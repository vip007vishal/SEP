(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function ax(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var em={exports:{}},wc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zy;function JU(){if(zy)return wc;zy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,s){var i=null;if(s!==void 0&&(i=""+s),a.key!==void 0&&(i=""+a.key),"key"in a){s={};for(var l in a)l!=="key"&&(s[l]=a[l])}else s=a;return a=s.ref,{$$typeof:e,type:n,key:i,ref:a!==void 0?a:null,props:s}}return wc.Fragment=t,wc.jsx=r,wc.jsxs=r,wc}var Xy;function YU(){return Xy||(Xy=1,em.exports=JU()),em.exports}var h=YU(),tm={exports:{}},bt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function qU(){if(Wy)return bt;Wy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),x=Symbol.iterator;function y(Y){return Y===null||typeof Y!="object"?null:(Y=x&&Y[x]||Y["@@iterator"],typeof Y=="function"?Y:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,T={};function S(Y,Q,K){this.props=Y,this.context=Q,this.refs=T,this.updater=K||C}S.prototype.isReactComponent={},S.prototype.setState=function(Y,Q){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,Q,"setState")},S.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function F(){}F.prototype=S.prototype;function _(Y,Q,K){this.props=Y,this.context=Q,this.refs=T,this.updater=K||C}var N=_.prototype=new F;N.constructor=_,E(N,S.prototype),N.isPureReactComponent=!0;var I=Array.isArray;function U(){}var k={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function M(Y,Q,K){var P=K.ref;return{$$typeof:e,type:Y,key:Q,ref:P!==void 0?P:null,props:K}}function ee(Y,Q){return M(Y.type,Q,Y.props)}function re(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function q(Y){var Q={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(K){return Q[K]})}var se=/\/+/g;function Te(Y,Q){return typeof Y=="object"&&Y!==null&&Y.key!=null?q(""+Y.key):Q.toString(36)}function Be(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(U,U):(Y.status="pending",Y.then(function(Q){Y.status==="pending"&&(Y.status="fulfilled",Y.value=Q)},function(Q){Y.status==="pending"&&(Y.status="rejected",Y.reason=Q)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function Z(Y,Q,K,P,z){var ce=typeof Y;(ce==="undefined"||ce==="boolean")&&(Y=null);var Ce=!1;if(Y===null)Ce=!0;else switch(ce){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(Y.$$typeof){case e:case t:Ce=!0;break;case d:return Ce=Y._init,Z(Ce(Y._payload),Q,K,P,z)}}if(Ce)return z=z(Y),Ce=P===""?"."+Te(Y,0):P,I(z)?(K="",Ce!=null&&(K=Ce.replace(se,"$&/")+"/"),Z(z,Q,K,"",function(ne){return ne})):z!=null&&(re(z)&&(z=ee(z,K+(z.key==null||Y&&Y.key===z.key?"":(""+z.key).replace(se,"$&/")+"/")+Ce)),Q.push(z)),1;Ce=0;var he=P===""?".":P+":";if(I(Y))for(var de=0;de<Y.length;de++)P=Y[de],ce=he+Te(P,de),Ce+=Z(P,Q,K,ce,z);else if(de=y(Y),typeof de=="function")for(Y=de.call(Y),de=0;!(P=Y.next()).done;)P=P.value,ce=he+Te(P,de++),Ce+=Z(P,Q,K,ce,z);else if(ce==="object"){if(typeof Y.then=="function")return Z(Be(Y),Q,K,P,z);throw Q=String(Y),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function ie(Y,Q,K){if(Y==null)return Y;var P=[],z=0;return Z(Y,P,"","",function(ce){return Q.call(K,ce,z++)}),P}function Qe(Y){if(Y._status===-1){var Q=Y._result;Q=Q(),Q.then(function(K){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=K)},function(K){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=K)}),Y._status===-1&&(Y._status=0,Y._result=Q)}if(Y._status===1)return Y._result.default;throw Y._result}var ae=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)},Le={map:ie,forEach:function(Y,Q,K){ie(Y,function(){Q.apply(this,arguments)},K)},count:function(Y){var Q=0;return ie(Y,function(){Q++}),Q},toArray:function(Y){return ie(Y,function(Q){return Q})||[]},only:function(Y){if(!re(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}};return bt.Activity=p,bt.Children=Le,bt.Component=S,bt.Fragment=r,bt.Profiler=a,bt.PureComponent=_,bt.StrictMode=n,bt.Suspense=u,bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,bt.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return k.H.useMemoCache(Y)}},bt.cache=function(Y){return function(){return Y.apply(null,arguments)}},bt.cacheSignal=function(){return null},bt.cloneElement=function(Y,Q,K){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var P=E({},Y.props),z=Y.key;if(Q!=null)for(ce in Q.key!==void 0&&(z=""+Q.key),Q)!G.call(Q,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&Q.ref===void 0||(P[ce]=Q[ce]);var ce=arguments.length-2;if(ce===1)P.children=K;else if(1<ce){for(var Ce=Array(ce),he=0;he<ce;he++)Ce[he]=arguments[he+2];P.children=Ce}return M(Y.type,z,P)},bt.createContext=function(Y){return Y={$$typeof:i,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:s,_context:Y},Y},bt.createElement=function(Y,Q,K){var P,z={},ce=null;if(Q!=null)for(P in Q.key!==void 0&&(ce=""+Q.key),Q)G.call(Q,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(z[P]=Q[P]);var Ce=arguments.length-2;if(Ce===1)z.children=K;else if(1<Ce){for(var he=Array(Ce),de=0;de<Ce;de++)he[de]=arguments[de+2];z.children=he}if(Y&&Y.defaultProps)for(P in Ce=Y.defaultProps,Ce)z[P]===void 0&&(z[P]=Ce[P]);return M(Y,ce,z)},bt.createRef=function(){return{current:null}},bt.forwardRef=function(Y){return{$$typeof:l,render:Y}},bt.isValidElement=re,bt.lazy=function(Y){return{$$typeof:d,_payload:{_status:-1,_result:Y},_init:Qe}},bt.memo=function(Y,Q){return{$$typeof:f,type:Y,compare:Q===void 0?null:Q}},bt.startTransition=function(Y){var Q=k.T,K={};k.T=K;try{var P=Y(),z=k.S;z!==null&&z(K,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(U,ae)}catch(ce){ae(ce)}finally{Q!==null&&K.types!==null&&(Q.types=K.types),k.T=Q}},bt.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},bt.use=function(Y){return k.H.use(Y)},bt.useActionState=function(Y,Q,K){return k.H.useActionState(Y,Q,K)},bt.useCallback=function(Y,Q){return k.H.useCallback(Y,Q)},bt.useContext=function(Y){return k.H.useContext(Y)},bt.useDebugValue=function(){},bt.useDeferredValue=function(Y,Q){return k.H.useDeferredValue(Y,Q)},bt.useEffect=function(Y,Q){return k.H.useEffect(Y,Q)},bt.useEffectEvent=function(Y){return k.H.useEffectEvent(Y)},bt.useId=function(){return k.H.useId()},bt.useImperativeHandle=function(Y,Q,K){return k.H.useImperativeHandle(Y,Q,K)},bt.useInsertionEffect=function(Y,Q){return k.H.useInsertionEffect(Y,Q)},bt.useLayoutEffect=function(Y,Q){return k.H.useLayoutEffect(Y,Q)},bt.useMemo=function(Y,Q){return k.H.useMemo(Y,Q)},bt.useOptimistic=function(Y,Q){return k.H.useOptimistic(Y,Q)},bt.useReducer=function(Y,Q,K){return k.H.useReducer(Y,Q,K)},bt.useRef=function(Y){return k.H.useRef(Y)},bt.useState=function(Y){return k.H.useState(Y)},bt.useSyncExternalStore=function(Y,Q,K){return k.H.useSyncExternalStore(Y,Q,K)},bt.useTransition=function(){return k.H.useTransition()},bt.version="19.2.4",bt}var Jy;function Ax(){return Jy||(Jy=1,tm.exports=qU()),tm.exports}var W=Ax();const $U=ax(W);var rm={exports:{}},yc={},nm={exports:{}},am={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yy;function ZU(){return Yy||(Yy=1,(function(e){function t(Z,ie){var Qe=Z.length;Z.push(ie);e:for(;0<Qe;){var ae=Qe-1>>>1,Le=Z[ae];if(0<a(Le,ie))Z[ae]=ie,Z[Qe]=Le,Qe=ae;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var ie=Z[0],Qe=Z.pop();if(Qe!==ie){Z[0]=Qe;e:for(var ae=0,Le=Z.length,Y=Le>>>1;ae<Y;){var Q=2*(ae+1)-1,K=Z[Q],P=Q+1,z=Z[P];if(0>a(K,Qe))P<Le&&0>a(z,K)?(Z[ae]=z,Z[P]=Qe,ae=P):(Z[ae]=K,Z[Q]=Qe,ae=Q);else if(P<Le&&0>a(z,Qe))Z[ae]=z,Z[P]=Qe,ae=P;else break e}}return ie}function a(Z,ie){var Qe=Z.sortIndex-ie.sortIndex;return Qe!==0?Qe:Z.id-ie.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var u=[],f=[],d=1,p=null,x=3,y=!1,C=!1,E=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function N(Z){for(var ie=r(f);ie!==null;){if(ie.callback===null)n(f);else if(ie.startTime<=Z)n(f),ie.sortIndex=ie.expirationTime,t(u,ie);else break;ie=r(f)}}function I(Z){if(E=!1,N(Z),!C)if(r(u)!==null)C=!0,U||(U=!0,q());else{var ie=r(f);ie!==null&&Be(I,ie.startTime-Z)}}var U=!1,k=-1,G=5,M=-1;function ee(){return T?!0:!(e.unstable_now()-M<G)}function re(){if(T=!1,U){var Z=e.unstable_now();M=Z;var ie=!0;try{e:{C=!1,E&&(E=!1,F(k),k=-1),y=!0;var Qe=x;try{t:{for(N(Z),p=r(u);p!==null&&!(p.expirationTime>Z&&ee());){var ae=p.callback;if(typeof ae=="function"){p.callback=null,x=p.priorityLevel;var Le=ae(p.expirationTime<=Z);if(Z=e.unstable_now(),typeof Le=="function"){p.callback=Le,N(Z),ie=!0;break t}p===r(u)&&n(u),N(Z)}else n(u);p=r(u)}if(p!==null)ie=!0;else{var Y=r(f);Y!==null&&Be(I,Y.startTime-Z),ie=!1}}break e}finally{p=null,x=Qe,y=!1}ie=void 0}}finally{ie?q():U=!1}}}var q;if(typeof _=="function")q=function(){_(re)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,Te=se.port2;se.port1.onmessage=re,q=function(){Te.postMessage(null)}}else q=function(){S(re,0)};function Be(Z,ie){k=S(function(){Z(e.unstable_now())},ie)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(Z){switch(x){case 1:case 2:case 3:var ie=3;break;default:ie=x}var Qe=x;x=ie;try{return Z()}finally{x=Qe}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(Z,ie){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Qe=x;x=Z;try{return ie()}finally{x=Qe}},e.unstable_scheduleCallback=function(Z,ie,Qe){var ae=e.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?ae+Qe:ae):Qe=ae,Z){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=Qe+Le,Z={id:d++,callback:ie,priorityLevel:Z,startTime:Qe,expirationTime:Le,sortIndex:-1},Qe>ae?(Z.sortIndex=Qe,t(f,Z),r(u)===null&&Z===r(f)&&(E?(F(k),k=-1):E=!0,Be(I,Qe-ae))):(Z.sortIndex=Le,t(u,Z),C||y||(C=!0,U||(U=!0,q()))),Z},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(Z){var ie=x;return function(){var Qe=x;x=ie;try{return Z.apply(this,arguments)}finally{x=Qe}}}})(am)),am}var qy;function ek(){return qy||(qy=1,nm.exports=ZU()),nm.exports}var Am={exports:{}},Dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $y;function tk(){if($y)return Dn;$y=1;var e=Ax();function t(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(u,f,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:u,containerInfo:f,implementation:d}}var i=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Dn.createPortal=function(u,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(u,f,null,d)},Dn.flushSync=function(u){var f=i.T,d=n.p;try{if(i.T=null,n.p=2,u)return u()}finally{i.T=f,n.p=d,n.d.f()}},Dn.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(u,f))},Dn.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},Dn.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:x,fetchPriority:y}):d==="script"&&n.d.X(u,{crossOrigin:p,integrity:x,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Dn.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);n.d.M(u,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(u)},Dn.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin);n.d.L(u,d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Dn.preloadModule=function(u,f){if(typeof u=="string")if(f){var d=l(f.as,f.crossOrigin);n.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(u)},Dn.requestFormReset=function(u){n.d.r(u)},Dn.unstable_batchedUpdates=function(u,f){return u(f)},Dn.useFormState=function(u,f,d){return i.H.useFormState(u,f,d)},Dn.useFormStatus=function(){return i.H.useHostTransitionStatus()},Dn.version="19.2.4",Dn}var Zy;function rk(){if(Zy)return Am.exports;Zy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Am.exports=tk(),Am.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eB;function nk(){if(eB)return yc;eB=1;var e=ek(),t=Ax(),r=rk();function n(A){var o="https://react.dev/errors/"+A;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+A+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(A){return!(!A||A.nodeType!==1&&A.nodeType!==9&&A.nodeType!==11)}function s(A){var o=A,c=A;if(A.alternate)for(;o.return;)o=o.return;else{A=o;do o=A,(o.flags&4098)!==0&&(c=o.return),A=o.return;while(A)}return o.tag===3?c:null}function i(A){if(A.tag===13){var o=A.memoizedState;if(o===null&&(A=A.alternate,A!==null&&(o=A.memoizedState)),o!==null)return o.dehydrated}return null}function l(A){if(A.tag===31){var o=A.memoizedState;if(o===null&&(A=A.alternate,A!==null&&(o=A.memoizedState)),o!==null)return o.dehydrated}return null}function u(A){if(s(A)!==A)throw Error(n(188))}function f(A){var o=A.alternate;if(!o){if(o=s(A),o===null)throw Error(n(188));return o!==A?null:A}for(var c=A,g=o;;){var w=c.return;if(w===null)break;var B=w.alternate;if(B===null){if(g=w.return,g!==null){c=g;continue}break}if(w.child===B.child){for(B=w.child;B;){if(B===c)return u(w),A;if(B===g)return u(w),o;B=B.sibling}throw Error(n(188))}if(c.return!==g.return)c=w,g=B;else{for(var b=!1,L=w.child;L;){if(L===c){b=!0,c=w,g=B;break}if(L===g){b=!0,g=w,c=B;break}L=L.sibling}if(!b){for(L=B.child;L;){if(L===c){b=!0,c=B,g=w;break}if(L===g){b=!0,g=B,c=w;break}L=L.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==g)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?A:o}function d(A){var o=A.tag;if(o===5||o===26||o===27||o===6)return A;for(A=A.child;A!==null;){if(o=d(A),o!==null)return o;A=A.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),_=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function q(A){return A===null||typeof A!="object"?null:(A=re&&A[re]||A["@@iterator"],typeof A=="function"?A:null)}var se=Symbol.for("react.client.reference");function Te(A){if(A==null)return null;if(typeof A=="function")return A.$$typeof===se?null:A.displayName||A.name||null;if(typeof A=="string")return A;switch(A){case E:return"Fragment";case S:return"Profiler";case T:return"StrictMode";case I:return"Suspense";case U:return"SuspenseList";case M:return"Activity"}if(typeof A=="object")switch(A.$$typeof){case C:return"Portal";case _:return A.displayName||"Context";case F:return(A._context.displayName||"Context")+".Consumer";case N:var o=A.render;return A=A.displayName,A||(A=o.displayName||o.name||"",A=A!==""?"ForwardRef("+A+")":"ForwardRef"),A;case k:return o=A.displayName||null,o!==null?o:Te(A.type)||"Memo";case G:o=A._payload,A=A._init;try{return Te(A(o))}catch{}}return null}var Be=Array.isArray,Z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Qe={pending:!1,data:null,method:null,action:null},ae=[],Le=-1;function Y(A){return{current:A}}function Q(A){0>Le||(A.current=ae[Le],ae[Le]=null,Le--)}function K(A,o){Le++,ae[Le]=A.current,A.current=o}var P=Y(null),z=Y(null),ce=Y(null),Ce=Y(null);function he(A,o){switch(K(ce,o),K(z,A),K(P,null),o.nodeType){case 9:case 11:A=(A=o.documentElement)&&(A=A.namespaceURI)?gy(A):0;break;default:if(A=o.tagName,o=o.namespaceURI)o=gy(o),A=my(o,A);else switch(A){case"svg":A=1;break;case"math":A=2;break;default:A=0}}Q(P),K(P,A)}function de(){Q(P),Q(z),Q(ce)}function ne(A){A.memoizedState!==null&&K(Ce,A);var o=P.current,c=my(o,A.type);o!==c&&(K(z,A),K(P,c))}function Ee(A){z.current===A&&(Q(P),Q(z)),Ce.current===A&&(Q(Ce),mc._currentValue=Qe)}var R,Re;function Ge(A){if(R===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);R=o&&o[1]||"",Re=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+R+A+Re}var Ze=!1;function st(A,o){if(!A||Ze)return"";Ze=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(o){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(_e){var ye=_e}Reflect.construct(A,[],Ie)}else{try{Ie.call()}catch(_e){ye=_e}A.call(Ie.prototype)}}else{try{throw Error()}catch(_e){ye=_e}(Ie=A())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(_e){if(_e&&ye&&typeof _e.stack=="string")return[_e.stack,ye.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=g.DetermineComponentFrameRoot(),b=B[0],L=B[1];if(b&&L){var te=b.split(`
`),pe=L.split(`
`);for(w=g=0;g<te.length&&!te[g].includes("DetermineComponentFrameRoot");)g++;for(;w<pe.length&&!pe[w].includes("DetermineComponentFrameRoot");)w++;if(g===te.length||w===pe.length)for(g=te.length-1,w=pe.length-1;1<=g&&0<=w&&te[g]!==pe[w];)w--;for(;1<=g&&0<=w;g--,w--)if(te[g]!==pe[w]){if(g!==1||w!==1)do if(g--,w--,0>w||te[g]!==pe[w]){var Ue=`
`+te[g].replace(" at new "," at ");return A.displayName&&Ue.includes("<anonymous>")&&(Ue=Ue.replace("<anonymous>",A.displayName)),Ue}while(1<=g&&0<=w);break}}}finally{Ze=!1,Error.prepareStackTrace=c}return(c=A?A.displayName||A.name:"")?Ge(c):""}function He(A,o){switch(A.tag){case 26:case 27:case 5:return Ge(A.type);case 16:return Ge("Lazy");case 13:return A.child!==o&&o!==null?Ge("Suspense Fallback"):Ge("Suspense");case 19:return Ge("SuspenseList");case 0:case 15:return st(A.type,!1);case 11:return st(A.type.render,!1);case 1:return st(A.type,!0);case 31:return Ge("Activity");default:return""}}function it(A){try{var o="",c=null;do o+=He(A,c),c=A,A=A.return;while(A);return o}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var wt=Object.prototype.hasOwnProperty,nr=e.unstable_scheduleCallback,Yt=e.unstable_cancelCallback,Mr=e.unstable_shouldYield,un=e.unstable_requestPaint,dt=e.unstable_now,ue=e.unstable_getCurrentPriorityLevel,We=e.unstable_ImmediatePriority,_t=e.unstable_UserBlockingPriority,ft=e.unstable_NormalPriority,Bt=e.unstable_LowPriority,et=e.unstable_IdlePriority,Tt=e.log,Rt=e.unstable_setDisableYieldValue,xt=null,zt=null;function zr(A){if(typeof Tt=="function"&&Rt(A),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(xt,A)}catch{}}var Sr=Math.clz32?Math.clz32:_r,nA=Math.log,ha=Math.LN2;function _r(A){return A>>>=0,A===0?32:31-(nA(A)/ha|0)|0}var mt=256,Lr=262144,Er=4194304;function ar(A){var o=A&42;if(o!==0)return o;switch(A&-A){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return A&261888;case 262144:case 524288:case 1048576:case 2097152:return A&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return A&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return A}}function MA(A,o,c){var g=A.pendingLanes;if(g===0)return 0;var w=0,B=A.suspendedLanes,b=A.pingedLanes;A=A.warmLanes;var L=g&134217727;return L!==0?(g=L&~B,g!==0?w=ar(g):(b&=L,b!==0?w=ar(b):c||(c=L&~A,c!==0&&(w=ar(c))))):(L=g&~B,L!==0?w=ar(L):b!==0?w=ar(b):c||(c=g&~A,c!==0&&(w=ar(c)))),w===0?0:o!==0&&o!==w&&(o&B)===0&&(B=w&-w,c=o&-o,B>=c||B===32&&(c&4194048)!==0)?o:w}function LA(A,o){return(A.pendingLanes&~(A.suspendedLanes&~A.pingedLanes)&o)===0}function uo(A,o){switch(A){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hi(){var A=Er;return Er<<=1,(Er&62914560)===0&&(Er=4194304),A}function gi(A){for(var o=[],c=0;31>c;c++)o.push(A);return o}function HA(A,o){A.pendingLanes|=o,o!==268435456&&(A.suspendedLanes=0,A.pingedLanes=0,A.warmLanes=0)}function fo(A,o,c,g,w,B){var b=A.pendingLanes;A.pendingLanes=c,A.suspendedLanes=0,A.pingedLanes=0,A.warmLanes=0,A.expiredLanes&=c,A.entangledLanes&=c,A.errorRecoveryDisabledLanes&=c,A.shellSuspendCounter=0;var L=A.entanglements,te=A.expirationTimes,pe=A.hiddenUpdates;for(c=b&~c;0<c;){var Ue=31-Sr(c),Ie=1<<Ue;L[Ue]=0,te[Ue]=-1;var ye=pe[Ue];if(ye!==null)for(pe[Ue]=null,Ue=0;Ue<ye.length;Ue++){var _e=ye[Ue];_e!==null&&(_e.lane&=-536870913)}c&=~Ie}g!==0&&ho(A,g,0),B!==0&&w===0&&A.tag!==0&&(A.suspendedLanes|=B&~(b&~o))}function ho(A,o,c){A.pendingLanes|=o,A.suspendedLanes&=~o;var g=31-Sr(o);A.entangledLanes|=o,A.entanglements[g]=A.entanglements[g]|1073741824|c&261930}function OA(A,o){var c=A.entangledLanes|=o;for(A=A.entanglements;c;){var g=31-Sr(c),w=1<<g;w&o|A[g]&o&&(A[g]|=o),c&=~w}}function go(A,o){var c=o&-o;return c=(c&42)!==0?1:mi(c),(c&(A.suspendedLanes|o))!==0?0:c}function mi(A){switch(A){case 2:A=1;break;case 8:A=4;break;case 32:A=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:A=128;break;case 268435456:A=134217728;break;default:A=0}return A}function vs(A){return A&=-A,2<A?8<A?(A&134217727)!==0?32:268435456:8:2}function D(){var A=ie.p;return A!==0?A:(A=window.event,A===void 0?32:Hy(A.type))}function j(A,o){var c=ie.p;try{return ie.p=A,o()}finally{ie.p=c}}var H=Math.random().toString(36).slice(2),O="__reactFiber$"+H,V="__reactProps$"+H,J="__reactContainer$"+H,me="__reactEvents$"+H,Fe="__reactListeners$"+H,xe="__reactHandles$"+H,ve="__reactResources$"+H,we="__reactMarker$"+H;function Oe(A){delete A[O],delete A[V],delete A[me],delete A[Fe],delete A[xe]}function Ve(A){var o=A[O];if(o)return o;for(var c=A.parentNode;c;){if(o=c[J]||c[O]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(A=Cy(A);A!==null;){if(c=A[O])return c;A=Cy(A)}return o}A=c,c=A.parentNode}return null}function Ye(A){if(A=A[O]||A[J]){var o=A.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return A}return null}function Pe(A){var o=A.tag;if(o===5||o===26||o===27||o===6)return A.stateNode;throw Error(n(33))}function Xe(A){var o=A[ve];return o||(o=A[ve]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ot(A){A[we]=!0}var pr=new Set,lr={};function cr(A,o){na(A,o),na(A+"Capture",o)}function na(A,o){for(lr[A]=o,A=0;A<o.length;A++)pr.add(o[A])}var PA=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vA={},ka={};function fn(A){return wt.call(ka,A)?!0:wt.call(vA,A)?!1:PA.test(A)?ka[A]=!0:(vA[A]=!0,!1)}function pn(A,o,c){if(fn(o))if(c===null)A.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":A.removeAttribute(o);return;case"boolean":var g=o.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){A.removeAttribute(o);return}}A.setAttribute(o,""+c)}}function ws(A,o,c){if(c===null)A.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":A.removeAttribute(o);return}A.setAttribute(o,""+c)}}function ga(A,o,c,g){if(g===null)A.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":A.removeAttribute(c);return}A.setAttributeNS(o,c,""+g)}}function Rn(A){switch(typeof A){case"bigint":case"boolean":case"number":case"string":case"undefined":return A;case"object":return A;default:return""}}function pi(A){var o=A.type;return(A=A.nodeName)&&A.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ou(A,o,c){var g=Object.getOwnPropertyDescriptor(A.constructor.prototype,o);if(!A.hasOwnProperty(o)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,B=g.set;return Object.defineProperty(A,o,{configurable:!0,get:function(){return w.call(this)},set:function(b){c=""+b,B.call(this,b)}}),Object.defineProperty(A,o,{enumerable:g.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){A._valueTracker=null,delete A[o]}}}}function mo(A){if(!A._valueTracker){var o=pi(A)?"checked":"value";A._valueTracker=Ou(A,o,""+A[o])}}function Il(A){if(!A)return!1;var o=A._valueTracker;if(!o)return!0;var c=o.getValue(),g="";return A&&(g=pi(A)?A.checked?"true":"false":A.value),A=g,A!==c?(o.setValue(A),!0):!1}function X(A){if(A=A||(typeof document<"u"?document:void 0),typeof A>"u")return null;try{return A.activeElement||A.body}catch{return A.body}}var le=/[\n"\\]/g;function Se(A){return A.replace(le,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ke(A,o,c,g,w,B,b,L){A.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?A.type=b:A.removeAttribute("type"),o!=null?b==="number"?(o===0&&A.value===""||A.value!=o)&&(A.value=""+Rn(o)):A.value!==""+Rn(o)&&(A.value=""+Rn(o)):b!=="submit"&&b!=="reset"||A.removeAttribute("value"),o!=null?Me(A,b,Rn(o)):c!=null?Me(A,b,Rn(c)):g!=null&&A.removeAttribute("value"),w==null&&B!=null&&(A.defaultChecked=!!B),w!=null&&(A.checked=w&&typeof w!="function"&&typeof w!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?A.name=""+Rn(L):A.removeAttribute("name")}function oe(A,o,c,g,w,B,b,L){if(B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(A.type=B),o!=null||c!=null){if(!(B!=="submit"&&B!=="reset"||o!=null)){mo(A);return}c=c!=null?""+Rn(c):"",o=o!=null?""+Rn(o):c,L||o===A.value||(A.value=o),A.defaultValue=o}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,A.checked=L?A.checked:!!g,A.defaultChecked=!!g,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(A.name=b),mo(A)}function Me(A,o,c){o==="number"&&X(A.ownerDocument)===A||A.defaultValue===""+c||(A.defaultValue=""+c)}function Je(A,o,c,g){if(A=A.options,o){o={};for(var w=0;w<c.length;w++)o["$"+c[w]]=!0;for(c=0;c<A.length;c++)w=o.hasOwnProperty("$"+A[c].value),A[c].selected!==w&&(A[c].selected=w),w&&g&&(A[c].defaultSelected=!0)}else{for(c=""+Rn(c),o=null,w=0;w<A.length;w++){if(A[w].value===c){A[w].selected=!0,g&&(A[w].defaultSelected=!0);return}o!==null||A[w].disabled||(o=A[w])}o!==null&&(o.selected=!0)}}function ct(A,o,c){if(o!=null&&(o=""+Rn(o),o!==A.value&&(A.value=o),c==null)){A.defaultValue!==o&&(A.defaultValue=o);return}A.defaultValue=c!=null?""+Rn(c):""}function Et(A,o,c,g){if(o==null){if(g!=null){if(c!=null)throw Error(n(92));if(Be(g)){if(1<g.length)throw Error(n(93));g=g[0]}c=g}c==null&&(c=""),o=c}c=Rn(o),A.defaultValue=c,g=A.textContent,g===c&&g!==""&&g!==null&&(A.value=g),mo(A)}function Nt(A,o){if(o){var c=A.firstChild;if(c&&c===A.lastChild&&c.nodeType===3){c.nodeValue=o;return}}A.textContent=o}var Pt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(A,o,c){var g=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?g?A.setProperty(o,""):o==="float"?A.cssFloat="":A[o]="":g?A.setProperty(o,c):typeof c!="number"||c===0||Pt.has(o)?o==="float"?A.cssFloat=c:A[o]=(""+c).trim():A[o]=c+"px"}function xn(A,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(A=A.style,c!=null){for(var g in c)!c.hasOwnProperty(g)||o!=null&&o.hasOwnProperty(g)||(g.indexOf("--")===0?A.setProperty(g,""):g==="float"?A.cssFloat="":A[g]="");for(var w in o)g=o[w],o.hasOwnProperty(w)&&c[w]!==g&&Mt(A,w,g)}else for(var B in o)o.hasOwnProperty(B)&&Mt(A,B,o[B])}function Xr(A){if(A.indexOf("-")===-1)return!1;switch(A){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Jn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ir(A){return Jn.test(""+A)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":A}function rt(){}var at=null;function ur(A){return A=A.target||A.srcElement||window,A.correspondingUseElement&&(A=A.correspondingUseElement),A.nodeType===3?A.parentNode:A}var Xt=null,br=null;function Ql(A){var o=Ye(A);if(o&&(A=o.stateNode)){var c=A[V]||null;e:switch(A=o.stateNode,o.type){case"input":if(ke(A,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=A;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Se(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var g=c[o];if(g!==A&&g.form===A.form){var w=g[V]||null;if(!w)throw Error(n(90));ke(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(o=0;o<c.length;o++)g=c[o],g.form===A.form&&Il(g)}break e;case"textarea":ct(A,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Je(A,!!c.multiple,o,!1)}}}var po=!1;function Wt(A,o,c){if(po)return A(o,c);po=!0;try{var g=A(o);return g}finally{if(po=!1,(Xt!==null||br!==null)&&(_0(),Xt&&(o=Xt,A=br,br=Xt=null,Ql(o),A)))for(o=0;o<A.length;o++)Ql(A[o])}}function aA(A,o){var c=A.stateNode;if(c===null)return null;var g=c[V]||null;if(g===null)return null;c=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(A=A.type,g=!(A==="button"||A==="input"||A==="select"||A==="textarea")),A=!g;break e;default:A=!1}if(A)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xo=!1;if(Na)try{var ys={};Object.defineProperty(ys,"passive",{get:function(){xo=!0}}),window.addEventListener("test",ys,ys),window.removeEventListener("test",ys,ys)}catch{xo=!1}var AA=null,xi=null,Pu=null;function mv(){if(Pu)return Pu;var A,o=xi,c=o.length,g,w="value"in AA?AA.value:AA.textContent,B=w.length;for(A=0;A<c&&o[A]===w[A];A++);var b=c-A;for(g=1;g<=b&&o[c-g]===w[B-g];g++);return Pu=w.slice(A,1<g?1-g:void 0)}function Gu(A){var o=A.keyCode;return"charCode"in A?(A=A.charCode,A===0&&o===13&&(A=13)):A=o,A===10&&(A=13),32<=A||A===13?A:0}function Vu(){return!0}function pv(){return!1}function aa(A){function o(c,g,w,B,b){this._reactName=c,this._targetInst=w,this.type=g,this.nativeEvent=B,this.target=b,this.currentTarget=null;for(var L in A)A.hasOwnProperty(L)&&(c=A[L],this[L]=c?c(B):B[L]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?Vu:pv,this.isPropagationStopped=pv,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Vu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Vu)},persist:function(){},isPersistent:Vu}),o}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(A){return A.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ku=aa(vi),Rl=p({},vi,{view:0,detail:0}),X4=aa(Rl),rh,nh,Dl,ju=p({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ah,button:0,buttons:0,relatedTarget:function(A){return A.relatedTarget===void 0?A.fromElement===A.srcElement?A.toElement:A.fromElement:A.relatedTarget},movementX:function(A){return"movementX"in A?A.movementX:(A!==Dl&&(Dl&&A.type==="mousemove"?(rh=A.screenX-Dl.screenX,nh=A.screenY-Dl.screenY):nh=rh=0,Dl=A),rh)},movementY:function(A){return"movementY"in A?A.movementY:nh}}),xv=aa(ju),W4=p({},ju,{dataTransfer:0}),J4=aa(W4),Y4=p({},Rl,{relatedTarget:0}),ah=aa(Y4),q4=p({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),$4=aa(q4),Z4=p({},vi,{clipboardData:function(A){return"clipboardData"in A?A.clipboardData:window.clipboardData}}),eF=aa(Z4),tF=p({},vi,{data:0}),vv=aa(tF),rF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AF(A){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(A):(A=aF[A])?!!o[A]:!1}function Ah(){return AF}var sF=p({},Rl,{key:function(A){if(A.key){var o=rF[A.key]||A.key;if(o!=="Unidentified")return o}return A.type==="keypress"?(A=Gu(A),A===13?"Enter":String.fromCharCode(A)):A.type==="keydown"||A.type==="keyup"?nF[A.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ah,charCode:function(A){return A.type==="keypress"?Gu(A):0},keyCode:function(A){return A.type==="keydown"||A.type==="keyup"?A.keyCode:0},which:function(A){return A.type==="keypress"?Gu(A):A.type==="keydown"||A.type==="keyup"?A.keyCode:0}}),iF=aa(sF),oF=p({},ju,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wv=aa(oF),lF=p({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ah}),cF=aa(lF),uF=p({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),fF=aa(uF),dF=p({},ju,{deltaX:function(A){return"deltaX"in A?A.deltaX:"wheelDeltaX"in A?-A.wheelDeltaX:0},deltaY:function(A){return"deltaY"in A?A.deltaY:"wheelDeltaY"in A?-A.wheelDeltaY:"wheelDelta"in A?-A.wheelDelta:0},deltaZ:0,deltaMode:0}),hF=aa(dF),gF=p({},vi,{newState:0,oldState:0}),mF=aa(gF),pF=[9,13,27,32],sh=Na&&"CompositionEvent"in window,Ml=null;Na&&"documentMode"in document&&(Ml=document.documentMode);var xF=Na&&"TextEvent"in window&&!Ml,yv=Na&&(!sh||Ml&&8<Ml&&11>=Ml),Bv=" ",Cv=!1;function Ev(A,o){switch(A){case"keyup":return pF.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tv(A){return A=A.detail,typeof A=="object"&&"data"in A?A.data:null}var vo=!1;function vF(A,o){switch(A){case"compositionend":return Tv(o);case"keypress":return o.which!==32?null:(Cv=!0,Bv);case"textInput":return A=o.data,A===Bv&&Cv?null:A;default:return null}}function wF(A,o){if(vo)return A==="compositionend"||!sh&&Ev(A,o)?(A=mv(),Pu=xi=AA=null,vo=!1,A):null;switch(A){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return yv&&o.locale!=="ko"?null:o.data;default:return null}}var yF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sv(A){var o=A&&A.nodeName&&A.nodeName.toLowerCase();return o==="input"?!!yF[A.type]:o==="textarea"}function _v(A,o,c,g){Xt?br?br.push(g):br=[g]:Xt=g,o=Q0(o,"onChange"),0<o.length&&(c=new Ku("onChange","change",null,c,g),A.push({event:c,listeners:o}))}var Ll=null,Hl=null;function BF(A){ly(A,0)}function zu(A){var o=Pe(A);if(Il(o))return A}function bv(A,o){if(A==="change")return o}var Fv=!1;if(Na){var ih;if(Na){var oh="oninput"in document;if(!oh){var Uv=document.createElement("div");Uv.setAttribute("oninput","return;"),oh=typeof Uv.oninput=="function"}ih=oh}else ih=!1;Fv=ih&&(!document.documentMode||9<document.documentMode)}function kv(){Ll&&(Ll.detachEvent("onpropertychange",Nv),Hl=Ll=null)}function Nv(A){if(A.propertyName==="value"&&zu(Hl)){var o=[];_v(o,Hl,A,ur(A)),Wt(BF,o)}}function CF(A,o,c){A==="focusin"?(kv(),Ll=o,Hl=c,Ll.attachEvent("onpropertychange",Nv)):A==="focusout"&&kv()}function EF(A){if(A==="selectionchange"||A==="keyup"||A==="keydown")return zu(Hl)}function TF(A,o){if(A==="click")return zu(o)}function SF(A,o){if(A==="input"||A==="change")return zu(o)}function _F(A,o){return A===o&&(A!==0||1/A===1/o)||A!==A&&o!==o}var ma=typeof Object.is=="function"?Object.is:_F;function Ol(A,o){if(ma(A,o))return!0;if(typeof A!="object"||A===null||typeof o!="object"||o===null)return!1;var c=Object.keys(A),g=Object.keys(o);if(c.length!==g.length)return!1;for(g=0;g<c.length;g++){var w=c[g];if(!wt.call(o,w)||!ma(A[w],o[w]))return!1}return!0}function Iv(A){for(;A&&A.firstChild;)A=A.firstChild;return A}function Qv(A,o){var c=Iv(A);A=0;for(var g;c;){if(c.nodeType===3){if(g=A+c.textContent.length,A<=o&&g>=o)return{node:c,offset:o-A};A=g}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Iv(c)}}function Rv(A,o){return A&&o?A===o?!0:A&&A.nodeType===3?!1:o&&o.nodeType===3?Rv(A,o.parentNode):"contains"in A?A.contains(o):A.compareDocumentPosition?!!(A.compareDocumentPosition(o)&16):!1:!1}function Dv(A){A=A!=null&&A.ownerDocument!=null&&A.ownerDocument.defaultView!=null?A.ownerDocument.defaultView:window;for(var o=X(A.document);o instanceof A.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)A=o.contentWindow;else break;o=X(A.document)}return o}function lh(A){var o=A&&A.nodeName&&A.nodeName.toLowerCase();return o&&(o==="input"&&(A.type==="text"||A.type==="search"||A.type==="tel"||A.type==="url"||A.type==="password")||o==="textarea"||A.contentEditable==="true")}var bF=Na&&"documentMode"in document&&11>=document.documentMode,wo=null,ch=null,Pl=null,uh=!1;function Mv(A,o,c){var g=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;uh||wo==null||wo!==X(g)||(g=wo,"selectionStart"in g&&lh(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Pl&&Ol(Pl,g)||(Pl=g,g=Q0(ch,"onSelect"),0<g.length&&(o=new Ku("onSelect","select",null,o,c),A.push({event:o,listeners:g}),o.target=wo)))}function wi(A,o){var c={};return c[A.toLowerCase()]=o.toLowerCase(),c["Webkit"+A]="webkit"+o,c["Moz"+A]="moz"+o,c}var yo={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionrun:wi("Transition","TransitionRun"),transitionstart:wi("Transition","TransitionStart"),transitioncancel:wi("Transition","TransitionCancel"),transitionend:wi("Transition","TransitionEnd")},fh={},Lv={};Na&&(Lv=document.createElement("div").style,"AnimationEvent"in window||(delete yo.animationend.animation,delete yo.animationiteration.animation,delete yo.animationstart.animation),"TransitionEvent"in window||delete yo.transitionend.transition);function yi(A){if(fh[A])return fh[A];if(!yo[A])return A;var o=yo[A],c;for(c in o)if(o.hasOwnProperty(c)&&c in Lv)return fh[A]=o[c];return A}var Hv=yi("animationend"),Ov=yi("animationiteration"),Pv=yi("animationstart"),FF=yi("transitionrun"),UF=yi("transitionstart"),kF=yi("transitioncancel"),Gv=yi("transitionend"),Vv=new Map,dh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dh.push("scrollEnd");function sA(A,o){Vv.set(A,o),cr(o,[A])}var Xu=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},Ia=[],Bo=0,hh=0;function Wu(){for(var A=Bo,o=hh=Bo=0;o<A;){var c=Ia[o];Ia[o++]=null;var g=Ia[o];Ia[o++]=null;var w=Ia[o];Ia[o++]=null;var B=Ia[o];if(Ia[o++]=null,g!==null&&w!==null){var b=g.pending;b===null?w.next=w:(w.next=b.next,b.next=w),g.pending=w}B!==0&&Kv(c,w,B)}}function Ju(A,o,c,g){Ia[Bo++]=A,Ia[Bo++]=o,Ia[Bo++]=c,Ia[Bo++]=g,hh|=g,A.lanes|=g,A=A.alternate,A!==null&&(A.lanes|=g)}function gh(A,o,c,g){return Ju(A,o,c,g),Yu(A)}function Bi(A,o){return Ju(A,null,null,o),Yu(A)}function Kv(A,o,c){A.lanes|=c;var g=A.alternate;g!==null&&(g.lanes|=c);for(var w=!1,B=A.return;B!==null;)B.childLanes|=c,g=B.alternate,g!==null&&(g.childLanes|=c),B.tag===22&&(A=B.stateNode,A===null||A._visibility&1||(w=!0)),A=B,B=B.return;return A.tag===3?(B=A.stateNode,w&&o!==null&&(w=31-Sr(c),A=B.hiddenUpdates,g=A[w],g===null?A[w]=[o]:g.push(o),o.lane=c|536870912),B):null}function Yu(A){if(50<lc)throw lc=0,Eg=null,Error(n(185));for(var o=A.return;o!==null;)A=o,o=A.return;return A.tag===3?A.stateNode:null}var Co={};function NF(A,o,c,g){this.tag=A,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pa(A,o,c,g){return new NF(A,o,c,g)}function mh(A){return A=A.prototype,!(!A||!A.isReactComponent)}function GA(A,o){var c=A.alternate;return c===null?(c=pa(A.tag,o,A.key,A.mode),c.elementType=A.elementType,c.type=A.type,c.stateNode=A.stateNode,c.alternate=A,A.alternate=c):(c.pendingProps=o,c.type=A.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=A.flags&65011712,c.childLanes=A.childLanes,c.lanes=A.lanes,c.child=A.child,c.memoizedProps=A.memoizedProps,c.memoizedState=A.memoizedState,c.updateQueue=A.updateQueue,o=A.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=A.sibling,c.index=A.index,c.ref=A.ref,c.refCleanup=A.refCleanup,c}function jv(A,o){A.flags&=65011714;var c=A.alternate;return c===null?(A.childLanes=0,A.lanes=o,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=c.childLanes,A.lanes=c.lanes,A.child=c.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=c.memoizedProps,A.memoizedState=c.memoizedState,A.updateQueue=c.updateQueue,A.type=c.type,o=c.dependencies,A.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),A}function qu(A,o,c,g,w,B){var b=0;if(g=A,typeof A=="function")mh(A)&&(b=1);else if(typeof A=="string")b=MU(A,c,P.current)?26:A==="html"||A==="head"||A==="body"?27:5;else e:switch(A){case M:return A=pa(31,c,o,w),A.elementType=M,A.lanes=B,A;case E:return Ci(c.children,w,B,o);case T:b=8,w|=24;break;case S:return A=pa(12,c,o,w|2),A.elementType=S,A.lanes=B,A;case I:return A=pa(13,c,o,w),A.elementType=I,A.lanes=B,A;case U:return A=pa(19,c,o,w),A.elementType=U,A.lanes=B,A;default:if(typeof A=="object"&&A!==null)switch(A.$$typeof){case _:b=10;break e;case F:b=9;break e;case N:b=11;break e;case k:b=14;break e;case G:b=16,g=null;break e}b=29,c=Error(n(130,A===null?"null":typeof A,"")),g=null}return o=pa(b,c,o,w),o.elementType=A,o.type=g,o.lanes=B,o}function Ci(A,o,c,g){return A=pa(7,A,g,o),A.lanes=c,A}function ph(A,o,c){return A=pa(6,A,null,o),A.lanes=c,A}function zv(A){var o=pa(18,null,null,0);return o.stateNode=A,o}function xh(A,o,c){return o=pa(4,A.children!==null?A.children:[],A.key,o),o.lanes=c,o.stateNode={containerInfo:A.containerInfo,pendingChildren:null,implementation:A.implementation},o}var Xv=new WeakMap;function Qa(A,o){if(typeof A=="object"&&A!==null){var c=Xv.get(A);return c!==void 0?c:(o={value:A,source:o,stack:it(o)},Xv.set(A,o),o)}return{value:A,source:o,stack:it(o)}}var Eo=[],To=0,$u=null,Gl=0,Ra=[],Da=0,Bs=null,wA=1,yA="";function VA(A,o){Eo[To++]=Gl,Eo[To++]=$u,$u=A,Gl=o}function Wv(A,o,c){Ra[Da++]=wA,Ra[Da++]=yA,Ra[Da++]=Bs,Bs=A;var g=wA;A=yA;var w=32-Sr(g)-1;g&=~(1<<w),c+=1;var B=32-Sr(o)+w;if(30<B){var b=w-w%5;B=(g&(1<<b)-1).toString(32),g>>=b,w-=b,wA=1<<32-Sr(o)+w|c<<w|g,yA=B+A}else wA=1<<B|c<<w|g,yA=A}function vh(A){A.return!==null&&(VA(A,1),Wv(A,1,0))}function wh(A){for(;A===$u;)$u=Eo[--To],Eo[To]=null,Gl=Eo[--To],Eo[To]=null;for(;A===Bs;)Bs=Ra[--Da],Ra[Da]=null,yA=Ra[--Da],Ra[Da]=null,wA=Ra[--Da],Ra[Da]=null}function Jv(A,o){Ra[Da++]=wA,Ra[Da++]=yA,Ra[Da++]=Bs,wA=o.id,yA=o.overflow,Bs=A}var Sn=null,Fr=null,Jt=!1,Cs=null,Ma=!1,yh=Error(n(519));function Es(A){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Vl(Qa(o,A)),yh}function Yv(A){var o=A.stateNode,c=A.type,g=A.memoizedProps;switch(o[O]=A,o[V]=g,c){case"dialog":Ot("cancel",o),Ot("close",o);break;case"iframe":case"object":case"embed":Ot("load",o);break;case"video":case"audio":for(c=0;c<uc.length;c++)Ot(uc[c],o);break;case"source":Ot("error",o);break;case"img":case"image":case"link":Ot("error",o),Ot("load",o);break;case"details":Ot("toggle",o);break;case"input":Ot("invalid",o),oe(o,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Ot("invalid",o);break;case"textarea":Ot("invalid",o),Et(o,g.value,g.defaultValue,g.children)}c=g.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||g.suppressHydrationWarning===!0||dy(o.textContent,c)?(g.popover!=null&&(Ot("beforetoggle",o),Ot("toggle",o)),g.onScroll!=null&&Ot("scroll",o),g.onScrollEnd!=null&&Ot("scrollend",o),g.onClick!=null&&(o.onclick=rt),o=!0):o=!1,o||Es(A,!0)}function qv(A){for(Sn=A.return;Sn;)switch(Sn.tag){case 5:case 31:case 13:Ma=!1;return;case 27:case 3:Ma=!0;return;default:Sn=Sn.return}}function So(A){if(A!==Sn)return!1;if(!Jt)return qv(A),Jt=!0,!1;var o=A.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=A.type,c=!(c!=="form"&&c!=="button")||Hg(A.type,A.memoizedProps)),c=!c),c&&Fr&&Es(A),qv(A),o===13){if(A=A.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));Fr=By(A)}else if(o===31){if(A=A.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));Fr=By(A)}else o===27?(o=Fr,Ls(A.type)?(A=Kg,Kg=null,Fr=A):Fr=o):Fr=Sn?Ha(A.stateNode.nextSibling):null;return!0}function Ei(){Fr=Sn=null,Jt=!1}function Bh(){var A=Cs;return A!==null&&(oa===null?oa=A:oa.push.apply(oa,A),Cs=null),A}function Vl(A){Cs===null?Cs=[A]:Cs.push(A)}var Ch=Y(null),Ti=null,KA=null;function Ts(A,o,c){K(Ch,o._currentValue),o._currentValue=c}function jA(A){A._currentValue=Ch.current,Q(Ch)}function Eh(A,o,c){for(;A!==null;){var g=A.alternate;if((A.childLanes&o)!==o?(A.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),A===c)break;A=A.return}}function Th(A,o,c,g){var w=A.child;for(w!==null&&(w.return=A);w!==null;){var B=w.dependencies;if(B!==null){var b=w.child;B=B.firstContext;e:for(;B!==null;){var L=B;B=w;for(var te=0;te<o.length;te++)if(L.context===o[te]){B.lanes|=c,L=B.alternate,L!==null&&(L.lanes|=c),Eh(B.return,c,A),g||(b=null);break e}B=L.next}}else if(w.tag===18){if(b=w.return,b===null)throw Error(n(341));b.lanes|=c,B=b.alternate,B!==null&&(B.lanes|=c),Eh(b,c,A),b=null}else b=w.child;if(b!==null)b.return=w;else for(b=w;b!==null;){if(b===A){b=null;break}if(w=b.sibling,w!==null){w.return=b.return,b=w;break}b=b.return}w=b}}function _o(A,o,c,g){A=null;for(var w=o,B=!1;w!==null;){if(!B){if((w.flags&524288)!==0)B=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var b=w.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var L=w.type;ma(w.pendingProps.value,b.value)||(A!==null?A.push(L):A=[L])}}else if(w===Ce.current){if(b=w.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(A!==null?A.push(mc):A=[mc])}w=w.return}A!==null&&Th(o,A,c,g),o.flags|=262144}function Zu(A){for(A=A.firstContext;A!==null;){if(!ma(A.context._currentValue,A.memoizedValue))return!0;A=A.next}return!1}function Si(A){Ti=A,KA=null,A=A.dependencies,A!==null&&(A.firstContext=null)}function _n(A){return $v(Ti,A)}function e0(A,o){return Ti===null&&Si(A),$v(A,o)}function $v(A,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},KA===null){if(A===null)throw Error(n(308));KA=o,A.dependencies={lanes:0,firstContext:o},A.flags|=524288}else KA=KA.next=o;return c}var IF=typeof AbortController<"u"?AbortController:function(){var A=[],o=this.signal={aborted:!1,addEventListener:function(c,g){A.push(g)}};this.abort=function(){o.aborted=!0,A.forEach(function(c){return c()})}},QF=e.unstable_scheduleCallback,RF=e.unstable_NormalPriority,tn={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sh(){return{controller:new IF,data:new Map,refCount:0}}function Kl(A){A.refCount--,A.refCount===0&&QF(RF,function(){A.controller.abort()})}var jl=null,_h=0,bo=0,Fo=null;function DF(A,o){if(jl===null){var c=jl=[];_h=0,bo=Ug(),Fo={status:"pending",value:void 0,then:function(g){c.push(g)}}}return _h++,o.then(Zv,Zv),o}function Zv(){if(--_h===0&&jl!==null){Fo!==null&&(Fo.status="fulfilled");var A=jl;jl=null,bo=0,Fo=null;for(var o=0;o<A.length;o++)(0,A[o])()}}function MF(A,o){var c=[],g={status:"pending",value:null,reason:null,then:function(w){c.push(w)}};return A.then(function(){g.status="fulfilled",g.value=o;for(var w=0;w<c.length;w++)(0,c[w])(o)},function(w){for(g.status="rejected",g.reason=w,w=0;w<c.length;w++)(0,c[w])(void 0)}),g}var e1=Z.S;Z.S=function(A,o){Mw=dt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&DF(A,o),e1!==null&&e1(A,o)};var _i=Y(null);function bh(){var A=_i.current;return A!==null?A:Cr.pooledCache}function t0(A,o){o===null?K(_i,_i.current):K(_i,o.pool)}function t1(){var A=bh();return A===null?null:{parent:tn._currentValue,pool:A}}var Uo=Error(n(460)),Fh=Error(n(474)),r0=Error(n(542)),n0={then:function(){}};function r1(A){return A=A.status,A==="fulfilled"||A==="rejected"}function n1(A,o,c){switch(c=A[c],c===void 0?A.push(o):c!==o&&(o.then(rt,rt),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw A=o.reason,A1(A),A;default:if(typeof o.status=="string")o.then(rt,rt);else{if(A=Cr,A!==null&&100<A.shellSuspendCounter)throw Error(n(482));A=o,A.status="pending",A.then(function(g){if(o.status==="pending"){var w=o;w.status="fulfilled",w.value=g}},function(g){if(o.status==="pending"){var w=o;w.status="rejected",w.reason=g}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw A=o.reason,A1(A),A}throw Fi=o,Uo}}function bi(A){try{var o=A._init;return o(A._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Fi=c,Uo):c}}var Fi=null;function a1(){if(Fi===null)throw Error(n(459));var A=Fi;return Fi=null,A}function A1(A){if(A===Uo||A===r0)throw Error(n(483))}var ko=null,zl=0;function a0(A){var o=zl;return zl+=1,ko===null&&(ko=[]),n1(ko,A,o)}function Xl(A,o){o=o.props.ref,A.ref=o!==void 0?o:null}function A0(A,o){throw o.$$typeof===x?Error(n(525)):(A=Object.prototype.toString.call(o),Error(n(31,A==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":A)))}function s1(A){function o(fe,Ae){if(A){var ge=fe.deletions;ge===null?(fe.deletions=[Ae],fe.flags|=16):ge.push(Ae)}}function c(fe,Ae){if(!A)return null;for(;Ae!==null;)o(fe,Ae),Ae=Ae.sibling;return null}function g(fe){for(var Ae=new Map;fe!==null;)fe.key!==null?Ae.set(fe.key,fe):Ae.set(fe.index,fe),fe=fe.sibling;return Ae}function w(fe,Ae){return fe=GA(fe,Ae),fe.index=0,fe.sibling=null,fe}function B(fe,Ae,ge){return fe.index=ge,A?(ge=fe.alternate,ge!==null?(ge=ge.index,ge<Ae?(fe.flags|=67108866,Ae):ge):(fe.flags|=67108866,Ae)):(fe.flags|=1048576,Ae)}function b(fe){return A&&fe.alternate===null&&(fe.flags|=67108866),fe}function L(fe,Ae,ge,Ne){return Ae===null||Ae.tag!==6?(Ae=ph(ge,fe.mode,Ne),Ae.return=fe,Ae):(Ae=w(Ae,ge),Ae.return=fe,Ae)}function te(fe,Ae,ge,Ne){var ht=ge.type;return ht===E?Ue(fe,Ae,ge.props.children,Ne,ge.key):Ae!==null&&(Ae.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===G&&bi(ht)===Ae.type)?(Ae=w(Ae,ge.props),Xl(Ae,ge),Ae.return=fe,Ae):(Ae=qu(ge.type,ge.key,ge.props,null,fe.mode,Ne),Xl(Ae,ge),Ae.return=fe,Ae)}function pe(fe,Ae,ge,Ne){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==ge.containerInfo||Ae.stateNode.implementation!==ge.implementation?(Ae=xh(ge,fe.mode,Ne),Ae.return=fe,Ae):(Ae=w(Ae,ge.children||[]),Ae.return=fe,Ae)}function Ue(fe,Ae,ge,Ne,ht){return Ae===null||Ae.tag!==7?(Ae=Ci(ge,fe.mode,Ne,ht),Ae.return=fe,Ae):(Ae=w(Ae,ge),Ae.return=fe,Ae)}function Ie(fe,Ae,ge){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Ae=ph(""+Ae,fe.mode,ge),Ae.return=fe,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case y:return ge=qu(Ae.type,Ae.key,Ae.props,null,fe.mode,ge),Xl(ge,Ae),ge.return=fe,ge;case C:return Ae=xh(Ae,fe.mode,ge),Ae.return=fe,Ae;case G:return Ae=bi(Ae),Ie(fe,Ae,ge)}if(Be(Ae)||q(Ae))return Ae=Ci(Ae,fe.mode,ge,null),Ae.return=fe,Ae;if(typeof Ae.then=="function")return Ie(fe,a0(Ae),ge);if(Ae.$$typeof===_)return Ie(fe,e0(fe,Ae),ge);A0(fe,Ae)}return null}function ye(fe,Ae,ge,Ne){var ht=Ae!==null?Ae.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ht!==null?null:L(fe,Ae,""+ge,Ne);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case y:return ge.key===ht?te(fe,Ae,ge,Ne):null;case C:return ge.key===ht?pe(fe,Ae,ge,Ne):null;case G:return ge=bi(ge),ye(fe,Ae,ge,Ne)}if(Be(ge)||q(ge))return ht!==null?null:Ue(fe,Ae,ge,Ne,null);if(typeof ge.then=="function")return ye(fe,Ae,a0(ge),Ne);if(ge.$$typeof===_)return ye(fe,Ae,e0(fe,ge),Ne);A0(fe,ge)}return null}function _e(fe,Ae,ge,Ne,ht){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return fe=fe.get(ge)||null,L(Ae,fe,""+Ne,ht);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case y:return fe=fe.get(Ne.key===null?ge:Ne.key)||null,te(Ae,fe,Ne,ht);case C:return fe=fe.get(Ne.key===null?ge:Ne.key)||null,pe(Ae,fe,Ne,ht);case G:return Ne=bi(Ne),_e(fe,Ae,ge,Ne,ht)}if(Be(Ne)||q(Ne))return fe=fe.get(ge)||null,Ue(Ae,fe,Ne,ht,null);if(typeof Ne.then=="function")return _e(fe,Ae,ge,a0(Ne),ht);if(Ne.$$typeof===_)return _e(fe,Ae,ge,e0(Ae,Ne),ht);A0(Ae,Ne)}return null}function At(fe,Ae,ge,Ne){for(var ht=null,Zt=null,ut=Ae,It=Ae=0,Vt=null;ut!==null&&It<ge.length;It++){ut.index>It?(Vt=ut,ut=null):Vt=ut.sibling;var er=ye(fe,ut,ge[It],Ne);if(er===null){ut===null&&(ut=Vt);break}A&&ut&&er.alternate===null&&o(fe,ut),Ae=B(er,Ae,It),Zt===null?ht=er:Zt.sibling=er,Zt=er,ut=Vt}if(It===ge.length)return c(fe,ut),Jt&&VA(fe,It),ht;if(ut===null){for(;It<ge.length;It++)ut=Ie(fe,ge[It],Ne),ut!==null&&(Ae=B(ut,Ae,It),Zt===null?ht=ut:Zt.sibling=ut,Zt=ut);return Jt&&VA(fe,It),ht}for(ut=g(ut);It<ge.length;It++)Vt=_e(ut,fe,It,ge[It],Ne),Vt!==null&&(A&&Vt.alternate!==null&&ut.delete(Vt.key===null?It:Vt.key),Ae=B(Vt,Ae,It),Zt===null?ht=Vt:Zt.sibling=Vt,Zt=Vt);return A&&ut.forEach(function(Vs){return o(fe,Vs)}),Jt&&VA(fe,It),ht}function pt(fe,Ae,ge,Ne){if(ge==null)throw Error(n(151));for(var ht=null,Zt=null,ut=Ae,It=Ae=0,Vt=null,er=ge.next();ut!==null&&!er.done;It++,er=ge.next()){ut.index>It?(Vt=ut,ut=null):Vt=ut.sibling;var Vs=ye(fe,ut,er.value,Ne);if(Vs===null){ut===null&&(ut=Vt);break}A&&ut&&Vs.alternate===null&&o(fe,ut),Ae=B(Vs,Ae,It),Zt===null?ht=Vs:Zt.sibling=Vs,Zt=Vs,ut=Vt}if(er.done)return c(fe,ut),Jt&&VA(fe,It),ht;if(ut===null){for(;!er.done;It++,er=ge.next())er=Ie(fe,er.value,Ne),er!==null&&(Ae=B(er,Ae,It),Zt===null?ht=er:Zt.sibling=er,Zt=er);return Jt&&VA(fe,It),ht}for(ut=g(ut);!er.done;It++,er=ge.next())er=_e(ut,fe,It,er.value,Ne),er!==null&&(A&&er.alternate!==null&&ut.delete(er.key===null?It:er.key),Ae=B(er,Ae,It),Zt===null?ht=er:Zt.sibling=er,Zt=er);return A&&ut.forEach(function(WU){return o(fe,WU)}),Jt&&VA(fe,It),ht}function wr(fe,Ae,ge,Ne){if(typeof ge=="object"&&ge!==null&&ge.type===E&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case y:e:{for(var ht=ge.key;Ae!==null;){if(Ae.key===ht){if(ht=ge.type,ht===E){if(Ae.tag===7){c(fe,Ae.sibling),Ne=w(Ae,ge.props.children),Ne.return=fe,fe=Ne;break e}}else if(Ae.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===G&&bi(ht)===Ae.type){c(fe,Ae.sibling),Ne=w(Ae,ge.props),Xl(Ne,ge),Ne.return=fe,fe=Ne;break e}c(fe,Ae);break}else o(fe,Ae);Ae=Ae.sibling}ge.type===E?(Ne=Ci(ge.props.children,fe.mode,Ne,ge.key),Ne.return=fe,fe=Ne):(Ne=qu(ge.type,ge.key,ge.props,null,fe.mode,Ne),Xl(Ne,ge),Ne.return=fe,fe=Ne)}return b(fe);case C:e:{for(ht=ge.key;Ae!==null;){if(Ae.key===ht)if(Ae.tag===4&&Ae.stateNode.containerInfo===ge.containerInfo&&Ae.stateNode.implementation===ge.implementation){c(fe,Ae.sibling),Ne=w(Ae,ge.children||[]),Ne.return=fe,fe=Ne;break e}else{c(fe,Ae);break}else o(fe,Ae);Ae=Ae.sibling}Ne=xh(ge,fe.mode,Ne),Ne.return=fe,fe=Ne}return b(fe);case G:return ge=bi(ge),wr(fe,Ae,ge,Ne)}if(Be(ge))return At(fe,Ae,ge,Ne);if(q(ge)){if(ht=q(ge),typeof ht!="function")throw Error(n(150));return ge=ht.call(ge),pt(fe,Ae,ge,Ne)}if(typeof ge.then=="function")return wr(fe,Ae,a0(ge),Ne);if(ge.$$typeof===_)return wr(fe,Ae,e0(fe,ge),Ne);A0(fe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint"?(ge=""+ge,Ae!==null&&Ae.tag===6?(c(fe,Ae.sibling),Ne=w(Ae,ge),Ne.return=fe,fe=Ne):(c(fe,Ae),Ne=ph(ge,fe.mode,Ne),Ne.return=fe,fe=Ne),b(fe)):c(fe,Ae)}return function(fe,Ae,ge,Ne){try{zl=0;var ht=wr(fe,Ae,ge,Ne);return ko=null,ht}catch(ut){if(ut===Uo||ut===r0)throw ut;var Zt=pa(29,ut,null,fe.mode);return Zt.lanes=Ne,Zt.return=fe,Zt}finally{}}}var Ui=s1(!0),i1=s1(!1),Ss=!1;function Uh(A){A.updateQueue={baseState:A.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kh(A,o){A=A.updateQueue,o.updateQueue===A&&(o.updateQueue={baseState:A.baseState,firstBaseUpdate:A.firstBaseUpdate,lastBaseUpdate:A.lastBaseUpdate,shared:A.shared,callbacks:null})}function _s(A){return{lane:A,tag:0,payload:null,callback:null,next:null}}function bs(A,o,c){var g=A.updateQueue;if(g===null)return null;if(g=g.shared,(Ar&2)!==0){var w=g.pending;return w===null?o.next=o:(o.next=w.next,w.next=o),g.pending=o,o=Yu(A),Kv(A,null,c),o}return Ju(A,g,o,c),Yu(A)}function Wl(A,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var g=o.lanes;g&=A.pendingLanes,c|=g,o.lanes=c,OA(A,c)}}function Nh(A,o){var c=A.updateQueue,g=A.alternate;if(g!==null&&(g=g.updateQueue,c===g)){var w=null,B=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};B===null?w=B=b:B=B.next=b,c=c.next}while(c!==null);B===null?w=B=o:B=B.next=o}else w=B=o;c={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:B,shared:g.shared,callbacks:g.callbacks},A.updateQueue=c;return}A=c.lastBaseUpdate,A===null?c.firstBaseUpdate=o:A.next=o,c.lastBaseUpdate=o}var Ih=!1;function Jl(){if(Ih){var A=Fo;if(A!==null)throw A}}function Yl(A,o,c,g){Ih=!1;var w=A.updateQueue;Ss=!1;var B=w.firstBaseUpdate,b=w.lastBaseUpdate,L=w.shared.pending;if(L!==null){w.shared.pending=null;var te=L,pe=te.next;te.next=null,b===null?B=pe:b.next=pe,b=te;var Ue=A.alternate;Ue!==null&&(Ue=Ue.updateQueue,L=Ue.lastBaseUpdate,L!==b&&(L===null?Ue.firstBaseUpdate=pe:L.next=pe,Ue.lastBaseUpdate=te))}if(B!==null){var Ie=w.baseState;b=0,Ue=pe=te=null,L=B;do{var ye=L.lane&-536870913,_e=ye!==L.lane;if(_e?(Gt&ye)===ye:(g&ye)===ye){ye!==0&&ye===bo&&(Ih=!0),Ue!==null&&(Ue=Ue.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var At=A,pt=L;ye=o;var wr=c;switch(pt.tag){case 1:if(At=pt.payload,typeof At=="function"){Ie=At.call(wr,Ie,ye);break e}Ie=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=pt.payload,ye=typeof At=="function"?At.call(wr,Ie,ye):At,ye==null)break e;Ie=p({},Ie,ye);break e;case 2:Ss=!0}}ye=L.callback,ye!==null&&(A.flags|=64,_e&&(A.flags|=8192),_e=w.callbacks,_e===null?w.callbacks=[ye]:_e.push(ye))}else _e={lane:ye,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Ue===null?(pe=Ue=_e,te=Ie):Ue=Ue.next=_e,b|=ye;if(L=L.next,L===null){if(L=w.shared.pending,L===null)break;_e=L,L=_e.next,_e.next=null,w.lastBaseUpdate=_e,w.shared.pending=null}}while(!0);Ue===null&&(te=Ie),w.baseState=te,w.firstBaseUpdate=pe,w.lastBaseUpdate=Ue,B===null&&(w.shared.lanes=0),Is|=b,A.lanes=b,A.memoizedState=Ie}}function o1(A,o){if(typeof A!="function")throw Error(n(191,A));A.call(o)}function l1(A,o){var c=A.callbacks;if(c!==null)for(A.callbacks=null,A=0;A<c.length;A++)o1(c[A],o)}var No=Y(null),s0=Y(0);function c1(A,o){A=es,K(s0,A),K(No,o),es=A|o.baseLanes}function Qh(){K(s0,es),K(No,No.current)}function Rh(){es=s0.current,Q(No),Q(s0)}var xa=Y(null),La=null;function Fs(A){var o=A.alternate;K(Wr,Wr.current&1),K(xa,A),La===null&&(o===null||No.current!==null||o.memoizedState!==null)&&(La=A)}function Dh(A){K(Wr,Wr.current),K(xa,A),La===null&&(La=A)}function u1(A){A.tag===22?(K(Wr,Wr.current),K(xa,A),La===null&&(La=A)):Us()}function Us(){K(Wr,Wr.current),K(xa,xa.current)}function va(A){Q(xa),La===A&&(La=null),Q(Wr)}var Wr=Y(0);function i0(A){for(var o=A;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Gg(c)||Vg(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===A)break;for(;o.sibling===null;){if(o.return===null||o.return===A)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var zA=0,Ft=null,xr=null,rn=null,o0=!1,Io=!1,ki=!1,l0=0,ql=0,Qo=null,LF=0;function Pr(){throw Error(n(321))}function Mh(A,o){if(o===null)return!1;for(var c=0;c<o.length&&c<A.length;c++)if(!ma(A[c],o[c]))return!1;return!0}function Lh(A,o,c,g,w,B){return zA=B,Ft=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Z.H=A===null||A.memoizedState===null?W1:Zh,ki=!1,B=c(g,w),ki=!1,Io&&(B=d1(o,c,g,w)),f1(A),B}function f1(A){Z.H=ec;var o=xr!==null&&xr.next!==null;if(zA=0,rn=xr=Ft=null,o0=!1,ql=0,Qo=null,o)throw Error(n(300));A===null||nn||(A=A.dependencies,A!==null&&Zu(A)&&(nn=!0))}function d1(A,o,c,g){Ft=A;var w=0;do{if(Io&&(Qo=null),ql=0,Io=!1,25<=w)throw Error(n(301));if(w+=1,rn=xr=null,A.updateQueue!=null){var B=A.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}Z.H=J1,B=o(c,g)}while(Io);return B}function HF(){var A=Z.H,o=A.useState()[0];return o=typeof o.then=="function"?$l(o):o,A=A.useState()[0],(xr!==null?xr.memoizedState:null)!==A&&(Ft.flags|=1024),o}function Hh(){var A=l0!==0;return l0=0,A}function Oh(A,o,c){o.updateQueue=A.updateQueue,o.flags&=-2053,A.lanes&=~c}function Ph(A){if(o0){for(A=A.memoizedState;A!==null;){var o=A.queue;o!==null&&(o.pending=null),A=A.next}o0=!1}zA=0,rn=xr=Ft=null,Io=!1,ql=l0=0,Qo=null}function Yn(){var A={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Ft.memoizedState=rn=A:rn=rn.next=A,rn}function Jr(){if(xr===null){var A=Ft.alternate;A=A!==null?A.memoizedState:null}else A=xr.next;var o=rn===null?Ft.memoizedState:rn.next;if(o!==null)rn=o,xr=A;else{if(A===null)throw Ft.alternate===null?Error(n(467)):Error(n(310));xr=A,A={memoizedState:xr.memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},rn===null?Ft.memoizedState=rn=A:rn=rn.next=A}return rn}function c0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $l(A){var o=ql;return ql+=1,Qo===null&&(Qo=[]),A=n1(Qo,A,o),o=Ft,(rn===null?o.memoizedState:rn.next)===null&&(o=o.alternate,Z.H=o===null||o.memoizedState===null?W1:Zh),A}function u0(A){if(A!==null&&typeof A=="object"){if(typeof A.then=="function")return $l(A);if(A.$$typeof===_)return _n(A)}throw Error(n(438,String(A)))}function Gh(A){var o=null,c=Ft.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var g=Ft.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(o={data:g.data.map(function(w){return w.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=c0(),Ft.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(A),g=0;g<A;g++)c[g]=ee;return o.index++,c}function XA(A,o){return typeof o=="function"?o(A):o}function f0(A){var o=Jr();return Vh(o,xr,A)}function Vh(A,o,c){var g=A.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=c;var w=A.baseQueue,B=g.pending;if(B!==null){if(w!==null){var b=w.next;w.next=B.next,B.next=b}o.baseQueue=w=B,g.pending=null}if(B=A.baseState,w===null)A.memoizedState=B;else{o=w.next;var L=b=null,te=null,pe=o,Ue=!1;do{var Ie=pe.lane&-536870913;if(Ie!==pe.lane?(Gt&Ie)===Ie:(zA&Ie)===Ie){var ye=pe.revertLane;if(ye===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Ie===bo&&(Ue=!0);else if((zA&ye)===ye){pe=pe.next,ye===bo&&(Ue=!0);continue}else Ie={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},te===null?(L=te=Ie,b=B):te=te.next=Ie,Ft.lanes|=ye,Is|=ye;Ie=pe.action,ki&&c(B,Ie),B=pe.hasEagerState?pe.eagerState:c(B,Ie)}else ye={lane:Ie,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},te===null?(L=te=ye,b=B):te=te.next=ye,Ft.lanes|=Ie,Is|=Ie;pe=pe.next}while(pe!==null&&pe!==o);if(te===null?b=B:te.next=L,!ma(B,A.memoizedState)&&(nn=!0,Ue&&(c=Fo,c!==null)))throw c;A.memoizedState=B,A.baseState=b,A.baseQueue=te,g.lastRenderedState=B}return w===null&&(g.lanes=0),[A.memoizedState,g.dispatch]}function Kh(A){var o=Jr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=A;var g=c.dispatch,w=c.pending,B=o.memoizedState;if(w!==null){c.pending=null;var b=w=w.next;do B=A(B,b.action),b=b.next;while(b!==w);ma(B,o.memoizedState)||(nn=!0),o.memoizedState=B,o.baseQueue===null&&(o.baseState=B),c.lastRenderedState=B}return[B,g]}function h1(A,o,c){var g=Ft,w=Jr(),B=Jt;if(B){if(c===void 0)throw Error(n(407));c=c()}else c=o();var b=!ma((xr||w).memoizedState,c);if(b&&(w.memoizedState=c,nn=!0),w=w.queue,Xh(p1.bind(null,g,w,A),[A]),w.getSnapshot!==o||b||rn!==null&&rn.memoizedState.tag&1){if(g.flags|=2048,Ro(9,{destroy:void 0},m1.bind(null,g,w,c,o),null),Cr===null)throw Error(n(349));B||(zA&127)!==0||g1(g,o,c)}return c}function g1(A,o,c){A.flags|=16384,A={getSnapshot:o,value:c},o=Ft.updateQueue,o===null?(o=c0(),Ft.updateQueue=o,o.stores=[A]):(c=o.stores,c===null?o.stores=[A]:c.push(A))}function m1(A,o,c,g){o.value=c,o.getSnapshot=g,x1(o)&&v1(A)}function p1(A,o,c){return c(function(){x1(o)&&v1(A)})}function x1(A){var o=A.getSnapshot;A=A.value;try{var c=o();return!ma(A,c)}catch{return!0}}function v1(A){var o=Bi(A,2);o!==null&&la(o,A,2)}function jh(A){var o=Yn();if(typeof A=="function"){var c=A;if(A=c(),ki){zr(!0);try{c()}finally{zr(!1)}}}return o.memoizedState=o.baseState=A,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:XA,lastRenderedState:A},o}function w1(A,o,c,g){return A.baseState=c,Vh(A,xr,typeof g=="function"?g:XA)}function OF(A,o,c,g,w){if(g0(A))throw Error(n(485));if(A=o.action,A!==null){var B={payload:w,action:A,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){B.listeners.push(b)}};Z.T!==null?c(!0):B.isTransition=!1,g(B),c=o.pending,c===null?(B.next=o.pending=B,y1(o,B)):(B.next=c.next,o.pending=c.next=B)}}function y1(A,o){var c=o.action,g=o.payload,w=A.state;if(o.isTransition){var B=Z.T,b={};Z.T=b;try{var L=c(w,g),te=Z.S;te!==null&&te(b,L),B1(A,o,L)}catch(pe){zh(A,o,pe)}finally{B!==null&&b.types!==null&&(B.types=b.types),Z.T=B}}else try{B=c(w,g),B1(A,o,B)}catch(pe){zh(A,o,pe)}}function B1(A,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(g){C1(A,o,g)},function(g){return zh(A,o,g)}):C1(A,o,c)}function C1(A,o,c){o.status="fulfilled",o.value=c,E1(o),A.state=c,o=A.pending,o!==null&&(c=o.next,c===o?A.pending=null:(c=c.next,o.next=c,y1(A,c)))}function zh(A,o,c){var g=A.pending;if(A.pending=null,g!==null){g=g.next;do o.status="rejected",o.reason=c,E1(o),o=o.next;while(o!==g)}A.action=null}function E1(A){A=A.listeners;for(var o=0;o<A.length;o++)(0,A[o])()}function T1(A,o){return o}function S1(A,o){if(Jt){var c=Cr.formState;if(c!==null){e:{var g=Ft;if(Jt){if(Fr){t:{for(var w=Fr,B=Ma;w.nodeType!==8;){if(!B){w=null;break t}if(w=Ha(w.nextSibling),w===null){w=null;break t}}B=w.data,w=B==="F!"||B==="F"?w:null}if(w){Fr=Ha(w.nextSibling),g=w.data==="F!";break e}}Es(g)}g=!1}g&&(o=c[0])}}return c=Yn(),c.memoizedState=c.baseState=o,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T1,lastRenderedState:o},c.queue=g,c=j1.bind(null,Ft,g),g.dispatch=c,g=jh(!1),B=$h.bind(null,Ft,!1,g.queue),g=Yn(),w={state:o,dispatch:null,action:A,pending:null},g.queue=w,c=OF.bind(null,Ft,w,B,c),w.dispatch=c,g.memoizedState=A,[o,c,!1]}function _1(A){var o=Jr();return b1(o,xr,A)}function b1(A,o,c){if(o=Vh(A,o,T1)[0],A=f0(XA)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var g=$l(o)}catch(b){throw b===Uo?r0:b}else g=o;o=Jr();var w=o.queue,B=w.dispatch;return c!==o.memoizedState&&(Ft.flags|=2048,Ro(9,{destroy:void 0},PF.bind(null,w,c),null)),[g,B,A]}function PF(A,o){A.action=o}function F1(A){var o=Jr(),c=xr;if(c!==null)return b1(o,c,A);Jr(),o=o.memoizedState,c=Jr();var g=c.queue.dispatch;return c.memoizedState=A,[o,g,!1]}function Ro(A,o,c,g){return A={tag:A,create:c,deps:g,inst:o,next:null},o=Ft.updateQueue,o===null&&(o=c0(),Ft.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=A.next=A:(g=c.next,c.next=A,A.next=g,o.lastEffect=A),A}function U1(){return Jr().memoizedState}function d0(A,o,c,g){var w=Yn();Ft.flags|=A,w.memoizedState=Ro(1|o,{destroy:void 0},c,g===void 0?null:g)}function h0(A,o,c,g){var w=Jr();g=g===void 0?null:g;var B=w.memoizedState.inst;xr!==null&&g!==null&&Mh(g,xr.memoizedState.deps)?w.memoizedState=Ro(o,B,c,g):(Ft.flags|=A,w.memoizedState=Ro(1|o,B,c,g))}function k1(A,o){d0(8390656,8,A,o)}function Xh(A,o){h0(2048,8,A,o)}function GF(A){Ft.flags|=4;var o=Ft.updateQueue;if(o===null)o=c0(),Ft.updateQueue=o,o.events=[A];else{var c=o.events;c===null?o.events=[A]:c.push(A)}}function N1(A){var o=Jr().memoizedState;return GF({ref:o,nextImpl:A}),function(){if((Ar&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function I1(A,o){return h0(4,2,A,o)}function Q1(A,o){return h0(4,4,A,o)}function R1(A,o){if(typeof o=="function"){A=A();var c=o(A);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return A=A(),o.current=A,function(){o.current=null}}function D1(A,o,c){c=c!=null?c.concat([A]):null,h0(4,4,R1.bind(null,o,A),c)}function Wh(){}function M1(A,o){var c=Jr();o=o===void 0?null:o;var g=c.memoizedState;return o!==null&&Mh(o,g[1])?g[0]:(c.memoizedState=[A,o],A)}function L1(A,o){var c=Jr();o=o===void 0?null:o;var g=c.memoizedState;if(o!==null&&Mh(o,g[1]))return g[0];if(g=A(),ki){zr(!0);try{A()}finally{zr(!1)}}return c.memoizedState=[g,o],g}function Jh(A,o,c){return c===void 0||(zA&1073741824)!==0&&(Gt&261930)===0?A.memoizedState=o:(A.memoizedState=c,A=Hw(),Ft.lanes|=A,Is|=A,c)}function H1(A,o,c,g){return ma(c,o)?c:No.current!==null?(A=Jh(A,c,g),ma(A,o)||(nn=!0),A):(zA&42)===0||(zA&1073741824)!==0&&(Gt&261930)===0?(nn=!0,A.memoizedState=c):(A=Hw(),Ft.lanes|=A,Is|=A,o)}function O1(A,o,c,g,w){var B=ie.p;ie.p=B!==0&&8>B?B:8;var b=Z.T,L={};Z.T=L,$h(A,!1,o,c);try{var te=w(),pe=Z.S;if(pe!==null&&pe(L,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Ue=MF(te,g);Zl(A,o,Ue,Ba(A))}else Zl(A,o,g,Ba(A))}catch(Ie){Zl(A,o,{then:function(){},status:"rejected",reason:Ie},Ba())}finally{ie.p=B,b!==null&&L.types!==null&&(b.types=L.types),Z.T=b}}function VF(){}function Yh(A,o,c,g){if(A.tag!==5)throw Error(n(476));var w=P1(A).queue;O1(A,w,o,Qe,c===null?VF:function(){return G1(A),c(g)})}function P1(A){var o=A.memoizedState;if(o!==null)return o;o={memoizedState:Qe,baseState:Qe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:XA,lastRenderedState:Qe},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:XA,lastRenderedState:c},next:null},A.memoizedState=o,A=A.alternate,A!==null&&(A.memoizedState=o),o}function G1(A){var o=P1(A);o.next===null&&(o=A.alternate.memoizedState),Zl(A,o.next.queue,{},Ba())}function qh(){return _n(mc)}function V1(){return Jr().memoizedState}function K1(){return Jr().memoizedState}function KF(A){for(var o=A.return;o!==null;){switch(o.tag){case 24:case 3:var c=Ba();A=_s(c);var g=bs(o,A,c);g!==null&&(la(g,o,c),Wl(g,o,c)),o={cache:Sh()},A.payload=o;return}o=o.return}}function jF(A,o,c){var g=Ba();c={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},g0(A)?z1(o,c):(c=gh(A,o,c,g),c!==null&&(la(c,A,g),X1(c,o,g)))}function j1(A,o,c){var g=Ba();Zl(A,o,c,g)}function Zl(A,o,c,g){var w={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(g0(A))z1(o,w);else{var B=A.alternate;if(A.lanes===0&&(B===null||B.lanes===0)&&(B=o.lastRenderedReducer,B!==null))try{var b=o.lastRenderedState,L=B(b,c);if(w.hasEagerState=!0,w.eagerState=L,ma(L,b))return Ju(A,o,w,0),Cr===null&&Wu(),!1}catch{}finally{}if(c=gh(A,o,w,g),c!==null)return la(c,A,g),X1(c,o,g),!0}return!1}function $h(A,o,c,g){if(g={lane:2,revertLane:Ug(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},g0(A)){if(o)throw Error(n(479))}else o=gh(A,c,g,2),o!==null&&la(o,A,2)}function g0(A){var o=A.alternate;return A===Ft||o!==null&&o===Ft}function z1(A,o){Io=o0=!0;var c=A.pending;c===null?o.next=o:(o.next=c.next,c.next=o),A.pending=o}function X1(A,o,c){if((c&4194048)!==0){var g=o.lanes;g&=A.pendingLanes,c|=g,o.lanes=c,OA(A,c)}}var ec={readContext:_n,use:u0,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useLayoutEffect:Pr,useInsertionEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useSyncExternalStore:Pr,useId:Pr,useHostTransitionStatus:Pr,useFormState:Pr,useActionState:Pr,useOptimistic:Pr,useMemoCache:Pr,useCacheRefresh:Pr};ec.useEffectEvent=Pr;var W1={readContext:_n,use:u0,useCallback:function(A,o){return Yn().memoizedState=[A,o===void 0?null:o],A},useContext:_n,useEffect:k1,useImperativeHandle:function(A,o,c){c=c!=null?c.concat([A]):null,d0(4194308,4,R1.bind(null,o,A),c)},useLayoutEffect:function(A,o){return d0(4194308,4,A,o)},useInsertionEffect:function(A,o){d0(4,2,A,o)},useMemo:function(A,o){var c=Yn();o=o===void 0?null:o;var g=A();if(ki){zr(!0);try{A()}finally{zr(!1)}}return c.memoizedState=[g,o],g},useReducer:function(A,o,c){var g=Yn();if(c!==void 0){var w=c(o);if(ki){zr(!0);try{c(o)}finally{zr(!1)}}}else w=o;return g.memoizedState=g.baseState=w,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:w},g.queue=A,A=A.dispatch=jF.bind(null,Ft,A),[g.memoizedState,A]},useRef:function(A){var o=Yn();return A={current:A},o.memoizedState=A},useState:function(A){A=jh(A);var o=A.queue,c=j1.bind(null,Ft,o);return o.dispatch=c,[A.memoizedState,c]},useDebugValue:Wh,useDeferredValue:function(A,o){var c=Yn();return Jh(c,A,o)},useTransition:function(){var A=jh(!1);return A=O1.bind(null,Ft,A.queue,!0,!1),Yn().memoizedState=A,[!1,A]},useSyncExternalStore:function(A,o,c){var g=Ft,w=Yn();if(Jt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),Cr===null)throw Error(n(349));(Gt&127)!==0||g1(g,o,c)}w.memoizedState=c;var B={value:c,getSnapshot:o};return w.queue=B,k1(p1.bind(null,g,B,A),[A]),g.flags|=2048,Ro(9,{destroy:void 0},m1.bind(null,g,B,c,o),null),c},useId:function(){var A=Yn(),o=Cr.identifierPrefix;if(Jt){var c=yA,g=wA;c=(g&~(1<<32-Sr(g)-1)).toString(32)+c,o="_"+o+"R_"+c,c=l0++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=LF++,o="_"+o+"r_"+c.toString(32)+"_";return A.memoizedState=o},useHostTransitionStatus:qh,useFormState:S1,useActionState:S1,useOptimistic:function(A){var o=Yn();o.memoizedState=o.baseState=A;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=$h.bind(null,Ft,!0,c),c.dispatch=o,[A,o]},useMemoCache:Gh,useCacheRefresh:function(){return Yn().memoizedState=KF.bind(null,Ft)},useEffectEvent:function(A){var o=Yn(),c={impl:A};return o.memoizedState=c,function(){if((Ar&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Zh={readContext:_n,use:u0,useCallback:M1,useContext:_n,useEffect:Xh,useImperativeHandle:D1,useInsertionEffect:I1,useLayoutEffect:Q1,useMemo:L1,useReducer:f0,useRef:U1,useState:function(){return f0(XA)},useDebugValue:Wh,useDeferredValue:function(A,o){var c=Jr();return H1(c,xr.memoizedState,A,o)},useTransition:function(){var A=f0(XA)[0],o=Jr().memoizedState;return[typeof A=="boolean"?A:$l(A),o]},useSyncExternalStore:h1,useId:V1,useHostTransitionStatus:qh,useFormState:_1,useActionState:_1,useOptimistic:function(A,o){var c=Jr();return w1(c,xr,A,o)},useMemoCache:Gh,useCacheRefresh:K1};Zh.useEffectEvent=N1;var J1={readContext:_n,use:u0,useCallback:M1,useContext:_n,useEffect:Xh,useImperativeHandle:D1,useInsertionEffect:I1,useLayoutEffect:Q1,useMemo:L1,useReducer:Kh,useRef:U1,useState:function(){return Kh(XA)},useDebugValue:Wh,useDeferredValue:function(A,o){var c=Jr();return xr===null?Jh(c,A,o):H1(c,xr.memoizedState,A,o)},useTransition:function(){var A=Kh(XA)[0],o=Jr().memoizedState;return[typeof A=="boolean"?A:$l(A),o]},useSyncExternalStore:h1,useId:V1,useHostTransitionStatus:qh,useFormState:F1,useActionState:F1,useOptimistic:function(A,o){var c=Jr();return xr!==null?w1(c,xr,A,o):(c.baseState=A,[A,c.queue.dispatch])},useMemoCache:Gh,useCacheRefresh:K1};J1.useEffectEvent=N1;function eg(A,o,c,g){o=A.memoizedState,c=c(g,o),c=c==null?o:p({},o,c),A.memoizedState=c,A.lanes===0&&(A.updateQueue.baseState=c)}var tg={enqueueSetState:function(A,o,c){A=A._reactInternals;var g=Ba(),w=_s(g);w.payload=o,c!=null&&(w.callback=c),o=bs(A,w,g),o!==null&&(la(o,A,g),Wl(o,A,g))},enqueueReplaceState:function(A,o,c){A=A._reactInternals;var g=Ba(),w=_s(g);w.tag=1,w.payload=o,c!=null&&(w.callback=c),o=bs(A,w,g),o!==null&&(la(o,A,g),Wl(o,A,g))},enqueueForceUpdate:function(A,o){A=A._reactInternals;var c=Ba(),g=_s(c);g.tag=2,o!=null&&(g.callback=o),o=bs(A,g,c),o!==null&&(la(o,A,c),Wl(o,A,c))}};function Y1(A,o,c,g,w,B,b){return A=A.stateNode,typeof A.shouldComponentUpdate=="function"?A.shouldComponentUpdate(g,B,b):o.prototype&&o.prototype.isPureReactComponent?!Ol(c,g)||!Ol(w,B):!0}function q1(A,o,c,g){A=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,g),o.state!==A&&tg.enqueueReplaceState(o,o.state,null)}function Ni(A,o){var c=o;if("ref"in o){c={};for(var g in o)g!=="ref"&&(c[g]=o[g])}if(A=A.defaultProps){c===o&&(c=p({},c));for(var w in A)c[w]===void 0&&(c[w]=A[w])}return c}function $1(A){Xu(A)}function Z1(A){console.error(A)}function ew(A){Xu(A)}function m0(A,o){try{var c=A.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(g){setTimeout(function(){throw g})}}function tw(A,o,c){try{var g=A.onCaughtError;g(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function rg(A,o,c){return c=_s(c),c.tag=3,c.payload={element:null},c.callback=function(){m0(A,o)},c}function rw(A){return A=_s(A),A.tag=3,A}function nw(A,o,c,g){var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var B=g.value;A.payload=function(){return w(B)},A.callback=function(){tw(o,c,g)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(A.callback=function(){tw(o,c,g),typeof w!="function"&&(Qs===null?Qs=new Set([this]):Qs.add(this));var L=g.stack;this.componentDidCatch(g.value,{componentStack:L!==null?L:""})})}function zF(A,o,c,g,w){if(c.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(o=c.alternate,o!==null&&_o(o,c,w,!0),c=xa.current,c!==null){switch(c.tag){case 31:case 13:return La===null?b0():c.alternate===null&&Gr===0&&(Gr=3),c.flags&=-257,c.flags|=65536,c.lanes=w,g===n0?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([g]):o.add(g),_g(A,g,w)),!1;case 22:return c.flags|=65536,g===n0?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([g])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([g]):c.add(g)),_g(A,g,w)),!1}throw Error(n(435,c.tag))}return _g(A,g,w),b0(),!1}if(Jt)return o=xa.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=w,g!==yh&&(A=Error(n(422),{cause:g}),Vl(Qa(A,c)))):(g!==yh&&(o=Error(n(423),{cause:g}),Vl(Qa(o,c))),A=A.current.alternate,A.flags|=65536,w&=-w,A.lanes|=w,g=Qa(g,c),w=rg(A.stateNode,g,w),Nh(A,w),Gr!==4&&(Gr=2)),!1;var B=Error(n(520),{cause:g});if(B=Qa(B,c),oc===null?oc=[B]:oc.push(B),Gr!==4&&(Gr=2),o===null)return!0;g=Qa(g,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,A=w&-w,c.lanes|=A,A=rg(c.stateNode,g,A),Nh(c,A),!1;case 1:if(o=c.type,B=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Qs===null||!Qs.has(B))))return c.flags|=65536,w&=-w,c.lanes|=w,w=rw(w),nw(w,A,c,g),Nh(c,w),!1}c=c.return}while(c!==null);return!1}var ng=Error(n(461)),nn=!1;function bn(A,o,c,g){o.child=A===null?i1(o,null,c,g):Ui(o,A.child,c,g)}function aw(A,o,c,g,w){c=c.render;var B=o.ref;if("ref"in g){var b={};for(var L in g)L!=="ref"&&(b[L]=g[L])}else b=g;return Si(o),g=Lh(A,o,c,b,B,w),L=Hh(),A!==null&&!nn?(Oh(A,o,w),WA(A,o,w)):(Jt&&L&&vh(o),o.flags|=1,bn(A,o,g,w),o.child)}function Aw(A,o,c,g,w){if(A===null){var B=c.type;return typeof B=="function"&&!mh(B)&&B.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=B,sw(A,o,B,g,w)):(A=qu(c.type,null,g,o,o.mode,w),A.ref=o.ref,A.return=o,o.child=A)}if(B=A.child,!ug(A,w)){var b=B.memoizedProps;if(c=c.compare,c=c!==null?c:Ol,c(b,g)&&A.ref===o.ref)return WA(A,o,w)}return o.flags|=1,A=GA(B,g),A.ref=o.ref,A.return=o,o.child=A}function sw(A,o,c,g,w){if(A!==null){var B=A.memoizedProps;if(Ol(B,g)&&A.ref===o.ref)if(nn=!1,o.pendingProps=g=B,ug(A,w))(A.flags&131072)!==0&&(nn=!0);else return o.lanes=A.lanes,WA(A,o,w)}return ag(A,o,c,g,w)}function iw(A,o,c,g){var w=g.children,B=A!==null?A.memoizedState:null;if(A===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((o.flags&128)!==0){if(B=B!==null?B.baseLanes|c:c,A!==null){for(g=o.child=A.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;g=w&~B}else g=0,o.child=null;return ow(A,o,B,c,g)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},A!==null&&t0(o,B!==null?B.cachePool:null),B!==null?c1(o,B):Qh(),u1(o);else return g=o.lanes=536870912,ow(A,o,B!==null?B.baseLanes|c:c,c,g)}else B!==null?(t0(o,B.cachePool),c1(o,B),Us(),o.memoizedState=null):(A!==null&&t0(o,null),Qh(),Us());return bn(A,o,w,c),o.child}function tc(A,o){return A!==null&&A.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function ow(A,o,c,g,w){var B=bh();return B=B===null?null:{parent:tn._currentValue,pool:B},o.memoizedState={baseLanes:c,cachePool:B},A!==null&&t0(o,null),Qh(),u1(o),A!==null&&_o(A,o,g,!0),o.childLanes=w,null}function p0(A,o){return o=v0({mode:o.mode,children:o.children},A.mode),o.ref=A.ref,A.child=o,o.return=A,o}function lw(A,o,c){return Ui(o,A.child,null,c),A=p0(o,o.pendingProps),A.flags|=2,va(o),o.memoizedState=null,A}function XF(A,o,c){var g=o.pendingProps,w=(o.flags&128)!==0;if(o.flags&=-129,A===null){if(Jt){if(g.mode==="hidden")return A=p0(o,g),o.lanes=536870912,tc(null,A);if(Dh(o),(A=Fr)?(A=yy(A,Ma),A=A!==null&&A.data==="&"?A:null,A!==null&&(o.memoizedState={dehydrated:A,treeContext:Bs!==null?{id:wA,overflow:yA}:null,retryLane:536870912,hydrationErrors:null},c=zv(A),c.return=o,o.child=c,Sn=o,Fr=null)):A=null,A===null)throw Es(o);return o.lanes=536870912,null}return p0(o,g)}var B=A.memoizedState;if(B!==null){var b=B.dehydrated;if(Dh(o),w)if(o.flags&256)o.flags&=-257,o=lw(A,o,c);else if(o.memoizedState!==null)o.child=A.child,o.flags|=128,o=null;else throw Error(n(558));else if(nn||_o(A,o,c,!1),w=(c&A.childLanes)!==0,nn||w){if(g=Cr,g!==null&&(b=go(g,c),b!==0&&b!==B.retryLane))throw B.retryLane=b,Bi(A,b),la(g,A,b),ng;b0(),o=lw(A,o,c)}else A=B.treeContext,Fr=Ha(b.nextSibling),Sn=o,Jt=!0,Cs=null,Ma=!1,A!==null&&Jv(o,A),o=p0(o,g),o.flags|=4096;return o}return A=GA(A.child,{mode:g.mode,children:g.children}),A.ref=o.ref,o.child=A,A.return=o,A}function x0(A,o){var c=o.ref;if(c===null)A!==null&&A.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(A===null||A.ref!==c)&&(o.flags|=4194816)}}function ag(A,o,c,g,w){return Si(o),c=Lh(A,o,c,g,void 0,w),g=Hh(),A!==null&&!nn?(Oh(A,o,w),WA(A,o,w)):(Jt&&g&&vh(o),o.flags|=1,bn(A,o,c,w),o.child)}function cw(A,o,c,g,w,B){return Si(o),o.updateQueue=null,c=d1(o,g,c,w),f1(A),g=Hh(),A!==null&&!nn?(Oh(A,o,B),WA(A,o,B)):(Jt&&g&&vh(o),o.flags|=1,bn(A,o,c,B),o.child)}function uw(A,o,c,g,w){if(Si(o),o.stateNode===null){var B=Co,b=c.contextType;typeof b=="object"&&b!==null&&(B=_n(b)),B=new c(g,B),o.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=tg,o.stateNode=B,B._reactInternals=o,B=o.stateNode,B.props=g,B.state=o.memoizedState,B.refs={},Uh(o),b=c.contextType,B.context=typeof b=="object"&&b!==null?_n(b):Co,B.state=o.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(eg(o,c,b,g),B.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(b=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),b!==B.state&&tg.enqueueReplaceState(B,B.state,null),Yl(o,g,B,w),Jl(),B.state=o.memoizedState),typeof B.componentDidMount=="function"&&(o.flags|=4194308),g=!0}else if(A===null){B=o.stateNode;var L=o.memoizedProps,te=Ni(c,L);B.props=te;var pe=B.context,Ue=c.contextType;b=Co,typeof Ue=="object"&&Ue!==null&&(b=_n(Ue));var Ie=c.getDerivedStateFromProps;Ue=typeof Ie=="function"||typeof B.getSnapshotBeforeUpdate=="function",L=o.pendingProps!==L,Ue||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(L||pe!==b)&&q1(o,B,g,b),Ss=!1;var ye=o.memoizedState;B.state=ye,Yl(o,g,B,w),Jl(),pe=o.memoizedState,L||ye!==pe||Ss?(typeof Ie=="function"&&(eg(o,c,Ie,g),pe=o.memoizedState),(te=Ss||Y1(o,c,te,g,ye,pe,b))?(Ue||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(o.flags|=4194308)):(typeof B.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=pe),B.props=g,B.state=pe,B.context=b,g=te):(typeof B.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{B=o.stateNode,kh(A,o),b=o.memoizedProps,Ue=Ni(c,b),B.props=Ue,Ie=o.pendingProps,ye=B.context,pe=c.contextType,te=Co,typeof pe=="object"&&pe!==null&&(te=_n(pe)),L=c.getDerivedStateFromProps,(pe=typeof L=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(b!==Ie||ye!==te)&&q1(o,B,g,te),Ss=!1,ye=o.memoizedState,B.state=ye,Yl(o,g,B,w),Jl();var _e=o.memoizedState;b!==Ie||ye!==_e||Ss||A!==null&&A.dependencies!==null&&Zu(A.dependencies)?(typeof L=="function"&&(eg(o,c,L,g),_e=o.memoizedState),(Ue=Ss||Y1(o,c,Ue,g,ye,_e,te)||A!==null&&A.dependencies!==null&&Zu(A.dependencies))?(pe||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(g,_e,te),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(g,_e,te)),typeof B.componentDidUpdate=="function"&&(o.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof B.componentDidUpdate!="function"||b===A.memoizedProps&&ye===A.memoizedState||(o.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||b===A.memoizedProps&&ye===A.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=_e),B.props=g,B.state=_e,B.context=te,g=Ue):(typeof B.componentDidUpdate!="function"||b===A.memoizedProps&&ye===A.memoizedState||(o.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||b===A.memoizedProps&&ye===A.memoizedState||(o.flags|=1024),g=!1)}return B=g,x0(A,o),g=(o.flags&128)!==0,B||g?(B=o.stateNode,c=g&&typeof c.getDerivedStateFromError!="function"?null:B.render(),o.flags|=1,A!==null&&g?(o.child=Ui(o,A.child,null,w),o.child=Ui(o,null,c,w)):bn(A,o,c,w),o.memoizedState=B.state,A=o.child):A=WA(A,o,w),A}function fw(A,o,c,g){return Ei(),o.flags|=256,bn(A,o,c,g),o.child}var Ag={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sg(A){return{baseLanes:A,cachePool:t1()}}function ig(A,o,c){return A=A!==null?A.childLanes&~c:0,o&&(A|=ya),A}function dw(A,o,c){var g=o.pendingProps,w=!1,B=(o.flags&128)!==0,b;if((b=B)||(b=A!==null&&A.memoizedState===null?!1:(Wr.current&2)!==0),b&&(w=!0,o.flags&=-129),b=(o.flags&32)!==0,o.flags&=-33,A===null){if(Jt){if(w?Fs(o):Us(),(A=Fr)?(A=yy(A,Ma),A=A!==null&&A.data!=="&"?A:null,A!==null&&(o.memoizedState={dehydrated:A,treeContext:Bs!==null?{id:wA,overflow:yA}:null,retryLane:536870912,hydrationErrors:null},c=zv(A),c.return=o,o.child=c,Sn=o,Fr=null)):A=null,A===null)throw Es(o);return Vg(A)?o.lanes=32:o.lanes=536870912,null}var L=g.children;return g=g.fallback,w?(Us(),w=o.mode,L=v0({mode:"hidden",children:L},w),g=Ci(g,w,c,null),L.return=o,g.return=o,L.sibling=g,o.child=L,g=o.child,g.memoizedState=sg(c),g.childLanes=ig(A,b,c),o.memoizedState=Ag,tc(null,g)):(Fs(o),og(o,L))}var te=A.memoizedState;if(te!==null&&(L=te.dehydrated,L!==null)){if(B)o.flags&256?(Fs(o),o.flags&=-257,o=lg(A,o,c)):o.memoizedState!==null?(Us(),o.child=A.child,o.flags|=128,o=null):(Us(),L=g.fallback,w=o.mode,g=v0({mode:"visible",children:g.children},w),L=Ci(L,w,c,null),L.flags|=2,g.return=o,L.return=o,g.sibling=L,o.child=g,Ui(o,A.child,null,c),g=o.child,g.memoizedState=sg(c),g.childLanes=ig(A,b,c),o.memoizedState=Ag,o=tc(null,g));else if(Fs(o),Vg(L)){if(b=L.nextSibling&&L.nextSibling.dataset,b)var pe=b.dgst;b=pe,g=Error(n(419)),g.stack="",g.digest=b,Vl({value:g,source:null,stack:null}),o=lg(A,o,c)}else if(nn||_o(A,o,c,!1),b=(c&A.childLanes)!==0,nn||b){if(b=Cr,b!==null&&(g=go(b,c),g!==0&&g!==te.retryLane))throw te.retryLane=g,Bi(A,g),la(b,A,g),ng;Gg(L)||b0(),o=lg(A,o,c)}else Gg(L)?(o.flags|=192,o.child=A.child,o=null):(A=te.treeContext,Fr=Ha(L.nextSibling),Sn=o,Jt=!0,Cs=null,Ma=!1,A!==null&&Jv(o,A),o=og(o,g.children),o.flags|=4096);return o}return w?(Us(),L=g.fallback,w=o.mode,te=A.child,pe=te.sibling,g=GA(te,{mode:"hidden",children:g.children}),g.subtreeFlags=te.subtreeFlags&65011712,pe!==null?L=GA(pe,L):(L=Ci(L,w,c,null),L.flags|=2),L.return=o,g.return=o,g.sibling=L,o.child=g,tc(null,g),g=o.child,L=A.child.memoizedState,L===null?L=sg(c):(w=L.cachePool,w!==null?(te=tn._currentValue,w=w.parent!==te?{parent:te,pool:te}:w):w=t1(),L={baseLanes:L.baseLanes|c,cachePool:w}),g.memoizedState=L,g.childLanes=ig(A,b,c),o.memoizedState=Ag,tc(A.child,g)):(Fs(o),c=A.child,A=c.sibling,c=GA(c,{mode:"visible",children:g.children}),c.return=o,c.sibling=null,A!==null&&(b=o.deletions,b===null?(o.deletions=[A],o.flags|=16):b.push(A)),o.child=c,o.memoizedState=null,c)}function og(A,o){return o=v0({mode:"visible",children:o},A.mode),o.return=A,A.child=o}function v0(A,o){return A=pa(22,A,null,o),A.lanes=0,A}function lg(A,o,c){return Ui(o,A.child,null,c),A=og(o,o.pendingProps.children),A.flags|=2,o.memoizedState=null,A}function hw(A,o,c){A.lanes|=o;var g=A.alternate;g!==null&&(g.lanes|=o),Eh(A.return,o,c)}function cg(A,o,c,g,w,B){var b=A.memoizedState;b===null?A.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:c,tailMode:w,treeForkCount:B}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=g,b.tail=c,b.tailMode=w,b.treeForkCount=B)}function gw(A,o,c){var g=o.pendingProps,w=g.revealOrder,B=g.tail;g=g.children;var b=Wr.current,L=(b&2)!==0;if(L?(b=b&1|2,o.flags|=128):b&=1,K(Wr,b),bn(A,o,g,c),g=Jt?Gl:0,!L&&A!==null&&(A.flags&128)!==0)e:for(A=o.child;A!==null;){if(A.tag===13)A.memoizedState!==null&&hw(A,c,o);else if(A.tag===19)hw(A,c,o);else if(A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break e;for(;A.sibling===null;){if(A.return===null||A.return===o)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}switch(w){case"forwards":for(c=o.child,w=null;c!==null;)A=c.alternate,A!==null&&i0(A)===null&&(w=c),c=c.sibling;c=w,c===null?(w=o.child,o.child=null):(w=c.sibling,c.sibling=null),cg(o,!1,w,c,B,g);break;case"backwards":case"unstable_legacy-backwards":for(c=null,w=o.child,o.child=null;w!==null;){if(A=w.alternate,A!==null&&i0(A)===null){o.child=w;break}A=w.sibling,w.sibling=c,c=w,w=A}cg(o,!0,c,null,B,g);break;case"together":cg(o,!1,null,null,void 0,g);break;default:o.memoizedState=null}return o.child}function WA(A,o,c){if(A!==null&&(o.dependencies=A.dependencies),Is|=o.lanes,(c&o.childLanes)===0)if(A!==null){if(_o(A,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(A!==null&&o.child!==A.child)throw Error(n(153));if(o.child!==null){for(A=o.child,c=GA(A,A.pendingProps),o.child=c,c.return=o;A.sibling!==null;)A=A.sibling,c=c.sibling=GA(A,A.pendingProps),c.return=o;c.sibling=null}return o.child}function ug(A,o){return(A.lanes&o)!==0?!0:(A=A.dependencies,!!(A!==null&&Zu(A)))}function WF(A,o,c){switch(o.tag){case 3:he(o,o.stateNode.containerInfo),Ts(o,tn,A.memoizedState.cache),Ei();break;case 27:case 5:ne(o);break;case 4:he(o,o.stateNode.containerInfo);break;case 10:Ts(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Dh(o),null;break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(Fs(o),o.flags|=128,null):(c&o.child.childLanes)!==0?dw(A,o,c):(Fs(o),A=WA(A,o,c),A!==null?A.sibling:null);Fs(o);break;case 19:var w=(A.flags&128)!==0;if(g=(c&o.childLanes)!==0,g||(_o(A,o,c,!1),g=(c&o.childLanes)!==0),w){if(g)return gw(A,o,c);o.flags|=128}if(w=o.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),K(Wr,Wr.current),g)break;return null;case 22:return o.lanes=0,iw(A,o,c,o.pendingProps);case 24:Ts(o,tn,A.memoizedState.cache)}return WA(A,o,c)}function mw(A,o,c){if(A!==null)if(A.memoizedProps!==o.pendingProps)nn=!0;else{if(!ug(A,c)&&(o.flags&128)===0)return nn=!1,WF(A,o,c);nn=(A.flags&131072)!==0}else nn=!1,Jt&&(o.flags&1048576)!==0&&Wv(o,Gl,o.index);switch(o.lanes=0,o.tag){case 16:e:{var g=o.pendingProps;if(A=bi(o.elementType),o.type=A,typeof A=="function")mh(A)?(g=Ni(A,g),o.tag=1,o=uw(null,o,A,g,c)):(o.tag=0,o=ag(null,o,A,g,c));else{if(A!=null){var w=A.$$typeof;if(w===N){o.tag=11,o=aw(null,o,A,g,c);break e}else if(w===k){o.tag=14,o=Aw(null,o,A,g,c);break e}}throw o=Te(A)||A,Error(n(306,o,""))}}return o;case 0:return ag(A,o,o.type,o.pendingProps,c);case 1:return g=o.type,w=Ni(g,o.pendingProps),uw(A,o,g,w,c);case 3:e:{if(he(o,o.stateNode.containerInfo),A===null)throw Error(n(387));g=o.pendingProps;var B=o.memoizedState;w=B.element,kh(A,o),Yl(o,g,null,c);var b=o.memoizedState;if(g=b.cache,Ts(o,tn,g),g!==B.cache&&Th(o,[tn],c,!0),Jl(),g=b.element,B.isDehydrated)if(B={element:g,isDehydrated:!1,cache:b.cache},o.updateQueue.baseState=B,o.memoizedState=B,o.flags&256){o=fw(A,o,g,c);break e}else if(g!==w){w=Qa(Error(n(424)),o),Vl(w),o=fw(A,o,g,c);break e}else{switch(A=o.stateNode.containerInfo,A.nodeType){case 9:A=A.body;break;default:A=A.nodeName==="HTML"?A.ownerDocument.body:A}for(Fr=Ha(A.firstChild),Sn=o,Jt=!0,Cs=null,Ma=!0,c=i1(o,null,g,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ei(),g===w){o=WA(A,o,c);break e}bn(A,o,g,c)}o=o.child}return o;case 26:return x0(A,o),A===null?(c=_y(o.type,null,o.pendingProps,null))?o.memoizedState=c:Jt||(c=o.type,A=o.pendingProps,g=R0(ce.current).createElement(c),g[O]=o,g[V]=A,Fn(g,c,A),ot(g),o.stateNode=g):o.memoizedState=_y(o.type,A.memoizedProps,o.pendingProps,A.memoizedState),null;case 27:return ne(o),A===null&&Jt&&(g=o.stateNode=Ey(o.type,o.pendingProps,ce.current),Sn=o,Ma=!0,w=Fr,Ls(o.type)?(Kg=w,Fr=Ha(g.firstChild)):Fr=w),bn(A,o,o.pendingProps.children,c),x0(A,o),A===null&&(o.flags|=4194304),o.child;case 5:return A===null&&Jt&&((w=g=Fr)&&(g=EU(g,o.type,o.pendingProps,Ma),g!==null?(o.stateNode=g,Sn=o,Fr=Ha(g.firstChild),Ma=!1,w=!0):w=!1),w||Es(o)),ne(o),w=o.type,B=o.pendingProps,b=A!==null?A.memoizedProps:null,g=B.children,Hg(w,B)?g=null:b!==null&&Hg(w,b)&&(o.flags|=32),o.memoizedState!==null&&(w=Lh(A,o,HF,null,null,c),mc._currentValue=w),x0(A,o),bn(A,o,g,c),o.child;case 6:return A===null&&Jt&&((A=c=Fr)&&(c=TU(c,o.pendingProps,Ma),c!==null?(o.stateNode=c,Sn=o,Fr=null,A=!0):A=!1),A||Es(o)),null;case 13:return dw(A,o,c);case 4:return he(o,o.stateNode.containerInfo),g=o.pendingProps,A===null?o.child=Ui(o,null,g,c):bn(A,o,g,c),o.child;case 11:return aw(A,o,o.type,o.pendingProps,c);case 7:return bn(A,o,o.pendingProps,c),o.child;case 8:return bn(A,o,o.pendingProps.children,c),o.child;case 12:return bn(A,o,o.pendingProps.children,c),o.child;case 10:return g=o.pendingProps,Ts(o,o.type,g.value),bn(A,o,g.children,c),o.child;case 9:return w=o.type._context,g=o.pendingProps.children,Si(o),w=_n(w),g=g(w),o.flags|=1,bn(A,o,g,c),o.child;case 14:return Aw(A,o,o.type,o.pendingProps,c);case 15:return sw(A,o,o.type,o.pendingProps,c);case 19:return gw(A,o,c);case 31:return XF(A,o,c);case 22:return iw(A,o,c,o.pendingProps);case 24:return Si(o),g=_n(tn),A===null?(w=bh(),w===null&&(w=Cr,B=Sh(),w.pooledCache=B,B.refCount++,B!==null&&(w.pooledCacheLanes|=c),w=B),o.memoizedState={parent:g,cache:w},Uh(o),Ts(o,tn,w)):((A.lanes&c)!==0&&(kh(A,o),Yl(o,null,null,c),Jl()),w=A.memoizedState,B=o.memoizedState,w.parent!==g?(w={parent:g,cache:g},o.memoizedState=w,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=w),Ts(o,tn,g)):(g=B.cache,Ts(o,tn,g),g!==w.cache&&Th(o,[tn],c,!0))),bn(A,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function JA(A){A.flags|=4}function fg(A,o,c,g,w){if((o=(A.mode&32)!==0)&&(o=!1),o){if(A.flags|=16777216,(w&335544128)===w)if(A.stateNode.complete)A.flags|=8192;else if(Vw())A.flags|=8192;else throw Fi=n0,Fh}else A.flags&=-16777217}function pw(A,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)A.flags&=-16777217;else if(A.flags|=16777216,!Ny(o))if(Vw())A.flags|=8192;else throw Fi=n0,Fh}function w0(A,o){o!==null&&(A.flags|=4),A.flags&16384&&(o=A.tag!==22?hi():536870912,A.lanes|=o,Ho|=o)}function rc(A,o){if(!Jt)switch(A.tailMode){case"hidden":o=A.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?A.tail=null:c.sibling=null;break;case"collapsed":c=A.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?o||A.tail===null?A.tail=null:A.tail.sibling=null:g.sibling=null}}function Ur(A){var o=A.alternate!==null&&A.alternate.child===A.child,c=0,g=0;if(o)for(var w=A.child;w!==null;)c|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=A,w=w.sibling;else for(w=A.child;w!==null;)c|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=A,w=w.sibling;return A.subtreeFlags|=g,A.childLanes=c,o}function JF(A,o,c){var g=o.pendingProps;switch(wh(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ur(o),null;case 1:return Ur(o),null;case 3:return c=o.stateNode,g=null,A!==null&&(g=A.memoizedState.cache),o.memoizedState.cache!==g&&(o.flags|=2048),jA(tn),de(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(A===null||A.child===null)&&(So(o)?JA(o):A===null||A.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Bh())),Ur(o),null;case 26:var w=o.type,B=o.memoizedState;return A===null?(JA(o),B!==null?(Ur(o),pw(o,B)):(Ur(o),fg(o,w,null,g,c))):B?B!==A.memoizedState?(JA(o),Ur(o),pw(o,B)):(Ur(o),o.flags&=-16777217):(A=A.memoizedProps,A!==g&&JA(o),Ur(o),fg(o,w,A,g,c)),null;case 27:if(Ee(o),c=ce.current,w=o.type,A!==null&&o.stateNode!=null)A.memoizedProps!==g&&JA(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return Ur(o),null}A=P.current,So(o)?Yv(o):(A=Ey(w,g,c),o.stateNode=A,JA(o))}return Ur(o),null;case 5:if(Ee(o),w=o.type,A!==null&&o.stateNode!=null)A.memoizedProps!==g&&JA(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return Ur(o),null}if(B=P.current,So(o))Yv(o);else{var b=R0(ce.current);switch(B){case 1:B=b.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:B=b.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":B=b.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":B=b.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":B=b.createElement("div"),B.innerHTML="<script><\/script>",B=B.removeChild(B.firstChild);break;case"select":B=typeof g.is=="string"?b.createElement("select",{is:g.is}):b.createElement("select"),g.multiple?B.multiple=!0:g.size&&(B.size=g.size);break;default:B=typeof g.is=="string"?b.createElement(w,{is:g.is}):b.createElement(w)}}B[O]=o,B[V]=g;e:for(b=o.child;b!==null;){if(b.tag===5||b.tag===6)B.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===o)break e;for(;b.sibling===null;){if(b.return===null||b.return===o)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}o.stateNode=B;e:switch(Fn(B,w,g),w){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&JA(o)}}return Ur(o),fg(o,o.type,A===null?null:A.memoizedProps,o.pendingProps,c),null;case 6:if(A&&o.stateNode!=null)A.memoizedProps!==g&&JA(o);else{if(typeof g!="string"&&o.stateNode===null)throw Error(n(166));if(A=ce.current,So(o)){if(A=o.stateNode,c=o.memoizedProps,g=null,w=Sn,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}A[O]=o,A=!!(A.nodeValue===c||g!==null&&g.suppressHydrationWarning===!0||dy(A.nodeValue,c)),A||Es(o,!0)}else A=R0(A).createTextNode(g),A[O]=o,o.stateNode=A}return Ur(o),null;case 31:if(c=o.memoizedState,A===null||A.memoizedState!==null){if(g=So(o),c!==null){if(A===null){if(!g)throw Error(n(318));if(A=o.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(557));A[O]=o}else Ei(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ur(o),A=!1}else c=Bh(),A!==null&&A.memoizedState!==null&&(A.memoizedState.hydrationErrors=c),A=!0;if(!A)return o.flags&256?(va(o),o):(va(o),null);if((o.flags&128)!==0)throw Error(n(558))}return Ur(o),null;case 13:if(g=o.memoizedState,A===null||A.memoizedState!==null&&A.memoizedState.dehydrated!==null){if(w=So(o),g!==null&&g.dehydrated!==null){if(A===null){if(!w)throw Error(n(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[O]=o}else Ei(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ur(o),w=!1}else w=Bh(),A!==null&&A.memoizedState!==null&&(A.memoizedState.hydrationErrors=w),w=!0;if(!w)return o.flags&256?(va(o),o):(va(o),null)}return va(o),(o.flags&128)!==0?(o.lanes=c,o):(c=g!==null,A=A!==null&&A.memoizedState!==null,c&&(g=o.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool),B=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(B=g.memoizedState.cachePool.pool),B!==w&&(g.flags|=2048)),c!==A&&c&&(o.child.flags|=8192),w0(o,o.updateQueue),Ur(o),null);case 4:return de(),A===null&&Qg(o.stateNode.containerInfo),Ur(o),null;case 10:return jA(o.type),Ur(o),null;case 19:if(Q(Wr),g=o.memoizedState,g===null)return Ur(o),null;if(w=(o.flags&128)!==0,B=g.rendering,B===null)if(w)rc(g,!1);else{if(Gr!==0||A!==null&&(A.flags&128)!==0)for(A=o.child;A!==null;){if(B=i0(A),B!==null){for(o.flags|=128,rc(g,!1),A=B.updateQueue,o.updateQueue=A,w0(o,A),o.subtreeFlags=0,A=c,c=o.child;c!==null;)jv(c,A),c=c.sibling;return K(Wr,Wr.current&1|2),Jt&&VA(o,g.treeForkCount),o.child}A=A.sibling}g.tail!==null&&dt()>T0&&(o.flags|=128,w=!0,rc(g,!1),o.lanes=4194304)}else{if(!w)if(A=i0(B),A!==null){if(o.flags|=128,w=!0,A=A.updateQueue,o.updateQueue=A,w0(o,A),rc(g,!0),g.tail===null&&g.tailMode==="hidden"&&!B.alternate&&!Jt)return Ur(o),null}else 2*dt()-g.renderingStartTime>T0&&c!==536870912&&(o.flags|=128,w=!0,rc(g,!1),o.lanes=4194304);g.isBackwards?(B.sibling=o.child,o.child=B):(A=g.last,A!==null?A.sibling=B:o.child=B,g.last=B)}return g.tail!==null?(A=g.tail,g.rendering=A,g.tail=A.sibling,g.renderingStartTime=dt(),A.sibling=null,c=Wr.current,K(Wr,w?c&1|2:c&1),Jt&&VA(o,g.treeForkCount),A):(Ur(o),null);case 22:case 23:return va(o),Rh(),g=o.memoizedState!==null,A!==null?A.memoizedState!==null!==g&&(o.flags|=8192):g&&(o.flags|=8192),g?(c&536870912)!==0&&(o.flags&128)===0&&(Ur(o),o.subtreeFlags&6&&(o.flags|=8192)):Ur(o),c=o.updateQueue,c!==null&&w0(o,c.retryQueue),c=null,A!==null&&A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(c=A.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==c&&(o.flags|=2048),A!==null&&Q(_i),null;case 24:return c=null,A!==null&&(c=A.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),jA(tn),Ur(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function YF(A,o){switch(wh(o),o.tag){case 1:return A=o.flags,A&65536?(o.flags=A&-65537|128,o):null;case 3:return jA(tn),de(),A=o.flags,(A&65536)!==0&&(A&128)===0?(o.flags=A&-65537|128,o):null;case 26:case 27:case 5:return Ee(o),null;case 31:if(o.memoizedState!==null){if(va(o),o.alternate===null)throw Error(n(340));Ei()}return A=o.flags,A&65536?(o.flags=A&-65537|128,o):null;case 13:if(va(o),A=o.memoizedState,A!==null&&A.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Ei()}return A=o.flags,A&65536?(o.flags=A&-65537|128,o):null;case 19:return Q(Wr),null;case 4:return de(),null;case 10:return jA(o.type),null;case 22:case 23:return va(o),Rh(),A!==null&&Q(_i),A=o.flags,A&65536?(o.flags=A&-65537|128,o):null;case 24:return jA(tn),null;case 25:return null;default:return null}}function xw(A,o){switch(wh(o),o.tag){case 3:jA(tn),de();break;case 26:case 27:case 5:Ee(o);break;case 4:de();break;case 31:o.memoizedState!==null&&va(o);break;case 13:va(o);break;case 19:Q(Wr);break;case 10:jA(o.type);break;case 22:case 23:va(o),Rh(),A!==null&&Q(_i);break;case 24:jA(tn)}}function nc(A,o){try{var c=o.updateQueue,g=c!==null?c.lastEffect:null;if(g!==null){var w=g.next;c=w;do{if((c.tag&A)===A){g=void 0;var B=c.create,b=c.inst;g=B(),b.destroy=g}c=c.next}while(c!==w)}}catch(L){dr(o,o.return,L)}}function ks(A,o,c){try{var g=o.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var B=w.next;g=B;do{if((g.tag&A)===A){var b=g.inst,L=b.destroy;if(L!==void 0){b.destroy=void 0,w=o;var te=c,pe=L;try{pe()}catch(Ue){dr(w,te,Ue)}}}g=g.next}while(g!==B)}}catch(Ue){dr(o,o.return,Ue)}}function vw(A){var o=A.updateQueue;if(o!==null){var c=A.stateNode;try{l1(o,c)}catch(g){dr(A,A.return,g)}}}function ww(A,o,c){c.props=Ni(A.type,A.memoizedProps),c.state=A.memoizedState;try{c.componentWillUnmount()}catch(g){dr(A,o,g)}}function ac(A,o){try{var c=A.ref;if(c!==null){switch(A.tag){case 26:case 27:case 5:var g=A.stateNode;break;case 30:g=A.stateNode;break;default:g=A.stateNode}typeof c=="function"?A.refCleanup=c(g):c.current=g}}catch(w){dr(A,o,w)}}function BA(A,o){var c=A.ref,g=A.refCleanup;if(c!==null)if(typeof g=="function")try{g()}catch(w){dr(A,o,w)}finally{A.refCleanup=null,A=A.alternate,A!=null&&(A.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(w){dr(A,o,w)}else c.current=null}function yw(A){var o=A.type,c=A.memoizedProps,g=A.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&g.focus();break e;case"img":c.src?g.src=c.src:c.srcSet&&(g.srcset=c.srcSet)}}catch(w){dr(A,A.return,w)}}function dg(A,o,c){try{var g=A.stateNode;xU(g,A.type,c,o),g[V]=o}catch(w){dr(A,A.return,w)}}function Bw(A){return A.tag===5||A.tag===3||A.tag===26||A.tag===27&&Ls(A.type)||A.tag===4}function hg(A){e:for(;;){for(;A.sibling===null;){if(A.return===null||Bw(A.return))return null;A=A.return}for(A.sibling.return=A.return,A=A.sibling;A.tag!==5&&A.tag!==6&&A.tag!==18;){if(A.tag===27&&Ls(A.type)||A.flags&2||A.child===null||A.tag===4)continue e;A.child.return=A,A=A.child}if(!(A.flags&2))return A.stateNode}}function gg(A,o,c){var g=A.tag;if(g===5||g===6)A=A.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(A,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(A),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=rt));else if(g!==4&&(g===27&&Ls(A.type)&&(c=A.stateNode,o=null),A=A.child,A!==null))for(gg(A,o,c),A=A.sibling;A!==null;)gg(A,o,c),A=A.sibling}function y0(A,o,c){var g=A.tag;if(g===5||g===6)A=A.stateNode,o?c.insertBefore(A,o):c.appendChild(A);else if(g!==4&&(g===27&&Ls(A.type)&&(c=A.stateNode),A=A.child,A!==null))for(y0(A,o,c),A=A.sibling;A!==null;)y0(A,o,c),A=A.sibling}function Cw(A){var o=A.stateNode,c=A.memoizedProps;try{for(var g=A.type,w=o.attributes;w.length;)o.removeAttributeNode(w[0]);Fn(o,g,c),o[O]=A,o[V]=c}catch(B){dr(A,A.return,B)}}var YA=!1,an=!1,mg=!1,Ew=typeof WeakSet=="function"?WeakSet:Set,vn=null;function qF(A,o){if(A=A.containerInfo,Mg=G0,A=Dv(A),lh(A)){if("selectionStart"in A)var c={start:A.selectionStart,end:A.selectionEnd};else e:{c=(c=A.ownerDocument)&&c.defaultView||window;var g=c.getSelection&&c.getSelection();if(g&&g.rangeCount!==0){c=g.anchorNode;var w=g.anchorOffset,B=g.focusNode;g=g.focusOffset;try{c.nodeType,B.nodeType}catch{c=null;break e}var b=0,L=-1,te=-1,pe=0,Ue=0,Ie=A,ye=null;t:for(;;){for(var _e;Ie!==c||w!==0&&Ie.nodeType!==3||(L=b+w),Ie!==B||g!==0&&Ie.nodeType!==3||(te=b+g),Ie.nodeType===3&&(b+=Ie.nodeValue.length),(_e=Ie.firstChild)!==null;)ye=Ie,Ie=_e;for(;;){if(Ie===A)break t;if(ye===c&&++pe===w&&(L=b),ye===B&&++Ue===g&&(te=b),(_e=Ie.nextSibling)!==null)break;Ie=ye,ye=Ie.parentNode}Ie=_e}c=L===-1||te===-1?null:{start:L,end:te}}else c=null}c=c||{start:0,end:0}}else c=null;for(Lg={focusedElem:A,selectionRange:c},G0=!1,vn=o;vn!==null;)if(o=vn,A=o.child,(o.subtreeFlags&1028)!==0&&A!==null)A.return=o,vn=A;else for(;vn!==null;){switch(o=vn,B=o.alternate,A=o.flags,o.tag){case 0:if((A&4)!==0&&(A=o.updateQueue,A=A!==null?A.events:null,A!==null))for(c=0;c<A.length;c++)w=A[c],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((A&1024)!==0&&B!==null){A=void 0,c=o,w=B.memoizedProps,B=B.memoizedState,g=c.stateNode;try{var At=Ni(c.type,w);A=g.getSnapshotBeforeUpdate(At,B),g.__reactInternalSnapshotBeforeUpdate=A}catch(pt){dr(c,c.return,pt)}}break;case 3:if((A&1024)!==0){if(A=o.stateNode.containerInfo,c=A.nodeType,c===9)Pg(A);else if(c===1)switch(A.nodeName){case"HEAD":case"HTML":case"BODY":Pg(A);break;default:A.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((A&1024)!==0)throw Error(n(163))}if(A=o.sibling,A!==null){A.return=o.return,vn=A;break}vn=o.return}}function Tw(A,o,c){var g=c.flags;switch(c.tag){case 0:case 11:case 15:$A(A,c),g&4&&nc(5,c);break;case 1:if($A(A,c),g&4)if(A=c.stateNode,o===null)try{A.componentDidMount()}catch(b){dr(c,c.return,b)}else{var w=Ni(c.type,o.memoizedProps);o=o.memoizedState;try{A.componentDidUpdate(w,o,A.__reactInternalSnapshotBeforeUpdate)}catch(b){dr(c,c.return,b)}}g&64&&vw(c),g&512&&ac(c,c.return);break;case 3:if($A(A,c),g&64&&(A=c.updateQueue,A!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{l1(A,o)}catch(b){dr(c,c.return,b)}}break;case 27:o===null&&g&4&&Cw(c);case 26:case 5:$A(A,c),o===null&&g&4&&yw(c),g&512&&ac(c,c.return);break;case 12:$A(A,c);break;case 31:$A(A,c),g&4&&bw(A,c);break;case 13:$A(A,c),g&4&&Fw(A,c),g&64&&(A=c.memoizedState,A!==null&&(A=A.dehydrated,A!==null&&(c=sU.bind(null,c),SU(A,c))));break;case 22:if(g=c.memoizedState!==null||YA,!g){o=o!==null&&o.memoizedState!==null||an,w=YA;var B=an;YA=g,(an=o)&&!B?ZA(A,c,(c.subtreeFlags&8772)!==0):$A(A,c),YA=w,an=B}break;case 30:break;default:$A(A,c)}}function Sw(A){var o=A.alternate;o!==null&&(A.alternate=null,Sw(o)),A.child=null,A.deletions=null,A.sibling=null,A.tag===5&&(o=A.stateNode,o!==null&&Oe(o)),A.stateNode=null,A.return=null,A.dependencies=null,A.memoizedProps=null,A.memoizedState=null,A.pendingProps=null,A.stateNode=null,A.updateQueue=null}var Qr=null,Aa=!1;function qA(A,o,c){for(c=c.child;c!==null;)_w(A,o,c),c=c.sibling}function _w(A,o,c){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(xt,c)}catch{}switch(c.tag){case 26:an||BA(c,o),qA(A,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:an||BA(c,o);var g=Qr,w=Aa;Ls(c.type)&&(Qr=c.stateNode,Aa=!1),qA(A,o,c),dc(c.stateNode),Qr=g,Aa=w;break;case 5:an||BA(c,o);case 6:if(g=Qr,w=Aa,Qr=null,qA(A,o,c),Qr=g,Aa=w,Qr!==null)if(Aa)try{(Qr.nodeType===9?Qr.body:Qr.nodeName==="HTML"?Qr.ownerDocument.body:Qr).removeChild(c.stateNode)}catch(B){dr(c,o,B)}else try{Qr.removeChild(c.stateNode)}catch(B){dr(c,o,B)}break;case 18:Qr!==null&&(Aa?(A=Qr,vy(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,c.stateNode),Xo(A)):vy(Qr,c.stateNode));break;case 4:g=Qr,w=Aa,Qr=c.stateNode.containerInfo,Aa=!0,qA(A,o,c),Qr=g,Aa=w;break;case 0:case 11:case 14:case 15:ks(2,c,o),an||ks(4,c,o),qA(A,o,c);break;case 1:an||(BA(c,o),g=c.stateNode,typeof g.componentWillUnmount=="function"&&ww(c,o,g)),qA(A,o,c);break;case 21:qA(A,o,c);break;case 22:an=(g=an)||c.memoizedState!==null,qA(A,o,c),an=g;break;default:qA(A,o,c)}}function bw(A,o){if(o.memoizedState===null&&(A=o.alternate,A!==null&&(A=A.memoizedState,A!==null))){A=A.dehydrated;try{Xo(A)}catch(c){dr(o,o.return,c)}}}function Fw(A,o){if(o.memoizedState===null&&(A=o.alternate,A!==null&&(A=A.memoizedState,A!==null&&(A=A.dehydrated,A!==null))))try{Xo(A)}catch(c){dr(o,o.return,c)}}function $F(A){switch(A.tag){case 31:case 13:case 19:var o=A.stateNode;return o===null&&(o=A.stateNode=new Ew),o;case 22:return A=A.stateNode,o=A._retryCache,o===null&&(o=A._retryCache=new Ew),o;default:throw Error(n(435,A.tag))}}function B0(A,o){var c=$F(A);o.forEach(function(g){if(!c.has(g)){c.add(g);var w=iU.bind(null,A,g);g.then(w,w)}})}function sa(A,o){var c=o.deletions;if(c!==null)for(var g=0;g<c.length;g++){var w=c[g],B=A,b=o,L=b;e:for(;L!==null;){switch(L.tag){case 27:if(Ls(L.type)){Qr=L.stateNode,Aa=!1;break e}break;case 5:Qr=L.stateNode,Aa=!1;break e;case 3:case 4:Qr=L.stateNode.containerInfo,Aa=!0;break e}L=L.return}if(Qr===null)throw Error(n(160));_w(B,b,w),Qr=null,Aa=!1,B=w.alternate,B!==null&&(B.return=null),w.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Uw(o,A),o=o.sibling}var iA=null;function Uw(A,o){var c=A.alternate,g=A.flags;switch(A.tag){case 0:case 11:case 14:case 15:sa(o,A),ia(A),g&4&&(ks(3,A,A.return),nc(3,A),ks(5,A,A.return));break;case 1:sa(o,A),ia(A),g&512&&(an||c===null||BA(c,c.return)),g&64&&YA&&(A=A.updateQueue,A!==null&&(g=A.callbacks,g!==null&&(c=A.shared.hiddenCallbacks,A.shared.hiddenCallbacks=c===null?g:c.concat(g))));break;case 26:var w=iA;if(sa(o,A),ia(A),g&512&&(an||c===null||BA(c,c.return)),g&4){var B=c!==null?c.memoizedState:null;if(g=A.memoizedState,c===null)if(g===null)if(A.stateNode===null){e:{g=A.type,c=A.memoizedProps,w=w.ownerDocument||w;t:switch(g){case"title":B=w.getElementsByTagName("title")[0],(!B||B[we]||B[O]||B.namespaceURI==="http://www.w3.org/2000/svg"||B.hasAttribute("itemprop"))&&(B=w.createElement(g),w.head.insertBefore(B,w.querySelector("head > title"))),Fn(B,g,c),B[O]=A,ot(B),g=B;break e;case"link":var b=Uy("link","href",w).get(g+(c.href||""));if(b){for(var L=0;L<b.length;L++)if(B=b[L],B.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&B.getAttribute("rel")===(c.rel==null?null:c.rel)&&B.getAttribute("title")===(c.title==null?null:c.title)&&B.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(L,1);break t}}B=w.createElement(g),Fn(B,g,c),w.head.appendChild(B);break;case"meta":if(b=Uy("meta","content",w).get(g+(c.content||""))){for(L=0;L<b.length;L++)if(B=b[L],B.getAttribute("content")===(c.content==null?null:""+c.content)&&B.getAttribute("name")===(c.name==null?null:c.name)&&B.getAttribute("property")===(c.property==null?null:c.property)&&B.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&B.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(L,1);break t}}B=w.createElement(g),Fn(B,g,c),w.head.appendChild(B);break;default:throw Error(n(468,g))}B[O]=A,ot(B),g=B}A.stateNode=g}else ky(w,A.type,A.stateNode);else A.stateNode=Fy(w,g,A.memoizedProps);else B!==g?(B===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):B.count--,g===null?ky(w,A.type,A.stateNode):Fy(w,g,A.memoizedProps)):g===null&&A.stateNode!==null&&dg(A,A.memoizedProps,c.memoizedProps)}break;case 27:sa(o,A),ia(A),g&512&&(an||c===null||BA(c,c.return)),c!==null&&g&4&&dg(A,A.memoizedProps,c.memoizedProps);break;case 5:if(sa(o,A),ia(A),g&512&&(an||c===null||BA(c,c.return)),A.flags&32){w=A.stateNode;try{Nt(w,"")}catch(At){dr(A,A.return,At)}}g&4&&A.stateNode!=null&&(w=A.memoizedProps,dg(A,w,c!==null?c.memoizedProps:w)),g&1024&&(mg=!0);break;case 6:if(sa(o,A),ia(A),g&4){if(A.stateNode===null)throw Error(n(162));g=A.memoizedProps,c=A.stateNode;try{c.nodeValue=g}catch(At){dr(A,A.return,At)}}break;case 3:if(L0=null,w=iA,iA=D0(o.containerInfo),sa(o,A),iA=w,ia(A),g&4&&c!==null&&c.memoizedState.isDehydrated)try{Xo(o.containerInfo)}catch(At){dr(A,A.return,At)}mg&&(mg=!1,kw(A));break;case 4:g=iA,iA=D0(A.stateNode.containerInfo),sa(o,A),ia(A),iA=g;break;case 12:sa(o,A),ia(A);break;case 31:sa(o,A),ia(A),g&4&&(g=A.updateQueue,g!==null&&(A.updateQueue=null,B0(A,g)));break;case 13:sa(o,A),ia(A),A.child.flags&8192&&A.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(E0=dt()),g&4&&(g=A.updateQueue,g!==null&&(A.updateQueue=null,B0(A,g)));break;case 22:w=A.memoizedState!==null;var te=c!==null&&c.memoizedState!==null,pe=YA,Ue=an;if(YA=pe||w,an=Ue||te,sa(o,A),an=Ue,YA=pe,ia(A),g&8192)e:for(o=A.stateNode,o._visibility=w?o._visibility&-2:o._visibility|1,w&&(c===null||te||YA||an||Ii(A)),c=null,o=A;;){if(o.tag===5||o.tag===26){if(c===null){te=c=o;try{if(B=te.stateNode,w)b=B.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{L=te.stateNode;var Ie=te.memoizedProps.style,ye=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;L.style.display=ye==null||typeof ye=="boolean"?"":(""+ye).trim()}}catch(At){dr(te,te.return,At)}}}else if(o.tag===6){if(c===null){te=o;try{te.stateNode.nodeValue=w?"":te.memoizedProps}catch(At){dr(te,te.return,At)}}}else if(o.tag===18){if(c===null){te=o;try{var _e=te.stateNode;w?wy(_e,!0):wy(te.stateNode,!1)}catch(At){dr(te,te.return,At)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===A)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===A)break e;for(;o.sibling===null;){if(o.return===null||o.return===A)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}g&4&&(g=A.updateQueue,g!==null&&(c=g.retryQueue,c!==null&&(g.retryQueue=null,B0(A,c))));break;case 19:sa(o,A),ia(A),g&4&&(g=A.updateQueue,g!==null&&(A.updateQueue=null,B0(A,g)));break;case 30:break;case 21:break;default:sa(o,A),ia(A)}}function ia(A){var o=A.flags;if(o&2){try{for(var c,g=A.return;g!==null;){if(Bw(g)){c=g;break}g=g.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var w=c.stateNode,B=hg(A);y0(A,B,w);break;case 5:var b=c.stateNode;c.flags&32&&(Nt(b,""),c.flags&=-33);var L=hg(A);y0(A,L,b);break;case 3:case 4:var te=c.stateNode.containerInfo,pe=hg(A);gg(A,pe,te);break;default:throw Error(n(161))}}catch(Ue){dr(A,A.return,Ue)}A.flags&=-3}o&4096&&(A.flags&=-4097)}function kw(A){if(A.subtreeFlags&1024)for(A=A.child;A!==null;){var o=A;kw(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),A=A.sibling}}function $A(A,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Tw(A,o.alternate,o),o=o.sibling}function Ii(A){for(A=A.child;A!==null;){var o=A;switch(o.tag){case 0:case 11:case 14:case 15:ks(4,o,o.return),Ii(o);break;case 1:BA(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&ww(o,o.return,c),Ii(o);break;case 27:dc(o.stateNode);case 26:case 5:BA(o,o.return),Ii(o);break;case 22:o.memoizedState===null&&Ii(o);break;case 30:Ii(o);break;default:Ii(o)}A=A.sibling}}function ZA(A,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var g=o.alternate,w=A,B=o,b=B.flags;switch(B.tag){case 0:case 11:case 15:ZA(w,B,c),nc(4,B);break;case 1:if(ZA(w,B,c),g=B,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(pe){dr(g,g.return,pe)}if(g=B,w=g.updateQueue,w!==null){var L=g.stateNode;try{var te=w.shared.hiddenCallbacks;if(te!==null)for(w.shared.hiddenCallbacks=null,w=0;w<te.length;w++)o1(te[w],L)}catch(pe){dr(g,g.return,pe)}}c&&b&64&&vw(B),ac(B,B.return);break;case 27:Cw(B);case 26:case 5:ZA(w,B,c),c&&g===null&&b&4&&yw(B),ac(B,B.return);break;case 12:ZA(w,B,c);break;case 31:ZA(w,B,c),c&&b&4&&bw(w,B);break;case 13:ZA(w,B,c),c&&b&4&&Fw(w,B);break;case 22:B.memoizedState===null&&ZA(w,B,c),ac(B,B.return);break;case 30:break;default:ZA(w,B,c)}o=o.sibling}}function pg(A,o){var c=null;A!==null&&A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(c=A.memoizedState.cachePool.pool),A=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(A=o.memoizedState.cachePool.pool),A!==c&&(A!=null&&A.refCount++,c!=null&&Kl(c))}function xg(A,o){A=null,o.alternate!==null&&(A=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==A&&(o.refCount++,A!=null&&Kl(A))}function oA(A,o,c,g){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Nw(A,o,c,g),o=o.sibling}function Nw(A,o,c,g){var w=o.flags;switch(o.tag){case 0:case 11:case 15:oA(A,o,c,g),w&2048&&nc(9,o);break;case 1:oA(A,o,c,g);break;case 3:oA(A,o,c,g),w&2048&&(A=null,o.alternate!==null&&(A=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==A&&(o.refCount++,A!=null&&Kl(A)));break;case 12:if(w&2048){oA(A,o,c,g),A=o.stateNode;try{var B=o.memoizedProps,b=B.id,L=B.onPostCommit;typeof L=="function"&&L(b,o.alternate===null?"mount":"update",A.passiveEffectDuration,-0)}catch(te){dr(o,o.return,te)}}else oA(A,o,c,g);break;case 31:oA(A,o,c,g);break;case 13:oA(A,o,c,g);break;case 23:break;case 22:B=o.stateNode,b=o.alternate,o.memoizedState!==null?B._visibility&2?oA(A,o,c,g):Ac(A,o):B._visibility&2?oA(A,o,c,g):(B._visibility|=2,Do(A,o,c,g,(o.subtreeFlags&10256)!==0||!1)),w&2048&&pg(b,o);break;case 24:oA(A,o,c,g),w&2048&&xg(o.alternate,o);break;default:oA(A,o,c,g)}}function Do(A,o,c,g,w){for(w=w&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var B=A,b=o,L=c,te=g,pe=b.flags;switch(b.tag){case 0:case 11:case 15:Do(B,b,L,te,w),nc(8,b);break;case 23:break;case 22:var Ue=b.stateNode;b.memoizedState!==null?Ue._visibility&2?Do(B,b,L,te,w):Ac(B,b):(Ue._visibility|=2,Do(B,b,L,te,w)),w&&pe&2048&&pg(b.alternate,b);break;case 24:Do(B,b,L,te,w),w&&pe&2048&&xg(b.alternate,b);break;default:Do(B,b,L,te,w)}o=o.sibling}}function Ac(A,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=A,g=o,w=g.flags;switch(g.tag){case 22:Ac(c,g),w&2048&&pg(g.alternate,g);break;case 24:Ac(c,g),w&2048&&xg(g.alternate,g);break;default:Ac(c,g)}o=o.sibling}}var sc=8192;function Mo(A,o,c){if(A.subtreeFlags&sc)for(A=A.child;A!==null;)Iw(A,o,c),A=A.sibling}function Iw(A,o,c){switch(A.tag){case 26:Mo(A,o,c),A.flags&sc&&A.memoizedState!==null&&LU(c,iA,A.memoizedState,A.memoizedProps);break;case 5:Mo(A,o,c);break;case 3:case 4:var g=iA;iA=D0(A.stateNode.containerInfo),Mo(A,o,c),iA=g;break;case 22:A.memoizedState===null&&(g=A.alternate,g!==null&&g.memoizedState!==null?(g=sc,sc=16777216,Mo(A,o,c),sc=g):Mo(A,o,c));break;default:Mo(A,o,c)}}function Qw(A){var o=A.alternate;if(o!==null&&(A=o.child,A!==null)){o.child=null;do o=A.sibling,A.sibling=null,A=o;while(A!==null)}}function ic(A){var o=A.deletions;if((A.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var g=o[c];vn=g,Dw(g,A)}Qw(A)}if(A.subtreeFlags&10256)for(A=A.child;A!==null;)Rw(A),A=A.sibling}function Rw(A){switch(A.tag){case 0:case 11:case 15:ic(A),A.flags&2048&&ks(9,A,A.return);break;case 3:ic(A);break;case 12:ic(A);break;case 22:var o=A.stateNode;A.memoizedState!==null&&o._visibility&2&&(A.return===null||A.return.tag!==13)?(o._visibility&=-3,C0(A)):ic(A);break;default:ic(A)}}function C0(A){var o=A.deletions;if((A.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var g=o[c];vn=g,Dw(g,A)}Qw(A)}for(A=A.child;A!==null;){switch(o=A,o.tag){case 0:case 11:case 15:ks(8,o,o.return),C0(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,C0(o));break;default:C0(o)}A=A.sibling}}function Dw(A,o){for(;vn!==null;){var c=vn;switch(c.tag){case 0:case 11:case 15:ks(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var g=c.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Kl(c.memoizedState.cache)}if(g=c.child,g!==null)g.return=c,vn=g;else e:for(c=A;vn!==null;){g=vn;var w=g.sibling,B=g.return;if(Sw(g),g===c){vn=null;break e}if(w!==null){w.return=B,vn=w;break e}vn=B}}}var ZF={getCacheForType:function(A){var o=_n(tn),c=o.data.get(A);return c===void 0&&(c=A(),o.data.set(A,c)),c},cacheSignal:function(){return _n(tn).controller.signal}},eU=typeof WeakMap=="function"?WeakMap:Map,Ar=0,Cr=null,Ht=null,Gt=0,fr=0,wa=null,Ns=!1,Lo=!1,vg=!1,es=0,Gr=0,Is=0,Qi=0,wg=0,ya=0,Ho=0,oc=null,oa=null,yg=!1,E0=0,Mw=0,T0=1/0,S0=null,Qs=null,dn=0,Rs=null,Oo=null,ts=0,Bg=0,Cg=null,Lw=null,lc=0,Eg=null;function Ba(){return(Ar&2)!==0&&Gt!==0?Gt&-Gt:Z.T!==null?Ug():D()}function Hw(){if(ya===0)if((Gt&536870912)===0||Jt){var A=Lr;Lr<<=1,(Lr&3932160)===0&&(Lr=262144),ya=A}else ya=536870912;return A=xa.current,A!==null&&(A.flags|=32),ya}function la(A,o,c){(A===Cr&&(fr===2||fr===9)||A.cancelPendingCommit!==null)&&(Po(A,0),Ds(A,Gt,ya,!1)),HA(A,c),((Ar&2)===0||A!==Cr)&&(A===Cr&&((Ar&2)===0&&(Qi|=c),Gr===4&&Ds(A,Gt,ya,!1)),CA(A))}function Ow(A,o,c){if((Ar&6)!==0)throw Error(n(327));var g=!c&&(o&127)===0&&(o&A.expiredLanes)===0||LA(A,o),w=g?nU(A,o):Sg(A,o,!0),B=g;do{if(w===0){Lo&&!g&&Ds(A,o,0,!1);break}else{if(c=A.current.alternate,B&&!tU(c)){w=Sg(A,o,!1),B=!1;continue}if(w===2){if(B=o,A.errorRecoveryDisabledLanes&B)var b=0;else b=A.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){o=b;e:{var L=A;w=oc;var te=L.current.memoizedState.isDehydrated;if(te&&(Po(L,b).flags|=256),b=Sg(L,b,!1),b!==2){if(vg&&!te){L.errorRecoveryDisabledLanes|=B,Qi|=B,w=4;break e}B=oa,oa=w,B!==null&&(oa===null?oa=B:oa.push.apply(oa,B))}w=b}if(B=!1,w!==2)continue}}if(w===1){Po(A,0),Ds(A,o,0,!0);break}e:{switch(g=A,B=w,B){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Ds(g,o,ya,!Ns);break e;case 2:oa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(w=E0+300-dt(),10<w)){if(Ds(g,o,ya,!Ns),MA(g,0,!0)!==0)break e;ts=o,g.timeoutHandle=py(Pw.bind(null,g,c,oa,S0,yg,o,ya,Qi,Ho,Ns,B,"Throttled",-0,0),w);break e}Pw(g,c,oa,S0,yg,o,ya,Qi,Ho,Ns,B,null,-0,0)}}break}while(!0);CA(A)}function Pw(A,o,c,g,w,B,b,L,te,pe,Ue,Ie,ye,_e){if(A.timeoutHandle=-1,Ie=o.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:rt},Iw(o,B,Ie);var At=(B&62914560)===B?E0-dt():(B&4194048)===B?Mw-dt():0;if(At=HU(Ie,At),At!==null){ts=B,A.cancelPendingCommit=At(Jw.bind(null,A,o,B,c,g,w,b,L,te,Ue,Ie,null,ye,_e)),Ds(A,B,b,!pe);return}}Jw(A,o,B,c,g,w,b,L,te)}function tU(A){for(var o=A;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var g=0;g<c.length;g++){var w=c[g],B=w.getSnapshot;w=w.value;try{if(!ma(B(),w))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===A)break;for(;o.sibling===null;){if(o.return===null||o.return===A)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ds(A,o,c,g){o&=~wg,o&=~Qi,A.suspendedLanes|=o,A.pingedLanes&=~o,g&&(A.warmLanes|=o),g=A.expirationTimes;for(var w=o;0<w;){var B=31-Sr(w),b=1<<B;g[B]=-1,w&=~b}c!==0&&ho(A,c,o)}function _0(){return(Ar&6)===0?(cc(0),!1):!0}function Tg(){if(Ht!==null){if(fr===0)var A=Ht.return;else A=Ht,KA=Ti=null,Ph(A),ko=null,zl=0,A=Ht;for(;A!==null;)xw(A.alternate,A),A=A.return;Ht=null}}function Po(A,o){var c=A.timeoutHandle;c!==-1&&(A.timeoutHandle=-1,yU(c)),c=A.cancelPendingCommit,c!==null&&(A.cancelPendingCommit=null,c()),ts=0,Tg(),Cr=A,Ht=c=GA(A.current,null),Gt=o,fr=0,wa=null,Ns=!1,Lo=LA(A,o),vg=!1,Ho=ya=wg=Qi=Is=Gr=0,oa=oc=null,yg=!1,(o&8)!==0&&(o|=o&32);var g=A.entangledLanes;if(g!==0)for(A=A.entanglements,g&=o;0<g;){var w=31-Sr(g),B=1<<w;o|=A[w],g&=~B}return es=o,Wu(),c}function Gw(A,o){Ft=null,Z.H=ec,o===Uo||o===r0?(o=a1(),fr=3):o===Fh?(o=a1(),fr=4):fr=o===ng?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,wa=o,Ht===null&&(Gr=1,m0(A,Qa(o,A.current)))}function Vw(){var A=xa.current;return A===null?!0:(Gt&4194048)===Gt?La===null:(Gt&62914560)===Gt||(Gt&536870912)!==0?A===La:!1}function Kw(){var A=Z.H;return Z.H=ec,A===null?ec:A}function jw(){var A=Z.A;return Z.A=ZF,A}function b0(){Gr=4,Ns||(Gt&4194048)!==Gt&&xa.current!==null||(Lo=!0),(Is&134217727)===0&&(Qi&134217727)===0||Cr===null||Ds(Cr,Gt,ya,!1)}function Sg(A,o,c){var g=Ar;Ar|=2;var w=Kw(),B=jw();(Cr!==A||Gt!==o)&&(S0=null,Po(A,o)),o=!1;var b=Gr;e:do try{if(fr!==0&&Ht!==null){var L=Ht,te=wa;switch(fr){case 8:Tg(),b=6;break e;case 3:case 2:case 9:case 6:xa.current===null&&(o=!0);var pe=fr;if(fr=0,wa=null,Go(A,L,te,pe),c&&Lo){b=0;break e}break;default:pe=fr,fr=0,wa=null,Go(A,L,te,pe)}}rU(),b=Gr;break}catch(Ue){Gw(A,Ue)}while(!0);return o&&A.shellSuspendCounter++,KA=Ti=null,Ar=g,Z.H=w,Z.A=B,Ht===null&&(Cr=null,Gt=0,Wu()),b}function rU(){for(;Ht!==null;)zw(Ht)}function nU(A,o){var c=Ar;Ar|=2;var g=Kw(),w=jw();Cr!==A||Gt!==o?(S0=null,T0=dt()+500,Po(A,o)):Lo=LA(A,o);e:do try{if(fr!==0&&Ht!==null){o=Ht;var B=wa;t:switch(fr){case 1:fr=0,wa=null,Go(A,o,B,1);break;case 2:case 9:if(r1(B)){fr=0,wa=null,Xw(o);break}o=function(){fr!==2&&fr!==9||Cr!==A||(fr=7),CA(A)},B.then(o,o);break e;case 3:fr=7;break e;case 4:fr=5;break e;case 7:r1(B)?(fr=0,wa=null,Xw(o)):(fr=0,wa=null,Go(A,o,B,7));break;case 5:var b=null;switch(Ht.tag){case 26:b=Ht.memoizedState;case 5:case 27:var L=Ht;if(b?Ny(b):L.stateNode.complete){fr=0,wa=null;var te=L.sibling;if(te!==null)Ht=te;else{var pe=L.return;pe!==null?(Ht=pe,F0(pe)):Ht=null}break t}}fr=0,wa=null,Go(A,o,B,5);break;case 6:fr=0,wa=null,Go(A,o,B,6);break;case 8:Tg(),Gr=6;break e;default:throw Error(n(462))}}aU();break}catch(Ue){Gw(A,Ue)}while(!0);return KA=Ti=null,Z.H=g,Z.A=w,Ar=c,Ht!==null?0:(Cr=null,Gt=0,Wu(),Gr)}function aU(){for(;Ht!==null&&!Mr();)zw(Ht)}function zw(A){var o=mw(A.alternate,A,es);A.memoizedProps=A.pendingProps,o===null?F0(A):Ht=o}function Xw(A){var o=A,c=o.alternate;switch(o.tag){case 15:case 0:o=cw(c,o,o.pendingProps,o.type,void 0,Gt);break;case 11:o=cw(c,o,o.pendingProps,o.type.render,o.ref,Gt);break;case 5:Ph(o);default:xw(c,o),o=Ht=jv(o,es),o=mw(c,o,es)}A.memoizedProps=A.pendingProps,o===null?F0(A):Ht=o}function Go(A,o,c,g){KA=Ti=null,Ph(o),ko=null,zl=0;var w=o.return;try{if(zF(A,w,o,c,Gt)){Gr=1,m0(A,Qa(c,A.current)),Ht=null;return}}catch(B){if(w!==null)throw Ht=w,B;Gr=1,m0(A,Qa(c,A.current)),Ht=null;return}o.flags&32768?(Jt||g===1?A=!0:Lo||(Gt&536870912)!==0?A=!1:(Ns=A=!0,(g===2||g===9||g===3||g===6)&&(g=xa.current,g!==null&&g.tag===13&&(g.flags|=16384))),Ww(o,A)):F0(o)}function F0(A){var o=A;do{if((o.flags&32768)!==0){Ww(o,Ns);return}A=o.return;var c=JF(o.alternate,o,es);if(c!==null){Ht=c;return}if(o=o.sibling,o!==null){Ht=o;return}Ht=o=A}while(o!==null);Gr===0&&(Gr=5)}function Ww(A,o){do{var c=YF(A.alternate,A);if(c!==null){c.flags&=32767,Ht=c;return}if(c=A.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(A=A.sibling,A!==null)){Ht=A;return}Ht=A=c}while(A!==null);Gr=6,Ht=null}function Jw(A,o,c,g,w,B,b,L,te){A.cancelPendingCommit=null;do U0();while(dn!==0);if((Ar&6)!==0)throw Error(n(327));if(o!==null){if(o===A.current)throw Error(n(177));if(B=o.lanes|o.childLanes,B|=hh,fo(A,c,B,b,L,te),A===Cr&&(Ht=Cr=null,Gt=0),Oo=o,Rs=A,ts=c,Bg=B,Cg=w,Lw=g,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(A.callbackNode=null,A.callbackPriority=0,oU(ft,function(){return ey(),null})):(A.callbackNode=null,A.callbackPriority=0),g=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||g){g=Z.T,Z.T=null,w=ie.p,ie.p=2,b=Ar,Ar|=4;try{qF(A,o,c)}finally{Ar=b,ie.p=w,Z.T=g}}dn=1,Yw(),qw(),$w()}}function Yw(){if(dn===1){dn=0;var A=Rs,o=Oo,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null;var g=ie.p;ie.p=2;var w=Ar;Ar|=4;try{Uw(o,A);var B=Lg,b=Dv(A.containerInfo),L=B.focusedElem,te=B.selectionRange;if(b!==L&&L&&L.ownerDocument&&Rv(L.ownerDocument.documentElement,L)){if(te!==null&&lh(L)){var pe=te.start,Ue=te.end;if(Ue===void 0&&(Ue=pe),"selectionStart"in L)L.selectionStart=pe,L.selectionEnd=Math.min(Ue,L.value.length);else{var Ie=L.ownerDocument||document,ye=Ie&&Ie.defaultView||window;if(ye.getSelection){var _e=ye.getSelection(),At=L.textContent.length,pt=Math.min(te.start,At),wr=te.end===void 0?pt:Math.min(te.end,At);!_e.extend&&pt>wr&&(b=wr,wr=pt,pt=b);var fe=Qv(L,pt),Ae=Qv(L,wr);if(fe&&Ae&&(_e.rangeCount!==1||_e.anchorNode!==fe.node||_e.anchorOffset!==fe.offset||_e.focusNode!==Ae.node||_e.focusOffset!==Ae.offset)){var ge=Ie.createRange();ge.setStart(fe.node,fe.offset),_e.removeAllRanges(),pt>wr?(_e.addRange(ge),_e.extend(Ae.node,Ae.offset)):(ge.setEnd(Ae.node,Ae.offset),_e.addRange(ge))}}}}for(Ie=[],_e=L;_e=_e.parentNode;)_e.nodeType===1&&Ie.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<Ie.length;L++){var Ne=Ie[L];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}G0=!!Mg,Lg=Mg=null}finally{Ar=w,ie.p=g,Z.T=c}}A.current=o,dn=2}}function qw(){if(dn===2){dn=0;var A=Rs,o=Oo,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=Z.T,Z.T=null;var g=ie.p;ie.p=2;var w=Ar;Ar|=4;try{Tw(A,o.alternate,o)}finally{Ar=w,ie.p=g,Z.T=c}}dn=3}}function $w(){if(dn===4||dn===3){dn=0,un();var A=Rs,o=Oo,c=ts,g=Lw;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?dn=5:(dn=0,Oo=Rs=null,Zw(A,A.pendingLanes));var w=A.pendingLanes;if(w===0&&(Qs=null),vs(c),o=o.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(xt,o,void 0,(o.current.flags&128)===128)}catch{}if(g!==null){o=Z.T,w=ie.p,ie.p=2,Z.T=null;try{for(var B=A.onRecoverableError,b=0;b<g.length;b++){var L=g[b];B(L.value,{componentStack:L.stack})}}finally{Z.T=o,ie.p=w}}(ts&3)!==0&&U0(),CA(A),w=A.pendingLanes,(c&261930)!==0&&(w&42)!==0?A===Eg?lc++:(lc=0,Eg=A):lc=0,cc(0)}}function Zw(A,o){(A.pooledCacheLanes&=o)===0&&(o=A.pooledCache,o!=null&&(A.pooledCache=null,Kl(o)))}function U0(){return Yw(),qw(),$w(),ey()}function ey(){if(dn!==5)return!1;var A=Rs,o=Bg;Bg=0;var c=vs(ts),g=Z.T,w=ie.p;try{ie.p=32>c?32:c,Z.T=null,c=Cg,Cg=null;var B=Rs,b=ts;if(dn=0,Oo=Rs=null,ts=0,(Ar&6)!==0)throw Error(n(331));var L=Ar;if(Ar|=4,Rw(B.current),Nw(B,B.current,b,c),Ar=L,cc(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(xt,B)}catch{}return!0}finally{ie.p=w,Z.T=g,Zw(A,o)}}function ty(A,o,c){o=Qa(c,o),o=rg(A.stateNode,o,2),A=bs(A,o,2),A!==null&&(HA(A,2),CA(A))}function dr(A,o,c){if(A.tag===3)ty(A,A,c);else for(;o!==null;){if(o.tag===3){ty(o,A,c);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Qs===null||!Qs.has(g))){A=Qa(c,A),c=rw(2),g=bs(o,c,2),g!==null&&(nw(c,g,o,A),HA(g,2),CA(g));break}}o=o.return}}function _g(A,o,c){var g=A.pingCache;if(g===null){g=A.pingCache=new eU;var w=new Set;g.set(o,w)}else w=g.get(o),w===void 0&&(w=new Set,g.set(o,w));w.has(c)||(vg=!0,w.add(c),A=AU.bind(null,A,o,c),o.then(A,A))}function AU(A,o,c){var g=A.pingCache;g!==null&&g.delete(o),A.pingedLanes|=A.suspendedLanes&c,A.warmLanes&=~c,Cr===A&&(Gt&c)===c&&(Gr===4||Gr===3&&(Gt&62914560)===Gt&&300>dt()-E0?(Ar&2)===0&&Po(A,0):wg|=c,Ho===Gt&&(Ho=0)),CA(A)}function ry(A,o){o===0&&(o=hi()),A=Bi(A,o),A!==null&&(HA(A,o),CA(A))}function sU(A){var o=A.memoizedState,c=0;o!==null&&(c=o.retryLane),ry(A,c)}function iU(A,o){var c=0;switch(A.tag){case 31:case 13:var g=A.stateNode,w=A.memoizedState;w!==null&&(c=w.retryLane);break;case 19:g=A.stateNode;break;case 22:g=A.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(o),ry(A,c)}function oU(A,o){return nr(A,o)}var k0=null,Vo=null,bg=!1,N0=!1,Fg=!1,Ms=0;function CA(A){A!==Vo&&A.next===null&&(Vo===null?k0=Vo=A:Vo=Vo.next=A),N0=!0,bg||(bg=!0,cU())}function cc(A,o){if(!Fg&&N0){Fg=!0;do for(var c=!1,g=k0;g!==null;){if(A!==0){var w=g.pendingLanes;if(w===0)var B=0;else{var b=g.suspendedLanes,L=g.pingedLanes;B=(1<<31-Sr(42|A)+1)-1,B&=w&~(b&~L),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(c=!0,sy(g,B))}else B=Gt,B=MA(g,g===Cr?B:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(B&3)===0||LA(g,B)||(c=!0,sy(g,B));g=g.next}while(c);Fg=!1}}function lU(){ny()}function ny(){N0=bg=!1;var A=0;Ms!==0&&wU()&&(A=Ms);for(var o=dt(),c=null,g=k0;g!==null;){var w=g.next,B=ay(g,o);B===0?(g.next=null,c===null?k0=w:c.next=w,w===null&&(Vo=c)):(c=g,(A!==0||(B&3)!==0)&&(N0=!0)),g=w}dn!==0&&dn!==5||cc(A),Ms!==0&&(Ms=0)}function ay(A,o){for(var c=A.suspendedLanes,g=A.pingedLanes,w=A.expirationTimes,B=A.pendingLanes&-62914561;0<B;){var b=31-Sr(B),L=1<<b,te=w[b];te===-1?((L&c)===0||(L&g)!==0)&&(w[b]=uo(L,o)):te<=o&&(A.expiredLanes|=L),B&=~L}if(o=Cr,c=Gt,c=MA(A,A===o?c:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),g=A.callbackNode,c===0||A===o&&(fr===2||fr===9)||A.cancelPendingCommit!==null)return g!==null&&g!==null&&Yt(g),A.callbackNode=null,A.callbackPriority=0;if((c&3)===0||LA(A,c)){if(o=c&-c,o===A.callbackPriority)return o;switch(g!==null&&Yt(g),vs(c)){case 2:case 8:c=_t;break;case 32:c=ft;break;case 268435456:c=et;break;default:c=ft}return g=Ay.bind(null,A),c=nr(c,g),A.callbackPriority=o,A.callbackNode=c,o}return g!==null&&g!==null&&Yt(g),A.callbackPriority=2,A.callbackNode=null,2}function Ay(A,o){if(dn!==0&&dn!==5)return A.callbackNode=null,A.callbackPriority=0,null;var c=A.callbackNode;if(U0()&&A.callbackNode!==c)return null;var g=Gt;return g=MA(A,A===Cr?g:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),g===0?null:(Ow(A,g,o),ay(A,dt()),A.callbackNode!=null&&A.callbackNode===c?Ay.bind(null,A):null)}function sy(A,o){if(U0())return null;Ow(A,o,!0)}function cU(){BU(function(){(Ar&6)!==0?nr(We,lU):ny()})}function Ug(){if(Ms===0){var A=bo;A===0&&(A=mt,mt<<=1,(mt&261888)===0&&(mt=256)),Ms=A}return Ms}function iy(A){return A==null||typeof A=="symbol"||typeof A=="boolean"?null:typeof A=="function"?A:ir(""+A)}function oy(A,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,A.id&&c.setAttribute("form",A.id),o.parentNode.insertBefore(c,o),A=new FormData(A),c.parentNode.removeChild(c),A}function uU(A,o,c,g,w){if(o==="submit"&&c&&c.stateNode===w){var B=iy((w[V]||null).action),b=g.submitter;b&&(o=(o=b[V]||null)?iy(o.formAction):b.getAttribute("formAction"),o!==null&&(B=o,b=null));var L=new Ku("action","action",null,g,w);A.push({event:L,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Ms!==0){var te=b?oy(w,b):new FormData(w);Yh(c,{pending:!0,data:te,method:w.method,action:B},null,te)}}else typeof B=="function"&&(L.preventDefault(),te=b?oy(w,b):new FormData(w),Yh(c,{pending:!0,data:te,method:w.method,action:B},B,te))},currentTarget:w}]})}}for(var kg=0;kg<dh.length;kg++){var Ng=dh[kg],fU=Ng.toLowerCase(),dU=Ng[0].toUpperCase()+Ng.slice(1);sA(fU,"on"+dU)}sA(Hv,"onAnimationEnd"),sA(Ov,"onAnimationIteration"),sA(Pv,"onAnimationStart"),sA("dblclick","onDoubleClick"),sA("focusin","onFocus"),sA("focusout","onBlur"),sA(FF,"onTransitionRun"),sA(UF,"onTransitionStart"),sA(kF,"onTransitionCancel"),sA(Gv,"onTransitionEnd"),na("onMouseEnter",["mouseout","mouseover"]),na("onMouseLeave",["mouseout","mouseover"]),na("onPointerEnter",["pointerout","pointerover"]),na("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hU=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uc));function ly(A,o){o=(o&4)!==0;for(var c=0;c<A.length;c++){var g=A[c],w=g.event;g=g.listeners;e:{var B=void 0;if(o)for(var b=g.length-1;0<=b;b--){var L=g[b],te=L.instance,pe=L.currentTarget;if(L=L.listener,te!==B&&w.isPropagationStopped())break e;B=L,w.currentTarget=pe;try{B(w)}catch(Ue){Xu(Ue)}w.currentTarget=null,B=te}else for(b=0;b<g.length;b++){if(L=g[b],te=L.instance,pe=L.currentTarget,L=L.listener,te!==B&&w.isPropagationStopped())break e;B=L,w.currentTarget=pe;try{B(w)}catch(Ue){Xu(Ue)}w.currentTarget=null,B=te}}}}function Ot(A,o){var c=o[me];c===void 0&&(c=o[me]=new Set);var g=A+"__bubble";c.has(g)||(cy(o,A,2,!1),c.add(g))}function Ig(A,o,c){var g=0;o&&(g|=4),cy(c,A,g,o)}var I0="_reactListening"+Math.random().toString(36).slice(2);function Qg(A){if(!A[I0]){A[I0]=!0,pr.forEach(function(c){c!=="selectionchange"&&(hU.has(c)||Ig(c,!1,A),Ig(c,!0,A))});var o=A.nodeType===9?A:A.ownerDocument;o===null||o[I0]||(o[I0]=!0,Ig("selectionchange",!1,o))}}function cy(A,o,c,g){switch(Hy(o)){case 2:var w=GU;break;case 8:w=VU;break;default:w=Jg}c=w.bind(null,o,c,A),w=void 0,!xo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(w=!0),g?w!==void 0?A.addEventListener(o,c,{capture:!0,passive:w}):A.addEventListener(o,c,!0):w!==void 0?A.addEventListener(o,c,{passive:w}):A.addEventListener(o,c,!1)}function Rg(A,o,c,g,w){var B=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var b=g.tag;if(b===3||b===4){var L=g.stateNode.containerInfo;if(L===w)break;if(b===4)for(b=g.return;b!==null;){var te=b.tag;if((te===3||te===4)&&b.stateNode.containerInfo===w)return;b=b.return}for(;L!==null;){if(b=Ve(L),b===null)return;if(te=b.tag,te===5||te===6||te===26||te===27){g=B=b;continue e}L=L.parentNode}}g=g.return}Wt(function(){var pe=B,Ue=ur(c),Ie=[];e:{var ye=Vv.get(A);if(ye!==void 0){var _e=Ku,At=A;switch(A){case"keypress":if(Gu(c)===0)break e;case"keydown":case"keyup":_e=iF;break;case"focusin":At="focus",_e=ah;break;case"focusout":At="blur",_e=ah;break;case"beforeblur":case"afterblur":_e=ah;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=xv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=J4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=cF;break;case Hv:case Ov:case Pv:_e=$4;break;case Gv:_e=fF;break;case"scroll":case"scrollend":_e=X4;break;case"wheel":_e=hF;break;case"copy":case"cut":case"paste":_e=eF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=wv;break;case"toggle":case"beforetoggle":_e=mF}var pt=(o&4)!==0,wr=!pt&&(A==="scroll"||A==="scrollend"),fe=pt?ye!==null?ye+"Capture":null:ye;pt=[];for(var Ae=pe,ge;Ae!==null;){var Ne=Ae;if(ge=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||ge===null||fe===null||(Ne=aA(Ae,fe),Ne!=null&&pt.push(fc(Ae,Ne,ge))),wr)break;Ae=Ae.return}0<pt.length&&(ye=new _e(ye,At,null,c,Ue),Ie.push({event:ye,listeners:pt}))}}if((o&7)===0){e:{if(ye=A==="mouseover"||A==="pointerover",_e=A==="mouseout"||A==="pointerout",ye&&c!==at&&(At=c.relatedTarget||c.fromElement)&&(Ve(At)||At[J]))break e;if((_e||ye)&&(ye=Ue.window===Ue?Ue:(ye=Ue.ownerDocument)?ye.defaultView||ye.parentWindow:window,_e?(At=c.relatedTarget||c.toElement,_e=pe,At=At?Ve(At):null,At!==null&&(wr=s(At),pt=At.tag,At!==wr||pt!==5&&pt!==27&&pt!==6)&&(At=null)):(_e=null,At=pe),_e!==At)){if(pt=xv,Ne="onMouseLeave",fe="onMouseEnter",Ae="mouse",(A==="pointerout"||A==="pointerover")&&(pt=wv,Ne="onPointerLeave",fe="onPointerEnter",Ae="pointer"),wr=_e==null?ye:Pe(_e),ge=At==null?ye:Pe(At),ye=new pt(Ne,Ae+"leave",_e,c,Ue),ye.target=wr,ye.relatedTarget=ge,Ne=null,Ve(Ue)===pe&&(pt=new pt(fe,Ae+"enter",At,c,Ue),pt.target=ge,pt.relatedTarget=wr,Ne=pt),wr=Ne,_e&&At)t:{for(pt=gU,fe=_e,Ae=At,ge=0,Ne=fe;Ne;Ne=pt(Ne))ge++;Ne=0;for(var ht=Ae;ht;ht=pt(ht))Ne++;for(;0<ge-Ne;)fe=pt(fe),ge--;for(;0<Ne-ge;)Ae=pt(Ae),Ne--;for(;ge--;){if(fe===Ae||Ae!==null&&fe===Ae.alternate){pt=fe;break t}fe=pt(fe),Ae=pt(Ae)}pt=null}else pt=null;_e!==null&&uy(Ie,ye,_e,pt,!1),At!==null&&wr!==null&&uy(Ie,wr,At,pt,!0)}}e:{if(ye=pe?Pe(pe):window,_e=ye.nodeName&&ye.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ye.type==="file")var Zt=bv;else if(Sv(ye))if(Fv)Zt=SF;else{Zt=EF;var ut=CF}else _e=ye.nodeName,!_e||_e.toLowerCase()!=="input"||ye.type!=="checkbox"&&ye.type!=="radio"?pe&&Xr(pe.elementType)&&(Zt=bv):Zt=TF;if(Zt&&(Zt=Zt(A,pe))){_v(Ie,Zt,c,Ue);break e}ut&&ut(A,ye,pe),A==="focusout"&&pe&&ye.type==="number"&&pe.memoizedProps.value!=null&&Me(ye,"number",ye.value)}switch(ut=pe?Pe(pe):window,A){case"focusin":(Sv(ut)||ut.contentEditable==="true")&&(wo=ut,ch=pe,Pl=null);break;case"focusout":Pl=ch=wo=null;break;case"mousedown":uh=!0;break;case"contextmenu":case"mouseup":case"dragend":uh=!1,Mv(Ie,c,Ue);break;case"selectionchange":if(bF)break;case"keydown":case"keyup":Mv(Ie,c,Ue)}var It;if(sh)e:{switch(A){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else vo?Ev(A,c)&&(Vt="onCompositionEnd"):A==="keydown"&&c.keyCode===229&&(Vt="onCompositionStart");Vt&&(yv&&c.locale!=="ko"&&(vo||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&vo&&(It=mv()):(AA=Ue,xi="value"in AA?AA.value:AA.textContent,vo=!0)),ut=Q0(pe,Vt),0<ut.length&&(Vt=new vv(Vt,A,null,c,Ue),Ie.push({event:Vt,listeners:ut}),It?Vt.data=It:(It=Tv(c),It!==null&&(Vt.data=It)))),(It=xF?vF(A,c):wF(A,c))&&(Vt=Q0(pe,"onBeforeInput"),0<Vt.length&&(ut=new vv("onBeforeInput","beforeinput",null,c,Ue),Ie.push({event:ut,listeners:Vt}),ut.data=It)),uU(Ie,A,pe,c,Ue)}ly(Ie,o)})}function fc(A,o,c){return{instance:A,listener:o,currentTarget:c}}function Q0(A,o){for(var c=o+"Capture",g=[];A!==null;){var w=A,B=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||B===null||(w=aA(A,c),w!=null&&g.unshift(fc(A,w,B)),w=aA(A,o),w!=null&&g.push(fc(A,w,B))),A.tag===3)return g;A=A.return}return[]}function gU(A){if(A===null)return null;do A=A.return;while(A&&A.tag!==5&&A.tag!==27);return A||null}function uy(A,o,c,g,w){for(var B=o._reactName,b=[];c!==null&&c!==g;){var L=c,te=L.alternate,pe=L.stateNode;if(L=L.tag,te!==null&&te===g)break;L!==5&&L!==26&&L!==27||pe===null||(te=pe,w?(pe=aA(c,B),pe!=null&&b.unshift(fc(c,pe,te))):w||(pe=aA(c,B),pe!=null&&b.push(fc(c,pe,te)))),c=c.return}b.length!==0&&A.push({event:o,listeners:b})}var mU=/\r\n?/g,pU=/\u0000|\uFFFD/g;function fy(A){return(typeof A=="string"?A:""+A).replace(mU,`
`).replace(pU,"")}function dy(A,o){return o=fy(o),fy(A)===o}function vr(A,o,c,g,w,B){switch(c){case"children":typeof g=="string"?o==="body"||o==="textarea"&&g===""||Nt(A,g):(typeof g=="number"||typeof g=="bigint")&&o!=="body"&&Nt(A,""+g);break;case"className":ws(A,"class",g);break;case"tabIndex":ws(A,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":ws(A,c,g);break;case"style":xn(A,g,B);break;case"data":if(o!=="object"){ws(A,"data",g);break}case"src":case"href":if(g===""&&(o!=="a"||c!=="href")){A.removeAttribute(c);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){A.removeAttribute(c);break}g=ir(""+g),A.setAttribute(c,g);break;case"action":case"formAction":if(typeof g=="function"){A.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof B=="function"&&(c==="formAction"?(o!=="input"&&vr(A,o,"name",w.name,w,null),vr(A,o,"formEncType",w.formEncType,w,null),vr(A,o,"formMethod",w.formMethod,w,null),vr(A,o,"formTarget",w.formTarget,w,null)):(vr(A,o,"encType",w.encType,w,null),vr(A,o,"method",w.method,w,null),vr(A,o,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){A.removeAttribute(c);break}g=ir(""+g),A.setAttribute(c,g);break;case"onClick":g!=null&&(A.onclick=rt);break;case"onScroll":g!=null&&Ot("scroll",A);break;case"onScrollEnd":g!=null&&Ot("scrollend",A);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(c=g.__html,c!=null){if(w.children!=null)throw Error(n(60));A.innerHTML=c}}break;case"multiple":A.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":A.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){A.removeAttribute("xlink:href");break}c=ir(""+g),A.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?A.setAttribute(c,""+g):A.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?A.setAttribute(c,""):A.removeAttribute(c);break;case"capture":case"download":g===!0?A.setAttribute(c,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?A.setAttribute(c,g):A.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?A.setAttribute(c,g):A.removeAttribute(c);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?A.removeAttribute(c):A.setAttribute(c,g);break;case"popover":Ot("beforetoggle",A),Ot("toggle",A),pn(A,"popover",g);break;case"xlinkActuate":ga(A,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":ga(A,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":ga(A,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":ga(A,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":ga(A,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":ga(A,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":ga(A,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":ga(A,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":ga(A,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":pn(A,"is",g);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Wn.get(c)||c,pn(A,c,g))}}function Dg(A,o,c,g,w,B){switch(c){case"style":xn(A,g,B);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(c=g.__html,c!=null){if(w.children!=null)throw Error(n(60));A.innerHTML=c}}break;case"children":typeof g=="string"?Nt(A,g):(typeof g=="number"||typeof g=="bigint")&&Nt(A,""+g);break;case"onScroll":g!=null&&Ot("scroll",A);break;case"onScrollEnd":g!=null&&Ot("scrollend",A);break;case"onClick":g!=null&&(A.onclick=rt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lr.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(w=c.endsWith("Capture"),o=c.slice(2,w?c.length-7:void 0),B=A[V]||null,B=B!=null?B[c]:null,typeof B=="function"&&A.removeEventListener(o,B,w),typeof g=="function")){typeof B!="function"&&B!==null&&(c in A?A[c]=null:A.hasAttribute(c)&&A.removeAttribute(c)),A.addEventListener(o,g,w);break e}c in A?A[c]=g:g===!0?A.setAttribute(c,""):pn(A,c,g)}}}function Fn(A,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",A),Ot("load",A);var g=!1,w=!1,B;for(B in c)if(c.hasOwnProperty(B)){var b=c[B];if(b!=null)switch(B){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:vr(A,o,B,b,c,null)}}w&&vr(A,o,"srcSet",c.srcSet,c,null),g&&vr(A,o,"src",c.src,c,null);return;case"input":Ot("invalid",A);var L=B=b=w=null,te=null,pe=null;for(g in c)if(c.hasOwnProperty(g)){var Ue=c[g];if(Ue!=null)switch(g){case"name":w=Ue;break;case"type":b=Ue;break;case"checked":te=Ue;break;case"defaultChecked":pe=Ue;break;case"value":B=Ue;break;case"defaultValue":L=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(n(137,o));break;default:vr(A,o,g,Ue,c,null)}}oe(A,B,L,te,pe,b,w,!1);return;case"select":Ot("invalid",A),g=b=B=null;for(w in c)if(c.hasOwnProperty(w)&&(L=c[w],L!=null))switch(w){case"value":B=L;break;case"defaultValue":b=L;break;case"multiple":g=L;default:vr(A,o,w,L,c,null)}o=B,c=b,A.multiple=!!g,o!=null?Je(A,!!g,o,!1):c!=null&&Je(A,!!g,c,!0);return;case"textarea":Ot("invalid",A),B=w=g=null;for(b in c)if(c.hasOwnProperty(b)&&(L=c[b],L!=null))switch(b){case"value":g=L;break;case"defaultValue":w=L;break;case"children":B=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(n(91));break;default:vr(A,o,b,L,c,null)}Et(A,g,w,B);return;case"option":for(te in c)if(c.hasOwnProperty(te)&&(g=c[te],g!=null))switch(te){case"selected":A.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:vr(A,o,te,g,c,null)}return;case"dialog":Ot("beforetoggle",A),Ot("toggle",A),Ot("cancel",A),Ot("close",A);break;case"iframe":case"object":Ot("load",A);break;case"video":case"audio":for(g=0;g<uc.length;g++)Ot(uc[g],A);break;case"image":Ot("error",A),Ot("load",A);break;case"details":Ot("toggle",A);break;case"embed":case"source":case"link":Ot("error",A),Ot("load",A);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(g=c[pe],g!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:vr(A,o,pe,g,c,null)}return;default:if(Xr(o)){for(Ue in c)c.hasOwnProperty(Ue)&&(g=c[Ue],g!==void 0&&Dg(A,o,Ue,g,c,void 0));return}}for(L in c)c.hasOwnProperty(L)&&(g=c[L],g!=null&&vr(A,o,L,g,c,null))}function xU(A,o,c,g){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,B=null,b=null,L=null,te=null,pe=null,Ue=null;for(_e in c){var Ie=c[_e];if(c.hasOwnProperty(_e)&&Ie!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":te=Ie;default:g.hasOwnProperty(_e)||vr(A,o,_e,null,g,Ie)}}for(var ye in g){var _e=g[ye];if(Ie=c[ye],g.hasOwnProperty(ye)&&(_e!=null||Ie!=null))switch(ye){case"type":B=_e;break;case"name":w=_e;break;case"checked":pe=_e;break;case"defaultChecked":Ue=_e;break;case"value":b=_e;break;case"defaultValue":L=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,o));break;default:_e!==Ie&&vr(A,o,ye,_e,g,Ie)}}ke(A,b,L,te,pe,Ue,B,w);return;case"select":_e=b=L=ye=null;for(B in c)if(te=c[B],c.hasOwnProperty(B)&&te!=null)switch(B){case"value":break;case"multiple":_e=te;default:g.hasOwnProperty(B)||vr(A,o,B,null,g,te)}for(w in g)if(B=g[w],te=c[w],g.hasOwnProperty(w)&&(B!=null||te!=null))switch(w){case"value":ye=B;break;case"defaultValue":L=B;break;case"multiple":b=B;default:B!==te&&vr(A,o,w,B,g,te)}o=L,c=b,g=_e,ye!=null?Je(A,!!c,ye,!1):!!g!=!!c&&(o!=null?Je(A,!!c,o,!0):Je(A,!!c,c?[]:"",!1));return;case"textarea":_e=ye=null;for(L in c)if(w=c[L],c.hasOwnProperty(L)&&w!=null&&!g.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:vr(A,o,L,null,g,w)}for(b in g)if(w=g[b],B=c[b],g.hasOwnProperty(b)&&(w!=null||B!=null))switch(b){case"value":ye=w;break;case"defaultValue":_e=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==B&&vr(A,o,b,w,g,B)}ct(A,ye,_e);return;case"option":for(var At in c)if(ye=c[At],c.hasOwnProperty(At)&&ye!=null&&!g.hasOwnProperty(At))switch(At){case"selected":A.selected=!1;break;default:vr(A,o,At,null,g,ye)}for(te in g)if(ye=g[te],_e=c[te],g.hasOwnProperty(te)&&ye!==_e&&(ye!=null||_e!=null))switch(te){case"selected":A.selected=ye&&typeof ye!="function"&&typeof ye!="symbol";break;default:vr(A,o,te,ye,g,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in c)ye=c[pt],c.hasOwnProperty(pt)&&ye!=null&&!g.hasOwnProperty(pt)&&vr(A,o,pt,null,g,ye);for(pe in g)if(ye=g[pe],_e=c[pe],g.hasOwnProperty(pe)&&ye!==_e&&(ye!=null||_e!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,o));break;default:vr(A,o,pe,ye,g,_e)}return;default:if(Xr(o)){for(var wr in c)ye=c[wr],c.hasOwnProperty(wr)&&ye!==void 0&&!g.hasOwnProperty(wr)&&Dg(A,o,wr,void 0,g,ye);for(Ue in g)ye=g[Ue],_e=c[Ue],!g.hasOwnProperty(Ue)||ye===_e||ye===void 0&&_e===void 0||Dg(A,o,Ue,ye,g,_e);return}}for(var fe in c)ye=c[fe],c.hasOwnProperty(fe)&&ye!=null&&!g.hasOwnProperty(fe)&&vr(A,o,fe,null,g,ye);for(Ie in g)ye=g[Ie],_e=c[Ie],!g.hasOwnProperty(Ie)||ye===_e||ye==null&&_e==null||vr(A,o,Ie,ye,g,_e)}function hy(A){switch(A){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vU(){if(typeof performance.getEntriesByType=="function"){for(var A=0,o=0,c=performance.getEntriesByType("resource"),g=0;g<c.length;g++){var w=c[g],B=w.transferSize,b=w.initiatorType,L=w.duration;if(B&&L&&hy(b)){for(b=0,L=w.responseEnd,g+=1;g<c.length;g++){var te=c[g],pe=te.startTime;if(pe>L)break;var Ue=te.transferSize,Ie=te.initiatorType;Ue&&hy(Ie)&&(te=te.responseEnd,b+=Ue*(te<L?1:(L-pe)/(te-pe)))}if(--g,o+=8*(B+b)/(w.duration/1e3),A++,10<A)break}}if(0<A)return o/A/1e6}return navigator.connection&&(A=navigator.connection.downlink,typeof A=="number")?A:5}var Mg=null,Lg=null;function R0(A){return A.nodeType===9?A:A.ownerDocument}function gy(A){switch(A){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function my(A,o){if(A===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return A===1&&o==="foreignObject"?0:A}function Hg(A,o){return A==="textarea"||A==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Og=null;function wU(){var A=window.event;return A&&A.type==="popstate"?A===Og?!1:(Og=A,!0):(Og=null,!1)}var py=typeof setTimeout=="function"?setTimeout:void 0,yU=typeof clearTimeout=="function"?clearTimeout:void 0,xy=typeof Promise=="function"?Promise:void 0,BU=typeof queueMicrotask=="function"?queueMicrotask:typeof xy<"u"?function(A){return xy.resolve(null).then(A).catch(CU)}:py;function CU(A){setTimeout(function(){throw A})}function Ls(A){return A==="head"}function vy(A,o){var c=o,g=0;do{var w=c.nextSibling;if(A.removeChild(c),w&&w.nodeType===8)if(c=w.data,c==="/$"||c==="/&"){if(g===0){A.removeChild(w),Xo(o);return}g--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")g++;else if(c==="html")dc(A.ownerDocument.documentElement);else if(c==="head"){c=A.ownerDocument.head,dc(c);for(var B=c.firstChild;B;){var b=B.nextSibling,L=B.nodeName;B[we]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&B.rel.toLowerCase()==="stylesheet"||c.removeChild(B),B=b}}else c==="body"&&dc(A.ownerDocument.body);c=w}while(c);Xo(o)}function wy(A,o){var c=A;A=0;do{var g=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(A===0)break;A--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||A++;c=g}while(c)}function Pg(A){var o=A.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Pg(c),Oe(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}A.removeChild(c)}}function EU(A,o,c,g){for(;A.nodeType===1;){var w=c;if(A.nodeName.toLowerCase()!==o.toLowerCase()){if(!g&&(A.nodeName!=="INPUT"||A.type!=="hidden"))break}else if(g){if(!A[we])switch(o){case"meta":if(!A.hasAttribute("itemprop"))break;return A;case"link":if(B=A.getAttribute("rel"),B==="stylesheet"&&A.hasAttribute("data-precedence"))break;if(B!==w.rel||A.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||A.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||A.getAttribute("title")!==(w.title==null?null:w.title))break;return A;case"style":if(A.hasAttribute("data-precedence"))break;return A;case"script":if(B=A.getAttribute("src"),(B!==(w.src==null?null:w.src)||A.getAttribute("type")!==(w.type==null?null:w.type)||A.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&B&&A.hasAttribute("async")&&!A.hasAttribute("itemprop"))break;return A;default:return A}}else if(o==="input"&&A.type==="hidden"){var B=w.name==null?null:""+w.name;if(w.type==="hidden"&&A.getAttribute("name")===B)return A}else return A;if(A=Ha(A.nextSibling),A===null)break}return null}function TU(A,o,c){if(o==="")return null;for(;A.nodeType!==3;)if((A.nodeType!==1||A.nodeName!=="INPUT"||A.type!=="hidden")&&!c||(A=Ha(A.nextSibling),A===null))return null;return A}function yy(A,o){for(;A.nodeType!==8;)if((A.nodeType!==1||A.nodeName!=="INPUT"||A.type!=="hidden")&&!o||(A=Ha(A.nextSibling),A===null))return null;return A}function Gg(A){return A.data==="$?"||A.data==="$~"}function Vg(A){return A.data==="$!"||A.data==="$?"&&A.ownerDocument.readyState!=="loading"}function SU(A,o){var c=A.ownerDocument;if(A.data==="$~")A._reactRetry=o;else if(A.data!=="$?"||c.readyState!=="loading")o();else{var g=function(){o(),c.removeEventListener("DOMContentLoaded",g)};c.addEventListener("DOMContentLoaded",g),A._reactRetry=g}}function Ha(A){for(;A!=null;A=A.nextSibling){var o=A.nodeType;if(o===1||o===3)break;if(o===8){if(o=A.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return A}var Kg=null;function By(A){A=A.nextSibling;for(var o=0;A;){if(A.nodeType===8){var c=A.data;if(c==="/$"||c==="/&"){if(o===0)return Ha(A.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}A=A.nextSibling}return null}function Cy(A){A=A.previousSibling;for(var o=0;A;){if(A.nodeType===8){var c=A.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return A;o--}else c!=="/$"&&c!=="/&"||o++}A=A.previousSibling}return null}function Ey(A,o,c){switch(o=R0(c),A){case"html":if(A=o.documentElement,!A)throw Error(n(452));return A;case"head":if(A=o.head,!A)throw Error(n(453));return A;case"body":if(A=o.body,!A)throw Error(n(454));return A;default:throw Error(n(451))}}function dc(A){for(var o=A.attributes;o.length;)A.removeAttributeNode(o[0]);Oe(A)}var Oa=new Map,Ty=new Set;function D0(A){return typeof A.getRootNode=="function"?A.getRootNode():A.nodeType===9?A:A.ownerDocument}var rs=ie.d;ie.d={f:_U,r:bU,D:FU,C:UU,L:kU,m:NU,X:QU,S:IU,M:RU};function _U(){var A=rs.f(),o=_0();return A||o}function bU(A){var o=Ye(A);o!==null&&o.tag===5&&o.type==="form"?G1(o):rs.r(A)}var Ko=typeof document>"u"?null:document;function Sy(A,o,c){var g=Ko;if(g&&typeof o=="string"&&o){var w=Se(o);w='link[rel="'+A+'"][href="'+w+'"]',typeof c=="string"&&(w+='[crossorigin="'+c+'"]'),Ty.has(w)||(Ty.add(w),A={rel:A,crossOrigin:c,href:o},g.querySelector(w)===null&&(o=g.createElement("link"),Fn(o,"link",A),ot(o),g.head.appendChild(o)))}}function FU(A){rs.D(A),Sy("dns-prefetch",A,null)}function UU(A,o){rs.C(A,o),Sy("preconnect",A,o)}function kU(A,o,c){rs.L(A,o,c);var g=Ko;if(g&&A&&o){var w='link[rel="preload"][as="'+Se(o)+'"]';o==="image"&&c&&c.imageSrcSet?(w+='[imagesrcset="'+Se(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(w+='[imagesizes="'+Se(c.imageSizes)+'"]')):w+='[href="'+Se(A)+'"]';var B=w;switch(o){case"style":B=jo(A);break;case"script":B=zo(A)}Oa.has(B)||(A=p({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:A,as:o},c),Oa.set(B,A),g.querySelector(w)!==null||o==="style"&&g.querySelector(hc(B))||o==="script"&&g.querySelector(gc(B))||(o=g.createElement("link"),Fn(o,"link",A),ot(o),g.head.appendChild(o)))}}function NU(A,o){rs.m(A,o);var c=Ko;if(c&&A){var g=o&&typeof o.as=="string"?o.as:"script",w='link[rel="modulepreload"][as="'+Se(g)+'"][href="'+Se(A)+'"]',B=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":B=zo(A)}if(!Oa.has(B)&&(A=p({rel:"modulepreload",href:A},o),Oa.set(B,A),c.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(gc(B)))return}g=c.createElement("link"),Fn(g,"link",A),ot(g),c.head.appendChild(g)}}}function IU(A,o,c){rs.S(A,o,c);var g=Ko;if(g&&A){var w=Xe(g).hoistableStyles,B=jo(A);o=o||"default";var b=w.get(B);if(!b){var L={loading:0,preload:null};if(b=g.querySelector(hc(B)))L.loading=5;else{A=p({rel:"stylesheet",href:A,"data-precedence":o},c),(c=Oa.get(B))&&jg(A,c);var te=b=g.createElement("link");ot(te),Fn(te,"link",A),te._p=new Promise(function(pe,Ue){te.onload=pe,te.onerror=Ue}),te.addEventListener("load",function(){L.loading|=1}),te.addEventListener("error",function(){L.loading|=2}),L.loading|=4,M0(b,o,g)}b={type:"stylesheet",instance:b,count:1,state:L},w.set(B,b)}}}function QU(A,o){rs.X(A,o);var c=Ko;if(c&&A){var g=Xe(c).hoistableScripts,w=zo(A),B=g.get(w);B||(B=c.querySelector(gc(w)),B||(A=p({src:A,async:!0},o),(o=Oa.get(w))&&zg(A,o),B=c.createElement("script"),ot(B),Fn(B,"link",A),c.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},g.set(w,B))}}function RU(A,o){rs.M(A,o);var c=Ko;if(c&&A){var g=Xe(c).hoistableScripts,w=zo(A),B=g.get(w);B||(B=c.querySelector(gc(w)),B||(A=p({src:A,async:!0,type:"module"},o),(o=Oa.get(w))&&zg(A,o),B=c.createElement("script"),ot(B),Fn(B,"link",A),c.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},g.set(w,B))}}function _y(A,o,c,g){var w=(w=ce.current)?D0(w):null;if(!w)throw Error(n(446));switch(A){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=jo(c.href),c=Xe(w).hoistableStyles,g=c.get(o),g||(g={type:"style",instance:null,count:0,state:null},c.set(o,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){A=jo(c.href);var B=Xe(w).hoistableStyles,b=B.get(A);if(b||(w=w.ownerDocument||w,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},B.set(A,b),(B=w.querySelector(hc(A)))&&!B._p&&(b.instance=B,b.state.loading=5),Oa.has(A)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Oa.set(A,c),B||DU(w,A,c,b.state))),o&&g===null)throw Error(n(528,""));return b}if(o&&g!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=zo(c),c=Xe(w).hoistableScripts,g=c.get(o),g||(g={type:"script",instance:null,count:0,state:null},c.set(o,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,A))}}function jo(A){return'href="'+Se(A)+'"'}function hc(A){return'link[rel="stylesheet"]['+A+"]"}function by(A){return p({},A,{"data-precedence":A.precedence,precedence:null})}function DU(A,o,c,g){A.querySelector('link[rel="preload"][as="style"]['+o+"]")?g.loading=1:(o=A.createElement("link"),g.preload=o,o.addEventListener("load",function(){return g.loading|=1}),o.addEventListener("error",function(){return g.loading|=2}),Fn(o,"link",c),ot(o),A.head.appendChild(o))}function zo(A){return'[src="'+Se(A)+'"]'}function gc(A){return"script[async]"+A}function Fy(A,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var g=A.querySelector('style[data-href~="'+Se(c.href)+'"]');if(g)return o.instance=g,ot(g),g;var w=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return g=(A.ownerDocument||A).createElement("style"),ot(g),Fn(g,"style",w),M0(g,c.precedence,A),o.instance=g;case"stylesheet":w=jo(c.href);var B=A.querySelector(hc(w));if(B)return o.state.loading|=4,o.instance=B,ot(B),B;g=by(c),(w=Oa.get(w))&&jg(g,w),B=(A.ownerDocument||A).createElement("link"),ot(B);var b=B;return b._p=new Promise(function(L,te){b.onload=L,b.onerror=te}),Fn(B,"link",g),o.state.loading|=4,M0(B,c.precedence,A),o.instance=B;case"script":return B=zo(c.src),(w=A.querySelector(gc(B)))?(o.instance=w,ot(w),w):(g=c,(w=Oa.get(B))&&(g=p({},c),zg(g,w)),A=A.ownerDocument||A,w=A.createElement("script"),ot(w),Fn(w,"link",g),A.head.appendChild(w),o.instance=w);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(g=o.instance,o.state.loading|=4,M0(g,c.precedence,A));return o.instance}function M0(A,o,c){for(var g=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,B=w,b=0;b<g.length;b++){var L=g[b];if(L.dataset.precedence===o)B=L;else if(B!==w)break}B?B.parentNode.insertBefore(A,B.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(A,o.firstChild))}function jg(A,o){A.crossOrigin==null&&(A.crossOrigin=o.crossOrigin),A.referrerPolicy==null&&(A.referrerPolicy=o.referrerPolicy),A.title==null&&(A.title=o.title)}function zg(A,o){A.crossOrigin==null&&(A.crossOrigin=o.crossOrigin),A.referrerPolicy==null&&(A.referrerPolicy=o.referrerPolicy),A.integrity==null&&(A.integrity=o.integrity)}var L0=null;function Uy(A,o,c){if(L0===null){var g=new Map,w=L0=new Map;w.set(c,g)}else w=L0,g=w.get(c),g||(g=new Map,w.set(c,g));if(g.has(A))return g;for(g.set(A,null),c=c.getElementsByTagName(A),w=0;w<c.length;w++){var B=c[w];if(!(B[we]||B[O]||A==="link"&&B.getAttribute("rel")==="stylesheet")&&B.namespaceURI!=="http://www.w3.org/2000/svg"){var b=B.getAttribute(o)||"";b=A+b;var L=g.get(b);L?L.push(B):g.set(b,[B])}}return g}function ky(A,o,c){A=A.ownerDocument||A,A.head.insertBefore(c,o==="title"?A.querySelector("head > title"):null)}function MU(A,o,c){if(c===1||o.itemProp!=null)return!1;switch(A){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return A=o.disabled,typeof o.precedence=="string"&&A==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Ny(A){return!(A.type==="stylesheet"&&(A.state.loading&3)===0)}function LU(A,o,c,g){if(c.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=jo(g.href),B=o.querySelector(hc(w));if(B){o=B._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(A.count++,A=H0.bind(A),o.then(A,A)),c.state.loading|=4,c.instance=B,ot(B);return}B=o.ownerDocument||o,g=by(g),(w=Oa.get(w))&&jg(g,w),B=B.createElement("link"),ot(B);var b=B;b._p=new Promise(function(L,te){b.onload=L,b.onerror=te}),Fn(B,"link",g),c.instance=B}A.stylesheets===null&&(A.stylesheets=new Map),A.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(A.count++,c=H0.bind(A),o.addEventListener("load",c),o.addEventListener("error",c))}}var Xg=0;function HU(A,o){return A.stylesheets&&A.count===0&&P0(A,A.stylesheets),0<A.count||0<A.imgCount?function(c){var g=setTimeout(function(){if(A.stylesheets&&P0(A,A.stylesheets),A.unsuspend){var B=A.unsuspend;A.unsuspend=null,B()}},6e4+o);0<A.imgBytes&&Xg===0&&(Xg=62500*vU());var w=setTimeout(function(){if(A.waitingForImages=!1,A.count===0&&(A.stylesheets&&P0(A,A.stylesheets),A.unsuspend)){var B=A.unsuspend;A.unsuspend=null,B()}},(A.imgBytes>Xg?50:800)+o);return A.unsuspend=c,function(){A.unsuspend=null,clearTimeout(g),clearTimeout(w)}}:null}function H0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)P0(this,this.stylesheets);else if(this.unsuspend){var A=this.unsuspend;this.unsuspend=null,A()}}}var O0=null;function P0(A,o){A.stylesheets=null,A.unsuspend!==null&&(A.count++,O0=new Map,o.forEach(OU,A),O0=null,H0.call(A))}function OU(A,o){if(!(o.state.loading&4)){var c=O0.get(A);if(c)var g=c.get(null);else{c=new Map,O0.set(A,c);for(var w=A.querySelectorAll("link[data-precedence],style[data-precedence]"),B=0;B<w.length;B++){var b=w[B];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),g=b)}g&&c.set(null,g)}w=o.instance,b=w.getAttribute("data-precedence"),B=c.get(b)||g,B===g&&c.set(null,w),c.set(b,w),this.count++,g=H0.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),B?B.parentNode.insertBefore(w,B.nextSibling):(A=A.nodeType===9?A.head:A,A.insertBefore(w,A.firstChild)),o.state.loading|=4}}var mc={$$typeof:_,Provider:null,Consumer:null,_currentValue:Qe,_currentValue2:Qe,_threadCount:0};function PU(A,o,c,g,w,B,b,L,te){this.tag=1,this.containerInfo=A,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gi(0),this.hiddenUpdates=gi(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=B,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function Iy(A,o,c,g,w,B,b,L,te,pe,Ue,Ie){return A=new PU(A,o,c,b,te,pe,Ue,Ie,L),o=1,B===!0&&(o|=24),B=pa(3,null,null,o),A.current=B,B.stateNode=A,o=Sh(),o.refCount++,A.pooledCache=o,o.refCount++,B.memoizedState={element:g,isDehydrated:c,cache:o},Uh(B),A}function Qy(A){return A?(A=Co,A):Co}function Ry(A,o,c,g,w,B){w=Qy(w),g.context===null?g.context=w:g.pendingContext=w,g=_s(o),g.payload={element:c},B=B===void 0?null:B,B!==null&&(g.callback=B),c=bs(A,g,o),c!==null&&(la(c,A,o),Wl(c,A,o))}function Dy(A,o){if(A=A.memoizedState,A!==null&&A.dehydrated!==null){var c=A.retryLane;A.retryLane=c!==0&&c<o?c:o}}function Wg(A,o){Dy(A,o),(A=A.alternate)&&Dy(A,o)}function My(A){if(A.tag===13||A.tag===31){var o=Bi(A,67108864);o!==null&&la(o,A,67108864),Wg(A,67108864)}}function Ly(A){if(A.tag===13||A.tag===31){var o=Ba();o=mi(o);var c=Bi(A,o);c!==null&&la(c,A,o),Wg(A,o)}}var G0=!0;function GU(A,o,c,g){var w=Z.T;Z.T=null;var B=ie.p;try{ie.p=2,Jg(A,o,c,g)}finally{ie.p=B,Z.T=w}}function VU(A,o,c,g){var w=Z.T;Z.T=null;var B=ie.p;try{ie.p=8,Jg(A,o,c,g)}finally{ie.p=B,Z.T=w}}function Jg(A,o,c,g){if(G0){var w=Yg(g);if(w===null)Rg(A,o,g,V0,c),Oy(A,g);else if(jU(w,A,o,c,g))g.stopPropagation();else if(Oy(A,g),o&4&&-1<KU.indexOf(A)){for(;w!==null;){var B=Ye(w);if(B!==null)switch(B.tag){case 3:if(B=B.stateNode,B.current.memoizedState.isDehydrated){var b=ar(B.pendingLanes);if(b!==0){var L=B;for(L.pendingLanes|=2,L.entangledLanes|=2;b;){var te=1<<31-Sr(b);L.entanglements[1]|=te,b&=~te}CA(B),(Ar&6)===0&&(T0=dt()+500,cc(0))}}break;case 31:case 13:L=Bi(B,2),L!==null&&la(L,B,2),_0(),Wg(B,2)}if(B=Yg(g),B===null&&Rg(A,o,g,V0,c),B===w)break;w=B}w!==null&&g.stopPropagation()}else Rg(A,o,g,null,c)}}function Yg(A){return A=ur(A),qg(A)}var V0=null;function qg(A){if(V0=null,A=Ve(A),A!==null){var o=s(A);if(o===null)A=null;else{var c=o.tag;if(c===13){if(A=i(o),A!==null)return A;A=null}else if(c===31){if(A=l(o),A!==null)return A;A=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;A=null}else o!==A&&(A=null)}}return V0=A,null}function Hy(A){switch(A){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case We:return 2;case _t:return 8;case ft:case Bt:return 32;case et:return 268435456;default:return 32}default:return 32}}var $g=!1,Hs=null,Os=null,Ps=null,pc=new Map,xc=new Map,Gs=[],KU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Oy(A,o){switch(A){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":Os=null;break;case"mouseover":case"mouseout":Ps=null;break;case"pointerover":case"pointerout":pc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":xc.delete(o.pointerId)}}function vc(A,o,c,g,w,B){return A===null||A.nativeEvent!==B?(A={blockedOn:o,domEventName:c,eventSystemFlags:g,nativeEvent:B,targetContainers:[w]},o!==null&&(o=Ye(o),o!==null&&My(o)),A):(A.eventSystemFlags|=g,o=A.targetContainers,w!==null&&o.indexOf(w)===-1&&o.push(w),A)}function jU(A,o,c,g,w){switch(o){case"focusin":return Hs=vc(Hs,A,o,c,g,w),!0;case"dragenter":return Os=vc(Os,A,o,c,g,w),!0;case"mouseover":return Ps=vc(Ps,A,o,c,g,w),!0;case"pointerover":var B=w.pointerId;return pc.set(B,vc(pc.get(B)||null,A,o,c,g,w)),!0;case"gotpointercapture":return B=w.pointerId,xc.set(B,vc(xc.get(B)||null,A,o,c,g,w)),!0}return!1}function Py(A){var o=Ve(A.target);if(o!==null){var c=s(o);if(c!==null){if(o=c.tag,o===13){if(o=i(c),o!==null){A.blockedOn=o,j(A.priority,function(){Ly(c)});return}}else if(o===31){if(o=l(c),o!==null){A.blockedOn=o,j(A.priority,function(){Ly(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){A.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}A.blockedOn=null}function K0(A){if(A.blockedOn!==null)return!1;for(var o=A.targetContainers;0<o.length;){var c=Yg(A.nativeEvent);if(c===null){c=A.nativeEvent;var g=new c.constructor(c.type,c);at=g,c.target.dispatchEvent(g),at=null}else return o=Ye(c),o!==null&&My(o),A.blockedOn=c,!1;o.shift()}return!0}function Gy(A,o,c){K0(A)&&c.delete(o)}function zU(){$g=!1,Hs!==null&&K0(Hs)&&(Hs=null),Os!==null&&K0(Os)&&(Os=null),Ps!==null&&K0(Ps)&&(Ps=null),pc.forEach(Gy),xc.forEach(Gy)}function j0(A,o){A.blockedOn===o&&(A.blockedOn=null,$g||($g=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zU)))}var z0=null;function Vy(A){z0!==A&&(z0=A,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){z0===A&&(z0=null);for(var o=0;o<A.length;o+=3){var c=A[o],g=A[o+1],w=A[o+2];if(typeof g!="function"){if(qg(g||c)===null)continue;break}var B=Ye(c);B!==null&&(A.splice(o,3),o-=3,Yh(B,{pending:!0,data:w,method:c.method,action:g},g,w))}}))}function Xo(A){function o(te){return j0(te,A)}Hs!==null&&j0(Hs,A),Os!==null&&j0(Os,A),Ps!==null&&j0(Ps,A),pc.forEach(o),xc.forEach(o);for(var c=0;c<Gs.length;c++){var g=Gs[c];g.blockedOn===A&&(g.blockedOn=null)}for(;0<Gs.length&&(c=Gs[0],c.blockedOn===null);)Py(c),c.blockedOn===null&&Gs.shift();if(c=(A.ownerDocument||A).$$reactFormReplay,c!=null)for(g=0;g<c.length;g+=3){var w=c[g],B=c[g+1],b=w[V]||null;if(typeof B=="function")b||Vy(c);else if(b){var L=null;if(B&&B.hasAttribute("formAction")){if(w=B,b=B[V]||null)L=b.formAction;else if(qg(w)!==null)continue}else L=b.action;typeof L=="function"?c[g+1]=L:(c.splice(g,3),g-=3),Vy(c)}}}function Ky(){function A(B){B.canIntercept&&B.info==="react-transition"&&B.intercept({handler:function(){return new Promise(function(b){return w=b})},focusReset:"manual",scroll:"manual"})}function o(){w!==null&&(w(),w=null),g||setTimeout(c,20)}function c(){if(!g&&!navigation.transition){var B=navigation.currentEntry;B&&B.url!=null&&navigation.navigate(B.url,{state:B.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,w=null;return navigation.addEventListener("navigate",A),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){g=!0,navigation.removeEventListener("navigate",A),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),w!==null&&(w(),w=null)}}}function Zg(A){this._internalRoot=A}X0.prototype.render=Zg.prototype.render=function(A){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,g=Ba();Ry(c,g,A,o,null,null)},X0.prototype.unmount=Zg.prototype.unmount=function(){var A=this._internalRoot;if(A!==null){this._internalRoot=null;var o=A.containerInfo;Ry(A.current,2,null,A,null,null),_0(),o[J]=null}};function X0(A){this._internalRoot=A}X0.prototype.unstable_scheduleHydration=function(A){if(A){var o=D();A={blockedOn:null,target:A,priority:o};for(var c=0;c<Gs.length&&o!==0&&o<Gs[c].priority;c++);Gs.splice(c,0,A),c===0&&Py(A)}};var jy=t.version;if(jy!=="19.2.4")throw Error(n(527,jy,"19.2.4"));ie.findDOMNode=function(A){var o=A._reactInternals;if(o===void 0)throw typeof A.render=="function"?Error(n(188)):(A=Object.keys(A).join(","),Error(n(268,A)));return A=f(o),A=A!==null?d(A):null,A=A===null?null:A.stateNode,A};var XU={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var W0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!W0.isDisabled&&W0.supportsFiber)try{xt=W0.inject(XU),zt=W0}catch{}}return yc.createRoot=function(A,o){if(!a(A))throw Error(n(299));var c=!1,g="",w=$1,B=Z1,b=ew;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(w=o.onUncaughtError),o.onCaughtError!==void 0&&(B=o.onCaughtError),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=Iy(A,1,!1,null,null,c,g,null,w,B,b,Ky),A[J]=o.current,Qg(A),new Zg(o)},yc.hydrateRoot=function(A,o,c){if(!a(A))throw Error(n(299));var g=!1,w="",B=$1,b=Z1,L=ew,te=null;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onUncaughtError!==void 0&&(B=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(L=c.onRecoverableError),c.formState!==void 0&&(te=c.formState)),o=Iy(A,1,!0,o,c??null,g,w,te,B,b,L,Ky),o.context=Qy(null),c=o.current,g=Ba(),g=mi(g),w=_s(g),w.callback=null,bs(c,w,g),c=g,o.current.lanes=c,HA(o,c),CA(o),A[J]=o.current,Qg(A),new X0(o)},yc.version="19.2.4",yc}var tB;function ak(){if(tB)return rm.exports;tB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),rm.exports=nk(),rm.exports}var Ak=ak();const sk=ax(Ak);/**
 * react-router v7.13.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var rB="popstate";function nB(e){return typeof e=="object"&&e!=null&&"pathname"in e&&"search"in e&&"hash"in e&&"state"in e&&"key"in e}function ik(e={}){function t(a,s){let{pathname:i="/",search:l="",hash:u=""}=no(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),tp("",{pathname:i,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(a,s){let i=a.document.querySelector("base"),l="";if(i&&i.getAttribute("href")){let u=a.location.href,f=u.indexOf("#");l=f===-1?u:u.slice(0,f)}return l+"#"+(typeof s=="string"?s:su(s))}function n(a,s){Za(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return lk(t,r,n,e)}function Dr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Za(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ok(){return Math.random().toString(36).substring(2,10)}function aB(e,t){return{usr:e.state,key:e.key,idx:t,masked:e.unstable_mask?{pathname:e.pathname,search:e.search,hash:e.hash}:void 0}}function tp(e,t,r=null,n,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?no(t):t,state:r,key:t&&t.key||n||ok(),unstable_mask:a}}function su({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function no(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function lk(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,l="POP",u=null,f=d();f==null&&(f=0,i.replaceState({...i.state,idx:f},""));function d(){return(i.state||{idx:null}).idx}function p(){l="POP";let T=d(),S=T==null?null:T-f;f=T,u&&u({action:l,location:E.location,delta:S})}function x(T,S){l="PUSH";let F=nB(T)?T:tp(E.location,T,S);r&&r(F,T),f=d()+1;let _=aB(F,f),N=E.createHref(F.unstable_mask||F);try{i.pushState(_,"",N)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;a.location.assign(N)}s&&u&&u({action:l,location:E.location,delta:1})}function y(T,S){l="REPLACE";let F=nB(T)?T:tp(E.location,T,S);r&&r(F,T),f=d();let _=aB(F,f),N=E.createHref(F.unstable_mask||F);i.replaceState(_,"",N),s&&u&&u({action:l,location:E.location,delta:0})}function C(T){return ck(T)}let E={get action(){return l},get location(){return e(a,i)},listen(T){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(rB,p),u=T,()=>{a.removeEventListener(rB,p),u=null}},createHref(T){return t(a,T)},createURL:C,encodeLocation(T){let S=C(T);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:y,go(T){return i.go(T)}};return E}function ck(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Dr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:su(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function fT(e,t,r="/"){return uk(e,t,r,!1)}function uk(e,t,r,n){let a=typeof t=="string"?no(t):t,s=cs(a.pathname||"/",r);if(s==null)return null;let i=dT(e);fk(i);let l=null;for(let u=0;l==null&&u<i.length;++u){let f=Ck(s);l=yk(i[u],f,n)}return l}function dT(e,t=[],r=[],n="",a=!1){let s=(i,l,u=a,f)=>{let d={relativePath:f===void 0?i.path||"":f,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&u)return;Dr(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let p=UA([n,d.relativePath]),x=r.concat(d);i.children&&i.children.length>0&&(Dr(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),dT(i.children,t,x,p,u)),!(i.path==null&&!i.index)&&t.push({path:p,score:vk(p,i.index),routesMeta:x})};return e.forEach((i,l)=>{var u;if(i.path===""||!((u=i.path)!=null&&u.includes("?")))s(i,l);else for(let f of hT(i.path))s(i,l,!0,f)}),t}function hT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=hT(n.join("/")),l=[];return l.push(...i.map(u=>u===""?s:[s,u].join("/"))),a&&l.push(...i),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function fk(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:wk(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var dk=/^:[\w-]+$/,hk=3,gk=2,mk=1,pk=10,xk=-2,AB=e=>e==="*";function vk(e,t){let r=e.split("/"),n=r.length;return r.some(AB)&&(n+=xk),t&&(n+=gk),r.filter(a=>!AB(a)).reduce((a,s)=>a+(dk.test(s)?hk:s===""?mk:pk),n)}function wk(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function yk(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let l=0;l<n.length;++l){let u=n[l],f=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",p=qf({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},d),x=u.route;if(!p&&f&&r&&!n[n.length-1].route.index&&(p=qf({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!p)return null;Object.assign(a,p.params),i.push({params:a,pathname:UA([s,p.pathname]),pathnameBase:_k(UA([s,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(s=UA([s,p.pathnameBase]))}return i}function qf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Bk(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:p},x)=>{if(d==="*"){let C=l[x]||"";i=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const y=l[x];return p&&!y?f[d]=void 0:f[d]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:i,pattern:e}}function Bk(e,t=!1,r=!0){Za(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,u,f,d)=>{if(n.push({paramName:l,isOptional:u!=null}),u){let p=d.charAt(f+i.length);return p&&p!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Ck(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Za(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function cs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var Ek=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Tk(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?no(e):e,s;return r?(r=r.replace(/\/\/+/g,"/"),r.startsWith("/")?s=sB(r.substring(1),"/"):s=sB(r,t)):s=t,{pathname:s,search:bk(n),hash:Fk(a)}}function sB(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function sm(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Sk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function sx(e){let t=Sk(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function bd(e,t,r,n=!1){let a;typeof e=="string"?a=no(e):(a={...e},Dr(!a.pathname||!a.pathname.includes("?"),sm("?","pathname","search",a)),Dr(!a.pathname||!a.pathname.includes("#"),sm("#","pathname","hash",a)),Dr(!a.search||!a.search.includes("#"),sm("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,l;if(i==null)l=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let x=i.split("/");for(;x[0]==="..";)x.shift(),p-=1;a.pathname=x.join("/")}l=p>=0?t[p]:"/"}let u=Tk(a,l),f=i&&i!=="/"&&i.endsWith("/"),d=(s||i===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||d)&&(u.pathname+="/"),u}var UA=e=>e.join("/").replace(/\/\/+/g,"/"),_k=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),bk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Fk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Uk=class{constructor(e,t,r,n=!1){this.status=e,this.statusText=t||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function kk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function Nk(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var gT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function mT(e,t){let r=e;if(typeof r!="string"||!Ek.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,a=!1;if(gT)try{let s=new URL(window.location.href),i=r.startsWith("//")?new URL(s.protocol+r):new URL(r),l=cs(i.pathname,t);i.origin===s.origin&&l!=null?r=l+i.search+i.hash:a=!0}catch{Za(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:a,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var pT=["POST","PUT","PATCH","DELETE"];new Set(pT);var Ik=["GET",...pT];new Set(Ik);var Cl=W.createContext(null);Cl.displayName="DataRouter";var Fd=W.createContext(null);Fd.displayName="DataRouterState";var Qk=W.createContext(!1),xT=W.createContext({isTransitioning:!1});xT.displayName="ViewTransition";var Rk=W.createContext(new Map);Rk.displayName="Fetchers";var Dk=W.createContext(null);Dk.displayName="Await";var Ua=W.createContext(null);Ua.displayName="Navigation";var Su=W.createContext(null);Su.displayName="Location";var kA=W.createContext({outlet:null,matches:[],isDataRoute:!1});kA.displayName="Route";var ix=W.createContext(null);ix.displayName="RouteError";var vT="REACT_ROUTER_ERROR",Mk="REDIRECT",Lk="ROUTE_ERROR_RESPONSE";function Hk(e){if(e.startsWith(`${vT}:${Mk}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Ok(e){if(e.startsWith(`${vT}:${Lk}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new Uk(t.status,t.statusText,t.data)}catch{}}function Pk(e,{relative:t}={}){Dr(El(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=W.useContext(Ua),{hash:a,pathname:s,search:i}=_u(e,{relative:t}),l=s;return r!=="/"&&(l=s==="/"?r:UA([r,s])),n.createHref({pathname:l,search:i,hash:a})}function El(){return W.useContext(Su)!=null}function NA(){return Dr(El(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(Su).location}var wT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yT(e){W.useContext(Ua).static||W.useLayoutEffect(e)}function Ud(){let{isDataRoute:e}=W.useContext(kA);return e?eN():Gk()}function Gk(){Dr(El(),"useNavigate() may be used only in the context of a <Router> component.");let e=W.useContext(Cl),{basename:t,navigator:r}=W.useContext(Ua),{matches:n}=W.useContext(kA),{pathname:a}=NA(),s=JSON.stringify(sx(n)),i=W.useRef(!1);return yT(()=>{i.current=!0}),W.useCallback((u,f={})=>{if(Za(i.current,wT),!i.current)return;if(typeof u=="number"){r.go(u);return}let d=bd(u,JSON.parse(s),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:UA([t,d.pathname])),(f.replace?r.replace:r.push)(d,f.state,f)},[t,r,s,a,e])}W.createContext(null);function _u(e,{relative:t}={}){let{matches:r}=W.useContext(kA),{pathname:n}=NA(),a=JSON.stringify(sx(r));return W.useMemo(()=>bd(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function Vk(e,t){return BT(e,t)}function BT(e,t,r){var T;Dr(El(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=W.useContext(Ua),{matches:a}=W.useContext(kA),s=a[a.length-1],i=s?s.params:{},l=s?s.pathname:"/",u=s?s.pathnameBase:"/",f=s&&s.route;{let S=f&&f.path||"";ET(l,!f||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let d=NA(),p;if(t){let S=typeof t=="string"?no(t):t;Dr(u==="/"||((T=S.pathname)==null?void 0:T.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${S.pathname}" was given in the \`location\` prop.`),p=S}else p=d;let x=p.pathname||"/",y=x;if(u!=="/"){let S=u.replace(/^\//,"").split("/");y="/"+x.replace(/^\//,"").split("/").slice(S.length).join("/")}let C=fT(e,{pathname:y});Za(f||C!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Za(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=Wk(C&&C.map(S=>Object.assign({},S,{params:Object.assign({},i,S.params),pathname:UA([u,n.encodeLocation?n.encodeLocation(S.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:UA([u,n.encodeLocation?n.encodeLocation(S.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathnameBase])})),a,r);return t&&E?W.createElement(Su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",unstable_mask:void 0,...p},navigationType:"POP"}},E):E}function Kk(){let e=Zk(),t=kk(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=W.createElement(W.Fragment,null,W.createElement("p",null," Hey developer "),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:s},"ErrorBoundary")," or"," ",W.createElement("code",{style:s},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},t),r?W.createElement("pre",{style:a},r):null,i)}var jk=W.createElement(Kk,null),CT=class extends W.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=Ok(e.digest);r&&(e=r)}let t=e!==void 0?W.createElement(kA.Provider,{value:this.props.routeContext},W.createElement(ix.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?W.createElement(zk,{error:e},t):t}};CT.contextType=Qk;var im=new WeakMap;function zk({children:e,error:t}){let{basename:r}=W.useContext(Ua);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=Hk(t.digest);if(n){let a=im.get(t);if(a)throw a;let s=mT(n.location,r);if(gT&&!im.get(t))if(s.isExternal||n.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const i=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:n.replace}));throw im.set(t,i),i}return W.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return e}function Xk({routeContext:e,match:t,children:r}){let n=W.useContext(Cl);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),W.createElement(kA.Provider,{value:e},r)}function Wk(e,t=[],r){let n=r==null?void 0:r.state;if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,s=n==null?void 0:n.errors;if(s!=null){let d=a.findIndex(p=>p.route.id&&(s==null?void 0:s[p.route.id])!==void 0);Dr(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let i=!1,l=-1;if(r&&n){i=n.renderFallback;for(let d=0;d<a.length;d++){let p=a[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(l=d),p.route.id){let{loaderData:x,errors:y}=n,C=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||C){r.isStatic&&(i=!0),l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}}let u=r==null?void 0:r.onError,f=n&&u?(d,p)=>{var x,y;u(d,{location:n.location,params:((y=(x=n.matches)==null?void 0:x[0])==null?void 0:y.params)??{},unstable_pattern:Nk(n.matches),errorInfo:p})}:void 0;return a.reduceRight((d,p,x)=>{let y,C=!1,E=null,T=null;n&&(y=s&&p.route.id?s[p.route.id]:void 0,E=p.route.errorElement||jk,i&&(l<0&&x===0?(ET("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,T=null):l===x&&(C=!0,T=p.route.hydrateFallbackElement||null)));let S=t.concat(a.slice(0,x+1)),F=()=>{let _;return y?_=E:C?_=T:p.route.Component?_=W.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=d,W.createElement(Xk,{match:p,routeContext:{outlet:d,matches:S,isDataRoute:n!=null},children:_})};return n&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?W.createElement(CT,{location:n.location,revalidation:n.revalidation,component:E,error:y,children:F(),routeContext:{outlet:null,matches:S,isDataRoute:!0},onError:f}):F()},null)}function ox(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jk(e){let t=W.useContext(Cl);return Dr(t,ox(e)),t}function Yk(e){let t=W.useContext(Fd);return Dr(t,ox(e)),t}function qk(e){let t=W.useContext(kA);return Dr(t,ox(e)),t}function lx(e){let t=qk(e),r=t.matches[t.matches.length-1];return Dr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function $k(){return lx("useRouteId")}function Zk(){var n;let e=W.useContext(ix),t=Yk("useRouteError"),r=lx("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function eN(){let{router:e}=Jk("useNavigate"),t=lx("useNavigate"),r=W.useRef(!1);return yT(()=>{r.current=!0}),W.useCallback(async(a,s={})=>{Za(r.current,wT),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var iB={};function ET(e,t,r){!t&&!iB[e]&&(iB[e]=!0,Za(!1,r))}W.memo(tN);function tN({routes:e,future:t,state:r,isStatic:n,onError:a}){return BT(e,void 0,{state:r,isStatic:n,onError:a})}function rp({to:e,replace:t,state:r,relative:n}){Dr(El(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=W.useContext(Ua);Za(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=W.useContext(kA),{pathname:i}=NA(),l=Ud(),u=bd(e,sx(s),i,n==="path"),f=JSON.stringify(u);return W.useEffect(()=>{l(JSON.parse(f),{replace:t,state:r,relative:n})},[l,f,n,t,r]),null}function Hi(e){Dr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rN({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1,unstable_useTransitions:i}){Dr(!El(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),u=W.useMemo(()=>({basename:l,navigator:a,static:s,unstable_useTransitions:i,future:{}}),[l,a,s,i]);typeof r=="string"&&(r=no(r));let{pathname:f="/",search:d="",hash:p="",state:x=null,key:y="default",unstable_mask:C}=r,E=W.useMemo(()=>{let T=cs(f,l);return T==null?null:{location:{pathname:T,search:d,hash:p,state:x,key:y,unstable_mask:C},navigationType:n}},[l,f,d,p,x,y,n,C]);return Za(E!=null,`<Router basename="${l}"> is not able to match the URL "${f}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:W.createElement(Ua.Provider,{value:u},W.createElement(Su.Provider,{children:t,value:E}))}function nN({children:e,location:t}){return Vk(np(e),t)}function np(e,t=[]){let r=[];return W.Children.forEach(e,(n,a)=>{if(!W.isValidElement(n))return;let s=[...t,a];if(n.type===W.Fragment){r.push.apply(r,np(n.props.children,s));return}Dr(n.type===Hi,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Dr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=np(n.props.children,s)),r.push(i)}),r}var Vf="get",Kf="application/x-www-form-urlencoded";function kd(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function aN(e){return kd(e)&&e.tagName.toLowerCase()==="button"}function AN(e){return kd(e)&&e.tagName.toLowerCase()==="form"}function sN(e){return kd(e)&&e.tagName.toLowerCase()==="input"}function iN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function oN(e,t){return e.button===0&&(!t||t==="_self")&&!iN(e)}var J0=null;function lN(){if(J0===null)try{new FormData(document.createElement("form"),0),J0=!1}catch{J0=!0}return J0}var cN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function om(e){return e!=null&&!cN.has(e)?(Za(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Kf}"`),null):e}function uN(e,t){let r,n,a,s,i;if(AN(e)){let l=e.getAttribute("action");n=l?cs(l,t):null,r=e.getAttribute("method")||Vf,a=om(e.getAttribute("enctype"))||Kf,s=new FormData(e)}else if(aN(e)||sN(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?cs(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Vf,a=om(e.getAttribute("formenctype"))||om(l.getAttribute("enctype"))||Kf,s=new FormData(l,e),!lN()){let{name:f,type:d,value:p}=e;if(d==="image"){let x=f?`${f}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else f&&s.append(f,p)}}else{if(kd(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Vf,n=null,a=Kf,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cx(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function fN(e,t,r,n){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${n}`:a.pathname=`${a.pathname}.${n}`:a.pathname==="/"?a.pathname=`_root.${n}`:t&&cs(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}async function dN(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function hN(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function gN(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let i=await dN(s,r);return i.links?i.links():[]}return[]}));return vN(n.flat(1).filter(hN).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function oB(e,t,r,n,a,s){let i=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,l=(u,f)=>{var d;return r[f].pathname!==u.pathname||((d=r[f].route.path)==null?void 0:d.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return s==="assets"?t.filter((u,f)=>i(u,f)||l(u,f)):s==="data"?t.filter((u,f)=>{var p;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(i(u,f)||l(u,f))return!0;if(u.route.shouldRevalidate){let x=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((p=r[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function mN(e,t,{includeHydrateFallback:r}={}){return pN(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function pN(e){return[...new Set(e)]}function xN(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function vN(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(xN(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function TT(){let e=W.useContext(Cl);return cx(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function wN(){let e=W.useContext(Fd);return cx(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var ux=W.createContext(void 0);ux.displayName="FrameworkContext";function ST(){let e=W.useContext(ux);return cx(e,"You must render this element inside a <HydratedRouter> element"),e}function yN(e,t){let r=W.useContext(ux),[n,a]=W.useState(!1),[s,i]=W.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:f,onMouseLeave:d,onTouchStart:p}=t,x=W.useRef(null);W.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let E=S=>{S.forEach(F=>{i(F.isIntersecting)})},T=new IntersectionObserver(E,{threshold:.5});return x.current&&T.observe(x.current),()=>{T.disconnect()}}},[e]),W.useEffect(()=>{if(n){let E=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(E)}}},[n]);let y=()=>{a(!0)},C=()=>{a(!1),i(!1)};return r?e!=="intent"?[s,x,{}]:[s,x,{onFocus:Bc(l,y),onBlur:Bc(u,C),onMouseEnter:Bc(f,y),onMouseLeave:Bc(d,C),onTouchStart:Bc(p,y)}]:[!1,x,{}]}function Bc(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function BN({page:e,...t}){let{router:r}=TT(),n=W.useMemo(()=>fT(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?W.createElement(EN,{page:e,matches:n,...t}):null}function CN(e){let{manifest:t,routeModules:r}=ST(),[n,a]=W.useState([]);return W.useEffect(()=>{let s=!1;return gN(e,t,r).then(i=>{s||a(i)}),()=>{s=!0}},[e,t,r]),n}function EN({page:e,matches:t,...r}){let n=NA(),{future:a,manifest:s,routeModules:i}=ST(),{basename:l}=TT(),{loaderData:u,matches:f}=wN(),d=W.useMemo(()=>oB(e,t,f,s,n,"data"),[e,t,f,s,n]),p=W.useMemo(()=>oB(e,t,f,s,n,"assets"),[e,t,f,s,n]),x=W.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let E=new Set,T=!1;if(t.forEach(F=>{var N;let _=s.routes[F.route.id];!_||!_.hasLoader||(!d.some(I=>I.route.id===F.route.id)&&F.route.id in u&&((N=i[F.route.id])!=null&&N.shouldRevalidate)||_.hasClientLoader?T=!0:E.add(F.route.id))}),E.size===0)return[];let S=fN(e,l,a.unstable_trailingSlashAwareDataRequests,"data");return T&&E.size>0&&S.searchParams.set("_routes",t.filter(F=>E.has(F.route.id)).map(F=>F.route.id).join(",")),[S.pathname+S.search]},[l,a.unstable_trailingSlashAwareDataRequests,u,n,s,d,t,e,i]),y=W.useMemo(()=>mN(p,s),[p,s]),C=CN(p);return W.createElement(W.Fragment,null,x.map(E=>W.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...r})),y.map(E=>W.createElement("link",{key:E,rel:"modulepreload",href:E,...r})),C.map(({key:E,link:T})=>W.createElement("link",{key:E,nonce:r.nonce,...T,crossOrigin:T.crossOrigin??r.crossOrigin})))}function TN(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var SN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{SN&&(window.__reactRouterVersion="7.13.1")}catch{}function _N({basename:e,children:t,unstable_useTransitions:r,window:n}){let a=W.useRef();a.current==null&&(a.current=ik({window:n,v5Compat:!0}));let s=a.current,[i,l]=W.useState({action:s.action,location:s.location}),u=W.useCallback(f=>{r===!1?l(f):W.startTransition(()=>l(f))},[r]);return W.useLayoutEffect(()=>s.listen(u),[s,u]),W.createElement(rN,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:s,unstable_useTransitions:r})}var _T=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bT=W.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,unstable_mask:l,state:u,target:f,to:d,preventScrollReset:p,viewTransition:x,unstable_defaultShouldRevalidate:y,...C},E){let{basename:T,navigator:S,unstable_useTransitions:F}=W.useContext(Ua),_=typeof d=="string"&&_T.test(d),N=mT(d,T);d=N.to;let I=Pk(d,{relative:a}),U=NA(),k=null;if(l){let Be=bd(l,[],U.unstable_mask?U.unstable_mask.pathname:"/",!0);T!=="/"&&(Be.pathname=Be.pathname==="/"?T:UA([T,Be.pathname])),k=S.createHref(Be)}let[G,M,ee]=yN(n,C),re=kN(d,{replace:i,unstable_mask:l,state:u,target:f,preventScrollReset:p,relative:a,viewTransition:x,unstable_defaultShouldRevalidate:y,unstable_useTransitions:F});function q(Be){t&&t(Be),Be.defaultPrevented||re(Be)}let se=!(N.isExternal||s),Te=W.createElement("a",{...C,...ee,href:(se?k:void 0)||N.absoluteURL||I,onClick:se?q:t,ref:TN(E,M),target:f,"data-discover":!_&&r==="render"?"true":void 0});return G&&!_?W.createElement(W.Fragment,null,Te,W.createElement(BN,{page:I})):Te});bT.displayName="Link";var bN=W.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:l,children:u,...f},d){let p=_u(i,{relative:f.relative}),x=NA(),y=W.useContext(Fd),{navigator:C,basename:E}=W.useContext(Ua),T=y!=null&&DN(p)&&l===!0,S=C.encodeLocation?C.encodeLocation(p).pathname:p.pathname,F=x.pathname,_=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(F=F.toLowerCase(),_=_?_.toLowerCase():null,S=S.toLowerCase()),_&&E&&(_=cs(_,E)||_);const N=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let I=F===S||!a&&F.startsWith(S)&&F.charAt(N)==="/",U=_!=null&&(_===S||!a&&_.startsWith(S)&&_.charAt(S.length)==="/"),k={isActive:I,isPending:U,isTransitioning:T},G=I?t:void 0,M;typeof n=="function"?M=n(k):M=[n,I?"active":null,U?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let ee=typeof s=="function"?s(k):s;return W.createElement(bT,{...f,"aria-current":G,className:M,ref:d,style:ee,to:i,viewTransition:l},typeof u=="function"?u(k):u)});bN.displayName="NavLink";var FN=W.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:i=Vf,action:l,onSubmit:u,relative:f,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:x,...y},C)=>{let{unstable_useTransitions:E}=W.useContext(Ua),T=QN(),S=RN(l,{relative:f}),F=i.toLowerCase()==="get"?"get":"post",_=typeof l=="string"&&_T.test(l),N=I=>{if(u&&u(I),I.defaultPrevented)return;I.preventDefault();let U=I.nativeEvent.submitter,k=(U==null?void 0:U.getAttribute("formmethod"))||i,G=()=>T(U||I.currentTarget,{fetcherKey:t,method:k,navigate:r,replace:a,state:s,relative:f,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:x});E&&r!==!1?W.startTransition(()=>G()):G()};return W.createElement("form",{ref:C,method:F,action:S,onSubmit:n?u:N,...y,"data-discover":!_&&e==="render"?"true":void 0})});FN.displayName="Form";function UN(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FT(e){let t=W.useContext(Cl);return Dr(t,UN(e)),t}function kN(e,{target:t,replace:r,unstable_mask:n,state:a,preventScrollReset:s,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:u,unstable_useTransitions:f}={}){let d=Ud(),p=NA(),x=_u(e,{relative:i});return W.useCallback(y=>{if(oN(y,t)){y.preventDefault();let C=r!==void 0?r:su(p)===su(x),E=()=>d(e,{replace:C,unstable_mask:n,state:a,preventScrollReset:s,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:u});f?W.startTransition(()=>E()):E()}},[p,d,x,r,n,a,t,e,s,i,l,u,f])}var NN=0,IN=()=>`__${String(++NN)}__`;function QN(){let{router:e}=FT("useSubmit"),{basename:t}=W.useContext(Ua),r=$k(),n=e.fetch,a=e.navigate;return W.useCallback(async(s,i={})=>{let{action:l,method:u,encType:f,formData:d,body:p}=uN(s,t);if(i.navigate===!1){let x=i.fetcherKey||IN();await n(x,r,i.action||l,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:d,body:p,formMethod:i.method||u,formEncType:i.encType||f,flushSync:i.flushSync})}else await a(i.action||l,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:d,body:p,formMethod:i.method||u,formEncType:i.encType||f,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,a,t,r])}function RN(e,{relative:t}={}){let{basename:r}=W.useContext(Ua),n=W.useContext(kA);Dr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={..._u(e||".",{relative:t})},i=NA();if(e==null){s.search=i.search;let l=new URLSearchParams(s.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(p=>p).forEach(p=>l.append("index",p));let d=l.toString();s.search=d?`?${d}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:UA([r,s.pathname])),su(s)}function DN(e,{relative:t}={}){let r=W.useContext(xT);Dr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=FT("useViewTransitionState"),a=_u(e,{relative:t});if(!r.isTransitioning)return!1;let s=cs(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=cs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return qf(a.pathname,i)!=null||qf(a.pathname,s)!=null}var lt=(e=>(e.SUPER_ADMIN="SUPER_ADMIN",e.ADMIN="ADMIN",e.TEACHER="TEACHER",e.STUDENT="STUDENT",e))(lt||{}),Cc={exports:{}},lm={},cm,lB;function MN(){if(lB)return cm;lB=1;function e(t,r){typeof r=="boolean"&&(r={forever:r}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=r||{},this._maxRetryTime=r&&r.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return cm=e,e.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},e.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},e.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var r=new Date().getTime();if(t&&r-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var a=this;return this._timer=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},n),this._options.unref&&this._timer.unref(),!0},e.prototype.attempt=function(t,r){this._fn=t,r&&(r.timeout&&(this._operationTimeout=r.timeout),r.cb&&(this._operationTimeoutCb=r.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},e.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},e.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},e.prototype.start=e.prototype.try,e.prototype.errors=function(){return this._errors},e.prototype.attempts=function(){return this._attempts},e.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},r=null,n=0,a=0;a<this._errors.length;a++){var s=this._errors[a],i=s.message,l=(t[i]||0)+1;t[i]=l,l>=n&&(r=s,n=l)}return r},cm}var cB;function LN(){return cB||(cB=1,(function(e){var t=MN();e.operation=function(r){var n=e.timeouts(r);return new t(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},e.timeouts=function(r){if(r instanceof Array)return[].concat(r);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var a in r)n[a]=r[a];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],i=0;i<n.retries;i++)s.push(this.createTimeout(i,n));return r&&r.forever&&!s.length&&s.push(this.createTimeout(i,n)),s.sort(function(l,u){return l-u}),s},e.createTimeout=function(r,n){var a=n.randomize?Math.random()+1:1,s=Math.round(a*Math.max(n.minTimeout,1)*Math.pow(n.factor,r));return s=Math.min(s,n.maxTimeout),s},e.wrap=function(r,n,a){if(n instanceof Array&&(a=n,n=null),!a){a=[];for(var s in r)typeof r[s]=="function"&&a.push(s)}for(var i=0;i<a.length;i++){var l=a[i],u=r[l];r[l]=(function(d){var p=e.operation(n),x=Array.prototype.slice.call(arguments,1),y=x.pop();x.push(function(C){p.retry(C)||(C&&(arguments[0]=p.mainError()),y.apply(this,arguments))}),p.attempt(function(){d.apply(r,x)})}).bind(r,u),r[l].options=n}}})(lm)),lm}var um,uB;function HN(){return uB||(uB=1,um=LN()),um}var fB;function ON(){if(fB)return Cc.exports;fB=1;const e=HN(),t=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class r extends Error{constructor(l){super(),l instanceof Error?(this.originalError=l,{message:l}=l):(this.originalError=new Error(l),this.originalError.stack=this.stack),this.name="AbortError",this.message=l}}const n=(i,l,u)=>{const f=u.retries-(l-1);return i.attemptNumber=l,i.retriesLeft=f,i},a=i=>t.includes(i),s=(i,l)=>new Promise((u,f)=>{l={onFailedAttempt:()=>{},retries:10,...l};const d=e.operation(l);d.attempt(async p=>{try{u(await i(p))}catch(x){if(!(x instanceof Error)){f(new TypeError(`Non-error was thrown: "${x}". You should only throw errors.`));return}if(x instanceof r)d.stop(),f(x.originalError);else if(x instanceof TypeError&&!a(x.message))d.stop(),f(x);else{n(x,p,l);try{await l.onFailedAttempt(x)}catch(y){f(y);return}d.retry(x)||f(d.mainError())}}})});return Cc.exports=s,Cc.exports.default=s,Cc.exports.AbortError=r,Cc.exports}var UT=ON();const PN=ax(UT);var GN={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let VN,KN;function jN(){return{geminiUrl:VN,vertexUrl:KN}}function zN(e,t,r,n){var a,s;if(!(e!=null&&e.baseUrl)){const i=jN();return t?(a=i.vertexUrl)!==null&&a!==void 0?a:r:(s=i.geminiUrl)!==null&&s!==void 0?s:n}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hs{}function qe(e,t){const r=/\{([^}]+)\}/g;return e.replace(r,(n,a)=>{if(Object.prototype.hasOwnProperty.call(t,a)){const s=t[a];return s!=null?String(s):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function v(e,t,r){for(let s=0;s<t.length-1;s++){const i=t[s];if(i.endsWith("[]")){const l=i.slice(0,-2);if(!(l in e))if(Array.isArray(r))e[l]=Array.from({length:r.length},()=>({}));else throw new Error(`Value must be a list given an array path ${i}`);if(Array.isArray(e[l])){const u=e[l];if(Array.isArray(r))for(let f=0;f<u.length;f++){const d=u[f];v(d,t.slice(s+1),r[f])}else for(const f of u)v(f,t.slice(s+1),r)}return}else if(i.endsWith("[0]")){const l=i.slice(0,-3);l in e||(e[l]=[{}]);const u=e[l];v(u[0],t.slice(s+1),r);return}(!e[i]||typeof e[i]!="object")&&(e[i]={}),e=e[i]}const n=t[t.length-1],a=e[n];if(a!==void 0){if(!r||typeof r=="object"&&Object.keys(r).length===0||r===a)return;if(typeof a=="object"&&typeof r=="object"&&a!==null&&r!==null)Object.assign(a,r);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(e,r):e[n]=r}function m(e,t,r=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return r;const a=t[n];if(a.endsWith("[]")){const s=a.slice(0,-2);if(s in e){const i=e[s];return Array.isArray(i)?i.map(l=>m(l,t.slice(n+1),r)):r}else return r}else e=e[a]}return e}catch(n){if(n instanceof TypeError)return r;throw n}}function XN(e,t){for(const[r,n]of Object.entries(t)){const a=r.split("."),s=n.split("."),i=new Set;let l=-1;for(let u=0;u<a.length;u++)if(a[u]==="*"){l=u;break}if(l!==-1&&s.length>l)for(let u=l;u<s.length;u++){const f=s[u];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&i.add(f)}ap(e,a,s,0,i)}}function ap(e,t,r,n,a){if(n>=t.length||typeof e!="object"||e===null)return;const s=t[n];if(s.endsWith("[]")){const i=s.slice(0,-2),l=e;if(i in l&&Array.isArray(l[i]))for(const u of l[i])ap(u,t,r,n+1,a)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const i=e,l=Object.keys(i).filter(f=>!f.startsWith("_")&&!a.has(f)),u={};for(const f of l)u[f]=i[f];for(const[f,d]of Object.entries(u)){const p=[];for(const x of r.slice(n))x==="*"?p.push(f):p.push(x);v(i,p,d)}for(const f of l)delete i[f]}}else{const i=e;s in i&&ap(i[s],t,r,n+1,a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fx(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WN(e){const t={},r=m(e,["operationName"]);r!=null&&v(t,["operationName"],r);const n=m(e,["resourceName"]);return n!=null&&v(t,["_url","resourceName"],n),t}function JN(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);s!=null&&v(t,["error"],s);const i=m(e,["response","generateVideoResponse"]);return i!=null&&v(t,["response"],qN(i)),t}function YN(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);s!=null&&v(t,["error"],s);const i=m(e,["response"]);return i!=null&&v(t,["response"],$N(i)),t}function qN(e){const t={},r=m(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>ZN(i))),v(t,["generatedVideos"],s)}const n=m(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const a=m(e,["raiMediaFilteredReasons"]);return a!=null&&v(t,["raiMediaFilteredReasons"],a),t}function $N(e){const t={},r=m(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>eI(i))),v(t,["generatedVideos"],s)}const n=m(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const a=m(e,["raiMediaFilteredReasons"]);return a!=null&&v(t,["raiMediaFilteredReasons"],a),t}function ZN(e){const t={},r=m(e,["video"]);return r!=null&&v(t,["video"],sI(r)),t}function eI(e){const t={},r=m(e,["_self"]);return r!=null&&v(t,["video"],iI(r)),t}function tI(e){const t={},r=m(e,["operationName"]);return r!=null&&v(t,["_url","operationName"],r),t}function rI(e){const t={},r=m(e,["operationName"]);return r!=null&&v(t,["_url","operationName"],r),t}function nI(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);s!=null&&v(t,["error"],s);const i=m(e,["response"]);return i!=null&&v(t,["response"],aI(i)),t}function aI(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["parent"]);n!=null&&v(t,["parent"],n);const a=m(e,["documentName"]);return a!=null&&v(t,["documentName"],a),t}function kT(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);s!=null&&v(t,["error"],s);const i=m(e,["response"]);return i!=null&&v(t,["response"],AI(i)),t}function AI(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["parent"]);n!=null&&v(t,["parent"],n);const a=m(e,["documentName"]);return a!=null&&v(t,["documentName"],a),t}function sI(e){const t={},r=m(e,["uri"]);r!=null&&v(t,["uri"],r);const n=m(e,["encodedVideo"]);n!=null&&v(t,["videoBytes"],fx(n));const a=m(e,["encoding"]);return a!=null&&v(t,["mimeType"],a),t}function iI(e){const t={},r=m(e,["gcsUri"]);r!=null&&v(t,["uri"],r);const n=m(e,["bytesBase64Encoded"]);n!=null&&v(t,["videoBytes"],fx(n));const a=m(e,["mimeType"]);return a!=null&&v(t,["mimeType"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var dB;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(dB||(dB={}));var hB;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(hB||(hB={}));var gB;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(gB||(gB={}));var ln;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(ln||(ln={}));var mB;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(mB||(mB={}));var pB;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(pB||(pB={}));var xB;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(xB||(xB={}));var vB;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(vB||(vB={}));var wB;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(wB||(wB={}));var yB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(yB||(yB={}));var BB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(BB||(BB={}));var CB;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(CB||(CB={}));var EB;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(EB||(EB={}));var TB;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(TB||(TB={}));var SB;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(SB||(SB={}));var _B;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(_B||(_B={}));var bB;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(bB||(bB={}));var FB;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(FB||(FB={}));var UB;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(UB||(UB={}));var kB;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(kB||(kB={}));var NB;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(NB||(NB={}));var $f;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})($f||($f={}));var IB;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(IB||(IB={}));var QB;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(QB||(QB={}));var RB;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(RB||(RB={}));var Ap;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ap||(Ap={}));var DB;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(DB||(DB={}));var MB;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(MB||(MB={}));var sp;(function(e){e.COLLECTION="COLLECTION"})(sp||(sp={}));var LB;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(LB||(LB={}));var HB;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(HB||(HB={}));var OB;(function(e){e.PROMINENT_PEOPLE_UNSPECIFIED="PROMINENT_PEOPLE_UNSPECIFIED",e.ALLOW_PROMINENT_PEOPLE="ALLOW_PROMINENT_PEOPLE",e.BLOCK_PROMINENT_PEOPLE="BLOCK_PROMINENT_PEOPLE"})(OB||(OB={}));var Zf;(function(e){e.PREDICT="PREDICT",e.EMBED_CONTENT="EMBED_CONTENT"})(Zf||(Zf={}));var PB;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(PB||(PB={}));var GB;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(GB||(GB={}));var VB;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(VB||(VB={}));var KB;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(KB||(KB={}));var jB;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(jB||(jB={}));var zB;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(zB||(zB={}));var XB;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(XB||(XB={}));var WB;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(WB||(WB={}));var JB;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(JB||(JB={}));var YB;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(YB||(YB={}));var qB;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(qB||(qB={}));var $B;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING",e.DISTILLATION="DISTILLATION"})($B||($B={}));var ZB;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(ZB||(ZB={}));var eC;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(eC||(eC={}));var tC;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(tC||(tC={}));var rC;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(rC||(rC={}));var nC;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(nC||(nC={}));var aC;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(aC||(aC={}));var AC;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(AC||(AC={}));var sC;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(sC||(sC={}));var iC;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(iC||(iC={}));var oC;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(oC||(oC={}));var lC;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(lC||(lC={}));var cC;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(cC||(cC={}));var uC;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(uC||(uC={}));var ol;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(ol||(ol={}));class ip{constructor(t){const r={};for(const n of t.headers.entries())r[n[0]]=n[1];this.headers=r,this.responseInternal=t}json(){return this.responseInternal.json()}}class Ec{get text(){var t,r,n,a,s,i,l,u;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",d=!1;const p=[];for(const x of(u=(l=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||l===void 0?void 0:l.parts)!==null&&u!==void 0?u:[]){for(const[y,C]of Object.entries(x))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(C!==null||C!==void 0)&&p.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;d=!0,f+=x.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?f:void 0}get data(){var t,r,n,a,s,i,l,u;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const d=[];for(const p of(u=(l=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||l===void 0?void 0:l.parts)!==null&&u!==void 0?u:[]){for(const[x,y]of Object.entries(p))x!=="inlineData"&&(y!==null||y!==void 0)&&d.push(x);p.inlineData&&typeof p.inlineData.data=="string"&&(f+=atob(p.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var t,r,n,a,s,i,l,u;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(u=(l=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var t,r,n,a,s,i,l,u,f;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(u=(l=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var t,r,n,a,s,i,l,u,f;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(u=(l=(i=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.output}}class fC{}class dC{}class oI{}class lI{}class cI{}class uI{}class hC{}class gC{}class mC{}class fI{}class ed{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new ed;let a;const s=t;return r?a=YN(s):a=JN(s),Object.assign(n,a),n}}class pC{}class xC{}class vC{}class wC{}class dI{}class hI{}class gI{}class dx{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new dx,s=nI(t);return Object.assign(n,s),n}}class mI{}class pI{}class xI{}class vI{}class yC{}class wI{get text(){var t,r,n;let a="",s=!1;const i=[];for(const l of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[u,f]of Object.entries(l))u!=="text"&&u!=="thought"&&f!==null&&i.push(u);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;s=!0,a+=l.text}}return i.length>0&&console.warn(`there are non-text parts ${i} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?a:void 0}get data(){var t,r,n;let a="";const s=[];for(const i of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[l,u]of Object.entries(i))l!=="inlineData"&&u!==null&&s.push(l);i.inlineData&&typeof i.inlineData.data=="string"&&(a+=atob(i.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class yI{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class hx{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new hx,s=kT(t);return Object.assign(n,s),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rr(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const r=t.split("/",2);return`publishers/${r[0]}/models/${r[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function NT(e,t){const r=rr(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function IT(e){return Array.isArray(e)?e.map(t=>td(t)):[td(e)]}function td(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function QT(e){const t=td(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function RT(e){const t=td(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function BC(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function DT(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>BC(t)):[BC(e)]}function op(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function CC(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function EC(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Cn(e){if(e==null)throw new Error("ContentUnion is required");return op(e)?e:{role:"user",parts:DT(e)}}function gx(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(r=>{const n=Cn(r);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(e.isVertexAI()){const r=Cn(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]}return Array.isArray(t)?t.map(r=>Cn(r)):[Cn(t)]}function ba(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(CC(e)||EC(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Cn(e)]}const t=[],r=[],n=op(e[0]);for(const a of e){const s=op(a);if(s!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(a);else{if(CC(a)||EC(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return n||t.push({role:"user",parts:DT(r)}),t}function BI(e,t){e.includes("null")&&(t.nullable=!0);const r=e.filter(n=>n!=="null");if(r.length===1)t.type=Object.values(ln).includes(r[0].toUpperCase())?r[0].toUpperCase():ln.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of r)t.anyOf.push({type:Object.values(ln).includes(n.toUpperCase())?n.toUpperCase():ln.TYPE_UNSPECIFIED})}}function fl(e){const t={},r=["items"],n=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&BI(e.type,t);for(const[i,l]of Object.entries(e))if(l!=null)if(i=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;t.type=Object.values(ln).includes(l.toUpperCase())?l.toUpperCase():ln.TYPE_UNSPECIFIED}else if(r.includes(i))t[i]=fl(l);else if(n.includes(i)){const u=[];for(const f of l){if(f.type=="null"){t.nullable=!0;continue}u.push(fl(f))}t[i]=u}else if(a.includes(i)){const u={};for(const[f,d]of Object.entries(l))u[f]=fl(d);t[i]=u}else{if(i==="additionalProperties")continue;t[i]=l}return t}function mx(e){return fl(e)}function px(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function xx(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Tl(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=fl(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=fl(t.response));return e}function Sl(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function CI(e,t,r,n=1){const a=!t.startsWith(`${r}/`)&&t.split("/").length===n;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${r}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`:t:a?`${r}/${t}`:t}function gs(e,t){if(typeof t!="string")throw new Error("name must be a string");return CI(e,t,"cachedContents")}function MT(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function oi(e){return fx(e)}function EI(e){return e!=null&&typeof e=="object"&&"name"in e}function TI(e){return e!=null&&typeof e=="object"&&"video"in e}function SI(e){return e!=null&&typeof e=="object"&&"uri"in e}function LT(e){var t;let r;if(EI(e)&&(r=e.name),!(SI(e)&&(r=e.uri,r===void 0))&&!(TI(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function HT(e,t){let r;return e.isVertexAI()?r=t?"publishers/google/models":"models":r=t?"models":"tunedModels",r}function OT(e){for(const t of["models","tunedModels","publisherModels"])if(_I(e,t))return e[t];return[]}function _I(e,t){return e!==null&&typeof e=="object"&&t in e}function bI(e,t={}){const r=e,n={name:r.name,description:r.description,parametersJsonSchema:r.inputSchema};return r.outputSchema&&(n.responseJsonSchema=r.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}function FI(e,t={}){const r=[],n=new Set;for(const a of e){const s=a.name;if(n.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);n.add(s);const i=bI(a,t);i.functionDeclarations&&r.push(...i.functionDeclarations)}return{functionDeclarations:r}}function PT(e,t){let r;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))r={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;const n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,a=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(a>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||a!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function UI(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function GT(e){if(typeof e!="object"||e===null)return{};const t=e,r=t.inlinedResponses;if(typeof r!="object"||r===null)return e;const a=r.inlinedResponses;if(!Array.isArray(a)||a.length===0)return e;let s=!1;for(const i of a){if(typeof i!="object"||i===null)continue;const u=i.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function _l(e,t){const r=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(r))return r.split("/").pop();throw new Error(`Invalid batch job name: ${r}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(r))return r.split("/").pop();if(/^\d+$/.test(r))return r;throw new Error(`Invalid batch job name: ${r}.`)}function VT(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}function kI(e){return e.includes("gemini")&&e!=="gemini-embedding-001"||e.includes("maas")}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NI(e){const t={},r=m(e,["responsesFile"]);r!=null&&v(t,["fileName"],r);const n=m(e,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>f3(i))),v(t,["inlinedResponses"],s)}const a=m(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["inlinedEmbedContentResponses"],s)}return t}function II(e){const t={},r=m(e,["predictionsFormat"]);r!=null&&v(t,["format"],r);const n=m(e,["gcsDestination","outputUriPrefix"]);n!=null&&v(t,["gcsUri"],n);const a=m(e,["bigqueryDestination","outputUri"]);return a!=null&&v(t,["bigqueryUri"],a),t}function QI(e){const t={},r=m(e,["format"]);r!=null&&v(t,["predictionsFormat"],r);const n=m(e,["gcsUri"]);n!=null&&v(t,["gcsDestination","outputUriPrefix"],n);const a=m(e,["bigqueryUri"]);if(a!=null&&v(t,["bigqueryDestination","outputUri"],a),m(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function jf(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["metadata","displayName"]);n!=null&&v(t,["displayName"],n);const a=m(e,["metadata","state"]);a!=null&&v(t,["state"],VT(a));const s=m(e,["metadata","createTime"]);s!=null&&v(t,["createTime"],s);const i=m(e,["metadata","endTime"]);i!=null&&v(t,["endTime"],i);const l=m(e,["metadata","updateTime"]);l!=null&&v(t,["updateTime"],l);const u=m(e,["metadata","model"]);u!=null&&v(t,["model"],u);const f=m(e,["metadata","output"]);return f!=null&&v(t,["dest"],NI(GT(f))),t}function lp(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["displayName"]);n!=null&&v(t,["displayName"],n);const a=m(e,["state"]);a!=null&&v(t,["state"],VT(a));const s=m(e,["error"]);s!=null&&v(t,["error"],s);const i=m(e,["createTime"]);i!=null&&v(t,["createTime"],i);const l=m(e,["startTime"]);l!=null&&v(t,["startTime"],l);const u=m(e,["endTime"]);u!=null&&v(t,["endTime"],u);const f=m(e,["updateTime"]);f!=null&&v(t,["updateTime"],f);const d=m(e,["model"]);d!=null&&v(t,["model"],d);const p=m(e,["inputConfig"]);p!=null&&v(t,["src"],RI(p));const x=m(e,["outputConfig"]);x!=null&&v(t,["dest"],II(GT(x)));const y=m(e,["completionStats"]);return y!=null&&v(t,["completionStats"],y),t}function RI(e){const t={},r=m(e,["instancesFormat"]);r!=null&&v(t,["format"],r);const n=m(e,["gcsSource","uris"]);n!=null&&v(t,["gcsUri"],n);const a=m(e,["bigquerySource","inputUri"]);return a!=null&&v(t,["bigqueryUri"],a),t}function DI(e,t){const r={};if(m(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=m(t,["fileName"]);n!=null&&v(r,["fileName"],n);const a=m(t,["inlinedRequests"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>u3(e,i))),v(r,["requests","requests"],s)}return r}function MI(e){const t={},r=m(e,["format"]);r!=null&&v(t,["instancesFormat"],r);const n=m(e,["gcsUri"]);n!=null&&v(t,["gcsSource","uris"],n);const a=m(e,["bigqueryUri"]);if(a!=null&&v(t,["bigquerySource","inputUri"],a),m(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function LI(e){const t={},r=m(e,["data"]);if(r!=null&&v(t,["data"],r),m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function HI(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],_l(e,n)),r}function OI(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],_l(e,n)),r}function PI(e){const t={},r=m(e,["content"]);r!=null&&v(t,["content"],r);const n=m(e,["citationMetadata"]);n!=null&&v(t,["citationMetadata"],GI(n));const a=m(e,["tokenCount"]);a!=null&&v(t,["tokenCount"],a);const s=m(e,["finishReason"]);s!=null&&v(t,["finishReason"],s);const i=m(e,["groundingMetadata"]);i!=null&&v(t,["groundingMetadata"],i);const l=m(e,["avgLogprobs"]);l!=null&&v(t,["avgLogprobs"],l);const u=m(e,["index"]);u!=null&&v(t,["index"],u);const f=m(e,["logprobsResult"]);f!=null&&v(t,["logprobsResult"],f);const d=m(e,["safetyRatings"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(y=>y)),v(t,["safetyRatings"],x)}const p=m(e,["urlContextMetadata"]);return p!=null&&v(t,["urlContextMetadata"],p),t}function GI(e){const t={},r=m(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>a)),v(t,["citations"],n)}return t}function KT(e){const t={},r=m(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>v3(s))),v(t,["parts"],a)}const n=m(e,["role"]);return n!=null&&v(t,["role"],n),t}function VI(e,t){const r={},n=m(e,["displayName"]);if(t!==void 0&&n!=null&&v(t,["batch","displayName"],n),m(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return r}function KI(e,t){const r={},n=m(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const a=m(e,["dest"]);return t!==void 0&&a!=null&&v(t,["outputConfig"],QI(UI(a))),r}function TC(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["_url","model"],rr(e,n));const a=m(t,["src"]);a!=null&&v(r,["batch","inputConfig"],DI(e,PT(e,a)));const s=m(t,["config"]);return s!=null&&VI(s,r),r}function jI(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["model"],rr(e,n));const a=m(t,["src"]);a!=null&&v(r,["inputConfig"],MI(PT(e,a)));const s=m(t,["config"]);return s!=null&&KI(s,r),r}function zI(e,t){const r={},n=m(e,["displayName"]);return t!==void 0&&n!=null&&v(t,["batch","displayName"],n),r}function XI(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["_url","model"],rr(e,n));const a=m(t,["src"]);a!=null&&v(r,["batch","inputConfig"],e3(e,a));const s=m(t,["config"]);return s!=null&&zI(s,r),r}function WI(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],_l(e,n)),r}function JI(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],_l(e,n)),r}function YI(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["name"]);n!=null&&v(t,["name"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);return s!=null&&v(t,["error"],s),t}function qI(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["name"]);n!=null&&v(t,["name"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);return s!=null&&v(t,["error"],s),t}function $I(e,t){const r={},n=m(t,["contents"]);if(n!=null){let s=gx(e,n);Array.isArray(s)&&(s=s.map(i=>i)),v(r,["requests[]","request","content"],s)}const a=m(t,["config"]);return a!=null&&(v(r,["_self"],ZI(a,r)),XN(r,{"requests[].*":"requests[].request.*"})),r}function ZI(e,t){const r={},n=m(e,["taskType"]);t!==void 0&&n!=null&&v(t,["requests[]","taskType"],n);const a=m(e,["title"]);t!==void 0&&a!=null&&v(t,["requests[]","title"],a);const s=m(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&v(t,["requests[]","outputDimensionality"],s),m(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function e3(e,t){const r={},n=m(t,["fileName"]);n!=null&&v(r,["file_name"],n);const a=m(t,["inlinedRequests"]);return a!=null&&v(r,["requests"],$I(e,a)),r}function t3(e){const t={};if(m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=m(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function r3(e){const t={},r=m(e,["id"]);r!=null&&v(t,["id"],r);const n=m(e,["args"]);n!=null&&v(t,["args"],n);const a=m(e,["name"]);if(a!=null&&v(t,["name"],a),m(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function n3(e){const t={},r=m(e,["allowedFunctionNames"]);r!=null&&v(t,["allowedFunctionNames"],r);const n=m(e,["mode"]);if(n!=null&&v(t,["mode"],n),m(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function a3(e,t,r){const n={},a=m(t,["systemInstruction"]);r!==void 0&&a!=null&&v(r,["systemInstruction"],KT(Cn(a)));const s=m(t,["temperature"]);s!=null&&v(n,["temperature"],s);const i=m(t,["topP"]);i!=null&&v(n,["topP"],i);const l=m(t,["topK"]);l!=null&&v(n,["topK"],l);const u=m(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=m(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=m(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const p=m(t,["responseLogprobs"]);p!=null&&v(n,["responseLogprobs"],p);const x=m(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=m(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const C=m(t,["frequencyPenalty"]);C!=null&&v(n,["frequencyPenalty"],C);const E=m(t,["seed"]);E!=null&&v(n,["seed"],E);const T=m(t,["responseMimeType"]);T!=null&&v(n,["responseMimeType"],T);const S=m(t,["responseSchema"]);S!=null&&v(n,["responseSchema"],mx(S));const F=m(t,["responseJsonSchema"]);if(F!=null&&v(n,["responseJsonSchema"],F),m(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=m(t,["safetySettings"]);if(r!==void 0&&_!=null){let se=_;Array.isArray(se)&&(se=se.map(Te=>w3(Te))),v(r,["safetySettings"],se)}const N=m(t,["tools"]);if(r!==void 0&&N!=null){let se=Sl(N);Array.isArray(se)&&(se=se.map(Te=>B3(Tl(Te)))),v(r,["tools"],se)}const I=m(t,["toolConfig"]);if(r!==void 0&&I!=null&&v(r,["toolConfig"],y3(I)),m(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=m(t,["cachedContent"]);r!==void 0&&U!=null&&v(r,["cachedContent"],gs(e,U));const k=m(t,["responseModalities"]);k!=null&&v(n,["responseModalities"],k);const G=m(t,["mediaResolution"]);G!=null&&v(n,["mediaResolution"],G);const M=m(t,["speechConfig"]);if(M!=null&&v(n,["speechConfig"],px(M)),m(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ee=m(t,["thinkingConfig"]);ee!=null&&v(n,["thinkingConfig"],ee);const re=m(t,["imageConfig"]);re!=null&&v(n,["imageConfig"],c3(re));const q=m(t,["enableEnhancedCivicAnswers"]);if(q!=null&&v(n,["enableEnhancedCivicAnswers"],q),m(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function A3(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>PI(f))),v(t,["candidates"],u)}const a=m(e,["modelVersion"]);a!=null&&v(t,["modelVersion"],a);const s=m(e,["promptFeedback"]);s!=null&&v(t,["promptFeedback"],s);const i=m(e,["responseId"]);i!=null&&v(t,["responseId"],i);const l=m(e,["usageMetadata"]);return l!=null&&v(t,["usageMetadata"],l),t}function s3(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],_l(e,n)),r}function i3(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],_l(e,n)),r}function o3(e){const t={};if(m(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=m(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function l3(e){const t={},r=m(e,["searchTypes"]);if(r!=null&&v(t,["searchTypes"],r),m(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=m(e,["timeRangeFilter"]);return n!=null&&v(t,["timeRangeFilter"],n),t}function c3(e){const t={},r=m(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=m(e,["imageSize"]);if(n!=null&&v(t,["imageSize"],n),m(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(e,["prominentPeople"])!==void 0)throw new Error("prominentPeople parameter is not supported in Gemini API.");if(m(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function u3(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["request","model"],rr(e,n));const a=m(t,["contents"]);if(a!=null){let l=ba(a);Array.isArray(l)&&(l=l.map(u=>KT(u))),v(r,["request","contents"],l)}const s=m(t,["metadata"]);s!=null&&v(r,["metadata"],s);const i=m(t,["config"]);return i!=null&&v(r,["request","generationConfig"],a3(e,i,m(r,["request"],{}))),r}function f3(e){const t={},r=m(e,["response"]);r!=null&&v(t,["response"],A3(r));const n=m(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=m(e,["error"]);return a!=null&&v(t,["error"],a),t}function d3(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);if(t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),m(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return r}function h3(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);t!==void 0&&a!=null&&v(t,["_query","pageToken"],a);const s=m(e,["filter"]);return t!==void 0&&s!=null&&v(t,["_query","filter"],s),r}function g3(e){const t={},r=m(e,["config"]);return r!=null&&d3(r,t),t}function m3(e){const t={},r=m(e,["config"]);return r!=null&&h3(r,t),t}function p3(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["operations"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>jf(i))),v(t,["batchJobs"],s)}return t}function x3(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["batchPredictionJobs"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>lp(i))),v(t,["batchJobs"],s)}return t}function v3(e){const t={},r=m(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=m(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=m(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=m(e,["fileData"]);s!=null&&v(t,["fileData"],t3(s));const i=m(e,["functionCall"]);i!=null&&v(t,["functionCall"],r3(i));const l=m(e,["functionResponse"]);l!=null&&v(t,["functionResponse"],l);const u=m(e,["inlineData"]);u!=null&&v(t,["inlineData"],LI(u));const f=m(e,["text"]);f!=null&&v(t,["text"],f);const d=m(e,["thought"]);d!=null&&v(t,["thought"],d);const p=m(e,["thoughtSignature"]);p!=null&&v(t,["thoughtSignature"],p);const x=m(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function w3(e){const t={},r=m(e,["category"]);if(r!=null&&v(t,["category"],r),m(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(e,["threshold"]);return n!=null&&v(t,["threshold"],n),t}function y3(e){const t={},r=m(e,["retrievalConfig"]);r!=null&&v(t,["retrievalConfig"],r);const n=m(e,["functionCallingConfig"]);return n!=null&&v(t,["functionCallingConfig"],n3(n)),t}function B3(e){const t={};if(m(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=m(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=m(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=m(e,["googleSearch"]);a!=null&&v(t,["googleSearch"],l3(a));const s=m(e,["codeExecution"]);if(s!=null&&v(t,["codeExecution"],s),m(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const i=m(e,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["functionDeclarations"],p)}const l=m(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],o3(l));const u=m(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=m(e,["urlContext"]);f!=null&&v(t,["urlContext"],f);const d=m(e,["mcpServers"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["mcpServers"],p)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var us;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(us||(us={}));class ao{constructor(t,r,n,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=r,this.init(t,n,a)}init(t,r,n){var a,s;this.nameInternal=t,this.pageInternal=r[this.nameInternal]||[],this.sdkHttpResponseInternal=r==null?void 0:r.sdkHttpResponse,this.idxInternal=0;let i={config:{}};!n||Object.keys(n).length===0?i={config:{}}:typeof n=="object"?i=Object.assign({},n):i=n,i.config&&(i.config.pageToken=r.nextPageToken),this.paramsInternal=i,this.pageInternalSize=(s=(a=i.config)===null||a===void 0?void 0:a.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class C3 extends hs{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ao(us.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.create=async r=>(this.apiClient.isVertexAI()&&(r.config=this.formatDestination(r.src,r.config)),this.createInternal(r)),this.createEmbeddings=async r=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(r)}}createInlinedGenerateContentRequest(t){const r=TC(this.apiClient,t),n=r._url,a=qe("{model}:batchGenerateContent",n),l=r.batch.inputConfig.requests,u=l.requests,f=[];for(const d of u){const p=Object.assign({},d);if(p.systemInstruction){const x=p.systemInstruction;delete p.systemInstruction;const y=p.request;y.systemInstruction=x,p.request=y}f.push(p)}return l.requests=f,delete r.config,delete r._url,delete r._query,{path:a,body:r}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,r){const n=r?Object.assign({},r):{},a=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${a}`),n.dest===void 0){const s=this.getGcsUri(t),i=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?n.dest=`${s.slice(0,-6)}/dest`:n.dest=`${s}_dest_${a}`;else if(i)n.dest=`${i}_dest_${a}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=jI(this.apiClient,t);return l=qe("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>lp(d))}else{const f=TC(this.apiClient,t);return l=qe("{model}:batchGenerateContent",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>jf(d))}}async createEmbeddingsInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=XI(this.apiClient,t);return s=qe("{model}:asyncBatchEmbedContent",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>jf(u))}}async get(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=i3(this.apiClient,t);return l=qe("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>lp(d))}else{const f=s3(this.apiClient,t);return l=qe("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>jf(d))}}async cancel(t){var r,n,a,s;let i="",l={};if(this.apiClient.isVertexAI()){const u=OI(this.apiClient,t);i=qe("batchPredictionJobs/{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const u=HI(this.apiClient,t);i=qe("batches/{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=m3(t);return l=qe("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=x3(d),x=new yC;return Object.assign(x,p),x})}else{const f=g3(t);return l=qe("batches",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=p3(d),x=new yC;return Object.assign(x,p),x})}}async delete(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=JI(this.apiClient,t);return l=qe("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>qI(d))}else{const f=WI(this.apiClient,t);return l=qe("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>YI(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E3(e){const t={},r=m(e,["data"]);if(r!=null&&v(t,["data"],r),m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function SC(e){const t={},r=m(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>X3(s))),v(t,["parts"],a)}const n=m(e,["role"]);return n!=null&&v(t,["role"],n),t}function T3(e,t){const r={},n=m(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=m(e,["expireTime"]);t!==void 0&&a!=null&&v(t,["expireTime"],a);const s=m(e,["displayName"]);t!==void 0&&s!=null&&v(t,["displayName"],s);const i=m(e,["contents"]);if(t!==void 0&&i!=null){let d=ba(i);Array.isArray(d)&&(d=d.map(p=>SC(p))),v(t,["contents"],d)}const l=m(e,["systemInstruction"]);t!==void 0&&l!=null&&v(t,["systemInstruction"],SC(Cn(l)));const u=m(e,["tools"]);if(t!==void 0&&u!=null){let d=u;Array.isArray(d)&&(d=d.map(p=>J3(p))),v(t,["tools"],d)}const f=m(e,["toolConfig"]);if(t!==void 0&&f!=null&&v(t,["toolConfig"],W3(f)),m(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function S3(e,t){const r={},n=m(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=m(e,["expireTime"]);t!==void 0&&a!=null&&v(t,["expireTime"],a);const s=m(e,["displayName"]);t!==void 0&&s!=null&&v(t,["displayName"],s);const i=m(e,["contents"]);if(t!==void 0&&i!=null){let p=ba(i);Array.isArray(p)&&(p=p.map(x=>x)),v(t,["contents"],p)}const l=m(e,["systemInstruction"]);t!==void 0&&l!=null&&v(t,["systemInstruction"],Cn(l));const u=m(e,["tools"]);if(t!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(x=>Y3(x))),v(t,["tools"],p)}const f=m(e,["toolConfig"]);t!==void 0&&f!=null&&v(t,["toolConfig"],f);const d=m(e,["kmsKeyName"]);return t!==void 0&&d!=null&&v(t,["encryption_spec","kmsKeyName"],d),r}function _3(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["model"],NT(e,n));const a=m(t,["config"]);return a!=null&&T3(a,r),r}function b3(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["model"],NT(e,n));const a=m(t,["config"]);return a!=null&&S3(a,r),r}function F3(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],gs(e,n)),r}function U3(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],gs(e,n)),r}function k3(e){const t={},r=m(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function N3(e){const t={},r=m(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function I3(e){const t={};if(m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=m(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function Q3(e){const t={},r=m(e,["id"]);r!=null&&v(t,["id"],r);const n=m(e,["args"]);n!=null&&v(t,["args"],n);const a=m(e,["name"]);if(a!=null&&v(t,["name"],a),m(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function R3(e){const t={},r=m(e,["allowedFunctionNames"]);r!=null&&v(t,["allowedFunctionNames"],r);const n=m(e,["mode"]);if(n!=null&&v(t,["mode"],n),m(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function D3(e){const t={},r=m(e,["description"]);r!=null&&v(t,["description"],r);const n=m(e,["name"]);n!=null&&v(t,["name"],n);const a=m(e,["parameters"]);a!=null&&v(t,["parameters"],a);const s=m(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const i=m(e,["response"]);i!=null&&v(t,["response"],i);const l=m(e,["responseJsonSchema"]);if(l!=null&&v(t,["responseJsonSchema"],l),m(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function M3(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],gs(e,n)),r}function L3(e,t){const r={},n=m(t,["name"]);return n!=null&&v(r,["_url","name"],gs(e,n)),r}function H3(e){const t={};if(m(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=m(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function O3(e){const t={},r=m(e,["searchTypes"]);if(r!=null&&v(t,["searchTypes"],r),m(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=m(e,["timeRangeFilter"]);return n!=null&&v(t,["timeRangeFilter"],n),t}function P3(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function G3(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function V3(e){const t={},r=m(e,["config"]);return r!=null&&P3(r,t),t}function K3(e){const t={},r=m(e,["config"]);return r!=null&&G3(r,t),t}function j3(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["cachedContents"],s)}return t}function z3(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["cachedContents"],s)}return t}function X3(e){const t={},r=m(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=m(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=m(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=m(e,["fileData"]);s!=null&&v(t,["fileData"],I3(s));const i=m(e,["functionCall"]);i!=null&&v(t,["functionCall"],Q3(i));const l=m(e,["functionResponse"]);l!=null&&v(t,["functionResponse"],l);const u=m(e,["inlineData"]);u!=null&&v(t,["inlineData"],E3(u));const f=m(e,["text"]);f!=null&&v(t,["text"],f);const d=m(e,["thought"]);d!=null&&v(t,["thought"],d);const p=m(e,["thoughtSignature"]);p!=null&&v(t,["thoughtSignature"],p);const x=m(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function W3(e){const t={},r=m(e,["retrievalConfig"]);r!=null&&v(t,["retrievalConfig"],r);const n=m(e,["functionCallingConfig"]);return n!=null&&v(t,["functionCallingConfig"],R3(n)),t}function J3(e){const t={};if(m(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=m(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=m(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=m(e,["googleSearch"]);a!=null&&v(t,["googleSearch"],O3(a));const s=m(e,["codeExecution"]);if(s!=null&&v(t,["codeExecution"],s),m(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const i=m(e,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["functionDeclarations"],p)}const l=m(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],H3(l));const u=m(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=m(e,["urlContext"]);f!=null&&v(t,["urlContext"],f);const d=m(e,["mcpServers"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["mcpServers"],p)}return t}function Y3(e){const t={},r=m(e,["retrieval"]);r!=null&&v(t,["retrieval"],r);const n=m(e,["computerUse"]);if(n!=null&&v(t,["computerUse"],n),m(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=m(e,["googleSearch"]);a!=null&&v(t,["googleSearch"],a);const s=m(e,["codeExecution"]);s!=null&&v(t,["codeExecution"],s);const i=m(e,["enterpriseWebSearch"]);i!=null&&v(t,["enterpriseWebSearch"],i);const l=m(e,["functionDeclarations"]);if(l!=null){let p=l;Array.isArray(p)&&(p=p.map(x=>D3(x))),v(t,["functionDeclarations"],p)}const u=m(e,["googleMaps"]);u!=null&&v(t,["googleMaps"],u);const f=m(e,["googleSearchRetrieval"]);f!=null&&v(t,["googleSearchRetrieval"],f);const d=m(e,["urlContext"]);if(d!=null&&v(t,["urlContext"],d),m(e,["mcpServers"])!==void 0)throw new Error("mcpServers parameter is not supported in Vertex AI.");return t}function q3(e,t){const r={},n=m(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=m(e,["expireTime"]);return t!==void 0&&a!=null&&v(t,["expireTime"],a),r}function $3(e,t){const r={},n=m(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=m(e,["expireTime"]);return t!==void 0&&a!=null&&v(t,["expireTime"],a),r}function Z3(e,t){const r={},n=m(t,["name"]);n!=null&&v(r,["_url","name"],gs(e,n));const a=m(t,["config"]);return a!=null&&q3(a,r),r}function eQ(e,t){const r={},n=m(t,["name"]);n!=null&&v(r,["_url","name"],gs(e,n));const a=m(t,["config"]);return a!=null&&$3(a,r),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tQ extends hs{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ao(us.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(r),r)}async create(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=b3(this.apiClient,t);return l=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}else{const f=_3(this.apiClient,t);return l=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async get(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=L3(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}else{const f=M3(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=U3(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=N3(d),x=new vC;return Object.assign(x,p),x})}else{const f=F3(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=k3(d),x=new vC;return Object.assign(x,p),x})}}async update(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=eQ(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}else{const f=Z3(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async listInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=K3(t);return l=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=z3(d),x=new wC;return Object.assign(x,p),x})}else{const f=V3(t);return l=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=j3(d),x=new wC;return Object.assign(x,p),x})}}}function rd(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function _C(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function St(e){return this instanceof St?(this.v=e,this):new St(e)}function dA(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),a[Symbol.asyncIterator]=function(){return this},a;function i(y){return function(C){return Promise.resolve(C).then(y,p)}}function l(y,C){n[y]&&(a[y]=function(E){return new Promise(function(T,S){s.push([y,E,T,S])>1||u(y,E)})},C&&(a[y]=C(a[y])))}function u(y,C){try{f(n[y](C))}catch(E){x(s[0][3],E)}}function f(y){y.value instanceof St?Promise.resolve(y.value.v).then(d,p):x(s[0][2],y)}function d(y){u("next",y)}function p(y){u("throw",y)}function x(y,C){y(C),s.shift(),s.length&&u(s[0][0],s[0][1])}}function hA(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof _C=="function"?_C(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(i){return new Promise(function(l,u){i=e[s](i),a(l,u,i.done,i.value)})}}function a(s,i,l,u){Promise.resolve(u).then(function(f){s({value:f,done:l})},i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rQ(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const r=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return r===void 0?!1:jT(r)}function jT(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function nQ(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function bC(e){if(e===void 0||e.length===0)return[];const t=[],r=e.length;let n=0;for(;n<r;)if(e[n].role==="user")t.push(e[n]),n++;else{const a=[];let s=!0;for(;n<r&&e[n].role==="model";)a.push(e[n]),s&&!jT(e[n])&&(s=!1),n++;s?t.push(...a):t.pop()}return t}class aQ{constructor(t,r){this.modelsModule=t,this.apiClient=r}create(t){return new AQ(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class AQ{constructor(t,r,n,a={},s=[]){this.apiClient=t,this.modelsModule=r,this.model=n,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),nQ(s)}async sendMessage(t){var r;await this.sendPromise;const n=Cn(t.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});return this.sendPromise=(async()=>{var s,i,l;const u=await a,f=(i=(s=u.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content,d=u.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let x=[];d!=null&&(x=(l=d.slice(p))!==null&&l!==void 0?l:[]);const y=f?[f]:[];this.recordHistory(n,y,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(t){var r;await this.sendPromise;const n=Cn(t.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,n)}getHistory(t=!1){const r=t?bC(this.history):this.history;return structuredClone(r)}processStreamResponse(t,r){return dA(this,arguments,function*(){var a,s,i,l,u,f;const d=[];try{for(var p=!0,x=hA(t),y;y=yield St(x.next()),a=y.done,!a;p=!0){l=y.value,p=!1;const C=l;if(rQ(C)){const E=(f=(u=C.candidates)===null||u===void 0?void 0:u[0])===null||f===void 0?void 0:f.content;E!==void 0&&d.push(E)}yield yield St(C)}}catch(C){s={error:C}}finally{try{!p&&!a&&(i=x.return)&&(yield St(i.call(x)))}finally{if(s)throw s.error}}this.recordHistory(r,d)})}recordHistory(t,r,n){let a=[];r.length>0&&r.every(s=>s.role!==void 0)?a=r:a.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...bC(n)):this.history.push(t),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iu extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,iu.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sQ(e){const t={},r=m(e,["file"]);return r!=null&&v(t,["file"],r),t}function iQ(e){const t={},r=m(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function oQ(e){const t={},r=m(e,["name"]);return r!=null&&v(t,["_url","file"],LT(r)),t}function lQ(e){const t={},r=m(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function cQ(e){const t={},r=m(e,["name"]);return r!=null&&v(t,["_url","file"],LT(r)),t}function uQ(e){const t={},r=m(e,["uris"]);return r!=null&&v(t,["uris"],r),t}function fQ(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function dQ(e){const t={},r=m(e,["config"]);return r!=null&&fQ(r,t),t}function hQ(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["files"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["files"],s)}return t}function gQ(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["files"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>s)),v(t,["files"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mQ extends hs{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ao(us.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(r),r)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(r=>r)}async download(t){await this.apiClient.downloadFile(t)}async registerFiles(t){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(t){return this.registerFilesInternal(t)}async listInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=dQ(t);return s=qe("files",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=hQ(u),d=new mI;return Object.assign(d,f),d})}}async createInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=sQ(t);return s=qe("upload/v1beta/files",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=iQ(u),d=new pI;return Object.assign(d,f),d})}}async get(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=cQ(t);return s=qe("files/{file}",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=oQ(t);return s=qe("files/{file}",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=lQ(u),d=new xI;return Object.assign(d,f),d})}}async registerFilesInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=uQ(t);return s=qe("files:register",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=gQ(u),d=new vI;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zf(e){const t={},r=m(e,["data"]);if(r!=null&&v(t,["data"],r),m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function pQ(e){const t={},r=m(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>IQ(s))),v(t,["parts"],a)}const n=m(e,["role"]);return n!=null&&v(t,["role"],n),t}function xQ(e){const t={};if(m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=m(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function vQ(e){const t={},r=m(e,["id"]);r!=null&&v(t,["id"],r);const n=m(e,["args"]);n!=null&&v(t,["args"],n);const a=m(e,["name"]);if(a!=null&&v(t,["name"],a),m(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function wQ(e){const t={},r=m(e,["description"]);r!=null&&v(t,["description"],r);const n=m(e,["name"]);n!=null&&v(t,["name"],n);const a=m(e,["parameters"]);a!=null&&v(t,["parameters"],a);const s=m(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const i=m(e,["response"]);i!=null&&v(t,["response"],i);const l=m(e,["responseJsonSchema"]);if(l!=null&&v(t,["responseJsonSchema"],l),m(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function yQ(e){const t={},r=m(e,["modelSelectionConfig"]);r!=null&&v(t,["modelConfig"],r);const n=m(e,["responseJsonSchema"]);n!=null&&v(t,["responseJsonSchema"],n);const a=m(e,["audioTimestamp"]);a!=null&&v(t,["audioTimestamp"],a);const s=m(e,["candidateCount"]);s!=null&&v(t,["candidateCount"],s);const i=m(e,["enableAffectiveDialog"]);i!=null&&v(t,["enableAffectiveDialog"],i);const l=m(e,["frequencyPenalty"]);l!=null&&v(t,["frequencyPenalty"],l);const u=m(e,["logprobs"]);u!=null&&v(t,["logprobs"],u);const f=m(e,["maxOutputTokens"]);f!=null&&v(t,["maxOutputTokens"],f);const d=m(e,["mediaResolution"]);d!=null&&v(t,["mediaResolution"],d);const p=m(e,["presencePenalty"]);p!=null&&v(t,["presencePenalty"],p);const x=m(e,["responseLogprobs"]);x!=null&&v(t,["responseLogprobs"],x);const y=m(e,["responseMimeType"]);y!=null&&v(t,["responseMimeType"],y);const C=m(e,["responseModalities"]);C!=null&&v(t,["responseModalities"],C);const E=m(e,["responseSchema"]);E!=null&&v(t,["responseSchema"],E);const T=m(e,["routingConfig"]);T!=null&&v(t,["routingConfig"],T);const S=m(e,["seed"]);S!=null&&v(t,["seed"],S);const F=m(e,["speechConfig"]);F!=null&&v(t,["speechConfig"],F);const _=m(e,["stopSequences"]);_!=null&&v(t,["stopSequences"],_);const N=m(e,["temperature"]);N!=null&&v(t,["temperature"],N);const I=m(e,["thinkingConfig"]);I!=null&&v(t,["thinkingConfig"],I);const U=m(e,["topK"]);U!=null&&v(t,["topK"],U);const k=m(e,["topP"]);if(k!=null&&v(t,["topP"],k),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function BQ(e){const t={};if(m(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=m(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function CQ(e){const t={},r=m(e,["searchTypes"]);if(r!=null&&v(t,["searchTypes"],r),m(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=m(e,["timeRangeFilter"]);return n!=null&&v(t,["timeRangeFilter"],n),t}function EQ(e,t){const r={},n=m(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],n);const a=m(e,["responseModalities"]);t!==void 0&&a!=null&&v(t,["setup","generationConfig","responseModalities"],a);const s=m(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const i=m(e,["topP"]);t!==void 0&&i!=null&&v(t,["setup","generationConfig","topP"],i);const l=m(e,["topK"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topK"],l);const u=m(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=m(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=m(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const p=m(e,["speechConfig"]);t!==void 0&&p!=null&&v(t,["setup","generationConfig","speechConfig"],xx(p));const x=m(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=m(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const C=m(e,["systemInstruction"]);t!==void 0&&C!=null&&v(t,["setup","systemInstruction"],pQ(Cn(C)));const E=m(e,["tools"]);if(t!==void 0&&E!=null){let U=Sl(E);Array.isArray(U)&&(U=U.map(k=>RQ(Tl(k)))),v(t,["setup","tools"],U)}const T=m(e,["sessionResumption"]);t!==void 0&&T!=null&&v(t,["setup","sessionResumption"],QQ(T));const S=m(e,["inputAudioTranscription"]);t!==void 0&&S!=null&&v(t,["setup","inputAudioTranscription"],S);const F=m(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const _=m(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&v(t,["setup","realtimeInputConfig"],_);const N=m(e,["contextWindowCompression"]);t!==void 0&&N!=null&&v(t,["setup","contextWindowCompression"],N);const I=m(e,["proactivity"]);if(t!==void 0&&I!=null&&v(t,["setup","proactivity"],I),m(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return r}function TQ(e,t){const r={},n=m(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],yQ(n));const a=m(e,["responseModalities"]);t!==void 0&&a!=null&&v(t,["setup","generationConfig","responseModalities"],a);const s=m(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const i=m(e,["topP"]);t!==void 0&&i!=null&&v(t,["setup","generationConfig","topP"],i);const l=m(e,["topK"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topK"],l);const u=m(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=m(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=m(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const p=m(e,["speechConfig"]);t!==void 0&&p!=null&&v(t,["setup","generationConfig","speechConfig"],xx(p));const x=m(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=m(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const C=m(e,["systemInstruction"]);t!==void 0&&C!=null&&v(t,["setup","systemInstruction"],Cn(C));const E=m(e,["tools"]);if(t!==void 0&&E!=null){let k=Sl(E);Array.isArray(k)&&(k=k.map(G=>DQ(Tl(G)))),v(t,["setup","tools"],k)}const T=m(e,["sessionResumption"]);t!==void 0&&T!=null&&v(t,["setup","sessionResumption"],T);const S=m(e,["inputAudioTranscription"]);t!==void 0&&S!=null&&v(t,["setup","inputAudioTranscription"],S);const F=m(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const _=m(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&v(t,["setup","realtimeInputConfig"],_);const N=m(e,["contextWindowCompression"]);t!==void 0&&N!=null&&v(t,["setup","contextWindowCompression"],N);const I=m(e,["proactivity"]);t!==void 0&&I!=null&&v(t,["setup","proactivity"],I);const U=m(e,["explicitVadSignal"]);return t!==void 0&&U!=null&&v(t,["setup","explicitVadSignal"],U),r}function SQ(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["setup","model"],rr(e,n));const a=m(t,["config"]);return a!=null&&v(r,["config"],EQ(a,r)),r}function _Q(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["setup","model"],rr(e,n));const a=m(t,["config"]);return a!=null&&v(r,["config"],TQ(a,r)),r}function bQ(e){const t={},r=m(e,["musicGenerationConfig"]);return r!=null&&v(t,["musicGenerationConfig"],r),t}function FQ(e){const t={},r=m(e,["weightedPrompts"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>a)),v(t,["weightedPrompts"],n)}return t}function UQ(e){const t={},r=m(e,["media"]);if(r!=null){let f=IT(r);Array.isArray(f)&&(f=f.map(d=>zf(d))),v(t,["mediaChunks"],f)}const n=m(e,["audio"]);n!=null&&v(t,["audio"],zf(RT(n)));const a=m(e,["audioStreamEnd"]);a!=null&&v(t,["audioStreamEnd"],a);const s=m(e,["video"]);s!=null&&v(t,["video"],zf(QT(s)));const i=m(e,["text"]);i!=null&&v(t,["text"],i);const l=m(e,["activityStart"]);l!=null&&v(t,["activityStart"],l);const u=m(e,["activityEnd"]);return u!=null&&v(t,["activityEnd"],u),t}function kQ(e){const t={},r=m(e,["media"]);if(r!=null){let f=IT(r);Array.isArray(f)&&(f=f.map(d=>d)),v(t,["mediaChunks"],f)}const n=m(e,["audio"]);n!=null&&v(t,["audio"],RT(n));const a=m(e,["audioStreamEnd"]);a!=null&&v(t,["audioStreamEnd"],a);const s=m(e,["video"]);s!=null&&v(t,["video"],QT(s));const i=m(e,["text"]);i!=null&&v(t,["text"],i);const l=m(e,["activityStart"]);l!=null&&v(t,["activityStart"],l);const u=m(e,["activityEnd"]);return u!=null&&v(t,["activityEnd"],u),t}function NQ(e){const t={},r=m(e,["setupComplete"]);r!=null&&v(t,["setupComplete"],r);const n=m(e,["serverContent"]);n!=null&&v(t,["serverContent"],n);const a=m(e,["toolCall"]);a!=null&&v(t,["toolCall"],a);const s=m(e,["toolCallCancellation"]);s!=null&&v(t,["toolCallCancellation"],s);const i=m(e,["usageMetadata"]);i!=null&&v(t,["usageMetadata"],MQ(i));const l=m(e,["goAway"]);l!=null&&v(t,["goAway"],l);const u=m(e,["sessionResumptionUpdate"]);u!=null&&v(t,["sessionResumptionUpdate"],u);const f=m(e,["voiceActivityDetectionSignal"]);f!=null&&v(t,["voiceActivityDetectionSignal"],f);const d=m(e,["voiceActivity"]);return d!=null&&v(t,["voiceActivity"],LQ(d)),t}function IQ(e){const t={},r=m(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=m(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=m(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=m(e,["fileData"]);s!=null&&v(t,["fileData"],xQ(s));const i=m(e,["functionCall"]);i!=null&&v(t,["functionCall"],vQ(i));const l=m(e,["functionResponse"]);l!=null&&v(t,["functionResponse"],l);const u=m(e,["inlineData"]);u!=null&&v(t,["inlineData"],zf(u));const f=m(e,["text"]);f!=null&&v(t,["text"],f);const d=m(e,["thought"]);d!=null&&v(t,["thought"],d);const p=m(e,["thoughtSignature"]);p!=null&&v(t,["thoughtSignature"],p);const x=m(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function QQ(e){const t={},r=m(e,["handle"]);if(r!=null&&v(t,["handle"],r),m(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function RQ(e){const t={};if(m(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=m(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=m(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=m(e,["googleSearch"]);a!=null&&v(t,["googleSearch"],CQ(a));const s=m(e,["codeExecution"]);if(s!=null&&v(t,["codeExecution"],s),m(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const i=m(e,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["functionDeclarations"],p)}const l=m(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],BQ(l));const u=m(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=m(e,["urlContext"]);f!=null&&v(t,["urlContext"],f);const d=m(e,["mcpServers"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["mcpServers"],p)}return t}function DQ(e){const t={},r=m(e,["retrieval"]);r!=null&&v(t,["retrieval"],r);const n=m(e,["computerUse"]);if(n!=null&&v(t,["computerUse"],n),m(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=m(e,["googleSearch"]);a!=null&&v(t,["googleSearch"],a);const s=m(e,["codeExecution"]);s!=null&&v(t,["codeExecution"],s);const i=m(e,["enterpriseWebSearch"]);i!=null&&v(t,["enterpriseWebSearch"],i);const l=m(e,["functionDeclarations"]);if(l!=null){let p=l;Array.isArray(p)&&(p=p.map(x=>wQ(x))),v(t,["functionDeclarations"],p)}const u=m(e,["googleMaps"]);u!=null&&v(t,["googleMaps"],u);const f=m(e,["googleSearchRetrieval"]);f!=null&&v(t,["googleSearchRetrieval"],f);const d=m(e,["urlContext"]);if(d!=null&&v(t,["urlContext"],d),m(e,["mcpServers"])!==void 0)throw new Error("mcpServers parameter is not supported in Vertex AI.");return t}function MQ(e){const t={},r=m(e,["promptTokenCount"]);r!=null&&v(t,["promptTokenCount"],r);const n=m(e,["cachedContentTokenCount"]);n!=null&&v(t,["cachedContentTokenCount"],n);const a=m(e,["candidatesTokenCount"]);a!=null&&v(t,["responseTokenCount"],a);const s=m(e,["toolUsePromptTokenCount"]);s!=null&&v(t,["toolUsePromptTokenCount"],s);const i=m(e,["thoughtsTokenCount"]);i!=null&&v(t,["thoughtsTokenCount"],i);const l=m(e,["totalTokenCount"]);l!=null&&v(t,["totalTokenCount"],l);const u=m(e,["promptTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["promptTokensDetails"],y)}const f=m(e,["cacheTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["cacheTokensDetails"],y)}const d=m(e,["candidatesTokensDetails"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["responseTokensDetails"],y)}const p=m(e,["toolUsePromptTokensDetails"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["toolUsePromptTokensDetails"],y)}const x=m(e,["trafficType"]);return x!=null&&v(t,["trafficType"],x),t}function LQ(e){const t={},r=m(e,["type"]);return r!=null&&v(t,["voiceActivityType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HQ(e,t){const r={},n=m(e,["data"]);if(n!=null&&v(r,["data"],n),m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=m(e,["mimeType"]);return a!=null&&v(r,["mimeType"],a),r}function OQ(e,t){const r={},n=m(e,["content"]);n!=null&&v(r,["content"],n);const a=m(e,["citationMetadata"]);a!=null&&v(r,["citationMetadata"],PQ(a));const s=m(e,["tokenCount"]);s!=null&&v(r,["tokenCount"],s);const i=m(e,["finishReason"]);i!=null&&v(r,["finishReason"],i);const l=m(e,["groundingMetadata"]);l!=null&&v(r,["groundingMetadata"],l);const u=m(e,["avgLogprobs"]);u!=null&&v(r,["avgLogprobs"],u);const f=m(e,["index"]);f!=null&&v(r,["index"],f);const d=m(e,["logprobsResult"]);d!=null&&v(r,["logprobsResult"],d);const p=m(e,["safetyRatings"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(C=>C)),v(r,["safetyRatings"],y)}const x=m(e,["urlContextMetadata"]);return x!=null&&v(r,["urlContextMetadata"],x),r}function PQ(e,t){const r={},n=m(e,["citationSources"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>s)),v(r,["citations"],a)}return r}function GQ(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["contents"]);if(s!=null){let i=ba(s);Array.isArray(i)&&(i=i.map(l=>l)),v(n,["contents"],i)}return n}function VQ(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["tokensInfo"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(r,["tokensInfo"],s)}return r}function KQ(e,t){const r={},n=m(e,["values"]);n!=null&&v(r,["values"],n);const a=m(e,["statistics"]);return a!=null&&v(r,["statistics"],jQ(a)),r}function jQ(e,t){const r={},n=m(e,["truncated"]);n!=null&&v(r,["truncated"],n);const a=m(e,["token_count"]);return a!=null&&v(r,["tokenCount"],a),r}function bu(e,t){const r={},n=m(e,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>eD(i))),v(r,["parts"],s)}const a=m(e,["role"]);return a!=null&&v(r,["role"],a),r}function zQ(e,t){const r={},n=m(e,["controlType"]);n!=null&&v(r,["controlType"],n);const a=m(e,["enableControlImageComputation"]);return a!=null&&v(r,["computeControl"],a),r}function XQ(e,t){const r={};if(m(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return r}function WQ(e,t,r){const n={},a=m(e,["systemInstruction"]);t!==void 0&&a!=null&&v(t,["systemInstruction"],Cn(a));const s=m(e,["tools"]);if(t!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>JT(u))),v(t,["tools"],l)}const i=m(e,["generationConfig"]);return t!==void 0&&i!=null&&v(t,["generationConfig"],HR(i)),n}function JQ(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["contents"]);if(s!=null){let l=ba(s);Array.isArray(l)&&(l=l.map(u=>bu(u))),v(n,["contents"],l)}const i=m(t,["config"]);return i!=null&&XQ(i),n}function YQ(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["contents"]);if(s!=null){let l=ba(s);Array.isArray(l)&&(l=l.map(u=>u)),v(n,["contents"],l)}const i=m(t,["config"]);return i!=null&&WQ(i,n),n}function qQ(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["totalTokens"]);a!=null&&v(r,["totalTokens"],a);const s=m(e,["cachedContentTokenCount"]);return s!=null&&v(r,["cachedContentTokenCount"],s),r}function $Q(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["totalTokens"]);return a!=null&&v(r,["totalTokens"],a),r}function ZQ(e,t,r){const n={},a=m(t,["model"]);return a!=null&&v(n,["_url","name"],rr(e,a)),n}function eR(e,t,r){const n={},a=m(t,["model"]);return a!=null&&v(n,["_url","name"],rr(e,a)),n}function tR(e,t){const r={},n=m(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function rR(e,t){const r={},n=m(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function nR(e,t,r){const n={},a=m(e,["outputGcsUri"]);t!==void 0&&a!=null&&v(t,["parameters","storageUri"],a);const s=m(e,["negativePrompt"]);t!==void 0&&s!=null&&v(t,["parameters","negativePrompt"],s);const i=m(e,["numberOfImages"]);t!==void 0&&i!=null&&v(t,["parameters","sampleCount"],i);const l=m(e,["aspectRatio"]);t!==void 0&&l!=null&&v(t,["parameters","aspectRatio"],l);const u=m(e,["guidanceScale"]);t!==void 0&&u!=null&&v(t,["parameters","guidanceScale"],u);const f=m(e,["seed"]);t!==void 0&&f!=null&&v(t,["parameters","seed"],f);const d=m(e,["safetyFilterLevel"]);t!==void 0&&d!=null&&v(t,["parameters","safetySetting"],d);const p=m(e,["personGeneration"]);t!==void 0&&p!=null&&v(t,["parameters","personGeneration"],p);const x=m(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&v(t,["parameters","includeSafetyAttributes"],x);const y=m(e,["includeRaiReason"]);t!==void 0&&y!=null&&v(t,["parameters","includeRaiReason"],y);const C=m(e,["language"]);t!==void 0&&C!=null&&v(t,["parameters","language"],C);const E=m(e,["outputMimeType"]);t!==void 0&&E!=null&&v(t,["parameters","outputOptions","mimeType"],E);const T=m(e,["outputCompressionQuality"]);t!==void 0&&T!=null&&v(t,["parameters","outputOptions","compressionQuality"],T);const S=m(e,["addWatermark"]);t!==void 0&&S!=null&&v(t,["parameters","addWatermark"],S);const F=m(e,["labels"]);t!==void 0&&F!=null&&v(t,["labels"],F);const _=m(e,["editMode"]);t!==void 0&&_!=null&&v(t,["parameters","editMode"],_);const N=m(e,["baseSteps"]);return t!==void 0&&N!=null&&v(t,["parameters","editConfig","baseSteps"],N),n}function aR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["prompt"]);s!=null&&v(n,["instances[0]","prompt"],s);const i=m(t,["referenceImages"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(f=>sD(f))),v(n,["instances[0]","referenceImages"],u)}const l=m(t,["config"]);return l!=null&&nR(l,n),n}function AR(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["predictions"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>Nd(i))),v(r,["generatedImages"],s)}return r}function sR(e,t,r){const n={},a=m(e,["taskType"]);t!==void 0&&a!=null&&v(t,["requests[]","taskType"],a);const s=m(e,["title"]);t!==void 0&&s!=null&&v(t,["requests[]","title"],s);const i=m(e,["outputDimensionality"]);if(t!==void 0&&i!=null&&v(t,["requests[]","outputDimensionality"],i),m(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function iR(e,t,r){const n={};let a=m(r,["embeddingApiType"]);if(a===void 0&&(a="PREDICT"),a==="PREDICT"){const f=m(e,["taskType"]);t!==void 0&&f!=null&&v(t,["instances[]","task_type"],f)}else if(a==="EMBED_CONTENT"){const f=m(e,["taskType"]);t!==void 0&&f!=null&&v(t,["taskType"],f)}let s=m(r,["embeddingApiType"]);if(s===void 0&&(s="PREDICT"),s==="PREDICT"){const f=m(e,["title"]);t!==void 0&&f!=null&&v(t,["instances[]","title"],f)}else if(s==="EMBED_CONTENT"){const f=m(e,["title"]);t!==void 0&&f!=null&&v(t,["title"],f)}let i=m(r,["embeddingApiType"]);if(i===void 0&&(i="PREDICT"),i==="PREDICT"){const f=m(e,["outputDimensionality"]);t!==void 0&&f!=null&&v(t,["parameters","outputDimensionality"],f)}else if(i==="EMBED_CONTENT"){const f=m(e,["outputDimensionality"]);t!==void 0&&f!=null&&v(t,["outputDimensionality"],f)}let l=m(r,["embeddingApiType"]);if(l===void 0&&(l="PREDICT"),l==="PREDICT"){const f=m(e,["mimeType"]);t!==void 0&&f!=null&&v(t,["instances[]","mimeType"],f)}let u=m(r,["embeddingApiType"]);if(u===void 0&&(u="PREDICT"),u==="PREDICT"){const f=m(e,["autoTruncate"]);t!==void 0&&f!=null&&v(t,["parameters","autoTruncate"],f)}else if(u==="EMBED_CONTENT"){const f=m(e,["autoTruncate"]);t!==void 0&&f!=null&&v(t,["autoTruncate"],f)}return n}function oR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["contents"]);if(s!=null){let f=gx(e,s);Array.isArray(f)&&(f=f.map(d=>d)),v(n,["requests[]","content"],f)}const i=m(t,["content"]);i!=null&&bu(Cn(i));const l=m(t,["config"]);l!=null&&sR(l,n);const u=m(t,["model"]);return u!==void 0&&v(n,["requests[]","model"],rr(e,u)),n}function lR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));let s=m(r,["embeddingApiType"]);if(s===void 0&&(s="PREDICT"),s==="PREDICT"){const u=m(t,["contents"]);if(u!=null){let f=gx(e,u);Array.isArray(f)&&(f=f.map(d=>d)),v(n,["instances[]","content"],f)}}let i=m(r,["embeddingApiType"]);if(i===void 0&&(i="PREDICT"),i==="EMBED_CONTENT"){const u=m(t,["content"]);u!=null&&v(n,["content"],Cn(u))}const l=m(t,["config"]);return l!=null&&iR(l,n,r),n}function cR(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["embeddings"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>l)),v(r,["embeddings"],i)}const s=m(e,["metadata"]);return s!=null&&v(r,["metadata"],s),r}function uR(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["predictions[]","embeddings"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>KQ(l))),v(r,["embeddings"],i)}const s=m(e,["metadata"]);if(s!=null&&v(r,["metadata"],s),t&&m(t,["embeddingApiType"])==="EMBED_CONTENT"){const i=m(e,["embedding"]),l=m(e,["usageMetadata"]),u=m(e,["truncated"]);if(i){const f={};l&&l.promptTokenCount&&(f.tokenCount=l.promptTokenCount),u&&(f.truncated=u),i.statistics=f,v(r,["embeddings"],[i])}}return r}function fR(e,t){const r={},n=m(e,["endpoint"]);n!=null&&v(r,["name"],n);const a=m(e,["deployedModelId"]);return a!=null&&v(r,["deployedModelId"],a),r}function dR(e,t){const r={};if(m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(e,["fileUri"]);n!=null&&v(r,["fileUri"],n);const a=m(e,["mimeType"]);return a!=null&&v(r,["mimeType"],a),r}function hR(e,t){const r={},n=m(e,["id"]);n!=null&&v(r,["id"],n);const a=m(e,["args"]);a!=null&&v(r,["args"],a);const s=m(e,["name"]);if(s!=null&&v(r,["name"],s),m(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return r}function gR(e,t){const r={},n=m(e,["allowedFunctionNames"]);n!=null&&v(r,["allowedFunctionNames"],n);const a=m(e,["mode"]);if(a!=null&&v(r,["mode"],a),m(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return r}function mR(e,t){const r={},n=m(e,["description"]);n!=null&&v(r,["description"],n);const a=m(e,["name"]);a!=null&&v(r,["name"],a);const s=m(e,["parameters"]);s!=null&&v(r,["parameters"],s);const i=m(e,["parametersJsonSchema"]);i!=null&&v(r,["parametersJsonSchema"],i);const l=m(e,["response"]);l!=null&&v(r,["response"],l);const u=m(e,["responseJsonSchema"]);if(u!=null&&v(r,["responseJsonSchema"],u),m(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return r}function pR(e,t,r,n){const a={},s=m(t,["systemInstruction"]);r!==void 0&&s!=null&&v(r,["systemInstruction"],bu(Cn(s)));const i=m(t,["temperature"]);i!=null&&v(a,["temperature"],i);const l=m(t,["topP"]);l!=null&&v(a,["topP"],l);const u=m(t,["topK"]);u!=null&&v(a,["topK"],u);const f=m(t,["candidateCount"]);f!=null&&v(a,["candidateCount"],f);const d=m(t,["maxOutputTokens"]);d!=null&&v(a,["maxOutputTokens"],d);const p=m(t,["stopSequences"]);p!=null&&v(a,["stopSequences"],p);const x=m(t,["responseLogprobs"]);x!=null&&v(a,["responseLogprobs"],x);const y=m(t,["logprobs"]);y!=null&&v(a,["logprobs"],y);const C=m(t,["presencePenalty"]);C!=null&&v(a,["presencePenalty"],C);const E=m(t,["frequencyPenalty"]);E!=null&&v(a,["frequencyPenalty"],E);const T=m(t,["seed"]);T!=null&&v(a,["seed"],T);const S=m(t,["responseMimeType"]);S!=null&&v(a,["responseMimeType"],S);const F=m(t,["responseSchema"]);F!=null&&v(a,["responseSchema"],mx(F));const _=m(t,["responseJsonSchema"]);if(_!=null&&v(a,["responseJsonSchema"],_),m(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const N=m(t,["safetySettings"]);if(r!==void 0&&N!=null){let Te=N;Array.isArray(Te)&&(Te=Te.map(Be=>iD(Be))),v(r,["safetySettings"],Te)}const I=m(t,["tools"]);if(r!==void 0&&I!=null){let Te=Sl(I);Array.isArray(Te)&&(Te=Te.map(Be=>hD(Tl(Be)))),v(r,["tools"],Te)}const U=m(t,["toolConfig"]);if(r!==void 0&&U!=null&&v(r,["toolConfig"],dD(U)),m(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=m(t,["cachedContent"]);r!==void 0&&k!=null&&v(r,["cachedContent"],gs(e,k));const G=m(t,["responseModalities"]);G!=null&&v(a,["responseModalities"],G);const M=m(t,["mediaResolution"]);M!=null&&v(a,["mediaResolution"],M);const ee=m(t,["speechConfig"]);if(ee!=null&&v(a,["speechConfig"],px(ee)),m(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const re=m(t,["thinkingConfig"]);re!=null&&v(a,["thinkingConfig"],re);const q=m(t,["imageConfig"]);q!=null&&v(a,["imageConfig"],KR(q));const se=m(t,["enableEnhancedCivicAnswers"]);if(se!=null&&v(a,["enableEnhancedCivicAnswers"],se),m(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return a}function xR(e,t,r,n){const a={},s=m(t,["systemInstruction"]);r!==void 0&&s!=null&&v(r,["systemInstruction"],Cn(s));const i=m(t,["temperature"]);i!=null&&v(a,["temperature"],i);const l=m(t,["topP"]);l!=null&&v(a,["topP"],l);const u=m(t,["topK"]);u!=null&&v(a,["topK"],u);const f=m(t,["candidateCount"]);f!=null&&v(a,["candidateCount"],f);const d=m(t,["maxOutputTokens"]);d!=null&&v(a,["maxOutputTokens"],d);const p=m(t,["stopSequences"]);p!=null&&v(a,["stopSequences"],p);const x=m(t,["responseLogprobs"]);x!=null&&v(a,["responseLogprobs"],x);const y=m(t,["logprobs"]);y!=null&&v(a,["logprobs"],y);const C=m(t,["presencePenalty"]);C!=null&&v(a,["presencePenalty"],C);const E=m(t,["frequencyPenalty"]);E!=null&&v(a,["frequencyPenalty"],E);const T=m(t,["seed"]);T!=null&&v(a,["seed"],T);const S=m(t,["responseMimeType"]);S!=null&&v(a,["responseMimeType"],S);const F=m(t,["responseSchema"]);F!=null&&v(a,["responseSchema"],mx(F));const _=m(t,["responseJsonSchema"]);_!=null&&v(a,["responseJsonSchema"],_);const N=m(t,["routingConfig"]);N!=null&&v(a,["routingConfig"],N);const I=m(t,["modelSelectionConfig"]);I!=null&&v(a,["modelConfig"],I);const U=m(t,["safetySettings"]);if(r!==void 0&&U!=null){let Qe=U;Array.isArray(Qe)&&(Qe=Qe.map(ae=>ae)),v(r,["safetySettings"],Qe)}const k=m(t,["tools"]);if(r!==void 0&&k!=null){let Qe=Sl(k);Array.isArray(Qe)&&(Qe=Qe.map(ae=>JT(Tl(ae)))),v(r,["tools"],Qe)}const G=m(t,["toolConfig"]);r!==void 0&&G!=null&&v(r,["toolConfig"],G);const M=m(t,["labels"]);r!==void 0&&M!=null&&v(r,["labels"],M);const ee=m(t,["cachedContent"]);r!==void 0&&ee!=null&&v(r,["cachedContent"],gs(e,ee));const re=m(t,["responseModalities"]);re!=null&&v(a,["responseModalities"],re);const q=m(t,["mediaResolution"]);q!=null&&v(a,["mediaResolution"],q);const se=m(t,["speechConfig"]);se!=null&&v(a,["speechConfig"],px(se));const Te=m(t,["audioTimestamp"]);Te!=null&&v(a,["audioTimestamp"],Te);const Be=m(t,["thinkingConfig"]);Be!=null&&v(a,["thinkingConfig"],Be);const Z=m(t,["imageConfig"]);if(Z!=null&&v(a,["imageConfig"],jR(Z)),m(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const ie=m(t,["modelArmorConfig"]);return r!==void 0&&ie!=null&&v(r,["modelArmorConfig"],ie),a}function FC(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["contents"]);if(s!=null){let l=ba(s);Array.isArray(l)&&(l=l.map(u=>bu(u))),v(n,["contents"],l)}const i=m(t,["config"]);return i!=null&&v(n,["generationConfig"],pR(e,i,n)),n}function UC(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["contents"]);if(s!=null){let l=ba(s);Array.isArray(l)&&(l=l.map(u=>u)),v(n,["contents"],l)}const i=m(t,["config"]);return i!=null&&v(n,["generationConfig"],xR(e,i,n)),n}function kC(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["candidates"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(d=>OQ(d))),v(r,["candidates"],f)}const s=m(e,["modelVersion"]);s!=null&&v(r,["modelVersion"],s);const i=m(e,["promptFeedback"]);i!=null&&v(r,["promptFeedback"],i);const l=m(e,["responseId"]);l!=null&&v(r,["responseId"],l);const u=m(e,["usageMetadata"]);return u!=null&&v(r,["usageMetadata"],u),r}function NC(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["candidates"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>p)),v(r,["candidates"],d)}const s=m(e,["createTime"]);s!=null&&v(r,["createTime"],s);const i=m(e,["modelVersion"]);i!=null&&v(r,["modelVersion"],i);const l=m(e,["promptFeedback"]);l!=null&&v(r,["promptFeedback"],l);const u=m(e,["responseId"]);u!=null&&v(r,["responseId"],u);const f=m(e,["usageMetadata"]);return f!=null&&v(r,["usageMetadata"],f),r}function vR(e,t,r){const n={};if(m(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=m(e,["numberOfImages"]);t!==void 0&&a!=null&&v(t,["parameters","sampleCount"],a);const s=m(e,["aspectRatio"]);t!==void 0&&s!=null&&v(t,["parameters","aspectRatio"],s);const i=m(e,["guidanceScale"]);if(t!==void 0&&i!=null&&v(t,["parameters","guidanceScale"],i),m(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&v(t,["parameters","safetySetting"],l);const u=m(e,["personGeneration"]);t!==void 0&&u!=null&&v(t,["parameters","personGeneration"],u);const f=m(e,["includeSafetyAttributes"]);t!==void 0&&f!=null&&v(t,["parameters","includeSafetyAttributes"],f);const d=m(e,["includeRaiReason"]);t!==void 0&&d!=null&&v(t,["parameters","includeRaiReason"],d);const p=m(e,["language"]);t!==void 0&&p!=null&&v(t,["parameters","language"],p);const x=m(e,["outputMimeType"]);t!==void 0&&x!=null&&v(t,["parameters","outputOptions","mimeType"],x);const y=m(e,["outputCompressionQuality"]);if(t!==void 0&&y!=null&&v(t,["parameters","outputOptions","compressionQuality"],y),m(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=m(e,["imageSize"]);if(t!==void 0&&C!=null&&v(t,["parameters","sampleImageSize"],C),m(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function wR(e,t,r){const n={},a=m(e,["outputGcsUri"]);t!==void 0&&a!=null&&v(t,["parameters","storageUri"],a);const s=m(e,["negativePrompt"]);t!==void 0&&s!=null&&v(t,["parameters","negativePrompt"],s);const i=m(e,["numberOfImages"]);t!==void 0&&i!=null&&v(t,["parameters","sampleCount"],i);const l=m(e,["aspectRatio"]);t!==void 0&&l!=null&&v(t,["parameters","aspectRatio"],l);const u=m(e,["guidanceScale"]);t!==void 0&&u!=null&&v(t,["parameters","guidanceScale"],u);const f=m(e,["seed"]);t!==void 0&&f!=null&&v(t,["parameters","seed"],f);const d=m(e,["safetyFilterLevel"]);t!==void 0&&d!=null&&v(t,["parameters","safetySetting"],d);const p=m(e,["personGeneration"]);t!==void 0&&p!=null&&v(t,["parameters","personGeneration"],p);const x=m(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&v(t,["parameters","includeSafetyAttributes"],x);const y=m(e,["includeRaiReason"]);t!==void 0&&y!=null&&v(t,["parameters","includeRaiReason"],y);const C=m(e,["language"]);t!==void 0&&C!=null&&v(t,["parameters","language"],C);const E=m(e,["outputMimeType"]);t!==void 0&&E!=null&&v(t,["parameters","outputOptions","mimeType"],E);const T=m(e,["outputCompressionQuality"]);t!==void 0&&T!=null&&v(t,["parameters","outputOptions","compressionQuality"],T);const S=m(e,["addWatermark"]);t!==void 0&&S!=null&&v(t,["parameters","addWatermark"],S);const F=m(e,["labels"]);t!==void 0&&F!=null&&v(t,["labels"],F);const _=m(e,["imageSize"]);t!==void 0&&_!=null&&v(t,["parameters","sampleImageSize"],_);const N=m(e,["enhancePrompt"]);return t!==void 0&&N!=null&&v(t,["parameters","enhancePrompt"],N),n}function yR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["prompt"]);s!=null&&v(n,["instances[0]","prompt"],s);const i=m(t,["config"]);return i!=null&&vR(i,n),n}function BR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["prompt"]);s!=null&&v(n,["instances[0]","prompt"],s);const i=m(t,["config"]);return i!=null&&wR(i,n),n}function CR(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["predictions"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>RR(l))),v(r,["generatedImages"],i)}const s=m(e,["positivePromptSafetyAttributes"]);return s!=null&&v(r,["positivePromptSafetyAttributes"],XT(s)),r}function ER(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["predictions"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>Nd(l))),v(r,["generatedImages"],i)}const s=m(e,["positivePromptSafetyAttributes"]);return s!=null&&v(r,["positivePromptSafetyAttributes"],WT(s)),r}function TR(e,t,r){const n={},a=m(e,["numberOfVideos"]);if(t!==void 0&&a!=null&&v(t,["parameters","sampleCount"],a),m(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=m(e,["durationSeconds"]);if(t!==void 0&&s!=null&&v(t,["parameters","durationSeconds"],s),m(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=m(e,["aspectRatio"]);t!==void 0&&i!=null&&v(t,["parameters","aspectRatio"],i);const l=m(e,["resolution"]);t!==void 0&&l!=null&&v(t,["parameters","resolution"],l);const u=m(e,["personGeneration"]);if(t!==void 0&&u!=null&&v(t,["parameters","personGeneration"],u),m(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=m(e,["negativePrompt"]);t!==void 0&&f!=null&&v(t,["parameters","negativePrompt"],f);const d=m(e,["enhancePrompt"]);if(t!==void 0&&d!=null&&v(t,["parameters","enhancePrompt"],d),m(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=m(e,["lastFrame"]);t!==void 0&&p!=null&&v(t,["instances[0]","lastFrame"],Id(p));const x=m(e,["referenceImages"]);if(t!==void 0&&x!=null){let y=x;Array.isArray(y)&&(y=y.map(C=>_D(C))),v(t,["instances[0]","referenceImages"],y)}if(m(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function SR(e,t,r){const n={},a=m(e,["numberOfVideos"]);t!==void 0&&a!=null&&v(t,["parameters","sampleCount"],a);const s=m(e,["outputGcsUri"]);t!==void 0&&s!=null&&v(t,["parameters","storageUri"],s);const i=m(e,["fps"]);t!==void 0&&i!=null&&v(t,["parameters","fps"],i);const l=m(e,["durationSeconds"]);t!==void 0&&l!=null&&v(t,["parameters","durationSeconds"],l);const u=m(e,["seed"]);t!==void 0&&u!=null&&v(t,["parameters","seed"],u);const f=m(e,["aspectRatio"]);t!==void 0&&f!=null&&v(t,["parameters","aspectRatio"],f);const d=m(e,["resolution"]);t!==void 0&&d!=null&&v(t,["parameters","resolution"],d);const p=m(e,["personGeneration"]);t!==void 0&&p!=null&&v(t,["parameters","personGeneration"],p);const x=m(e,["pubsubTopic"]);t!==void 0&&x!=null&&v(t,["parameters","pubsubTopic"],x);const y=m(e,["negativePrompt"]);t!==void 0&&y!=null&&v(t,["parameters","negativePrompt"],y);const C=m(e,["enhancePrompt"]);t!==void 0&&C!=null&&v(t,["parameters","enhancePrompt"],C);const E=m(e,["generateAudio"]);t!==void 0&&E!=null&&v(t,["parameters","generateAudio"],E);const T=m(e,["lastFrame"]);t!==void 0&&T!=null&&v(t,["instances[0]","lastFrame"],pA(T));const S=m(e,["referenceImages"]);if(t!==void 0&&S!=null){let N=S;Array.isArray(N)&&(N=N.map(I=>bD(I))),v(t,["instances[0]","referenceImages"],N)}const F=m(e,["mask"]);t!==void 0&&F!=null&&v(t,["instances[0]","mask"],SD(F));const _=m(e,["compressionQuality"]);return t!==void 0&&_!=null&&v(t,["parameters","compressionQuality"],_),n}function _R(e,t){const r={},n=m(e,["name"]);n!=null&&v(r,["name"],n);const a=m(e,["metadata"]);a!=null&&v(r,["metadata"],a);const s=m(e,["done"]);s!=null&&v(r,["done"],s);const i=m(e,["error"]);i!=null&&v(r,["error"],i);const l=m(e,["response","generateVideoResponse"]);return l!=null&&v(r,["response"],kR(l)),r}function bR(e,t){const r={},n=m(e,["name"]);n!=null&&v(r,["name"],n);const a=m(e,["metadata"]);a!=null&&v(r,["metadata"],a);const s=m(e,["done"]);s!=null&&v(r,["done"],s);const i=m(e,["error"]);i!=null&&v(r,["error"],i);const l=m(e,["response"]);return l!=null&&v(r,["response"],NR(l)),r}function FR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["prompt"]);s!=null&&v(n,["instances[0]","prompt"],s);const i=m(t,["image"]);i!=null&&v(n,["instances[0]","image"],Id(i));const l=m(t,["video"]);l!=null&&v(n,["instances[0]","video"],YT(l));const u=m(t,["source"]);u!=null&&IR(u,n);const f=m(t,["config"]);return f!=null&&TR(f,n),n}function UR(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["prompt"]);s!=null&&v(n,["instances[0]","prompt"],s);const i=m(t,["image"]);i!=null&&v(n,["instances[0]","image"],pA(i));const l=m(t,["video"]);l!=null&&v(n,["instances[0]","video"],qT(l));const u=m(t,["source"]);u!=null&&QR(u,n);const f=m(t,["config"]);return f!=null&&SR(f,n),n}function kR(e,t){const r={},n=m(e,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>MR(l))),v(r,["generatedVideos"],i)}const a=m(e,["raiMediaFilteredCount"]);a!=null&&v(r,["raiMediaFilteredCount"],a);const s=m(e,["raiMediaFilteredReasons"]);return s!=null&&v(r,["raiMediaFilteredReasons"],s),r}function NR(e,t){const r={},n=m(e,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>LR(l))),v(r,["generatedVideos"],i)}const a=m(e,["raiMediaFilteredCount"]);a!=null&&v(r,["raiMediaFilteredCount"],a);const s=m(e,["raiMediaFilteredReasons"]);return s!=null&&v(r,["raiMediaFilteredReasons"],s),r}function IR(e,t,r){const n={},a=m(e,["prompt"]);t!==void 0&&a!=null&&v(t,["instances[0]","prompt"],a);const s=m(e,["image"]);t!==void 0&&s!=null&&v(t,["instances[0]","image"],Id(s));const i=m(e,["video"]);return t!==void 0&&i!=null&&v(t,["instances[0]","video"],YT(i)),n}function QR(e,t,r){const n={},a=m(e,["prompt"]);t!==void 0&&a!=null&&v(t,["instances[0]","prompt"],a);const s=m(e,["image"]);t!==void 0&&s!=null&&v(t,["instances[0]","image"],pA(s));const i=m(e,["video"]);return t!==void 0&&i!=null&&v(t,["instances[0]","video"],qT(i)),n}function RR(e,t){const r={},n=m(e,["_self"]);n!=null&&v(r,["image"],zR(n));const a=m(e,["raiFilteredReason"]);a!=null&&v(r,["raiFilteredReason"],a);const s=m(e,["_self"]);return s!=null&&v(r,["safetyAttributes"],XT(s)),r}function Nd(e,t){const r={},n=m(e,["_self"]);n!=null&&v(r,["image"],zT(n));const a=m(e,["raiFilteredReason"]);a!=null&&v(r,["raiFilteredReason"],a);const s=m(e,["_self"]);s!=null&&v(r,["safetyAttributes"],WT(s));const i=m(e,["prompt"]);return i!=null&&v(r,["enhancedPrompt"],i),r}function DR(e,t){const r={},n=m(e,["_self"]);n!=null&&v(r,["mask"],zT(n));const a=m(e,["labels"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(r,["labels"],s)}return r}function MR(e,t){const r={},n=m(e,["video"]);return n!=null&&v(r,["video"],ED(n)),r}function LR(e,t){const r={},n=m(e,["_self"]);return n!=null&&v(r,["video"],TD(n)),r}function HR(e,t){const r={},n=m(e,["modelSelectionConfig"]);n!=null&&v(r,["modelConfig"],n);const a=m(e,["responseJsonSchema"]);a!=null&&v(r,["responseJsonSchema"],a);const s=m(e,["audioTimestamp"]);s!=null&&v(r,["audioTimestamp"],s);const i=m(e,["candidateCount"]);i!=null&&v(r,["candidateCount"],i);const l=m(e,["enableAffectiveDialog"]);l!=null&&v(r,["enableAffectiveDialog"],l);const u=m(e,["frequencyPenalty"]);u!=null&&v(r,["frequencyPenalty"],u);const f=m(e,["logprobs"]);f!=null&&v(r,["logprobs"],f);const d=m(e,["maxOutputTokens"]);d!=null&&v(r,["maxOutputTokens"],d);const p=m(e,["mediaResolution"]);p!=null&&v(r,["mediaResolution"],p);const x=m(e,["presencePenalty"]);x!=null&&v(r,["presencePenalty"],x);const y=m(e,["responseLogprobs"]);y!=null&&v(r,["responseLogprobs"],y);const C=m(e,["responseMimeType"]);C!=null&&v(r,["responseMimeType"],C);const E=m(e,["responseModalities"]);E!=null&&v(r,["responseModalities"],E);const T=m(e,["responseSchema"]);T!=null&&v(r,["responseSchema"],T);const S=m(e,["routingConfig"]);S!=null&&v(r,["routingConfig"],S);const F=m(e,["seed"]);F!=null&&v(r,["seed"],F);const _=m(e,["speechConfig"]);_!=null&&v(r,["speechConfig"],_);const N=m(e,["stopSequences"]);N!=null&&v(r,["stopSequences"],N);const I=m(e,["temperature"]);I!=null&&v(r,["temperature"],I);const U=m(e,["thinkingConfig"]);U!=null&&v(r,["thinkingConfig"],U);const k=m(e,["topK"]);k!=null&&v(r,["topK"],k);const G=m(e,["topP"]);if(G!=null&&v(r,["topP"],G),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function OR(e,t,r){const n={},a=m(t,["model"]);return a!=null&&v(n,["_url","name"],rr(e,a)),n}function PR(e,t,r){const n={},a=m(t,["model"]);return a!=null&&v(n,["_url","name"],rr(e,a)),n}function GR(e,t){const r={};if(m(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=m(e,["enableWidget"]);return n!=null&&v(r,["enableWidget"],n),r}function VR(e,t){const r={},n=m(e,["searchTypes"]);if(n!=null&&v(r,["searchTypes"],n),m(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const a=m(e,["timeRangeFilter"]);return a!=null&&v(r,["timeRangeFilter"],a),r}function KR(e,t){const r={},n=m(e,["aspectRatio"]);n!=null&&v(r,["aspectRatio"],n);const a=m(e,["imageSize"]);if(a!=null&&v(r,["imageSize"],a),m(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(e,["prominentPeople"])!==void 0)throw new Error("prominentPeople parameter is not supported in Gemini API.");if(m(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return r}function jR(e,t){const r={},n=m(e,["aspectRatio"]);n!=null&&v(r,["aspectRatio"],n);const a=m(e,["imageSize"]);a!=null&&v(r,["imageSize"],a);const s=m(e,["personGeneration"]);s!=null&&v(r,["personGeneration"],s);const i=m(e,["prominentPeople"]);i!=null&&v(r,["prominentPeople"],i);const l=m(e,["outputMimeType"]);l!=null&&v(r,["imageOutputOptions","mimeType"],l);const u=m(e,["outputCompressionQuality"]);return u!=null&&v(r,["imageOutputOptions","compressionQuality"],u),r}function zR(e,t){const r={},n=m(e,["bytesBase64Encoded"]);n!=null&&v(r,["imageBytes"],oi(n));const a=m(e,["mimeType"]);return a!=null&&v(r,["mimeType"],a),r}function zT(e,t){const r={},n=m(e,["gcsUri"]);n!=null&&v(r,["gcsUri"],n);const a=m(e,["bytesBase64Encoded"]);a!=null&&v(r,["imageBytes"],oi(a));const s=m(e,["mimeType"]);return s!=null&&v(r,["mimeType"],s),r}function Id(e,t){const r={};if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=m(e,["imageBytes"]);n!=null&&v(r,["bytesBase64Encoded"],oi(n));const a=m(e,["mimeType"]);return a!=null&&v(r,["mimeType"],a),r}function pA(e,t){const r={},n=m(e,["gcsUri"]);n!=null&&v(r,["gcsUri"],n);const a=m(e,["imageBytes"]);a!=null&&v(r,["bytesBase64Encoded"],oi(a));const s=m(e,["mimeType"]);return s!=null&&v(r,["mimeType"],s),r}function XR(e,t,r,n){const a={},s=m(t,["pageSize"]);r!==void 0&&s!=null&&v(r,["_query","pageSize"],s);const i=m(t,["pageToken"]);r!==void 0&&i!=null&&v(r,["_query","pageToken"],i);const l=m(t,["filter"]);r!==void 0&&l!=null&&v(r,["_query","filter"],l);const u=m(t,["queryBase"]);return r!==void 0&&u!=null&&v(r,["_url","models_url"],HT(e,u)),a}function WR(e,t,r,n){const a={},s=m(t,["pageSize"]);r!==void 0&&s!=null&&v(r,["_query","pageSize"],s);const i=m(t,["pageToken"]);r!==void 0&&i!=null&&v(r,["_query","pageToken"],i);const l=m(t,["filter"]);r!==void 0&&l!=null&&v(r,["_query","filter"],l);const u=m(t,["queryBase"]);return r!==void 0&&u!=null&&v(r,["_url","models_url"],HT(e,u)),a}function JR(e,t,r){const n={},a=m(t,["config"]);return a!=null&&XR(e,a,n),n}function YR(e,t,r){const n={},a=m(t,["config"]);return a!=null&&WR(e,a,n),n}function qR(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["nextPageToken"]);a!=null&&v(r,["nextPageToken"],a);const s=m(e,["_self"]);if(s!=null){let i=OT(s);Array.isArray(i)&&(i=i.map(l=>cp(l))),v(r,["models"],i)}return r}function $R(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["nextPageToken"]);a!=null&&v(r,["nextPageToken"],a);const s=m(e,["_self"]);if(s!=null){let i=OT(s);Array.isArray(i)&&(i=i.map(l=>up(l))),v(r,["models"],i)}return r}function ZR(e,t){const r={},n=m(e,["maskMode"]);n!=null&&v(r,["maskMode"],n);const a=m(e,["segmentationClasses"]);a!=null&&v(r,["maskClasses"],a);const s=m(e,["maskDilation"]);return s!=null&&v(r,["dilation"],s),r}function cp(e,t){const r={},n=m(e,["name"]);n!=null&&v(r,["name"],n);const a=m(e,["displayName"]);a!=null&&v(r,["displayName"],a);const s=m(e,["description"]);s!=null&&v(r,["description"],s);const i=m(e,["version"]);i!=null&&v(r,["version"],i);const l=m(e,["_self"]);l!=null&&v(r,["tunedModelInfo"],gD(l));const u=m(e,["inputTokenLimit"]);u!=null&&v(r,["inputTokenLimit"],u);const f=m(e,["outputTokenLimit"]);f!=null&&v(r,["outputTokenLimit"],f);const d=m(e,["supportedGenerationMethods"]);d!=null&&v(r,["supportedActions"],d);const p=m(e,["temperature"]);p!=null&&v(r,["temperature"],p);const x=m(e,["maxTemperature"]);x!=null&&v(r,["maxTemperature"],x);const y=m(e,["topP"]);y!=null&&v(r,["topP"],y);const C=m(e,["topK"]);C!=null&&v(r,["topK"],C);const E=m(e,["thinking"]);return E!=null&&v(r,["thinking"],E),r}function up(e,t){const r={},n=m(e,["name"]);n!=null&&v(r,["name"],n);const a=m(e,["displayName"]);a!=null&&v(r,["displayName"],a);const s=m(e,["description"]);s!=null&&v(r,["description"],s);const i=m(e,["versionId"]);i!=null&&v(r,["version"],i);const l=m(e,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(y=>fR(y))),v(r,["endpoints"],x)}const u=m(e,["labels"]);u!=null&&v(r,["labels"],u);const f=m(e,["_self"]);f!=null&&v(r,["tunedModelInfo"],mD(f));const d=m(e,["defaultCheckpointId"]);d!=null&&v(r,["defaultCheckpointId"],d);const p=m(e,["checkpoints"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(y=>y)),v(r,["checkpoints"],x)}return r}function eD(e,t){const r={},n=m(e,["mediaResolution"]);n!=null&&v(r,["mediaResolution"],n);const a=m(e,["codeExecutionResult"]);a!=null&&v(r,["codeExecutionResult"],a);const s=m(e,["executableCode"]);s!=null&&v(r,["executableCode"],s);const i=m(e,["fileData"]);i!=null&&v(r,["fileData"],dR(i));const l=m(e,["functionCall"]);l!=null&&v(r,["functionCall"],hR(l));const u=m(e,["functionResponse"]);u!=null&&v(r,["functionResponse"],u);const f=m(e,["inlineData"]);f!=null&&v(r,["inlineData"],HQ(f));const d=m(e,["text"]);d!=null&&v(r,["text"],d);const p=m(e,["thought"]);p!=null&&v(r,["thought"],p);const x=m(e,["thoughtSignature"]);x!=null&&v(r,["thoughtSignature"],x);const y=m(e,["videoMetadata"]);return y!=null&&v(r,["videoMetadata"],y),r}function tD(e,t){const r={},n=m(e,["productImage"]);return n!=null&&v(r,["image"],pA(n)),r}function rD(e,t,r){const n={},a=m(e,["numberOfImages"]);t!==void 0&&a!=null&&v(t,["parameters","sampleCount"],a);const s=m(e,["baseSteps"]);t!==void 0&&s!=null&&v(t,["parameters","baseSteps"],s);const i=m(e,["outputGcsUri"]);t!==void 0&&i!=null&&v(t,["parameters","storageUri"],i);const l=m(e,["seed"]);t!==void 0&&l!=null&&v(t,["parameters","seed"],l);const u=m(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&v(t,["parameters","safetySetting"],u);const f=m(e,["personGeneration"]);t!==void 0&&f!=null&&v(t,["parameters","personGeneration"],f);const d=m(e,["addWatermark"]);t!==void 0&&d!=null&&v(t,["parameters","addWatermark"],d);const p=m(e,["outputMimeType"]);t!==void 0&&p!=null&&v(t,["parameters","outputOptions","mimeType"],p);const x=m(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&v(t,["parameters","outputOptions","compressionQuality"],x);const y=m(e,["enhancePrompt"]);t!==void 0&&y!=null&&v(t,["parameters","enhancePrompt"],y);const C=m(e,["labels"]);return t!==void 0&&C!=null&&v(t,["labels"],C),n}function nD(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["source"]);s!=null&&AD(s,n);const i=m(t,["config"]);return i!=null&&rD(i,n),n}function aD(e,t){const r={},n=m(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>Nd(s))),v(r,["generatedImages"],a)}return r}function AD(e,t,r){const n={},a=m(e,["prompt"]);t!==void 0&&a!=null&&v(t,["instances[0]","prompt"],a);const s=m(e,["personImage"]);t!==void 0&&s!=null&&v(t,["instances[0]","personImage","image"],pA(s));const i=m(e,["productImages"]);if(t!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>tD(u))),v(t,["instances[0]","productImages"],l)}return n}function sD(e,t){const r={},n=m(e,["referenceImage"]);n!=null&&v(r,["referenceImage"],pA(n));const a=m(e,["referenceId"]);a!=null&&v(r,["referenceId"],a);const s=m(e,["referenceType"]);s!=null&&v(r,["referenceType"],s);const i=m(e,["maskImageConfig"]);i!=null&&v(r,["maskImageConfig"],ZR(i));const l=m(e,["controlImageConfig"]);l!=null&&v(r,["controlImageConfig"],zQ(l));const u=m(e,["styleImageConfig"]);u!=null&&v(r,["styleImageConfig"],u);const f=m(e,["subjectImageConfig"]);return f!=null&&v(r,["subjectImageConfig"],f),r}function XT(e,t){const r={},n=m(e,["safetyAttributes","categories"]);n!=null&&v(r,["categories"],n);const a=m(e,["safetyAttributes","scores"]);a!=null&&v(r,["scores"],a);const s=m(e,["contentType"]);return s!=null&&v(r,["contentType"],s),r}function WT(e,t){const r={},n=m(e,["safetyAttributes","categories"]);n!=null&&v(r,["categories"],n);const a=m(e,["safetyAttributes","scores"]);a!=null&&v(r,["scores"],a);const s=m(e,["contentType"]);return s!=null&&v(r,["contentType"],s),r}function iD(e,t){const r={},n=m(e,["category"]);if(n!=null&&v(r,["category"],n),m(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const a=m(e,["threshold"]);return a!=null&&v(r,["threshold"],a),r}function oD(e,t){const r={},n=m(e,["image"]);return n!=null&&v(r,["image"],pA(n)),r}function lD(e,t,r){const n={},a=m(e,["mode"]);t!==void 0&&a!=null&&v(t,["parameters","mode"],a);const s=m(e,["maxPredictions"]);t!==void 0&&s!=null&&v(t,["parameters","maxPredictions"],s);const i=m(e,["confidenceThreshold"]);t!==void 0&&i!=null&&v(t,["parameters","confidenceThreshold"],i);const l=m(e,["maskDilation"]);t!==void 0&&l!=null&&v(t,["parameters","maskDilation"],l);const u=m(e,["binaryColorThreshold"]);t!==void 0&&u!=null&&v(t,["parameters","binaryColorThreshold"],u);const f=m(e,["labels"]);return t!==void 0&&f!=null&&v(t,["labels"],f),n}function cD(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["source"]);s!=null&&fD(s,n);const i=m(t,["config"]);return i!=null&&lD(i,n),n}function uD(e,t){const r={},n=m(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>DR(s))),v(r,["generatedMasks"],a)}return r}function fD(e,t,r){const n={},a=m(e,["prompt"]);t!==void 0&&a!=null&&v(t,["instances[0]","prompt"],a);const s=m(e,["image"]);t!==void 0&&s!=null&&v(t,["instances[0]","image"],pA(s));const i=m(e,["scribbleImage"]);return t!==void 0&&i!=null&&v(t,["instances[0]","scribble"],oD(i)),n}function dD(e,t){const r={},n=m(e,["retrievalConfig"]);n!=null&&v(r,["retrievalConfig"],n);const a=m(e,["functionCallingConfig"]);return a!=null&&v(r,["functionCallingConfig"],gR(a)),r}function hD(e,t){const r={};if(m(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=m(e,["computerUse"]);n!=null&&v(r,["computerUse"],n);const a=m(e,["fileSearch"]);a!=null&&v(r,["fileSearch"],a);const s=m(e,["googleSearch"]);s!=null&&v(r,["googleSearch"],VR(s));const i=m(e,["codeExecution"]);if(i!=null&&v(r,["codeExecution"],i),m(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(e,["functionDeclarations"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(y=>y)),v(r,["functionDeclarations"],x)}const u=m(e,["googleMaps"]);u!=null&&v(r,["googleMaps"],GR(u));const f=m(e,["googleSearchRetrieval"]);f!=null&&v(r,["googleSearchRetrieval"],f);const d=m(e,["urlContext"]);d!=null&&v(r,["urlContext"],d);const p=m(e,["mcpServers"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(y=>y)),v(r,["mcpServers"],x)}return r}function JT(e,t){const r={},n=m(e,["retrieval"]);n!=null&&v(r,["retrieval"],n);const a=m(e,["computerUse"]);if(a!=null&&v(r,["computerUse"],a),m(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(e,["googleSearch"]);s!=null&&v(r,["googleSearch"],s);const i=m(e,["codeExecution"]);i!=null&&v(r,["codeExecution"],i);const l=m(e,["enterpriseWebSearch"]);l!=null&&v(r,["enterpriseWebSearch"],l);const u=m(e,["functionDeclarations"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(y=>mR(y))),v(r,["functionDeclarations"],x)}const f=m(e,["googleMaps"]);f!=null&&v(r,["googleMaps"],f);const d=m(e,["googleSearchRetrieval"]);d!=null&&v(r,["googleSearchRetrieval"],d);const p=m(e,["urlContext"]);if(p!=null&&v(r,["urlContext"],p),m(e,["mcpServers"])!==void 0)throw new Error("mcpServers parameter is not supported in Vertex AI.");return r}function gD(e,t){const r={},n=m(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const a=m(e,["createTime"]);a!=null&&v(r,["createTime"],a);const s=m(e,["updateTime"]);return s!=null&&v(r,["updateTime"],s),r}function mD(e,t){const r={},n=m(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&v(r,["baseModel"],n);const a=m(e,["createTime"]);a!=null&&v(r,["createTime"],a);const s=m(e,["updateTime"]);return s!=null&&v(r,["updateTime"],s),r}function pD(e,t,r){const n={},a=m(e,["displayName"]);t!==void 0&&a!=null&&v(t,["displayName"],a);const s=m(e,["description"]);t!==void 0&&s!=null&&v(t,["description"],s);const i=m(e,["defaultCheckpointId"]);return t!==void 0&&i!=null&&v(t,["defaultCheckpointId"],i),n}function xD(e,t,r){const n={},a=m(e,["displayName"]);t!==void 0&&a!=null&&v(t,["displayName"],a);const s=m(e,["description"]);t!==void 0&&s!=null&&v(t,["description"],s);const i=m(e,["defaultCheckpointId"]);return t!==void 0&&i!=null&&v(t,["defaultCheckpointId"],i),n}function vD(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","name"],rr(e,a));const s=m(t,["config"]);return s!=null&&pD(s,n),n}function wD(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["config"]);return s!=null&&xD(s,n),n}function yD(e,t,r){const n={},a=m(e,["outputGcsUri"]);t!==void 0&&a!=null&&v(t,["parameters","storageUri"],a);const s=m(e,["safetyFilterLevel"]);t!==void 0&&s!=null&&v(t,["parameters","safetySetting"],s);const i=m(e,["personGeneration"]);t!==void 0&&i!=null&&v(t,["parameters","personGeneration"],i);const l=m(e,["includeRaiReason"]);t!==void 0&&l!=null&&v(t,["parameters","includeRaiReason"],l);const u=m(e,["outputMimeType"]);t!==void 0&&u!=null&&v(t,["parameters","outputOptions","mimeType"],u);const f=m(e,["outputCompressionQuality"]);t!==void 0&&f!=null&&v(t,["parameters","outputOptions","compressionQuality"],f);const d=m(e,["enhanceInputImage"]);t!==void 0&&d!=null&&v(t,["parameters","upscaleConfig","enhanceInputImage"],d);const p=m(e,["imagePreservationFactor"]);t!==void 0&&p!=null&&v(t,["parameters","upscaleConfig","imagePreservationFactor"],p);const x=m(e,["labels"]);t!==void 0&&x!=null&&v(t,["labels"],x);const y=m(e,["numberOfImages"]);t!==void 0&&y!=null&&v(t,["parameters","sampleCount"],y);const C=m(e,["mode"]);return t!==void 0&&C!=null&&v(t,["parameters","mode"],C),n}function BD(e,t,r){const n={},a=m(t,["model"]);a!=null&&v(n,["_url","model"],rr(e,a));const s=m(t,["image"]);s!=null&&v(n,["instances[0]","image"],pA(s));const i=m(t,["upscaleFactor"]);i!=null&&v(n,["parameters","upscaleConfig","upscaleFactor"],i);const l=m(t,["config"]);return l!=null&&yD(l,n),n}function CD(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["predictions"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>Nd(i))),v(r,["generatedImages"],s)}return r}function ED(e,t){const r={},n=m(e,["uri"]);n!=null&&v(r,["uri"],n);const a=m(e,["encodedVideo"]);a!=null&&v(r,["videoBytes"],oi(a));const s=m(e,["encoding"]);return s!=null&&v(r,["mimeType"],s),r}function TD(e,t){const r={},n=m(e,["gcsUri"]);n!=null&&v(r,["uri"],n);const a=m(e,["bytesBase64Encoded"]);a!=null&&v(r,["videoBytes"],oi(a));const s=m(e,["mimeType"]);return s!=null&&v(r,["mimeType"],s),r}function SD(e,t){const r={},n=m(e,["image"]);n!=null&&v(r,["_self"],pA(n));const a=m(e,["maskMode"]);return a!=null&&v(r,["maskMode"],a),r}function _D(e,t){const r={},n=m(e,["image"]);n!=null&&v(r,["image"],Id(n));const a=m(e,["referenceType"]);return a!=null&&v(r,["referenceType"],a),r}function bD(e,t){const r={},n=m(e,["image"]);n!=null&&v(r,["image"],pA(n));const a=m(e,["referenceType"]);return a!=null&&v(r,["referenceType"],a),r}function YT(e,t){const r={},n=m(e,["uri"]);n!=null&&v(r,["uri"],n);const a=m(e,["videoBytes"]);a!=null&&v(r,["encodedVideo"],oi(a));const s=m(e,["mimeType"]);return s!=null&&v(r,["encoding"],s),r}function qT(e,t){const r={},n=m(e,["uri"]);n!=null&&v(r,["gcsUri"],n);const a=m(e,["videoBytes"]);a!=null&&v(r,["bytesBase64Encoded"],oi(a));const s=m(e,["mimeType"]);return s!=null&&v(r,["mimeType"],s),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FD(e,t){const r={},n=m(e,["displayName"]);return t!==void 0&&n!=null&&v(t,["displayName"],n),r}function UD(e){const t={},r=m(e,["config"]);return r!=null&&FD(r,t),t}function kD(e,t){const r={},n=m(e,["force"]);return t!==void 0&&n!=null&&v(t,["_query","force"],n),r}function ND(e){const t={},r=m(e,["name"]);r!=null&&v(t,["_url","name"],r);const n=m(e,["config"]);return n!=null&&kD(n,t),t}function ID(e){const t={},r=m(e,["name"]);return r!=null&&v(t,["_url","name"],r),t}function QD(e,t){const r={},n=m(e,["customMetadata"]);if(t!==void 0&&n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["customMetadata"],s)}const a=m(e,["chunkingConfig"]);return t!==void 0&&a!=null&&v(t,["chunkingConfig"],a),r}function RD(e){const t={},r=m(e,["name"]);r!=null&&v(t,["name"],r);const n=m(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=m(e,["done"]);a!=null&&v(t,["done"],a);const s=m(e,["error"]);s!=null&&v(t,["error"],s);const i=m(e,["response"]);return i!=null&&v(t,["response"],MD(i)),t}function DD(e){const t={},r=m(e,["fileSearchStoreName"]);r!=null&&v(t,["_url","file_search_store_name"],r);const n=m(e,["fileName"]);n!=null&&v(t,["fileName"],n);const a=m(e,["config"]);return a!=null&&QD(a,t),t}function MD(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["parent"]);n!=null&&v(t,["parent"],n);const a=m(e,["documentName"]);return a!=null&&v(t,["documentName"],a),t}function LD(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function HD(e){const t={},r=m(e,["config"]);return r!=null&&LD(r,t),t}function OD(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["fileSearchStores"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["fileSearchStores"],s)}return t}function $T(e,t){const r={},n=m(e,["mimeType"]);t!==void 0&&n!=null&&v(t,["mimeType"],n);const a=m(e,["displayName"]);t!==void 0&&a!=null&&v(t,["displayName"],a);const s=m(e,["customMetadata"]);if(t!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>u)),v(t,["customMetadata"],l)}const i=m(e,["chunkingConfig"]);return t!==void 0&&i!=null&&v(t,["chunkingConfig"],i),r}function PD(e){const t={},r=m(e,["fileSearchStoreName"]);r!=null&&v(t,["_url","file_search_store_name"],r);const n=m(e,["config"]);return n!=null&&$T(n,t),t}function GD(e){const t={},r=m(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VD="Content-Type",KD="X-Server-Timeout",jD="User-Agent",fp="x-goog-api-client",zD="1.43.0",XD=`google-genai-sdk/${zD}`,WD="v1beta1",JD="v1beta",YD=5,qD=[408,429,500,502,503,504];class $D{constructor(t){var r,n,a;this.clientOptions=Object.assign({},t),this.customBaseUrl=(r=t.httpOptions)===null||r===void 0?void 0:r.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const s={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const l=t.project&&t.location||!!t.apiKey;this.customBaseUrl&&!l?(s.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?s.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(s.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:WD}else{if(!this.clientOptions.apiKey)throw new iu({message:"API key must be set when using the Gemini API.",status:403});s.apiVersion=(a=this.clientOptions.apiVersion)!==null&&a!==void 0?a:JD,s.baseUrl="https://generativelanguage.googleapis.com/"}s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),r=new URL(t);return r.protocol=r.protocol=="http:"?"ws":"wss",r.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,r,n){const a=[this.getRequestUrlInternal(r)];return n&&a.push(this.getBaseResourcePath()),t!==""&&a.push(t),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(t,r){return!(r.baseUrl&&r.baseUrlResourceScope===sp.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t,r),a=this.constructUrl(t.path,r,n);if(t.queryParams)for(const[i,l]of Object.entries(t.queryParams))a.searchParams.append(i,String(l));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,r,a.toString(),t.abortSignal),this.unaryApiCall(a,s,t.httpMethod)}patchHttpOptions(t,r){const n=JSON.parse(JSON.stringify(t));for(const[a,s]of Object.entries(r))typeof s=="object"?n[a]=Object.assign(Object.assign({},n[a]),s):s!==void 0&&(n[a]=s);return n}async requestStream(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t,r),a=this.constructUrl(t.path,r,n);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,r,a.toString(),t.abortSignal),this.streamApiCall(a,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,r,n,a){if(r&&r.timeout||a){const s=new AbortController,i=s.signal;if(r.timeout&&(r==null?void 0:r.timeout)>0){const l=setTimeout(()=>s.abort(),r.timeout);l&&typeof l.unref=="function"&&l.unref()}a&&a.addEventListener("abort",()=>{s.abort()}),t.signal=i}return r&&r.extraBody!==null&&ZD(t,r.extraBody),t.headers=await this.getHeadersInternal(r,n),t}async unaryApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async a=>(await IC(a),new ip(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async a=>(await IC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(t){return dA(this,arguments,function*(){var n;const a=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let i="";const l="data:",u=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:d}=yield St(a.read());if(f){if(i.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=s.decode(d,{stream:!0});try{const C=JSON.parse(p);if("error"in C){const E=JSON.parse(JSON.stringify(C.error)),T=E.status,S=E.code,F=`got status: ${T}. ${JSON.stringify(C)}`;if(S>=400&&S<600)throw new iu({message:F,status:S})}}catch(C){if(C.name==="ApiError")throw C}i+=p;let x=-1,y=0;for(;;){x=-1,y=0;for(const T of u){const S=i.indexOf(T);S!==-1&&(x===-1||S<x)&&(x=S,y=T.length)}if(x===-1)break;const C=i.substring(0,x);i=i.substring(x+y);const E=C.trim();if(E.startsWith(l)){const T=E.substring(l.length).trim();try{const S=new Response(T,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield St(new ip(S))}catch(S){throw new Error(`exception parsing stream chunk ${T}. ${S}`)}}}}}finally{a.releaseLock()}})}async apiCall(t,r){var n;if(!this.clientOptions.httpOptions||!this.clientOptions.httpOptions.retryOptions)return fetch(t,r);const a=this.clientOptions.httpOptions.retryOptions;return PN(async()=>{const i=await fetch(t,r);if(i.ok)return i;throw qD.includes(i.status)?new Error(`Retryable HTTP Error: ${i.statusText}`):new UT.AbortError(`Non-retryable exception ${i.statusText} sending request`)},{retries:((n=a.attempts)!==null&&n!==void 0?n:YD)-1})}getDefaultHeaders(){const t={},r=XD+" "+this.clientOptions.userAgentExtra;return t[jD]=r,t[fp]=r,t[VD]="application/json",t}async getHeadersInternal(t,r){const n=new Headers;if(t&&t.headers){for(const[a,s]of Object.entries(t.headers))n.append(a,s);t.timeout&&t.timeout>0&&n.append(KD,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,r),n}getFileName(t){var r;let n="";return typeof t=="string"&&(n=t.replace(/[/\\]+$/,""),n=(r=n.split(/[/\\]/).pop())!==null&&r!==void 0?r:""),n}async uploadFile(t,r){var n;const a={};r!=null&&(a.mimeType=r.mimeType,a.name=r.name,a.displayName=r.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,i=await s.stat(t);a.sizeBytes=String(i.size);const l=(n=r==null?void 0:r.mimeType)!==null&&n!==void 0?n:i.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=l;const u={file:a},f=this.getFileName(t),d=qe("upload/v1beta/files",u._url),p=await this.fetchUploadUrl(d,a.sizeBytes,a.mimeType,f,u,r==null?void 0:r.httpOptions);return s.upload(t,p,this)}async uploadFileToFileSearchStore(t,r,n){var a;const s=this.clientOptions.uploader,i=await s.stat(r),l=String(i.size),u=(a=n==null?void 0:n.mimeType)!==null&&a!==void 0?a:i.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${t}:uploadToFileSearchStore`,d=this.getFileName(r),p={};n!=null&&$T(n,p);const x=await this.fetchUploadUrl(f,l,u,d,p,n==null?void 0:n.httpOptions);return s.uploadToFileSearchStore(r,x,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,r,n,a,s,i){var l;let u={};i?u=i:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r}`,"X-Goog-Upload-Header-Content-Type":`${n}`},a?{"X-Goog-Upload-File-Name":a}:{})};const f=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:u});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(l=f==null?void 0:f.headers)===null||l===void 0?void 0:l["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function IC(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const r=e.status;let n;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?n=await e.json():n={error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(n);throw r>=400&&r<600?new iu({message:a,status:r}):new Error(a)}}function ZD(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let r={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))r=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(s,i){const l=Object.assign({},s);for(const u in i)if(Object.prototype.hasOwnProperty.call(i,u)){const f=i[u],d=l[u];f&&typeof f=="object"&&!Array.isArray(f)&&d&&typeof d=="object"&&!Array.isArray(d)?l[u]=n(d,f):(d&&f&&typeof d!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof d}, New type: ${typeof f}. Overwriting.`),l[u]=f)}return l}const a=n(r,t);e.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eM="mcp_used/unknown";let tM=!1;function ZT(e){for(const t of e)if(rM(t)||typeof t=="object"&&"inputSchema"in t)return!0;return tM}function eS(e){var t;const r=(t=e[fp])!==null&&t!==void 0?t:"";e[fp]=(r+` ${eM}`).trimStart()}function rM(e){return e!==null&&typeof e=="object"&&e instanceof vx}function nM(e){return dA(this,arguments,function*(r,n=100){let a,s=0;for(;s<n;){const i=yield St(r.listTools({cursor:a}));for(const l of i.tools)yield yield St(l),s++;if(!i.nextCursor)break;a=i.nextCursor}})}class vx{constructor(t=[],r){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=r}static create(t,r){return new vx(t,r)}async initialize(){var t,r,n,a;if(this.mcpTools.length>0)return;const s={},i=[];for(const d of this.mcpClients)try{for(var l=!0,u=(r=void 0,hA(nM(d))),f;f=await u.next(),t=f.done,!t;l=!0){a=f.value,l=!1;const p=a;i.push(p);const x=p.name;if(s[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);s[x]=d}}catch(p){r={error:p}}finally{try{!l&&!t&&(n=u.return)&&await n.call(u)}finally{if(r)throw r.error}}this.mcpTools=i,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),FI(this.mcpTools,this.config)}async callTool(t){await this.initialize();const r=[];for(const n of t)if(n.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const i=await a.callTool({name:n.name,arguments:n.args},void 0,s);r.push({functionResponse:{name:n.name,response:i.isError?{error:i}:i}})}return r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aM(e,t,r){const n=new yI;let a;r.data instanceof Blob?a=JSON.parse(await r.data.text()):a=JSON.parse(r.data),Object.assign(n,a),t(n)}class AM{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n}async connect(t){var r,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),i=oM(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),u=`${a}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${l}`;let f=()=>{};const d=new Promise(_=>{f=_}),p=t.callbacks,x=function(){f({})},y=this.apiClient,C={onopen:x,onmessage:_=>{aM(y,p.onmessage,_)},onerror:(r=p==null?void 0:p.onerror)!==null&&r!==void 0?r:function(_){},onclose:(n=p==null?void 0:p.onclose)!==null&&n!==void 0?n:function(_){}},E=this.webSocketFactory.create(u,iM(i),C);E.connect(),await d;const F={setup:{model:rr(this.apiClient,t.model)}};return E.send(JSON.stringify(F)),new sM(E,this.apiClient)}}class sM{constructor(t,r){this.conn=t,this.apiClient=r}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const r=FQ(t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const r=bQ(t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const r={playbackControl:t};this.conn.send(JSON.stringify(r))}play(){this.sendPlaybackControl(ol.PLAY)}pause(){this.sendPlaybackControl(ol.PAUSE)}stop(){this.sendPlaybackControl(ol.STOP)}resetContext(){this.sendPlaybackControl(ol.RESET_CONTEXT)}close(){this.conn.close()}}function iM(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function oM(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function cM(e,t,r){const n=new wI;let a;r.data instanceof Blob?a=await r.data.text():r.data instanceof ArrayBuffer?a=new TextDecoder().decode(r.data):a=r.data;const s=JSON.parse(a);if(e.isVertexAI()){const i=NQ(s);Object.assign(n,i)}else Object.assign(n,s);t(n)}class uM{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n,this.music=new AM(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var r,n,a,s,i,l;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let d;const p=this.apiClient.getHeaders();t.config&&t.config.tools&&ZT(t.config.tools)&&eS(p);const x=gM(p);if(this.apiClient.isVertexAI()){const M=this.apiClient.getProject(),ee=this.apiClient.getLocation(),re=this.apiClient.getApiKey(),q=!!M&&!!ee||!!re;this.apiClient.getCustomBaseUrl()&&!q?d=u:(d=`${u}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x,d))}else{const M=this.apiClient.getApiKey();let ee="BidiGenerateContent",re="key";M!=null&&M.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),ee="BidiGenerateContentConstrained",re="access_token"),d=`${u}/ws/google.ai.generativelanguage.${f}.GenerativeService.${ee}?${re}=${M}`}let y=()=>{};const C=new Promise(M=>{y=M}),E=t.callbacks,T=function(){var M;(M=E==null?void 0:E.onopen)===null||M===void 0||M.call(E),y({})},S=this.apiClient,F={onopen:T,onmessage:M=>{cM(S,E.onmessage,M)},onerror:(r=E==null?void 0:E.onerror)!==null&&r!==void 0?r:function(M){},onclose:(n=E==null?void 0:E.onclose)!==null&&n!==void 0?n:function(M){}},_=this.webSocketFactory.create(d,hM(x),F);_.connect(),await C;let N=rr(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&N.startsWith("publishers/")){const M=this.apiClient.getProject(),ee=this.apiClient.getLocation();M&&ee&&(N=`projects/${M}/locations/${ee}/`+N)}let I={};this.apiClient.isVertexAI()&&((a=t.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[$f.AUDIO]}:t.config.responseModalities=[$f.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const U=(l=(i=t.config)===null||i===void 0?void 0:i.tools)!==null&&l!==void 0?l:[],k=[];for(const M of U)if(this.isCallableTool(M)){const ee=M;k.push(await ee.tool())}else k.push(M);k.length>0&&(t.config.tools=k);const G={model:N,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?I=_Q(this.apiClient,G):I=SQ(this.apiClient,G),delete I.config,_.send(JSON.stringify(I)),new dM(_,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const fM={turnComplete:!0};class dM{constructor(t,r){this.conn=t,this.apiClient=r}tLiveClientContent(t,r){if(r.turns!==null&&r.turns!==void 0){let n=[];try{n=ba(r.turns),t.isVertexAI()||(n=n.map(a=>bu(a)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof r.turns}'`)}return{clientContent:{turns:n,turnComplete:r.turnComplete}}}return{clientContent:{turnComplete:r.turnComplete}}}tLiveClienttToolResponse(t,r){let n=[];if(r.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(r.functionResponses)?n=r.functionResponses:n=[r.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(lM)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},fM),t);const r=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendRealtimeInput(t){let r={};this.apiClient.isVertexAI()?r={realtimeInput:kQ(t)}:r={realtimeInput:UQ(t)},this.conn.send(JSON.stringify(r))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const r=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(r))}close(){this.conn.close()}}function hM(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function gM(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const QC=10;function RC(e){var t,r,n;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let a=!1;for(const i of(r=e==null?void 0:e.tools)!==null&&r!==void 0?r:[])if(dl(i)){a=!0;break}if(!a)return!0;const s=(n=e==null?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function dl(e){return"callTool"in e&&typeof e.callTool=="function"}function mM(e){var t,r,n;return(n=(r=(t=e.config)===null||t===void 0?void 0:t.tools)===null||r===void 0?void 0:r.some(a=>dl(a)))!==null&&n!==void 0?n:!1}function DC(e){var t;const r=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((n,a)=>{if(dl(n))return;const s=n;s.functionDeclarations&&s.functionDeclarations.length>0&&r.push(a)}),r}function MC(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pM extends hs{constructor(t){super(),this.apiClient=t,this.embedContent=async r=>{if(!this.apiClient.isVertexAI())return await this.embedContentInternal(r);if(r.model.includes("gemini")&&r.model!=="gemini-embedding-001"||r.model.includes("maas")){const a=ba(r.contents);if(a.length>1)throw new Error("The embedContent API for this model only supports one content at a time.");const s=Object.assign(Object.assign({},r),{content:a[0],embeddingApiType:Zf.EMBED_CONTENT});return await this.embedContentInternal(s)}else{const a=Object.assign(Object.assign({},r),{embeddingApiType:Zf.PREDICT});return await this.embedContentInternal(a)}},this.generateContent=async r=>{var n,a,s,i,l;const u=await this.processParamsMaybeAddMcpUsage(r);if(this.maybeMoveToResponseJsonSchem(r),!mM(r)||RC(r.config))return await this.generateContentInternal(u);const f=DC(r);if(f.length>0){const E=f.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let d,p;const x=ba(u.contents),y=(s=(a=(n=u.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&s!==void 0?s:QC;let C=0;for(;C<y&&(d=await this.generateContentInternal(u),!(!d.functionCalls||d.functionCalls.length===0));){const E=d.candidates[0].content,T=[];for(const S of(l=(i=r.config)===null||i===void 0?void 0:i.tools)!==null&&l!==void 0?l:[])if(dl(S)){const _=await S.callTool(d.functionCalls);T.push(..._)}C++,p={role:"user",parts:T},u.contents=ba(u.contents),u.contents.push(E),u.contents.push(p),MC(u.config)&&(x.push(E),x.push(p))}return MC(u.config)&&(d.automaticFunctionCallingHistory=x),d},this.generateContentStream=async r=>{var n,a,s,i,l;if(this.maybeMoveToResponseJsonSchem(r),RC(r.config)){const p=await this.processParamsMaybeAddMcpUsage(r);return await this.generateContentStreamInternal(p)}const u=DC(r);if(u.length>0){const p=u.map(x=>`tools[${x}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(s=(a=(n=r==null?void 0:r.config)===null||n===void 0?void 0:n.toolConfig)===null||a===void 0?void 0:a.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,d=(l=(i=r==null?void 0:r.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||l===void 0?void 0:l.disable;if(f&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(r)},this.generateImages=async r=>await this.generateImagesInternal(r).then(n=>{var a;let s;const i=[];if(n!=null&&n.generatedImages)for(const u of n.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((a=u==null?void 0:u.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?s=u==null?void 0:u.safetyAttributes:i.push(u);let l;return s?l={generatedImages:i,positivePromptSafetyAttributes:s,sdkHttpResponse:n.sdkHttpResponse}:l={generatedImages:i,sdkHttpResponse:n.sdkHttpResponse},l}),this.list=async r=>{var n;const i={config:Object.assign(Object.assign({},{queryBase:!0}),r==null?void 0:r.config)};if(this.apiClient.isVertexAI()&&!i.config.queryBase){if(!((n=i.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");i.config.filter="labels.tune-type:*"}return new ao(us.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(i),i)},this.editImage=async r=>{const n={model:r.model,prompt:r.prompt,referenceImages:[],config:r.config};return r.referenceImages&&r.referenceImages&&(n.referenceImages=r.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async r=>{let n={numberOfImages:1,mode:"upscale"};r.config&&(n=Object.assign(Object.assign({},n),r.config));const a={model:r.model,image:r.image,upscaleFactor:r.upscaleFactor,config:n};return await this.upscaleImageInternal(a)},this.generateVideos=async r=>{var n,a,s,i,l,u;if((r.prompt||r.image||r.video)&&r.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=r.video)===null||n===void 0)&&n.uri&&(!((a=r.video)===null||a===void 0)&&a.videoBytes)?r.video={uri:r.video.uri,mimeType:r.video.mimeType}:!((i=(s=r.source)===null||s===void 0?void 0:s.video)===null||i===void 0)&&i.uri&&(!((u=(l=r.source)===null||l===void 0?void 0:l.video)===null||u===void 0)&&u.videoBytes)&&(r.source.video={uri:r.source.video.uri,mimeType:r.source.video.mimeType})),await this.generateVideosInternal(r)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var r,n,a;const s=(r=t.config)===null||r===void 0?void 0:r.tools;if(!s)return t;const i=await Promise.all(s.map(async u=>dl(u)?await u.tool():u)),l={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:i})};if(l.config.tools=i,t.config&&t.config.tools&&ZT(t.config.tools)){const u=(a=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},u);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),eS(f),l.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:f})}return l}async initAfcToolsMap(t){var r,n,a;const s=new Map;for(const i of(n=(r=t.config)===null||r===void 0?void 0:r.tools)!==null&&n!==void 0?n:[])if(dl(i)){const l=i,u=await l.tool();for(const f of(a=u.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(s.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);s.set(f.name,l)}}return s}async processAfcStream(t){var r,n,a;const s=(a=(n=(r=t.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&a!==void 0?a:QC;let i=!1,l=0;const u=await this.initAfcToolsMap(t);return(function(f,d,p){return dA(this,arguments,function*(){for(var x,y,C,E,T,S;l<s;){i&&(l++,i=!1);const I=yield St(f.processParamsMaybeAddMcpUsage(p)),U=yield St(f.generateContentStreamInternal(I)),k=[],G=[];try{for(var F=!0,_=(y=void 0,hA(U)),N;N=yield St(_.next()),x=N.done,!x;F=!0){E=N.value,F=!1;const M=E;if(yield yield St(M),M.candidates&&(!((T=M.candidates[0])===null||T===void 0)&&T.content)){G.push(M.candidates[0].content);for(const ee of(S=M.candidates[0].content.parts)!==null&&S!==void 0?S:[])if(l<s&&ee.functionCall){if(!ee.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(ee.functionCall.name)){const re=yield St(d.get(ee.functionCall.name).callTool([ee.functionCall]));k.push(...re)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${ee.functionCall.name}`)}}}}catch(M){y={error:M}}finally{try{!F&&!x&&(C=_.return)&&(yield St(C.call(_)))}finally{if(y)throw y.error}}if(k.length>0){i=!0;const M=new Ec;M.candidates=[{content:{role:"user",parts:k}}],yield yield St(M);const ee=[];ee.push(...G),ee.push({role:"user",parts:k});const re=ba(p.contents).concat(ee);p.contents=re}else break}})})(this,u,t)}async generateContentInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=UC(this.apiClient,t);return l=qe("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=NC(d),x=new Ec;return Object.assign(x,p),x})}else{const f=FC(this.apiClient,t);return l=qe("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=kC(d),x=new Ec;return Object.assign(x,p),x})}}async generateContentStreamInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=UC(this.apiClient,t);return l=qe("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.requestStream({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),i.then(function(p){return dA(this,arguments,function*(){var x,y,C,E;try{for(var T=!0,S=hA(p),F;F=yield St(S.next()),x=F.done,!x;T=!0){E=F.value,T=!1;const _=E,N=NC(yield St(_.json()),t);N.sdkHttpResponse={headers:_.headers};const I=new Ec;Object.assign(I,N),yield yield St(I)}}catch(_){y={error:_}}finally{try{!T&&!x&&(C=S.return)&&(yield St(C.call(S)))}finally{if(y)throw y.error}}})})}else{const f=FC(this.apiClient,t);return l=qe("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.requestStream({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),i.then(function(p){return dA(this,arguments,function*(){var x,y,C,E;try{for(var T=!0,S=hA(p),F;F=yield St(S.next()),x=F.done,!x;T=!0){E=F.value,T=!1;const _=E,N=kC(yield St(_.json()),t);N.sdkHttpResponse={headers:_.headers};const I=new Ec;Object.assign(I,N),yield yield St(I)}}catch(_){y={error:_}}finally{try{!T&&!x&&(C=S.return)&&(yield St(C.call(S)))}finally{if(y)throw y.error}}})})}}async embedContentInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=lR(this.apiClient,t,t),d=kI(t.model)?"{model}:embedContent":"{model}:predict";return l=qe(d,f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(x=>{const y=x;return y.sdkHttpResponse={headers:p.headers},y})),i.then(p=>{const x=uR(p,t),y=new fC;return Object.assign(y,x),y})}else{const f=oR(this.apiClient,t);return l=qe("{model}:batchEmbedContents",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=cR(d),x=new fC;return Object.assign(x,p),x})}}async generateImagesInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=BR(this.apiClient,t);return l=qe("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=ER(d),x=new dC;return Object.assign(x,p),x})}else{const f=yR(this.apiClient,t);return l=qe("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=CR(d),x=new dC;return Object.assign(x,p),x})}}async editImageInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=aR(this.apiClient,t);return s=qe("{model}:predict",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=AR(u),d=new oI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=BD(this.apiClient,t);return s=qe("{model}:predict",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=CD(u),d=new lI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=nD(this.apiClient,t);return s=qe("{model}:predict",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=aD(u),d=new cI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=cD(this.apiClient,t);return s=qe("{model}:predict",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=uD(u),d=new uI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=PR(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>up(d))}else{const f=OR(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>cp(d))}}async listInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=YR(this.apiClient,t);return l=qe("{models_url}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=$R(d),x=new hC;return Object.assign(x,p),x})}else{const f=JR(this.apiClient,t);return l=qe("{models_url}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=qR(d),x=new hC;return Object.assign(x,p),x})}}async update(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=wD(this.apiClient,t);return l=qe("{model}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>up(d))}else{const f=vD(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>cp(d))}}async delete(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=eR(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=rR(d),x=new gC;return Object.assign(x,p),x})}else{const f=ZQ(this.apiClient,t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=tR(d),x=new gC;return Object.assign(x,p),x})}}async countTokens(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=YQ(this.apiClient,t);return l=qe("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=$Q(d),x=new mC;return Object.assign(x,p),x})}else{const f=JQ(this.apiClient,t);return l=qe("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=qQ(d),x=new mC;return Object.assign(x,p),x})}}async computeTokens(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=GQ(this.apiClient,t);return s=qe("{model}:computeTokens",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=VQ(u),d=new fI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=UR(this.apiClient,t);return l=qe("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const p=bR(d),x=new ed;return Object.assign(x,p),x})}else{const f=FR(this.apiClient,t);return l=qe("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>{const p=_R(d),x=new ed;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xM extends hs{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:a,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:a,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=rI(t);return l=qe("{operationName}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i}else{const f=tI(t);return l=qe("{operationName}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i}}async fetchPredictVideosOperationInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=WN(t);return s=qe("{resourceName}:fetchPredictOperation",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vM(e){const t={},r=m(e,["data"]);if(r!=null&&v(t,["data"],r),m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function wM(e){const t={},r=m(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>FM(s))),v(t,["parts"],a)}const n=m(e,["role"]);return n!=null&&v(t,["role"],n),t}function yM(e,t,r){const n={},a=m(t,["expireTime"]);r!==void 0&&a!=null&&v(r,["expireTime"],a);const s=m(t,["newSessionExpireTime"]);r!==void 0&&s!=null&&v(r,["newSessionExpireTime"],s);const i=m(t,["uses"]);r!==void 0&&i!=null&&v(r,["uses"],i);const l=m(t,["liveConnectConstraints"]);r!==void 0&&l!=null&&v(r,["bidiGenerateContentSetup"],bM(e,l));const u=m(t,["lockAdditionalFields"]);return r!==void 0&&u!=null&&v(r,["fieldMask"],u),n}function BM(e,t){const r={},n=m(t,["config"]);return n!=null&&v(r,["config"],yM(e,n,r)),r}function CM(e){const t={};if(m(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=m(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=m(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function EM(e){const t={},r=m(e,["id"]);r!=null&&v(t,["id"],r);const n=m(e,["args"]);n!=null&&v(t,["args"],n);const a=m(e,["name"]);if(a!=null&&v(t,["name"],a),m(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function TM(e){const t={};if(m(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=m(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function SM(e){const t={},r=m(e,["searchTypes"]);if(r!=null&&v(t,["searchTypes"],r),m(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=m(e,["timeRangeFilter"]);return n!=null&&v(t,["timeRangeFilter"],n),t}function _M(e,t){const r={},n=m(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],n);const a=m(e,["responseModalities"]);t!==void 0&&a!=null&&v(t,["setup","generationConfig","responseModalities"],a);const s=m(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const i=m(e,["topP"]);t!==void 0&&i!=null&&v(t,["setup","generationConfig","topP"],i);const l=m(e,["topK"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topK"],l);const u=m(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=m(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=m(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const p=m(e,["speechConfig"]);t!==void 0&&p!=null&&v(t,["setup","generationConfig","speechConfig"],xx(p));const x=m(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=m(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const C=m(e,["systemInstruction"]);t!==void 0&&C!=null&&v(t,["setup","systemInstruction"],wM(Cn(C)));const E=m(e,["tools"]);if(t!==void 0&&E!=null){let U=Sl(E);Array.isArray(U)&&(U=U.map(k=>kM(Tl(k)))),v(t,["setup","tools"],U)}const T=m(e,["sessionResumption"]);t!==void 0&&T!=null&&v(t,["setup","sessionResumption"],UM(T));const S=m(e,["inputAudioTranscription"]);t!==void 0&&S!=null&&v(t,["setup","inputAudioTranscription"],S);const F=m(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const _=m(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&v(t,["setup","realtimeInputConfig"],_);const N=m(e,["contextWindowCompression"]);t!==void 0&&N!=null&&v(t,["setup","contextWindowCompression"],N);const I=m(e,["proactivity"]);if(t!==void 0&&I!=null&&v(t,["setup","proactivity"],I),m(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return r}function bM(e,t){const r={},n=m(t,["model"]);n!=null&&v(r,["setup","model"],rr(e,n));const a=m(t,["config"]);return a!=null&&v(r,["config"],_M(a,r)),r}function FM(e){const t={},r=m(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=m(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=m(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=m(e,["fileData"]);s!=null&&v(t,["fileData"],CM(s));const i=m(e,["functionCall"]);i!=null&&v(t,["functionCall"],EM(i));const l=m(e,["functionResponse"]);l!=null&&v(t,["functionResponse"],l);const u=m(e,["inlineData"]);u!=null&&v(t,["inlineData"],vM(u));const f=m(e,["text"]);f!=null&&v(t,["text"],f);const d=m(e,["thought"]);d!=null&&v(t,["thought"],d);const p=m(e,["thoughtSignature"]);p!=null&&v(t,["thoughtSignature"],p);const x=m(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function UM(e){const t={},r=m(e,["handle"]);if(r!=null&&v(t,["handle"],r),m(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function kM(e){const t={};if(m(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=m(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=m(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=m(e,["googleSearch"]);a!=null&&v(t,["googleSearch"],SM(a));const s=m(e,["codeExecution"]);if(s!=null&&v(t,["codeExecution"],s),m(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const i=m(e,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["functionDeclarations"],p)}const l=m(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],TM(l));const u=m(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=m(e,["urlContext"]);f!=null&&v(t,["urlContext"],f);const d=m(e,["mcpServers"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>x)),v(t,["mcpServers"],p)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NM(e){const t=[];for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=e[r];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const a=Object.keys(n).map(s=>`${r}.${s}`);t.push(...a)}else t.push(r)}return t.join(",")}function IM(e,t){let r=null;const n=e.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const s=n.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,r=s):delete e.bidiGenerateContentSetup}else n!==void 0&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(r){const s=NM(r);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const i=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let l=[];a.length>0&&(l=a.map(f=>i.includes(f)?`generationConfig.${f}`:f));const u=[];s&&u.push(s),l.length>0&&u.push(...l),u.length>0?e.fieldMask=u.join(","):delete e.fieldMask}else delete e.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class QM extends hs{constructor(t){super(),this.apiClient=t}async create(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const l=BM(this.apiClient,t);s=qe("auth_tokens",l._url),i=l._query,delete l.config,delete l._url,delete l._query;const u=IM(l,t.config);return a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RM(e,t){const r={},n=m(e,["force"]);return t!==void 0&&n!=null&&v(t,["_query","force"],n),r}function DM(e){const t={},r=m(e,["name"]);r!=null&&v(t,["_url","name"],r);const n=m(e,["config"]);return n!=null&&RM(n,t),t}function MM(e){const t={},r=m(e,["name"]);return r!=null&&v(t,["_url","name"],r),t}function LM(e,t){const r={},n=m(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=m(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function HM(e){const t={},r=m(e,["parent"]);r!=null&&v(t,["_url","parent"],r);const n=m(e,["config"]);return n!=null&&LM(n,t),t}function OM(e){const t={},r=m(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=m(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=m(e,["documents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(i=>i)),v(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PM extends hs{constructor(t){super(),this.apiClient=t,this.list=async r=>new ao(us.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:r.parent,config:n.config}),await this.listInternal(r),r)}async get(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=MM(t);return s=qe("{name}",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n;let a="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=DM(t);a=qe("{name}",i._url),s=i._query,delete i._url,delete i._query,await this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=HM(t);return s=qe("{parent}/documents",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=OM(u),d=new dI;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GM extends hs{constructor(t,r=new PM(t)){super(),this.apiClient=t,this.documents=r,this.list=async(n={})=>new ao(us.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(n),n)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=UD(t);return s=qe("fileSearchStores",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async get(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ID(t);return s=qe("{name}",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n;let a="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=ND(t);a=qe("{name}",i._url),s=i._query,delete i._url,delete i._query,await this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=HD(t);return s=qe("fileSearchStores",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=OD(u),d=new hI;return Object.assign(d,f),d})}}async uploadToFileSearchStoreInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=PD(t);return s=qe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=GD(u),d=new gI;return Object.assign(d,f),d})}}async importFile(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=DD(t);return s=qe("{file_search_store_name}:importFile",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=RD(u),d=new dx;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let tS=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return tS=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),r=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^r()&15>>+n/4).toString(16))};const VM=()=>tS();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dp(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const hp=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eA extends Error{}class ra extends eA{constructor(t,r,n,a){super(`${ra.makeMessage(t,r,n)}`),this.status=t,this.headers=a,this.error=r}static makeMessage(t,r,n){const a=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,r,n,a){if(!t||!a)return new Qd({message:n,cause:hp(r)});const s=r;return t===400?new nS(t,s,n,a):t===401?new aS(t,s,n,a):t===403?new AS(t,s,n,a):t===404?new sS(t,s,n,a):t===409?new iS(t,s,n,a):t===422?new oS(t,s,n,a):t===429?new lS(t,s,n,a):t>=500?new cS(t,s,n,a):new ra(t,s,n,a)}}class gp extends ra{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Qd extends ra{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class rS extends Qd{constructor({message:t}={}){super({message:t??"Request timed out."})}}class nS extends ra{}class aS extends ra{}class AS extends ra{}class sS extends ra{}class iS extends ra{}class oS extends ra{}class lS extends ra{}class cS extends ra{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KM=/^[a-z][a-z0-9+.-]*:/i,jM=e=>KM.test(e);let mp=e=>(mp=Array.isArray,mp(e));const zM=mp;let XM=zM;const LC=XM;function WM(e){if(!e)return!0;for(const t in e)return!1;return!0}function JM(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const YM=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new eA(`${e} must be an integer`);if(t<0)throw new eA(`${e} must be a positive integer`);return t},qM=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $M=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const al="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZM(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const eL=()=>{var e,t,r,n,a;const s=ZM();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":OC(Deno.build.os),"X-Stainless-Arch":HC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":OC((r=globalThis.process.platform)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Arch":HC((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(a=globalThis.process.version)!==null&&a!==void 0?a:"unknown"};const i=tL();return i?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${i.browser}`,"X-Stainless-Runtime-Version":i.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function tL(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const n=r.exec(navigator.userAgent);if(n){const a=n[1]||0,s=n[2]||0,i=n[3]||0;return{browser:t,version:`${a}.${s}.${i}`}}}return null}const HC=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",OC=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Y0;const rL=()=>Y0??(Y0=eL());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nL(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function uS(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function aL(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return uS({start(){},async pull(r){const{done:n,value:a}=await t.next();n?r.close():r.enqueue(a)},async cancel(){var r;await((r=t.return)===null||r===void 0?void 0:r.call(t))}})}function fS(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function AL(e){var t,r;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((r=(t=e[Symbol.asyncIterator]()).return)===null||r===void 0?void 0:r.call(t));return}const n=e.getReader(),a=n.cancel();n.releaseLock(),await a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sL=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dS=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,r=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(r?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function fm(e,t,r){return dS(),new File(e,t??"unknown_file",r)}function iL(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const oL=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hS=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",lL=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&hS(e),cL=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function uL(e,t,r){if(dS(),e=await e,lL(e))return e instanceof File?e:fm([await e.arrayBuffer()],e.name);if(cL(e)){const a=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),fm(await pp(a),t,r)}const n=await pp(e);if(t||(t=iL(e)),!(r!=null&&r.type)){const a=n.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof a=="string"&&(r=Object.assign(Object.assign({},r),{type:a}))}return fm(n,t,r)}async function pp(e){var t,r,n,a,s;let i=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)i.push(e);else if(hS(e))i.push(e instanceof Blob?e:await e.arrayBuffer());else if(oL(e))try{for(var l=!0,u=hA(e),f;f=await u.next(),t=f.done,!t;l=!0){a=f.value,l=!1;const d=a;i.push(...await pp(d))}}catch(d){r={error:d}}finally{try{!l&&!t&&(n=u.return)&&await n.call(u)}finally{if(r)throw r.error}}else{const d=(s=e==null?void 0:e.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof e}${d?`; constructor: ${d}`:""}${fL(e)}`)}return i}function fL(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(r=>`"${r}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gS{constructor(t){this._client=t}}gS._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mS(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const PC=Object.freeze(Object.create(null)),dL=(e=mS)=>(function(r,...n){if(r.length===1)return r[0];let a=!1;const s=[],i=r.reduce((d,p,x)=>{var y,C,E;/[?#]/.test(p)&&(a=!0);const T=n[x];let S=(a?encodeURIComponent:e)(""+T);return x!==n.length&&(T==null||typeof T=="object"&&T.toString===((E=Object.getPrototypeOf((C=Object.getPrototypeOf((y=T.hasOwnProperty)!==null&&y!==void 0?y:PC))!==null&&C!==void 0?C:PC))===null||E===void 0?void 0:E.toString))&&(S=T+"",s.push({start:d.length+p.length,length:S.length,error:`Value of type ${Object.prototype.toString.call(T).slice(8,-1)} is not a valid path parameter`})),d+p+(x===n.length?"":S)},""),l=i.split(/[?#]/,1)[0],u=/(^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let f;for(;(f=u.exec(l))!==null;){const d=f[0].startsWith("/"),p=d?1:0,x=d?f[0].slice(1):f[0];s.push({start:f.index+p,length:x.length,error:`Value "${x}" can't be safely passed as a path parameter`})}if(s.sort((d,p)=>d.start-p.start),s.length>0){let d=0;const p=s.reduce((x,y)=>{const C=" ".repeat(y.start-d),E="^".repeat(y.length);return d=y.start+y.length,x+C+E},"");throw new eA(`Path parameters result in path with invalid segments:
${s.map(x=>x.error).join(`
`)}
${i}
${p}`)}return i}),q0=dL(mS);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pS extends gS{create(t,r){var n;const{api_version:a=this._client.apiVersion}=t,s=rd(t,["api_version"]);if("model"in s&&"agent_config"in s)throw new eA("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new eA("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(q0`/${a}/interactions`,Object.assign(Object.assign({body:s},r),{stream:(n=t.stream)!==null&&n!==void 0?n:!1}))}delete(t,r={},n){const{api_version:a=this._client.apiVersion}=r??{};return this._client.delete(q0`/${a}/interactions/${t}`,n)}cancel(t,r={},n){const{api_version:a=this._client.apiVersion}=r??{};return this._client.post(q0`/${a}/interactions/${t}/cancel`,n)}get(t,r={},n){var a;const s=r??{},{api_version:i=this._client.apiVersion}=s,l=rd(s,["api_version"]);return this._client.get(q0`/${i}/interactions/${t}`,Object.assign(Object.assign({query:l},n),{stream:(a=r==null?void 0:r.stream)!==null&&a!==void 0?a:!1}))}}pS._key=Object.freeze(["interactions"]);class xS extends pS{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hL(e){let t=0;for(const a of e)t+=a.length;const r=new Uint8Array(t);let n=0;for(const a of e)r.set(a,n),n+=a.length;return r}let $0;function wx(e){let t;return($0??(t=new globalThis.TextEncoder,$0=t.encode.bind(t)))(e)}let Z0;function GC(e){let t;return(Z0??(t=new globalThis.TextDecoder,Z0=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rd{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?wx(t):t;this.buffer=hL([this.buffer,r]);const n=[];let a;for(;(a=gL(this.buffer,this.carriageReturnIndex))!=null;){if(a.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=a.index;continue}if(this.carriageReturnIndex!=null&&(a.index!==this.carriageReturnIndex+1||a.carriage)){n.push(GC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?a.preceding-1:a.preceding,i=GC(this.buffer.subarray(0,s));n.push(i),this.buffer=this.buffer.subarray(a.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}Rd.NEWLINE_CHARS=new Set([`
`,"\r"]);Rd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function gL(e,t){for(let a=t??0;a<e.length;a++){if(e[a]===10)return{preceding:a,index:a+1,carriage:!1};if(e[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function mL(e){for(let n=0;n<e.length-1;n++){if(e[n]===10&&e[n+1]===10||e[n]===13&&e[n+1]===13)return n+2;if(e[n]===13&&e[n+1]===10&&n+3<e.length&&e[n+2]===13&&e[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nd={off:0,error:200,warn:300,info:400,debug:500},VC=(e,t,r)=>{if(e){if(JM(nd,e))return e;qn(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(nd))}`)}};function Ic(){}function ef(e,t,r){return!t||nd[e]>nd[r]?Ic:t[e].bind(t)}const pL={error:Ic,warn:Ic,info:Ic,debug:Ic};let KC=new WeakMap;function qn(e){var t;const r=e.logger,n=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!r)return pL;const a=KC.get(r);if(a&&a[0]===n)return a[1];const s={error:ef("error",r,n),warn:ef("warn",r,n),info:ef("info",r,n),debug:ef("debug",r,n)};return KC.set(r,[n,s]),s}const Oi=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,r])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":r]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ll{constructor(t,r,n){this.iterator=t,this.controller=r,this.client=n}static fromSSEResponse(t,r,n){let a=!1;const s=n?qn(n):console;function i(){return dA(this,arguments,function*(){var u,f,d,p;if(a)throw new eA("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let x=!1;try{try{for(var y=!0,C=hA(xL(t,r)),E;E=yield St(C.next()),u=E.done,!u;y=!0){p=E.value,y=!1;const T=p;if(!x)if(T.data.startsWith("[DONE]")){x=!0;continue}else try{yield yield St(JSON.parse(T.data))}catch(S){throw s.error("Could not parse message into JSON:",T.data),s.error("From chunk:",T.raw),S}}}catch(T){f={error:T}}finally{try{!y&&!u&&(d=C.return)&&(yield St(d.call(C)))}finally{if(f)throw f.error}}x=!0}catch(T){if(dp(T))return yield St(void 0);throw T}finally{x||r.abort()}})}return new ll(i,r,n)}static fromReadableStream(t,r,n){let a=!1;function s(){return dA(this,arguments,function*(){var u,f,d,p;const x=new Rd,y=fS(t);try{for(var C=!0,E=hA(y),T;T=yield St(E.next()),u=T.done,!u;C=!0){p=T.value,C=!1;const S=p;for(const F of x.decode(S))yield yield St(F)}}catch(S){f={error:S}}finally{try{!C&&!u&&(d=E.return)&&(yield St(d.call(E)))}finally{if(f)throw f.error}}for(const S of x.flush())yield yield St(S)})}function i(){return dA(this,arguments,function*(){var u,f,d,p;if(a)throw new eA("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let x=!1;try{try{for(var y=!0,C=hA(s()),E;E=yield St(C.next()),u=E.done,!u;y=!0){p=E.value,y=!1;const T=p;x||T&&(yield yield St(JSON.parse(T)))}}catch(T){f={error:T}}finally{try{!y&&!u&&(d=C.return)&&(yield St(d.call(C)))}finally{if(f)throw f.error}}x=!0}catch(T){if(dp(T))return yield St(void 0);throw T}finally{x||r.abort()}})}return new ll(i,r,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],n=this.iterator(),a=s=>({next:()=>{if(s.length===0){const i=n.next();t.push(i),r.push(i)}return s.shift()}});return[new ll(()=>a(t),this.controller,this.client),new ll(()=>a(r),this.controller,this.client)]}toReadableStream(){const t=this;let r;return uS({async start(){r=t[Symbol.asyncIterator]()},async pull(n){try{const{value:a,done:s}=await r.next();if(s)return n.close();const i=wx(JSON.stringify(a)+`
`);n.enqueue(i)}catch(a){n.error(a)}},async cancel(){var n;await((n=r.return)===null||n===void 0?void 0:n.call(r))}})}}function xL(e,t){return dA(this,arguments,function*(){var n,a,s,i;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new eA("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new eA("Attempted to iterate over a response with no body");const l=new wL,u=new Rd,f=fS(e.body);try{for(var d=!0,p=hA(vL(f)),x;x=yield St(p.next()),n=x.done,!n;d=!0){i=x.value,d=!1;const y=i;for(const C of u.decode(y)){const E=l.decode(C);E&&(yield yield St(E))}}}catch(y){a={error:y}}finally{try{!d&&!n&&(s=p.return)&&(yield St(s.call(p)))}finally{if(a)throw a.error}}for(const y of u.flush()){const C=l.decode(y);C&&(yield yield St(C))}})}function vL(e){return dA(this,arguments,function*(){var r,n,a,s;let i=new Uint8Array;try{for(var l=!0,u=hA(e),f;f=yield St(u.next()),r=f.done,!r;l=!0){s=f.value,l=!1;const d=s;if(d==null)continue;const p=d instanceof ArrayBuffer?new Uint8Array(d):typeof d=="string"?wx(d):d;let x=new Uint8Array(i.length+p.length);x.set(i),x.set(p,i.length),i=x;let y;for(;(y=mL(i))!==-1;)yield yield St(i.slice(0,y)),i=i.slice(y)}}catch(d){n={error:d}}finally{try{!l&&!r&&(a=u.return)&&(yield St(a.call(u)))}finally{if(n)throw n.error}}i.length>0&&(yield yield St(i))})}class wL{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,n,a]=yL(t,":");return a.startsWith(" ")&&(a=a.substring(1)),r==="event"?this.event=a:r==="data"&&this.data.push(a),null}}function yL(e,t){const r=e.indexOf(t);return r!==-1?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function BL(e,t){const{response:r,requestLogID:n,retryOfRequestLogID:a,startTime:s}=t,i=await(async()=>{var l;if(t.options.stream)return qn(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(r,t.controller,e):ll.fromSSEResponse(r,t.controller,e);if(r.status===204)return null;if(t.options.__binaryResponse)return r;const u=r.headers.get("content-type"),f=(l=u==null?void 0:u.split(";")[0])===null||l===void 0?void 0:l.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?r.headers.get("content-length")==="0"?void 0:await r.json():await r.text()})();return qn(e).debug(`[${n}] response parsed`,Oi({retryOfRequestLogID:a,url:r.url,status:r.status,body:i,durationMs:Date.now()-s})),i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yx extends Promise{constructor(t,r,n=BL){super(a=>{a(null)}),this.responsePromise=r,this.parseResponse=n,this.client=t}_thenUnwrap(t){return new yx(this.client,this.responsePromise,async(r,n)=>t(await this.parseResponse(r,n),n))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vS=Symbol("brand.privateNullableHeaders");function*CL(e){if(!e)return;if(vS in e){const{values:n,nulls:a}=e;yield*n.entries();for(const s of a)yield[s,null];return}let t=!1,r;e instanceof Headers?r=e.entries():LC(e)?r=e:(t=!0,r=Object.entries(e??{}));for(let n of r){const a=n[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const s=LC(n[1])?n[1]:[n[1]];let i=!1;for(const l of s)l!==void 0&&(t&&!i&&(i=!0,yield[a,null]),yield[a,l])}}const Tc=e=>{const t=new Headers,r=new Set;for(const n of e){const a=new Set;for(const[s,i]of CL(n)){const l=s.toLowerCase();a.has(l)||(t.delete(s),a.add(l)),i===null?(t.delete(s),r.add(l)):(t.append(s,i),r.delete(l))}}return{[vS]:!0,values:t,nulls:r}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dm=e=>{var t,r,n,a,s,i;if(typeof globalThis.process<"u")return(n=(r=(t=GN)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(i=(s=(a=globalThis.Deno.env)===null||a===void 0?void 0:a.get)===null||s===void 0?void 0:s.call(a,e))===null||i===void 0?void 0:i.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var wS;class Dd{constructor(t){var r,n,a,s,i,l,u,{baseURL:f=dm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:d=(r=dm("GEMINI_API_KEY"))!==null&&r!==void 0?r:null,apiVersion:p="v1beta"}=t,x=rd(t,["baseURL","apiKey","apiVersion"]);const y=Object.assign(Object.assign({apiKey:d,apiVersion:p},x),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=y.baseURL,this.timeout=(n=y.timeout)!==null&&n!==void 0?n:Dd.DEFAULT_TIMEOUT,this.logger=(a=y.logger)!==null&&a!==void 0?a:console;const C="warn";this.logLevel=C,this.logLevel=(i=(s=VC(y.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:VC(dm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&i!==void 0?i:C,this.fetchOptions=y.fetchOptions,this.maxRetries=(l=y.maxRetries)!==null&&l!==void 0?l:2,this.fetch=(u=y.fetch)!==null&&u!==void 0?u:nL(),this.encoder=sL,this._options=y,this.apiKey=d,this.apiVersion=p,this.clientAdapter=y.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:r}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!r.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const r=Tc([t.headers]);if(!(r.values.has("authorization")||r.values.has("x-goog-api-key"))){if(this.apiKey)return Tc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Tc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new eA(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${al}`}defaultIdempotencyKey(){return`stainless-node-retry-${VM()}`}makeStatusError(t,r,n,a){return ra.generate(t,r,n,a)}buildURL(t,r,n){const a=!this.baseURLOverridden()&&n||this.baseURL,s=jM(t)?new URL(t):new URL(a+(a.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),i=this.defaultQuery();return WM(i)||(r=Object.assign(Object.assign({},i),r)),typeof r=="object"&&r&&!Array.isArray(r)&&(s.search=this.stringifyQuery(r)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const r=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${r}`}}async prepareRequest(t,{url:r,options:n}){}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,n){return this.request(Promise.resolve(n).then(a=>Object.assign({method:t,path:r},a)))}request(t,r=null){return new yx(this,this.makeRequest(t,r,void 0))}async makeRequest(t,r,n){var a,s,i;const l=await t,u=(a=l.maxRetries)!==null&&a!==void 0?a:this.maxRetries;r==null&&(r=u),await this.prepareOptions(l);const{req:f,url:d,timeout:p}=await this.buildRequest(l,{retryCount:u-r});await this.prepareRequest(f,{url:d,options:l});const x="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),y=n===void 0?"":`, retryOf: ${n}`,C=Date.now();if(qn(this).debug(`[${x}] sending request`,Oi({retryOfRequestLogID:n,method:l.method,url:d,options:l,headers:f.headers})),!((s=l.signal)===null||s===void 0)&&s.aborted)throw new gp;const E=new AbortController,T=await this.fetchWithTimeout(d,f,p,E).catch(hp),S=Date.now();if(T instanceof globalThis.Error){const _=`retrying, ${r} attempts remaining`;if(!((i=l.signal)===null||i===void 0)&&i.aborted)throw new gp;const N=dp(T)||/timed? ?out/i.test(String(T)+("cause"in T?String(T.cause):""));if(r)return qn(this).info(`[${x}] connection ${N?"timed out":"failed"} - ${_}`),qn(this).debug(`[${x}] connection ${N?"timed out":"failed"} (${_})`,Oi({retryOfRequestLogID:n,url:d,durationMs:S-C,message:T.message})),this.retryRequest(l,r,n??x);throw qn(this).info(`[${x}] connection ${N?"timed out":"failed"} - error; no more retries left`),qn(this).debug(`[${x}] connection ${N?"timed out":"failed"} (error; no more retries left)`,Oi({retryOfRequestLogID:n,url:d,durationMs:S-C,message:T.message})),N?new rS:new Qd({cause:T})}const F=`[${x}${y}] ${f.method} ${d} ${T.ok?"succeeded":"failed"} with status ${T.status} in ${S-C}ms`;if(!T.ok){const _=await this.shouldRetry(T);if(r&&_){const M=`retrying, ${r} attempts remaining`;return await AL(T.body),qn(this).info(`${F} - ${M}`),qn(this).debug(`[${x}] response error (${M})`,Oi({retryOfRequestLogID:n,url:T.url,status:T.status,headers:T.headers,durationMs:S-C})),this.retryRequest(l,r,n??x,T.headers)}const N=_?"error; no more retries left":"error; not retryable";qn(this).info(`${F} - ${N}`);const I=await T.text().catch(M=>hp(M).message),U=qM(I),k=U?void 0:I;throw qn(this).debug(`[${x}] response error (${N})`,Oi({retryOfRequestLogID:n,url:T.url,status:T.status,headers:T.headers,message:k,durationMs:Date.now()-C})),this.makeStatusError(T.status,U,k,T.headers)}return qn(this).info(F),qn(this).debug(`[${x}] response start`,Oi({retryOfRequestLogID:n,url:T.url,status:T.status,headers:T.headers,durationMs:S-C})),{response:T,options:l,controller:E,requestLogID:x,retryOfRequestLogID:n,startTime:C}}async fetchWithTimeout(t,r,n,a){const s=r||{},{signal:i,method:l}=s,u=rd(s,["signal","method"]),f=this._makeAbort(a);i&&i.addEventListener("abort",f,{once:!0});const d=setTimeout(f,n),p=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,x=Object.assign(Object.assign(Object.assign({signal:a.signal},p?{duplex:"half"}:{}),{method:"GET"}),u);l&&(x.method=l.toUpperCase());try{return await this.fetch.call(void 0,t,x)}finally{clearTimeout(d)}}async shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,n,a){var s;let i;const l=a==null?void 0:a.get("retry-after-ms");if(l){const f=parseFloat(l);Number.isNaN(f)||(i=f)}const u=a==null?void 0:a.get("retry-after");if(u&&!i){const f=parseFloat(u);Number.isNaN(f)?i=Date.parse(u)-Date.now():i=f*1e3}if(!(i&&0<=i&&i<60*1e3)){const f=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(r,f)}return await $M(i),this.makeRequest(t,r-1,n)}calculateDefaultRetryTimeoutMillis(t,r){const s=r-t,i=Math.min(.5*Math.pow(2,s),8),l=1-Math.random()*.25;return i*l*1e3}async buildRequest(t,{retryCount:r=0}={}){var n,a,s;const i=Object.assign({},t),{method:l,path:u,query:f,defaultBaseURL:d}=i,p=this.buildURL(u,f,d);"timeout"in i&&YM("timeout",i.timeout),i.timeout=(n=i.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:x,body:y}=this.buildBody({options:i}),C=await this.buildHeaders({options:t,method:l,bodyHeaders:x,retryCount:r});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:l,headers:C},i.signal&&{signal:i.signal}),globalThis.ReadableStream&&y instanceof globalThis.ReadableStream&&{duplex:"half"}),y&&{body:y}),(a=this.fetchOptions)!==null&&a!==void 0?a:{}),(s=i.fetchOptions)!==null&&s!==void 0?s:{}),url:p,timeout:i.timeout}}async buildHeaders({options:t,method:r,bodyHeaders:n,retryCount:a}){let s={};this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);const i=await this.authHeaders(t);let l=Tc([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),rL()),this._options.defaultHeaders,n,t.headers,i]);return this.validateHeaders(l),l.values}_makeAbort(t){return()=>t.abort()}buildBody({options:{body:t,headers:r}}){if(!t)return{bodyHeaders:void 0,body:void 0};const n=Tc([r]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&n.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:aL(t)}:typeof t=="object"&&n.values.get("content-type")==="application/x-www-form-urlencoded"?{bodyHeaders:{"content-type":"application/x-www-form-urlencoded"},body:this.stringifyQuery(t)}:this.encoder({body:t,headers:n})}}Dd.DEFAULT_TIMEOUT=6e4;class Tn extends Dd{constructor(){super(...arguments),this.interactions=new xS(this)}}wS=Tn;Tn.GeminiNextGenAPIClient=wS;Tn.GeminiNextGenAPIClientError=eA;Tn.APIError=ra;Tn.APIConnectionError=Qd;Tn.APIConnectionTimeoutError=rS;Tn.APIUserAbortError=gp;Tn.NotFoundError=sS;Tn.ConflictError=iS;Tn.RateLimitError=lS;Tn.BadRequestError=nS;Tn.AuthenticationError=aS;Tn.InternalServerError=cS;Tn.PermissionDeniedError=AS;Tn.UnprocessableEntityError=oS;Tn.toFile=uL;Tn.Interactions=xS;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EL(e,t){const r={},n=m(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function TL(e,t){const r={},n=m(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function SL(e,t){const r={},n=m(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function _L(e,t){const r={},n=m(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function bL(e,t,r){const n={};if(m(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=m(e,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&v(t,["displayName"],a),m(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=m(e,["epochCount"]);t!==void 0&&s!=null&&v(t,["tuningTask","hyperparameters","epochCount"],s);const i=m(e,["learningRateMultiplier"]);if(i!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],i),m(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(m(e,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(m(e,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const l=m(e,["batchSize"]);t!==void 0&&l!=null&&v(t,["tuningTask","hyperparameters","batchSize"],l);const u=m(e,["learningRate"]);if(t!==void 0&&u!=null&&v(t,["tuningTask","hyperparameters","learningRate"],u),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(m(e,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(m(e,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(m(e,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(m(e,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");if(m(e,["encryptionSpec"])!==void 0)throw new Error("encryptionSpec parameter is not supported in Gemini API.");return n}function FL(e,t,r){const n={};let a=m(r,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const U=m(e,["validationDataset"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec"],hm(U))}else if(a==="PREFERENCE_TUNING"){const U=m(e,["validationDataset"]);t!==void 0&&U!=null&&v(t,["preferenceOptimizationSpec"],hm(U))}else if(a==="DISTILLATION"){const U=m(e,["validationDataset"]);t!==void 0&&U!=null&&v(t,["distillationSpec"],hm(U))}const s=m(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&v(t,["tunedModelDisplayName"],s);const i=m(e,["description"]);t!==void 0&&i!=null&&v(t,["description"],i);let l=m(r,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const U=m(e,["epochCount"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","hyperParameters","epochCount"],U)}else if(l==="PREFERENCE_TUNING"){const U=m(e,["epochCount"]);t!==void 0&&U!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],U)}else if(l==="DISTILLATION"){const U=m(e,["epochCount"]);t!==void 0&&U!=null&&v(t,["distillationSpec","hyperParameters","epochCount"],U)}let u=m(r,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const U=m(e,["learningRateMultiplier"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],U)}else if(u==="PREFERENCE_TUNING"){const U=m(e,["learningRateMultiplier"]);t!==void 0&&U!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],U)}else if(u==="DISTILLATION"){const U=m(e,["learningRateMultiplier"]);t!==void 0&&U!=null&&v(t,["distillationSpec","hyperParameters","learningRateMultiplier"],U)}let f=m(r,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const U=m(e,["exportLastCheckpointOnly"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","exportLastCheckpointOnly"],U)}else if(f==="PREFERENCE_TUNING"){const U=m(e,["exportLastCheckpointOnly"]);t!==void 0&&U!=null&&v(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],U)}else if(f==="DISTILLATION"){const U=m(e,["exportLastCheckpointOnly"]);t!==void 0&&U!=null&&v(t,["distillationSpec","exportLastCheckpointOnly"],U)}let d=m(r,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const U=m(e,["adapterSize"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","hyperParameters","adapterSize"],U)}else if(d==="PREFERENCE_TUNING"){const U=m(e,["adapterSize"]);t!==void 0&&U!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],U)}else if(d==="DISTILLATION"){const U=m(e,["adapterSize"]);t!==void 0&&U!=null&&v(t,["distillationSpec","hyperParameters","adapterSize"],U)}let p=m(r,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const U=m(e,["tuningMode"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","tuningMode"],U)}const x=m(e,["customBaseModel"]);t!==void 0&&x!=null&&v(t,["customBaseModel"],x);let y=m(r,["config","method"]);if(y===void 0&&(y="SUPERVISED_FINE_TUNING"),y==="SUPERVISED_FINE_TUNING"){const U=m(e,["batchSize"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","hyperParameters","batchSize"],U)}let C=m(r,["config","method"]);if(C===void 0&&(C="SUPERVISED_FINE_TUNING"),C==="SUPERVISED_FINE_TUNING"){const U=m(e,["learningRate"]);t!==void 0&&U!=null&&v(t,["supervisedTuningSpec","hyperParameters","learningRate"],U)}const E=m(e,["labels"]);t!==void 0&&E!=null&&v(t,["labels"],E);const T=m(e,["beta"]);t!==void 0&&T!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","beta"],T);const S=m(e,["baseTeacherModel"]);t!==void 0&&S!=null&&v(t,["distillationSpec","baseTeacherModel"],S);const F=m(e,["tunedTeacherModelSource"]);t!==void 0&&F!=null&&v(t,["distillationSpec","tunedTeacherModelSource"],F);const _=m(e,["sftLossWeightMultiplier"]);t!==void 0&&_!=null&&v(t,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],_);const N=m(e,["outputUri"]);t!==void 0&&N!=null&&v(t,["outputUri"],N);const I=m(e,["encryptionSpec"]);return t!==void 0&&I!=null&&v(t,["encryptionSpec"],I),n}function UL(e,t){const r={},n=m(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const a=m(e,["preTunedModel"]);a!=null&&v(r,["preTunedModel"],a);const s=m(e,["trainingDataset"]);s!=null&&PL(s);const i=m(e,["config"]);return i!=null&&bL(i,r),r}function kL(e,t){const r={},n=m(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const a=m(e,["preTunedModel"]);a!=null&&v(r,["preTunedModel"],a);const s=m(e,["trainingDataset"]);s!=null&&GL(s,r,t);const i=m(e,["config"]);return i!=null&&FL(i,r,t),r}function NL(e,t){const r={},n=m(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function IL(e,t){const r={},n=m(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function QL(e,t,r){const n={},a=m(e,["pageSize"]);t!==void 0&&a!=null&&v(t,["_query","pageSize"],a);const s=m(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const i=m(e,["filter"]);return t!==void 0&&i!=null&&v(t,["_query","filter"],i),n}function RL(e,t,r){const n={},a=m(e,["pageSize"]);t!==void 0&&a!=null&&v(t,["_query","pageSize"],a);const s=m(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const i=m(e,["filter"]);return t!==void 0&&i!=null&&v(t,["_query","filter"],i),n}function DL(e,t){const r={},n=m(e,["config"]);return n!=null&&QL(n,r),r}function ML(e,t){const r={},n=m(e,["config"]);return n!=null&&RL(n,r),r}function LL(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["nextPageToken"]);a!=null&&v(r,["nextPageToken"],a);const s=m(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(l=>yS(l))),v(r,["tuningJobs"],i)}return r}function HL(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["nextPageToken"]);a!=null&&v(r,["nextPageToken"],a);const s=m(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(l=>xp(l))),v(r,["tuningJobs"],i)}return r}function OL(e,t){const r={},n=m(e,["name"]);n!=null&&v(r,["model"],n);const a=m(e,["name"]);return a!=null&&v(r,["endpoint"],a),r}function PL(e,t){const r={};if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=m(e,["examples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>s)),v(r,["examples","examples"],a)}return r}function GL(e,t,r){const n={};let a=m(r,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const i=m(e,["gcsUri"]);t!==void 0&&i!=null&&v(t,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(a==="PREFERENCE_TUNING"){const i=m(e,["gcsUri"]);t!==void 0&&i!=null&&v(t,["preferenceOptimizationSpec","trainingDatasetUri"],i)}else if(a==="DISTILLATION"){const i=m(e,["gcsUri"]);t!==void 0&&i!=null&&v(t,["distillationSpec","promptDatasetUri"],i)}let s=m(r,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const i=m(e,["vertexDatasetResource"]);t!==void 0&&i!=null&&v(t,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(s==="PREFERENCE_TUNING"){const i=m(e,["vertexDatasetResource"]);t!==void 0&&i!=null&&v(t,["preferenceOptimizationSpec","trainingDatasetUri"],i)}else if(s==="DISTILLATION"){const i=m(e,["vertexDatasetResource"]);t!==void 0&&i!=null&&v(t,["distillationSpec","promptDatasetUri"],i)}if(m(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function yS(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["name"]);a!=null&&v(r,["name"],a);const s=m(e,["state"]);s!=null&&v(r,["state"],MT(s));const i=m(e,["createTime"]);i!=null&&v(r,["createTime"],i);const l=m(e,["tuningTask","startTime"]);l!=null&&v(r,["startTime"],l);const u=m(e,["tuningTask","completeTime"]);u!=null&&v(r,["endTime"],u);const f=m(e,["updateTime"]);f!=null&&v(r,["updateTime"],f);const d=m(e,["description"]);d!=null&&v(r,["description"],d);const p=m(e,["baseModel"]);p!=null&&v(r,["baseModel"],p);const x=m(e,["_self"]);return x!=null&&v(r,["tunedModel"],OL(x)),r}function xp(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["name"]);a!=null&&v(r,["name"],a);const s=m(e,["state"]);s!=null&&v(r,["state"],MT(s));const i=m(e,["createTime"]);i!=null&&v(r,["createTime"],i);const l=m(e,["startTime"]);l!=null&&v(r,["startTime"],l);const u=m(e,["endTime"]);u!=null&&v(r,["endTime"],u);const f=m(e,["updateTime"]);f!=null&&v(r,["updateTime"],f);const d=m(e,["error"]);d!=null&&v(r,["error"],d);const p=m(e,["description"]);p!=null&&v(r,["description"],p);const x=m(e,["baseModel"]);x!=null&&v(r,["baseModel"],x);const y=m(e,["tunedModel"]);y!=null&&v(r,["tunedModel"],y);const C=m(e,["preTunedModel"]);C!=null&&v(r,["preTunedModel"],C);const E=m(e,["supervisedTuningSpec"]);E!=null&&v(r,["supervisedTuningSpec"],E);const T=m(e,["preferenceOptimizationSpec"]);T!=null&&v(r,["preferenceOptimizationSpec"],T);const S=m(e,["distillationSpec"]);S!=null&&v(r,["distillationSpec"],S);const F=m(e,["tuningDataStats"]);F!=null&&v(r,["tuningDataStats"],F);const _=m(e,["encryptionSpec"]);_!=null&&v(r,["encryptionSpec"],_);const N=m(e,["partnerModelTuningSpec"]);N!=null&&v(r,["partnerModelTuningSpec"],N);const I=m(e,["customBaseModel"]);I!=null&&v(r,["customBaseModel"],I);const U=m(e,["experiment"]);U!=null&&v(r,["experiment"],U);const k=m(e,["labels"]);k!=null&&v(r,["labels"],k);const G=m(e,["outputUri"]);G!=null&&v(r,["outputUri"],G);const M=m(e,["pipelineJob"]);M!=null&&v(r,["pipelineJob"],M);const ee=m(e,["serviceAccount"]);ee!=null&&v(r,["serviceAccount"],ee);const re=m(e,["tunedModelDisplayName"]);re!=null&&v(r,["tunedModelDisplayName"],re);const q=m(e,["veoTuningSpec"]);return q!=null&&v(r,["veoTuningSpec"],q),r}function VL(e,t){const r={},n=m(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=m(e,["name"]);a!=null&&v(r,["name"],a);const s=m(e,["metadata"]);s!=null&&v(r,["metadata"],s);const i=m(e,["done"]);i!=null&&v(r,["done"],i);const l=m(e,["error"]);return l!=null&&v(r,["error"],l),r}function hm(e,t){const r={},n=m(e,["gcsUri"]);n!=null&&v(r,["validationDatasetUri"],n);const a=m(e,["vertexDatasetResource"]);return a!=null&&v(r,["validationDatasetUri"],a),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KL extends hs{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ao(us.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.get=async r=>await this.getInternal(r),this.tune=async r=>{var n;if(this.apiClient.isVertexAI())if(r.baseModel.startsWith("projects/")){const a={tunedModelName:r.baseModel};!((n=r.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(a.checkpointId=r.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},r),{preTunedModel:a});return s.baseModel=void 0,await this.tuneInternal(s)}else{const a=Object.assign({},r);return await this.tuneInternal(a)}else{const a=Object.assign({},r),s=await this.tuneMldevInternal(a);let i="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?i=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(i=s.name.split("/operations/")[0]),{name:i,state:Ap.JOB_STATE_QUEUED}}}}async getInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=IL(t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>xp(d))}else{const f=NL(t);return l=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>yS(d))}}async listInternal(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=ML(t);return l=qe("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=HL(d),x=new pC;return Object.assign(x,p),x})}else{const f=DL(t);return l=qe("tunedModels",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=LL(d),x=new pC;return Object.assign(x,p),x})}}async cancel(t){var r,n,a,s;let i,l="",u={};if(this.apiClient.isVertexAI()){const f=TL(t);return l=qe("{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=_L(d),x=new xC;return Object.assign(x,p),x})}else{const f=EL(t);return l=qe("{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:d.headers},x})),i.then(d=>{const p=SL(d),x=new xC;return Object.assign(x,p),x})}}async tuneInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI()){const l=kL(t,t);return s=qe("tuningJobs",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>xp(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var r,n;let a,s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=UL(t);return s=qe("tunedModels",l._url),i=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>VL(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jL{async download(t,r){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const zL=1024*1024*8,XL=3,WL=1e3,JL=2,ad="x-goog-upload-status";async function YL(e,t,r){var n;const a=await BS(e,t,r),s=await(a==null?void 0:a.json());if(((n=a==null?void 0:a.headers)===null||n===void 0?void 0:n[ad])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function qL(e,t,r){var n;const a=await BS(e,t,r),s=await(a==null?void 0:a.json());if(((n=a==null?void 0:a.headers)===null||n===void 0?void 0:n[ad])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const i=kT(s),l=new hx;return Object.assign(l,i),l}async function BS(e,t,r){var n,a;let s=0,i=0,l=new ip(new Response),u="upload";for(s=e.size;i<s;){const f=Math.min(zL,s-i),d=e.slice(i,i+f);i+f>=s&&(u+=", finalize");let p=0,x=WL;for(;p<XL&&(l=await r.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(i),"Content-Length":String(f)}}}),!(!((n=l==null?void 0:l.headers)===null||n===void 0)&&n[ad]));)p++,await ZL(x),x=x*JL;if(i+=f,((a=l==null?void 0:l.headers)===null||a===void 0?void 0:a[ad])!=="active")break;if(s<=i)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return l}async function $L(e){return{size:e.size,type:e.type}}function ZL(e){return new Promise(t=>setTimeout(t,e))}class eH{async upload(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await YL(t,r,n)}async uploadToFileSearchStore(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await qL(t,r,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await $L(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tH{create(t,r,n){return new rH(t,r,n)}}class rH{constructor(t,r,n){this.url=t,this.headers=r,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jC="x-goog-api-key";class nH{constructor(t){this.apiKey=t}async addAuthHeaders(t,r){if(t.get(jC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(jC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aH="gl-node/";class CS{get interactions(){var t;if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const r=this.httpOptions;r!=null&&r.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new Tn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:r==null?void 0:r.timeout,maxRetries:(t=r==null?void 0:r.retryOptions)===null||t===void 0?void 0:t.attempts});return this._interactions=n.interactions,this._interactions}constructor(t){var r;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(r=t.vertexai)!==null&&r!==void 0?r:!1,this.apiKey=t.apiKey;const n=zN(t.httpOptions,t.vertexai,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const a=new nH(this.apiKey);this.apiClient=new $D({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:aH+"web",uploader:new eH,downloader:new jL}),this.models=new pM(this.apiClient),this.live=new uM(this.apiClient,a,new tH),this.batches=new C3(this.apiClient),this.chats=new aQ(this.models,this.apiClient),this.caches=new tQ(this.apiClient),this.files=new mQ(this.apiClient),this.operations=new xM(this.apiClient),this.authTokens=new QM(this.apiClient),this.tunings=new KL(this.apiClient),this.fileSearchStores=new GM(this.apiClient)}}const AH={users:[{id:"super01",name:"System Super Admin",email:"super@exam.com",role:lt.SUPER_ADMIN,password:"password123"},{id:"admin01",name:"Admin User",email:"admin@exam.com",role:lt.ADMIN,password:"password123",institutionName:"Global Tech University",permissionGranted:!0},{id:"admin02",name:"Second Admin",email:"admin2@exam.com",role:lt.ADMIN,password:"password123",institutionName:"Innovate Institute",permissionGranted:!0},{id:"admin_pending",name:"Pending Admin",email:"pending@exam.com",role:lt.ADMIN,password:"password123",institutionName:"New Horizon School",permissionGranted:!1},{id:"teacher01",name:"Dr. Evelyn Reed",email:"teacher1@exam.com",role:lt.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"},{id:"teacher02",name:"Mr. Samuel Chen",email:"teacher2@exam.com",role:lt.TEACHER,permissionGranted:!1,password:"password123"},{id:"teacher03",name:"Ms. Anya Sharma",email:"teacher3@exam.com",role:lt.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"},{id:"teacher04",name:"Ms. Nitya",email:"teacher4@exam.com",role:lt.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"}],exams:[{id:"exam01",title:"Mid-Term Examinations",date:"2024-09-15",halls:[{id:"hallA",name:"Hall A",layout:Array.from({length:64},(e,t)=>({id:`s${t}`,row:Math.floor(t/8),col:t%8,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"},{id:"hallB",name:"Hall B",layout:Array.from({length:42},(e,t)=>({id:`s${t}`,row:Math.floor(t/7),col:t%7,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"}],studentSets:[{id:"set101",subject:"101",studentCount:50},{id:"set102",subject:"102",studentCount:45}],seatingPlan:void 0,seatingType:"normal",editorMode:"ai",createdBy:"teacher01",adminId:"admin01"},{id:"exam02",title:"Finals - Advanced Mode",date:"2024-12-10",halls:[{id:"hallC",name:"Hall C",layout:Array.from({length:50},(e,t)=>({id:`s${t}`,row:Math.floor(t/10),col:t%10,type:"standard"})),constraints:{type:"advanced",allowedSetIds:["set201"],arrangement:"vertical"},frontDirection:"left"}],studentSets:[{id:"set201",subject:"201",studentCount:30},{id:"set202",subject:"202",studentCount:20}],seatingPlan:void 0,seatingType:"normal",editorMode:"advanced",createdBy:"teacher03",adminId:"admin01"},{id:"exam03",title:"Pop Quiz - Classic Mode",date:"2024-10-25",halls:[{id:"hallD",name:"Hall D",layout:Array.from({length:30},(e,t)=>({id:`s${t}`,row:Math.floor(t/5),col:t%5,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"bottom"}],studentSets:[{id:"set301",subject:"301",studentCount:25}],seatingPlan:void 0,seatingType:"fair",editorMode:"classic",createdBy:"teacher01",adminId:"admin01"}],hallTemplates:[{id:"template01",name:"Main Auditorium",layout:Array.from({length:100},(e,t)=>({id:`s${t}`,row:Math.floor(t/10),col:t%10,type:"standard"})),createdBy:"teacher01",adminId:"admin01"},{id:"template02",name:"Computer Lab 1",layout:Array.from({length:40},(e,t)=>({id:`s${t}`,row:Math.floor(t/8),col:t%8,type:"standard"})),createdBy:"teacher01",adminId:"admin01"}],studentSetTemplates:[{id:"settemplate01",subject:"Physics 101",studentCount:50,createdBy:"teacher01",adminId:"admin01"},{id:"settemplate02",subject:"Chemistry Lab",studentCount:24,createdBy:"teacher01",adminId:"admin01"},{id:"settemplate03",subject:"Calculus III",studentCount:45,createdBy:"teacher03",adminId:"admin01"}],auditLogs:[{id:"log1",adminId:"admin01",actorName:"Dr. Evelyn Reed",role:lt.TEACHER,action:"CREATED_EXAM",details:'Created exam "Mid-Term Examinations"',timestamp:new Date(Date.now()-864e5*2).toISOString()},{id:"log2",adminId:"admin01",actorName:"Student 101001",role:lt.STUDENT,action:"STUDENT_LOGIN",details:"Accessed dashboard",timestamp:new Date(Date.now()-36e5).toISOString()}]};let ze=JSON.parse(JSON.stringify(AH));const sr=200,li=(e,t,r,n,a)=>{const s={id:`log${Date.now()}${Math.random().toString(36).substr(2,5)}`,adminId:e,actorName:t,role:r,action:n,details:a,timestamp:new Date().toISOString()};ze.auditLogs.unshift(s)},ES=async e=>(await new Promise(t=>setTimeout(t,sr)),e?Promise.resolve(ze.auditLogs.filter(t=>t.adminId===e).sort((t,r)=>new Date(r.timestamp).getTime()-new Date(t.timestamp).getTime())):Promise.resolve(ze.auditLogs)),sH=async()=>(await new Promise(e=>setTimeout(e,sr)),Promise.resolve(ze.users.filter(e=>e.role===lt.ADMIN))),iH=async e=>{await new Promise(r=>setTimeout(r,sr));let t;return ze.users=ze.users.map(r=>r.id===e&&r.role===lt.ADMIN?(t={...r,permissionGranted:!0},t):r),t&&li("SYSTEM","Super Admin",lt.SUPER_ADMIN,"GRANT_ADMIN_ACCESS",`Approved institution admin: ${t.institutionName}`),Promise.resolve(t)},oH=async e=>{await new Promise(r=>setTimeout(r,sr));const t=ze.users.find(r=>r.id===e&&r.role===lt.ADMIN);return t?(ze.users=ze.users.filter(r=>r.id!==e&&r.adminId!==e),ze.exams=ze.exams.filter(r=>r.adminId!==e),ze.hallTemplates=ze.hallTemplates.filter(r=>r.adminId!==e),ze.studentSetTemplates=ze.studentSetTemplates.filter(r=>r.adminId!==e),ze.auditLogs=ze.auditLogs.filter(r=>r.adminId!==e),li("SYSTEM","Super Admin",lt.SUPER_ADMIN,"DELETE_INSTITUTION",`Wiped institution and all data for: ${t.institutionName}`),!0):!1},lH=async()=>{await new Promise(t=>setTimeout(t,sr));const e=ze.users.filter(t=>t.role===lt.ADMIN&&t.institutionName&&t.permissionGranted).map(t=>({id:t.id,name:t.institutionName})).sort((t,r)=>t.name.localeCompare(r.name));return Promise.resolve(e)},cH=async e=>(await new Promise(t=>setTimeout(t,sr)),Promise.resolve(ze.users.find(t=>t.email.toLowerCase()===e.toLowerCase()))),Fu=async e=>(await new Promise(t=>setTimeout(t,sr)),Promise.resolve(ze.users.find(t=>t.id===e))),uH=async(e,t,r,n)=>{if(await new Promise(s=>setTimeout(s,sr)),ze.users.some(s=>s.email.toLowerCase()===t.toLowerCase()))return Promise.resolve(null);const a={id:`admin${Date.now()}`,name:e,email:t,role:lt.ADMIN,password:r,institutionName:n,permissionGranted:!1};return ze.users=[...ze.users,a],Promise.resolve(a)},fH=async(e,t,r,n)=>{if(await new Promise(i=>setTimeout(i,sr)),ze.users.some(i=>i.email.toLowerCase()===t.toLowerCase()))return Promise.resolve(null);const a=ze.users.find(i=>{var l;return i.role===lt.ADMIN&&(i.id===n||((l=i.institutionName)==null?void 0:l.toLowerCase())===n.toLowerCase())});if(!a)return Promise.resolve(null);const s={id:`teacher${Date.now()}`,name:e,email:t,role:lt.TEACHER,permissionGranted:!1,password:r,adminId:a.id};return ze.users=[...ze.users,s],Promise.resolve(s)},TS=async e=>(await new Promise(t=>setTimeout(t,sr)),Promise.resolve(ze.users.filter(t=>t.role==="TEACHER"&&t.adminId===e))),dH=async()=>(await new Promise(e=>setTimeout(e,sr)),Promise.resolve(ze.users.filter(e=>e.role==="TEACHER"&&!e.permissionGranted))),hH=async(e,t)=>{await new Promise(n=>setTimeout(n,sr));let r;return ze.users=ze.users.map(n=>n.id===e&&n.role==="TEACHER"?(r={...n,permissionGranted:!0,adminId:t},r):n),r&&li(t,"Admin",lt.ADMIN,"GRANTED_PERMISSION",`Approved teacher account: ${r.name}`),Promise.resolve(r)},gH=async e=>{await new Promise(r=>setTimeout(r,sr));let t;return ze.users=ze.users.map(r=>r.id===e&&r.role==="TEACHER"?(t={...r,permissionGranted:!1},t):r),t&&t.adminId&&li(t.adminId,"Admin",lt.ADMIN,"REVOKED_PERMISSION",`Revoked permission for: ${t.name}`),Promise.resolve(t)},mH=async(e,t)=>{await new Promise(n=>setTimeout(n,sr));const r=ze.users.length;return ze.users=ze.users.filter(n=>n.id!==e),ze.users.length===r?Promise.resolve(!1):(ze.exams=ze.exams.filter(n=>n.createdBy!==e),ze.hallTemplates=ze.hallTemplates.filter(n=>n.createdBy!==e),ze.studentSetTemplates=ze.studentSetTemplates.filter(n=>n.createdBy!==e),li(t,"Admin",lt.ADMIN,"DELETED_TEACHER","Deleted teacher account."),Promise.resolve(!0))},pH=async e=>(await new Promise(t=>setTimeout(t,sr)),Promise.resolve([...ze.exams].filter(t=>t.adminId===e).sort((t,r)=>r.id.localeCompare(t.id)))),xH=async(e,t)=>{await new Promise(n=>setTimeout(n,sr));for(const n of ze.exams)if(!n.seatingPlan&&n.adminId===t){let a;n.editorMode==="classic"||n.editorMode==="advanced"?a=await wp({halls:n.halls,studentSets:n.studentSets,seatingType:n.seatingType}):a=await yp({halls:n.halls,studentSets:n.studentSets,rules:n.aiSeatingRules,seatingType:n.seatingType,editorMode:n.editorMode}),a.plan&&(n.seatingPlan=a.plan)}const r=ze.exams.filter(n=>n.adminId!==t||!n.seatingPlan?!1:Object.values(n.seatingPlan).some(a=>a.some(s=>s.some(i=>{var l;return((l=i==null?void 0:i.student)==null?void 0:l.id)===e}))));return Promise.resolve(r.sort((n,a)=>a.id.localeCompare(n.id)))},vH=async e=>{await new Promise(r=>setTimeout(r,sr));const t=ze.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(ze.exams.filter(r=>r.adminId===t.adminId).sort((r,n)=>n.id.localeCompare(r.id)))},wH=async(e,t)=>{await new Promise(a=>setTimeout(a,sr));const r=await Fu(t);if(!r||!r.adminId)throw new Error("Teacher not assigned.");const n={...e,id:`exam${Date.now()}`,createdBy:t,adminId:r.adminId,halls:e.halls.map((a,s)=>({...a,id:`hall${Date.now()}${s}`})),studentSets:e.studentSets.map((a,s)=>({...a,id:`set${Date.now()}${s}`})),seatingPlan:void 0};return ze.exams=[...ze.exams,n],li(r.adminId,r.name,lt.TEACHER,"CREATED_EXAM",`Created new exam: "${n.title}"`),Promise.resolve(n)},gm=async e=>{await new Promise(r=>setTimeout(r,sr));const t=ze.users.find(r=>r.id===e.createdBy);return ze.exams=ze.exams.map(r=>r.id===e.id?e:r),t&&t.adminId&&li(t.adminId,t.name,lt.TEACHER,"UPDATED_EXAM",`Updated exam: "${e.title}"`),Promise.resolve(e)},yH=async(e,t,r)=>{await new Promise(a=>setTimeout(a,sr));const n=ze.exams.findIndex(a=>a.id===e);return n===-1?Promise.resolve(!1):(ze.exams[n].seatingPlan=t,Promise.resolve(!0))},SS=async(e,t,r)=>{await new Promise(s=>setTimeout(s,sr));const n=ze.exams.find(s=>s.id===e);if(!n)return Promise.resolve(!1);if(r===lt.ADMIN&&n.adminId===t||r===lt.TEACHER){const s=ze.exams.length;if(ze.exams=ze.exams.filter(i=>i.id!==e),ze.exams.length<s)return li(n.adminId,r===lt.ADMIN?"Admin":"Teacher",r,"DELETED_EXAM",`Deleted exam: "${n.title}"`),Promise.resolve(!0)}return Promise.resolve(!1)},BH=async e=>{await new Promise(r=>setTimeout(r,sr));const t=ze.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(ze.hallTemplates.filter(r=>r.adminId===t.adminId))},CH=async e=>(await new Promise(t=>setTimeout(t,sr)),Promise.resolve(ze.hallTemplates.filter(t=>t.adminId===e))),Kc=async(e,t)=>{await new Promise(s=>setTimeout(s,sr));const r=await Fu(t);if(!r)throw new Error("Creator not found.");const n=r.role===lt.ADMIN?r.id:r.adminId,a={...e,id:`template${Date.now()}`,createdBy:t,adminId:n};return ze.hallTemplates=[...ze.hallTemplates,a],Promise.resolve(a)},EH=async(e,t,r)=>{await new Promise(s=>setTimeout(s,sr));const n=ze.hallTemplates.findIndex(s=>s.id===e);if(n===-1)return Promise.resolve(null);const a={...ze.hallTemplates[n],...t};return ze.hallTemplates[n]=a,Promise.resolve(a)},_S=async(e,t,r)=>{await new Promise(a=>setTimeout(a,sr));const n=ze.hallTemplates.length;return ze.hallTemplates=ze.hallTemplates.filter(a=>a.id!==e),Promise.resolve(ze.hallTemplates.length<n)},TH=async e=>{await new Promise(r=>setTimeout(r,sr));const t=ze.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(ze.studentSetTemplates.filter(r=>r.adminId===t.adminId))},SH=async e=>(await new Promise(t=>setTimeout(t,sr)),Promise.resolve(ze.studentSetTemplates.filter(t=>t.adminId===e))),vp=async(e,t)=>{await new Promise(s=>setTimeout(s,sr));const r=await Fu(t);if(!r)throw new Error("Creator not found.");const n=r.role===lt.ADMIN?r.id:r.adminId,a={...e,id:`settemplate${Date.now()}`,createdBy:t,adminId:n};return ze.studentSetTemplates=[...ze.studentSetTemplates,a],Promise.resolve(a)},_H=async(e,t,r)=>{await new Promise(s=>setTimeout(s,sr));const n=ze.studentSetTemplates.findIndex(s=>s.id===e);if(n===-1)return Promise.resolve(null);const a={...ze.studentSetTemplates[n],...t};return ze.studentSetTemplates[n]=a,Promise.resolve(a)},bS=async(e,t,r)=>{await new Promise(a=>setTimeout(a,sr));const n=ze.studentSetTemplates.length;return ze.studentSetTemplates=ze.studentSetTemplates.filter(a=>a.id!==e),Promise.resolve(ze.studentSetTemplates.length<n)},FS=e=>{const t=[];return e.forEach(r=>{if(r.students&&r.students.length>0)r.students.forEach((n,a)=>t.push({id:n,setId:r.id,setNumber:a+1}));else{const n=/^\d+$/.test(r.subject)?r.subject:"999",a=Math.max(2,r.studentCount.toString().length);for(let s=0;s<r.studentCount;s++){const i=(s+1).toString().padStart(a,"0");t.push({id:`${n}${i}`,setId:r.id,setNumber:s+1})}}}),t},wp=async e=>{var f,d;const{halls:t,studentSets:r,seatingType:n="normal"}=e,a=FS(r),s=new Map,i={};r.forEach(p=>{i[p.id]=a.filter(x=>x.setId===p.id)});for(const p of t){const x={},y=p.layout.filter(_=>_.type!=="faculty").sort((_,N)=>{var U;return(((U=p.constraints)==null?void 0:U.arrangement)||"horizontal")==="vertical"?_.col!==N.col?_.col-N.col:_.row-N.row:_.row!==N.row?_.row-N.row:_.col-N.col}),C=((f=p.constraints)==null?void 0:f.type)==="advanced"?p.constraints.allowedSetIds:Object.keys(i),E=_=>{var N;if(!C.includes(_)||i[_].length===0)return!1;if(((N=p.constraints)==null?void 0:N.type)==="advanced"&&p.constraints.setLimits){const I=p.constraints.setLimits[_],U=x[_]||0;if(I!==void 0&&U>=I)return!1}return!0},T=(d=p.constraints)==null?void 0:d.allocation;let S=0,F=0;for(const _ of y){const N=C.filter(I=>E(I));if(N.length===0)break;if(n==="fair"&&N.length===1){if(F>0){F--;continue}const I=N[0],U=i[I].shift();s.set(`${p.id}-${_.row}-${_.col}`,U),x[I]=(x[I]||0)+1,F=1}else{let I;if(T!=null&&T.enabled){let U=0;T.strategy==="linear"?U=T.linearDirection==="vertical"?_.col:_.row:T.strategy==="diagonal"&&(U=_.row+_.col);const k=N[U%N.length];if(E(k))I=i[k].shift(),I&&(x[k]=(x[k]||0)+1);else{let G=0;for(;!I&&G<N.length;){const M=N[(U+G)%N.length];E(M)&&(I=i[M].shift(),I&&(x[M]=(x[M]||0)+1)),G++}}}else{let U=0;for(;!I&&U<N.length;){const k=N[S%N.length];E(k)&&(I=i[k].shift(),I&&(x[k]=(x[k]||0)+1)),S++,U++}}if(I)s.set(`${p.id}-${_.row}-${_.col}`,I);else break}}}const l=Object.values(i).flat();if(l.length>0)return n==="fair"?{plan:null,message:"Not enough seats for fair seating with these constraints."}:{plan:null,message:`Failed to assign all students. ${l.length} students remain unplaced due to strict hall constraints.`};const u={};return t.forEach(p=>{const x=Math.max(-1,...p.layout.map(E=>E.row)),y=Math.max(-1,...p.layout.map(E=>E.col)),C=Array.from({length:x+1},()=>Array(y+1).fill(null));p.layout.forEach(E=>{const T=s.get(`${p.id}-${E.row}-${E.col}`);C[E.row][E.col]={...E,hallId:p.id,...T&&{student:T}}}),u[p.id]=C}),{plan:u,message:"Classic seating plan generated successfully!"}},yp=async e=>{const{halls:t,studentSets:r,rules:n,seatingType:a,editorMode:s}=e,i=FS(r),l=t.flatMap(x=>x.layout.filter(y=>y.type!=="faculty"));if(a!=="fair"&&i.length>l.length)return{plan:null,message:`Not enough seats. Required: ${i.length}, Available: ${l.length}.`};const u={halls:t.map(x=>({id:x.id,name:x.name,seats:x.layout.map(y=>({row:y.row,col:y.col,type:y.type})),constraints:x.constraints})),studentSets:r.map(x=>({id:x.id,subject:x.subject,students:i.filter(y=>y.setId===x.id).map(y=>y.id)}))};let f=a==="fair"?"**CRITICAL: FAIR SEATING MODE** Students from same set should be separated. Avoid placing same subjects adjacent.":"**CRITICAL: NORMAL SEATING MODE** Fill seats efficiently.",d=s==="ai-advanced"||s==="advanced"?`**STRICT HARD CONSTRAINTS** Follow the 'constraints' field for each hall in JSON. 
           If 'type' is 'advanced', ONLY students from 'allowedSetIds' can enter. 
           If 'setLimits' is present, DO NOT exceed the specified maximum number of students for that set in that specific hall.
           If 'allocation' is present and 'enabled' is true:
             - If 'strategy' is 'linear': align students of the same set along the 'linearDirection' (horizontal=rows, vertical=columns).
             - If 'strategy' is 'diagonal': place students in an alternating zigzag pattern so no straight linear alignment of the same set is formed.
           If a hall limit for a subject is reached, that student MUST be placed in a subsequent hall.`:"";const p=`Assistant task: Assign every student to a unique and valid seat based on constraints.
    Return a list of assignments.
    [JSON Data: ${JSON.stringify(u)}] 
    [Rules: ${f} ${d}] 
    [User Custom Instructions: ${n}]`;try{const y=await new CS({apiKey:"AIzaSyB2YME9uf4GJxT3nNgnTv_NrzP2g_QL5EA"}).models.generateContent({model:"gemini-3-flash-preview",contents:p,config:{responseMimeType:"application/json",responseSchema:{type:ln.OBJECT,properties:{assignments:{type:ln.ARRAY,items:{type:ln.OBJECT,properties:{studentId:{type:ln.STRING},hallId:{type:ln.STRING},row:{type:ln.INTEGER},col:{type:ln.INTEGER}},required:["studentId","hallId","row","col"]}}},required:["assignments"]}}}),E=JSON.parse(y.text).assignments;if(E.length!==i.length)return{plan:null,message:`AI Error: Expected ${i.length} assignments, but got ${E.length}. Try refreshing or adjusting hall limits.`};const T=new Map;E.forEach(F=>{const _=i.find(N=>N.id===F.studentId);_&&T.set(`${F.hallId}-${F.row}-${F.col}`,_)});const S={};return t.forEach(F=>{const _=Math.max(-1,...F.layout.map(U=>U.row)),N=Math.max(-1,...F.layout.map(U=>U.col)),I=Array.from({length:_+1},()=>Array(N+1).fill(null));F.layout.forEach(U=>{const k=T.get(`${F.id}-${U.row}-${U.col}`);I[U.row][U.col]={...U,hallId:F.id,...k&&{student:k}}}),S[F.id]=I}),{plan:S,message:"AI-powered seating plan generated successfully!"}}catch(x){return{plan:null,message:`AI Communication Error: ${x.message}`}}},bH=async(e,t)=>{const r=new CS({apiKey:"AIzaSyB2YME9uf4GJxT3nNgnTv_NrzP2g_QL5EA"}),n="Expert image analysis...";try{const a=await r.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:t,data:e}},{text:n}]},config:{responseMimeType:"application/json",responseSchema:{type:ln.OBJECT,properties:{rows:{type:ln.INTEGER},cols:{type:ln.INTEGER},matrix:{type:ln.ARRAY,items:{type:ln.STRING}}},required:["rows","cols","matrix"]}}}),i=JSON.parse(a.text).matrix;if(!i||i.length===0)return null;const l=i.length,u=Math.max(...i.map(d=>d.length)),f=[];for(let d=0;d<l;d++){const p=i[d];for(let x=0;x<p.length;x++)p[x]==="1"&&f.push({id:`seat-${d}-${x}-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,row:d,col:x,type:"standard"})}return{layout:f,rows:l,cols:u}}catch{return null}},FH=async(e,t)=>{const r=await cH(e);return r&&r.password===t?r.role===lt.SUPER_ADMIN?r:((r.role===lt.ADMIN||r.role===lt.TEACHER)&&!r.permissionGranted&&console.warn(`${r.role} ${r.name} login attempt failed: Permission not granted.`),Promise.resolve(r)):Promise.resolve(null)},UH=(e,t,r,n)=>uH(e,t,r,n),kH=(e,t,r,n)=>fH(e,t,r,n),NH=(e,t)=>{if(/^\d+$/.test(e)&&e.length>0){const r={id:e,name:`Student ${e}`,email:"",role:lt.STUDENT,registerNumber:e,adminId:t};return Promise.resolve(r)}return Promise.resolve(null)},IH=()=>(console.log("User logged out."),Promise.resolve()),US=W.createContext(void 0),QH=({children:e})=>{const[t,r]=W.useState(()=>{const f=localStorage.getItem("user");return f?JSON.parse(f):null}),n=async(f,d)=>{const p=await FH(f,d);return p&&(r(p),localStorage.setItem("user",JSON.stringify(p))),p},a=async(f,d,p,x)=>await kH(f,d,p,x),s=async(f,d,p,x)=>await UH(f,d,p,x),i=async(f,d)=>{const p=await NH(f,d);return p&&(r(p),localStorage.setItem("user",JSON.stringify(p))),p},l=()=>{IH(),r(null),localStorage.removeItem("user")},u=!!t;return h.jsx(US.Provider,{value:{user:t,isAuthenticated:u,login:n,logout:l,loginStudent:i,registerTeacher:a,registerAdmin:s},children:e})},ci=()=>{const e=W.useContext(US);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},kS=W.createContext(void 0),RH=({children:e})=>{const[t,r]=W.useState(()=>{const a=localStorage.getItem("theme");return a||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});W.useEffect(()=>{const a=window.document.documentElement;a.classList.remove("dark","black","lavender","lightblue","limegreen","lightred","lightyellow","lightpink","lightindigo"),t==="dark"?a.classList.add("dark"):t==="black"?a.classList.add("dark","black"):t==="lavender"?a.classList.add("lavender"):t==="lightblue"?a.classList.add("lightblue"):t==="limegreen"?a.classList.add("limegreen"):t==="lightred"?a.classList.add("lightred"):t==="lightyellow"?a.classList.add("lightyellow"):t==="lightpink"?a.classList.add("lightpink"):t==="lightindigo"&&a.classList.add("lightindigo"),localStorage.setItem("theme",t)},[t]);const n=()=>{r(a=>a==="light"?"dark":a==="dark"?"black":a==="black"?"lavender":a==="lavender"?"lightblue":a==="lightblue"?"limegreen":a==="limegreen"?"lightred":a==="lightred"?"lightyellow":a==="lightyellow"?"lightpink":a==="lightpink"?"lightindigo":"light")};return h.jsx(kS.Provider,{value:{theme:t,toggleTheme:n},children:e})},DH=()=>{const e=W.useContext(kS);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},jt=W.forwardRef(({children:e,className:t="",...r},n)=>h.jsx("div",{ref:n,className:`bg-white dark:bg-slate-800 rounded-xl shadow-md dark:shadow-none dark:border dark:border-slate-700 overflow-hidden p-6 sm:p-8 ${t}`,...r,children:e}));jt.displayName="Card";const MH=({className:e})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),LH=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),Ut=({label:e,id:t,containerClassName:r="",type:n="text",inputSize:a="md",...s})=>{const[i,l]=W.useState(!1),u=n==="password",f=()=>{l(!i)},d=u?i?"text":"password":n,p={sm:"px-2 py-1 text-sm",md:"px-3 py-2",lg:"px-4 py-3 text-lg"};return h.jsxs("div",{className:r,children:[e&&h.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:e}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{id:t,type:d,className:`w-full ${p[a]} border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:placeholder-slate-400 dark:focus:ring-violet-400 dark:focus:border-violet-400 ${u?"pr-10":""}`,...s}),u&&h.jsx("button",{type:"button",onClick:f,className:"absolute inset-y-0 right-0 px-3 flex items-center text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors focus:outline-none",tabIndex:-1,children:i?h.jsx(LH,{className:"h-5 w-5"}):h.jsx(MH,{className:"h-5 w-5"})})]})]})},tt=({children:e,variant:t="primary",size:r="md",className:n="",type:a="button",...s})=>{const i="font-bold rounded-lg transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:scale-100 flex items-center justify-center",l={sm:"py-1 px-3 text-sm",md:"py-2 px-4",lg:"py-3 px-6 text-lg"},u={primary:"bg-violet-600 text-white hover:bg-violet-700 shadow-md",secondary:"bg-slate-200 text-slate-800 hover:bg-slate-300 dark:bg-slate-700 dark:text-slate-200 dark:hover:bg-slate-600",danger:"bg-red-500 text-white hover:bg-red-600 shadow-md",outline:"border-2 border-slate-300 text-slate-600 hover:bg-slate-50 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-800"};return h.jsx("button",{type:a,className:`${i} ${l[r]} ${u[t]} ${n}`,...s,children:e})},NS=({className:e="h-8 w-8",...t})=>h.jsx("img",{src:"https://img.icons8.com/plasticine/100/graduation-cap.png",alt:"Smart Exam Planner Logo",className:`object-contain ${e}`,...t}),HH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),OH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),PH=()=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"}),h.jsx("path",{d:"M12 3a9 9 0 000 18V3z",fill:"currentColor"})]}),GH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),VH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),KH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 21.75H18.75m-13.5 0v-8.25h13.5v8.25m-13.5 0H3.375c-.621 0-1.125-.504-1.125-1.125V9.375c0-.621.504-1.125 1.125-1.125h1.5c.621 0 1.125.504 1.125 1.125v11.25m0-11.25h10.5m0 0v-1.125c0-.621-.504-1.125-1.125-1.125h-7.5c-.621 0-1.125.504-1.125 1.125V9.375m10.5 0h1.875c.621 0 1.125-.504 1.125-1.125V6.375c0-.621-.504-1.125-1.125-1.125h-1.5c-.621 0-1.125.504-1.125 1.125V9.375"})}),jH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),zH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),XH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),WH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),IS=()=>{const{theme:e,toggleTheme:t}=DH();return h.jsxs("button",{onClick:t,className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500 dark:focus:ring-offset-slate-800 transition-colors","aria-label":"Toggle theme",children:[e==="light"&&h.jsx(OH,{}),e==="dark"&&h.jsx(PH,{}),e==="black"&&h.jsx(GH,{}),e==="lavender"&&h.jsx(VH,{}),e==="lightblue"&&h.jsx(KH,{}),e==="limegreen"&&h.jsx(jH,{}),e==="lightred"&&h.jsx(XH,{}),e==="lightyellow"&&h.jsx(zH,{}),e==="lightpink"&&h.jsx(WH,{}),e==="lightindigo"&&h.jsx(HH,{})]})},JH=()=>{const[e,t]=W.useState(""),[r,n]=W.useState(""),[a,s]=W.useState(""),[i,l]=W.useState("admin"),[u,f]=W.useState("login"),[d,p]=W.useState(""),[x,y]=W.useState(""),[C,E]=W.useState(""),[T,S]=W.useState(""),[F,_]=W.useState(""),[N,I]=W.useState([]),[U,k]=W.useState(""),[G,M]=W.useState(""),[ee,re]=W.useState(1),[q,se]=W.useState(""),[Te,Be]=W.useState(""),[Z,ie]=W.useState(!1),{login:Qe,loginStudent:ae,registerTeacher:Le,registerAdmin:Y}=ci(),Q=Ud();W.useEffect(()=>{(async()=>{try{const Re=await lH();I(Re)}catch(Re){console.error("Failed to fetch institutions:",Re)}})()},[]);const K=async R=>{R.preventDefault(),ie(!0),se(""),Be(""),setTimeout(()=>{ie(!1),re(2)},500)},P=async R=>{if(R.preventDefault(),ie(!0),se(""),Be(""),G!=="123456"){se("Invalid OTP. Please use 123456 for this demo."),ie(!1);return}const Re=await Qe(e,r);if(ie(!1),Re){if(Re.role===lt.SUPER_ADMIN){Q("/super-admin");return}i==="admin"?Re.role===lt.ADMIN?Re.permissionGranted?Q("/admin"):(se("Account Pending: A Super Admin must approve your institutional registration."),re(1)):(se("This account does not have admin privileges."),re(1)):i==="teacher"&&(Re.role===lt.TEACHER?Re.permissionGranted?Q("/teacher"):(se("Account Pending: Your institutional administrator must grant you permission."),re(1)):(se("This account is not a teacher account."),re(1)))}else se("Invalid credentials. Please try again."),re(1)},z=async R=>{if(R.preventDefault(),ie(!0),se(""),Be(""),!d||!e||!x||!T){se("Please fill in all fields."),ie(!1);return}if(x!==C){se("Passwords do not match."),ie(!1);return}if(x.length<6){se("Password must be at least 6 characters long."),ie(!1);return}const Re=await Y(d,e,x,T);ie(!1),Re?(Be("Registration request sent! A Super Admin will review and approve your institution shortly."),f("login"),p(""),t(""),y(""),E(""),S("")):se("An account with this email already exists.")},ce=async R=>{if(R.preventDefault(),ie(!0),se(""),Be(""),!d||!e||!x||!F){se("Please fill in all fields."),ie(!1);return}if(x!==C){se("Passwords do not match."),ie(!1);return}if(x.length<6){se("Password must be at least 6 characters long."),ie(!1);return}const Re=await Le(d,e,x,F);ie(!1),Re?(Be("Account created. Your institution admin must grant permission before you can log in."),f("login"),p(""),t(""),y(""),E(""),_("")):se("Registration failed. Please check your details.")},Ce=async R=>{if(R.preventDefault(),ie(!0),se(""),!U){se("Please select your institution."),ie(!1);return}const Re=await ae(a,U);ie(!1),Re?Q("/student"):se("Please enter a valid, numeric Register Number.")},he=R=>{l(R),se(""),Be(""),re(1),t(""),n(""),M(""),s(""),f("login"),p(""),y(""),E(""),S(""),_(""),k("")},de=()=>h.jsx(h.Fragment,{children:ee===1?h.jsxs("form",{onSubmit:K,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6 text-rose-600 dark:text-rose-400",children:"System Oversight"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Master Email",id:"email",type:"email",value:e,onChange:R=>t(R.target.value),required:!0,placeholder:"super@exam.com"}),h.jsx(Ut,{label:"Master Password",id:"password",type:"password",value:r,onChange:R=>n(R.target.value),required:!0,placeholder:"Enter master password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6 bg-rose-600 hover:bg-rose-700",disabled:Z,children:Z?"Accessing...":"Verify Identity"})]}):h.jsxs("form",{onSubmit:P,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-2",children:"Master Verification"}),h.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:"Enter secure 6-digit bypass code."}),h.jsx("div",{className:"space-y-4",children:h.jsx(Ut,{label:"Security Code",id:"otp",type:"text",value:G,onChange:R=>M(R.target.value),required:!0,placeholder:"123456"})}),h.jsx(tt,{type:"submit",className:"w-full mt-6 bg-rose-600 hover:bg-rose-700",disabled:Z,children:Z?"Authenticating...":"Enter Command Center"}),h.jsx(tt,{variant:"secondary",onClick:()=>{re(1),se("")},className:"w-full mt-2",children:"Back"})]})}),ne=()=>u==="register"?h.jsxs("form",{onSubmit:z,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Institution Registration"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Full Name",id:"registerName",type:"text",value:d,onChange:R=>p(R.target.value),required:!0,placeholder:"e.g., Jane Doe"}),h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:R=>t(R.target.value),required:!0,placeholder:"e.g., admin@exam.com"}),h.jsx(Ut,{label:"Institution / Organization Name",id:"registerInstitution",type:"text",value:T,onChange:R=>S(R.target.value),required:!0,placeholder:"e.g., Global Tech University"}),h.jsx(Ut,{label:"Password",id:"registerPassword",type:"password",value:x,onChange:R=>y(R.target.value),required:!0,placeholder:"Minimum 6 characters"}),h.jsx(Ut,{label:"Confirm Password",id:"confirmPassword",type:"password",value:C,onChange:R=>E(R.target.value),required:!0,placeholder:"Re-enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z,children:Z?"Sending Request...":"Register Institution"}),h.jsx(tt,{variant:"secondary",onClick:()=>{f("login"),se(""),Be("")},className:"w-full mt-2",children:"Back to Login"})]}):h.jsx(h.Fragment,{children:ee===1?h.jsxs("form",{onSubmit:K,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Staff Login"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:R=>t(R.target.value),required:!0,placeholder:"e.g., admin@exam.com"}),h.jsx(Ut,{label:"Password",id:"password",type:"password",value:r,onChange:R=>n(R.target.value),required:!0,placeholder:"Enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z,children:Z?"Loading...":"Continue"}),h.jsxs("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400 mt-4",children:["New institution?"," ",h.jsx("button",{type:"button",onClick:()=>{f("register"),se("")},className:"font-bold text-violet-600 hover:text-violet-500 dark:text-violet-400 dark:hover:text-violet-300 focus:outline-none",children:"Register here"})]})]}):h.jsxs("form",{onSubmit:P,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-2",children:"Verification"}),h.jsxs("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:['An OTP has been "sent" to your email. ',h.jsx("br",{}),"(Hint: use ",h.jsx("strong",{children:"123456"}),")"]}),h.jsx("div",{className:"space-y-4",children:h.jsx(Ut,{label:"One-Time Password",id:"otp",type:"text",value:G,onChange:R=>M(R.target.value),required:!0,placeholder:"Enter 6-digit code"})}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z,children:Z?"Verifying...":"Verify & Login"}),h.jsx(tt,{variant:"secondary",onClick:()=>{re(1),se("")},className:"w-full mt-2",children:"Back"})]})}),Ee=()=>u==="register"?h.jsxs("form",{onSubmit:ce,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Teacher Registration"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Full Name",id:"teacherName",type:"text",value:d,onChange:R=>p(R.target.value),required:!0,placeholder:"e.g., Dr. Evelyn Reed"}),h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:R=>t(R.target.value),required:!0,placeholder:"e.g., teacher@exam.com"}),h.jsx(Ut,{label:"Admin ID or Institution Name",id:"adminIdentifier",type:"text",value:F,onChange:R=>_(R.target.value),required:!0,placeholder:"Enter institution name"}),h.jsx(Ut,{label:"Password",id:"teacherPassword",type:"password",value:x,onChange:R=>y(R.target.value),required:!0,placeholder:"Minimum 6 characters"}),h.jsx(Ut,{label:"Confirm Password",id:"confirmPassword",type:"password",value:C,onChange:R=>E(R.target.value),required:!0,placeholder:"Re-enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z,children:Z?"Creating...":"Create Account"}),h.jsx(tt,{variant:"secondary",onClick:()=>{f("login"),se(""),Be("")},className:"w-full mt-2",children:"Back to Login"})]}):h.jsx(h.Fragment,{children:ee===1?h.jsxs("form",{onSubmit:K,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Teacher Login"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:R=>t(R.target.value),required:!0,placeholder:"e.g., teacher1@exam.com"}),h.jsx(Ut,{label:"Password",id:"password",type:"password",value:r,onChange:R=>n(R.target.value),required:!0,placeholder:"Enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z,children:Z?"Loading...":"Continue"}),h.jsxs("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400 mt-4",children:["Don't have an account?"," ",h.jsx("button",{type:"button",onClick:()=>{f("register"),se("")},className:"font-bold text-violet-600 hover:text-violet-500 dark:text-violet-400 dark:hover:text-violet-300 focus:outline-none",children:"Create one"})]})]}):h.jsxs("form",{onSubmit:P,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-2",children:"Verification"}),h.jsxs("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:['An OTP has been "sent" to your email. ',h.jsx("br",{}),"(Hint: use ",h.jsx("strong",{children:"123456"}),")"]}),h.jsx("div",{className:"space-y-4",children:h.jsx(Ut,{label:"One-Time Password",id:"otp",type:"text",value:G,onChange:R=>M(R.target.value),required:!0,placeholder:"Enter 6-digit code"})}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z,children:Z?"Verifying...":"Verify & Login"}),h.jsx(tt,{variant:"secondary",onClick:()=>{re(1),se("")},className:"w-full mt-2",children:"Back"})]})});return h.jsxs("div",{className:"min-h-screen flex flex-col justify-center items-center p-4 relative bg-slate-50 dark:bg-slate-900",children:[h.jsx("div",{className:"absolute top-4 right-4",children:h.jsx(IS,{})}),h.jsxs("div",{className:"text-center mb-8 flex flex-col items-center gap-4",children:[h.jsx(NS,{className:"h-16 w-16"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-black text-violet-700 dark:text-violet-400",children:"Smart Exam Planner"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 font-medium",children:"Global Examination Logistics Platform"})]})]}),h.jsxs(jt,{className:"w-full max-w-md shadow-2xl overflow-visible",children:[h.jsxs("div",{className:"flex flex-wrap justify-center border-b border-slate-200 dark:border-slate-700 mb-6",children:[h.jsx("button",{onClick:()=>he("admin"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${i==="admin"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 hover:text-slate-700"}`,children:"Admin"}),h.jsx("button",{onClick:()=>he("teacher"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${i==="teacher"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 hover:text-slate-700"}`,children:"Teacher"}),h.jsx("button",{onClick:()=>he("student"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${i==="student"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 hover:text-slate-700"}`,children:"Student"}),h.jsx("button",{onClick:()=>he("super"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${i==="super"?"text-rose-600 dark:text-rose-400 border-b-2 border-rose-600 dark:border-rose-400":"text-slate-400 hover:text-rose-500"}`,children:"Super"})]}),Te&&h.jsx("p",{className:"text-green-600 bg-green-50 dark:text-green-400 dark:bg-green-500/10 p-3 rounded-xl text-sm mb-4 text-center font-medium border border-green-100 dark:border-green-900/30",children:Te}),q&&h.jsx("p",{className:"text-red-600 bg-red-100 dark:text-red-300 dark:bg-red-500/20 p-3 rounded-xl text-sm mb-4 text-center font-medium border border-red-100 dark:border-red-900/30",children:q}),i==="super"&&de(),i==="admin"&&ne(),i==="teacher"&&Ee(),i==="student"&&h.jsxs("form",{onSubmit:Ce,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Student Login"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"institution-select",className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Institution"}),h.jsxs("select",{id:"institution-select",value:U,onChange:R=>k(R.target.value),required:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 font-medium",children:[h.jsx("option",{value:"",disabled:!0,children:"Select your institution"}),N.map(R=>h.jsx("option",{value:R.id,children:R.name},R.id))]})]}),h.jsx(Ut,{label:"Register Number",id:"registerNumber",type:"text",value:a,onChange:R=>s(R.target.value),required:!0,placeholder:"e.g., 101001"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:Z||!U,children:Z?"Logging In...":"Login"})]})]}),i==="super"&&h.jsxs("div",{className:"mt-8 p-4 bg-rose-50 dark:bg-rose-900/10 border border-rose-100 dark:border-rose-900/30 rounded-xl max-w-sm text-center",children:[h.jsx("p",{className:"text-xs font-bold text-rose-700 dark:text-rose-300 uppercase tracking-widest mb-1",children:"Restricted Access"}),h.jsx("p",{className:"text-[10px] text-rose-600/70 dark:text-rose-400/70",children:"This area is reserved for the primary system owner only. Unauthorized access attempts are logged."})]})]})},YH=({user:e,isOpen:t,onClose:r})=>{const[n,a]=W.useState(""),[s,i]=W.useState(!1);if(W.useEffect(()=>{t&&(i(!0),e.role===lt.ADMIN?(a(e.institutionName||"N/A"),i(!1)):e.role===lt.TEACHER&&e.adminId?Fu(e.adminId).then(u=>{a(u?u.institutionName||"N/A":"Institution not found"),i(!1)}):(a("N/A"),i(!1)))},[e,t]),!t)return null;const l=u=>{switch(u){case lt.ADMIN:return"Admin";case lt.TEACHER:return"Teacher";case lt.STUDENT:return"Student";default:return""}};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:r,children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md",onClick:u=>u.stopPropagation(),children:[h.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-slate-800 dark:text-slate-200",children:"User Profile"}),h.jsx(jt,{children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Username"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:e.name})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Email ID"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300 break-all",children:e.email})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Institution / Organization"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:s?"Loading...":n})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Role"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:l(e.role)})]})]})}),h.jsx("div",{className:"mt-6 text-right",children:h.jsx(tt,{onClick:r,variant:"secondary",children:"Close"})})]})})},qH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),$H=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),bA=()=>{const{user:e,logout:t}=ci(),r=Ud(),[n,a]=W.useState(!1),s=()=>{t(),r("/login")},i=l=>{switch(l){case lt.SUPER_ADMIN:return"Super Admin";case lt.ADMIN:return"Admin";case lt.TEACHER:return"Teacher";case lt.STUDENT:return"Student";default:return""}};return h.jsxs(h.Fragment,{children:[h.jsx("header",{className:"sticky top-0 z-50 w-full bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm shadow-md dark:shadow-none dark:border-b dark:border-slate-700",children:h.jsxs("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(NS,{className:"h-9 w-9"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-violet-700 dark:text-violet-400",children:"Smart Exam Planner"}),e&&h.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Welcome, ",e.name," (",i(e.role),")"]})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[e&&h.jsxs(h.Fragment,{children:[(e.role===lt.SUPER_ADMIN||e.role===lt.ADMIN||e.role===lt.TEACHER)&&h.jsxs("button",{onClick:()=>a(!0),className:"hidden sm:flex items-center text-slate-600 hover:text-violet-700 dark:text-slate-300 dark:hover:text-violet-400 transition","aria-label":"View Profile",children:[h.jsx($H,{}),h.jsx("span",{className:"hidden lg:inline",children:"Profile"})]}),h.jsxs("button",{onClick:s,className:"flex items-center text-slate-600 hover:text-violet-700 dark:text-slate-300 dark:hover:text-violet-400 transition","aria-label":"Logout",children:[h.jsx(qH,{}),h.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}),h.jsx(IS,{})]})]})}),e&&(e.role===lt.SUPER_ADMIN||e.role===lt.ADMIN||e.role===lt.TEACHER)&&h.jsx(YH,{user:e,isOpen:n,onClose:()=>a(!1)})]})},zC=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),XC=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),WC=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),ZH=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e6=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),mm=({title:e,value:t,icon:r,colorClass:n})=>h.jsxs("div",{className:`p-6 rounded-xl border shadow-sm flex items-center justify-between transition-all hover:scale-[1.02] ${n}`,children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold opacity-80 uppercase tracking-widest",children:e}),h.jsx("p",{className:"text-3xl font-black mt-2",children:t})]}),h.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:r})]}),t6=()=>{const{user:e}=ci(),[t,r]=W.useState([]),[n,a]=W.useState([]),[s,i]=W.useState(!0),[l,u]=W.useState(""),[f,d]=W.useState("institutes"),p=W.useCallback(async()=>{i(!0);try{const[T,S]=await Promise.all([sH(),ES("")]);r(T),a(S)}catch(T){console.error("Failed to fetch dashboard data:",T),alert("Error loading system data. Please try again.")}finally{i(!1)}},[]);W.useEffect(()=>{p()},[p]);const x=async(T,S)=>{if(window.confirm(`Grant administrator access to "${S}"? This will allow the admin to log in and manage their institution.`)){i(!0);try{await iH(T)?(alert(`SUCCESS: Access granted for "${S}".`),await p()):(alert("ERROR: Admin record not found."),i(!1))}catch(F){console.error("Grant Access Error:",F),alert("An unexpected error occurred while granting access."),i(!1)}}},y=async(T,S)=>{const F=`CRITICAL WARNING: You are about to permanently delete "${S}". 
This will wipe all associated data:
- Admin account
- All Teacher accounts
- All Student sessions
- All Exam schedules
- All Hall layouts
- All Audit logs

THIS ACTION CANNOT BE UNDONE. Type 'DELETE' to proceed.`,_=window.prompt(F);if(_==="DELETE"){i(!0);try{await oH(T)?(alert(`SUCCESS: Institution "${S}" and all associated data wiped.`),await p()):(alert("ERROR: Failed to delete institution."),i(!1))}catch(N){console.error("Delete Institution Error:",N),alert("An error occurred during the data wipe process."),i(!1)}}else _!==null&&alert("Action cancelled. Input did not match 'DELETE'.")},C=t.filter(T=>{var S;return((S=T.institutionName)==null?void 0:S.toLowerCase().includes(l.toLowerCase()))||T.name.toLowerCase().includes(l.toLowerCase())||T.email.toLowerCase().includes(l.toLowerCase())}),E=t.filter(T=>!T.permissionGranted);return h.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-black text-slate-800 dark:text-slate-100",children:"Command Center"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Global management of institutional infrastructures."})]})}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[h.jsx(mm,{title:"Institutions",value:t.length,icon:h.jsx(XC,{className:"h-6 w-6 text-violet-600 dark:text-violet-300"}),colorClass:"bg-violet-50 border-violet-100 text-violet-900 dark:bg-violet-900/20 dark:border-violet-900/50 dark:text-violet-100"}),h.jsx(mm,{title:"Pending Requests",value:E.length,icon:h.jsx(WC,{className:"h-6 w-6 text-amber-600 dark:text-amber-300"}),colorClass:"bg-amber-50 border-amber-100 text-amber-900 dark:bg-amber-900/20 dark:border-amber-900/50 dark:text-amber-100"}),h.jsx(mm,{title:"System Uptime",value:"99.9%",icon:h.jsx(ZH,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-300"}),colorClass:"bg-emerald-50 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-900/50 dark:text-emerald-100"})]}),h.jsx("div",{className:"mb-6 border-b border-slate-200 dark:border-slate-700",children:h.jsxs("nav",{className:"-mb-px flex space-x-8",children:[h.jsx("button",{onClick:()=>d("institutes"),className:`py-4 px-1 border-b-2 font-bold text-sm transition-colors ${f==="institutes"?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:"Institute Directory"}),h.jsx("button",{onClick:()=>d("audit"),className:`py-4 px-1 border-b-2 font-bold text-sm transition-colors ${f==="audit"?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:"Global Audit Logs"})]})}),f==="institutes"&&h.jsxs("div",{className:"space-y-8",children:[E.length>0&&h.jsxs("div",{className:"bg-amber-100/50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-800 rounded-2xl p-6",children:[h.jsxs("h3",{className:"text-lg font-black text-amber-800 dark:text-amber-200 mb-4 flex items-center gap-2",children:[h.jsx(WC,{className:"h-5 w-5"})," Urgent: Pending Approvals"]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(T=>h.jsxs(jt,{className:"!p-5 border-amber-200 shadow-sm transition-all hover:shadow-md",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("p",{className:"font-black text-slate-800 dark:text-slate-100 text-lg",children:T.institutionName}),h.jsxs("p",{className:"text-sm font-medium text-slate-500 mt-1",children:["Admin: ",T.name]}),h.jsx("p",{className:"text-xs text-slate-400 font-mono mt-1 truncate",children:T.email})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(tt,{size:"sm",className:"flex-1 !bg-emerald-600 hover:!bg-emerald-700 !text-white",onClick:()=>x(T.id,T.institutionName||"Unknown"),disabled:s,children:s?"Wait...":"Approve Access"}),h.jsx("button",{onClick:()=>y(T.id,T.institutionName),className:"p-2 text-slate-400 hover:text-red-500 transition-colors disabled:opacity-50",title:"Reject & Delete",disabled:s,children:h.jsx(zC,{})})]})]},T.id))})]}),h.jsxs(jt,{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[h.jsx("h3",{className:"text-xl font-black text-slate-800 dark:text-slate-100",children:"Managed Institutions"}),h.jsx("div",{className:"relative w-full sm:w-72",children:h.jsx(Ut,{placeholder:"Search directory...",value:l,onChange:T=>u(T.target.value),containerClassName:"mb-0"})})]}),s?h.jsx("p",{className:"text-center py-12 text-slate-500",children:"Communicating with global database..."}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.length>0?C.map(T=>h.jsxs("div",{className:"bg-white dark:bg-slate-800/50 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 flex flex-col hover:border-violet-300 dark:hover:border-violet-900 transition-colors group",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsx("div",{className:"p-3 bg-slate-100 dark:bg-slate-700 rounded-xl group-hover:bg-violet-100 dark:group-hover:bg-violet-900/30 transition-colors",children:h.jsx(XC,{className:"h-6 w-6 text-slate-600 dark:text-slate-300"})}),h.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-widest ${T.permissionGranted?"bg-green-100 text-green-700 dark:bg-green-900/30":"bg-amber-100 text-amber-700 dark:bg-amber-900/30"}`,children:T.permissionGranted?"Active":"Pending"})]}),h.jsxs("div",{className:"flex-grow",children:[h.jsx("h4",{className:"text-lg font-black text-slate-800 dark:text-slate-100 mb-1",children:T.institutionName}),h.jsx("p",{className:"text-sm font-bold text-slate-500",children:T.name}),h.jsx("p",{className:"text-xs text-slate-400 mt-3 font-mono",children:T.email})]}),h.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[T.permissionGranted?h.jsxs("div",{className:"text-[10px] font-bold text-slate-400 flex items-center gap-1 uppercase tracking-widest",children:[h.jsx(e6,{className:"h-3 w-3 text-emerald-500"})," Authorized"]}):h.jsx(tt,{size:"sm",onClick:()=>x(T.id,T.institutionName||"Unknown"),disabled:s,children:s?"...":"Approve"}),h.jsxs("button",{onClick:()=>y(T.id,T.institutionName),className:"flex items-center gap-2 text-xs font-black text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 px-3 py-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors disabled:opacity-50",disabled:s,children:[h.jsx(zC,{className:"h-4 w-4"})," Wipe Data"]})]})]},T.id)):h.jsx("p",{className:"col-span-full text-center py-12 text-slate-500 italic",children:"No institutions match your search criteria."})})]})]}),f==="audit"&&h.jsxs(jt,{children:[h.jsx("h3",{className:"text-xl font-black mb-6 text-slate-800 dark:text-slate-100",children:"Global Activity Monitor"}),h.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:n.length>0?n.map(T=>h.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-slate-800/30 border border-slate-100 dark:border-slate-700 flex flex-col sm:flex-row gap-4",children:[h.jsx("div",{className:"flex-shrink-0 flex items-center",children:h.jsx("div",{className:`h-12 w-12 rounded-xl flex items-center justify-center font-black text-white shadow-sm ${T.role===lt.SUPER_ADMIN?"bg-rose-500":T.role===lt.ADMIN?"bg-sky-500":"bg-indigo-500"}`,children:T.actorName.charAt(0)})}),h.jsxs("div",{className:"flex-grow",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsxs("p",{className:"font-black text-slate-800 dark:text-slate-100",children:[T.actorName," ",h.jsxs("span",{className:"text-xs font-bold text-slate-400 ml-1",children:["(",T.role,")"]})]}),h.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-0.5",children:new Date(T.timestamp).toLocaleString()})]}),h.jsx("span",{className:"text-[10px] font-black px-2 py-1 bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg uppercase tracking-widest",children:T.action.replace(/_/g," ")})]}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-2 font-medium",children:T.details})]})]},T.id)):h.jsx("p",{className:"text-center py-12 text-slate-500 italic",children:"No global activity logs available."})})]})]})]})},Js=["bg-sky-200","bg-emerald-200","bg-amber-200","bg-violet-200","bg-rose-200","bg-cyan-200","bg-lime-200","bg-orange-200","bg-purple-200","bg-pink-200"],r6=e=>{switch(e){case"accessible":return{icon:h.jsx("span",{title:"Accessible Seating",children:""}),baseBg:"bg-blue-200 dark:bg-blue-600"};case"faculty":return{icon:h.jsx("span",{title:"Faculty/Invigilator Seat",children:""}),baseBg:"bg-yellow-200 dark:bg-yellow-600"};case"standard":default:return{icon:null,baseBg:"bg-slate-200 dark:bg-slate-600"}}},ou=({hall:e,plan:t,studentSets:r,highlightSeat:n,seatDimensions:a})=>{const s=t[e.id];if(!s)return h.jsxs("p",{children:["Seating plan for ",e.name," not available."]});const i=r.reduce((T,S,F)=>(T[S.id]=Js[F%Js.length],T),{}),l=s.reduce((T,S)=>Math.max(T,S.length),0),u=e.frontDirection||"top",f={top:"flex-col",bottom:"flex-col-reverse",left:"flex-row",right:"flex-row-reverse"},d=u==="left"||u==="right"?"w-10 flex-shrink-0 flex items-center justify-center py-4":"w-full py-2",p={top:"mb-4",bottom:"mt-4",left:"mr-4",right:"ml-4"},x=u==="left"||u==="right",y=a!=null&&a.width?`${a.width/16}rem`:"5.5rem",C=a!=null&&a.height?`${a.height/16}rem`:"3rem",E=a!=null&&a.fontSize?`${a.fontSize}px`:"0.875rem";return h.jsxs("div",{className:"w-full",children:[h.jsx("h3",{className:"text-xl font-bold mb-6 text-center text-slate-700 dark:text-slate-300",children:e.name}),h.jsxs("div",{className:`flex ${f[u]} items-stretch justify-center w-full`,children:[h.jsx("div",{className:`bg-slate-200 dark:bg-slate-700 rounded-md text-sm font-bold text-slate-600 dark:text-slate-300 shadow-inner flex items-center justify-center ${d} ${p[u]}`,children:h.jsx("span",{style:{writingMode:x?"vertical-rl":"horizontal-tb",transform:x?"rotate(180deg)":"none"},children:"FRONT OF HALL"})}),h.jsx("div",{className:"overflow-x-auto bg-slate-100 dark:bg-slate-800 p-6 rounded-xl flex-grow border border-slate-200 dark:border-slate-700",children:h.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${l}, minmax(${y}, 1fr))`},children:s.map((T,S)=>T.map((F,_)=>{if(!F)return h.jsx("div",{style:{height:C}},`empty-${S}-${_}`);const N=r6(F.type),I=F.student?i[F.student.setId]:N.baseBg,k=n&&F.row===n.row&&F.col===n.col?"ring-4 ring-offset-2 ring-violet-500 dark:ring-violet-400 z-10":"border border-slate-300 dark:border-slate-500 shadow-sm";let G=N.icon;return F.student&&(G=F.student.id),h.jsx("div",{title:F.student?`Seat: R${F.row+1}C${F.col+1} - Student ID: ${F.student.id}`:`${F.type} Seat: R${F.row+1}C${F.col+1}`,className:`w-full rounded-lg flex items-center justify-center text-center font-bold text-slate-800 dark:text-slate-900 transition-all break-all px-2 py-1 ${I} ${k} ${a?"":"h-12 sm:h-14 text-sm"}`,style:{height:a?C:void 0,fontSize:a?E:void 0},children:G},`${F.id}-${S}-${_}`)}).concat(Array.from({length:l-T.length}).map((F,_)=>h.jsx("div",{style:{height:C}},`pad-${S}-${T.length+_}`))))})})]}),h.jsx("div",{className:"mt-6 flex flex-wrap gap-4 justify-center",children:r.map((T,S)=>h.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 px-3 py-1.5 rounded-full border border-slate-200 dark:border-slate-700 shadow-sm",children:[h.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${Js[S%Js.length]}`}),h.jsxs("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:["Set: ",T.subject]})]},T.id))})]})},JC=[{type:"standard",label:"Standard",style:"bg-slate-300 dark:bg-slate-600",icon:null},{type:"accessible",label:"Accessible",style:"bg-blue-300 dark:bg-blue-600",icon:h.jsx("span",{title:"Accessible Seating",children:""})},{type:"faculty",label:"Faculty",style:"bg-yellow-300 dark:bg-yellow-600",icon:h.jsx("span",{title:"Faculty/Invigilator Seat",children:""})}],n6=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),a6=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M6.672 1.911a1 1 0 10-1.932.524l1.822 6.723L1.94 11.23a1 1 0 00.72 1.916h3.417l2.128 6.384a1 1 0 001.902-.619l-1.077-3.23 3.616 1.808a1 1 0 001.378-.868l1.37-7.533a1 1 0 00-1.37-1.171l-7.353 3.16.822-6.166z",clipRule:"evenodd"})}),A6=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),s6=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),Bp=({isOpen:e,onClose:t,onSave:r,initialLayout:n,initialName:a,isTemplateCreationMode:s})=>{const[i,l]=W.useState(n||[]),[u,f]=W.useState(10),[d,p]=W.useState(10),[x,y]=W.useState(null),[C,E]=W.useState(""),[T,S]=W.useState(""),[F,_]=W.useState(!1),[N,I]=W.useState(new Set),[U,k]=W.useState(!1),[G,M]=W.useState([]),[ee,re]=W.useState(-1),q=W.useRef(null);W.useEffect(()=>{let ne=[],Ee=10,R=10;if(n&&n.length>0){ne=n;const Ge=Math.max(9,...n.map(st=>st.row)),Ze=Math.max(9,...n.map(st=>st.col));Ee=Ge+1,R=Ze+1}l(ne),f(Ee),p(R),E(a||""),S(""),I(new Set),M([{seats:ne,rows:Ee,cols:R}]),re(0)},[n,a,e]);const se=W.useCallback((ne,Ee,R)=>{M(Re=>[...Re.slice(0,ee+1),{seats:ne,rows:Ee,cols:R}]),re(Re=>Re+1),l(ne),f(Ee),p(R)},[ee]),Te=W.useCallback(()=>{if(ee>0){const ne=ee-1,Ee=G[ne];l(Ee.seats),f(Ee.rows),p(Ee.cols),re(ne),I(new Set)}},[G,ee]),Be=W.useCallback(()=>{if(ee<G.length-1){const ne=ee+1,Ee=G[ne];l(Ee.seats),f(Ee.rows),p(Ee.cols),re(ne),I(new Set)}},[G,ee]);W.useEffect(()=>{const ne=Ee=>{e&&((Ee.metaKey||Ee.ctrlKey)&&Ee.key==="z"?(Ee.preventDefault(),Ee.shiftKey?Be():Te()):(Ee.metaKey||Ee.ctrlKey)&&Ee.key==="y"&&(Ee.preventDefault(),Be()))};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[e,Te,Be]);const Z=(ne,Ee)=>{ne.stopPropagation();const R=new Set(N);ne.shiftKey||U?(R.has(Ee)?R.delete(Ee):R.add(Ee),I(R)):N.has(Ee)?I(new Set([Ee])):I(new Set([Ee]))},ie=()=>{I(new Set)},Qe=(ne,Ee,R)=>{if(ne.preventDefault(),x){if("type"in x){if(i.some(Ze=>Ze.row===Ee&&Ze.col===R))return;const Re={id:`seat-${Date.now()}-${Math.random()}`,row:Ee,col:R,type:x.type},Ge=[...i,Re];se(Ge,u,d),I(new Set([Re.id]))}else if("id"in x){const Re=i.find(it=>it.id===x.id);if(!Re)return;const Ge=Ee-Re.row,Ze=R-Re.col;if(i.filter(it=>N.has(it.id)).every(it=>{const wt=it.row+Ge,nr=it.col+Ze;return!(wt<0||wt>=u||nr<0||nr>=d||i.find(Mr=>Mr.row===wt&&Mr.col===nr&&!N.has(Mr.id)))})){const it=i.map(wt=>N.has(wt.id)?{...wt,row:wt.row+Ge,col:wt.col+Ze}:wt);se(it,u,d)}}}y(null),ne.currentTarget.classList.remove("bg-violet-200","dark:bg-violet-700/50")},ae=(ne,Ee)=>{y({type:Ee}),ne.dataTransfer.effectAllowed="copy",I(new Set)},Le=(ne,Ee)=>{N.has(Ee.id)||I(new Set([Ee.id])),y({id:Ee.id}),ne.dataTransfer.effectAllowed="move"},Y=ne=>{ne.preventDefault(),ne.currentTarget.classList.add("bg-violet-200","dark:bg-violet-700/50")},Q=ne=>{ne.currentTarget.classList.remove("bg-violet-200","dark:bg-violet-700/50")},K=ne=>{if(ne.preventDefault(),x&&"id"in x){const Ee=i.filter(R=>!N.has(R.id));se(Ee,u,d),I(new Set)}y(null),ne.currentTarget.classList.remove("bg-red-500/50")},P=()=>{I(new Set(i.map(ne=>ne.id)))},z=()=>{I(new Set)},ce=()=>{if(s){if(!C.trim()){S("Template name is required.");return}r({layout:i,name:C})}else r({layout:i})},Ce=(ne,Ee)=>{const R=Math.max(1,Math.min(50,Ee));let Re=i;ne==="rows"?(Re=i.filter(Ge=>Ge.row<R),se(Re,R,d)):(Re=i.filter(Ge=>Ge.col<R),se(Re,u,R))},he=async ne=>{if(ne.target.files&&ne.target.files[0]){_(!0);const Ee=ne.target.files[0],R=new FileReader;R.onloadend=async()=>{try{const Re=R.result.split(",")[1],Ge=Ee.type,Ze=await bH(Re,Ge);Ze?se(Ze.layout,Ze.rows,Ze.cols):alert("Could not analyze image. Please try again with a clearer image of the seating arrangement.")}catch(Re){console.error(Re),alert("An error occurred during image processing.")}finally{_(!1),q.current&&(q.current.value="")}},R.readAsDataURL(Ee)}};if(!e)return null;const de=new Map(i.map(ne=>[`${ne.row}-${ne.col}`,ne]));return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",onClick:t,children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full h-full max-w-7xl max-h-[95vh] flex flex-col",onClick:ne=>ne.stopPropagation(),children:[h.jsxs("header",{className:"p-4 border-b dark:border-slate-700 flex justify-between items-center",children:[h.jsx("h2",{className:"text-xl font-bold",children:s?"Create Hall Template":"Hall Layout Editor"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"flex gap-1 mr-4 border-r dark:border-slate-700 pr-4",children:[h.jsx("button",{onClick:Te,disabled:ee<=0,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Undo (Ctrl+Z)",children:h.jsx(A6,{})}),h.jsx("button",{onClick:Be,disabled:ee>=G.length-1,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Redo (Ctrl+Y)",children:h.jsx(s6,{})})]}),h.jsx(tt,{onClick:t,variant:"secondary",children:"Close"})]})]}),h.jsxs("div",{className:"flex-grow flex overflow-hidden relative",children:[F&&h.jsxs("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-900/80 z-50 flex flex-col items-center justify-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600 mb-4"}),h.jsx("p",{className:"text-violet-700 dark:text-violet-400 font-semibold",children:"AI is analyzing your image to generate the layout..."})]}),h.jsxs("aside",{className:"w-64 p-4 border-r dark:border-slate-700 flex flex-col gap-4 bg-slate-50 dark:bg-slate-800/50 overflow-y-auto",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"font-semibold mb-2",children:"Tools"}),h.jsx("input",{type:"file",ref:q,onChange:he,accept:"image/*",className:"hidden"}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("button",{onClick:()=>{var ne;return(ne=q.current)==null?void 0:ne.click()},className:"w-full flex items-center justify-center gap-2 p-2 bg-violet-100 text-violet-700 dark:bg-violet-500/20 dark:text-violet-300 hover:bg-violet-200 dark:hover:bg-violet-500/30 rounded-md transition-colors text-sm font-medium",disabled:F,children:[h.jsx(n6,{})," Import from Image"]}),h.jsxs("button",{onClick:()=>k(!U),className:`w-full flex items-center justify-center gap-2 p-2 rounded-md transition-colors text-sm font-medium ${U?"bg-violet-600 text-white":"bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-600"}`,children:[h.jsx(a6,{})," ",U?"Multi-Select On":"Multi-Select Off"]})]})]}),h.jsxs("div",{className:"mb-2",children:[h.jsx("h3",{className:"font-semibold",children:"Selection"}),h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:[N.size," seat",N.size!==1?"s":""," selected"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:P,className:"flex-1 text-xs bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 px-2 py-1 rounded",children:"Select All"}),h.jsx("button",{onClick:z,className:"flex-1 text-xs bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 px-2 py-1 rounded",children:"Clear"})]})]}),h.jsx("h3",{className:"font-semibold",children:"Seat Palette"}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Drag a seat type onto the grid."}),JC.map(({type:ne,label:Ee,style:R,icon:Re})=>h.jsxs("div",{draggable:!0,onDragStart:Ge=>ae(Ge,ne),className:`p-2 rounded-md cursor-grab flex items-center gap-2 ${R}`,children:[h.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center font-bold text-slate-800 dark:text-slate-900 border border-slate-400 dark:border-slate-500",children:Re}),h.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-slate-200",children:Ee})]},ne)),h.jsx("div",{className:"mt-auto pt-4 border-t dark:border-slate-700",children:h.jsxs("div",{onDragOver:ne=>{ne.preventDefault(),ne.currentTarget.classList.add("bg-red-500/50")},onDragLeave:ne=>ne.currentTarget.classList.remove("bg-red-500/50"),onDrop:K,className:"border-2 border-dashed border-red-500 rounded-lg p-4 text-center text-red-500 transition-colors",children:[h.jsx("p",{className:"font-bold",children:"Trash"}),h.jsx("p",{className:"text-xs",children:"Drag seat(s) here to remove."})]})})]}),h.jsxs("main",{className:"flex-grow flex flex-col p-4 overflow-auto bg-white dark:bg-slate-900",onClick:ie,children:[s&&h.jsxs("div",{className:"mb-4",children:[h.jsx(Ut,{label:"Template Name",id:"template-name",value:C,onChange:ne=>{E(ne.target.value),S("")},placeholder:"e.g., Main Auditorium",required:!0,onClick:ne=>ne.stopPropagation()}),T&&h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:T})]}),h.jsxs("div",{className:"flex items-center gap-4 mb-4",onClick:ne=>ne.stopPropagation(),children:[h.jsx(Ut,{label:"Rows",type:"number",value:u,onChange:ne=>Ce("rows",parseInt(ne.target.value)||0),containerClassName:"w-24"}),h.jsx(Ut,{label:"Columns",type:"number",value:d,onChange:ne=>Ce("cols",parseInt(ne.target.value)||0),containerClassName:"w-24"}),h.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Total Seats: ",h.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:i.length})]}),h.jsxs("div",{className:"ml-auto text-xs text-slate-400",children:["Tip: Hold ",h.jsx("b",{children:"Shift"})," to select multiple seats. Use ",h.jsx("b",{children:"Ctrl+Z"})," to Undo."]})]}),h.jsx("div",{className:"flex-grow overflow-auto p-2 bg-slate-100 dark:bg-slate-800/50 rounded-md border dark:border-slate-700",children:h.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${d}, 2.5rem)`,gridTemplateRows:`repeat(${u}, 2.5rem)`},children:Array.from({length:u*d}).map((ne,Ee)=>{const R=Math.floor(Ee/d),Re=Ee%d,Ge=de.get(`${R}-${Re}`);if(Ge){const Ze=Ge,st=JC.find(it=>it.type===Ze.type),He=N.has(Ze.id);return h.jsxs("div",{draggable:!0,onDragStart:it=>Le(it,Ze),onClick:it=>Z(it,Ze.id),className:`
                                                    w-10 h-10 rounded cursor-move flex items-center justify-center 
                                                    font-bold text-slate-800 dark:text-slate-900 border 
                                                    ${st.style}
                                                    ${He?"ring-4 ring-offset-2 ring-violet-500 dark:ring-violet-400 z-10":"border-slate-400 dark:border-slate-500 hover:brightness-110"}
                                                `,title:`${st.label} Seat (R${R+1}, C${Re+1})`,children:[He&&h.jsx("div",{className:"absolute top-0 right-0 -mt-1 -mr-1 w-3 h-3 bg-violet-600 rounded-full border border-white"}),st.icon]},Ze.id)}return h.jsx("div",{onDrop:Ze=>Qe(Ze,R,Re),onDragOver:Y,onDragLeave:Q,className:"w-10 h-10 bg-slate-200 dark:bg-slate-700/30 rounded-sm transition-colors"},`cell-${R}-${Re}`)})})})]})]}),h.jsx("footer",{className:"p-4 border-t dark:border-slate-700 text-right",children:h.jsxs(tt,{onClick:ce,children:["Save ",s?"Template":"Layout"]})})]})})};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Cp=function(e,t){return Cp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Cp(e,t)};function xA(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Cp(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ep=function(){return Ep=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ep.apply(this,arguments)};function $n(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(d){try{f(n.next(d))}catch(p){i(p)}}function u(d){try{f(n.throw(d))}catch(p){i(p)}}function f(d){d.done?s(d.value):a(d.value).then(l,u)}f((n=n.apply(e,[])).next())})}function Ln(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,i;return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(f){return function(d){return u([f,d])}}function u(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=f[0]&2?a.return:f[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,f[1])).done)return s;switch(a=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,a=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],a=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function tf(e,t,r){if(arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||t)}var fs=(function(){function e(t,r,n,a){this.left=t,this.top=r,this.width=n,this.height=a}return e.prototype.add=function(t,r,n,a){return new e(this.left+t,this.top+r,this.width+n,this.height+a)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e})(),Md=function(e,t){return fs.fromClientRect(e,t.getBoundingClientRect())},i6=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),a=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new fs(0,0,n,a)},Ld=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((a&1023)<<10)+(s&1023)+65536):(t.push(a),r--)}else t.push(a)}return t},$r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var i=e[a];i<=65535?n.push(i):(i-=65536,n.push((i>>10)+55296,i%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},YC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o6=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var rf=0;rf<YC.length;rf++)o6[YC.charCodeAt(rf)]=rf;var qC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var nf=0;nf<qC.length;nf++)Qc[qC.charCodeAt(nf)]=nf;var l6=function(e){var t=e.length*.75,r=e.length,n,a=0,s,i,l,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<r;n+=4)s=Qc[e.charCodeAt(n)],i=Qc[e.charCodeAt(n+1)],l=Qc[e.charCodeAt(n+2)],u=Qc[e.charCodeAt(n+3)],d[a++]=s<<2|i>>4,d[a++]=(i&15)<<4|l>>2,d[a++]=(l&3)<<6|u&63;return f},c6=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},u6=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},ji=5,Bx=11,pm=2,f6=Bx-ji,QS=65536>>ji,d6=1<<ji,xm=d6-1,h6=1024>>ji,g6=QS+h6,m6=g6,p6=32,x6=m6+p6,v6=65536>>Bx,w6=1<<f6,y6=w6-1,$C=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},B6=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},C6=function(e,t){var r=l6(e),n=Array.isArray(r)?u6(r):new Uint32Array(r),a=Array.isArray(r)?c6(r):new Uint16Array(r),s=24,i=$C(a,s/2,n[4]/2),l=n[5]===2?$C(a,(s+n[4])/2):B6(n,Math.ceil((s+n[4])/4));return new E6(n[0],n[1],n[2],n[3],i,l)},E6=(function(){function e(t,r,n,a,s,i){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=i}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>ji],r=(r<<pm)+(t&xm),this.data[r];if(t<=65535)return r=this.index[QS+(t-55296>>ji)],r=(r<<pm)+(t&xm),this.data[r];if(t<this.highStart)return r=x6-v6+(t>>Bx),r=this.index[r],r+=t>>ji&y6,r=this.index[r],r=(r<<pm)+(t&xm),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),ZC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T6=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var af=0;af<ZC.length;af++)T6[ZC.charCodeAt(af)]=af;var S6="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",eE=50,_6=1,RS=2,DS=3,b6=4,F6=5,tE=7,MS=8,rE=9,Ys=10,Tp=11,nE=12,Sp=13,U6=14,Rc=15,_p=16,Af=17,Sc=18,k6=19,aE=20,bp=21,_c=22,vm=23,Wo=24,Ca=25,Dc=26,Mc=27,Jo=28,N6=29,Pi=30,I6=31,sf=32,of=33,Fp=34,Up=35,kp=36,lu=37,Np=38,Xf=39,Wf=40,wm=41,LS=42,Q6=43,R6=[9001,65288],HS="!",Kt="",lf="",Ip=C6(S6),ns=[Pi,kp],Qp=[_6,RS,DS,F6],OS=[Ys,MS],AE=[Mc,Dc],D6=Qp.concat(OS),sE=[Np,Xf,Wf,Fp,Up],M6=[Rc,Sp],L6=function(e,t){t===void 0&&(t="strict");var r=[],n=[],a=[];return e.forEach(function(s,i){var l=Ip.get(s);if(l>eE?(a.push(!0),l-=eE):a.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(i),r.push(_p);if(l===b6||l===Tp){if(i===0)return n.push(i),r.push(Pi);var u=r[i-1];return D6.indexOf(u)===-1?(n.push(n[i-1]),r.push(u)):(n.push(i),r.push(Pi))}if(n.push(i),l===I6)return r.push(t==="strict"?bp:lu);if(l===LS||l===N6)return r.push(Pi);if(l===Q6)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(lu):r.push(Pi);r.push(l)}),[n,r,a]},ym=function(e,t,r,n){var a=n[r];if(Array.isArray(e)?e.indexOf(a)!==-1:e===a)for(var s=r;s<=n.length;){s++;var i=n[s];if(i===t)return!0;if(i!==Ys)break}if(a===Ys)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var u=r;u<=n.length;){u++;var i=n[u];if(i===t)return!0;if(i!==Ys)break}if(l!==Ys)break}return!1},iE=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===Ys)r--;else return n}return 0},H6=function(e,t,r,n,a){if(r[n]===0)return Kt;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return Kt;var i=s-1,l=s+1,u=t[s],f=i>=0?t[i]:0,d=t[l];if(u===RS&&d===DS)return Kt;if(Qp.indexOf(u)!==-1)return HS;if(Qp.indexOf(d)!==-1||OS.indexOf(d)!==-1)return Kt;if(iE(s,t)===MS)return lf;if(Ip.get(e[s])===Tp||(u===sf||u===of)&&Ip.get(e[l])===Tp||u===tE||d===tE||u===rE||[Ys,Sp,Rc].indexOf(u)===-1&&d===rE||[Af,Sc,k6,Wo,Jo].indexOf(d)!==-1||iE(s,t)===_c||ym(vm,_c,s,t)||ym([Af,Sc],bp,s,t)||ym(nE,nE,s,t))return Kt;if(u===Ys)return lf;if(u===vm||d===vm)return Kt;if(d===_p||u===_p)return lf;if([Sp,Rc,bp].indexOf(d)!==-1||u===U6||f===kp&&M6.indexOf(u)!==-1||u===Jo&&d===kp||d===aE||ns.indexOf(d)!==-1&&u===Ca||ns.indexOf(u)!==-1&&d===Ca||u===Mc&&[lu,sf,of].indexOf(d)!==-1||[lu,sf,of].indexOf(u)!==-1&&d===Dc||ns.indexOf(u)!==-1&&AE.indexOf(d)!==-1||AE.indexOf(u)!==-1&&ns.indexOf(d)!==-1||[Mc,Dc].indexOf(u)!==-1&&(d===Ca||[_c,Rc].indexOf(d)!==-1&&t[l+1]===Ca)||[_c,Rc].indexOf(u)!==-1&&d===Ca||u===Ca&&[Ca,Jo,Wo].indexOf(d)!==-1)return Kt;if([Ca,Jo,Wo,Af,Sc].indexOf(d)!==-1)for(var p=s;p>=0;){var x=t[p];if(x===Ca)return Kt;if([Jo,Wo].indexOf(x)!==-1)p--;else break}if([Mc,Dc].indexOf(d)!==-1)for(var p=[Af,Sc].indexOf(u)!==-1?i:s;p>=0;){var x=t[p];if(x===Ca)return Kt;if([Jo,Wo].indexOf(x)!==-1)p--;else break}if(Np===u&&[Np,Xf,Fp,Up].indexOf(d)!==-1||[Xf,Fp].indexOf(u)!==-1&&[Xf,Wf].indexOf(d)!==-1||[Wf,Up].indexOf(u)!==-1&&d===Wf||sE.indexOf(u)!==-1&&[aE,Dc].indexOf(d)!==-1||sE.indexOf(d)!==-1&&u===Mc||ns.indexOf(u)!==-1&&ns.indexOf(d)!==-1||u===Wo&&ns.indexOf(d)!==-1||ns.concat(Ca).indexOf(u)!==-1&&d===_c&&R6.indexOf(e[l])===-1||ns.concat(Ca).indexOf(d)!==-1&&u===Sc)return Kt;if(u===wm&&d===wm){for(var y=r[s],C=1;y>0&&(y--,t[y]===wm);)C++;if(C%2!==0)return Kt}return u===sf&&d===of?Kt:lf},O6=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=L6(e,t.lineBreak),n=r[0],a=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(a=a.map(function(l){return[Ca,Pi,LS].indexOf(l)!==-1?lu:l}));var i=t.wordBreak==="keep-all"?s.map(function(l,u){return l&&e[u]>=19968&&e[u]<=40959}):void 0;return[n,a,i]},P6=(function(){function e(t,r,n,a){this.codePoints=t,this.required=r===HS,this.start=n,this.end=a}return e.prototype.slice=function(){return $r.apply(void 0,this.codePoints.slice(this.start,this.end))},e})(),G6=function(e,t){var r=Ld(e),n=O6(r,t),a=n[0],s=n[1],i=n[2],l=r.length,u=0,f=0;return{next:function(){if(f>=l)return{done:!0,value:null};for(var d=Kt;f<l&&(d=H6(r,s,a,++f,i))===Kt;);if(d!==Kt||f===l){var p=new P6(r,d,u,f);return u=f,{value:p,done:!1}}return{done:!0,value:null}}}},V6=1,K6=2,Uu=4,oE=8,Ad=10,lE=47,jc=92,j6=9,z6=32,cf=34,bc=61,X6=35,W6=36,J6=37,uf=39,ff=40,Fc=41,Y6=95,ua=45,q6=33,$6=60,Z6=62,e5=64,t5=91,r5=93,n5=61,a5=123,df=63,A5=125,cE=124,s5=126,i5=128,uE=65533,Bm=42,Vi=43,o5=44,l5=58,c5=59,cu=46,u5=0,f5=8,d5=11,h5=14,g5=31,m5=127,EA=-1,PS=48,GS=97,VS=101,p5=102,x5=117,v5=122,KS=65,jS=69,zS=70,w5=85,y5=90,Pn=function(e){return e>=PS&&e<=57},B5=function(e){return e>=55296&&e<=57343},Yo=function(e){return Pn(e)||e>=KS&&e<=zS||e>=GS&&e<=p5},C5=function(e){return e>=GS&&e<=v5},E5=function(e){return e>=KS&&e<=y5},T5=function(e){return C5(e)||E5(e)},S5=function(e){return e>=i5},hf=function(e){return e===Ad||e===j6||e===z6},sd=function(e){return T5(e)||S5(e)||e===Y6},fE=function(e){return sd(e)||Pn(e)||e===ua},_5=function(e){return e>=u5&&e<=f5||e===d5||e>=h5&&e<=g5||e===m5},Ws=function(e,t){return e!==jc?!1:t!==Ad},gf=function(e,t,r){return e===ua?sd(t)||Ws(t,r):sd(e)?!0:!!(e===jc&&Ws(e,t))},Cm=function(e,t,r){return e===Vi||e===ua?Pn(t)?!0:t===cu&&Pn(r):Pn(e===cu?t:e)},b5=function(e){var t=0,r=1;(e[t]===Vi||e[t]===ua)&&(e[t]===ua&&(r=-1),t++);for(var n=[];Pn(e[t]);)n.push(e[t++]);var a=n.length?parseInt($r.apply(void 0,n),10):0;e[t]===cu&&t++;for(var s=[];Pn(e[t]);)s.push(e[t++]);var i=s.length,l=i?parseInt($r.apply(void 0,s),10):0;(e[t]===jS||e[t]===VS)&&t++;var u=1;(e[t]===Vi||e[t]===ua)&&(e[t]===ua&&(u=-1),t++);for(var f=[];Pn(e[t]);)f.push(e[t++]);var d=f.length?parseInt($r.apply(void 0,f),10):0;return r*(a+l*Math.pow(10,-i))*Math.pow(10,u*d)},F5={type:2},U5={type:3},k5={type:4},N5={type:13},I5={type:8},Q5={type:21},R5={type:9},D5={type:10},M5={type:11},L5={type:12},H5={type:14},mf={type:23},O5={type:1},P5={type:25},G5={type:24},V5={type:26},K5={type:27},j5={type:28},z5={type:29},X5={type:31},Rp={type:32},XS=(function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(Ld(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Rp;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case cf:return this.consumeStringToken(cf);case X6:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(fE(r)||Ws(n,a)){var s=gf(r,n,a)?K6:V6,i=this.consumeName();return{type:5,value:i,flags:s}}break;case W6:if(this.peekCodePoint(0)===bc)return this.consumeCodePoint(),N5;break;case uf:return this.consumeStringToken(uf);case ff:return F5;case Fc:return U5;case Bm:if(this.peekCodePoint(0)===bc)return this.consumeCodePoint(),H5;break;case Vi:if(Cm(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case o5:return k5;case ua:var l=t,u=this.peekCodePoint(0),f=this.peekCodePoint(1);if(Cm(l,u,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(gf(l,u,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(u===ua&&f===Z6)return this.consumeCodePoint(),this.consumeCodePoint(),G5;break;case cu:if(Cm(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case lE:if(this.peekCodePoint(0)===Bm)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===Bm&&(d=this.consumeCodePoint(),d===lE))return this.consumeToken();if(d===EA)return this.consumeToken()}break;case l5:return V5;case c5:return K5;case $6:if(this.peekCodePoint(0)===q6&&this.peekCodePoint(1)===ua&&this.peekCodePoint(2)===ua)return this.consumeCodePoint(),this.consumeCodePoint(),P5;break;case e5:var p=this.peekCodePoint(0),x=this.peekCodePoint(1),y=this.peekCodePoint(2);if(gf(p,x,y)){var i=this.consumeName();return{type:7,value:i}}break;case t5:return j5;case jc:if(Ws(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case r5:return z5;case n5:if(this.peekCodePoint(0)===bc)return this.consumeCodePoint(),I5;break;case a5:return M5;case A5:return L5;case x5:case w5:var C=this.peekCodePoint(0),E=this.peekCodePoint(1);return C===Vi&&(Yo(E)||E===df)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case cE:if(this.peekCodePoint(0)===bc)return this.consumeCodePoint(),R5;if(this.peekCodePoint(0)===cE)return this.consumeCodePoint(),Q5;break;case s5:if(this.peekCodePoint(0)===bc)return this.consumeCodePoint(),D5;break;case EA:return Rp}return hf(t)?(this.consumeWhiteSpace(),X5):Pn(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):sd(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:$r(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Yo(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===df&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt($r.apply(void 0,t.map(function(u){return u===df?PS:u})),16),s=parseInt($r.apply(void 0,t.map(function(u){return u===df?zS:u})),16);return{type:30,start:a,end:s}}var i=parseInt($r.apply(void 0,t),16);if(this.peekCodePoint(0)===ua&&Yo(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Yo(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt($r.apply(void 0,l),16);return{type:30,start:i,end:s}}else return{type:30,start:i,end:i}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===ff?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===ff?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===EA)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===uf||r===cf){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===EA||this.peekCodePoint(0)===Fc)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),mf)}for(;;){var a=this.consumeCodePoint();if(a===EA||a===Fc)return{type:22,value:$r.apply(void 0,t)};if(hf(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===EA||this.peekCodePoint(0)===Fc?(this.consumeCodePoint(),{type:22,value:$r.apply(void 0,t)}):(this.consumeBadUrlRemnants(),mf);if(a===cf||a===uf||a===ff||_5(a))return this.consumeBadUrlRemnants(),mf;if(a===jc)if(Ws(a,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),mf;else t.push(a)}},e.prototype.consumeWhiteSpace=function(){for(;hf(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Fc||t===EA)return;Ws(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var a=Math.min(r,t);n+=$r.apply(void 0,this._value.splice(0,a)),t-=a}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var a=this._value[n];if(a===EA||a===void 0||a===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===Ad)return this._value.splice(0,n),O5;if(a===jc){var s=this._value[n+1];s!==EA&&s!==void 0&&(s===Ad?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):Ws(a,s)&&(r+=this.consumeStringSlice(n),r+=$r(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=Uu,n=this.peekCodePoint(0);for((n===Vi||n===ua)&&t.push(this.consumeCodePoint());Pn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===cu&&Pn(a))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=oE;Pn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===jS||n===VS)&&((a===Vi||a===ua)&&Pn(s)||Pn(a)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=oE;Pn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[b5(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),i=this.peekCodePoint(2);if(gf(a,s,i)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===J6?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Yo(t)){for(var r=$r(t);Yo(this.peekCodePoint(0))&&r.length<6;)r+=$r(this.consumeCodePoint());hf(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||B5(n)||n>1114111?uE:n}return t===EA?uE:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(fE(r))t+=$r(r);else if(Ws(r,this.peekCodePoint(0)))t+=$r(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e})(),WS=(function(){function e(t){this._tokens=t}return e.create=function(t){var r=new XS;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||J5(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Rp:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e})(),ku=function(e){return e.type===15},bl=function(e){return e.type===17},yr=function(e){return e.type===20},W5=function(e){return e.type===0},Dp=function(e,t){return yr(e)&&e.value===t},JS=function(e){return e.type!==31},vl=function(e){return e.type!==31&&e.type!==4},IA=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},J5=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},ni=function(e){return e.type===17||e.type===15},cn=function(e){return e.type===16||ni(e)},YS=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Qn={type:17,number:0,flags:Uu},Cx={type:16,number:50,flags:Uu},qs={type:16,number:100,flags:Uu},Lc=function(e,t,r){var n=e[0],a=e[1];return[Tr(n,t),Tr(typeof a<"u"?a:n,r)]},Tr=function(e,t){if(e.type===16)return e.number/100*t;if(ku(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},qS="deg",$S="grad",ZS="rad",e_="turn",Hd={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case qS:return Math.PI*t.number/180;case $S:return Math.PI/200*t.number;case ZS:return t.number;case e_:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},t_=function(e){return e.type===15&&(e.unit===qS||e.unit===$S||e.unit===ZS||e.unit===e_)},r_=function(e){var t=e.filter(yr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Qn,Qn];case"to top":case"bottom":return Ya(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Qn,qs];case"to right":case"left":return Ya(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[qs,qs];case"to bottom":case"top":return Ya(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[qs,Qn];case"to left":case"right":return Ya(270)}return 0},Ya=function(e){return Math.PI*e/180},ti={name:"color",parse:function(e,t){if(t.type===18){var r=Y5[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),a=t.value.substring(1,2),s=t.value.substring(2,3);return $s(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),a=t.value.substring(1,2),s=t.value.substring(2,3),i=t.value.substring(3,4);return $s(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(i+i,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),a=t.value.substring(2,4),s=t.value.substring(4,6);return $s(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),a=t.value.substring(2,4),s=t.value.substring(4,6),i=t.value.substring(6,8);return $s(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(i,16)/255)}}if(t.type===20){var l=ss[t.value.toUpperCase()];if(typeof l<"u")return l}return ss.TRANSPARENT}},ri=function(e){return(255&e)===0},wn=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,a=255&e>>24;return t<255?"rgba("+a+","+n+","+r+","+t/255+")":"rgb("+a+","+n+","+r+")"},$s=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},dE=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},hE=function(e,t){var r=t.filter(vl);if(r.length===3){var n=r.map(dE),a=n[0],s=n[1],i=n[2];return $s(a,s,i,1)}if(r.length===4){var l=r.map(dE),a=l[0],s=l[1],i=l[2],u=l[3];return $s(a,s,i,u)}return 0};function Em(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var gE=function(e,t){var r=t.filter(vl),n=r[0],a=r[1],s=r[2],i=r[3],l=(n.type===17?Ya(n.number):Hd.parse(e,n))/(Math.PI*2),u=cn(a)?a.number/100:0,f=cn(s)?s.number/100:0,d=typeof i<"u"&&cn(i)?Tr(i,1):1;if(u===0)return $s(f*255,f*255,f*255,1);var p=f<=.5?f*(u+1):f+u-f*u,x=f*2-p,y=Em(x,p,l+1/3),C=Em(x,p,l),E=Em(x,p,l-1/3);return $s(y*255,C*255,E*255,d)},Y5={hsl:gE,hsla:gE,rgb:hE,rgba:hE},zc=function(e,t){return ti.parse(e,WS.create(t).parseComponentValue())},ss={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},q5={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(yr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},$5={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Od=function(e,t){var r=ti.parse(e,t[0]),n=t[1];return n&&cn(n)?{color:r,stop:n}:{color:r,stop:null}},mE=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=Qn),n.stop===null&&(n.stop=qs);for(var a=[],s=0,i=0;i<e.length;i++){var l=e[i].stop;if(l!==null){var u=Tr(l,t);u>s?a.push(u):a.push(s),s=u}else a.push(null)}for(var f=null,i=0;i<a.length;i++){var d=a[i];if(d===null)f===null&&(f=i);else if(f!==null){for(var p=i-f,x=a[f-1],y=(d-x)/(p+1),C=1;C<=p;C++)a[f+C-1]=y*C;f=null}}return e.map(function(E,T){var S=E.color;return{color:S,stop:Math.max(Math.min(1,a[T]/t),0)}})},Z5=function(e,t,r){var n=t/2,a=r/2,s=Tr(e[0],t)-n,i=a-Tr(e[1],r);return(Math.atan2(i,s)+Math.PI*2)%(Math.PI*2)},e8=function(e,t,r){var n=typeof e=="number"?e:Z5(e,t,r),a=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),s=t/2,i=r/2,l=a/2,u=Math.sin(n-Math.PI/2)*l,f=Math.cos(n-Math.PI/2)*l;return[a,s-f,s+f,i-u,i+u]},cA=function(e,t){return Math.sqrt(e*e+t*t)},pE=function(e,t,r,n,a){var s=[[0,0],[0,t],[e,0],[e,t]];return s.reduce(function(i,l){var u=l[0],f=l[1],d=cA(r-u,n-f);return(a?d<i.optimumDistance:d>i.optimumDistance)?{optimumCorner:l,optimumDistance:d}:i},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},t8=function(e,t,r,n,a){var s=0,i=0;switch(e.size){case 0:e.shape===0?s=i=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-a)):e.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),i=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(e.shape===0)s=i=Math.min(cA(t,r),cA(t,r-a),cA(t-n,r),cA(t-n,r-a));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(t),Math.abs(t-n)),u=pE(n,a,t,r,!0),f=u[0],d=u[1];s=cA(f-t,(d-r)/l),i=l*s}break;case 1:e.shape===0?s=i=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-a)):e.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),i=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(e.shape===0)s=i=Math.max(cA(t,r),cA(t,r-a),cA(t-n,r),cA(t-n,r-a));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(t),Math.abs(t-n)),p=pE(n,a,t,r,!1),f=p[0],d=p[1];s=cA(f-t,(d-r)/l),i=l*s}break}return Array.isArray(e.size)&&(s=Tr(e.size[0],n),i=e.size.length===2?Tr(e.size[1],a):s),[s,i]},r8=function(e,t){var r=Ya(180),n=[];return IA(t).forEach(function(a,s){if(s===0){var i=a[0];if(i.type===20&&i.value==="to"){r=r_(a);return}else if(t_(i)){r=Hd.parse(e,i);return}}var l=Od(e,a);n.push(l)}),{angle:r,stops:n,type:1}},pf=function(e,t){var r=Ya(180),n=[];return IA(t).forEach(function(a,s){if(s===0){var i=a[0];if(i.type===20&&["top","left","right","bottom"].indexOf(i.value)!==-1){r=r_(a);return}else if(t_(i)){r=(Hd.parse(e,i)+Ya(270))%Ya(360);return}}var l=Od(e,a);n.push(l)}),{angle:r,stops:n,type:1}},n8=function(e,t){var r=Ya(180),n=[],a=1,s=0,i=3,l=[];return IA(t).forEach(function(u,f){var d=u[0];if(f===0){if(yr(d)&&d.value==="linear"){a=1;return}else if(yr(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var p=ti.parse(e,d.values[0]);n.push({stop:Qn,color:p})}else if(d.name==="to"){var p=ti.parse(e,d.values[0]);n.push({stop:qs,color:p})}else if(d.name==="color-stop"){var x=d.values.filter(vl);if(x.length===2){var p=ti.parse(e,x[1]),y=x[0];bl(y)&&n.push({stop:{type:16,number:y.number*100,flags:y.flags},color:p})}}}}),a===1?{angle:(r+Ya(180))%Ya(360),stops:n,type:a}:{size:i,shape:s,stops:n,position:l,type:a}},n_="closest-side",a_="farthest-side",A_="closest-corner",s_="farthest-corner",i_="circle",o_="ellipse",l_="cover",c_="contain",a8=function(e,t){var r=0,n=3,a=[],s=[];return IA(t).forEach(function(i,l){var u=!0;if(l===0){var f=!1;u=i.reduce(function(p,x){if(f)if(yr(x))switch(x.value){case"center":return s.push(Cx),p;case"top":case"left":return s.push(Qn),p;case"right":case"bottom":return s.push(qs),p}else(cn(x)||ni(x))&&s.push(x);else if(yr(x))switch(x.value){case i_:return r=0,!1;case o_:return r=1,!1;case"at":return f=!0,!1;case n_:return n=0,!1;case l_:case a_:return n=1,!1;case c_:case A_:return n=2,!1;case s_:return n=3,!1}else if(ni(x)||cn(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return p},u)}if(u){var d=Od(e,i);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},xf=function(e,t){var r=0,n=3,a=[],s=[];return IA(t).forEach(function(i,l){var u=!0;if(l===0?u=i.reduce(function(d,p){if(yr(p))switch(p.value){case"center":return s.push(Cx),!1;case"top":case"left":return s.push(Qn),!1;case"right":case"bottom":return s.push(qs),!1}else if(cn(p)||ni(p))return s.push(p),!1;return d},u):l===1&&(u=i.reduce(function(d,p){if(yr(p))switch(p.value){case i_:return r=0,!1;case o_:return r=1,!1;case c_:case n_:return n=0,!1;case a_:return n=1,!1;case A_:return n=2,!1;case l_:case s_:return n=3,!1}else if(ni(p)||cn(p))return Array.isArray(n)||(n=[]),n.push(p),!1;return d},u)),u){var f=Od(e,i);a.push(f)}}),{size:n,shape:r,stops:a,position:s,type:2}},A8=function(e){return e.type===1},s8=function(e){return e.type===2},Ex={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=u_[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function i8(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!u_[e.name])}var u_={"linear-gradient":r8,"-moz-linear-gradient":pf,"-ms-linear-gradient":pf,"-o-linear-gradient":pf,"-webkit-linear-gradient":pf,"radial-gradient":a8,"-moz-radial-gradient":xf,"-ms-radial-gradient":xf,"-o-radial-gradient":xf,"-webkit-radial-gradient":xf,"-webkit-gradient":n8},o8={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return vl(n)&&i8(n)}).map(function(n){return Ex.parse(e,n)})}},l8={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(yr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},c8={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return IA(t).map(function(r){return r.filter(cn)}).map(YS)}},u8={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return IA(t).map(function(r){return r.filter(yr).map(function(n){return n.value}).join(" ")}).map(f8)}},f8=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},hl;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(hl||(hl={}));var d8={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return IA(t).map(function(r){return r.filter(h8)})}},h8=function(e){return yr(e)||cn(e)},Pd=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},g8=Pd("top"),m8=Pd("right"),p8=Pd("bottom"),x8=Pd("left"),Gd=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return YS(r.filter(cn))}}},v8=Gd("top-left"),w8=Gd("top-right"),y8=Gd("bottom-right"),B8=Gd("bottom-left"),Vd=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},C8=Vd("top"),E8=Vd("right"),T8=Vd("bottom"),S8=Vd("left"),Kd=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return ku(r)?r.number:0}}},_8=Kd("top"),b8=Kd("right"),F8=Kd("bottom"),U8=Kd("left"),k8={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},N8={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},I8={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(yr).reduce(function(r,n){return r|Q8(n.value)},0)}},Q8=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},R8={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},D8={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},id;(function(e){e.NORMAL="normal",e.STRICT="strict"})(id||(id={}));var M8={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return id.STRICT;case"normal":default:return id.NORMAL}}},L8={name:"line-height",initialValue:"normal",prefix:!1,type:4},xE=function(e,t){return yr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:cn(e)?Tr(e,t):t},H8={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:Ex.parse(e,t)}},O8={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},Mp={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},jd=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},P8=jd("top"),G8=jd("right"),V8=jd("bottom"),K8=jd("left"),j8={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(yr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},z8={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},zd=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},X8=zd("top"),W8=zd("right"),J8=zd("bottom"),Y8=zd("left"),q8={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},$8={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Z8={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Dp(t[0],"none")?[]:IA(t).map(function(r){for(var n={color:ss.TRANSPARENT,offsetX:Qn,offsetY:Qn,blur:Qn},a=0,s=0;s<r.length;s++){var i=r[s];ni(i)?(a===0?n.offsetX=i:a===1?n.offsetY=i:n.blur=i,a++):n.color=ti.parse(e,i)}return n})}},eO={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},tO={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=aO[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},rO=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},nO=function(e){var t=e.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=t[0],n=t[1];t[2],t[3];var a=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var i=t[12],l=t[13];return t[14],t[15],t.length===16?[r,n,a,s,i,l]:null},aO={matrix:rO,matrix3d:nO},vE={type:16,number:50,flags:Uu},AO=[vE,vE],sO={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(cn);return r.length!==2?AO:[r[0],r[1]]}},iO={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Xc;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(Xc||(Xc={}));var oO={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return Xc.BREAK_ALL;case"keep-all":return Xc.KEEP_ALL;case"normal":default:return Xc.NORMAL}}},lO={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(bl(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},f_={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},cO={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return bl(t)?t.number:1}},uO={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},fO={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(yr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},dO={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},hO={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},gO={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(bl(t))return t.number;if(yr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},mO={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(yr).map(function(r){return r.value})}},pO={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},hn=function(e,t){return(e&t)!==0},xO={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},vO={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=t.filter(JS),s=0;s<a.length;s++){var i=a[s],l=a[s+1];if(i.type===20){var u=l&&bl(l)?l.number:1;n.push({counter:i.value,increment:u})}}return n}},wO={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(JS),a=0;a<n.length;a++){var s=n[a],i=n[a+1];if(yr(s)&&s.value!=="none"){var l=i&&bl(i)?i.number:0;r.push({counter:s.value,reset:l})}}return r}},yO={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(ku).map(function(r){return f_.parse(e,r)})}},BO={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],a=t.filter(W5);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var i=a[s].value,l=a[s+1].value;n.push({open:i,close:l})}return n}},wE=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},CO={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Dp(t[0],"none")?[]:IA(t).map(function(r){for(var n={color:255,offsetX:Qn,offsetY:Qn,blur:Qn,spread:Qn,inset:!1},a=0,s=0;s<r.length;s++){var i=r[s];Dp(i,"inset")?n.inset=!0:ni(i)?(a===0?n.offsetX=i:a===1?n.offsetY=i:a===2?n.blur=i:n.spread=i,a++):n.color=ti.parse(e,i)}return n})}},EO={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(yr).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},TO={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},SO={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return ku(t)?t.number:0}},_O=(function(){function e(t,r){var n,a;this.animationDuration=nt(t,yO,r.animationDuration),this.backgroundClip=nt(t,q5,r.backgroundClip),this.backgroundColor=nt(t,$5,r.backgroundColor),this.backgroundImage=nt(t,o8,r.backgroundImage),this.backgroundOrigin=nt(t,l8,r.backgroundOrigin),this.backgroundPosition=nt(t,c8,r.backgroundPosition),this.backgroundRepeat=nt(t,u8,r.backgroundRepeat),this.backgroundSize=nt(t,d8,r.backgroundSize),this.borderTopColor=nt(t,g8,r.borderTopColor),this.borderRightColor=nt(t,m8,r.borderRightColor),this.borderBottomColor=nt(t,p8,r.borderBottomColor),this.borderLeftColor=nt(t,x8,r.borderLeftColor),this.borderTopLeftRadius=nt(t,v8,r.borderTopLeftRadius),this.borderTopRightRadius=nt(t,w8,r.borderTopRightRadius),this.borderBottomRightRadius=nt(t,y8,r.borderBottomRightRadius),this.borderBottomLeftRadius=nt(t,B8,r.borderBottomLeftRadius),this.borderTopStyle=nt(t,C8,r.borderTopStyle),this.borderRightStyle=nt(t,E8,r.borderRightStyle),this.borderBottomStyle=nt(t,T8,r.borderBottomStyle),this.borderLeftStyle=nt(t,S8,r.borderLeftStyle),this.borderTopWidth=nt(t,_8,r.borderTopWidth),this.borderRightWidth=nt(t,b8,r.borderRightWidth),this.borderBottomWidth=nt(t,F8,r.borderBottomWidth),this.borderLeftWidth=nt(t,U8,r.borderLeftWidth),this.boxShadow=nt(t,CO,r.boxShadow),this.color=nt(t,k8,r.color),this.direction=nt(t,N8,r.direction),this.display=nt(t,I8,r.display),this.float=nt(t,R8,r.cssFloat),this.fontFamily=nt(t,dO,r.fontFamily),this.fontSize=nt(t,hO,r.fontSize),this.fontStyle=nt(t,pO,r.fontStyle),this.fontVariant=nt(t,mO,r.fontVariant),this.fontWeight=nt(t,gO,r.fontWeight),this.letterSpacing=nt(t,D8,r.letterSpacing),this.lineBreak=nt(t,M8,r.lineBreak),this.lineHeight=nt(t,L8,r.lineHeight),this.listStyleImage=nt(t,H8,r.listStyleImage),this.listStylePosition=nt(t,O8,r.listStylePosition),this.listStyleType=nt(t,Mp,r.listStyleType),this.marginTop=nt(t,P8,r.marginTop),this.marginRight=nt(t,G8,r.marginRight),this.marginBottom=nt(t,V8,r.marginBottom),this.marginLeft=nt(t,K8,r.marginLeft),this.opacity=nt(t,cO,r.opacity);var s=nt(t,j8,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=nt(t,z8,r.overflowWrap),this.paddingTop=nt(t,X8,r.paddingTop),this.paddingRight=nt(t,W8,r.paddingRight),this.paddingBottom=nt(t,J8,r.paddingBottom),this.paddingLeft=nt(t,Y8,r.paddingLeft),this.paintOrder=nt(t,EO,r.paintOrder),this.position=nt(t,$8,r.position),this.textAlign=nt(t,q8,r.textAlign),this.textDecorationColor=nt(t,uO,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=nt(t,fO,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=nt(t,Z8,r.textShadow),this.textTransform=nt(t,eO,r.textTransform),this.transform=nt(t,tO,r.transform),this.transformOrigin=nt(t,sO,r.transformOrigin),this.visibility=nt(t,iO,r.visibility),this.webkitTextStrokeColor=nt(t,TO,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=nt(t,SO,r.webkitTextStrokeWidth),this.wordBreak=nt(t,oO,r.wordBreak),this.zIndex=nt(t,lO,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return ri(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return hn(this.display,4)||hn(this.display,33554432)||hn(this.display,268435456)||hn(this.display,536870912)||hn(this.display,67108864)||hn(this.display,134217728)},e})(),bO=(function(){function e(t,r){this.content=nt(t,xO,r.content),this.quotes=nt(t,BO,r.quotes)}return e})(),yE=(function(){function e(t,r){this.counterIncrement=nt(t,vO,r.counterIncrement),this.counterReset=nt(t,wO,r.counterReset)}return e})(),nt=function(e,t,r){var n=new XS,a=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(a);var s=new WS(n.read());switch(t.type){case 2:var i=s.parseComponentValue();return t.parse(e,yr(i)?i.value:t.initialValue);case 0:return t.parse(e,s.parseComponentValue());case 1:return t.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return Hd.parse(e,s.parseComponentValue());case"color":return ti.parse(e,s.parseComponentValue());case"image":return Ex.parse(e,s.parseComponentValue());case"length":var l=s.parseComponentValue();return ni(l)?l:Qn;case"length-percentage":var u=s.parseComponentValue();return cn(u)?u:Qn;case"time":return f_.parse(e,s.parseComponentValue())}break}},FO="data-html2canvas-debug",UO=function(e){var t=e.getAttribute(FO);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Lp=function(e,t){var r=UO(e);return r===1||t===r},QA=(function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Lp(r,3))debugger;this.styles=new _O(t,window.getComputedStyle(r,null)),Pp(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Md(this.context,r),Lp(r,4)&&(this.flags|=16)}return e})(),kO="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",BE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var vf=0;vf<BE.length;vf++)Hc[BE.charCodeAt(vf)]=vf;var NO=function(e){var t=e.length*.75,r=e.length,n,a=0,s,i,l,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<r;n+=4)s=Hc[e.charCodeAt(n)],i=Hc[e.charCodeAt(n+1)],l=Hc[e.charCodeAt(n+2)],u=Hc[e.charCodeAt(n+3)],d[a++]=s<<2|i>>4,d[a++]=(i&15)<<4|l>>2,d[a++]=(l&3)<<6|u&63;return f},IO=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},QO=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},zi=5,Tx=11,Tm=2,RO=Tx-zi,d_=65536>>zi,DO=1<<zi,Sm=DO-1,MO=1024>>zi,LO=d_+MO,HO=LO,OO=32,PO=HO+OO,GO=65536>>Tx,VO=1<<RO,KO=VO-1,CE=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},jO=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},zO=function(e,t){var r=NO(e),n=Array.isArray(r)?QO(r):new Uint32Array(r),a=Array.isArray(r)?IO(r):new Uint16Array(r),s=24,i=CE(a,s/2,n[4]/2),l=n[5]===2?CE(a,(s+n[4])/2):jO(n,Math.ceil((s+n[4])/4));return new XO(n[0],n[1],n[2],n[3],i,l)},XO=(function(){function e(t,r,n,a,s,i){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=i}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>zi],r=(r<<Tm)+(t&Sm),this.data[r];if(t<=65535)return r=this.index[d_+(t-55296>>zi)],r=(r<<Tm)+(t&Sm),this.data[r];if(t<this.highStart)return r=PO-GO+(t>>Tx),r=this.index[r],r+=t>>zi&KO,r=this.index[r],r=(r<<Tm)+(t&Sm),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),EE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",WO=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var wf=0;wf<EE.length;wf++)WO[EE.charCodeAt(wf)]=wf;var JO=1,_m=2,bm=3,TE=4,SE=5,YO=7,_E=8,Fm=9,Um=10,bE=11,FE=12,UE=13,kE=14,km=15,qO=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((a&1023)<<10)+(s&1023)+65536):(t.push(a),r--)}else t.push(a)}return t},$O=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var i=e[a];i<=65535?n.push(i):(i-=65536,n.push((i>>10)+55296,i%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},ZO=zO(kO),za="",Nm="",eP=function(e){return ZO.get(e)},tP=function(e,t,r){var n=r-2,a=t[n],s=t[r-1],i=t[r];if(s===_m&&i===bm)return za;if(s===_m||s===bm||s===TE||i===_m||i===bm||i===TE)return Nm;if(s===_E&&[_E,Fm,bE,FE].indexOf(i)!==-1||(s===bE||s===Fm)&&(i===Fm||i===Um)||(s===FE||s===Um)&&i===Um||i===UE||i===SE||i===YO||s===JO)return za;if(s===UE&&i===kE){for(;a===SE;)a=t[--n];if(a===kE)return za}if(s===km&&i===km){for(var l=0;a===km;)l++,a=t[--n];if(l%2===0)return za}return Nm},rP=function(e){var t=qO(e),r=t.length,n=0,a=0,s=t.map(eP);return{next:function(){if(n>=r)return{done:!0,value:null};for(var i=za;n<r&&(i=tP(t,s,++n))===za;);if(i!==za||n===r){var l=$O.apply(null,t.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},nP=function(e){for(var t=rP(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},aP=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(e.body.removeChild(n),s===t)return!0}}return!1},AP=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,a=Ld(n.data).map(function(u){return $r(u)}),s=0,i={},l=a.every(function(u,f){r.setStart(n,s),r.setEnd(n,s+u.length);var d=r.getBoundingClientRect();s+=u.length;var p=d.x>i.x||d.y>i.y;return i=d,f===0?!0:p});return e.body.removeChild(t),l},sP=function(){return typeof new Image().crossOrigin<"u"},iP=function(){return typeof new XMLHttpRequest().responseType=="string"},oP=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},NE=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},lP=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=t.toDataURL();a.src=s;var i=Hp(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),IE(i).then(function(l){n.drawImage(l,0,0);var u=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var f=e.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=r+"px",NE(u)?IE(Hp(r,r,0,0,f)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),NE(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Hp=function(e,t,r,n,a){var s="http://www.w3.org/2000/svg",i=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return i.setAttributeNS(null,"width",e.toString()),i.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),i.appendChild(l),l.appendChild(a),i},IE=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},kn={get SUPPORT_RANGE_BOUNDS(){var e=aP(document);return Object.defineProperty(kn,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=kn.SUPPORT_RANGE_BOUNDS&&AP(document);return Object.defineProperty(kn,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=oP(document);return Object.defineProperty(kn,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?lP(document):Promise.resolve(!1);return Object.defineProperty(kn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=sP();return Object.defineProperty(kn,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=iP();return Object.defineProperty(kn,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(kn,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(kn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Wc=(function(){function e(t,r){this.text=t,this.bounds=r}return e})(),cP=function(e,t,r,n){var a=dP(t,r),s=[],i=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(kn.SUPPORT_RANGE_BOUNDS){var u=QE(n,i,l.length).getClientRects();if(u.length>1){var f=Sx(l),d=0;f.forEach(function(x){s.push(new Wc(x,fs.fromDOMRectList(e,QE(n,d+i,x.length).getClientRects()))),d+=x.length})}else s.push(new Wc(l,fs.fromDOMRectList(e,u)))}else{var p=n.splitText(l.length);s.push(new Wc(l,uP(e,n))),n=p}else kn.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));i+=l.length}),s},uP=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var a=t.parentNode;if(a){a.replaceChild(n,t);var s=Md(e,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return fs.EMPTY},QE=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(e,t),a.setEnd(e,t+r),a},Sx=function(e){if(kn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return nP(e)},fP=function(e,t){if(kn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return gP(e,t)},dP=function(e,t){return t.letterSpacing!==0?Sx(e):fP(e,t)},hP=[32,160,4961,65792,65793,4153,4241],gP=function(e,t){for(var r=G6(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],a,s=function(){if(a.value){var i=a.value.slice(),l=Ld(i),u="";l.forEach(function(f){hP.indexOf(f)===-1?u+=$r(f):(u.length&&n.push(u),n.push($r(f)),u="")}),u.length&&n.push(u)}};!(a=r.next()).done;)s();return n},mP=(function(){function e(t,r,n){this.text=pP(r.data,n.textTransform),this.textBounds=cP(t,this.text,n,r)}return e})(),pP=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(xP,vP);case 2:return e.toUpperCase();default:return e}},xP=/(^|\s|:|-|\(|\))([a-z])/g,vP=function(e,t,r){return e.length>0?t+r.toUpperCase():e},h_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return t})(QA),g_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return t})(QA),m_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this,s=new XMLSerializer,i=Md(r,n);return n.setAttribute("width",i.width+"px"),n.setAttribute("height",i.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return t})(QA),p_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.value=n.value,a}return t})(QA),Op=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return t})(QA),wP=[{type:15,flags:0,unit:"px",number:3}],yP=[{type:16,flags:0,number:50}],BP=function(e){return e.width>e.height?new fs(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new fs(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},CP=function(e){var t=e.type===EP?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},od="checkbox",ld="radio",EP="password",RE=707406591,_x=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=CP(n),(a.type===od||a.type===ld)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=BP(a.bounds)),a.type){case od:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=wP;break;case ld:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=yP;break}return a}return t})(QA),x_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return t})(QA),v_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.value=n.value,a}return t})(QA),w_=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=B_(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?zc(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):ss.TRANSPARENT,i=n.contentWindow.document.body?zc(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):ss.TRANSPARENT;a.backgroundColor=ri(s)?ri(i)?a.styles.backgroundColor:i:s}}catch{}return a}return t})(QA),TP=["OL","UL","MENU"],Jf=function(e,t,r,n){for(var a=t.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,C_(a)&&a.data.trim().length>0)r.textNodes.push(new mP(e,a,r.styles));else if(cl(a))if(__(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return Jf(e,l,r,n)});else{var i=y_(e,a);i.styles.isVisible()&&(SP(a,i,n)?i.flags|=4:_P(i.styles)&&(i.flags|=2),TP.indexOf(a.tagName)!==-1&&(i.flags|=8),r.elements.push(i),a.slot,a.shadowRoot?Jf(e,a.shadowRoot,i,n):!cd(a)&&!E_(a)&&!ud(a)&&Jf(e,a,i,n))}},y_=function(e,t){return Gp(t)?new h_(e,t):T_(t)?new g_(e,t):E_(t)?new m_(e,t):bP(t)?new p_(e,t):FP(t)?new Op(e,t):UP(t)?new _x(e,t):ud(t)?new x_(e,t):cd(t)?new v_(e,t):S_(t)?new w_(e,t):new QA(e,t)},B_=function(e,t){var r=y_(e,t);return r.flags|=4,Jf(e,t,r,r),r},SP=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||bx(e)&&r.styles.isTransparent()},_P=function(e){return e.isPositioned()||e.isFloating()},C_=function(e){return e.nodeType===Node.TEXT_NODE},cl=function(e){return e.nodeType===Node.ELEMENT_NODE},Pp=function(e){return cl(e)&&typeof e.style<"u"&&!Yf(e)},Yf=function(e){return typeof e.className=="object"},bP=function(e){return e.tagName==="LI"},FP=function(e){return e.tagName==="OL"},UP=function(e){return e.tagName==="INPUT"},kP=function(e){return e.tagName==="HTML"},E_=function(e){return e.tagName==="svg"},bx=function(e){return e.tagName==="BODY"},T_=function(e){return e.tagName==="CANVAS"},DE=function(e){return e.tagName==="VIDEO"},Gp=function(e){return e.tagName==="IMG"},S_=function(e){return e.tagName==="IFRAME"},ME=function(e){return e.tagName==="STYLE"},NP=function(e){return e.tagName==="SCRIPT"},cd=function(e){return e.tagName==="TEXTAREA"},ud=function(e){return e.tagName==="SELECT"},__=function(e){return e.tagName==="SLOT"},LE=function(e){return e.tagName.indexOf("-")>0},IP=(function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,a=t.counterReset,s=!0;n!==null&&n.forEach(function(l){var u=r.counters[l.counter];u&&l.increment!==0&&(s=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=l.increment)});var i=[];return s&&a.forEach(function(l){var u=r.counters[l.counter];i.push(l.counter),u||(u=r.counters[l.counter]=[]),u.push(l.reset)}),i},e})(),HE={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},OE={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},QP={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},RP={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},qo=function(e,t,r,n,a,s){return e<t||e>r?uu(e,a,s.length>0):n.integers.reduce(function(i,l,u){for(;e>=l;)e-=l,i+=n.values[u];return i},"")+s},b_=function(e,t,r,n){var a="";do r||e--,a=n(e)+a,e/=t;while(e*t>=t);return a},Yr=function(e,t,r,n,a){var s=r-t+1;return(e<0?"-":"")+(b_(Math.abs(e),s,n,function(i){return $r(Math.floor(i%s)+t)})+a)},Ri=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return b_(Math.abs(e),n,!1,function(a){return t[Math.floor(a%n)]})+r},Al=1,zs=2,Xs=4,Oc=8,as=function(e,t,r,n,a,s){if(e<-9999||e>9999)return uu(e,4,a.length>0);var i=Math.abs(e),l=a;if(i===0)return t[0]+l;for(var u=0;i>0&&u<=4;u++){var f=i%10;f===0&&hn(s,Al)&&l!==""?l=t[f]+l:f>1||f===1&&u===0||f===1&&u===1&&hn(s,zs)||f===1&&u===1&&hn(s,Xs)&&e>100||f===1&&u>1&&hn(s,Oc)?l=t[f]+(u>0?r[u-1]:"")+l:f===1&&u>0&&(l=r[u-1]+l),i=Math.floor(i/10)}return(e<0?n:"")+l},PE="",GE="",VE="",Im="",uu=function(e,t,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",i=r?" ":"";switch(t){case 0:return""+i;case 1:return""+i;case 2:return""+i;case 5:var l=Yr(e,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Ri(e,"",a);case 6:return qo(e,1,3999,HE,3,n).toLowerCase();case 7:return qo(e,1,3999,HE,3,n);case 8:return Yr(e,945,969,!1,n);case 9:return Yr(e,97,122,!1,n);case 10:return Yr(e,65,90,!1,n);case 11:return Yr(e,1632,1641,!0,n);case 12:case 49:return qo(e,1,9999,OE,3,n);case 35:return qo(e,1,9999,OE,3,n).toLowerCase();case 13:return Yr(e,2534,2543,!0,n);case 14:case 30:return Yr(e,6112,6121,!0,n);case 15:return Ri(e,"",a);case 16:return Ri(e,"",a);case 17:case 48:return as(e,"",PE,"",a,zs|Xs|Oc);case 47:return as(e,"",GE,"",a,Al|zs|Xs|Oc);case 42:return as(e,"",PE,"",a,zs|Xs|Oc);case 41:return as(e,"",GE,"",a,Al|zs|Xs|Oc);case 26:return as(e,"","",VE,a,0);case 25:return as(e,"","",VE,a,Al|zs|Xs);case 31:return as(e,"","",Im,s,Al|zs|Xs);case 33:return as(e,"","",Im,s,0);case 32:return as(e,"","",Im,s,Al|zs|Xs);case 18:return Yr(e,2406,2415,!0,n);case 20:return qo(e,1,19999,RP,3,n);case 21:return Yr(e,2790,2799,!0,n);case 22:return Yr(e,2662,2671,!0,n);case 22:return qo(e,1,10999,QP,3,n);case 23:return Ri(e,"");case 24:return Ri(e,"");case 27:return Yr(e,3302,3311,!0,n);case 28:return Ri(e,"",a);case 29:return Ri(e,"",a);case 34:return Yr(e,3792,3801,!0,n);case 37:return Yr(e,6160,6169,!0,n);case 38:return Yr(e,4160,4169,!0,n);case 39:return Yr(e,2918,2927,!0,n);case 40:return Yr(e,1776,1785,!0,n);case 43:return Yr(e,3046,3055,!0,n);case 44:return Yr(e,3174,3183,!0,n);case 45:return Yr(e,3664,3673,!0,n);case 46:return Yr(e,3872,3881,!0,n);case 3:default:return Yr(e,48,57,!0,n)}},F_="data-html2canvas-ignore",KE=(function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new IP,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,a=DP(t,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,i=t.defaultView.pageYOffset,l=a.contentWindow,u=l.document,f=HP(a).then(function(){return $n(n,void 0,void 0,function(){var d,p;return Ln(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(VP),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,p=this.clonedReferenceElement,typeof p>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,LP(u)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(u,p)}).then(function(){return a})]:[2,a]}})})});return u.open(),u.write(PP(document.doctype)+"<html></html>"),GP(this.referenceElement.ownerDocument,s,i),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),f},e.prototype.createElementClone=function(t){if(Lp(t,2))debugger;if(T_(t))return this.createCanvasClone(t);if(DE(t))return this.createVideoClone(t);if(ME(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return Gp(r)&&(Gp(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),LE(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return Qm(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,i){return i&&typeof i.cssText=="string"?s+i.cssText:s},""),a=t.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var a=t.cloneNode(!1);try{a.width=t.width,a.height=t.height;var s=t.getContext("2d"),i=a.getContext("2d");if(i)if(!this.options.allowTaint&&s)i.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var u=l.getContextAttributes();(u==null?void 0:u.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}i.drawImage(t,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return a},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var a=t.ownerDocument.createElement("canvas");return a.width=t.offsetWidth,a.height=t.offsetHeight,a},e.prototype.appendChildNode=function(t,r,n){(!cl(r)||!NP(r)&&!r.hasAttribute(F_)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!cl(r)||!ME(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var a=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(cl(s)&&__(s)&&typeof s.assignedNodes=="function"){var i=s.assignedNodes();i.length&&i.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},e.prototype.cloneNode=function(t,r){if(C_(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&cl(t)&&(Pp(t)||Yf(t))){var a=this.createElementClone(t);a.style.transitionProperty="none";var s=n.getComputedStyle(t),i=n.getComputedStyle(t,":before"),l=n.getComputedStyle(t,":after");this.referenceElement===t&&Pp(a)&&(this.clonedReferenceElement=a),bx(a)&&zP(a);var u=this.counters.parse(new yE(this.context,s)),f=this.resolvePseudoContent(t,a,i,Jc.BEFORE);LE(t)&&(r=!0),DE(t)||this.cloneChildNodes(t,a,r),f&&a.insertBefore(f,a.firstChild);var d=this.resolvePseudoContent(t,a,l,Jc.AFTER);return d&&a.appendChild(d),this.counters.pop(u),(s&&(this.options.copyStyles||Yf(t))&&!S_(t)||r)&&Qm(s,a),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([a,t.scrollLeft,t.scrollTop]),(cd(t)||ud(t))&&(cd(a)||ud(a))&&(a.value=t.value),a}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,a){var s=this;if(n){var i=n.content,l=r.ownerDocument;if(!(!l||!i||i==="none"||i==="-moz-alt-content"||n.display==="none")){this.counters.parse(new yE(this.context,n));var u=new bO(this.context,n),f=l.createElement("html2canvaspseudoelement");Qm(n,f),u.content.forEach(function(p){if(p.type===0)f.appendChild(l.createTextNode(p.value));else if(p.type===22){var x=l.createElement("img");x.src=p.value,x.style.opacity="1",f.appendChild(x)}else if(p.type===18){if(p.name==="attr"){var y=p.values.filter(yr);y.length&&f.appendChild(l.createTextNode(t.getAttribute(y[0].value)||""))}else if(p.name==="counter"){var C=p.values.filter(vl),E=C[0],T=C[1];if(E&&yr(E)){var S=s.counters.getCounterValue(E.value),F=T&&yr(T)?Mp.parse(s.context,T.value):3;f.appendChild(l.createTextNode(uu(S,F,!1)))}}else if(p.name==="counters"){var _=p.values.filter(vl),E=_[0],N=_[1],T=_[2];if(E&&yr(E)){var I=s.counters.getCounterValues(E.value),U=T&&yr(T)?Mp.parse(s.context,T.value):3,k=N&&N.type===0?N.value:"",G=I.map(function(re){return uu(re,U,!1)}).join(k);f.appendChild(l.createTextNode(G))}}}else if(p.type===20)switch(p.value){case"open-quote":f.appendChild(l.createTextNode(wE(u.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(l.createTextNode(wE(u.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(l.createTextNode(p.value))}}),f.className=Vp+" "+Kp;var d=a===Jc.BEFORE?" "+Vp:" "+Kp;return Yf(r)?r.className.baseValue+=d:r.className+=d,f}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e})(),Jc;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(Jc||(Jc={}));var DP=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(F_,"true"),e.body.appendChild(r),r},MP=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},LP=function(e){return Promise.all([].slice.call(e.images,0).map(MP))},HP=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),t(e))},50)}})},OP=["all","d","content"],Qm=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);OP.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},PP=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},GP=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},VP=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},KP=":before",jP=":after",Vp="___html2canvas___pseudoelement_before",Kp="___html2canvas___pseudoelement_after",jE=`{
    content: "" !important;
    display: none !important;
}`,zP=function(e){XP(e,"."+Vp+KP+jE+`
         .`+Kp+jP+jE)},XP=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},U_=(function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e})(),WP=(function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(Dm(t)||$P(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return $n(this,void 0,void 0,function(){var r,n,a,s,i=this;return Ln(this,function(l){switch(l.label){case 0:return r=U_.isSameOrigin(t),n=!Rm(t)&&this._options.useCORS===!0&&kn.SUPPORT_CORS_IMAGES&&!r,a=!Rm(t)&&!r&&!Dm(t)&&typeof this._options.proxy=="string"&&kn.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!Rm(t)&&!Dm(t)&&!a&&!n?[2]:(s=t,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(u,f){var d=new Image;d.onload=function(){return u(d)},d.onerror=f,(ZP(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return u(d)},500),i._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+i._options.imageTimeout+"ms) loading image")},i._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=t.substring(0,256);return new Promise(function(s,i){var l=kn.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(l==="text")s(u.response);else{var p=new FileReader;p.addEventListener("load",function(){return s(p.result)},!1),p.addEventListener("error",function(x){return i(x)},!1),p.readAsDataURL(u.response)}else i("Failed to proxy resource "+a+" with status code "+u.status)},u.onerror=i;var f=n.indexOf("?")>-1?"&":"?";if(u.open("GET",""+n+f+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;u.timeout=d,u.ontimeout=function(){return i("Timed out ("+d+"ms) proxying "+a)}}u.send()})},e})(),JP=/^data:image\/svg\+xml/i,YP=/^data:image\/.*;base64,/i,qP=/^data:image\/.*/i,$P=function(e){return kn.SUPPORT_SVG_DRAWING||!e7(e)},Rm=function(e){return qP.test(e)},ZP=function(e){return YP.test(e)},Dm=function(e){return e.substr(0,4)==="blob"},e7=function(e){return e.substr(-3).toLowerCase()==="svg"||JP.test(e)},$e=(function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e})(),$o=function(e,t,r){return new $e(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},yf=(function(){function e(t,r,n,a){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=a}return e.prototype.subdivide=function(t,r){var n=$o(this.start,this.startControl,t),a=$o(this.startControl,this.endControl,t),s=$o(this.endControl,this.end,t),i=$o(n,a,t),l=$o(a,s,t),u=$o(i,l,t);return r?new e(this.start,n,i,u):new e(u,l,s,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),Ja=function(e){return e.type===1},t7=(function(){function e(t){var r=t.styles,n=t.bounds,a=Lc(r.borderTopLeftRadius,n.width,n.height),s=a[0],i=a[1],l=Lc(r.borderTopRightRadius,n.width,n.height),u=l[0],f=l[1],d=Lc(r.borderBottomRightRadius,n.width,n.height),p=d[0],x=d[1],y=Lc(r.borderBottomLeftRadius,n.width,n.height),C=y[0],E=y[1],T=[];T.push((s+u)/n.width),T.push((C+p)/n.width),T.push((i+E)/n.height),T.push((f+x)/n.height);var S=Math.max.apply(Math,T);S>1&&(s/=S,i/=S,u/=S,f/=S,p/=S,x/=S,C/=S,E/=S);var F=n.width-u,_=n.height-x,N=n.width-p,I=n.height-E,U=r.borderTopWidth,k=r.borderRightWidth,G=r.borderBottomWidth,M=r.borderLeftWidth,ee=Tr(r.paddingTop,t.bounds.width),re=Tr(r.paddingRight,t.bounds.width),q=Tr(r.paddingBottom,t.bounds.width),se=Tr(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||i>0?Rr(n.left+M/3,n.top+U/3,s-M/3,i-U/3,or.TOP_LEFT):new $e(n.left+M/3,n.top+U/3),this.topRightBorderDoubleOuterBox=s>0||i>0?Rr(n.left+F,n.top+U/3,u-k/3,f-U/3,or.TOP_RIGHT):new $e(n.left+n.width-k/3,n.top+U/3),this.bottomRightBorderDoubleOuterBox=p>0||x>0?Rr(n.left+N,n.top+_,p-k/3,x-G/3,or.BOTTOM_RIGHT):new $e(n.left+n.width-k/3,n.top+n.height-G/3),this.bottomLeftBorderDoubleOuterBox=C>0||E>0?Rr(n.left+M/3,n.top+I,C-M/3,E-G/3,or.BOTTOM_LEFT):new $e(n.left+M/3,n.top+n.height-G/3),this.topLeftBorderDoubleInnerBox=s>0||i>0?Rr(n.left+M*2/3,n.top+U*2/3,s-M*2/3,i-U*2/3,or.TOP_LEFT):new $e(n.left+M*2/3,n.top+U*2/3),this.topRightBorderDoubleInnerBox=s>0||i>0?Rr(n.left+F,n.top+U*2/3,u-k*2/3,f-U*2/3,or.TOP_RIGHT):new $e(n.left+n.width-k*2/3,n.top+U*2/3),this.bottomRightBorderDoubleInnerBox=p>0||x>0?Rr(n.left+N,n.top+_,p-k*2/3,x-G*2/3,or.BOTTOM_RIGHT):new $e(n.left+n.width-k*2/3,n.top+n.height-G*2/3),this.bottomLeftBorderDoubleInnerBox=C>0||E>0?Rr(n.left+M*2/3,n.top+I,C-M*2/3,E-G*2/3,or.BOTTOM_LEFT):new $e(n.left+M*2/3,n.top+n.height-G*2/3),this.topLeftBorderStroke=s>0||i>0?Rr(n.left+M/2,n.top+U/2,s-M/2,i-U/2,or.TOP_LEFT):new $e(n.left+M/2,n.top+U/2),this.topRightBorderStroke=s>0||i>0?Rr(n.left+F,n.top+U/2,u-k/2,f-U/2,or.TOP_RIGHT):new $e(n.left+n.width-k/2,n.top+U/2),this.bottomRightBorderStroke=p>0||x>0?Rr(n.left+N,n.top+_,p-k/2,x-G/2,or.BOTTOM_RIGHT):new $e(n.left+n.width-k/2,n.top+n.height-G/2),this.bottomLeftBorderStroke=C>0||E>0?Rr(n.left+M/2,n.top+I,C-M/2,E-G/2,or.BOTTOM_LEFT):new $e(n.left+M/2,n.top+n.height-G/2),this.topLeftBorderBox=s>0||i>0?Rr(n.left,n.top,s,i,or.TOP_LEFT):new $e(n.left,n.top),this.topRightBorderBox=u>0||f>0?Rr(n.left+F,n.top,u,f,or.TOP_RIGHT):new $e(n.left+n.width,n.top),this.bottomRightBorderBox=p>0||x>0?Rr(n.left+N,n.top+_,p,x,or.BOTTOM_RIGHT):new $e(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=C>0||E>0?Rr(n.left,n.top+I,C,E,or.BOTTOM_LEFT):new $e(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||i>0?Rr(n.left+M,n.top+U,Math.max(0,s-M),Math.max(0,i-U),or.TOP_LEFT):new $e(n.left+M,n.top+U),this.topRightPaddingBox=u>0||f>0?Rr(n.left+Math.min(F,n.width-k),n.top+U,F>n.width+k?0:Math.max(0,u-k),Math.max(0,f-U),or.TOP_RIGHT):new $e(n.left+n.width-k,n.top+U),this.bottomRightPaddingBox=p>0||x>0?Rr(n.left+Math.min(N,n.width-M),n.top+Math.min(_,n.height-G),Math.max(0,p-k),Math.max(0,x-G),or.BOTTOM_RIGHT):new $e(n.left+n.width-k,n.top+n.height-G),this.bottomLeftPaddingBox=C>0||E>0?Rr(n.left+M,n.top+Math.min(I,n.height-G),Math.max(0,C-M),Math.max(0,E-G),or.BOTTOM_LEFT):new $e(n.left+M,n.top+n.height-G),this.topLeftContentBox=s>0||i>0?Rr(n.left+M+se,n.top+U+ee,Math.max(0,s-(M+se)),Math.max(0,i-(U+ee)),or.TOP_LEFT):new $e(n.left+M+se,n.top+U+ee),this.topRightContentBox=u>0||f>0?Rr(n.left+Math.min(F,n.width+M+se),n.top+U+ee,F>n.width+M+se?0:u-M+se,f-(U+ee),or.TOP_RIGHT):new $e(n.left+n.width-(k+re),n.top+U+ee),this.bottomRightContentBox=p>0||x>0?Rr(n.left+Math.min(N,n.width-(M+se)),n.top+Math.min(_,n.height+U+ee),Math.max(0,p-(k+re)),x-(G+q),or.BOTTOM_RIGHT):new $e(n.left+n.width-(k+re),n.top+n.height-(G+q)),this.bottomLeftContentBox=C>0||E>0?Rr(n.left+M+se,n.top+I,Math.max(0,C-(M+se)),E-(G+q),or.BOTTOM_LEFT):new $e(n.left+M+se,n.top+n.height-(G+q))}return e})(),or;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(or||(or={}));var Rr=function(e,t,r,n,a){var s=4*((Math.sqrt(2)-1)/3),i=r*s,l=n*s,u=e+r,f=t+n;switch(a){case or.TOP_LEFT:return new yf(new $e(e,f),new $e(e,f-l),new $e(u-i,t),new $e(u,t));case or.TOP_RIGHT:return new yf(new $e(e,t),new $e(e+i,t),new $e(u,f-l),new $e(u,f));case or.BOTTOM_RIGHT:return new yf(new $e(u,t),new $e(u,t+l),new $e(e+i,f),new $e(e,f));case or.BOTTOM_LEFT:default:return new yf(new $e(u,f),new $e(u-i,f),new $e(e,t+l),new $e(e,t))}},fd=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},r7=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},dd=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},n7=(function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e})(),Bf=(function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e})(),a7=(function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e})(),A7=function(e){return e.type===0},k_=function(e){return e.type===1},s7=function(e){return e.type===2},zE=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},i7=function(e,t,r,n,a){return e.map(function(s,i){switch(i){case 0:return s.add(t,r);case 1:return s.add(t+n,r);case 2:return s.add(t+n,r+a);case 3:return s.add(t,r+a)}return s})},N_=(function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),I_=(function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new t7(this.container),this.container.styles.opacity<1&&this.effects.push(new a7(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new n7(n,a,s))}if(this.container.styles.overflowX!==0){var i=fd(this.curves),l=dd(this.curves);zE(i,l)?this.effects.push(new Bf(i,6)):(this.effects.push(new Bf(i,2)),this.effects.push(new Bf(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(u){return!k_(u)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var i=fd(n.curves),l=dd(n.curves);zE(i,l)||a.unshift(new Bf(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(u){return hn(u.target,t)})},e})(),jp=function(e,t,r,n){e.container.elements.forEach(function(a){var s=hn(a.flags,4),i=hn(a.flags,2),l=new I_(a,e);hn(a.styles.display,2048)&&n.push(l);var u=hn(a.flags,8)?[]:n;if(s||i){var f=s||a.styles.isPositioned()?r:t,d=new N_(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var p=a.styles.zIndex.order;if(p<0){var x=0;f.negativeZIndex.some(function(C,E){return p>C.element.container.styles.zIndex.order?(x=E,!1):x>0}),f.negativeZIndex.splice(x,0,d)}else if(p>0){var y=0;f.positiveZIndex.some(function(C,E){return p>=C.element.container.styles.zIndex.order?(y=E+1,!1):y>0}),f.positiveZIndex.splice(y,0,d)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?f.nonPositionedFloats.push(d):f.nonPositionedInlineLevel.push(d);jp(l,d,s?d:r,u)}else a.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),jp(l,t,r,u);hn(a.flags,8)&&Q_(a,u)})},Q_=function(e,t){for(var r=e instanceof Op?e.start:1,n=e instanceof Op?e.reversed:!1,a=0;a<t.length;a++){var s=t[a];s.container instanceof p_&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=uu(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},o7=function(e){var t=new I_(e,null),r=new N_(t),n=[];return jp(t,r,r,n),Q_(t.container,n),r},XE=function(e,t){switch(t){case 0:return qa(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return qa(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return qa(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return qa(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},l7=function(e,t){switch(t){case 0:return qa(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return qa(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return qa(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return qa(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},c7=function(e,t){switch(t){case 0:return qa(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return qa(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return qa(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return qa(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},u7=function(e,t){switch(t){case 0:return Cf(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Cf(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Cf(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Cf(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Cf=function(e,t){var r=[];return Ja(e)?r.push(e.subdivide(.5,!1)):r.push(e),Ja(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},qa=function(e,t,r,n){var a=[];return Ja(e)?a.push(e.subdivide(.5,!1)):a.push(e),Ja(r)?a.push(r.subdivide(.5,!0)):a.push(r),Ja(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),Ja(t)?a.push(t.subdivide(.5,!1).reverse()):a.push(t),a},R_=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},hd=function(e){var t=e.styles,r=e.bounds,n=Tr(t.paddingLeft,r.width),a=Tr(t.paddingRight,r.width),s=Tr(t.paddingTop,r.width),i=Tr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+a),-(t.borderTopWidth+t.borderBottomWidth+s+i))},f7=function(e,t){return e===0?t.bounds:e===2?hd(t):R_(t)},d7=function(e,t){return e===0?t.bounds:e===2?hd(t):R_(t)},Mm=function(e,t,r){var n=f7(sl(e.styles.backgroundOrigin,t),e),a=d7(sl(e.styles.backgroundClip,t),e),s=h7(sl(e.styles.backgroundSize,t),r,n),i=s[0],l=s[1],u=Lc(sl(e.styles.backgroundPosition,t),n.width-i,n.height-l),f=g7(sl(e.styles.backgroundRepeat,t),u,s,n,a),d=Math.round(n.left+u[0]),p=Math.round(n.top+u[1]);return[f,d,p,i,l]},Zo=function(e){return yr(e)&&e.value===hl.AUTO},Ef=function(e){return typeof e=="number"},h7=function(e,t,r){var n=t[0],a=t[1],s=t[2],i=e[0],l=e[1];if(!i)return[0,0];if(cn(i)&&l&&cn(l))return[Tr(i,r.width),Tr(l,r.height)];var u=Ef(s);if(yr(i)&&(i.value===hl.CONTAIN||i.value===hl.COVER)){if(Ef(s)){var f=r.width/r.height;return f<s!=(i.value===hl.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=Ef(n),p=Ef(a),x=d||p;if(Zo(i)&&(!l||Zo(l))){if(d&&p)return[n,a];if(!u&&!x)return[r.width,r.height];if(x&&u){var y=d?n:a*s,C=p?a:n/s;return[y,C]}var E=d?n:r.width,T=p?a:r.height;return[E,T]}if(u){var S=0,F=0;return cn(i)?S=Tr(i,r.width):cn(l)&&(F=Tr(l,r.height)),Zo(i)?S=F*s:(!l||Zo(l))&&(F=S/s),[S,F]}var _=null,N=null;if(cn(i)?_=Tr(i,r.width):l&&cn(l)&&(N=Tr(l,r.height)),_!==null&&(!l||Zo(l))&&(N=d&&p?_/n*a:r.height),N!==null&&Zo(i)&&(_=d&&p?N/a*n:r.width),_!==null&&N!==null)return[_,N];throw new Error("Unable to calculate background-size for element")},sl=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},g7=function(e,t,r,n,a){var s=t[0],i=t[1],l=r[0],u=r[1];switch(e){case 2:return[new $e(Math.round(n.left),Math.round(n.top+i)),new $e(Math.round(n.left+n.width),Math.round(n.top+i)),new $e(Math.round(n.left+n.width),Math.round(u+n.top+i)),new $e(Math.round(n.left),Math.round(u+n.top+i))];case 3:return[new $e(Math.round(n.left+s),Math.round(n.top)),new $e(Math.round(n.left+s+l),Math.round(n.top)),new $e(Math.round(n.left+s+l),Math.round(n.height+n.top)),new $e(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new $e(Math.round(n.left+s),Math.round(n.top+i)),new $e(Math.round(n.left+s+l),Math.round(n.top+i)),new $e(Math.round(n.left+s+l),Math.round(n.top+i+u)),new $e(Math.round(n.left+s),Math.round(n.top+i+u))];default:return[new $e(Math.round(a.left),Math.round(a.top)),new $e(Math.round(a.left+a.width),Math.round(a.top)),new $e(Math.round(a.left+a.width),Math.round(a.height+a.top)),new $e(Math.round(a.left),Math.round(a.height+a.top))]}},m7="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",WE="Hidden Text",p7=(function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),i=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",i.appendChild(n),a.src=m7,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(WE)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(WE)),n.style.lineHeight="normal",a.style.verticalAlign="super";var u=a.offsetTop-n.offsetTop+2;return i.removeChild(n),{baseline:l,middle:u}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e})(),D_=(function(){function e(t,r){this.context=t,this.options=r}return e})(),x7=1e4,v7=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new p7(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},t.prototype.applyEffect=function(r){this.ctx.save(),s7(r)&&(this.ctx.globalAlpha=r.opacity),A7(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),k_(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return $n(this,void 0,void 0,function(){var n;return Ln(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return $n(this,void 0,void 0,function(){return Ln(this,function(n){switch(n.label){case 0:if(hn(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var i=Sx(r.text);i.reduce(function(l,u){return s.ctx.fillText(u,l,r.bounds.top+a),l+s.ctx.measureText(u).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(i){return i==="normal"||i==="small-caps"}).join(""),a=E7(r.fontFamily).join(", "),s=ku(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},t.prototype.renderTextNode=function(r,n){return $n(this,void 0,void 0,function(){var a,s,i,l,u,f,d,p,x=this;return Ln(this,function(y){return a=this.createFontStyle(n),s=a[0],i=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(i,l),f=u.baseline,d=u.middle,p=n.paintOrder,r.textBounds.forEach(function(C){p.forEach(function(E){switch(E){case 0:x.ctx.fillStyle=wn(n.color),x.renderTextWithLetterSpacing(C,n.letterSpacing,f);var T=n.textShadow;T.length&&C.text.trim().length&&(T.slice(0).reverse().forEach(function(S){x.ctx.shadowColor=wn(S.color),x.ctx.shadowOffsetX=S.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=S.offsetY.number*x.options.scale,x.ctx.shadowBlur=S.blur.number,x.renderTextWithLetterSpacing(C,n.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=wn(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(S){switch(S){case 1:x.ctx.fillRect(C.bounds.left,Math.round(C.bounds.top+f),C.bounds.width,1);break;case 2:x.ctx.fillRect(C.bounds.left,Math.round(C.bounds.top),C.bounds.width,1);break;case 3:x.ctx.fillRect(C.bounds.left,Math.ceil(C.bounds.top+d),C.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&C.text.trim().length&&(x.ctx.strokeStyle=wn(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(C.text,C.bounds.left,C.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=hd(r),i=dd(n);this.path(i),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return $n(this,void 0,void 0,function(){var n,a,s,i,l,u,F,F,f,d,p,x,N,y,C,I,E,T,S,F,_,N,I;return Ln(this,function(U){switch(U.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,i=0,l=n.textNodes,U.label=1;case 1:return i<l.length?(u=l[i],[4,this.renderTextNode(u,s)]):[3,4];case 2:U.sent(),U.label=3;case 3:return i++,[3,1];case 4:if(!(n instanceof h_))return[3,8];U.label=5;case 5:return U.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return F=U.sent(),this.renderReplacedElement(n,a,F),[3,8];case 7:return U.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof g_&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof m_))return[3,12];U.label=9;case 9:return U.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return F=U.sent(),this.renderReplacedElement(n,a,F),[3,12];case 11:return U.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof w_&&n.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,f.render(n.tree)]):[3,14];case 13:d=U.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),U.label=14;case 14:if(n instanceof _x&&(p=Math.min(n.bounds.width,n.bounds.height),n.type===od?n.checked&&(this.ctx.save(),this.path([new $e(n.bounds.left+p*.39363,n.bounds.top+p*.79),new $e(n.bounds.left+p*.16,n.bounds.top+p*.5549),new $e(n.bounds.left+p*.27347,n.bounds.top+p*.44071),new $e(n.bounds.left+p*.39694,n.bounds.top+p*.5649),new $e(n.bounds.left+p*.72983,n.bounds.top+p*.23),new $e(n.bounds.left+p*.84,n.bounds.top+p*.34085),new $e(n.bounds.left+p*.39363,n.bounds.top+p*.79)]),this.ctx.fillStyle=wn(RE),this.ctx.fill(),this.ctx.restore()):n.type===ld&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+p/2,n.bounds.top+p/2,p/4,0,Math.PI*2,!0),this.ctx.fillStyle=wn(RE),this.ctx.fill(),this.ctx.restore())),w7(n)&&n.value.length){switch(x=this.createFontStyle(s),N=x[0],y=x[1],C=this.fontMetrics.getMetrics(N,y).baseline,this.ctx.font=N,this.ctx.fillStyle=wn(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=B7(n.styles.textAlign),I=hd(n),E=0,n.styles.textAlign){case 1:E+=I.width/2;break;case 2:E+=I.width;break}T=I.add(E,0,0,-I.height/2+1),this.ctx.save(),this.path([new $e(I.left,I.top),new $e(I.left+I.width,I.top),new $e(I.left+I.width,I.top+I.height),new $e(I.left,I.top+I.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Wc(n.value,T),s.letterSpacing,C),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!hn(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(S=n.styles.listStyleImage,S.type!==0)return[3,18];F=void 0,_=S.url,U.label=15;case 15:return U.trys.push([15,17,,18]),[4,this.context.cache.match(_)];case 16:return F=U.sent(),this.ctx.drawImage(F,n.bounds.left-(F.width+10),n.bounds.top),[3,18];case 17:return U.sent(),this.context.logger.error("Error loading list-style-image "+_),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(N=this.createFontStyle(s)[0],this.ctx.font=N,this.ctx.fillStyle=wn(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",I=new fs(n.bounds.left,n.bounds.top+Tr(n.styles.paddingTop,n.bounds.width),n.bounds.width,xE(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Wc(r.listValue,I),s.letterSpacing,xE(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),U.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return $n(this,void 0,void 0,function(){var n,a,S,s,i,S,l,u,S,f,d,S,p,x,S,y,C,S,E,T,S;return Ln(this,function(F){switch(F.label){case 0:if(hn(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:F.sent(),n=0,a=r.negativeZIndex,F.label=2;case 2:return n<a.length?(S=a[n],[4,this.renderStack(S)]):[3,5];case 3:F.sent(),F.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:F.sent(),s=0,i=r.nonInlineLevel,F.label=7;case 7:return s<i.length?(S=i[s],[4,this.renderNode(S)]):[3,10];case 8:F.sent(),F.label=9;case 9:return s++,[3,7];case 10:l=0,u=r.nonPositionedFloats,F.label=11;case 11:return l<u.length?(S=u[l],[4,this.renderStack(S)]):[3,14];case 12:F.sent(),F.label=13;case 13:return l++,[3,11];case 14:f=0,d=r.nonPositionedInlineLevel,F.label=15;case 15:return f<d.length?(S=d[f],[4,this.renderStack(S)]):[3,18];case 16:F.sent(),F.label=17;case 17:return f++,[3,15];case 18:p=0,x=r.inlineLevel,F.label=19;case 19:return p<x.length?(S=x[p],[4,this.renderNode(S)]):[3,22];case 20:F.sent(),F.label=21;case 21:return p++,[3,19];case 22:y=0,C=r.zeroOrAutoZIndexOrTransformedOrOpacity,F.label=23;case 23:return y<C.length?(S=C[y],[4,this.renderStack(S)]):[3,26];case 24:F.sent(),F.label=25;case 25:return y++,[3,23];case 26:E=0,T=r.positiveZIndex,F.label=27;case 27:return E<T.length?(S=T[E],[4,this.renderStack(S)]):[3,30];case 28:F.sent(),F.label=29;case 29:return E++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var i=Ja(a)?a.start:a;s===0?n.ctx.moveTo(i.x,i.y):n.ctx.lineTo(i.x,i.y),Ja(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},t.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},t.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var i=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=i.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var u=l.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},t.prototype.renderBackgroundImage=function(r){return $n(this,void 0,void 0,function(){var n,a,s,i,l,u;return Ln(this,function(f){switch(f.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var p,x,y,ee,Z,ie,se,Te,G,C,ee,Z,ie,se,Te,E,T,S,F,_,N,I,U,k,G,M,ee,re,q,se,Te,Be,Z,ie,Qe,ae,Le,Y,Q,K,P,z;return Ln(this,function(ce){switch(ce.label){case 0:if(d.type!==0)return[3,5];p=void 0,x=d.url,ce.label=1;case 1:return ce.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return p=ce.sent(),[3,4];case 3:return ce.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return p&&(y=Mm(r,n,[p.width,p.height,p.width/p.height]),ee=y[0],Z=y[1],ie=y[2],se=y[3],Te=y[4],G=s.ctx.createPattern(s.resizeImage(p,se,Te),"repeat"),s.renderRepeat(ee,G,Z,ie)),[3,6];case 5:A8(d)?(C=Mm(r,n,[null,null,null]),ee=C[0],Z=C[1],ie=C[2],se=C[3],Te=C[4],E=e8(d.angle,se,Te),T=E[0],S=E[1],F=E[2],_=E[3],N=E[4],I=document.createElement("canvas"),I.width=se,I.height=Te,U=I.getContext("2d"),k=U.createLinearGradient(S,_,F,N),mE(d.stops,T).forEach(function(Ce){return k.addColorStop(Ce.stop,wn(Ce.color))}),U.fillStyle=k,U.fillRect(0,0,se,Te),se>0&&Te>0&&(G=s.ctx.createPattern(I,"repeat"),s.renderRepeat(ee,G,Z,ie))):s8(d)&&(M=Mm(r,n,[null,null,null]),ee=M[0],re=M[1],q=M[2],se=M[3],Te=M[4],Be=d.position.length===0?[Cx]:d.position,Z=Tr(Be[0],se),ie=Tr(Be[Be.length-1],Te),Qe=t8(d,Z,ie,se,Te),ae=Qe[0],Le=Qe[1],ae>0&&Le>0&&(Y=s.ctx.createRadialGradient(re+Z,q+ie,0,re+Z,q+ie,ae),mE(d.stops,ae*2).forEach(function(Ce){return Y.addColorStop(Ce.stop,wn(Ce.color))}),s.path(ee),s.ctx.fillStyle=Y,ae!==Le?(Q=r.bounds.left+.5*r.bounds.width,K=r.bounds.top+.5*r.bounds.height,P=Le/ae,z=1/P,s.ctx.save(),s.ctx.translate(Q,K),s.ctx.transform(1,0,0,P,0,0),s.ctx.translate(-Q,-K),s.ctx.fillRect(re,z*(q-K)+K,se,Te*z),s.ctx.restore()):s.ctx.fill())),ce.label=6;case 6:return n--,[2]}})},s=this,i=0,l=r.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return i<l.length?(u=l[i],[5,a(u)]):[3,4];case 2:f.sent(),f.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,a){return $n(this,void 0,void 0,function(){return Ln(this,function(s){return this.path(XE(a,n)),this.ctx.fillStyle=wn(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,a,s){return $n(this,void 0,void 0,function(){var i,l;return Ln(this,function(u){switch(u.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return u.sent(),[2];case 2:return i=l7(s,a),this.path(i),this.ctx.fillStyle=wn(r),this.ctx.fill(),l=c7(s,a),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return $n(this,void 0,void 0,function(){var n,a,s,i,l,u,f,d,p=this;return Ln(this,function(x){switch(x.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!ri(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],i=y7(sl(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(i),this.ctx.clip(),ri(n.backgroundColor)||(this.ctx.fillStyle=wn(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(y){p.ctx.save();var C=fd(r.curves),E=y.inset?0:x7,T=i7(C,-E+(y.inset?1:-1)*y.spread.number,(y.inset?1:-1)*y.spread.number,y.spread.number*(y.inset?-2:2),y.spread.number*(y.inset?-2:2));y.inset?(p.path(C),p.ctx.clip(),p.mask(T)):(p.mask(C),p.ctx.clip(),p.path(T)),p.ctx.shadowOffsetX=y.offsetX.number+E,p.ctx.shadowOffsetY=y.offsetY.number,p.ctx.shadowColor=wn(y.color),p.ctx.shadowBlur=y.blur.number,p.ctx.fillStyle=y.inset?wn(y.color):"rgba(0,0,0,1)",p.ctx.fill(),p.ctx.restore()}),x.label=2;case 2:l=0,u=0,f=s,x.label=3;case 3:return u<f.length?(d=f[u],d.style!==0&&!ri(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return x.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:x.sent(),x.label=11;case 11:l++,x.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,a,s,i){return $n(this,void 0,void 0,function(){var l,u,f,d,p,x,y,C,E,T,S,F,_,N,I,U,I,U;return Ln(this,function(k){return this.ctx.save(),l=u7(s,a),u=XE(s,a),i===2&&(this.path(u),this.ctx.clip()),Ja(u[0])?(f=u[0].start.x,d=u[0].start.y):(f=u[0].x,d=u[0].y),Ja(u[1])?(p=u[1].end.x,x=u[1].end.y):(p=u[1].x,x=u[1].y),a===0||a===2?y=Math.abs(f-p):y=Math.abs(d-x),this.ctx.beginPath(),i===3?this.formatPath(l):this.formatPath(u.slice(0,2)),C=n<3?n*3:n*2,E=n<3?n*2:n,i===3&&(C=n,E=n),T=!0,y<=C*2?T=!1:y<=C*2+E?(S=y/(2*C+E),C*=S,E*=S):(F=Math.floor((y+E)/(C+E)),_=(y-F*C)/(F-1),N=(y-(F+1)*C)/F,E=N<=0||Math.abs(E-_)<Math.abs(E-N)?_:N),T&&(i===3?this.ctx.setLineDash([0,C+E]):this.ctx.setLineDash([C,E])),i===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=wn(r),this.ctx.stroke(),this.ctx.setLineDash([]),i===2&&(Ja(u[0])&&(I=u[3],U=u[0],this.ctx.beginPath(),this.formatPath([new $e(I.end.x,I.end.y),new $e(U.start.x,U.start.y)]),this.ctx.stroke()),Ja(u[1])&&(I=u[1],U=u[2],this.ctx.beginPath(),this.formatPath([new $e(I.end.x,I.end.y),new $e(U.start.x,U.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return $n(this,void 0,void 0,function(){var n;return Ln(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=wn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=o7(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},t})(D_),w7=function(e){return e instanceof v_||e instanceof x_?!0:e instanceof _x&&e.type!==ld&&e.type!==od},y7=function(e,t){switch(e){case 0:return fd(t);case 2:return r7(t);case 1:default:return dd(t)}},B7=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},C7=["-apple-system","system-ui"],E7=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return C7.indexOf(t)===-1}):e},T7=(function(e){xA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return t.prototype.render=function(r){return $n(this,void 0,void 0,function(){var n,a;return Ln(this,function(s){switch(s.label){case 0:return n=Hp(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,S7(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=wn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t})(D_),S7=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},_7=(function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,tf([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,tf([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,tf([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,tf([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e})(),b7=(function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new _7({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new WP(this,t)}return e.instanceCount=1,e})(),Yc=function(e,t){return t===void 0&&(t={}),F7(e,t)};typeof window<"u"&&U_.setContext(window);var F7=function(e,t){return $n(void 0,void 0,void 0,function(){var r,n,a,s,i,l,u,f,d,p,x,y,C,E,T,S,F,_,N,I,k,U,k,G,M,ee,re,q,se,Te,Be,Z,ie,Qe,ae,Le,Y,Q,K,P;return Ln(this,function(z){switch(z.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(G=t.allowTaint)!==null&&G!==void 0?G:!1,imageTimeout:(M=t.imageTimeout)!==null&&M!==void 0?M:15e3,proxy:t.proxy,useCORS:(ee=t.useCORS)!==null&&ee!==void 0?ee:!1},s=Ep({logging:(re=t.logging)!==null&&re!==void 0?re:!0,cache:t.cache},a),i={windowWidth:(q=t.windowWidth)!==null&&q!==void 0?q:n.innerWidth,windowHeight:(se=t.windowHeight)!==null&&se!==void 0?se:n.innerHeight,scrollX:(Te=t.scrollX)!==null&&Te!==void 0?Te:n.pageXOffset,scrollY:(Be=t.scrollY)!==null&&Be!==void 0?Be:n.pageYOffset},l=new fs(i.scrollX,i.scrollY,i.windowWidth,i.windowHeight),u=new b7(s,l),f=(Z=t.foreignObjectRendering)!==null&&Z!==void 0?Z:!1,d={allowTaint:(ie=t.allowTaint)!==null&&ie!==void 0?ie:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},u.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),p=new KE(u,e,d),x=p.clonedReferenceElement,x?[4,p.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return y=z.sent(),C=bx(x)||kP(x)?i6(x.ownerDocument):Md(u,x),E=C.width,T=C.height,S=C.left,F=C.top,_=U7(u,x,t.backgroundColor),N={canvas:t.canvas,backgroundColor:_,scale:(ae=(Qe=t.scale)!==null&&Qe!==void 0?Qe:n.devicePixelRatio)!==null&&ae!==void 0?ae:1,x:((Le=t.x)!==null&&Le!==void 0?Le:0)+S,y:((Y=t.y)!==null&&Y!==void 0?Y:0)+F,width:(Q=t.width)!==null&&Q!==void 0?Q:Math.ceil(E),height:(K=t.height)!==null&&K!==void 0?K:Math.ceil(T)},f?(u.logger.debug("Document cloned, using foreign object rendering"),k=new T7(u,N),[4,k.render(x)]):[3,3];case 2:return I=z.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+S+","+F+" with size "+E+"x"+T+" using computed rendering"),u.logger.debug("Starting DOM parsing"),U=B_(u,x),_===U.styles.backgroundColor&&(U.styles.backgroundColor=ss.TRANSPARENT),u.logger.debug("Starting renderer for element at "+N.x+","+N.y+" with size "+N.width+"x"+N.height),k=new v7(u,N),[4,k.render(U)];case 4:I=z.sent(),z.label=5;case 5:return(!((P=t.removeContainer)!==null&&P!==void 0)||P)&&(KE.destroy(y)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,I]}})})},U7=function(e,t,r){var n=t.ownerDocument,a=n.documentElement?zc(e,getComputedStyle(n.documentElement).backgroundColor):ss.TRANSPARENT,s=n.body?zc(e,getComputedStyle(n.body).backgroundColor):ss.TRANSPARENT,i=typeof r=="string"?zc(e,r):r===null?ss.TRANSPARENT:4294967295;return t===n.documentElement?ri(a)?ri(s)?i:s:a:i};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gd={};gd.version="0.18.5";var M_=1252,k7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Fx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ux=function(e){k7.indexOf(e)!=-1&&(M_=Fx[0]=e)};function N7(){Ux(1252)}var uA=function(e){Ux(e)};function kx(){uA(1200),N7()}function JE(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function I7(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function L_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Pc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?I7(e.slice(2)):t==254&&r==255?L_(e.slice(2)):t==65279?e.slice(1):e},Tf=function(t){return String.fromCharCode(t)},YE=function(t){return String.fromCharCode(t)},fu,Zs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function du(e){for(var t="",r=0,n=0,a=0,s=0,i=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),s=r>>2,n=e.charCodeAt(f++),i=(r&3)<<4|n>>4,a=e.charCodeAt(f++),l=(n&15)<<2|a>>6,u=a&63,isNaN(n)?l=u=64:isNaN(a)&&(u=64),t+=Zs.charAt(s)+Zs.charAt(i)+Zs.charAt(l)+Zs.charAt(u);return t}function Fa(e){var t="",r=0,n=0,a=0,s=0,i=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)s=Zs.indexOf(e.charAt(f++)),i=Zs.indexOf(e.charAt(f++)),r=s<<2|i>>4,t+=String.fromCharCode(r),l=Zs.indexOf(e.charAt(f++)),n=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=Zs.indexOf(e.charAt(f++)),a=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var Dt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ms=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ai(e){return Dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function qE(e){return Dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Sa=function(t){return Dt?ms(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Xd(e){if(typeof ArrayBuffer>"u")return Sa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ui(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Q7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Nx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Nx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Bn=Dt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ms(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function R7(e){for(var t=[],r=0,n=e.length+250,a=ai(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|l>>6&15|(i&3)<<4,a[r++]=128|l&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ai(65535),n=65530)}return t.push(a.slice(0,r)),Bn(t)}var ta=/\u0000/g,Gc=/[\u0001-\u0006]/g;function gl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function fA(e,t){var r=""+e;return r.length>=t?r:Vr("0",t-r.length)+r}function Ix(e,t){var r=""+e;return r.length>=t?r:Vr(" ",t-r.length)+r}function md(e,t){var r=""+e;return r.length>=t?r:r+Vr(" ",t-r.length)}function D7(e,t){var r=""+Math.round(e);return r.length>=t?r:Vr("0",t-r.length)+r}function M7(e,t){var r=""+e;return r.length>=t?r:Vr("0",t-r.length)+r}var $E=Math.pow(2,32);function el(e,t){if(e>$E||e<-$E)return D7(e,t);var r=Math.round(e);return M7(r,t)}function pd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ZE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function L7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},e2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},H7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xd(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,l=0,u=1,f=0,d=0,p=Math.floor(a);f<t&&(p=Math.floor(a),l=p*i+s,d=p*f+u,!(a-p<5e-8));)a=1/(a-p),s=i,i=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=s):(d=f,l=i)),!r)return[0,n*l,d];var x=Math.floor(n*l/d);return[x,n*l-x*d,d]}function Ki(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),i=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=j7(u,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var H_=new Date(1899,11,31,0,0,0),O7=H_.getTime(),P7=new Date(1900,2,1,0,0,0);function O_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=P7&&(r+=1440*60*1e3),(r-(O7+(e.getTimezoneOffset()-H_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Qx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function G7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function V7(e){var t=e<0?12:11,r=Qx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function K7(e){var t=Qx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function hu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=V7(e):t===10?r=e.toFixed(10).substr(0,12):r=K7(e),Qx(G7(r.toUpperCase()))}function qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):hu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return tA(14,O_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function j7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function z7(e,t,r,n){var a="",s=0,i=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return Lm[r.m-1][1];case 5:return Lm[r.m-1][0];default:return Lm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return ZE[r.q][0];default:return ZE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?fA(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=fA(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?fA(u,f):"";return d}function ei(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var P_=/%/g;function X7(e,t,r){var n=t.replace(P_,""),a=t.length-n.length;return is(e,n,r*Math.pow(10,2*a))+Vr("%",a)}function W7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return is(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function G_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+G_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var V_=/# (\?+)( ?)\/( ?)(\d+)/;function J7(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(i===0?Vr(" ",e[1].length+1+e[4].length):Ix(i,e[1].length)+e[2]+"/"+e[3]+fA(l,e[4].length))}function Y7(e,t,r){return r+(t===0?"":""+t)+Vr(" ",e[1].length+2+e[4].length)}var K_=/^#*0*\.([0#]+)/,j_=/\).*[0#]/,z_=/\(###\) ###\\?-####/;function Zn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function t2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function r2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function q7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function $7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Va(e,t,r){if(e.charCodeAt(0)===40&&!t.match(j_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Va("n",n,r):"("+Va("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return W7(e,t,r);if(t.indexOf("%")!==-1)return X7(e,t,r);if(t.indexOf("E")!==-1)return G_(t,r);if(t.charCodeAt(0)===36)return"$"+Va(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+el(u,t.length);if(t.match(/^[#?]+$/))return a=el(r,0),a==="0"&&(a=""),a.length>t.length?a:Zn(t.substr(0,t.length-a.length))+a;if(s=t.match(V_))return J7(s,u,f);if(t.match(/^#+0+$/))return f+el(u,t.length-t.indexOf("0"));if(s=t.match(K_))return a=t2(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Zn(s[1])).replace(/\.$/,"."+Zn(s[1])).replace(/\.(\d*)$/,function(C,E){return"."+E+Vr("0",Zn(s[1]).length-E.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+t2(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+ei(el(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Va(e,t,-r):ei(""+(Math.floor(r)+q7(r,s[1].length)))+"."+fA(r2(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Va(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gl(Va(e,t.replace(/[\\-]/g,""),r)),i=0,gl(gl(t.replace(/\\/g,"")).replace(/[0#]/g,function(C){return i<a.length?a.charAt(i++):C==="0"?"0":""}));if(t.match(z_))return a=Va(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=xd(u,Math.pow(10,i)-1,!1),a=""+f,d=is("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=md(l[2],i),d.length<s[4].length&&(d=Zn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),l=xd(u,Math.pow(10,i)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ix(l[1],i)+s[2]+"/"+s[3]+md(l[2],i):Vr(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=el(r,0),t.length<=a.length?a:Zn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var p=t.indexOf(".")-i,x=t.length-a.length-p;return Zn(t.substr(0,p)+a+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=r2(r,s[1].length),r<0?"-"+Va(e,t,-r):ei($7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?fA(0,3-C.length):"")+C})+"."+fA(i,s[1].length);switch(t){case"###,##0.00":return Va(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=ei(el(u,0));return y!=="0"?f+y:"";case"###,###.00":return Va(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Va(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Z7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return is(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function e9(e,t,r){var n=t.replace(P_,""),a=t.length-n.length;return is(e,n,r*Math.pow(10,2*a))+Vr("%",a)}function X_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+X_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function SA(e,t,r){if(e.charCodeAt(0)===40&&!t.match(j_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?SA("n",n,r):"("+SA("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Z7(e,t,r);if(t.indexOf("%")!==-1)return e9(e,t,r);if(t.indexOf("E")!==-1)return X_(t,r);if(t.charCodeAt(0)===36)return"$"+SA(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+fA(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Zn(t.substr(0,t.length-a.length))+a;if(s=t.match(V_))return Y7(s,u,f);if(t.match(/^#+0+$/))return f+fA(u,t.length-t.indexOf("0"));if(s=t.match(K_))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Zn(s[1])).replace(/\.$/,"."+Zn(s[1])),a=a.replace(/\.(\d*)$/,function(C,E){return"."+E+Vr("0",Zn(s[1]).length-E.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+ei(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+SA(e,t,-r):ei(""+r)+"."+Vr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return SA(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gl(SA(e,t.replace(/[\\-]/g,""),r)),i=0,gl(gl(t.replace(/\\/g,"")).replace(/[0#]/g,function(C){return i<a.length?a.charAt(i++):C==="0"?"0":""}));if(t.match(z_))return a=SA(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=xd(u,Math.pow(10,i)-1,!1),a=""+f,d=is("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=md(l[2],i),d.length<s[4].length&&(d=Zn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),l=xd(u,Math.pow(10,i)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ix(l[1],i)+s[2]+"/"+s[3]+md(l[2],i):Vr(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Zn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var p=t.indexOf(".")-i,x=t.length-a.length-p;return Zn(t.substr(0,p)+a+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+SA(e,t,-r):ei(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?fA(0,3-C.length):"")+C})+"."+fA(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=ei(""+u);return y!=="0"?f+y:"";default:if(t.match(/\.[0#?]*$/))return SA(e,t.slice(0,t.lastIndexOf(".")),r)+Zn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function is(e,t,r){return(r|0)===r?SA(e,t,r):Va(e,t,r)}function t9(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var W_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":pd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(W_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function r9(e,t,r,n){for(var a=[],s="",i=0,l="",u="t",f,d,p,x="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!pd(e,i))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(p=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(p);a[a.length]={t:"t",v:s},++i;break;case"\\":var y=e.charAt(++i),C=y==="("||y===")"?y:"t";a[a.length]={t:C,v:y},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=Ki(t,r,e.charAt(i+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},u=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Ki(t,r),f==null))return"";for(s=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),a[a.length]={t:l,v:s},u=l;break;case"A":case"a":case"":var E={t:l,v:l};if(f==null&&(f=Ki(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(E.v=f.H>=12?"P":"A"),E.t="T",x="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(E.v=f.H>=12?"PM":"AM"),E.t="T",i+=5,x="h"):e.substr(i,5).toUpperCase()==="/"?(f!=null&&(E.v=f.H>=12?"":""),E.t="T",i+=5,x="h"):(E.t="t",++i),f==null&&E.t==="T")return"";a[a.length]=E,u=l;break;case"[":for(s=l;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(W_)){if(f==null&&(f=Ki(t,r),f==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fl(e)||(a[a.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=l;++i<e.length&&(l=e.charAt(i))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++i)===l;)s+=l;a[a.length]={t:l,v:s},u=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++i;break}var T=0,S=0,F;for(i=a.length-1,u="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=x,u="h",T<1&&(T=1);break;case"s":(F=a[i].v.match(/\.0+$/))&&(S=Math.max(S,F[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":u=a[i].t;break;case"m":u==="s"&&(a[i].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&a[i].v.match(/[Hh]/)&&(T=1),T<2&&a[i].v.match(/[Mm]/)&&(T=2),T<3&&a[i].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var _="",N;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=z7(a[i].t.charCodeAt(0),a[i].v,f,S),a[i].t="t";break;case"n":case"?":for(N=i+1;a[N]!=null&&((l=a[N].t)==="?"||l==="D"||(l===" "||l==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[i].v+=a[N].v,a[N]={v:"",t:";"},++N;_+=a[i].v,i=N-1;break;case"G":a[i].t="t",a[i].v=qi(t,r);break}var I="",U,k;if(_.length>0){_.charCodeAt(0)==40?(U=t<0&&_.charCodeAt(0)===45?-t:t,k=is("n",_,U)):(U=t<0&&n>1?-t:t,k=is("n",_,U),U<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),N=k.length-1;var G=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){G=i;break}var M=a.length;if(G===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(N>=a[i].v.length-1?(N-=a[i].v.length,a[i].v=k.substr(N+1,a[i].v.length)):N<0?a[i].v="":(a[i].v=k.substr(0,N+1),N=-1),a[i].t="t",M=i);N>=0&&M<a.length&&(a[M].v=k.substr(0,N+1)+a[M].v)}else if(G!==a.length&&k.indexOf("E")===-1){for(N=k.indexOf(".")-1,i=G;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(d=a[i].v.indexOf(".")>-1&&i===G?a[i].v.indexOf(".")-1:a[i].v.length-1,I=a[i].v.substr(d+1);d>=0;--d)N>=0&&(a[i].v.charAt(d)==="0"||a[i].v.charAt(d)==="#")&&(I=k.charAt(N--)+I);a[i].v=I,a[i].t="t",M=i}for(N>=0&&M<a.length&&(a[M].v=k.substr(0,N+1)+a[M].v),N=k.indexOf(".")+1,i=G;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==G)){for(d=a[i].v.indexOf(".")>-1&&i===G?a[i].v.indexOf(".")+1:0,I=a[i].v.substr(0,d);d<a[i].v.length;++d)N<k.length&&(I+=k.charAt(N++));a[i].v=I,a[i].t="t",M=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(U=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=is(a[i].t,a[i].v,U),a[i].t="t");var ee="";for(i=0;i!==a.length;++i)a[i]!=null&&(ee+=a[i].v);return ee}var n2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function a2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function n9(e,t){var r=t9(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(n2),l=r[1].match(n2);return a2(t,i)?[n,r[0]]:a2(t,l)?[n,r[1]]:[n,r[i!=null&&l!=null?2:1]]}return[n,s]}function tA(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:vt)[e],n==null&&(n=r.table&&r.table[e2[e]]||vt[e2[e]]),n==null&&(n=H7[e]||"General");break}if(pd(n,0))return qi(t,r);t instanceof Date&&(t=O_(t,r.date1904));var a=n9(n,t);if(pd(a[1]))return qi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return r9(a[1],t,r,a[0])}function os(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(vt[r]==null){t<0&&(t=r);continue}if(vt[r]==e){t=r;break}}t<0&&(t=391)}return vt[t]=e,t}function Wd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&os(e[t],t)}function Ul(){vt=L7()}var a9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},J_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function A9(e){var t=typeof e=="number"?vt[e]:e;return t=t.replace(J_,"(\\d+)"),new RegExp("^"+t+"$")}function s9(e,t,r){var n=-1,a=-1,s=-1,i=-1,l=-1,u=-1;(t.match(J_)||[]).forEach(function(p,x){var y=parseInt(r[x+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":i=y;break;case"s":u=y;break;case"m":i>=0?l=y:a=y;break}}),u>=0&&l==-1&&a>=0&&(l=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return i==-1&&l==-1&&u==-1?f:n==-1&&a==-1&&s==-1?d:f+"T"+d}var i9=(function(){var e={};e.version="1.2.0";function t(){for(var k=0,G=new Array(256),M=0;M!=256;++M)k=M,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,G[M]=k;return typeof Int32Array<"u"?new Int32Array(G):G}var r=t();function n(k){var G=0,M=0,ee=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)re[ee]=k[ee];for(ee=0;ee!=256;++ee)for(M=k[ee],G=256+ee;G<4096;G+=256)M=re[G]=M>>>8^k[M&255];var q=[];for(ee=1;ee!=16;++ee)q[ee-1]=typeof Int32Array<"u"?re.subarray(ee*256,ee*256+256):re.slice(ee*256,ee*256+256);return q}var a=n(r),s=a[0],i=a[1],l=a[2],u=a[3],f=a[4],d=a[5],p=a[6],x=a[7],y=a[8],C=a[9],E=a[10],T=a[11],S=a[12],F=a[13],_=a[14];function N(k,G){for(var M=G^-1,ee=0,re=k.length;ee<re;)M=M>>>8^r[(M^k.charCodeAt(ee++))&255];return~M}function I(k,G){for(var M=G^-1,ee=k.length-15,re=0;re<ee;)M=_[k[re++]^M&255]^F[k[re++]^M>>8&255]^S[k[re++]^M>>16&255]^T[k[re++]^M>>>24]^E[k[re++]]^C[k[re++]]^y[k[re++]]^x[k[re++]]^p[k[re++]]^d[k[re++]]^f[k[re++]]^u[k[re++]]^l[k[re++]]^i[k[re++]]^s[k[re++]]^r[k[re++]];for(ee+=15;re<ee;)M=M>>>8^r[(M^k[re++])&255];return~M}function U(k,G){for(var M=G^-1,ee=0,re=k.length,q=0,se=0;ee<re;)q=k.charCodeAt(ee++),q<128?M=M>>>8^r[(M^q)&255]:q<2048?(M=M>>>8^r[(M^(192|q>>6&31))&255],M=M>>>8^r[(M^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,se=k.charCodeAt(ee++)&1023,M=M>>>8^r[(M^(240|q>>8&7))&255],M=M>>>8^r[(M^(128|q>>2&63))&255],M=M>>>8^r[(M^(128|se>>6&15|(q&3)<<4))&255],M=M>>>8^r[(M^(128|se&63))&255]):(M=M>>>8^r[(M^(224|q>>12&15))&255],M=M>>>8^r[(M^(128|q>>6&63))&255],M=M>>>8^r[(M^(128|q&63))&255]);return~M}return e.table=r,e.bstr=N,e.buf=I,e.str=U,e})(),gt=(function(){var t={};t.version="1.2.1";function r(D,j){for(var H=D.split("/"),O=j.split("/"),V=0,J=0,me=Math.min(H.length,O.length);V<me;++V){if(J=H[V].length-O[V].length)return J;if(H[V]!=O[V])return H[V]<O[V]?-1:1}return H.length-O.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var j=D.lastIndexOf("/");return j===-1?D:D.slice(0,j+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var j=D.lastIndexOf("/");return j===-1?D:D.slice(j+1)}function s(D,j){typeof j=="string"&&(j=new Date(j));var H=j.getHours();H=H<<6|j.getMinutes(),H=H<<5|j.getSeconds()>>>1,D.write_shift(2,H);var O=j.getFullYear()-1980;O=O<<4|j.getMonth()+1,O=O<<5|j.getDate(),D.write_shift(2,O)}function i(D){var j=D.read_shift(2)&65535,H=D.read_shift(2)&65535,O=new Date,V=H&31;H>>>=5;var J=H&15;H>>>=4,O.setMilliseconds(0),O.setFullYear(H+1980),O.setMonth(J-1),O.setDate(V);var me=j&31;j>>>=5;var Fe=j&63;return j>>>=6,O.setHours(j),O.setMinutes(Fe),O.setSeconds(me<<1),O}function l(D){Nn(D,0);for(var j={},H=0;D.l<=D.length-4;){var O=D.read_shift(2),V=D.read_shift(2),J=D.l+V,me={};switch(O){case 21589:H=D.read_shift(1),H&1&&(me.mtime=D.read_shift(4)),V>5&&(H&2&&(me.atime=D.read_shift(4)),H&4&&(me.ctime=D.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}D.l=J,j[O]=me}return j}var u;function f(){return u||(u={})}function d(D,j){if(D[0]==80&&D[1]==75)return mt(D,j);if((D[0]|32)==109&&(D[1]|32)==105)return HA(D,j);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var H=3,O=512,V=0,J=0,me=0,Fe=0,xe=0,ve=[],we=D.slice(0,512);Nn(we,0);var Oe=p(we);switch(H=Oe[0],H){case 3:O=512;break;case 4:O=4096;break;case 0:if(Oe[1]==0)return mt(D,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}O!==512&&(we=D.slice(0,O),Nn(we,28));var Ve=D.slice(0,O);x(we,H);var Ye=we.read_shift(4,"i");if(H===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);we.l+=4,me=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),Fe=we.read_shift(4,"i"),V=we.read_shift(4,"i"),xe=we.read_shift(4,"i"),J=we.read_shift(4,"i");for(var Pe=-1,Xe=0;Xe<109&&(Pe=we.read_shift(4,"i"),!(Pe<0));++Xe)ve[Xe]=Pe;var ot=y(D,O);T(xe,J,ot,O,ve);var pr=F(ot,me,ve,O);pr[me].name="!Directory",V>0&&Fe!==se&&(pr[Fe].name="!MiniFAT"),pr[ve[0]].name="!FAT",pr.fat_addrs=ve,pr.ssz=O;var lr={},cr=[],na=[],PA=[];_(me,pr,ot,cr,V,lr,na,Fe),C(na,PA,cr),cr.shift();var vA={FileIndex:na,FullPaths:PA};return j&&j.raw&&(vA.raw={header:Ve,sectors:ot}),vA}function p(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(Te,"Header Signature: "),D.l+=16;var j=D.read_shift(2,"u");return[D.read_shift(2,"u"),j]}function x(D,j){var H=9;switch(D.l+=2,H=D.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function y(D,j){for(var H=Math.ceil(D.length/j)-1,O=[],V=1;V<H;++V)O[V-1]=D.slice(V*j,(V+1)*j);return O[H-1]=D.slice(H*j),O}function C(D,j,H){for(var O=0,V=0,J=0,me=0,Fe=0,xe=H.length,ve=[],we=[];O<xe;++O)ve[O]=we[O]=O,j[O]=H[O];for(;Fe<we.length;++Fe)O=we[Fe],V=D[O].L,J=D[O].R,me=D[O].C,ve[O]===O&&(V!==-1&&ve[V]!==V&&(ve[O]=ve[V]),J!==-1&&ve[J]!==J&&(ve[O]=ve[J])),me!==-1&&(ve[me]=O),V!==-1&&O!=ve[O]&&(ve[V]=ve[O],we.lastIndexOf(V)<Fe&&we.push(V)),J!==-1&&O!=ve[O]&&(ve[J]=ve[O],we.lastIndexOf(J)<Fe&&we.push(J));for(O=1;O<xe;++O)ve[O]===O&&(J!==-1&&ve[J]!==J?ve[O]=ve[J]:V!==-1&&ve[V]!==V&&(ve[O]=ve[V]));for(O=1;O<xe;++O)if(D[O].type!==0){if(Fe=O,Fe!=ve[Fe])do Fe=ve[Fe],j[O]=j[Fe]+"/"+j[O];while(Fe!==0&&ve[Fe]!==-1&&Fe!=ve[Fe]);ve[O]=-1}for(j[0]+="/",O=1;O<xe;++O)D[O].type!==2&&(j[O]+="/")}function E(D,j,H){for(var O=D.start,V=D.size,J=[],me=O;H&&V>0&&me>=0;)J.push(j.slice(me*q,me*q+q)),V-=q,me=Gi(H,me*4);return J.length===0?be(0):Bn(J).slice(0,D.size)}function T(D,j,H,O,V){var J=se;if(D===se){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var me=H[D],Fe=(O>>>2)-1;if(!me)return;for(var xe=0;xe<Fe&&(J=Gi(me,xe*4))!==se;++xe)V.push(J);T(Gi(me,O-4),j-1,H,O,V)}}function S(D,j,H,O,V){var J=[],me=[];V||(V=[]);var Fe=O-1,xe=0,ve=0;for(xe=j;xe>=0;){V[xe]=!0,J[J.length]=xe,me.push(D[xe]);var we=H[Math.floor(xe*4/O)];if(ve=xe*4&Fe,O<4+ve)throw new Error("FAT boundary crossed: "+xe+" 4 "+O);if(!D[we])break;xe=Gi(D[we],ve)}return{nodes:J,data:m2([me])}}function F(D,j,H,O){var V=D.length,J=[],me=[],Fe=[],xe=[],ve=O-1,we=0,Oe=0,Ve=0,Ye=0;for(we=0;we<V;++we)if(Fe=[],Ve=we+j,Ve>=V&&(Ve-=V),!me[Ve]){xe=[];var Pe=[];for(Oe=Ve;Oe>=0;){Pe[Oe]=!0,me[Oe]=!0,Fe[Fe.length]=Oe,xe.push(D[Oe]);var Xe=H[Math.floor(Oe*4/O)];if(Ye=Oe*4&ve,O<4+Ye)throw new Error("FAT boundary crossed: "+Oe+" 4 "+O);if(!D[Xe]||(Oe=Gi(D[Xe],Ye),Pe[Oe]))break}J[Ve]={nodes:Fe,data:m2([xe])}}return J}function _(D,j,H,O,V,J,me,Fe){for(var xe=0,ve=O.length?2:0,we=j[D].data,Oe=0,Ve=0,Ye;Oe<we.length;Oe+=128){var Pe=we.slice(Oe,Oe+128);Nn(Pe,64),Ve=Pe.read_shift(2),Ye=Px(Pe,0,Ve-ve),O.push(Ye);var Xe={name:Ye,type:Pe.read_shift(1),color:Pe.read_shift(1),L:Pe.read_shift(4,"i"),R:Pe.read_shift(4,"i"),C:Pe.read_shift(4,"i"),clsid:Pe.read_shift(16),state:Pe.read_shift(4,"i"),start:0,size:0},ot=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);ot!==0&&(Xe.ct=N(Pe,Pe.l-8));var pr=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);pr!==0&&(Xe.mt=N(Pe,Pe.l-8)),Xe.start=Pe.read_shift(4,"i"),Xe.size=Pe.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=se,Xe.name=""),Xe.type===5?(xe=Xe.start,V>0&&xe!==se&&(j[xe].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",j[Xe.start]===void 0&&(j[Xe.start]=S(H,Xe.start,j.fat_addrs,j.ssz)),j[Xe.start].name=Xe.name,Xe.content=j[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:xe!==se&&Xe.start!==se&&j[xe]&&(Xe.content=E(Xe,j[xe].data,(j[Fe]||{}).data))),Xe.content&&Nn(Xe.content,0),J[Ye]=Xe,me.push(Xe)}}function N(D,j){return new Date((Ta(D,j+4)/1e7*Math.pow(2,32)+Ta(D,j)/1e7-11644473600)*1e3)}function I(D,j){return f(),d(u.readFileSync(D),j)}function U(D,j){var H=j&&j.type;switch(H||Dt&&Buffer.isBuffer(D)&&(H="buffer"),H||"base64"){case"file":return I(D,j);case"base64":return d(Sa(Fa(D)),j);case"binary":return d(Sa(D),j)}return d(D,j)}function k(D,j){var H=j||{},O=H.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=O+"/",D.FileIndex[0]={name:O,type:5}),H.CLSID&&(D.FileIndex[0].clsid=H.CLSID),G(D)}function G(D){var j="Sh33tJ5";if(!gt.find(D,"/"+j)){var H=be(4);H[0]=55,H[1]=H[3]=50,H[2]=54,D.FileIndex.push({name:j,type:2,content:H,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+j),M(D)}}function M(D,j){k(D);for(var H=!1,O=!1,V=D.FullPaths.length-1;V>=0;--V){var J=D.FileIndex[V];switch(J.type){case 0:O?H=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(J.R*J.L*J.C)&&(H=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!j)){var me=new Date(1987,1,19),Fe=0,xe=Object.create?Object.create(null):{},ve=[];for(V=0;V<D.FullPaths.length;++V)xe[D.FullPaths[V]]=!0,D.FileIndex[V].type!==0&&ve.push([D.FullPaths[V],D.FileIndex[V]]);for(V=0;V<ve.length;++V){var we=n(ve[V][0]);O=xe[we],O||(ve.push([we,{name:a(we).replace("/",""),type:1,clsid:Z,ct:me,mt:me,content:null}]),xe[we]=!0)}for(ve.sort(function(Ye,Pe){return r(Ye[0],Pe[0])}),D.FullPaths=[],D.FileIndex=[],V=0;V<ve.length;++V)D.FullPaths[V]=ve[V][0],D.FileIndex[V]=ve[V][1];for(V=0;V<ve.length;++V){var Oe=D.FileIndex[V],Ve=D.FullPaths[V];if(Oe.name=a(Ve).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||Z,V===0)Oe.C=ve.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Ve.slice(-1)=="/"){for(Fe=V+1;Fe<ve.length&&n(D.FullPaths[Fe])!=Ve;++Fe);for(Oe.C=Fe>=ve.length?-1:Fe,Fe=V+1;Fe<ve.length&&n(D.FullPaths[Fe])!=n(Ve);++Fe);Oe.R=Fe>=ve.length?-1:Fe,Oe.type=1}else n(D.FullPaths[V+1]||"")==n(Ve)&&(Oe.R=V+1),Oe.type=2}}}function ee(D,j){var H=j||{};if(H.fileType=="mad")return fo(D,H);switch(M(D),H.fileType){case"zip":return Er(D,H)}var O=(function(Ye){for(var Pe=0,Xe=0,ot=0;ot<Ye.FileIndex.length;++ot){var pr=Ye.FileIndex[ot];if(pr.content){var lr=pr.content.length;lr>0&&(lr<4096?Pe+=lr+63>>6:Xe+=lr+511>>9)}}for(var cr=Ye.FullPaths.length+3>>2,na=Pe+7>>3,PA=Pe+127>>7,vA=na+Xe+cr+PA,ka=vA+127>>7,fn=ka<=109?0:Math.ceil((ka-109)/127);vA+ka+fn+127>>7>ka;)fn=++ka<=109?0:Math.ceil((ka-109)/127);var pn=[1,fn,ka,PA,cr,Xe,Pe,0];return Ye.FileIndex[0].size=Pe<<6,pn[7]=(Ye.FileIndex[0].start=pn[0]+pn[1]+pn[2]+pn[3]+pn[4]+pn[5])+(pn[6]+7>>3),pn})(D),V=be(O[7]<<9),J=0,me=0;{for(J=0;J<8;++J)V.write_shift(1,Be[J]);for(J=0;J<8;++J)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),J=0;J<3;++J)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,O[2]),V.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:se),V.write_shift(4,O[3]),V.write_shift(-4,O[1]?O[0]-1:se),V.write_shift(4,O[1]),J=0;J<109;++J)V.write_shift(-4,J<O[2]?O[1]+J:-1)}if(O[1])for(me=0;me<O[1];++me){for(;J<236+me*127;++J)V.write_shift(-4,J<O[2]?O[1]+J:-1);V.write_shift(-4,me===O[1]-1?se:me+1)}var Fe=function(Ye){for(me+=Ye;J<me-1;++J)V.write_shift(-4,J+1);Ye&&(++J,V.write_shift(-4,se))};for(me=J=0,me+=O[1];J<me;++J)V.write_shift(-4,ie.DIFSECT);for(me+=O[2];J<me;++J)V.write_shift(-4,ie.FATSECT);Fe(O[3]),Fe(O[4]);for(var xe=0,ve=0,we=D.FileIndex[0];xe<D.FileIndex.length;++xe)we=D.FileIndex[xe],we.content&&(ve=we.content.length,!(ve<4096)&&(we.start=me,Fe(ve+511>>9)));for(Fe(O[6]+7>>3);V.l&511;)V.write_shift(-4,ie.ENDOFCHAIN);for(me=J=0,xe=0;xe<D.FileIndex.length;++xe)we=D.FileIndex[xe],we.content&&(ve=we.content.length,!(!ve||ve>=4096)&&(we.start=me,Fe(ve+63>>6)));for(;V.l&511;)V.write_shift(-4,ie.ENDOFCHAIN);for(J=0;J<O[4]<<2;++J){var Oe=D.FullPaths[J];if(!Oe||Oe.length===0){for(xe=0;xe<17;++xe)V.write_shift(4,0);for(xe=0;xe<3;++xe)V.write_shift(4,-1);for(xe=0;xe<12;++xe)V.write_shift(4,0);continue}we=D.FileIndex[J],J===0&&(we.start=we.size?we.start-1:se);var Ve=J===0&&H.root||we.name;if(ve=2*(Ve.length+1),V.write_shift(64,Ve,"utf16le"),V.write_shift(2,ve),V.write_shift(1,we.type),V.write_shift(1,we.color),V.write_shift(-4,we.L),V.write_shift(-4,we.R),V.write_shift(-4,we.C),we.clsid)V.write_shift(16,we.clsid,"hex");else for(xe=0;xe<4;++xe)V.write_shift(4,0);V.write_shift(4,we.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,we.start),V.write_shift(4,we.size),V.write_shift(4,0)}for(J=1;J<D.FileIndex.length;++J)if(we=D.FileIndex[J],we.size>=4096)if(V.l=we.start+1<<9,Dt&&Buffer.isBuffer(we.content))we.content.copy(V,V.l,0,we.size),V.l+=we.size+511&-512;else{for(xe=0;xe<we.size;++xe)V.write_shift(1,we.content[xe]);for(;xe&511;++xe)V.write_shift(1,0)}for(J=1;J<D.FileIndex.length;++J)if(we=D.FileIndex[J],we.size>0&&we.size<4096)if(Dt&&Buffer.isBuffer(we.content))we.content.copy(V,V.l,0,we.size),V.l+=we.size+63&-64;else{for(xe=0;xe<we.size;++xe)V.write_shift(1,we.content[xe]);for(;xe&63;++xe)V.write_shift(1,0)}if(Dt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function re(D,j){var H=D.FullPaths.map(function(xe){return xe.toUpperCase()}),O=H.map(function(xe){var ve=xe.split("/");return ve[ve.length-(xe.slice(-1)=="/"?2:1)]}),V=!1;j.charCodeAt(0)===47?(V=!0,j=H[0].slice(0,-1)+j):V=j.indexOf("/")!==-1;var J=j.toUpperCase(),me=V===!0?H.indexOf(J):O.indexOf(J);if(me!==-1)return D.FileIndex[me];var Fe=!J.match(Gc);for(J=J.replace(ta,""),Fe&&(J=J.replace(Gc,"!")),me=0;me<H.length;++me)if((Fe?H[me].replace(Gc,"!"):H[me]).replace(ta,"")==J||(Fe?O[me].replace(Gc,"!"):O[me]).replace(ta,"")==J)return D.FileIndex[me];return null}var q=64,se=-2,Te="d0cf11e0a1b11ae1",Be=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Qe(D,j,H){f();var O=ee(D,H);u.writeFileSync(j,O)}function ae(D){for(var j=new Array(D.length),H=0;H<D.length;++H)j[H]=String.fromCharCode(D[H]);return j.join("")}function Le(D,j){var H=ee(D,j);switch(j&&j.type||"buffer"){case"file":return f(),u.writeFileSync(j.filename,H),H;case"binary":return typeof H=="string"?H:ae(H);case"base64":return du(typeof H=="string"?H:ae(H));case"buffer":if(Dt)return Buffer.isBuffer(H)?H:ms(H);case"array":return typeof H=="string"?Sa(H):H}return H}var Y;function Q(D){try{var j=D.InflateRaw,H=new j;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)Y=D;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function K(D,j){if(!Y)return ha(D,j);var H=Y.InflateRaw,O=new H,V=O._processChunk(D.slice(D.l),O._finishFlushFlag);return D.l+=O.bytesRead,V}function P(D){return Y?Y.deflateRawSync(D):et(D)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(D){var j=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(j>>16|j>>8|j)&255}for(var de=typeof Uint8Array<"u",ne=de?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)ne[Ee]=he(Ee);function R(D,j){var H=ne[D&255];return j<=8?H>>>8-j:(H=H<<8|ne[D>>8&255],j<=16?H>>>16-j:(H=H<<8|ne[D>>16&255],H>>>24-j))}function Re(D,j){var H=j&7,O=j>>>3;return(D[O]|(H<=6?0:D[O+1]<<8))>>>H&3}function Ge(D,j){var H=j&7,O=j>>>3;return(D[O]|(H<=5?0:D[O+1]<<8))>>>H&7}function Ze(D,j){var H=j&7,O=j>>>3;return(D[O]|(H<=4?0:D[O+1]<<8))>>>H&15}function st(D,j){var H=j&7,O=j>>>3;return(D[O]|(H<=3?0:D[O+1]<<8))>>>H&31}function He(D,j){var H=j&7,O=j>>>3;return(D[O]|(H<=1?0:D[O+1]<<8))>>>H&127}function it(D,j,H){var O=j&7,V=j>>>3,J=(1<<H)-1,me=D[V]>>>O;return H<8-O||(me|=D[V+1]<<8-O,H<16-O)||(me|=D[V+2]<<16-O,H<24-O)||(me|=D[V+3]<<24-O),me&J}function wt(D,j,H){var O=j&7,V=j>>>3;return O<=5?D[V]|=(H&7)<<O:(D[V]|=H<<O&255,D[V+1]=(H&7)>>8-O),j+3}function nr(D,j,H){var O=j&7,V=j>>>3;return H=(H&1)<<O,D[V]|=H,j+1}function Yt(D,j,H){var O=j&7,V=j>>>3;return H<<=O,D[V]|=H&255,H>>>=8,D[V+1]=H,j+8}function Mr(D,j,H){var O=j&7,V=j>>>3;return H<<=O,D[V]|=H&255,H>>>=8,D[V+1]=H&255,D[V+2]=H>>>8,j+16}function un(D,j){var H=D.length,O=2*H>j?2*H:j+5,V=0;if(H>=j)return D;if(Dt){var J=qE(O);if(D.copy)D.copy(J);else for(;V<D.length;++V)J[V]=D[V];return J}else if(de){var me=new Uint8Array(O);if(me.set)me.set(D);else for(;V<H;++V)me[V]=D[V];return me}return D.length=O,D}function dt(D){for(var j=new Array(D),H=0;H<D;++H)j[H]=0;return j}function ue(D,j,H){var O=1,V=0,J=0,me=0,Fe=0,xe=D.length,ve=de?new Uint16Array(32):dt(32);for(J=0;J<32;++J)ve[J]=0;for(J=xe;J<H;++J)D[J]=0;xe=D.length;var we=de?new Uint16Array(xe):dt(xe);for(J=0;J<xe;++J)ve[V=D[J]]++,O<V&&(O=V),we[J]=0;for(ve[0]=0,J=1;J<=O;++J)ve[J+16]=Fe=Fe+ve[J-1]<<1;for(J=0;J<xe;++J)Fe=D[J],Fe!=0&&(we[J]=ve[Fe+16]++);var Oe=0;for(J=0;J<xe;++J)if(Oe=D[J],Oe!=0)for(Fe=R(we[J],O)>>O-Oe,me=(1<<O+4-Oe)-1;me>=0;--me)j[Fe|me<<Oe]=Oe&15|J<<4;return O}var We=de?new Uint16Array(512):dt(512),_t=de?new Uint16Array(32):dt(32);if(!de){for(var ft=0;ft<512;++ft)We[ft]=0;for(ft=0;ft<32;++ft)_t[ft]=0}(function(){for(var D=[],j=0;j<32;j++)D.push(5);ue(D,_t,32);var H=[];for(j=0;j<=143;j++)H.push(8);for(;j<=255;j++)H.push(9);for(;j<=279;j++)H.push(7);for(;j<=287;j++)H.push(8);ue(H,We,288)})();var Bt=(function(){for(var j=de?new Uint8Array(32768):[],H=0,O=0;H<Ce.length-1;++H)for(;O<Ce[H+1];++O)j[O]=H;for(;O<32768;++O)j[O]=29;var V=de?new Uint8Array(259):[];for(H=0,O=0;H<ce.length-1;++H)for(;O<ce[H+1];++O)V[O]=H;function J(Fe,xe){for(var ve=0;ve<Fe.length;){var we=Math.min(65535,Fe.length-ve),Oe=ve+we==Fe.length;for(xe.write_shift(1,+Oe),xe.write_shift(2,we),xe.write_shift(2,~we&65535);we-- >0;)xe[xe.l++]=Fe[ve++]}return xe.l}function me(Fe,xe){for(var ve=0,we=0,Oe=de?new Uint16Array(32768):[];we<Fe.length;){var Ve=Math.min(65535,Fe.length-we);if(Ve<10){for(ve=wt(xe,ve,+(we+Ve==Fe.length)),ve&7&&(ve+=8-(ve&7)),xe.l=ve/8|0,xe.write_shift(2,Ve),xe.write_shift(2,~Ve&65535);Ve-- >0;)xe[xe.l++]=Fe[we++];ve=xe.l*8;continue}ve=wt(xe,ve,+(we+Ve==Fe.length)+2);for(var Ye=0;Ve-- >0;){var Pe=Fe[we];Ye=(Ye<<5^Pe)&32767;var Xe=-1,ot=0;if((Xe=Oe[Ye])&&(Xe|=we&-32768,Xe>we&&(Xe-=32768),Xe<we))for(;Fe[Xe+ot]==Fe[we+ot]&&ot<250;)++ot;if(ot>2){Pe=V[ot],Pe<=22?ve=Yt(xe,ve,ne[Pe+1]>>1)-1:(Yt(xe,ve,3),ve+=5,Yt(xe,ve,ne[Pe-23]>>5),ve+=3);var pr=Pe<8?0:Pe-4>>2;pr>0&&(Mr(xe,ve,ot-ce[Pe]),ve+=pr),Pe=j[we-Xe],ve=Yt(xe,ve,ne[Pe]>>3),ve-=3;var lr=Pe<4?0:Pe-2>>1;lr>0&&(Mr(xe,ve,we-Xe-Ce[Pe]),ve+=lr);for(var cr=0;cr<ot;++cr)Oe[Ye]=we&32767,Ye=(Ye<<5^Fe[we])&32767,++we;Ve-=ot-1}else Pe<=143?Pe=Pe+48:ve=nr(xe,ve,1),ve=Yt(xe,ve,ne[Pe]),Oe[Ye]=we&32767,++we}ve=Yt(xe,ve,0)-1}return xe.l=(ve+7)/8|0,xe.l}return function(xe,ve){return xe.length<8?J(xe,ve):me(xe,ve)}})();function et(D){var j=be(50+Math.floor(D.length*1.1)),H=Bt(D,j);return j.slice(0,H)}var Tt=de?new Uint16Array(32768):dt(32768),Rt=de?new Uint16Array(32768):dt(32768),xt=de?new Uint16Array(128):dt(128),zt=1,zr=1;function Sr(D,j){var H=st(D,j)+257;j+=5;var O=st(D,j)+1;j+=5;var V=Ze(D,j)+4;j+=4;for(var J=0,me=de?new Uint8Array(19):dt(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,ve=de?new Uint8Array(8):dt(8),we=de?new Uint8Array(8):dt(8),Oe=me.length,Ve=0;Ve<V;++Ve)me[z[Ve]]=J=Ge(D,j),xe<J&&(xe=J),ve[J]++,j+=3;var Ye=0;for(ve[0]=0,Ve=1;Ve<=xe;++Ve)we[Ve]=Ye=Ye+ve[Ve-1]<<1;for(Ve=0;Ve<Oe;++Ve)(Ye=me[Ve])!=0&&(Fe[Ve]=we[Ye]++);var Pe=0;for(Ve=0;Ve<Oe;++Ve)if(Pe=me[Ve],Pe!=0){Ye=ne[Fe[Ve]]>>8-Pe;for(var Xe=(1<<7-Pe)-1;Xe>=0;--Xe)xt[Ye|Xe<<Pe]=Pe&7|Ve<<3}var ot=[];for(xe=1;ot.length<H+O;)switch(Ye=xt[He(D,j)],j+=Ye&7,Ye>>>=3){case 16:for(J=3+Re(D,j),j+=2,Ye=ot[ot.length-1];J-- >0;)ot.push(Ye);break;case 17:for(J=3+Ge(D,j),j+=3;J-- >0;)ot.push(0);break;case 18:for(J=11+He(D,j),j+=7;J-- >0;)ot.push(0);break;default:ot.push(Ye),xe<Ye&&(xe=Ye);break}var pr=ot.slice(0,H),lr=ot.slice(H);for(Ve=H;Ve<286;++Ve)pr[Ve]=0;for(Ve=O;Ve<30;++Ve)lr[Ve]=0;return zt=ue(pr,Tt,286),zr=ue(lr,Rt,30),j}function nA(D,j){if(D[0]==3&&!(D[1]&3))return[ai(j),2];for(var H=0,O=0,V=qE(j||1<<18),J=0,me=V.length>>>0,Fe=0,xe=0;(O&1)==0;){if(O=Ge(D,H),H+=3,O>>>1)O>>1==1?(Fe=9,xe=5):(H=Sr(D,H),Fe=zt,xe=zr);else{H&7&&(H+=8-(H&7));var ve=D[H>>>3]|D[(H>>>3)+1]<<8;if(H+=32,ve>0)for(!j&&me<J+ve&&(V=un(V,J+ve),me=V.length);ve-- >0;)V[J++]=D[H>>>3],H+=8;continue}for(;;){!j&&me<J+32767&&(V=un(V,J+32767),me=V.length);var we=it(D,H,Fe),Oe=O>>>1==1?We[we]:Tt[we];if(H+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)V[J++]=Oe;else{if(Oe==256)break;Oe-=257;var Ve=Oe<8?0:Oe-4>>2;Ve>5&&(Ve=0);var Ye=J+ce[Oe];Ve>0&&(Ye+=it(D,H,Ve),H+=Ve),we=it(D,H,xe),Oe=O>>>1==1?_t[we]:Rt[we],H+=Oe&15,Oe>>>=4;var Pe=Oe<4?0:Oe-2>>1,Xe=Ce[Oe];for(Pe>0&&(Xe+=it(D,H,Pe),H+=Pe),!j&&me<Ye&&(V=un(V,Ye+100),me=V.length);J<Ye;)V[J]=V[J-Xe],++J}}}return j?[V,H+7>>>3]:[V.slice(0,J),H+7>>>3]}function ha(D,j){var H=D.slice(D.l||0),O=nA(H,j);return D.l+=O[1],O[0]}function _r(D,j){if(D)typeof console<"u"&&console.error(j);else throw new Error(j)}function mt(D,j){var H=D;Nn(H,0);var O=[],V=[],J={FileIndex:O,FullPaths:V};k(J,{root:j.root});for(var me=H.length-4;(H[me]!=80||H[me+1]!=75||H[me+2]!=5||H[me+3]!=6)&&me>=0;)--me;H.l=me+4,H.l+=4;var Fe=H.read_shift(2);H.l+=6;var xe=H.read_shift(4);for(H.l=xe,me=0;me<Fe;++me){H.l+=20;var ve=H.read_shift(4),we=H.read_shift(4),Oe=H.read_shift(2),Ve=H.read_shift(2),Ye=H.read_shift(2);H.l+=8;var Pe=H.read_shift(4),Xe=l(H.slice(H.l+Oe,H.l+Oe+Ve));H.l+=Oe+Ve+Ye;var ot=H.l;H.l=Pe+4,Lr(H,ve,we,J,Xe),H.l=ot}return J}function Lr(D,j,H,O,V){D.l+=2;var J=D.read_shift(2),me=D.read_shift(2),Fe=i(D);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var xe=D.read_shift(4),ve=D.read_shift(4),we=D.read_shift(4),Oe=D.read_shift(2),Ve=D.read_shift(2),Ye="",Pe=0;Pe<Oe;++Pe)Ye+=String.fromCharCode(D[D.l++]);if(Ve){var Xe=l(D.slice(D.l,D.l+Ve));(Xe[21589]||{}).mt&&(Fe=Xe[21589].mt),((V||{})[21589]||{}).mt&&(Fe=V[21589].mt)}D.l+=Ve;var ot=D.slice(D.l,D.l+ve);switch(me){case 8:ot=K(D,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var pr=!1;J&8&&(xe=D.read_shift(4),xe==134695760&&(xe=D.read_shift(4),pr=!0),ve=D.read_shift(4),we=D.read_shift(4)),ve!=j&&_r(pr,"Bad compressed size: "+j+" != "+ve),we!=H&&_r(pr,"Bad uncompressed size: "+H+" != "+we),OA(O,Ye,ot,{unsafe:!0,mt:Fe})}function Er(D,j){var H=j||{},O=[],V=[],J=be(1),me=H.compression?8:0,Fe=0,xe=0,ve=0,we=0,Oe=0,Ve=D.FullPaths[0],Ye=Ve,Pe=D.FileIndex[0],Xe=[],ot=0;for(xe=1;xe<D.FullPaths.length;++xe)if(Ye=D.FullPaths[xe].slice(Ve.length),Pe=D.FileIndex[xe],!(!Pe.size||!Pe.content||Ye=="Sh33tJ5")){var pr=we,lr=be(Ye.length);for(ve=0;ve<Ye.length;++ve)lr.write_shift(1,Ye.charCodeAt(ve)&127);lr=lr.slice(0,lr.l),Xe[Oe]=i9.buf(Pe.content,0);var cr=Pe.content;me==8&&(cr=P(cr)),J=be(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,Fe),J.write_shift(2,me),Pe.mt?s(J,Pe.mt):J.write_shift(4,0),J.write_shift(-4,Xe[Oe]),J.write_shift(4,cr.length),J.write_shift(4,Pe.content.length),J.write_shift(2,lr.length),J.write_shift(2,0),we+=J.length,O.push(J),we+=lr.length,O.push(lr),we+=cr.length,O.push(cr),J=be(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,Fe),J.write_shift(2,me),J.write_shift(4,0),J.write_shift(-4,Xe[Oe]),J.write_shift(4,cr.length),J.write_shift(4,Pe.content.length),J.write_shift(2,lr.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,pr),ot+=J.l,V.push(J),ot+=lr.length,V.push(lr),++Oe}return J=be(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Oe),J.write_shift(2,Oe),J.write_shift(4,ot),J.write_shift(4,we),J.write_shift(2,0),Bn([Bn(O),Bn(V),J])}var ar={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function MA(D,j){if(D.ctype)return D.ctype;var H=D.name||"",O=H.match(/\.([^\.]+)$/);return O&&ar[O[1]]||j&&(O=(H=j).match(/[\.\\]([^\.\\])+$/),O&&ar[O[1]])?ar[O[1]]:"application/octet-stream"}function LA(D){for(var j=du(D),H=[],O=0;O<j.length;O+=76)H.push(j.slice(O,O+76));return H.join(`\r
`)+`\r
`}function uo(D){var j=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var we=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],O=j.split(`\r
`),V=0;V<O.length;++V){var J=O[V];if(J.length==0){H.push("");continue}for(var me=0;me<J.length;){var Fe=76,xe=J.slice(me,me+Fe);xe.charAt(Fe-1)=="="?Fe--:xe.charAt(Fe-2)=="="?Fe-=2:xe.charAt(Fe-3)=="="&&(Fe-=3),xe=J.slice(me,me+Fe),me+=Fe,me<J.length&&(xe+="="),H.push(xe)}}return H.join(`\r
`)}function hi(D){for(var j=[],H=0;H<D.length;++H){for(var O=D[H];H<=D.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+D[++H];j.push(O)}for(var V=0;V<j.length;++V)j[V]=j[V].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return Sa(j.join(`\r
`))}function gi(D,j,H){for(var O="",V="",J="",me,Fe=0;Fe<10;++Fe){var xe=j[Fe];if(!xe||xe.match(/^\s*$/))break;var ve=xe.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":O=ve[2].trim();break;case"content-type":J=ve[2].trim();break;case"content-transfer-encoding":V=ve[2].trim();break}}switch(++Fe,V.toLowerCase()){case"base64":me=Sa(Fa(j.slice(Fe).join("")));break;case"quoted-printable":me=hi(j.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var we=OA(D,O.slice(H.length),me,{unsafe:!0});J&&(we.ctype=J)}function HA(D,j){if(ae(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=j&&j.root||"",O=(Dt&&Buffer.isBuffer(D)?D.toString("binary"):ae(D)).split(`\r
`),V=0,J="";for(V=0;V<O.length;++V)if(J=O[V],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),H||(H=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),J.slice(0,H.length)!=H););var me=(O[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Fe="--"+(me[1]||""),xe=[],ve=[],we={FileIndex:xe,FullPaths:ve};k(we);var Oe,Ve=0;for(V=0;V<O.length;++V){var Ye=O[V];Ye!==Fe&&Ye!==Fe+"--"||(Ve++&&gi(we,O.slice(Oe,V),H),Oe=V)}return we}function fo(D,j){var H=j||{},O=H.boundary||"SheetJS";O="------="+O;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],J=D.FullPaths[0],me=J,Fe=D.FileIndex[0],xe=1;xe<D.FullPaths.length;++xe)if(me=D.FullPaths[xe].slice(J.length),Fe=D.FileIndex[xe],!(!Fe.size||!Fe.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ot){return"_x"+ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ot){return"_u"+ot.charCodeAt(0).toString(16)+"_"});for(var ve=Fe.content,we=Dt&&Buffer.isBuffer(ve)?ve.toString("binary"):ae(ve),Oe=0,Ve=Math.min(1024,we.length),Ye=0,Pe=0;Pe<=Ve;++Pe)(Ye=we.charCodeAt(Pe))>=32&&Ye<128&&++Oe;var Xe=Oe>=Ve*4/5;V.push(O),V.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+me),V.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),V.push("Content-Type: "+MA(Fe,me)),V.push(""),V.push(Xe?uo(we):LA(we))}return V.push(O+`--\r
`),V.join(`\r
`)}function ho(D){var j={};return k(j,D),j}function OA(D,j,H,O){var V=O&&O.unsafe;V||k(D);var J=!V&&gt.find(D,j);if(!J){var me=D.FullPaths[0];j.slice(0,me.length)==me?me=j:(me.slice(-1)!="/"&&(me+="/"),me=(me+j).replace("//","/")),J={name:a(j),type:2},D.FileIndex.push(J),D.FullPaths.push(me),V||gt.utils.cfb_gc(D)}return J.content=H,J.size=H?H.length:0,O&&(O.CLSID&&(J.clsid=O.CLSID),O.mt&&(J.mt=O.mt),O.ct&&(J.ct=O.ct)),J}function go(D,j){k(D);var H=gt.find(D,j);if(H){for(var O=0;O<D.FileIndex.length;++O)if(D.FileIndex[O]==H)return D.FileIndex.splice(O,1),D.FullPaths.splice(O,1),!0}return!1}function mi(D,j,H){k(D);var O=gt.find(D,j);if(O){for(var V=0;V<D.FileIndex.length;++V)if(D.FileIndex[V]==O)return D.FileIndex[V].name=a(H),D.FullPaths[V]=H,!0}return!1}function vs(D){M(D,!0)}return t.find=re,t.read=U,t.parse=d,t.write=Le,t.writeFile=Qe,t.utils={cfb_new:ho,cfb_add:OA,cfb_del:go,cfb_mov:mi,cfb_gc:vs,ReadShift:qc,CheckField:pb,prep_blob:Nn,bconcat:Bn,use_zlib:Q,_deflateRaw:et,_inflateRaw:ha,consts:ie},t})();function o9(e){return typeof e=="string"?Xd(e):Array.isArray(e)?Q7(e):e}function Nu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Xd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?FA(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([o9(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ui(t)),l.write(t),l.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function l9(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function jr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function A2(e,t){for(var r=[],n=jr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Jd(e){for(var t=[],r=jr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Yd(e){for(var t=[],r=jr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function c9(e){for(var t=[],r=jr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var vd=new Date(1899,11,30,0,0,0);function mn(e,t){var r=e.getTime(),n=vd.getTime()+(e.getTimezoneOffset()-vd.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var Y_=new Date,u9=vd.getTime()+(Y_.getTimezoneOffset()-vd.getTimezoneOffset())*6e4,s2=Y_.getTimezoneOffset();function qd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+u9),t.getTimezoneOffset()!==s2&&t.setTime(t.getTime()+(t.getTimezoneOffset()-s2)*6e4),t}function f9(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var i2=new Date("2017-02-19T19:06:09.000Z"),q_=isNaN(i2.getFullYear())?new Date("2/19/17"):i2,d9=q_.getFullYear()==2017;function Nr(e,t){var r=new Date(e);if(d9)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(q_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function $i(e,t){if(Dt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return FA(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return FA(L_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return FA(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return FA(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ir(e[r]));return t}function Vr(e,t){for(var r="";r.length<t;)r+=e;return r}function gA(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var h9=["january","february","march","april","may","june","july","august","september","october","november","december"];function wl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&h9.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var g9=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],l=1;l<s.length;++l)i.push(a),i.push(s[l]);return i}})();function $_(e){return e?e.content&&e.type?$i(e.content,!0):e.data?Pc(e.data):e.asNodeBuffer&&Dt?Pc(e.asNodeBuffer().toString("binary")):e.asBinary?Pc(e.asBinary()):e._data&&e._data.getContent?Pc($i(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Z_(e){if(!e)return null;if(e.data)return JE(e.data);if(e.asNodeBuffer&&Dt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?JE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function m9(e){return e&&e.name.slice(-4)===".bin"?Z_(e):$_(e)}function Xa(e,t){for(var r=e.FullPaths||jr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Rx(e,t){var r=Xa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function sn(e,t,r){if(!r)return m9(Rx(e,t));if(!t)return null;try{return sn(e,t)}catch{return null}}function _a(e,t,r){if(!r)return $_(Rx(e,t));if(!t)return null;try{return _a(e,t)}catch{return null}}function p9(e,t,r){return Z_(Rx(e,t))}function o2(e){for(var t=e.FullPaths||jr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Qt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Dt?n=ms(r):n=R7(r),gt.utils.cfb_add(e,t,n)}gt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Dx(){return gt.utils.cfb_new()}function eb(e,t){switch(t.type){case"base64":return gt.read(e,{type:"base64"});case"binary":return gt.read(e,{type:"binary"});case"buffer":case"array":return gt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Vc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var en=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,x9=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,l2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,v9=/<[^>]*>/g,Xn=en.match(l2)?l2:v9,w9=/<\w*:/,y9=/<(\/?)\w+:/;function Ct(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(x9),l=0,u="",f=0,d="",p="",x=1;if(i)for(f=0;f!=i.length;++f){for(p=i[f],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(d=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(x=(a=p.charCodeAt(s+1))==34||a==39?1:0,u=p.slice(s+1+x,p.length-x),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var y=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[y]&&d.slice(l-3,l)=="ext")continue;n[y]=u,n[y.toLowerCase()]=u}}return n}function RA(e){return e.replace(y9,"<$1")}var tb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Mx=Jd(tb),qt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(l,u){return tb[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}})(),Lx=/[&<>'"]/g,B9=/[\u0000-\u0008\u000b-\u001f]/g;function mr(e){var t=e+"";return t.replace(Lx,function(r){return Mx[r]}).replace(B9,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function c2(e){return mr(e).replace(/ /g,"_x0020_")}var rb=/[\u0000-\u001f]/g;function Hx(e){var t=e+"";return t.replace(Lx,function(r){return Mx[r]}).replace(/\n/g,"<br/>").replace(rb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function C9(e){var t=e+"";return t.replace(Lx,function(r){return Mx[r]}).replace(rb,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var u2=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function E9(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function kr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Hm(e){for(var t="",r=0,n=0,a=0,s=0,i=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function f2(e){var t=ai(2*e.length),r,n,a=1,s=0,i=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function d2(e){return ms(e,"binary").toString("utf8")}var Sf="foo bar baz",Br=Dt&&(d2(Sf)==Hm(Sf)&&d2||f2(Sf)==Hm(Sf)&&f2)||Hm,FA=Dt?function(e){return ms(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gu=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),nb=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),T9=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),S9=/<\/?(?:vt:)?variant>/g,_9=/<(?:vt:)([^>]*)>([\s\S]*)</;function h2(e,t){var r=Ct(e),n=e.match(T9(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(S9,"").match(_9);i&&a.push({v:Br(i[2]),t:i[1]})}),a}var ab=/(^\s|\s$|\n)/;function In(e,t){return"<"+e+(t.match(ab)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function mu(e){return jr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ke(e,t,r){return"<"+e+(r!=null?mu(r):"")+(t!=null?(t.match(ab)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function zp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function b9(e,t){switch(typeof e){case"string":var r=Ke("vt:lpwstr",mr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ke((e|0)==e?"vt:i4":"vt:r8",mr(String(e)));case"boolean":return Ke("vt:bool",e?"true":"false")}if(e instanceof Date)return Ke("vt:filetime",zp(e));throw new Error("Unable to serialize "+e)}function Ox(e){if(Dt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Br(ui(Nx(e)));throw new Error("Bad input format: expected Buffer or string")}var pu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,gn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ao=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ea={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function F9(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function U9(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var g2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},m2=Dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ms(t)})):g2(e)}:g2,p2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(As(e,a)));return n.join("").replace(ta,"")},Px=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ta,""):p2(e,t,r)}:p2,x2=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Ab=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):x2(e,t,r)}:x2,v2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(il(e,a)));return n.join("")},Iu=Dt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):v2(t,r,n)}:v2,sb=function(e,t){var r=Ta(e,t);return r>0?Iu(e,t+4,t+4+r-1):""},ib=sb,ob=function(e,t){var r=Ta(e,t);return r>0?Iu(e,t+4,t+4+r-1):""},lb=ob,cb=function(e,t){var r=2*Ta(e,t);return r>0?Iu(e,t+4,t+4+r-1):""},ub=cb,fb=function(t,r){var n=Ta(t,r);return n>0?Px(t,r+4,r+4+n):""},db=fb,hb=function(e,t){var r=Ta(e,t);return r>0?Iu(e,t+4,t+4+r):""},gb=hb,mb=function(e,t){return F9(e,t)},wd=mb,Gx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Dt&&(ib=function(t,r){if(!Buffer.isBuffer(t))return sb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},lb=function(t,r){if(!Buffer.isBuffer(t))return ob(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ub=function(t,r){if(!Buffer.isBuffer(t))return cb(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},db=function(t,r){if(!Buffer.isBuffer(t))return fb(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},gb=function(t,r){if(!Buffer.isBuffer(t))return hb(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},wd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):mb(t,r)},Gx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var il=function(e,t){return e[t]},As=function(e,t){return e[t+1]*256+e[t]},k9=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ta=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Gi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},N9=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function qc(e,t){var r="",n,a,s=[],i,l,u,f;switch(t){case"dbcs":if(f=this.l,Dt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(As(this,f)),f+=2;e*=2;break;case"utf8":r=Iu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Px(this,this.l,this.l+e);break;case"wstr":return qc.call(this,e,"dbcs");case"lpstr-ansi":r=ib(this,this.l),e=4+Ta(this,this.l);break;case"lpstr-cp":r=lb(this,this.l),e=4+Ta(this,this.l);break;case"lpwstr":r=ub(this,this.l),e=4+2*Ta(this,this.l);break;case"lpp4":e=4+Ta(this,this.l),r=db(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ta(this,this.l),r=gb(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=il(this,this.l+e++))!==0;)s.push(Tf(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=As(this,this.l+e))!==0;)s.push(Tf(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return i=il(this,f),this.l=f+1,l=qc.call(this,e-u,i?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Tf(As(this,f))),f+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return i=il(this,f),this.l=f+1,l=qc.call(this,e-u,i?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Tf(il(this,f))),f+=1}r=s.join("");break;default:switch(e){case 1:return n=il(this,this.l),this.l++,n;case 2:return n=(t==="i"?k9:As)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Gi:N9)(this,this.l),this.l+=4,n):(a=Ta(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=wd(this,this.l):a=wd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Ab(this,this.l,e);break}}return this.l+=e,r}var I9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Q9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},R9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function D9(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)R9(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,I9(this,t,this.l);break;case 8:if(n=8,r==="f"){U9(this,t,this.l);break}case 16:break;case-4:n=4,Q9(this,t,this.l);break}return this.l+=n,this}function pb(e,t){var r=Ab(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Nn(e,t){e.l=t,e.read_shift=qc,e.chk=pb,e.write_shift=D9}function zn(e,t){e.l+=t}function be(e){var t=ai(e);return Nn(t,0),t}function ps(e,t,r){if(e){var n,a,s;Nn(e,e.l||0);for(var i=e.length,l=0,u=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=Cu[l]||Cu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;u=e.l+s;var d=f.f&&f.f(e,s,r);if(e.l=u,t(d,f,l))return}}}function fa(){var e=[],t=Dt?256:2048,r=function(f){var d=be(f);return Nn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},i=function(){return a(),Bn(e)},l=function(f){a(),n=f,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:i,_bufs:e}}function De(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Cu[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Gx(r)&&e.push(r)}}function $c(e,t,r){var n=Ir(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function w2(e,t,r){var n=Ir(e);return n.s=$c(n.s,t.s,r),n.e=$c(n.e,t.s,r),n}function Zc(e,t){if(e.cRel&&e.c<0)for(e=Ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=yt(e);return!e.cRel&&e.cRel!=null&&(r=H9(r)),!e.rRel&&e.rRel!=null&&(r=M9(r)),r}function Om(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Hr(e.s.c)+":"+(e.e.cRel?"":"$")+Hr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zr(e.s.r)+":"+(e.e.rRel?"":"$")+Zr(e.e.r):Zc(e.s,t.biff)+":"+Zc(e.e,t.biff)}function Vx(e){return parseInt(L9(e),10)-1}function Zr(e){return""+(e+1)}function M9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function L9(e){return e.replace(/\$(\d+)$/,"$1")}function Kx(e){for(var t=O9(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Hr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function H9(e){return e.replace(/^([A-Z])/,"$$$1")}function O9(e){return e.replace(/^\$([A-Z])/,"$1")}function P9(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Or(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function yt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function da(e){var t=e.indexOf(":");return t==-1?{s:Or(e),e:Or(e)}:{s:Or(e.slice(0,t)),e:Or(e.slice(t+1))}}function kt(e,t){return typeof t>"u"||typeof t=="number"?kt(e.s,e.e):(typeof e!="string"&&(e=yt(e)),typeof t!="string"&&(t=yt(t)),e==t?e:e+":"+t)}function $t(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function y2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=tA(e.z,r?mn(t):t)}catch{}try{return e.w=tA((e.XF||{}).numFmtId||(r?14:0),r?mn(t):t)}catch{return""+t}}function ds(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xs[e.v]||e.v:t==null?y2(e,e.v):y2(e,t))}function fi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function xb(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Or(n.origin):n.origin;i=u.r,l=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=$t(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(f.e.r=i=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[p].length;++x)if(!(typeof t[p][x]>"u")){var y={v:t[p][x]},C=i+p,E=l+x;if(f.s.r>C&&(f.s.r=C),f.s.c>E&&(f.s.c=E),f.e.r<C&&(f.e.r=C),f.e.c<E&&(f.e.c=E),t[p][x]&&typeof t[p][x]=="object"&&!Array.isArray(t[p][x])&&!(t[p][x]instanceof Date))y=t[p][x];else if(Array.isArray(y.v)&&(y.f=t[p][x][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||vt[14],n.cellDates?(y.t="d",y.w=tA(y.z,mn(y.v))):(y.t="n",y.v=mn(y.v),y.w=tA(y.z,y.v))):y.t="s";if(a)s[C]||(s[C]=[]),s[C][E]&&s[C][E].z&&(y.z=s[C][E].z),s[C][E]=y;else{var T=yt({c:E,r:C});s[T]&&s[T].z&&(y.z=s[T].z),s[T]=y}}}return f.s.c<1e7&&(s["!ref"]=kt(f)),s}function kl(e,t){return xb(null,e,t)}function G9(e){return e.read_shift(4,"i")}function mA(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function jn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function En(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function V9(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function K9(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function jx(e,t){var r=e.l,n=e.read_shift(1),a=jn(e),s=[],i={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),u=0;u!=l;++u)s.push(V9(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function j9(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),En(e.t,t),r?t.slice(0,t.l):t}var z9=jx;function X9(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),En(e.t,t),t.write_shift(4,1),K9({},t),r?t.slice(0,t.l):t}function rA(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function so(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function io(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function oo(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var W9=jn,vb=En;function zx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yd(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var J9=jn,Xp=zx,Xx=yd;function Wx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?wd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Gi(t,0)>>2;return r?a/100:a}function wb(e,t){t==null&&(t=be(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function yb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Y9(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var lo=yb,Nl=Y9;function Kn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zi(e,t){return(t||be(8)).write_shift(8,e,"f")}function q9(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=Xi[a];f&&(t.rgb=vu(f));break;case 2:t.rgb=vu([i,l,u]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Bd(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function $9(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Z9(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Bb(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function eG(e){return Bb(e,1)}function tG(e){return Bb(e,2)}var Jx=2,ca=3,_f=11,B2=12,Cd=19,bf=64,rG=65,nG=71,aG=4108,AG=4126,yn=80,Cb=81,sG=[yn,Cb],Wp={1:{n:"CodePage",t:Jx},2:{n:"Category",t:yn},3:{n:"PresentationFormat",t:yn},4:{n:"ByteCount",t:ca},5:{n:"LineCount",t:ca},6:{n:"ParagraphCount",t:ca},7:{n:"SlideCount",t:ca},8:{n:"NoteCount",t:ca},9:{n:"HiddenCount",t:ca},10:{n:"MultimediaClipCount",t:ca},11:{n:"ScaleCrop",t:_f},12:{n:"HeadingPairs",t:aG},13:{n:"TitlesOfParts",t:AG},14:{n:"Manager",t:yn},15:{n:"Company",t:yn},16:{n:"LinksUpToDate",t:_f},17:{n:"CharacterCount",t:ca},19:{n:"SharedDoc",t:_f},22:{n:"HyperlinksChanged",t:_f},23:{n:"AppVersion",t:ca,p:"version"},24:{n:"DigSig",t:rG},26:{n:"ContentType",t:yn},27:{n:"ContentStatus",t:yn},28:{n:"Language",t:yn},29:{n:"Version",t:yn},255:{},2147483648:{n:"Locale",t:Cd},2147483651:{n:"Behavior",t:Cd},1919054434:{}},Jp={1:{n:"CodePage",t:Jx},2:{n:"Title",t:yn},3:{n:"Subject",t:yn},4:{n:"Author",t:yn},5:{n:"Keywords",t:yn},6:{n:"Comments",t:yn},7:{n:"Template",t:yn},8:{n:"LastAuthor",t:yn},9:{n:"RevNumber",t:yn},10:{n:"EditTime",t:bf},11:{n:"LastPrinted",t:bf},12:{n:"CreatedDate",t:bf},13:{n:"ModifiedDate",t:bf},14:{n:"PageCount",t:ca},15:{n:"WordCount",t:ca},16:{n:"CharCount",t:ca},17:{n:"Thumbnail",t:nG},18:{n:"Application",t:yn},19:{n:"DocSecurity",t:ca},255:{},2147483648:{n:"Locale",t:Cd},2147483651:{n:"Behavior",t:Cd},1919054434:{}},C2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},iG=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function oG(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var lG=oG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xi=Ir(lG),xs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Eb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Yp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ff={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Yx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function cG(e){var t=Yx();if(!e||!e.match)return t;var r={};if((e.match(Xn)||[]).forEach(function(n){var a=Ct(n);switch(a[0].replace(w9,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Yp[a.ContentType]]!==void 0&&t[Yp[a.ContentType]].push(a.PartName);break}}),t.xmlns!==gn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Tb(e,t){var r=c9(Yp),n=[],a;n[n.length]=en,n[n.length]=Ke("Types",null,{xmlns:gn.CT,"xmlns:xsd":gn.xsd,"xmlns:xsi":gn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ke("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(a=e[u][0],n[n.length]=Ke("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Ff[u][t.bookType]||Ff[u].xlsx}))},i=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Ke("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Ff[u][t.bookType]||Ff[u].xlsx})})},l=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Ke("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[u][0]})})};return s("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Lt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function eu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Xn)||[]).forEach(function(a){var s=Ct(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Vc(s.Target,t);r[l]=i,n[s.Id]=i}}),r["!id"]=n,r}function ml(e){var t=[en,Ke("Relationships",null,{xmlns:gn.RELS})];return jr(e["!id"]).forEach(function(r){t[t.length]=Ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function gr(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Lt.HLINK,Lt.XPATH,Lt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var uG="application/vnd.oasis.opendocument.spreadsheet";function fG(e,t){for(var r=Ox(e),n,a;n=pu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ct(n[0],!1),a.path=="/"&&a.type!==uG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function dG(e){var t=[en];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function E2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function hG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function gG(e){var t=[en];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(E2(e[r][0],e[r][1])),t.push(hG("",e[r][0]));return t.push(E2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Sb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gd.version+"</meta:generator></office:meta></office:document-meta>"}var $a=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],mG=(function(){for(var e=new Array($a.length),t=0;t<$a.length;++t){var r=$a[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function _b(e){var t={};e=Br(e);for(var r=0;r<$a.length;++r){var n=$a[r],a=e.match(mG[r]);a!=null&&a.length>0&&(t[n[1]]=qt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Nr(t[n[1]]))}return t}function Pm(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=mr(t),n[n.length]=r?Ke(e,t,r):In(e,t))}function bb(e,t){var r=t||{},n=[en,Ke("cp:coreProperties",null,{"xmlns:cp":gn.CORE_PROPS,"xmlns:dc":gn.dc,"xmlns:dcterms":gn.dcterms,"xmlns:dcmitype":gn.dcmitype,"xmlns:xsi":gn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Pm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:zp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Pm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:zp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=$a.length;++s){var i=$a[s],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Pm(i[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Wi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Fb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ub(e,t,r,n){var a=[];if(typeof e=="string")a=h2(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var i=typeof t=="string"?h2(t,n).map(function(d){return d.v}):t,l=0,u=0;if(i.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=i.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=i.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=i.slice(l,l+u);break}l+=u}}function pG(e,t,r){var n={};return t||(t={}),e=Br(e),Wi.forEach(function(a){var s=(e.match(gu(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=qt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ub(n.HeadingPairs,n.TitlesOfParts,t,r),t}function kb(e){var t=[],r=Ke;return e||(e={}),e.Application="SheetJS",t[t.length]=en,t[t.length]=Ke("Properties",null,{xmlns:gn.EXT_PROPS,"xmlns:vt":gn.vt}),Wi.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=mr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+mr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xG=/<[^>]+>[^<]*/g;function vG(e,t){var r={},n="",a=e.match(xG);if(a)for(var s=0;s!=a.length;++s){var i=a[s],l=Ct(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=qt(l.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var u=i.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=qt(d);break;case"bool":r[n]=kr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Nr(d);break;case"cy":case"error":r[n]=qt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,u)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Nb(e){var t=[en,Ke("Properties",null,{xmlns:gn.CUST_PROPS,"xmlns:vt":gn.vt})];if(!e)return t.join("");var r=1;return jr(e).forEach(function(a){++r,t[t.length]=Ke("property",b9(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:mr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Gm;function wG(e,t,r){Gm||(Gm=Jd(qp)),t=Gm[t]||t,e[t]=r}function yG(e,t){var r=[];return jr(qp).map(function(n){for(var a=0;a<$a.length;++a)if($a[a][1]==n)return $a[a];for(a=0;a<Wi.length;++a)if(Wi[a][1]==n)return Wi[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(In(qp[n[1]]||n[1],a))}}),Ke("DocumentProperties",r.join(""),{xmlns:Ea.o})}function BG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&jr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<$a.length;++i)if(s==$a[i][1])return;for(i=0;i<Wi.length;++i)if(s==Wi[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var l=e[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),a.push(Ke(c2(s),l,{"dt:dt":u}))}}),t&&jr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),a.push(Ke(c2(s),i,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Ea.o+'">'+a.join("")+"</"+n+">"}function qx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function CG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=be(8);return i.write_shift(4,n),i.write_shift(4,a),i}function Ib(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Qb(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Rb(e,t,r){return t===31?Qb(e):Ib(e,t,r)}function $p(e,t,r){return Rb(e,t,r===!1?0:4)}function EG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Rb(e,t,0)}function TG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ta,""),e.l-a&2&&(e.l+=2)}return r}function SG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ta,"");return r}function _G(e){var t=e.l,r=Ed(e,Cb);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ed(e,ca);return[r,n]}function bG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(_G(e));return r}function T2(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(ta,"").replace(Gc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Db(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function FG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ed(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==B2&&n!==t&&sG.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===B2?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Ib(e,n,4).replace(ta,"");case 31:return Qb(e);case 64:return qx(e);case 65:return Db(e);case 71:return FG(e);case 80:return $p(e,n,!s.raw).replace(ta,"");case 81:return EG(e,n).replace(ta,"");case 4108:return bG(e);case 4126:case 4127:return n==4127?TG(e):SG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function S2(e,t){var r=be(4),n=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=be(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=CG(t);break;case 31:case 80:for(n=be(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Bn([r,n])}function _2(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,l=0,u=-1,f={};for(i=0;i!=a;++i){var d=e.read_shift(4),p=e.read_shift(4);s[i]=[d,p+r]}s.sort(function(F,_){return F[1]-_[1]});var x={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var y=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,y=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],y=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],y=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(y=!1,e.l=s[i][1]),y)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var C=t[s[i][0]];if(x[C.n]=Ed(e,C.t,{raw:!0}),C.p==="version"&&(x[C.n]=String(x[C.n]>>16)+"."+("0000"+String(x[C.n]&65535)).slice(-4)),C.n=="CodePage")switch(x[C.n]){case 0:x[C.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:uA(l=x[C.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[C.n])}}else if(s[i][0]===1){if(l=x.CodePage=Ed(e,Jx),uA(l),u!==-1){var E=e.l;e.l=s[u][1],f=T2(e,l),e.l=E}}else if(s[i][0]===0){if(l===0){u=i,e.l=s[i+1][1];continue}f=T2(e,l)}else{var T=f[s[i][0]],S;switch(e[e.l]){case 65:e.l+=4,S=Db(e);break;case 30:e.l+=4,S=$p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=$p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=qr(e,4);break;case 64:e.l+=4,S=Nr(qx(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[T]=S}}return e.l=r+n,x}var Mb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function b2(e,t,r){var n=be(8),a=[],s=[],i=8,l=0,u=be(8),f=be(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),a.push(f),i+=8+u.length,!t){f=be(8),f.write_shift(4,0),a.unshift(f);var d=[be(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var p=e[l][0];for(u=be(8+2*(p.length+1)+(p.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,p.length+1),u.write_shift(0,p,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=Bn(d),s.unshift(u),i+=8+u.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Mb.indexOf(e[l][0])>-1||Fb.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],y=0;if(t){y=+t[e[l][0]];var C=r[y];if(C.p=="version"&&typeof x=="string"){var E=x.split(".");x=(+E[0]<<16)+(+E[1]||0)}u=S2(C.t,x)}else{var T=UG(x);T==-1&&(T=31,x=String(x)),u=S2(T,x)}s.push(u),f=be(8),f.write_shift(4,t?y:2+l),a.push(f),i+=8+u.length}var S=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,S),S+=s[l].length;return n.write_shift(4,i),n.write_shift(4,s.length),Bn([n].concat(a).concat(s))}function F2(e,t,r){var n=e.content;if(!n)return{};Nn(n,0);var a,s,i,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==gt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(i=n.read_shift(16),u=n.read_shift(4));var p=_2(n,t),x={SystemIdentifier:f};for(var y in p)x[y]=p[y];if(x.FMTID=s,a===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var C;try{C=_2(n,null)}catch{}for(y in C)x[y]=C[y];return x.FMTID=[s,i],x}function U2(e,t,r,n,a,s){var i=be(a?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,gt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var u=b2(e,r,n);if(l.push(u),a){var f=b2(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+u.length),l.push(f)}return Bn(l)}function Ks(e,t){return e.read_shift(t),null}function kG(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function NG(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function qr(e,t){return e.read_shift(t)===1}function ea(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function on(e){return e.read_shift(2,"u")}function Wa(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function Lb(e,t){return NG(e,t,on)}function IG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Hb(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Qu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function QG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,l,u={};a&&(i=e.read_shift(2)),n&&(l=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*i),n&&(e.l+=l),u.t=d,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function RG(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=be(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Bn(a)}function eo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ru(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):eo(e,n,r)}function co(e,t,r){if(r.biff>5)return Ru(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ob(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function DG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function MG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ta,"");return n&&(e.l+=24),a}function LG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(ta,"");return r+i}function HG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return MG(e);case"0303000000000000c000000000000046":return LG(e);default:throw new Error("Unsupported Moniker "+r)}}function Uf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ta,""):"";return r}function k2(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function OG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,l,u,f="",d,p;a&16&&(s=Uf(e,r-e.l)),a&128&&(i=Uf(e,r-e.l)),(a&257)===257&&(l=Uf(e,r-e.l)),(a&257)===1&&(u=HG(e,r-e.l)),a&8&&(f=Uf(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(p=qx(e)),e.l=r;var x=i||l||u||"";x&&f&&(x+="#"+f),x||(x="#"+f),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var y={Target:x};return d&&(y.guid=d),p&&(y.time=p),s&&(y.Tooltip=s),y}function PG(e){var t=be(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),k2(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&k2(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)t.write_shift(1,n.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Pb(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Gb(e,t){var r=Pb(e);return r[3]=0,r}function DA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function to(e,t,r,n){return n||(n=be(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function GG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function VG(e,t,r){return t===0?"":co(e,t,r)}function KG(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Vb(e){var t=e.read_shift(2),r=Wx(e);return[t,r]}function jG(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Qu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function $d(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Kb(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function jb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var zG=jb;function zb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function XG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function WG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Mn(e){e.l+=2,e.l+=e.read_shift(2)}var JG={0:Mn,4:Mn,5:Mn,6:Mn,7:WG,8:Mn,9:Mn,10:Mn,11:Mn,12:Mn,13:XG,14:Mn,15:Mn,16:Mn,17:Mn,18:Mn,19:Mn,20:Mn,21:zb};function YG(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(JG[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function kf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function $x(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=be(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function qG(e,t){return t===0||e.read_shift(2),1200}function $G(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=co(e,0,r);return e.read_shift(t+n-e.l),a}function ZG(e,t){var r=!t||t.biff==8,n=be(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function eV(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function tV(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Qu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function rV(e,t){var r=!t||t.biff>=8?2:1,n=be(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function nV(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(QG(e));return s.Count=n,s.Unique=a,s}function aV(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=RG(e[a]);var s=Bn([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function AV(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function sV(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function iV(e){var t=GG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function oV(e){return e.read_shift(2),e.read_shift(4)}function N2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function lV(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:l,Selected:u,TabRatio:f}}function cV(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function uV(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function fV(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function dV(){}function hV(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Qu(e,0,r),n}function gV(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=be(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function mV(e){var t=DA(e);return t.isst=e.read_shift(4),t}function pV(e,t,r,n){var a=be(10);return to(e,t,n,a),a.write_shift(4,r),a}function xV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=DA(e);r.biff==2&&e.l++;var s=Ru(e,n-e.l,r);return a.val=s,a}function vV(e,t,r,n,a){var s=!a||a.biff==8,i=be(8+ +s+(1+s)*r.length);return to(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function wV(e,t,r){var n=e.read_shift(2),a=co(e,0,r);return[n,a]}function yV(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var BV=co;function I2(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:i,c:u}}}function CV(e,t){var r=t.biff==8||!t.biff?4:2,n=be(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function EV(e){var t=e.read_shift(2),r=e.read_shift(2),n=Vb(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function TV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Vb(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function SV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function _V(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return a.patternType=iG[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function bV(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=_V(e,t,n.fStyle,r),n}function Q2(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function FV(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function UV(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function R2(e,t,r){var n=DA(e);(r.biff==2||t==9)&&++e.l;var a=IG(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function kV(e,t,r,n,a,s){var i=be(8);return to(e,t,n,i),Hb(r,s,i),i}function NV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=DA(e),a=Kn(e);return n.val=a,n}function IV(e,t,r,n){var a=be(14);return to(e,t,n,a),Zi(r,a),a}var D2=VG;function QV(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=eo(e,s),l=[];n>e.l;)l.push(Ru(e));return[s,a,i,l]}function M2(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=jG(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var RV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function L2(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=eo(e,i,r);a&32&&(f=RV[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var p=n==e.l||l===0||!(d>0)?[]:YX(e,d,r,l);return{chKey:s,Name:f,itab:u,rgce:p}}function Xb(e,t,r){if(r.biff<8)return DV(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(KG(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function DV(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Qu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function MV(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=eo(e,n,r),i=eo(e,a,r);return[s,i]}function LV(e,t,r){var n=jb(e);e.l++;var a=e.read_shift(1);return t-=8,[qX(e,t,r),a,n]}function H2(e,t,r){var n=zG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,WX(e,t,r)]}function HV(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function OV(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=co(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,i,s]}}function PV(e,t,r){return OV(e,t,r)}function GV(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push($d(e));return r}function VV(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Kb(e[r],t);return t}function KV(e,t,r){if(r&&r.biff<8)return zV(e,t,r);var n=zb(e),a=YG(e,t-22,n[1]);return{cmo:n,ft:a}}var jV={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function zV(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((jV[n]||zn)(e,t,r)),{cmo:[a,n,s],ft:i}}function XV(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=DG(e,6,r);var l=e.read_shift(2);e.read_shift(2),on(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],p=eo(e,e.lens[f+1]-e.lens[f]-1);if(a+=p,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function WV(e,t){var r=$d(e);e.l+=16;var n=OG(e,t-24);return[r,n]}function JV(e){var t=be(24),r=Or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Bn([t,PG(e[1])])}function YV(e,t){e.read_shift(2);var r=$d(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ta,""),[r,n]}function qV(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var n=Or(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function $V(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=C2[r]||r,r=e.read_shift(2),t[1]=C2[r]||r,t}function ZV(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function eK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Gb(e));return r}function tK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Gb(e));return r}function rK(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Wb(e,t,r){if(!r.cellStyles)return zn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:s,w:i,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function nK(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function aK(e,t){var r={};return t<32||(e.l+=16,r.header=Kn(e),r.footer=Kn(e),e.l+=2),r}function AK(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function sK(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var iK=DA,oK=Lb,lK=Ru;function cK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function uK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=DA(e);++e.l;var a=co(e,t-7,r);return n.t="str",n.val=a,n}function fK(e){var t=DA(e);++e.l;var r=Kn(e);return t.t="n",t.val=r,t}function dK(e,t,r){var n=be(15);return Hu(n,e,t),n.write_shift(8,r,"f"),n}function hK(e){var t=DA(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gK(e,t,r){var n=be(9);return Hu(n,e,t),n.write_shift(2,r),n}function mK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function pK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function xK(e,t,r){var n=e.l+t,a=DA(e),s=e.read_shift(2),i=eo(e,s,r);return e.l=n,a.t="str",a.val=i,a}var vK=[2,3,48,49,131,139,140,245],Zp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Jd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],d=ai(1);switch(u.type){case"base64":d=Sa(Fa(l));break;case"binary":d=Sa(l);break;case"buffer":case"array":d=l;break}Nn(d,0);var p=d.read_shift(1),x=!!(p&136),y=!1,C=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,x=!0;break;case 49:y=!0,x=!0;break;case 131:break;case 139:break;case 140:C=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var E=0,T=521;p==2&&(E=d.read_shift(2)),d.l+=3,p!=2&&(E=d.read_shift(4)),E>1048576&&(E=1e6),p!=2&&(T=d.read_shift(2));var S=d.read_shift(2),F=u.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=e[d[d.l]]),d.l+=1,d.l+=2),C&&(d.l+=36);for(var _=[],N={},I=Math.min(d.length,p==2?521:T-10-(y?264:0)),U=C?32:11;d.l<I&&d[d.l]!=13;)switch(N={},N.name=fu.utils.decode(F,d.slice(d.l,d.l+U)).replace(/[\u0000\r\n].*$/g,""),d.l+=U,N.type=String.fromCharCode(d.read_shift(1)),p!=2&&!C&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),p==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&_.push(N),p!=2&&(d.l+=C?13:14),N.type){case"B":(!y||N.len!=8)&&u.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=T-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=T;var k=0,G=0;for(f[0]=[],G=0;G!=_.length;++G)f[0][G]=_[G].name;for(;E-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,f[++k]=[],G=0,G=0;G!=_.length;++G){var M=d.slice(d.l,d.l+_[G].len);d.l+=_[G].len,Nn(M,0);var ee=fu.utils.decode(F,M);switch(_[G].type){case"C":ee.trim().length&&(f[k][G]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?f[k][G]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):f[k][G]=ee;break;case"F":f[k][G]=parseFloat(ee.trim());break;case"+":case"I":f[k][G]=C?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":f[k][G]=!0;break;case"N":case"F":f[k][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[k][G]="##MEMO##"+(C?parseInt(ee.trim(),10):M.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(f[k][G]=+ee||0);break;case"@":f[k][G]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":f[k][G]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":f[k][G]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[k][G]=-M.read_shift(-8,"f");break;case"B":if(y&&_[G].len==8){f[k][G]=M.read_shift(8,"f");break}case"G":case"P":M.l+=_[G].len;break;case"0":if(_[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[G].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=_,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=kl(r(l,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function a(l,u){try{return fi(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,u){var f=u||{};if(+f.codepage>=0&&uA(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=fa(),p=_d(l,{header:1,raw:!0,cellDates:!0}),x=p[0],y=p.slice(1),C=l["!cols"]||[],E=0,T=0,S=0,F=1;for(E=0;E<x.length;++E){if(((C[E]||{}).DBF||{}).name){x[E]=C[E].DBF.name,++S;continue}if(x[E]!=null){if(++S,typeof x[E]=="number"&&(x[E]=x[E].toString(10)),typeof x[E]!="string")throw new Error("DBF Invalid column name "+x[E]+" |"+typeof x[E]+"|");if(x.indexOf(x[E])!==E){for(T=0;T<1024;++T)if(x.indexOf(x[E]+"_"+T)==-1){x[E]+="_"+T;break}}}}var _=$t(l["!ref"]),N=[],I=[],U=[];for(E=0;E<=_.e.c-_.s.c;++E){var k="",G="",M=0,ee=[];for(T=0;T<y.length;++T)y[T][E]!=null&&ee.push(y[T][E]);if(ee.length==0||x[E]==null){N[E]="?";continue}for(T=0;T<ee.length;++T){switch(typeof ee[T]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=ee[T]instanceof Date?"D":"C";break;default:G="C"}M=Math.max(M,String(ee[T]).length),k=k&&k!=G?"C":G}M>250&&(M=250),G=((C[E]||{}).DBF||{}).type,G=="C"&&C[E].DBF.len>M&&(M=C[E].DBF.len),k=="B"&&G=="N"&&(k="N",U[E]=C[E].DBF.dec,M=C[E].DBF.len),I[E]=k=="C"||G=="N"?M:s[k]||0,F+=I[E],N[E]=k}var re=d.next(32);for(re.write_shift(4,318902576),re.write_shift(4,y.length),re.write_shift(2,296+32*S),re.write_shift(2,F),E=0;E<4;++E)re.write_shift(4,0);for(re.write_shift(4,0|(+t[M_]||3)<<8),E=0,T=0;E<x.length;++E)if(x[E]!=null){var q=d.next(32),se=(x[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,se,"sbcs"),q.write_shift(1,N[E]=="?"?"C":N[E],"sbcs"),q.write_shift(4,T),q.write_shift(1,I[E]||s[N[E]]||0),q.write_shift(1,U[E]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),T+=I[E]||s[N[E]]||0}var Te=d.next(264);for(Te.write_shift(4,13),E=0;E<65;++E)Te.write_shift(4,0);for(E=0;E<y.length;++E){var Be=d.next(F);for(Be.write_shift(1,0),T=0;T<x.length;++T)if(x[T]!=null)switch(N[T]){case"L":Be.write_shift(1,y[E][T]==null?63:y[E][T]?84:70);break;case"B":Be.write_shift(8,y[E][T]||0,"f");break;case"N":var Z="0";for(typeof y[E][T]=="number"&&(Z=y[E][T].toFixed(U[T]||0)),S=0;S<I[T]-Z.length;++S)Be.write_shift(1,32);Be.write_shift(1,Z,"sbcs");break;case"D":y[E][T]?(Be.write_shift(4,("0000"+y[E][T].getFullYear()).slice(-4),"sbcs"),Be.write_shift(2,("00"+(y[E][T].getMonth()+1)).slice(-2),"sbcs"),Be.write_shift(2,("00"+y[E][T].getDate()).slice(-2),"sbcs")):Be.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(y[E][T]!=null?y[E][T]:"").slice(0,I[T]);for(Be.write_shift(1,ie,"sbcs"),S=0;S<I[T]-ie.length;++S)Be.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}})(),Jb=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+jr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,y){var C=e[y];return typeof C=="number"?YE(C):C},n=function(x,y,C){var E=y.charCodeAt(0)-32<<4|C.charCodeAt(0)-48;return E==59?x:YE(E)};e["|"]=254;function a(x,y){switch(y.type){case"base64":return s(Fa(x),y);case"binary":return s(x,y);case"buffer":return s(Dt&&Buffer.isBuffer(x)?x.toString("binary"):ui(x),y);case"array":return s($i(x),y)}throw new Error("Unrecognized type "+y.type)}function s(x,y){var C=x.split(/[\n\r]+/),E=-1,T=-1,S=0,F=0,_=[],N=[],I=null,U={},k=[],G=[],M=[],ee=0,re;for(+y.codepage>=0&&uA(+y.codepage);S!==C.length;++S){ee=0;var q=C[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),se=q.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Te=se[0],Be;if(q.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&N.push(q.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ie=!1,Qe=!1,ae=!1,Le=-1,Y=-1;for(F=1;F<se.length;++F)switch(se[F].charAt(0)){case"A":break;case"X":T=parseInt(se[F].slice(1))-1,ie=!0;break;case"Y":for(E=parseInt(se[F].slice(1))-1,ie||(T=0),re=_.length;re<=E;++re)_[re]=[];break;case"K":Be=se[F].slice(1),Be.charAt(0)==='"'?Be=Be.slice(1,Be.length-1):Be==="TRUE"?Be=!0:Be==="FALSE"?Be=!1:isNaN(gA(Be))?isNaN(wl(Be).getDate())||(Be=Nr(Be)):(Be=gA(Be),I!==null&&Fl(I)&&(Be=qd(Be))),Z=!0;break;case"E":ae=!0;var Q=pl(se[F].slice(1),{r:E,c:T});_[E][T]=[_[E][T],Q];break;case"S":Qe=!0,_[E][T]=[_[E][T],"S5S"];break;case"G":break;case"R":Le=parseInt(se[F].slice(1))-1;break;case"C":Y=parseInt(se[F].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+q)}if(Z&&(_[E][T]&&_[E][T].length==2?_[E][T][0]=Be:_[E][T]=Be,I=null),Qe){if(ae)throw new Error("SYLK shared formula cannot have own formula");var K=Le>-1&&_[Le][Y];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");_[E][T][1]=d4(K[1],{r:E-Le,c:T-Y})}break;case"F":var P=0;for(F=1;F<se.length;++F)switch(se[F].charAt(0)){case"X":T=parseInt(se[F].slice(1))-1,++P;break;case"Y":for(E=parseInt(se[F].slice(1))-1,re=_.length;re<=E;++re)_[re]=[];break;case"M":ee=parseInt(se[F].slice(1))/20;break;case"F":break;case"G":break;case"P":I=N[parseInt(se[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=se[F].slice(1).split(" "),re=parseInt(M[0],10);re<=parseInt(M[1],10);++re)ee=parseInt(M[2],10),G[re-1]=ee===0?{hidden:!0}:{wch:ee},Ai(G[re-1]);break;case"C":T=parseInt(se[F].slice(1))-1,G[T]||(G[T]={});break;case"R":E=parseInt(se[F].slice(1))-1,k[E]||(k[E]={}),ee>0?(k[E].hpt=ee,k[E].hpx=Bl(ee)):ee===0&&(k[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+q)}P<1&&(I=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+q)}}return k.length>0&&(U["!rows"]=k),G.length>0&&(U["!cols"]=G),y&&y.sheetRows&&(_=_.slice(0,y.sheetRows)),[_,U]}function i(x,y){var C=a(x,y),E=C[0],T=C[1],S=kl(E,y);return jr(T).forEach(function(F){S[F]=T[F]}),S}function l(x,y){return fi(i(x,y),y)}function u(x,y,C,E){var T="C;Y"+(C+1)+";X"+(E+1)+";K";switch(x.t){case"n":T+=x.v||0,x.f&&!x.F&&(T+=";E"+av(x.f,{r:C,c:E}));break;case"b":T+=x.v?"TRUE":"FALSE";break;case"e":T+=x.w||x.v;break;case"d":T+='"'+(x.w||x.v)+'"';break;case"s":T+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function f(x,y){y.forEach(function(C,E){var T="F;W"+(E+1)+" "+(E+1)+" ";C.hidden?T+="0":(typeof C.width=="number"&&!C.wpx&&(C.wpx=wu(C.width)),typeof C.wpx=="number"&&!C.wch&&(C.wch=yu(C.wpx)),typeof C.wch=="number"&&(T+=Math.round(C.wch))),T.charAt(T.length-1)!=" "&&x.push(T)})}function d(x,y){y.forEach(function(C,E){var T="F;";C.hidden?T+="M0;":C.hpt?T+="M"+20*C.hpt+";":C.hpx&&(T+="M"+20*Bu(C.hpx)+";"),T.length>2&&x.push(T+"R"+(E+1))})}function p(x,y){var C=["ID;PWXL;N;E"],E=[],T=$t(x["!ref"]),S,F=Array.isArray(x),_=`\r
`;C.push("P;PGeneral"),C.push("F;P0;DG0G8;M255"),x["!cols"]&&f(C,x["!cols"]),x["!rows"]&&d(C,x["!rows"]),C.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var N=T.s.r;N<=T.e.r;++N)for(var I=T.s.c;I<=T.e.c;++I){var U=yt({r:N,c:I});S=F?(x[N]||[])[I]:x[U],!(!S||S.v==null&&(!S.f||S.F))&&E.push(u(S,x,N,I))}return C.join(_)+_+E.join(_)+_+"E"+_}return{to_workbook:l,to_sheet:i,from_sheet:p}})(),Yb=(function(){function e(s,i){switch(i.type){case"base64":return t(Fa(s),i);case"binary":return t(s,i);case"buffer":return t(Dt&&Buffer.isBuffer(s)?s.toString("binary"):ui(s),i);case"array":return t($i(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var l=s.split(`
`),u=-1,f=-1,d=0,p=[];d!==l.length;++d){if(l[d].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var x=l[d].trim().split(","),y=x[0],C=x[1];++d;for(var E=l[d]||"";(E.match(/["]/g)||[]).length&1&&d<l.length-1;)E+=`
`+l[++d];switch(E=E.trim(),+y){case-1:if(E==="BOT"){p[++u]=[],f=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?p[u][f]=!0:E==="FALSE"?p[u][f]=!1:isNaN(gA(C))?isNaN(wl(C).getDate())?p[u][f]=C:p[u][f]=Nr(C):p[u][f]=gA(C),++f;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),p[u][f++]=E!==""?E:null;break}if(E==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(s,i){return kl(e(s,i),i)}function n(s,i){return fi(r(s,i),i)}var a=(function(){var s=function(u,f,d,p,x){u.push(f),u.push(d+","+p),u.push('"'+x.replace(/"/g,'""')+'"')},i=function(u,f,d,p){u.push(f+","+d),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],d=$t(u["!ref"]),p,x=Array.isArray(u);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,d.e.r-d.s.r+1,""),s(f,"TUPLES",0,d.e.c-d.s.c+1,""),s(f,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){i(f,-1,0,"BOT");for(var C=d.s.c;C<=d.e.c;++C){var E=yt({r:y,c:C});if(p=x?(u[y]||[])[C]:u[E],!p){i(f,1,0,"");continue}switch(p.t){case"n":var T=p.w;!T&&p.v!=null&&(T=p.v),T==null?p.f&&!p.F?i(f,1,0,"="+p.f):i(f,1,0,""):i(f,0,T,"V");break;case"b":i(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=tA(p.z||vt[14],mn(Nr(p.v)))),i(f,0,p.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var S=`\r
`,F=f.join(S);return F}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),qb=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,x){for(var y=p.split(`
`),C=-1,E=-1,T=0,S=[];T!==y.length;++T){var F=y[T].trim().split(":");if(F[0]==="cell"){var _=Or(F[1]);if(S.length<=_.r)for(C=S.length;C<=_.r;++C)S[C]||(S[C]=[]);switch(C=_.r,E=_.c,F[2]){case"t":S[C][E]=e(F[3]);break;case"v":S[C][E]=+F[3];break;case"vtf":var N=F[F.length-1];case"vtc":switch(F[3]){case"nl":S[C][E]=!!+F[4];break;default:S[C][E]=+F[4];break}F[2]=="vtf"&&(S[C][E]=[S[C][E],N])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(p,x){return kl(r(p,x),x)}function a(p,x){return fi(n(p,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var x=[],y=[],C,E="",T=da(p["!ref"]),S=Array.isArray(p),F=T.s.r;F<=T.e.r;++F)for(var _=T.s.c;_<=T.e.c;++_)if(E=yt({r:F,c:_}),C=S?(p[F]||[])[_]:p[E],!(!C||C.v==null||C.t==="z")){switch(y=["cell",E,"t"],C.t){case"s":case"str":y.push(t(C.v));break;case"n":C.f?(y[2]="vtf",y[3]="n",y[4]=C.v,y[5]=t(C.f)):(y[2]="v",y[3]=C.v);break;case"b":y[2]="vt"+(C.f?"f":"c"),y[3]="nl",y[4]=C.v?"1":"0",y[5]=t(C.f||(C.v?"TRUE":"FALSE"));break;case"d":var N=mn(Nr(C.v));y[2]="vtc",y[3]="nd",y[4]=""+N,y[5]=C.w||tA(C.z||vt[14],N);break;case"e":continue}x.push(y.join(":"))}return x.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(p){return[s,i,l,i,f(p),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}})(),yl=(function(){function e(d,p,x,y,C){C.raw?p[x][y]=d:d===""||(d==="TRUE"?p[x][y]=!0:d==="FALSE"?p[x][y]=!1:isNaN(gA(d))?isNaN(wl(d).getDate())?p[x][y]=d:p[x][y]=Nr(d):p[x][y]=gA(d))}function t(d,p){var x=p||{},y=[];if(!d||d.length===0)return y;for(var C=d.split(/[\r\n]/),E=C.length-1;E>=0&&C[E].length===0;)--E;for(var T=10,S=0,F=0;F<=E;++F)S=C[F].indexOf(" "),S==-1?S=C[F].length:S++,T=Math.max(T,S);for(F=0;F<=E;++F){y[F]=[];var _=0;for(e(C[F].slice(0,T).trim(),y,F,_,x),_=1;_<=(C[F].length-T)/10+1;++_)e(C[F].slice(T+(_-1)*10,T+_*10).trim(),y,F,_,x)}return x.sheetRows&&(y=y.slice(0,x.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var p={},x=!1,y=0,C=0;y<d.length;++y)(C=d.charCodeAt(y))==34?x=!x:!x&&C in r&&(p[C]=(p[C]||0)+1);C=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&C.push([p[y],y]);if(!C.length){p=n;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&C.push([p[y],y])}return C.sort(function(E,T){return E[0]-T[0]||n[E[1]]-n[T[1]]}),r[C.pop()[1]]||44}function s(d,p){var x=p||{},y="",C=x.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=a(d.slice(0,1024)):x&&x.FS?y=x.FS:y=a(d.slice(0,1024));var T=0,S=0,F=0,_=0,N=0,I=y.charCodeAt(0),U=!1,k=0,G=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=x.dateNF!=null?A9(x.dateNF):null;function ee(){var re=d.slice(_,N),q={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)q.t="z";else if(x.raw)q.t="s",q.v=re;else if(re.trim().length===0)q.t="s",q.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(q.t="s",q.v=re.slice(2,-1).replace(/""/g,'"')):Qz(re)?(q.t="n",q.f=re.slice(1)):(q.t="s",q.v=re);else if(re=="TRUE")q.t="b",q.v=!0;else if(re=="FALSE")q.t="b",q.v=!1;else if(!isNaN(F=gA(re)))q.t="n",x.cellText!==!1&&(q.w=re),q.v=F;else if(!isNaN(wl(re).getDate())||M&&re.match(M)){q.z=x.dateNF||vt[14];var se=0;M&&re.match(M)&&(re=s9(re,x.dateNF,re.match(M)||[]),se=1),x.cellDates?(q.t="d",q.v=Nr(re,se)):(q.t="n",q.v=mn(Nr(re,se))),x.cellText!==!1&&(q.w=tA(q.z,q.v instanceof Date?mn(q.v):q.v)),x.cellNF||delete q.z}else q.t="s",q.v=re;if(q.t=="z"||(x.dense?(C[T]||(C[T]=[]),C[T][S]=q):C[yt({c:S,r:T})]=q),_=N+1,G=d.charCodeAt(_),E.e.c<S&&(E.e.c=S),E.e.r<T&&(E.e.r=T),k==I)++S;else if(S=0,++T,x.sheetRows&&x.sheetRows<=T)return!0}e:for(;N<d.length;++N)switch(k=d.charCodeAt(N)){case 34:G===34&&(U=!U);break;case I:case 10:case 13:if(!U&&ee())break e;break}return N-_>0&&ee(),C["!ref"]=kt(E),C}function i(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,p):kl(t(d,p),p)}function l(d,p){var x="",y=p.type=="string"?[0,0,0,0]:fv(d,p);switch(p.type){case"base64":x=Fa(d);break;case"binary":x=d;break;case"buffer":p.codepage==65001?x=d.toString("utf8"):p.codepage&&typeof fu<"u"||(x=Dt&&Buffer.isBuffer(d)?d.toString("binary"):ui(d));break;case"array":x=$i(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?x=Br(x.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?x=Br(x):p.type=="binary"&&typeof fu<"u",x.slice(0,19)=="socialcalc:version:"?qb.to_sheet(p.type=="string"?x:Br(x),p):i(x,p)}function u(d,p){return fi(l(d,p),p)}function f(d){for(var p=[],x=$t(d["!ref"]),y,C=Array.isArray(d),E=x.s.r;E<=x.e.r;++E){for(var T=[],S=x.s.c;S<=x.e.c;++S){var F=yt({r:E,c:S});if(y=C?(d[E]||[])[S]:d[F],!y||y.v==null){T.push("          ");continue}for(var _=(y.w||(ds(y),y.w)||"").slice(0,10);_.length<10;)_+=" ";T.push(_+(S===0?" ":""))}p.push(T.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}})();function wK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Jb.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return yl.to_workbook(e,t)}}var Ji=(function(){function e(Q,K,P){if(Q){Nn(Q,Q.l||0);for(var z=P.Enum||Le;Q.l<Q.length;){var ce=Q.read_shift(2),Ce=z[ce]||z[65535],he=Q.read_shift(2),de=Q.l+he,ne=Ce.f&&Ce.f(Q,he,P);if(Q.l=de,K(ne,Ce,ce))return}}}function t(Q,K){switch(K.type){case"base64":return r(Sa(Fa(Q)),K);case"binary":return r(Sa(Q),K);case"buffer":case"array":return r(Q,K)}throw"Unsupported type "+K.type}function r(Q,K){if(!Q)return Q;var P=K||{},z=P.dense?[]:{},ce="Sheet1",Ce="",he=0,de={},ne=[],Ee=[],R={s:{r:0,c:0},e:{r:0,c:0}},Re=P.sheetRows||0;if(Q[2]==0&&(Q[3]==8||Q[3]==9)&&Q.length>=16&&Q[14]==5&&Q[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Q[2]==2)P.Enum=Le,e(Q,function(He,it,wt){switch(wt){case 0:P.vers=He,He>=4096&&(P.qpro=!0);break;case 6:R=He;break;case 204:He&&(Ce=He);break;case 222:Ce=He;break;case 15:case 51:P.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:wt==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=P.dateNF||vt[14],P.cellDates&&(He[1].t="d",He[1].v=qd(He[1].v))),P.qpro&&He[3]>he&&(z["!ref"]=kt(R),de[ce]=z,ne.push(ce),z=P.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},he=He[3],ce=Ce||"Sheet"+(he+1),Ce="");var nr=P.dense?(z[He[0].r]||[])[He[0].c]:z[yt(He[0])];if(nr){nr.t=He[1].t,nr.v=He[1].v,He[1].z!=null&&(nr.z=He[1].z),He[1].f!=null&&(nr.f=He[1].f);break}P.dense?(z[He[0].r]||(z[He[0].r]=[]),z[He[0].r][He[0].c]=He[1]):z[yt(He[0])]=He[1];break}},P);else if(Q[2]==26||Q[2]==14)P.Enum=Y,Q[2]==14&&(P.qpro=!0,Q.l=0),e(Q,function(He,it,wt){switch(wt){case 204:ce=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>he&&(z["!ref"]=kt(R),de[ce]=z,ne.push(ce),z=P.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},he=He[3],ce="Sheet"+(he+1)),Re>0&&He[0].r>=Re)break;P.dense?(z[He[0].r]||(z[He[0].r]=[]),z[He[0].r][He[0].c]=He[1]):z[yt(He[0])]=He[1],R.e.c<He[0].c&&(R.e.c=He[0].c),R.e.r<He[0].r&&(R.e.r=He[0].r);break;case 27:He[14e3]&&(Ee[He[14e3][0]]=He[14e3][1]);break;case 1537:Ee[He[0]]=He[1],He[0]==he&&(ce=He[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+Q[2]);if(z["!ref"]=kt(R),de[Ce||ce]=z,ne.push(Ce||ce),!Ee.length)return{SheetNames:ne,Sheets:de};for(var Ge={},Ze=[],st=0;st<Ee.length;++st)de[ne[st]]?(Ze.push(Ee[st]||ne[st]),Ge[Ee[st]]=de[Ee[st]]||de[ne[st]]):(Ze.push(Ee[st]),Ge[Ee[st]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:Ge}}function n(Q,K){var P=K||{};if(+P.codepage>=0&&uA(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var z=fa(),ce=$t(Q["!ref"]),Ce=Array.isArray(Q),he=[];je(z,0,s(1030)),je(z,6,u(ce));for(var de=Math.min(ce.e.r,8191),ne=ce.s.r;ne<=de;++ne)for(var Ee=Zr(ne),R=ce.s.c;R<=ce.e.c;++R){ne===ce.s.r&&(he[R]=Hr(R));var Re=he[R]+Ee,Ge=Ce?(Q[ne]||[])[R]:Q[Re];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?je(z,13,y(ne,R,Ge.v)):je(z,14,E(ne,R,Ge.v));else{var Ze=ds(Ge);je(z,15,p(ne,R,Ze.slice(0,239)))}}return je(z,1),z.end()}function a(Q,K){var P=K||{};if(+P.codepage>=0&&uA(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var z=fa();je(z,0,i(Q));for(var ce=0,Ce=0;ce<Q.SheetNames.length;++ce)(Q.Sheets[Q.SheetNames[ce]]||{})["!ref"]&&je(z,27,ae(Q.SheetNames[ce],Ce++));var he=0;for(ce=0;ce<Q.SheetNames.length;++ce){var de=Q.Sheets[Q.SheetNames[ce]];if(!(!de||!de["!ref"])){for(var ne=$t(de["!ref"]),Ee=Array.isArray(de),R=[],Re=Math.min(ne.e.r,8191),Ge=ne.s.r;Ge<=Re;++Ge)for(var Ze=Zr(Ge),st=ne.s.c;st<=ne.e.c;++st){Ge===ne.s.r&&(R[st]=Hr(st));var He=R[st]+Ze,it=Ee?(de[Ge]||[])[st]:de[He];if(!(!it||it.t=="z"))if(it.t=="n")je(z,23,ee(Ge,st,he,it.v));else{var wt=ds(it);je(z,22,k(Ge,st,he,wt.slice(0,239)))}}++he}}return je(z,1),z.end()}function s(Q){var K=be(2);return K.write_shift(2,Q),K}function i(Q){var K=be(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var P=0,z=0,ce=0,Ce=0;Ce<Q.SheetNames.length;++Ce){var he=Q.SheetNames[Ce],de=Q.Sheets[he];if(!(!de||!de["!ref"])){++ce;var ne=da(de["!ref"]);P<ne.e.r&&(P=ne.e.r),z<ne.e.c&&(z=ne.e.c)}}return P>8191&&(P=8191),K.write_shift(2,P),K.write_shift(1,ce),K.write_shift(1,z),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function l(Q,K,P){var z={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&P.qpro?(z.s.c=Q.read_shift(1),Q.l++,z.s.r=Q.read_shift(2),z.e.c=Q.read_shift(1),Q.l++,z.e.r=Q.read_shift(2),z):(z.s.c=Q.read_shift(2),z.s.r=Q.read_shift(2),K==12&&P.qpro&&(Q.l+=2),z.e.c=Q.read_shift(2),z.e.r=Q.read_shift(2),K==12&&P.qpro&&(Q.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function u(Q){var K=be(8);return K.write_shift(2,Q.s.c),K.write_shift(2,Q.s.r),K.write_shift(2,Q.e.c),K.write_shift(2,Q.e.r),K}function f(Q,K,P){var z=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(z[0].c=Q.read_shift(1),z[3]=Q.read_shift(1),z[0].r=Q.read_shift(2),Q.l+=2):(z[2]=Q.read_shift(1),z[0].c=Q.read_shift(2),z[0].r=Q.read_shift(2)),z}function d(Q,K,P){var z=Q.l+K,ce=f(Q,K,P);if(ce[1].t="s",P.vers==20768){Q.l++;var Ce=Q.read_shift(1);return ce[1].v=Q.read_shift(Ce,"utf8"),ce}return P.qpro&&Q.l++,ce[1].v=Q.read_shift(z-Q.l,"cstr"),ce}function p(Q,K,P){var z=be(7+P.length);z.write_shift(1,255),z.write_shift(2,K),z.write_shift(2,Q),z.write_shift(1,39);for(var ce=0;ce<z.length;++ce){var Ce=P.charCodeAt(ce);z.write_shift(1,Ce>=128?95:Ce)}return z.write_shift(1,0),z}function x(Q,K,P){var z=f(Q,K,P);return z[1].v=Q.read_shift(2,"i"),z}function y(Q,K,P){var z=be(7);return z.write_shift(1,255),z.write_shift(2,K),z.write_shift(2,Q),z.write_shift(2,P,"i"),z}function C(Q,K,P){var z=f(Q,K,P);return z[1].v=Q.read_shift(8,"f"),z}function E(Q,K,P){var z=be(13);return z.write_shift(1,255),z.write_shift(2,K),z.write_shift(2,Q),z.write_shift(8,P,"f"),z}function T(Q,K,P){var z=Q.l+K,ce=f(Q,K,P);if(ce[1].v=Q.read_shift(8,"f"),P.qpro)Q.l=z;else{var Ce=Q.read_shift(2);N(Q.slice(Q.l,Q.l+Ce),ce),Q.l+=Ce}return ce}function S(Q,K,P){var z=K&32768;return K&=-32769,K=(z?Q:0)+(K>=8192?K-16384:K),(z?"":"$")+(P?Hr(K):Zr(K))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(Q,K){Nn(Q,0);for(var P=[],z=0,ce="",Ce="",he="",de="";Q.l<Q.length;){var ne=Q[Q.l++];switch(ne){case 0:P.push(Q.read_shift(8,"f"));break;case 1:Ce=S(K[0].c,Q.read_shift(2),!0),ce=S(K[0].r,Q.read_shift(2),!1),P.push(Ce+ce);break;case 2:{var Ee=S(K[0].c,Q.read_shift(2),!0),R=S(K[0].r,Q.read_shift(2),!1);Ce=S(K[0].c,Q.read_shift(2),!0),ce=S(K[0].r,Q.read_shift(2),!1),P.push(Ee+R+":"+Ce+ce)}break;case 3:if(Q.l<Q.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(Q.read_shift(2));break;case 6:{for(var Re="";ne=Q[Q.l++];)Re+=String.fromCharCode(ne);P.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:de=P.pop(),he=P.pop(),P.push(["AND","OR"][ne-20]+"("+he+","+de+")");break;default:if(ne<32&&_[ne])de=P.pop(),he=P.pop(),P.push(he+_[ne]+de);else if(F[ne]){if(z=F[ne][1],z==69&&(z=Q[Q.l++]),z>P.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+P.join("|")+"|");return}var Ge=P.slice(-z);P.length-=z,P.push(F[ne][0]+"("+Ge.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}P.length==1?K[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function I(Q){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=Q.read_shift(2),K[3]=Q[Q.l++],K[0].c=Q[Q.l++],K}function U(Q,K){var P=I(Q);return P[1].t="s",P[1].v=Q.read_shift(K-4,"cstr"),P}function k(Q,K,P,z){var ce=be(6+z.length);ce.write_shift(2,Q),ce.write_shift(1,P),ce.write_shift(1,K),ce.write_shift(1,39);for(var Ce=0;Ce<z.length;++Ce){var he=z.charCodeAt(Ce);ce.write_shift(1,he>=128?95:he)}return ce.write_shift(1,0),ce}function G(Q,K){var P=I(Q);P[1].v=Q.read_shift(2);var z=P[1].v>>1;if(P[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return P[1].v=z,P}function M(Q,K){var P=I(Q),z=Q.read_shift(4),ce=Q.read_shift(4),Ce=Q.read_shift(2);if(Ce==65535)return z===0&&ce===3221225472?(P[1].t="e",P[1].v=15):z===0&&ce===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var he=Ce&32768;return Ce=(Ce&32767)-16446,P[1].v=(1-he*2)*(ce*Math.pow(2,Ce+32)+z*Math.pow(2,Ce)),P}function ee(Q,K,P,z){var ce=be(14);if(ce.write_shift(2,Q),ce.write_shift(1,P),ce.write_shift(1,K),z==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Ce=0,he=0,de=0,ne=0;return z<0&&(Ce=1,z=-z),he=Math.log2(z)|0,z/=Math.pow(2,he-31),ne=z>>>0,(ne&2147483648)==0&&(z/=2,++he,ne=z>>>0),z-=ne,ne|=2147483648,ne>>>=0,z*=Math.pow(2,32),de=z>>>0,ce.write_shift(4,de),ce.write_shift(4,ne),he+=16383+(Ce?32768:0),ce.write_shift(2,he),ce}function re(Q,K){var P=M(Q);return Q.l+=K-14,P}function q(Q,K){var P=I(Q),z=Q.read_shift(4);return P[1].v=z>>6,P}function se(Q,K){var P=I(Q),z=Q.read_shift(8,"f");return P[1].v=z,P}function Te(Q,K){var P=se(Q);return Q.l+=K-10,P}function Be(Q,K){return Q[Q.l+K-1]==0?Q.read_shift(K,"cstr"):""}function Z(Q,K){var P=Q[Q.l++];P>K-1&&(P=K-1);for(var z="";z.length<P;)z+=String.fromCharCode(Q[Q.l++]);return z}function ie(Q,K,P){if(!(!P.qpro||K<21)){var z=Q.read_shift(1);Q.l+=17,Q.l+=1,Q.l+=2;var ce=Q.read_shift(K-21,"cstr");return[z,ce]}}function Qe(Q,K){for(var P={},z=Q.l+K;Q.l<z;){var ce=Q.read_shift(2);if(ce==14e3){for(P[ce]=[0,""],P[ce][0]=Q.read_shift(2);Q[Q.l];)P[ce][1]+=String.fromCharCode(Q[Q.l]),Q.l++;Q.l++}}return P}function ae(Q,K){var P=be(5+Q.length);P.write_shift(2,14e3),P.write_shift(2,K);for(var z=0;z<Q.length;++z){var ce=Q.charCodeAt(z);P[P.l++]=ce>127?95:ce}return P[P.l++]=0,P}var Le={0:{n:"BOF",f:on},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:C},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Be},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Qe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Be},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function yK(e){var t={},r=e.match(Xn),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ct(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Fx[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var BK=(function(){var e=gu("t"),t=gu("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:qt(i[1])},u=s.match(t);return u&&(l.s=yK(u[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(l){return l.v})}})(),CK=(function(){var t=/(\r\n|\n)/g;function r(a,s,i){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),i.push("</"+u+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),EK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,TK=/<(?:\w+:)?r>/,SK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=qt(Br(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Br(e),r&&(n.h=Hx(n.t))):e.match(TK)&&(n.r=Br(e),n.t=qt(Br((e.replace(SK,"").match(EK)||[]).join("").replace(Xn,""))),r&&(n.h=CK(BK(n.r)))),n):{t:""}}var _K=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bK=/<(?:\w+:)?(?:si|sstItem)>/g,FK=/<\/(?:\w+:)?(?:si|sstItem)>/;function UK(e,t){var r=[],n="";if(!e)return r;var a=e.match(_K);if(a){n=a[2].replace(bK,"").split(FK);for(var s=0;s!=n.length;++s){var i=Zx(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ct(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var kK=/^\s|\s$|[\t\n\r]/;function $b(e,t){if(!t.bookSST)return"";var r=[en];r[r.length]=Ke("sst",null,{xmlns:Ao[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(kK)&&(s+=' xml:space="preserve"'),s+=">"+mr(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function NK(e){return[e.read_shift(4),e.read_shift(4)]}function IK(e,t){var r=[],n=!1;return ps(e,function(s,i,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function QK(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var RK=j9;function DK(e){var t=fa();De(t,159,QK(e));for(var r=0;r<e.length;++r)De(t,19,RK(e[r]));return De(t,160),t.end()}function Zb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ls(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function MK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ls(e,4),t.U=ls(e,4),t.W=ls(e,4),t}function LK(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function HK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(LK(e));return t}function OK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function PK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ls(e,4),t.U=ls(e,4),t.W=ls(e,4),t}function GK(e){var t=PK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function e4(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function t4(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function VK(e){var t=ls(e);switch(t.Minor){case 2:return[t.Minor,KK(e)];case 3:return[t.Minor,jK()];case 4:return[t.Minor,zK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function KK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=e4(e,r),a=t4(e,e.length-e.l);return{t:"Std",h:n,v:a}}function jK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Xn,function(s){var i=Ct(s);switch(RA(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=i[l]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function XK(e,t){var r={},n=r.EncryptionVersionInfo=ls(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=e4(e,a),t-=a,r.EncryptionVerifier=t4(e,t),r}function WK(e){var t={},r=t.EncryptionVersionInfo=ls(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ev(e){var t=0,r,n=Zb(e),a=n.length+1,s,i,l,u,f;for(r=ai(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],l=(t&16384)===0?0:1,u=t<<1&32767,f=l|u,t=f^i;return t^52811}var r4=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,l){return n(i^l)},s=function(i){for(var l=t[i.length-1],u=104,f=i.length-1;f>=0;--f)for(var d=i[f],p=0;p!=7;++p)d&64&&(l^=r[u]),d*=2,--u;return l};return function(i){for(var l=Zb(i),u=s(l),f=l.length,d=ai(16),p=0;p!=16;++p)d[p]=0;var x,y,C;for((f&1)===1&&(x=u>>8,d[f]=a(e[0],x),--f,x=u&255,y=l[l.length-1],d[f]=a(y,x));f>0;)--f,x=u>>8,d[f]=a(l[f],x),--f,x=u&255,d[f]=a(l[f],x);for(f=15,C=15-l.length;C>0;)x=u>>8,d[f]=a(e[C],x),--f,--C,x=u&255,d[f]=a(l[f],x),--f,--C;return d}})(),JK=function(e,t,r,n,a){a||(a=t),n||(n=r4(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},YK=function(e){var t=0,r=r4(e);return function(n){var a=JK("",n,t,r);return t=a[1],a[0]}};function qK(e,t,r,n){var a={key:on(e),verificationBytes:on(e)};return r.password&&(a.verifier=ev(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=YK(r.password)),a}function $K(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=WK(e):n.Data=XK(e,t),n}function ZK(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?$K(e,t-2,n):qK(e,r.biff>=8?t:t-2,r,n),n}var n4=(function(){function e(a,s){switch(s.type){case"base64":return t(Fa(a),s);case"binary":return t(a,s);case"buffer":return t(Dt&&Buffer.isBuffer(a)?a.toString("binary"):ui(a),s);case"array":return t($i(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},l=i.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,p){Array.isArray(l)&&(l[p]=[]);for(var x=/\\\w+\b/g,y=0,C,E=-1;C=x.exec(d);){switch(C[0]){case"\\cell":var T=d.slice(y,x.lastIndex-C[0].length);if(T[0]==" "&&(T=T.slice(1)),++E,T.length){var S={v:T,t:"s"};Array.isArray(l)?l[p][E]=S:l[yt({r:p,c:E})]=S}break}y=x.lastIndex}E>f.e.c&&(f.e.c=E)}),l["!ref"]=kt(f),l}function r(a,s){return fi(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=$t(a["!ref"]),l,u=Array.isArray(a),f=i.s.r;f<=i.e.r;++f){s.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var p=yt({r:f,c:d});l=u?(a[f]||[])[d]:a[p],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(ds(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function ej(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function vu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function tj(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var l=0,u=0,f=a+s;switch(u=i/(f>1?2-f:f),a){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4;break}return[l/6,u,f/2]}function rj(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=a*l,i[0]+=a,i[1]+=u;break;case 1:u=a*(2-l),i[0]+=u,i[1]+=a;break;case 2:u=a*(l-2),i[1]+=a,i[2]+=u;break;case 3:u=a*(4-l),i[1]+=u,i[2]+=a;break;case 4:u=a*(l-4),i[2]+=a,i[0]+=u;break;case 5:u=a*(6-l),i[2]+=u,i[0]+=a;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function Td(e,t){if(t===0)return e;var r=tj(ej(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),vu(rj(r))}var a4=6,nj=15,aj=1,Vn=a4;function wu(e){return Math.floor((e+Math.round(128/Vn)/256)*Vn)}function yu(e){return Math.floor((e-5)/Vn*100+.5)/100}function Sd(e){return Math.round((e*Vn+5)/Vn*256)/256}function Vm(e){return Sd(yu(wu(e)))}function tv(e){var t=Math.abs(e-Vm(e)),r=Vn;if(t>.005)for(Vn=aj;Vn<nj;++Vn)Math.abs(e-Vm(e))<=t&&(t=Math.abs(e-Vm(e)),r=Vn);Vn=r}function Ai(e){e.width?(e.wpx=wu(e.width),e.wch=yu(e.wpx),e.MDW=Vn):e.wpx?(e.wch=yu(e.wpx),e.width=Sd(e.wch),e.MDW=Vn):typeof e.wch=="number"&&(e.width=Sd(e.wch),e.wpx=wu(e.width),e.MDW=Vn),e.customWidth&&delete e.customWidth}var Aj=96,A4=Aj;function Bu(e){return e*96/A4}function Bl(e){return e*A4/96}var sj={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ij(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Xn)||[]).forEach(function(i){var l=Ct(i);switch(RA(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=kr(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=kr(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function oj(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Xn)||[]).forEach(function(i){var l=Ct(i);switch(RA(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function lj(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Xn)||[]).forEach(function(i){var l=Ct(i);switch(RA(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Br(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?kr(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?kr(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?kr(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?kr(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?kr(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?kr(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?kr(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Fx[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=kr(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var u=Xi[a.color.index];a.color.index==81&&(u=Xi[1]),u||(u=Xi[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Td(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function cj(e,t,r){t.NumberFmt=[];for(var n=jr(vt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=vt[n[a]];var s=e[0].match(Xn);if(s)for(a=0;a<s.length;++a){var i=Ct(s[a]);switch(RA(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=qt(Br(i.formatCode)),u=parseInt(i.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}os(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function uj(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ke("numFmt",null,{numFmtId:n,formatCode:mr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Nf=["numFmtId","fillId","fontId","borderId","xfId"],If=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function fj(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Xn)||[]).forEach(function(s){var i=Ct(s),l=0;switch(RA(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],l=0;l<Nf.length;++l)n[Nf[l]]&&(n[Nf[l]]=parseInt(n[Nf[l]],10));for(l=0;l<If.length;++l)n[If[l]]&&(n[If[l]]=kr(n[If[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};i.vertical&&(u.vertical=i.vertical),i.horizontal&&(u.horizontal=i.horizontal),i.textRotation!=null&&(u.textRotation=i.textRotation),i.indent&&(u.indent=i.indent),i.wrapText&&(u.wrapText=kr(i.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function dj(e){var t=[];return t[t.length]=Ke("cellXfs",null),e.forEach(function(r){t[t.length]=Ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var hj=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(t))&&cj(p,d,f),(p=l.match(a))&&lj(p,d,u,f),(p=l.match(n))&&oj(p,d,u,f),(p=l.match(s))&&ij(p,d,u,f),(p=l.match(r))&&fj(p,d,f),d}})();function s4(e,t){var r=[en,Ke("styleSheet",null,{xmlns:Ao[0],"xmlns:vt":gn.vt})],n;return e.SSF&&(n=uj(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=dj(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gj(e,t){var r=e.read_shift(2),n=jn(e);return[r,n]}function mj(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),En(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function pj(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=$9(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=q9(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jn(e),n}function xj(e,t){t||(t=be(153)),t.write_shift(2,e.sz*20),Z9(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Bd(e.color,t);var n=0;return n=2,t.write_shift(1,n),En(e.name,t),t.length>t.l?t.slice(0,t.l):t}var vj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Km,wj=zn;function O2(e,t){t||(t=be(84)),Km||(Km=Jd(vj));var r=Km[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Bd({auto:1},t),Bd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function yj(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function i4(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Uc(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Bj=zn;function Cj(e,t){return t||(t=be(51)),t.write_shift(1,0),Uc(null,t),Uc(null,t),Uc(null,t),Uc(null,t),Uc(null,t),t.length>t.l?t.slice(0,t.l):t}function Ej(e,t){return t||(t=be(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),yd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Tj(e,t,r){var n=be(2052);return n.write_shift(4,e),yd(t,n),yd(r,n),n.length>n.l?n.slice(0,n.l):n}function Sj(e,t,r){var n={};n.NumberFmt=[];for(var a in vt)n.NumberFmt[a]=vt[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return ps(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],os(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Td(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(d),i=!0;break;case 38:s.pop(),i=!1;break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function _j(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(De(e,615,mA(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&De(e,44,mj(a,t[a]))}),De(e,616))}}function bj(e){var t=1;De(e,611,mA(t)),De(e,43,xj({sz:12,color:{theme:1},name:"Calibri",family:2})),De(e,612)}function Fj(e){var t=2;De(e,603,mA(t)),De(e,45,O2({patternType:"none"})),De(e,45,O2({patternType:"gray125"})),De(e,604)}function Uj(e){var t=1;De(e,613,mA(t)),De(e,46,Cj()),De(e,614)}function kj(e){var t=1;De(e,626,mA(t)),De(e,47,i4({numFmtId:0},65535)),De(e,627)}function Nj(e,t){De(e,617,mA(t.length)),t.forEach(function(r){De(e,47,i4(r,0))}),De(e,618)}function Ij(e){var t=1;De(e,619,mA(t)),De(e,48,Ej({xfId:0,name:"Normal"})),De(e,620)}function Qj(e){var t=0;De(e,505,mA(t)),De(e,506)}function Rj(e){var t=0;De(e,508,Tj(t,"TableStyleMedium9","PivotStyleMedium4")),De(e,509)}function Dj(e,t){var r=fa();return De(r,278),_j(r,e.SSF),bj(r),Fj(r),Uj(r),kj(r),Nj(r,t.cellXfs),Ij(r),Qj(r),Rj(r),De(r,279),r.end()}var Mj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Lj(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Xn)||[]).forEach(function(a){var s=Ct(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[Mj.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Hj(){}function Oj(){}var Pj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Gj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Vj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Kj(e,t,r){t.themeElements={};var n;[["clrScheme",Pj,Lj],["fontScheme",Gj,Hj],["fmtScheme",Vj,Oj]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var jj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function o4(e,t){(!e||e.length===0)&&(e=rv());var r,n={};if(!(r=e.match(jj)))throw new Error("themeElements not found in theme");return Kj(r[0],n,t),n.raw=e,n}function rv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[en];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function zj(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=eb(s,{type:"array"})}catch{return}var l=_a(i,"theme/theme/theme1.xml",!0);if(l)return o4(l,r)}}function Xj(e){return e.read_shift(4)}function Wj(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Jj(e,4);break;case 2:t.xclrValue=Pb(e);break;case 3:t.xclrValue=Xj(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Jj(e,t){return zn(e,t)}function Yj(e,t){return zn(e,t)}function qj(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Wj(e);break;case 6:n[1]=Yj(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function $j(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(qj(e,r-e.l));return{ixfe:n,ext:s}}function Zj(e,t){t.forEach(function(r){r[0]})}function ez(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jn(e)}}function tz(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),En(e.name,t),t.slice(0,t.l)}function rz(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function nz(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function az(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),En(t,r),r.slice(0,r.l)}function Az(e){return e.l+=4,e.read_shift(4)!=0}function sz(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function iz(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,l=2;return ps(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){l==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):l==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:s.push(d),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!f.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function oz(){var e=fa();return De(e,332),De(e,334,mA(1)),De(e,335,tz({name:"XLDAPR",version:12e4,flags:3496657072})),De(e,336),De(e,339,az(1,"XLDAPR")),De(e,52),De(e,35,mA(514)),De(e,4096,mA(0)),De(e,4097,Wa(1)),De(e,36),De(e,53),De(e,340),De(e,337,sz(1)),De(e,51,nz([[1,0]])),De(e,338),De(e,333),e.end()}function lz(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Xn,function(l){var u=Ct(l);switch(RA(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(i=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function l4(){var e=[en];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function cz(e){var t=[];if(!e)return t;var r=1;return(e.match(Xn)||[]).forEach(function(n){var a=Ct(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function uz(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=yt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function fz(e,t,r){var n=[];return ps(e,function(s,i,l){switch(l){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function dz(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ps(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function hz(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ul=1024;function c4(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ke("xml",null,{"xmlns:v":Ea.v,"xmlns:o":Ea.o,"xmlns:x":Ea.x,"xmlns:mv":Ea.mv}).replace(/\/>/,">"),Ke("o:shapelayout",Ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ke("v:shapetype",[Ke("v:stroke",null,{joinstyle:"miter"}),Ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ul<e*1e3;)ul+=1e3;return t.forEach(function(s){var i=Or(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var u=l.type=="gradient"?Ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ke("v:fill",u,l),d={on:"t",obscured:"t"};++ul,a=a.concat(["<v:shape"+mu({id:"_x0000_s"+ul,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ke("v:shadow",null,d),Ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",In("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),In("x:AutoFill","False"),In("x:Row",String(i.r)),In("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function P2(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var l=Or(i.ref);if(a?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[i.ref],!s){s={t:"z"},a?e[l.r][l.c]=s:e[i.ref]=s;var u=$t(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=kt(u);f!==e["!ref"]&&(e["!ref"]=f)}s.c||(s.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(d.a==n[p].id){d.a=n[p].name||d.a;break}}s.c.push(d)})}function gz(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Ct(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Or(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!p&&!!p[1]&&Zx(p[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),n.push(f)}}}}),n}function u4(e){var t=[en,Ke("comments",null,{xmlns:Ao[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=mr(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(a=r.indexOf(mr(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(In("t",mr(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)i+=`Reply:
    `+s[l]+`
`;t.push(In("t",mr(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function mz(e,t){var r=[],n=!1,a={},s=0;return e.replace(Xn,function(l,u){var f=Ct(l);switch(RA(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=u+l.length;break;case"</text>":a.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function pz(e,t,r){var n=[en,Ke("ThreadedComments",null,{xmlns:gn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var u={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=u.id:u.parentId=s,i.ID=u.id,i.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Ke("threadedComment",In("text",i.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function xz(e,t){var r=[],n=!1;return e.replace(Xn,function(s){var i=Ct(s);switch(RA(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function vz(e){var t=[en,Ke("personList",null,{xmlns:gn.TCMNT,"xmlns:x":Ao[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function wz(e){var t={};t.iauthor=e.read_shift(4);var r=lo(e);return t.rfx=r.s,t.ref=yt(r.s),e.l+=16,t}function yz(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),Nl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Bz=jn;function Cz(e){return En(e.slice(0,54))}function Ez(e,t){var r=[],n=[],a={},s=!1;return ps(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function Tz(e){var t=fa(),r=[];return De(t,628),De(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),De(t,632,Cz(a.a)))})}),De(t,631),De(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Or(n[0]),e:Or(n[0])};De(t,635,yz([s,a])),a.t&&a.t.length>0&&De(t,637,X9(a)),De(t,636),delete a.iauthor})}),De(t,634),De(t,629),t.end()}var Sz="application/vnd.ms-office.vbaProject";function _z(e){var t=gt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");gt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),gt.write(t)}function bz(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&gt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var f4=["xlsb","xlsm","xlam","biff8","xla"];function Fz(){return{"!type":"dialog"}}function Uz(){return{"!type":"dialog"}}function kz(){return{"!type":"macro"}}function Nz(){return{"!type":"macro"}}var pl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,a+(l?"":"$")+Hr(d)+(u?"":"$")+Zr(f)}return function(a,s){return t=s,a.replace(e,r)}})(),nv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,av=(function(){return function(t,r){return t.replace(nv,function(n,a,s,i,l,u){var f=Kx(i)-(s?0:r.c),d=Vx(u)-(l?0:r.r),p=d==0?"":l?d+1:"["+d+"]",x=f==0?"":s?f+1:"["+f+"]";return a+"R"+p+"C"+x})}})();function d4(e,t){return e.replace(nv,function(r,n,a,s,i,l){return n+(a=="$"?a+s:Hr(Kx(s)+t.c))+(i=="$"?i+l:Zr(Vx(l)+t.r))})}function Iz(e,t,r){var n=da(t),a=n.s,s=Or(r),i={r:s.r-a.r,c:s.c-a.c};return d4(e,i)}function Qz(e){return e.length!=1}function G2(e){return e.replace(/_xlfn\./g,"")}function An(e){e.l+=1}function si(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function h4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return g4(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=si(e),l=si(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function g4(e){var t=si(e),r=si(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Rz(e,t,r){if(r.biff<8)return g4(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=si(e),i=si(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function m4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Dz(e);var n=e.read_shift(r&&r.biff==12?4:2),a=si(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Dz(e){var t=si(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Mz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Lz(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Hz(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:l}}function Hz(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Oz(e,t,r){var n=(e[e.l++]&96)>>5,a=h4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Pz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=h4(e,s,r);return[n,a,i]}function Gz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Vz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Kz(e,t,r){var n=(e[e.l++]&96)>>5,a=Rz(e,t-1,r);return[n,a]}function jz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function V2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function zz(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Xz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Wz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Jz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Yz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function p4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function qz(e){return e.read_shift(2),p4(e)}function $z(e){return e.read_shift(2),p4(e)}function Zz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=m4(e,0,r);return[n,a]}function eX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Lz(e,0,r);return[n,a]}function tX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=m4(e,0,r);return[n,a,s]}function rX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[AW[a],w4[a],n]}function nX(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:aX(e);return[a,(s[0]===0?w4:aW)[s[1]]]}function aX(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function AX(e,t,r){e.l+=r&&r.biff==2?3:4}function sX(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function iX(e){return e.l++,xs[e.read_shift(1)]}function oX(e){return e.l++,e.read_shift(2)}function lX(e){return e.l++,e.read_shift(1)!==0}function cX(e){return e.l++,Kn(e)}function uX(e,t,r){return e.l++,Qu(e,t-1,r)}function fX(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=qr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Kn(e);break;case 2:r[1]=co(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function dX(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?lo:$d)(e));return a}function hX(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var l=0;l!=a;++l)i[s][l]=fX(e,r.biff);return i}function gX(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function mX(e,t,r){if(r.biff==5)return pX(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function pX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function xX(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function vX(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function wX(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function yX(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var BX=zn,CX=zn,EX=zn;function Du(e,t,r){return e.l+=2,[Mz(e)]}function Av(e){return e.l+=6,[]}var TX=Du,SX=Av,_X=Av,bX=Du;function x4(e){return e.l+=2,[on(e),e.read_shift(2)&1]}var FX=Du,UX=x4,kX=Av,NX=Du,IX=Du,QX=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=QX[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function DX(e){return e.l+=2,[e.read_shift(4)]}function MX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function LX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function HX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function OX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function PX(e){return e.l+=4,[0,0]}var K2={1:{n:"PtgExp",f:sX},2:{n:"PtgTbl",f:EX},3:{n:"PtgAdd",f:An},4:{n:"PtgSub",f:An},5:{n:"PtgMul",f:An},6:{n:"PtgDiv",f:An},7:{n:"PtgPower",f:An},8:{n:"PtgConcat",f:An},9:{n:"PtgLt",f:An},10:{n:"PtgLe",f:An},11:{n:"PtgEq",f:An},12:{n:"PtgGe",f:An},13:{n:"PtgGt",f:An},14:{n:"PtgNe",f:An},15:{n:"PtgIsect",f:An},16:{n:"PtgUnion",f:An},17:{n:"PtgRange",f:An},18:{n:"PtgUplus",f:An},19:{n:"PtgUminus",f:An},20:{n:"PtgPercent",f:An},21:{n:"PtgParen",f:An},22:{n:"PtgMissArg",f:An},23:{n:"PtgStr",f:uX},26:{n:"PtgSheet",f:MX},27:{n:"PtgEndSheet",f:LX},28:{n:"PtgErr",f:iX},29:{n:"PtgBool",f:lX},30:{n:"PtgInt",f:oX},31:{n:"PtgNum",f:cX},32:{n:"PtgArray",f:jz},33:{n:"PtgFunc",f:rX},34:{n:"PtgFuncVar",f:nX},35:{n:"PtgName",f:gX},36:{n:"PtgRef",f:Zz},37:{n:"PtgArea",f:Oz},38:{n:"PtgMemArea",f:xX},39:{n:"PtgMemErr",f:BX},40:{n:"PtgMemNoMem",f:CX},41:{n:"PtgMemFunc",f:vX},42:{n:"PtgRefErr",f:wX},43:{n:"PtgAreaErr",f:Gz},44:{n:"PtgRefN",f:eX},45:{n:"PtgAreaN",f:Kz},46:{n:"PtgMemAreaN",f:HX},47:{n:"PtgMemNoMemN",f:OX},57:{n:"PtgNameX",f:mX},58:{n:"PtgRef3d",f:tX},59:{n:"PtgArea3d",f:Pz},60:{n:"PtgRefErr3d",f:yX},61:{n:"PtgAreaErr3d",f:Vz},255:{}},GX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},VX={1:{n:"PtgElfLel",f:x4},2:{n:"PtgElfRw",f:NX},3:{n:"PtgElfCol",f:TX},6:{n:"PtgElfRwV",f:IX},7:{n:"PtgElfColV",f:bX},10:{n:"PtgElfRadical",f:FX},11:{n:"PtgElfRadicalS",f:kX},13:{n:"PtgElfColS",f:SX},15:{n:"PtgElfColSV",f:_X},16:{n:"PtgElfRadicalLel",f:UX},25:{n:"PtgList",f:RX},29:{n:"PtgSxName",f:DX},255:{}},KX={0:{n:"PtgAttrNoop",f:PX},1:{n:"PtgAttrSemi",f:Yz},2:{n:"PtgAttrIf",f:Wz},4:{n:"PtgAttrChoose",f:zz},8:{n:"PtgAttrGoto",f:Xz},16:{n:"PtgAttrSum",f:AX},32:{n:"PtgAttrBaxcel",f:V2},33:{n:"PtgAttrBaxcel",f:V2},64:{n:"PtgAttrSpace",f:qz},65:{n:"PtgAttrSpaceSemi",f:$z},128:{n:"PtgAttrIfError",f:Jz},255:{}};function Mu(e,t,r,n){if(n.biff<8)return zn(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=hX(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=dX(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(zn(e,t)),s}function Lu(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=K2[s]||K2[GX[s]],(s===24||s===25)&&(a=(s===24?VX:KX)[e[e.l+1]]),!a||!a.f?zn(e,t):i.push([a.n,a.f(e,t,r)]);return i}function jX(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var zX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function v4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function j2(e,t,r){var n=v4(e,t,r);return n=="#REF"?n:XX(n,r)}function Gn(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},l=[],u,f,d,p=0,x=0,y,C="";if(!e[0]||!e[0][0])return"";for(var E=-1,T="",S=0,F=e[0].length;S<F;++S){var _=e[0][S];switch(_[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),E>=0){switch(e[0][E][1][0]){case 0:T=Vr(" ",e[0][E][1][1]);break;case 1:T=Vr("\r",e[0][E][1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}f=f+T,E=-1}l.push(f+zX[_[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=$c(_[1][1],i,a),l.push(Zc(d,s));break;case"PtgRefN":d=r?$c(_[1][1],r,a):_[1][1],l.push(Zc(d,s));break;case"PtgRef3d":p=_[1][1],d=$c(_[1][2],i,a),C=j2(n,p,a),l.push(C+"!"+Zc(d,s));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],I=_[1][1];N||(N=0),N&=127;var U=N==0?[]:l.slice(-N);l.length-=N,I==="User"&&(I=U.shift()),l.push(I+"("+U.join(",")+")");break;case"PtgBool":l.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(_[1]);break;case"PtgNum":l.push(String(_[1]));break;case"PtgStr":l.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(_[1]);break;case"PtgAreaN":y=w2(_[1][1],r?{s:r}:i,a),l.push(Om(y,a));break;case"PtgArea":y=w2(_[1][1],i,a),l.push(Om(y,a));break;case"PtgArea3d":p=_[1][1],y=_[1][2],C=j2(n,p,a),l.push(C+"!"+Om(y,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=_[1][2];var k=(n.names||[])[x-1]||(n[0]||[])[x],G=k?k.Name:"SH33TJSNAME"+String(x);G&&G.slice(0,6)=="_xlfn."&&!a.xlfn&&(G=G.slice(6)),l.push(G);break;case"PtgNameX":var M=_[1][1];x=_[1][2];var ee;if(a.biff<=5)M<0&&(M=-M),n[M]&&(ee=n[M][x]);else{var re="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][x]&&n[M][x].itab>0&&(re=n.SheetNames[n[M][x].itab-1]+"!"):re=n.SheetNames[x-1]+"!"),n[M]&&n[M][x])re+=n[M][x].Name;else if(n[0]&&n[0][x])re+=n[0][x].Name;else{var q=(v4(n,M,a)||"").split(";;");q[x-1]?re=q[x-1]:re+="SH33TJSERRX"}l.push(re);break}ee||(ee={Name:"SH33TJSERRY"}),l.push(ee.Name);break;case"PtgParen":var se="(",Te=")";if(E>=0){switch(T="",e[0][E][1][0]){case 2:se=Vr(" ",e[0][E][1][1])+se;break;case 3:se=Vr("\r",e[0][E][1][1])+se;break;case 4:Te=Vr(" ",e[0][E][1][1])+Te;break;case 5:Te=Vr("\r",e[0][E][1][1])+Te;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}E=-1}l.push(se+l.pop()+Te);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var Be={c:r.c,r:r.r};if(n.sharedf[yt(d)]){var Z=n.sharedf[yt(d)];l.push(Gn(Z,i,Be,n,a))}else{var ie=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(Gn(f[1],i,Be,n,a)),ie=!0;break}ie||l.push(_[1])}break;case"PtgArray":l.push("{"+jX(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Qe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&E>=0&&Qe.indexOf(e[0][S][0])==-1){_=e[0][E];var ae=!0;switch(_[1][0]){case 4:ae=!1;case 0:T=Vr(" ",_[1][1]);break;case 5:ae=!1;case 1:T=Vr("\r",_[1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}l.push((ae?T:"")+l.pop()+(ae?"":T)),E=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function WX(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],zn(e,t-2)];var l=Lu(e,i,r);return t!==i+a&&(s=Mu(e,t-i-a,l,r)),e.l=n,[l,s]}function JX(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],zn(e,t-2)];var l=Lu(e,i,r);return t!==i+a&&(s=Mu(e,t-i-a,l,r)),e.l=n,[l,s]}function YX(e,t,r,n){var a=e.l+t,s=Lu(e,n,r),i;return a!==e.l&&(i=Mu(e,a-e.l,s,r)),[s,i]}function qX(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Lu(e,s,r);return s==65535?[[],zn(e,t-2)]:(t!==s+2&&(a=Mu(e,n-s-2,i,r)),[i,a])}function $X(e){var t;if(As(e,e.l+6)!==65535)return[Kn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function ZX(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zi(e);return Zi(0)}function jm(e,t,r){var n=e.l+t,a=DA(e);r.biff==2&&++e.l;var s=$X(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=JX(e,n-e.l,r);return{cell:a,val:s[0],formula:l,shared:i>>3&1,tt:s[1]}}function eW(e,t,r,n,a){var s=to(t,r,a),i=ZX(e.v),l=be(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var f=be(e.bf.length),d=0;d<e.bf.length;++d)f[d]=e.bf[d];var p=Bn([s,i,l,f]);return p}function Zd(e,t,r){var n=e.read_shift(4),a=Lu(e,n,r),s=e.read_shift(4),i=s>0?Mu(e,s,a,r):null;return[a,i]}var tW=Zd,eh=Zd,rW=Zd,nW=Zd,aW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},w4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},AW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function z2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function sW(e){var t="of:="+e.replace(nv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function zm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function iW(e){return e.replace(/\./,"!")}var tu={},xl={},ru=typeof Map<"u";function sv(e,t,r){var n=0,a=e.length;if(r){if(ru?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=ru?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(ru?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function th(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Vn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=yu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Sd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Yi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function di(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){os(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function y4(e,t,r,n,a,s){try{n.cellNF&&(e.z=vt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Nr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(vt[t]==null&&os(a9[t]||"General",t),e.t==="e")e.w=e.w||xs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hu(e.v);else if(e.t==="d"){var i=mn(e.v);(i|0)===i?e.w=i.toString(10):e.w=hu(i)}else{if(e.v===void 0)return"";e.w=qi(e.v,xl)}else e.t==="d"?e.w=tA(t,mn(e.v),xl):e.w=tA(t,e.v,xl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Td(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Td(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function oW(e,t,r){if(e&&e["!ref"]){var n=$t(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function lW(e,t){var r=$t(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=kt(r))}var cW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fW=/<(?:\w:)?hyperlink [^>]*>/mg,dW=/"(\w*:\w*)"/,hW=/<(?:\w:)?col\b[^>]*[\/]?>/g,gW=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,mW=/<(?:\w:)?pageMargins[^>]*\/>/g,B4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,pW=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,xW=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vW(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",p=e.match(uW);p?(f=e.slice(0,p.index),d=e.slice(p.index+p[0].length)):f=d=e;var x=f.match(B4);x?iv(x[0],l,a,r):(x=f.match(pW))&&yW(x[0],x[1]||"",l,a,r);var y=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var C=f.slice(y,y+50).match(dW);C&&lW(l,C[1])}var E=f.match(xW);E&&E[1]&&QW(E[1],a);var T=[];if(t.cellStyles){var S=f.match(hW);S&&FW(T,S)}p&&MW(p[1],l,t,u,s,i);var F=d.match(gW);F&&(l["!autofilter"]=kW(F[0]));var _=[],N=d.match(cW);if(N)for(y=0;y!=N.length;++y)_[y]=$t(N[y].slice(N[y].indexOf('"')+1));var I=d.match(fW);I&&SW(l,I,n);var U=d.match(mW);if(U&&(l["!margins"]=_W(Ct(U[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=kt(u)),t.sheetRows>0&&l["!ref"]){var k=$t(l["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>u.e.r&&(k.e.r=u.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>u.e.c&&(k.e.c=u.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),l["!fullref"]=l["!ref"],l["!ref"]=kt(k))}return T.length>0&&(l["!cols"]=T),_.length>0&&(l["!merges"]=_),l}function wW(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+kt(e[r])+'"/>';return t+"</mergeCells>"}function iv(e,t,r,n){var a=Ct(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=qt(Br(a.codeName)))}function yW(e,t,r,n,a){iv(e.slice(0,e.indexOf(">")),r,n,a)}function BW(e,t,r,n,a){var s=!1,i={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,i.codeName=FA(mr(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),l=(l||"")+Ke("outlinePr",null,f)}!s&&!l||(a[a.length]=Ke("sheetPr",l,i))}var CW=["objects","scenarios","selectLockedCells","selectUnlockedCells"],EW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function TW(e){var t={sheet:1};return CW.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),EW.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ev(e.password).toString(16).toUpperCase()),Ke("sheetProtection",null,t)}function SW(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ct(Br(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+qt(s.location))):(s.Target="#"+qt(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=$t(s.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var d=yt({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function _W(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function bW(e){return Yi(e),Ke("pageMargins",null,e)}function FW(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ct(t[n],!0);a.hidden&&(a.hidden=kr(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,tv(a.width)),Ai(a);s<=i;)e[s++]=Ir(a)}}function UW(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ke("col",null,th(a,n)));return r[r.length]="</cols>",r.join("")}function kW(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function NW(e,t,r,n){var a=typeof e.ref=="string"?e.ref:kt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=da(a);i.s.r==i.e.r&&(i.e.r=da(t["!ref"]).e.r,a=kt(i));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ke("autoFilter",null,{ref:a})}var IW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function QW(e,t){t.Views||(t.Views=[{}]),(e.match(IW)||[]).forEach(function(r,n){var a=Ct(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),kr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function RW(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ke("sheetViews",Ke("sheetView",null,a),{})}function DW(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=xs[e.v];break;case"d":n&&n.cellDates?a=Nr(e.v,-1).toISOString():(e=Ir(e),e.t="n",a=""+(e.v=mn(Nr(e.v)))),typeof e.z>"u"&&(e.z=vt[14]);break;default:a=e.v;break}var l=In("v",mr(a)),u={r:t},f=di(n.cellXfs,e,n);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=In("v",""+sv(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ke("f",mr(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Ke("c",l,u)}var MW=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=gu("v"),i=gu("f");return function(u,f,d,p,x,y){for(var C=0,E="",T=[],S=[],F=0,_=0,N=0,I="",U,k,G=0,M=0,ee,re,q=0,se=0,Te=Array.isArray(y.CellXf),Be,Z=[],ie=[],Qe=Array.isArray(f),ae=[],Le={},Y=!1,Q=!!d.sheetStubs,K=u.split(t),P=0,z=K.length;P!=z;++P){E=K[P].trim();var ce=E.length;if(ce!==0){var Ce=0;e:for(C=0;C<ce;++C)switch(E[C]){case">":if(E[C-1]!="/"){++C;break e}if(d&&d.cellStyles){if(k=Ct(E.slice(Ce,C),!0),G=k.r!=null?parseInt(k.r,10):G+1,M=-1,d.sheetRows&&d.sheetRows<G)continue;Le={},Y=!1,k.ht&&(Y=!0,Le.hpt=parseFloat(k.ht),Le.hpx=Bl(Le.hpt)),k.hidden=="1"&&(Y=!0,Le.hidden=!0),k.outlineLevel!=null&&(Y=!0,Le.level=+k.outlineLevel),Y&&(ae[G-1]=Le)}break;case"<":Ce=C;break}if(Ce>=C)break;if(k=Ct(E.slice(Ce,C),!0),G=k.r!=null?parseInt(k.r,10):G+1,M=-1,!(d.sheetRows&&d.sheetRows<G)){p.s.r>G-1&&(p.s.r=G-1),p.e.r<G-1&&(p.e.r=G-1),d&&d.cellStyles&&(Le={},Y=!1,k.ht&&(Y=!0,Le.hpt=parseFloat(k.ht),Le.hpx=Bl(Le.hpt)),k.hidden=="1"&&(Y=!0,Le.hidden=!0),k.outlineLevel!=null&&(Y=!0,Le.level=+k.outlineLevel),Y&&(ae[G-1]=Le)),T=E.slice(C).split(e);for(var he=0;he!=T.length&&T[he].trim().charAt(0)=="<";++he);for(T=T.slice(he),C=0;C!=T.length;++C)if(E=T[C].trim(),E.length!==0){if(S=E.match(r),F=C,_=0,N=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,S!=null&&S.length===2){for(F=0,I=S[1],_=0;_!=I.length&&!((N=I.charCodeAt(_)-64)<1||N>26);++_)F=26*F+N;--F,M=F}else++M;for(_=0;_!=E.length&&E.charCodeAt(_)!==62;++_);if(++_,k=Ct(E.slice(0,_),!0),k.r||(k.r=yt({r:G-1,c:M})),I=E.slice(_),U={t:""},(S=I.match(s))!=null&&S[1]!==""&&(U.v=qt(S[1])),d.cellFormula){if((S=I.match(i))!=null&&S[1]!==""){if(U.f=qt(Br(S[1])).replace(/\r\n/g,`
`),d.xlfn||(U.f=G2(U.f)),S[0].indexOf('t="array"')>-1)U.F=(I.match(a)||[])[1],U.F.indexOf(":")>-1&&Z.push([$t(U.F),U.F]);else if(S[0].indexOf('t="shared"')>-1){re=Ct(S[0]);var de=qt(Br(S[1]));d.xlfn||(de=G2(de)),ie[parseInt(re.si,10)]=[re,de,k.r]}}else(S=I.match(/<f[^>]*\/>/))&&(re=Ct(S[0]),ie[re.si]&&(U.f=Iz(ie[re.si][1],ie[re.si][2],k.r)));var ne=Or(k.r);for(_=0;_<Z.length;++_)ne.r>=Z[_][0].s.r&&ne.r<=Z[_][0].e.r&&ne.c>=Z[_][0].s.c&&ne.c<=Z[_][0].e.c&&(U.F=Z[_][1])}if(k.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(Q)U.t="z";else continue;else U.t=k.t||"n";switch(p.s.c>M&&(p.s.c=M),p.e.c<M&&(p.e.c=M),U.t){case"n":if(U.v==""||U.v==null){if(!Q)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!Q)continue;U.t="z"}else ee=tu[parseInt(U.v,10)],U.v=ee.t,U.r=ee.r,d.cellHTML&&(U.h=ee.h);break;case"str":U.t="s",U.v=U.v!=null?Br(U.v):"",d.cellHTML&&(U.h=Hx(U.v));break;case"inlineStr":S=I.match(n),U.t="s",S!=null&&(ee=Zx(S[1]))?(U.v=ee.t,d.cellHTML&&(U.h=ee.h)):U.v="";break;case"b":U.v=kr(U.v);break;case"d":d.cellDates?U.v=Nr(U.v,1):(U.v=mn(Nr(U.v,1)),U.t="n");break;case"e":(!d||d.cellText!==!1)&&(U.w=U.v),U.v=Eb[U.v];break}if(q=se=0,Be=null,Te&&k.s!==void 0&&(Be=y.CellXf[k.s],Be!=null&&(Be.numFmtId!=null&&(q=Be.numFmtId),d.cellStyles&&Be.fillId!=null&&(se=Be.fillId))),y4(U,q,se,d,x,y),d.cellDates&&Te&&U.t=="n"&&Fl(vt[q])&&(U.t="d",U.v=qd(U.v)),k.cm&&d.xlmeta){var Ee=(d.xlmeta.Cell||[])[+k.cm-1];Ee&&Ee.type=="XLDAPR"&&(U.D=!0)}if(Qe){var R=Or(k.r);f[R.r]||(f[R.r]=[]),f[R.r][R.c]=U}else f[k.r]=U}}}}ae.length>0&&(f["!rows"]=ae)}})();function LW(e,t,r,n){var a=[],s=[],i=$t(e["!ref"]),l="",u,f="",d=[],p=0,x=0,y=e["!rows"],C=Array.isArray(e),E={r:f},T,S=-1;for(x=i.s.c;x<=i.e.c;++x)d[x]=Hr(x);for(p=i.s.r;p<=i.e.r;++p){for(s=[],f=Zr(p),x=i.s.c;x<=i.e.c;++x){u=d[x]+f;var F=C?(e[p]||[])[x]:e[u];F!==void 0&&(l=DW(F,u,e,t))!=null&&s.push(l)}(s.length>0||y&&y[p])&&(E={r:f},y&&y[p]&&(T=y[p],T.hidden&&(E.hidden=1),S=-1,T.hpx?S=Bu(T.hpx):T.hpt&&(S=T.hpt),S>-1&&(E.ht=S,E.customHeight=1),T.level&&(E.outlineLevel=T.level)),a[a.length]=Ke("row",s.join(""),E))}if(y)for(;p<y.length;++p)y&&y[p]&&(E={r:p+1},T=y[p],T.hidden&&(E.hidden=1),S=-1,T.hpx?S=Bu(T.hpx):T.hpt&&(S=T.hpt),S>-1&&(E.ht=S,E.customHeight=1),T.level&&(E.outlineLevel=T.level),a[a.length]=Ke("row","",E));return a.join("")}function C4(e,t,r,n){var a=[en,Ke("worksheet",null,{xmlns:Ao[0],"xmlns:r":gn.r})],s=r.SheetNames[e],i=0,l="",u=r.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",d=$t(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=kt(d)}n||(n={}),u["!comments"]=[];var p=[];BW(u,r,e,t,a),a[a.length]=Ke("dimension",null,{ref:f}),a[a.length]=RW(u,t,e,r),t.sheetFormat&&(a[a.length]=Ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(a[a.length]=UW(u,u["!cols"])),a[i=a.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=LW(u,t),l.length>0&&(a[a.length]=l)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),u["!protect"]&&(a[a.length]=TW(u["!protect"])),u["!autofilter"]!=null&&(a[a.length]=NW(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(a[a.length]=wW(u["!merges"]));var x=-1,y,C=-1;return u["!links"].length>0&&(a[a.length]="<hyperlinks>",u["!links"].forEach(function(E){E[1].Target&&(y={ref:E[0]},E[1].Target.charAt(0)!="#"&&(C=gr(n,-1,mr(E[1].Target).replace(/#.*$/,""),Lt.HLINK),y["r:id"]="rId"+C),(x=E[1].Target.indexOf("#"))>-1&&(y.location=mr(E[1].Target.slice(x+1))),E[1].Tooltip&&(y.tooltip=mr(E[1].Tooltip)),a[a.length]=Ke("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(a[a.length]=bW(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=In("ignoredErrors",Ke("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(C=gr(n,-1,"../drawings/drawing"+(e+1)+".xml",Lt.DRAW),a[a.length]=Ke("drawing",null,{"r:id":"rId"+C}),u["!drawing"]=p),u["!comments"].length>0&&(C=gr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Lt.VML),a[a.length]=Ke("legacyDrawing",null,{"r:id":"rId"+C}),u["!legacy"]=C),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function HW(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function OW(e,t,r){var n=be(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Bu(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var l=0,u=n.l;n.l+=4;for(var f={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var p=-1,x=-1,y=d<<10;y<d+1<<10;++y){f.c=y;var C=Array.isArray(r)?(r[f.r]||[])[f.c]:r[yt(f)];C&&(p<0&&(p=y),x=y)}p<0||(++l,n.write_shift(4,p),n.write_shift(4,x))}var E=n.l;return n.l=u,n.write_shift(4,l),n.l=E,n.length>n.l?n.slice(0,n.l):n}function PW(e,t,r,n){var a=OW(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&De(e,0,a)}var GW=lo,VW=Nl;function KW(){}function jW(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=W9(e),r}function zW(e,t,r){r==null&&(r=be(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Bd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),vb(e,r),r.slice(0,r.l)}function XW(e){var t=rA(e);return[t]}function WW(e,t,r){return r==null&&(r=be(8)),so(t,r)}function JW(e){var t=io(e);return[t]}function YW(e,t,r){return r==null&&(r=be(4)),oo(t,r)}function qW(e){var t=rA(e),r=e.read_shift(1);return[t,r,"b"]}function $W(e,t,r){return r==null&&(r=be(9)),so(t,r),r.write_shift(1,e.v?1:0),r}function ZW(e){var t=io(e),r=e.read_shift(1);return[t,r,"b"]}function eJ(e,t,r){return r==null&&(r=be(5)),oo(t,r),r.write_shift(1,e.v?1:0),r}function tJ(e){var t=rA(e),r=e.read_shift(1);return[t,r,"e"]}function rJ(e,t,r){return r==null&&(r=be(9)),so(t,r),r.write_shift(1,e.v),r}function nJ(e){var t=io(e),r=e.read_shift(1);return[t,r,"e"]}function aJ(e,t,r){return r==null&&(r=be(8)),oo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function AJ(e){var t=rA(e),r=e.read_shift(4);return[t,r,"s"]}function sJ(e,t,r){return r==null&&(r=be(12)),so(t,r),r.write_shift(4,t.v),r}function iJ(e){var t=io(e),r=e.read_shift(4);return[t,r,"s"]}function oJ(e,t,r){return r==null&&(r=be(8)),oo(t,r),r.write_shift(4,t.v),r}function lJ(e){var t=rA(e),r=Kn(e);return[t,r,"n"]}function cJ(e,t,r){return r==null&&(r=be(16)),so(t,r),Zi(e.v,r),r}function E4(e){var t=io(e),r=Kn(e);return[t,r,"n"]}function uJ(e,t,r){return r==null&&(r=be(12)),oo(t,r),Zi(e.v,r),r}function fJ(e){var t=rA(e),r=Wx(e);return[t,r,"n"]}function dJ(e,t,r){return r==null&&(r=be(12)),so(t,r),wb(e.v,r),r}function hJ(e){var t=io(e),r=Wx(e);return[t,r,"n"]}function gJ(e,t,r){return r==null&&(r=be(8)),oo(t,r),wb(e.v,r),r}function mJ(e){var t=rA(e),r=jx(e);return[t,r,"is"]}function pJ(e){var t=rA(e),r=jn(e);return[t,r,"str"]}function xJ(e,t,r){return r==null&&(r=be(12+4*e.v.length)),so(t,r),En(e.v,r),r.length>r.l?r.slice(0,r.l):r}function vJ(e){var t=io(e),r=jn(e);return[t,r,"str"]}function wJ(e,t,r){return r==null&&(r=be(8+4*e.v.length)),oo(t,r),En(e.v,r),r.length>r.l?r.slice(0,r.l):r}function yJ(e,t,r){var n=e.l+t,a=rA(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=eh(e,n-e.l,r);i[3]=Gn(l,null,a,r.supbooks,r)}else e.l=n;return i}function BJ(e,t,r){var n=e.l+t,a=rA(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=eh(e,n-e.l,r);i[3]=Gn(l,null,a,r.supbooks,r)}else e.l=n;return i}function CJ(e,t,r){var n=e.l+t,a=rA(e);a.r=r["!row"];var s=Kn(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=eh(e,n-e.l,r);i[3]=Gn(l,null,a,r.supbooks,r)}else e.l=n;return i}function EJ(e,t,r){var n=e.l+t,a=rA(e);a.r=r["!row"];var s=jn(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=eh(e,n-e.l,r);i[3]=Gn(l,null,a,r.supbooks,r)}else e.l=n;return i}var TJ=lo,SJ=Nl;function _J(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function bJ(e,t){var r=e.l+t,n=lo(e),a=zx(e),s=jn(e),i=jn(e),l=jn(e);e.l=r;var u={rfx:n,relId:a,loc:s,display:l};return i&&(u.Tooltip=i),u}function FJ(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Nl({s:Or(e[0]),e:Or(e[0])},r),Xx("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return En(a||"",r),En(e[1].Tooltip||"",r),En("",r),r.slice(0,r.l)}function UJ(){}function kJ(e,t,r){var n=e.l+t,a=yb(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var l=tW(e,n-e.l,r);i[1]=l}else e.l=n;return i}function NJ(e,t,r){var n=e.l+t,a=lo(e),s=[a];if(r.cellFormula){var i=nW(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function IJ(e,t,r){r==null&&(r=be(18));var n=th(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var T4=["left","right","top","bottom","header","footer"];function QJ(e){var t={};return T4.forEach(function(r){t[r]=Kn(e)}),t}function RJ(e,t){return t==null&&(t=be(48)),Yi(e),T4.forEach(function(r){Zi(e[r],t)}),t}function DJ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function MJ(e,t,r){r==null&&(r=be(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function LJ(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),Nl(e,t),t}function HJ(e,t){return t==null&&(t=be(66)),t.write_shift(2,e.password?ev(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function OJ(){}function PJ(){}function GJ(e,t,r,n,a,s,i){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,x=!1,y,C,E,T,S,F,_,N,I,U=[];l.biff=12,l["!row"]=0;var k=0,G=!1,M=[],ee={},re=l.supbooks||a.supbooks||[[]];if(re.sharedf=ee,re.arrayf=M,re.SheetNames=a.SheetNames||a.Sheets.map(function(Qe){return Qe.name}),!l.supbooks&&(l.supbooks=re,a.Names))for(var q=0;q<a.Names.length;++q)re[0][q+1]=a.Names[q];var se=[],Te=[],Be=!1;Cu[16]={n:"BrtShortReal",f:E4};var Z;if(ps(e,function(ae,Le,Y){if(!x)switch(Y){case 148:f=ae;break;case 0:y=ae,l.sheetRows&&l.sheetRows<=y.r&&(x=!0),N=Zr(T=y.r),l["!row"]=y.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Bl(ae.hpt)),Te[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(C={t:ae[2]},ae[2]){case"n":C.v=ae[1];break;case"s":_=tu[ae[1]],C.v=_.t,C.r=_.r;break;case"b":C.v=!!ae[1];break;case"e":C.v=ae[1],l.cellText!==!1&&(C.w=xs[C.v]);break;case"str":C.t="s",C.v=ae[1];break;case"is":C.t="s",C.v=ae[1].t;break}if((E=i.CellXf[ae[0].iStyleRef])&&y4(C,E.numFmtId,null,l,s,i),S=ae[0].c==-1?S+1:ae[0].c,l.dense?(u[T]||(u[T]=[]),u[T][S]=C):u[Hr(S)+N]=C,l.cellFormula){for(G=!1,k=0;k<M.length;++k){var Q=M[k];y.r>=Q[0].s.r&&y.r<=Q[0].e.r&&S>=Q[0].s.c&&S<=Q[0].e.c&&(C.F=kt(Q[0]),G=!0)}!G&&ae.length>3&&(C.f=ae[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>S&&(d.s.c=S),d.e.r<y.r&&(d.e.r=y.r),d.e.c<S&&(d.e.c=S),l.cellDates&&E&&C.t=="n"&&Fl(vt[E.numFmtId])){var K=Ki(C.v);K&&(C.t="d",C.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}Z&&(Z.type=="XLDAPR"&&(C.D=!0),Z=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;C={t:"z",v:void 0},S=ae[0].c==-1?S+1:ae[0].c,l.dense?(u[T]||(u[T]=[]),u[T][S]=C):u[Hr(S)+N]=C,d.s.r>y.r&&(d.s.r=y.r),d.s.c>S&&(d.s.c=S),d.e.r<y.r&&(d.e.r=y.r),d.e.c<S&&(d.e.c=S),Z&&(Z.type=="XLDAPR"&&(C.D=!0),Z=void 0);break;case 176:U.push(ae);break;case 49:Z=((l.xlmeta||{}).Cell||[])[ae-1];break;case 494:var P=n["!id"][ae.relId];for(P?(ae.Target=P.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=P):ae.relId==""&&(ae.Target="#"+ae.loc),T=ae.rfx.s.r;T<=ae.rfx.e.r;++T)for(S=ae.rfx.s.c;S<=ae.rfx.e.c;++S)l.dense?(u[T]||(u[T]=[]),u[T][S]||(u[T][S]={t:"z",v:void 0}),u[T][S].l=ae):(F=yt({c:S,r:T}),u[F]||(u[F]={t:"z",v:void 0}),u[F].l=ae);break;case 426:if(!l.cellFormula)break;M.push(ae),I=l.dense?u[T][S]:u[Hr(S)+N],I.f=Gn(ae[1],d,{r:y.r,c:S},re,l),I.F=kt(ae[0]);break;case 427:if(!l.cellFormula)break;ee[yt(ae[0].s)]=ae[1],I=l.dense?u[T][S]:u[Hr(S)+N],I.f=Gn(ae[1],d,{r:y.r,c:S},re,l);break;case 60:if(!l.cellStyles)break;for(;ae.e>=ae.s;)se[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},Be||(Be=!0,tv(ae.w/256)),Ai(se[ae.e+1]);break;case 161:u["!autofilter"]={ref:kt(ae)};break;case 476:u["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(u["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Le.T){if(!p||l.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=kt(f||d)),l.sheetRows&&u["!ref"]){var ie=$t(u["!ref"]);l.sheetRows<=+ie.e.r&&(ie.e.r=l.sheetRows-1,ie.e.r>d.e.r&&(ie.e.r=d.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>d.e.c&&(ie.e.c=d.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),u["!fullref"]=u["!ref"],u["!ref"]=kt(ie))}return U.length>0&&(u["!merges"]=U),se.length>0&&(u["!cols"]=se),Te.length>0&&(u["!rows"]=Te),u}function VJ(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Ir(t),t.z=t.z||vt[14],t.v=mn(Nr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var u={r,c:n};switch(u.s=di(a.cellXfs,t,a),t.l&&s["!links"].push([yt(u),t.l]),t.c&&s["!comments"].push([yt(u),t.c]),t.t){case"s":case"str":return a.bookSST?(l=sv(a.Strings,t.v,a.revStrings),u.t="s",u.v=l,i?De(e,18,oJ(t,u)):De(e,7,sJ(t,u))):(u.t="str",i?De(e,17,wJ(t,u)):De(e,6,xJ(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?De(e,13,gJ(t,u)):De(e,2,dJ(t,u)):i?De(e,16,uJ(t,u)):De(e,5,cJ(t,u)),!0;case"b":return u.t="b",i?De(e,15,eJ(t,u)):De(e,4,$W(t,u)),!0;case"e":return u.t="e",i?De(e,14,aJ(t,u)):De(e,3,rJ(t,u)),!0}return i?De(e,12,YW(t,u)):De(e,1,WW(t,u)),!0}function KJ(e,t,r,n){var a=$t(t["!ref"]||"A1"),s,i="",l=[];De(e,145);var u=Array.isArray(t),f=a.e.r;t["!rows"]&&(f=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=f;++d){i=Zr(d),PW(e,t,a,d);var p=!1;if(d<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){d===a.s.r&&(l[x]=Hr(x)),s=l[x]+i;var y=u?(t[d]||[])[x]:t[s];if(!y){p=!1;continue}p=VJ(e,y,d,x,n,t,p)}}De(e,146)}function jJ(e,t){!t||!t["!merges"]||(De(e,177,_J(t["!merges"].length)),t["!merges"].forEach(function(r){De(e,176,SJ(r))}),De(e,178))}function zJ(e,t){!t||!t["!cols"]||(De(e,390),t["!cols"].forEach(function(r,n){r&&De(e,60,IJ(n,r))}),De(e,391))}function XJ(e,t){!t||!t["!ref"]||(De(e,648),De(e,649,LJ($t(t["!ref"]))),De(e,650))}function WJ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=gr(r,-1,n[1].Target.replace(/#.*$/,""),Lt.HLINK);De(e,494,FJ(n,a))}}),delete t["!links"]}function JJ(e,t,r,n){if(t["!comments"].length>0){var a=gr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Lt.VML);De(e,551,Xx("rId"+a)),t["!legacy"]=a}}function YJ(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:kt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=da(s);l.s.r==l.e.r&&(l.e.r=da(t["!ref"]).e.r,s=kt(l));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+s;break}}u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),De(e,161,Nl($t(s))),De(e,162)}}function qJ(e,t,r){De(e,133),De(e,137,MJ(t,r)),De(e,138),De(e,134)}function $J(e,t){t["!protect"]&&De(e,535,HJ(t["!protect"]))}function ZJ(e,t,r,n){var a=fa(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var u=$t(i["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],De(a,129),(r.vbaraw||i["!outline"])&&De(a,147,zW(l,i["!outline"])),De(a,148,VW(u)),qJ(a,i,r.Workbook),zJ(a,i),KJ(a,i,e,t),$J(a,i),YJ(a,i,r,e),jJ(a,i),WJ(a,i,n),i["!margins"]&&De(a,476,RJ(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&XJ(a,i),JJ(a,i,e,n),De(a,130),a.end()}function eY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=qt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function tY(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var l=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var x=eY(p);d.s.r=d.s.c=0,d.e.c=l,f=Hr(l),x[0].forEach(function(y,C){i[f+Zr(C)]={t:"n",v:y,z:x[1]},u=C}),d.e.r<u&&(d.e.r=u),++l}),l>0&&(i["!ref"]=kt(d)),i}function rY(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(B4);return l&&iv(l[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function nY(e,t){e.l+=10;var r=jn(e);return{name:r}}function aY(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ps(e,function(u,f,d){switch(d){case 550:s["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ov=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],AY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sY=[],iY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function X2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=kr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function W2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=kr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function S4(e){W2(e.WBProps,ov),W2(e.CalcPr,iY),X2(e.WBView,AY),X2(e.Sheets,sY),xl.date1904=kr(e.WBProps.date1904)}function oY(e){return!e.Workbook||!e.Workbook.WBProps?"false":kr(e.Workbook.WBProps.date1904)?"true":"false"}var lY="][*?/\\".split("");function _4(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return lY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function cY(e,t,r){e.forEach(function(n,a){_4(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function uY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];cY(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)oW(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var fY=/<\w+:workbook/;function dY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Xn,function(u,f){var d=Ct(u);switch(RA(d[0])){case"<?xml":break;case"<workbook":u.match(fY)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ov.forEach(function(p){if(d[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=kr(d[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(d[p[0]],10);break;default:r.WBProps[p[0]]=d[p[0]]}}),d.codeName&&(r.WBProps.CodeName=Br(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=qt(Br(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Br(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),kr(d.hidden||"0")&&(s.Hidden=!0),i=f+u.length;break;case"</definedName>":s.Ref=qt(Br(e.slice(i,f))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Ao.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return S4(r),r}function b4(e){var t=[en];t[t.length]=Ke("workbook",null,{xmlns:Ao[0],"xmlns:r":gn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ov.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ke("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:mr(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Ke("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(t[t.length]=Ke("definedName",mr(l.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function hY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Xp(e),r.name=jn(e),r}function gY(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Xx(e.strRelID,t),En(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function mY(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?jn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function pY(e,t){t||(t=be(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),vb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function xY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function vY(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=J9(e),i=rW(e,0,r),l=zx(e);e.l=n;var u={Name:s,Ptg:i};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function wY(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Cu[16]={n:"BrtFRTArchID$",f:xY},ps(e,function(u,f,d){switch(d){case 156:i.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Gn(u.Ptg,null,null,i,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,u]):i[0]=[d,u],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(u),i.XTI=i.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),S4(r),r.Names=s,r.supbooks=i,r}function yY(e,t){De(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};De(e,156,gY(a))}De(e,144)}function BY(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return En("SheetJS",t),En(gd.version,t),En(gd.version,t),En("7262",t),t.length>t.l?t.slice(0,t.l):t}function CY(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function EY(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(De(e,135),De(e,158,CY(a)),De(e,136))}}function TY(e,t){var r=fa();return De(r,131),De(r,128,BY()),De(r,153,pY(e.Workbook&&e.Workbook.WBProps||null)),EY(r,e),yY(r,e),De(r,132),r.end()}function SY(e,t,r){return t.slice(-4)===".bin"?wY(e,r):dY(e,r)}function _Y(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?GJ(e,n,r,a,s,i,l):vW(e,n,r,a,s,i,l)}function bY(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?aY(e,n,r,a,s):rY(e,n,r,a,s)}function FY(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?kz():Nz()}function UY(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?Fz():Uz()}function kY(e,t,r,n){return t.slice(-4)===".bin"?Sj(e,r,n):hj(e,r,n)}function NY(e,t,r){return o4(e,r)}function IY(e,t,r){return t.slice(-4)===".bin"?IK(e,r):UK(e,r)}function QY(e,t,r){return t.slice(-4)===".bin"?Ez(e,r):gz(e,r)}function RY(e,t,r){return t.slice(-4)===".bin"?fz(e):cz(e)}function DY(e,t,r,n){return r.slice(-4)===".bin"?dz(e,t,r,n):void 0}function MY(e,t,r){return t.slice(-4)===".bin"?iz(e,t,r):lz(e,t,r)}function LY(e,t,r){return(t.slice(-4)===".bin"?TY:b4)(e)}function HY(e,t,r,n,a){return(t.slice(-4)===".bin"?ZJ:C4)(e,r,n,a)}function OY(e,t,r){return(t.slice(-4)===".bin"?Dj:s4)(e,r)}function PY(e,t,r){return(t.slice(-4)===".bin"?DK:$b)(e,r)}function GY(e,t,r){return(t.slice(-4)===".bin"?Tz:u4)(e)}function VY(e){return(e.slice(-4)===".bin"?oz:l4)()}var F4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,U4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function lA(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(F4),s,i,l,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(U4),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),n[l]=s[2].slice(1,s[2].length-1));return n}function KY(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(F4),a,s,i,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(U4),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var nu;function jY(e,t){var r=nu[e]||qt(e);return r==="General"?qi(t):tA(r,t)}function zY(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=kr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Nr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[qt(t)]=a}function XY(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hu(e.v):e.w=qi(e.v):e.w=jY(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=nu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fl(n)){var a=Ki(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function WY(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=sj[n.Pattern]||n.Pattern)}e[t.ID]=t}function JY(e,t,r,n,a,s,i,l,u,f){var d="General",p=n.StyleID,x={};f=f||{};var y=[],C=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&i&&(p=i.StyleID);s[p]!==void 0&&(s[p].nf&&(d=s[p].nf),s[p].Interior&&y.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=kr(e);break;case"String":n.t="s",n.r=u2(qt(e)),n.v=e.indexOf("<")>-1?qt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Nr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=qt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Eb[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=u2(t||e));break}if(XY(n,d,f),f.cellFormula!==!1)if(n.Formula){var E=qt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=pl(E,a),delete n.Formula,n.ArrayRange=="RC"?n.F=pl("RC:RC",a):n.ArrayRange&&(n.F=pl(n.ArrayRange,a),u.push([$t(n.F),n.F]))}else for(C=0;C<u.length;++C)a.r>=u[C][0].s.r&&a.r<=u[C][0].e.r&&a.c>=u[C][0].s.c&&a.c<=u[C][0].e.c&&(n.F=u[C][1]);f.cellStyles&&(y.forEach(function(T){!x.patternType&&T.patternType&&(x.patternType=T.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function YY(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Xm(e,t){var r=t||{};Ul();var n=Pc(Ox(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Br(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Ir(r);return i.type="string",yl.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){a.indexOf("<"+it)>=0&&(s=!0)}),s)return Rq(n,r);nu={"General Number":"General","General Date":vt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":vt[15],"Short Date":vt[14],"Long Time":vt[19],"Medium Time":vt[18],"Short Time":vt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:vt[2],Standard:vt[4],Percent:vt[10],Scientific:vt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,d={},p=[],x=r.dense?[]:{},y="",C={},E={},T=lA('<Data ss:Type="String">'),S=0,F=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},U={},k="",G=0,M=[],ee={},re={},q=0,se=[],Te=[],Be={},Z=[],ie,Qe=!1,ae=[],Le=[],Y={},Q=0,K=0,P={Sheets:[],WBProps:{date1904:!1}},z={};pu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";l=pu.exec(n);)switch(l[3]=(ce=l[3]).toLowerCase()){case"data":if(ce=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?JY(n.slice(S,l.index),k,T,u[u.length-1][0]=="comment"?Be:C,{c:F,r:_},I,Z[F],E,ae,r):(k="",T=lA(l[0]),S=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Te.length>0&&(C.c=Te),(!r.sheetRows||r.sheetRows>_)&&C.v!==void 0&&(r.dense?(x[_]||(x[_]=[]),x[_][F]=C):x[Hr(F)+Zr(_)]=C),C.HRef&&(C.l={Target:qt(C.HRef)},C.HRefScreenTip&&(C.l.Tooltip=C.HRefScreenTip),delete C.HRef,delete C.HRefScreenTip),(C.MergeAcross||C.MergeDown)&&(Q=F+(parseInt(C.MergeAcross,10)|0),K=_+(parseInt(C.MergeDown,10)|0),M.push({s:{c:F,r:_},e:{c:Q,r:K}})),!r.sheetStubs)C.MergeAcross?F=Q+1:++F;else if(C.MergeAcross||C.MergeDown){for(var Ce=F;Ce<=Q;++Ce)for(var he=_;he<=K;++he)(Ce>F||he>_)&&(r.dense?(x[he]||(x[he]=[]),x[he][Ce]={t:"z"}):x[Hr(Ce)+Zr(he)]={t:"z"});F=Q+1}else++F;else C=KY(l[0]),C.Index&&(F=+C.Index-1),F<N.s.c&&(N.s.c=F),F>N.e.c&&(N.e.c=F),l[0].slice(-2)==="/>"&&++F,Te=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),l[0].slice(-2)==="/>"&&(E=lA(l[0]),E.Index&&(_=+E.Index-1)),F=0,++_):(E=lA(l[0]),E.Index&&(_=+E.Index-1),Y={},(E.AutoFitHeight=="0"||E.Height)&&(Y.hpx=parseInt(E.Height,10),Y.hpt=Bu(Y.hpx),Le[_]=Y),E.Hidden=="1"&&(Y.hidden=!0,Le[_]=Y));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));p.push(y),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(x["!ref"]=kt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=kt(N))),M.length&&(x["!merges"]=M),Z.length>0&&(x["!cols"]=Z),Le.length>0&&(x["!rows"]=Le),d[y]=x}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=F=0,u.push([l[3],!1]),f=lA(l[0]),y=qt(f.Name),x=r.dense?[]:{},M=[],ae=[],Le=[],z={name:y,Hidden:0},P.Sheets.push(z);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),Z=[],Qe=!1}break;case"style":l[1]==="/"?WY(I,U,r):U=lA(l[0]);break;case"numberformat":U.nf=qt(lA(l[0]).Format||"General"),nu[U.nf]&&(U.nf=nu[U.nf]);for(var de=0;de!=392&&vt[de]!=U.nf;++de);if(de==392){for(de=57;de!=392;++de)if(vt[de]==null){os(U.nf,de);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ie=lA(l[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!Qe&&ie.wpx>10){Qe=!0,Vn=a4;for(var ne=0;ne<Z.length;++ne)Z[ne]&&Ai(Z[ne])}Qe&&Ai(ie),Z[ie.Index-1||Z.length]=ie;for(var Ee=0;Ee<+ie.Span;++Ee)Z[Z.length]=Ir(ie);break;case"namedrange":if(l[1]==="/")break;P.Names||(P.Names=[]);var R=Ct(l[0]),Re={Name:R.Name,Ref:pl(R.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Re.Sheet=P.Sheets.length-1),P.Names.push(Re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?k+=n.slice(G,l.index):G=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=lA(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?wG(ee,ce,n.slice(q,l.index)):q=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));YY(Be),Te.push(Be)}else u.push([l[3],!1]),f=lA(l[0]),Be={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ge=lA(l[0]);x["!autofilter"]={ref:pl(Ge.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return Z2(n,r);var Ze=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(l[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(q,l.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else q=l.index+l[0].length;break;case"header":x["!margins"]||Yi(x["!margins"]={},"xlml"),isNaN(+Ct(l[0]).Margin)||(x["!margins"].header=+Ct(l[0]).Margin);break;case"footer":x["!margins"]||Yi(x["!margins"]={},"xlml"),isNaN(+Ct(l[0]).Margin)||(x["!margins"].footer=+Ct(l[0]).Margin);break;case"pagemargins":var st=Ct(l[0]);x["!margins"]||Yi(x["!margins"]={},"xlml"),isNaN(+st.Top)||(x["!margins"].top=+st.Top),isNaN(+st.Left)||(x["!margins"].left=+st.Left),isNaN(+st.Right)||(x["!margins"].right=+st.Right),isNaN(+st.Bottom)||(x["!margins"].bottom=+st.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?zY(re,ce,se,n.slice(q,l.index)):(se=l,q=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=d),He.SheetNames=p,He.Workbook=P,He.SSF=Ir(vt),He.Props=ee,He.Custprops=re,He}function ex(e,t){switch(cv(t=t||{}),t.type||"base64"){case"base64":return Xm(Fa(e),t);case"binary":case"buffer":case"file":return Xm(e,t);case"array":return Xm(ui(e),t)}}function qY(e,t){var r=[];return e.Props&&r.push(yG(e.Props,t)),e.Custprops&&r.push(BG(e.Props,e.Custprops)),r.join("")}function $Y(){return""}function ZY(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Ke("NumberFormat",null,{"ss:Format":mr(vt[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(Ke("Style",s.join(""),i))}),Ke("Styles",r.join(""))}function k4(e){return Ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+av(e.Ref,{r:0,c:0})})}function eq(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(k4(a)))}return Ke("Names",r.join(""))}function tq(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var l=a[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(k4(l)))}return s.join("")}function rq(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ke("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ke("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(In("ProtectContents","True")),e["!protect"].objects&&a.push(In("ProtectObjects","True")),e["!protect"].scenarios&&a.push(In("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(In("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(In("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":Ke("WorksheetOptions",a.join(""),{xmlns:Ea.x})}function nq(e){return e.map(function(t){var r=E9(t.t||""),n=Ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ke("Comment",n,{"ss:Author":t.a})}).join("")}function aq(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+mr(av(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var u=Or(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==i.r?"":"["+(u.r-i.r)+"]")+"C"+(u.c==i.c?"":"["+(u.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=mr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=mr(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],d=0;d!=f.length;++d)f[d].s.c!=i.c||f[d].s.r!=i.r||(f[d].e.c>f[d].s.c&&(l["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(l["ss:MergeDown"]=f[d].e.r-f[d].s.r));var p="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",x=String(e.v);break;case"b":p="Boolean",x=e.v?"1":"0";break;case"e":p="Error",x=xs[e.v];break;case"d":p="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||vt[14]);break;case"s":p="String",x=C9(e.v||"");break}var y=di(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+y),l["ss:Index"]=i.c+1;var C=e.v!=null?x:"",E=e.t=="z"?"":'<Data ss:Type="'+p+'">'+C+"</Data>";return(e.c||[]).length>0&&(E+=nq(e.c)),Ke("Cell",E,l)}function Aq(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Bl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function sq(e,t,r,n){if(!e["!ref"])return"";var a=$t(e["!ref"]),s=e["!merges"]||[],i=0,l=[];e["!cols"]&&e["!cols"].forEach(function(T,S){Ai(T);var F=!!T.width,_=th(S,T),N={"ss:Index":S+1};F&&(N["ss:Width"]=wu(_.width)),T.hidden&&(N["ss:Hidden"]="1"),l.push(Ke("Column",null,N))});for(var u=Array.isArray(e),f=a.s.r;f<=a.e.r;++f){for(var d=[Aq(f,(e["!rows"]||[])[f])],p=a.s.c;p<=a.e.c;++p){var x=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>p)&&!(s[i].s.r>f)&&!(s[i].e.c<p)&&!(s[i].e.r<f)){(s[i].s.c!=p||s[i].s.r!=f)&&(x=!0);break}if(!x){var y={r:f,c:p},C=yt(y),E=u?(e[f]||[])[p]:e[C];d.push(aq(E,C,e,t,r,n,y))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function iq(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?tq(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?sq(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(rq(s,t,e,r)),n.join("")}function oq(e,t){t||(t={}),e.SSF||(e.SSF=Ir(vt)),e.SSF&&(Ul(),Wd(e.SSF),t.revssf=Yd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],di(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(qY(e,t)),r.push($Y()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ke("Worksheet",iq(n,t,e),{"ss:Name":mr(e.SheetNames[n])}));return r[2]=ZY(e,t),r[3]=eq(e),en+Ke("Workbook",r.join(""),{xmlns:Ea.ss,"xmlns:o":Ea.o,"xmlns:x":Ea.x,"xmlns:ss":Ea.ss,"xmlns:dt":Ea.dt,"xmlns:html":Ea.html})}function lq(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=eG(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=tG(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var cq=[60,1084,2066,2165,2175];function uq(e,t,r,n,a){var s=n,i=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}i.push(l),r.l+=s;for(var u=As(r,r.l),f=tx[u],d=0;f!=null&&cq.indexOf(u)>-1;)s=As(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),l=r.slice(d,r.l+4+s),i.push(l),r.l+=4+s,f=tx[u=As(r,r.l)];var p=Bn(i);Nn(p,0);var x=0;p.lens=[];for(var y=0;y<i.length;++y)p.lens.push(x),x+=i[y].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,a)}function TA(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=vt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hu(e.v):e.w=qi(e.v):e.w=tA(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Fl(vt[n]||String(n))){var a=Ki(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Qf(e,t,r){return{v:e,ixfe:t,t:r}}function fq(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},l=null,u=[],f="",d={},p,x="",y,C,E,T,S={},F=[],_,N,I=[],U=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},G={},M=function(et){return et<8?Xi[et]:et<64&&U[et-8]||Xi[et]},ee=function(et,Tt,Rt){var xt=Tt.XF.data;if(!(!xt||!xt.patternType||!Rt||!Rt.cellStyles)){Tt.s={},Tt.s.patternType=xt.patternType;var zt;(zt=vu(M(xt.icvFore)))&&(Tt.s.fgColor={rgb:zt}),(zt=vu(M(xt.icvBack)))&&(Tt.s.bgColor={rgb:zt})}},re=function(et,Tt,Rt){if(!(Y>1)&&!(Rt.sheetRows&&et.r>=Rt.sheetRows)){if(Rt.cellStyles&&Tt.XF&&Tt.XF.data&&ee(et,Tt,Rt),delete Tt.ixfe,delete Tt.XF,p=et,x=yt(et),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),et.r<i.s.r&&(i.s.r=et.r),et.c<i.s.c&&(i.s.c=et.c),et.r+1>i.e.r&&(i.e.r=et.r+1),et.c+1>i.e.c&&(i.e.c=et.c+1),Rt.cellFormula&&Tt.f){for(var xt=0;xt<F.length;++xt)if(!(F[xt][0].s.c>et.c||F[xt][0].s.r>et.r)&&!(F[xt][0].e.c<et.c||F[xt][0].e.r<et.r)){Tt.F=kt(F[xt][0]),(F[xt][0].s.c!=et.c||F[xt][0].s.r!=et.r)&&delete Tt.f,Tt.f&&(Tt.f=""+Gn(F[xt][1],i,et,ae,q));break}}Rt.dense?(a[et.r]||(a[et.r]=[]),a[et.r][et.c]=Tt):a[x]=Tt}},q={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(q.password=t.password);var se,Te=[],Be=[],Z=[],ie=[],Qe=!1,ae=[];ae.SheetNames=q.snames,ae.sharedf=q.sharedf,ae.arrayf=q.arrayf,ae.names=[],ae.XTI=[];var Le=0,Y=0,Q=0,K=[],P=[],z;q.codepage=1200,uA(1200);for(var ce=!1;e.l<e.length-1;){var Ce=e.l,he=e.read_shift(2);if(he===0&&Le===10)break;var de=e.l===e.length?0:e.read_shift(2),ne=tx[he];if(ne&&ne.f){if(t.bookSheets&&Le===133&&he!==133)break;if(Le=he,ne.r===2||ne.r==12){var Ee=e.read_shift(2);if(de-=2,!q.enc&&Ee!==he&&((Ee&255)<<8|Ee>>8)!==he)throw new Error("rt mismatch: "+Ee+"!="+he);ne.r==12&&(e.l+=10,de-=10)}var R={};if(he===10?R=ne.f(e,de,q):R=uq(he,ne,e,de,q),Y==0&&[9,521,1033,2057].indexOf(Le)===-1)continue;switch(he){case 34:r.opts.Date1904=k.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(q.enc||(e.l=0),q.enc=R,!t.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=R;break;case 66:var Re=Number(R);switch(Re){case 21010:Re=1200;break;case 32768:Re=1e4;break;case 32769:Re=1252;break}uA(q.codepage=Re),ce=!0;break;case 317:q.rrtabid=R;break;case 25:q.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:q.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(a["!type"]="dialog"),R.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),R.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(R);break;case 430:ae.push([R]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(R);break;case 24:case 536:z={Name:R.Name,Ref:Gn(R.rgce,i,null,ae,q)},R.itab>0&&(z.Sheet=R.itab-1),ae.names.push(z),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(P[R.itab-1]={ref:kt(R.rgce[0][0][1][2])});break;case 22:q.ExternCount=R;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(R),ae.XTI=ae.XTI.concat(R);break;case 2196:if(q.biff<8)break;z!=null&&(z.Comment=R[1]);break;case 18:a["!protect"]=R;break;case 19:R!==0&&q.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,q.snames.push(R.name);break;case 10:{if(--Y)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=kt(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ge=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=kt(i),i.e.r=Ge}i.e.r++,i.e.c++}Te.length>0&&(a["!merges"]=Te),Be.length>0&&(a["!objects"]=Be),Z.length>0&&(a["!cols"]=Z),ie.length>0&&(a["!rows"]=ie),k.Sheets.push(G)}f===""?d=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[he]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),q.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(q.biff=5,ce=!0,uA(q.codepage=28591)),q.biff==8&&R.BIFFVer==0&&R.dt==16&&(q.biff=2),Y++)break;if(a=t.dense?[]:{},q.biff<8&&!ce&&(ce=!0,uA(q.codepage=t.codepage||1252)),q.biff<5||R.BIFFVer==0&&R.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:e.l-de,name:f};s[Ze.pos]=Ze,q.snames.push(f)}else f=(s[Ce]||{name:""}).name;R.dt==32&&(a["!type"]="chart"),R.dt==64&&(a["!type"]="macro"),Te=[],Be=[],q.arrayf=F=[],Z=[],ie=[],Qe=!1,G={Hidden:(s[Ce]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[R.r]||[])[R.c]:a[yt({c:R.c,r:R.r})])&&++R.c,_={ixfe:R.ixfe,XF:I[R.ixfe]||{},v:R.val,t:"n"},Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:R.c,r:R.r},_,t);break;case 5:case 517:_={ixfe:R.ixfe,XF:I[R.ixfe],v:R.val,t:R.t},Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:R.c,r:R.r},_,t);break;case 638:_={ixfe:R.ixfe,XF:I[R.ixfe],v:R.rknum,t:"n"},Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:R.c,r:R.r},_,t);break;case 189:for(var st=R.c;st<=R.C;++st){var He=R.rkrec[st-R.c][0];_={ixfe:He,XF:I[He],v:R.rkrec[st-R.c][1],t:"n"},Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:st,r:R.r},_,t)}break;case 6:case 518:case 1030:{if(R.val=="String"){l=R;break}if(_=Qf(R.val,R.cell.ixfe,R.tt),_.XF=I[_.ixfe],t.cellFormula){var it=R.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var wt=it[0][0][1][0],nr=it[0][0][1][1],Yt=yt({r:wt,c:nr});S[Yt]?_.f=""+Gn(R.formula,i,R.cell,ae,q):_.F=((t.dense?(a[wt]||[])[nr]:a[Yt])||{}).F}else _.f=""+Gn(R.formula,i,R.cell,ae,q)}Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re(R.cell,_,t),l=R}break;case 7:case 519:if(l)l.val=R,_=Qf(R,l.cell.ixfe,"s"),_.XF=I[_.ixfe],t.cellFormula&&(_.f=""+Gn(l.formula,i,l.cell,ae,q)),Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re(l.cell,_,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(R);var Mr=yt(R[0].s);if(y=t.dense?(a[R[0].s.r]||[])[R[0].s.c]:a[Mr],t.cellFormula&&y){if(!l||!Mr||!y)break;y.f=""+Gn(R[1],i,R[0],ae,q),y.F=kt(R[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!l)break;S[yt(l.cell)]=R[0],y=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[yt(l.cell)],(y||{}).f=""+Gn(R[0],i,p,ae,q)}}break;case 253:_=Qf(u[R.isst].t,R.ixfe,"s"),u[R.isst].h&&(_.h=u[R.isst].h),_.XF=I[_.ixfe],Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:R.c,r:R.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:R.ixfe,XF:I[R.ixfe],t:"z"},Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:R.c,r:R.r},_,t));break;case 190:if(t.sheetStubs)for(var un=R.c;un<=R.C;++un){var dt=R.ixfe[un-R.c];_={ixfe:dt,XF:I[dt],t:"z"},Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:un,r:R.r},_,t)}break;case 214:case 516:case 4:_=Qf(R.val,R.ixfe,"s"),_.XF=I[_.ixfe],Q>0&&(_.z=K[_.ixfe>>8&63]),TA(_,t,r.opts.Date1904),re({c:R.c,r:R.r},_,t);break;case 0:case 512:Y===1&&(i=R);break;case 252:u=R;break;case 1054:if(q.biff==4){K[Q++]=R[1];for(var ue=0;ue<Q+163&&vt[ue]!=R[1];++ue);ue>=163&&os(R[1],Q+163)}else os(R[1],R[0]);break;case 30:{K[Q++]=R;for(var We=0;We<Q+163&&vt[We]!=R;++We);We>=163&&os(R,Q+163)}break;case 229:Te=Te.concat(R);break;case 93:Be[R.cmo[0]]=q.lastobj=R;break;case 438:q.lastobj.TxO=R;break;case 127:q.lastobj.ImData=R;break;case 440:for(T=R[0].s.r;T<=R[0].e.r;++T)for(E=R[0].s.c;E<=R[0].e.c;++E)y=t.dense?(a[T]||[])[E]:a[yt({c:E,r:T})],y&&(y.l=R[1]);break;case 2048:for(T=R[0].s.r;T<=R[0].e.r;++T)for(E=R[0].s.c;E<=R[0].e.c;++E)y=t.dense?(a[T]||[])[E]:a[yt({c:E,r:T})],y&&y.l&&(y.l.Tooltip=R[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;y=t.dense?(a[R[0].r]||[])[R[0].c]:a[yt(R[0])];var _t=Be[R[2]];y||(t.dense?(a[R[0].r]||(a[R[0].r]=[]),y=a[R[0].r][R[0].c]={t:"z"}):y=a[yt(R[0])]={t:"z"},i.e.r=Math.max(i.e.r,R[0].r),i.s.r=Math.min(i.s.r,R[0].r),i.e.c=Math.max(i.e.c,R[0].c),i.s.c=Math.min(i.s.c,R[0].c)),y.c||(y.c=[]),C={a:R[1],t:_t.TxO.t},y.c.push(C)}break;case 2173:Zj(I[R.ixfe],R.ext);break;case 125:{if(!q.cellStyles)break;for(;R.e>=R.s;)Z[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},Qe||(Qe=!0,tv(R.w/256)),Ai(Z[R.e+1])}break;case 520:{var ft={};R.level!=null&&(ie[R.r]=ft,ft.level=R.level),R.hidden&&(ie[R.r]=ft,ft.hidden=!0),R.hpt&&(ie[R.r]=ft,ft.hpt=R.hpt,ft.hpx=Bl(R.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Yi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[he]]=R;break;case 161:a["!margins"]||Yi(a["!margins"]={}),a["!margins"].header=R.header,a["!margins"].footer=R.footer;break;case 574:R.RTL&&(k.Views[0].RTL=!0);break;case 146:U=R;break;case 2198:se=R;break;case 140:N=R;break;case 442:f?G.CodeName=R||G.name:k.WBProps.CodeName=R||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+he.toString(16)),e.l+=de}return r.SheetNames=jr(s).sort(function(Bt,et){return Number(Bt)-Number(et)}).map(function(Bt){return s[Bt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&P.forEach(function(Bt,et){r.Sheets[r.SheetNames[et]]["!autofilter"]=Bt}),r.Strings=u,r.SSF=Ir(vt),q.enc&&(r.Encryption=q.enc),se&&(r.Themes=se),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),ae.names.length>0&&(k.Names=ae.names),r.Workbook=k,r}var au={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function dq(e,t,r){var n=gt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=F2(n,Wp,au.DSI);for(var s in a)t[s]=a[s]}catch(f){if(r.WTF)throw f}var i=gt.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=F2(i,Jp,au.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(Ub(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function hq(e,t){var r=[],n=[],a=[],s=0,i,l=A2(Wp,"n"),u=A2(Jp,"n");if(e.Props)for(i=jr(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(l,i[s])?r:Object.prototype.hasOwnProperty.call(u,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=jr(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(l,i[s])?r:Object.prototype.hasOwnProperty.call(u,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var f=[];for(s=0;s<a.length;++s)Mb.indexOf(a[s][0])>-1||Fb.indexOf(a[s][0])>-1||a[s][1]!=null&&f.push(a[s]);n.length&&gt.utils.cfb_add(t,"/SummaryInformation",U2(n,au.SI,u,Jp)),(r.length||f.length)&&gt.utils.cfb_add(t,"/DocumentSummaryInformation",U2(r,au.DSI,l,Wp,f.length?f:null,au.UDI))}function N4(e,t){t||(t={}),cv(t),kx(),t.codepage&&Ux(t.codepage);var r,n;if(e.FullPaths){if(gt.find(e,"/encryption"))throw new Error("File is password-protected");r=gt.find(e,"!CompObj"),n=gt.find(e,"/Workbook")||gt.find(e,"/Book")}else{switch(t.type){case"base64":e=Sa(Fa(e));break;case"binary":e=Sa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Nn(e,0),n={content:e}}var a,s;if(r&&lq(r),t.bookProps&&!t.bookSheets)a={};else{var i=Dt?"buffer":"array";if(n&&n.content)a=fq(n.content,t);else if((s=gt.find(e,"PerfectOffice_MAIN"))&&s.content)a=Ji.to_workbook(s.content,(t.type=i,t));else if((s=gt.find(e,"NativeContent_MAIN"))&&s.content)a=Ji.to_workbook(s.content,(t.type=i,t));else throw(s=gt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&gt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=_z(e))}var l={};return e.FullPaths&&dq(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function gq(e,t){var r=t||{},n=gt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gt.utils.cfb_add(n,a,I4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&hq(e,n),r.biff==8&&e.vbaraw&&bz(n,gt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Cu={0:{f:HW},1:{f:XW},2:{f:fJ},3:{f:tJ},4:{f:qW},5:{f:lJ},6:{f:pJ},7:{f:AJ},8:{f:EJ},9:{f:CJ},10:{f:yJ},11:{f:BJ},12:{f:JW},13:{f:hJ},14:{f:nJ},15:{f:ZW},16:{f:E4},17:{f:vJ},18:{f:iJ},19:{f:jx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vY},40:{},42:{},43:{f:pj},44:{f:gj},45:{f:wj},46:{f:Bj},47:{f:yj},48:{},49:{f:G9},50:{},51:{f:rz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Wb},62:{f:mJ},63:{f:uz},64:{f:OJ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:DJ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jW},148:{f:GW,p:16},151:{f:UJ},152:{},153:{f:mY},154:{},155:{},156:{f:hY},157:{},158:{},159:{T:1,f:NK},160:{T:-1},161:{T:1,f:lo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:TJ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ez},336:{T:-1},337:{f:Az,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kJ},427:{f:NJ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QJ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:KW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Bz},633:{T:1},634:{T:-1},635:{T:1,f:wz},636:{T:-1},637:{f:z9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:nY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:PJ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tx={6:{f:jm},10:{f:Ks},12:{f:on},13:{f:on},14:{f:qr},15:{f:qr},16:{f:Kn},17:{f:qr},18:{f:qr},19:{f:on},20:{f:D2},21:{f:D2},23:{f:Xb},24:{f:L2},25:{f:qr},26:{},27:{},28:{f:PV},29:{},34:{f:qr},35:{f:M2},38:{f:Kn},39:{f:Kn},40:{f:Kn},41:{f:Kn},42:{f:qr},43:{f:qr},47:{f:ZK},49:{f:hV},51:{f:on},60:{},61:{f:lV},64:{f:qr},65:{f:dV},66:{f:on},77:{},80:{},81:{},82:{},85:{f:on},89:{},90:{},91:{},92:{f:$G},93:{f:KV},94:{},95:{f:qr},96:{},97:{},99:{f:qr},125:{f:Wb},128:{f:FV},129:{f:eV},130:{f:on},131:{f:qr},132:{f:qr},133:{f:tV},134:{},140:{f:$V},141:{f:on},144:{},146:{f:tK},151:{},152:{},153:{},154:{},155:{},156:{f:on},157:{},158:{},160:{f:oK},161:{f:aK},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:TV},190:{f:SV},193:{f:Ks},197:{},198:{},199:{},200:{},201:{},202:{f:qr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:on},220:{},221:{f:qr},222:{},224:{f:bV},225:{f:qG},226:{f:Ks},227:{},229:{f:GV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:nV},253:{f:mV},255:{f:AV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Lb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qr},353:{f:Ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:QV},431:{f:qr},432:{},433:{},434:{},437:{},438:{f:XV},439:{f:qr},440:{f:WV},441:{},442:{f:Ru},443:{},444:{f:on},445:{},446:{},448:{f:Ks},449:{f:oV,r:2},450:{f:Ks},512:{f:I2},513:{f:iK},515:{f:NV},516:{f:xV},517:{f:R2},519:{f:lK},520:{f:sV},523:{},545:{f:H2},549:{f:N2},566:{},574:{f:uV},638:{f:EV},659:{},1048:{},1054:{f:wV},1084:{},1212:{f:LV},2048:{f:YV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:rK,r:12},2173:{f:$j,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:MV,r:12},2197:{},2198:{f:zj,r:12},2199:{},2200:{},2201:{},2202:{f:HV,r:12},2203:{f:Ks},2204:{},2205:{},2206:{},2207:{},2211:{f:iV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:on},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:AK},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eK},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:I2},1:{},2:{f:hK},3:{f:fK},4:{f:uK},5:{f:R2},7:{f:mK},8:{},9:{f:kf},11:{},22:{f:on},30:{f:BV},31:{},32:{},33:{f:H2},36:{},37:{f:N2},50:{f:pK},62:{},52:{},67:{},68:{f:on},69:{},86:{},126:{},127:{f:cK},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:xK},223:{},234:{},354:{},421:{},518:{f:jm},521:{f:kf},536:{f:L2},547:{f:M2},561:{},579:{},1030:{f:jm},1033:{f:kf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function je(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Gx(r)&&e.push(r)}}function mq(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return je(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],l=0,u=0,f=0;f+(i[l]||8224)<=8224;)f+=i[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f;u<a;){for(d=e.next(4),d.write_shift(2,60),f=0;f+(i[l]||8224)<=8224;)f+=i[l]||8224,l++;d.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f}}}function Hu(e,t,r){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function pq(e,t,r,n){var a=be(9);return Hu(a,e,t),Hb(r,n||"b",a),a}function xq(e,t,r){var n=be(8+2*r.length);return Hu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function vq(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?mn(Nr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?je(e,2,gK(r,n,a)):je(e,3,dK(r,n,a));return;case"b":case"e":je(e,5,pq(r,n,t.v,t.t));return;case"s":case"str":je(e,4,xq(r,n,(t.v||"").slice(0,255)));return}je(e,1,Hu(null,r,n))}function wq(e,t,r,n){var a=Array.isArray(t),s=$t(t["!ref"]||"A1"),i,l="",u=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=kt(s)}for(var f=s.s.r;f<=s.e.r;++f){l=Zr(f);for(var d=s.s.c;d<=s.e.c;++d){f===s.s.r&&(u[d]=Hr(d)),i=u[d]+l;var p=a?(t[f]||[])[d]:t[i];p&&vq(e,p,f,d)}}}function yq(e,t){for(var r=t||{},n=fa(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return je(n,r.biff==4?1033:r.biff==3?521:9,$x(e,16,r)),wq(n,e.Sheets[e.SheetNames[a]],a,r),je(n,10),n.end()}function Bq(e,t,r){je(e,49,gV({sz:12,name:"Arial"},r))}function Cq(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&je(e,1054,yV(a,t[a],r))})}function Eq(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),je(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Kb($t(t["!ref"]||"A1"),r),r.write_shift(4,4),je(e,2152,r)}function Tq(e,t){for(var r=0;r<16;++r)je(e,224,Q2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){je(e,224,Q2(n,0,t))})}function Sq(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];je(e,440,JV(n)),n[1].Tooltip&&je(e,2048,qV(n))}delete t["!links"]}function _q(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&je(e,125,nK(th(a,n),a))})}}function bq(e,t,r,n,a){var s=16+di(a.cellXfs,t,a);if(t.v==null&&!t.bf){je(e,513,to(r,n,s));return}if(t.bf)je(e,6,eW(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?mn(Nr(t.v)):t.v;je(e,515,IV(r,n,i,s));break;case"b":case"e":je(e,517,kV(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var l=sv(a.Strings,t.v,a.revStrings);je(e,253,pV(r,n,l,s))}else je(e,516,vV(r,n,(t.v||"").slice(0,255),s,a));break;default:je(e,513,to(r,n,s))}}function Fq(e,t,r){var n=fa(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[e]||{},u=Array.isArray(s),f=t.biff==8,d,p="",x=[],y=$t(s["!ref"]||"A1"),C=f?65536:16384;if(y.e.c>255||y.e.r>=C){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,C-1)}je(n,2057,$x(r,16,t)),je(n,13,Wa(1)),je(n,12,Wa(100)),je(n,15,ea(!0)),je(n,17,ea(!1)),je(n,16,Zi(.001)),je(n,95,ea(!0)),je(n,42,ea(!1)),je(n,43,ea(!1)),je(n,130,Wa(1)),je(n,128,UV()),je(n,131,ea(!1)),je(n,132,ea(!1)),f&&_q(n,s["!cols"]),je(n,512,CV(y,t)),f&&(s["!links"]=[]);for(var E=y.s.r;E<=y.e.r;++E){p=Zr(E);for(var T=y.s.c;T<=y.e.c;++T){E===y.s.r&&(x[T]=Hr(T)),d=x[T]+p;var S=u?(s[E]||[])[T]:s[d];S&&(bq(n,S,E,T,t),f&&S.l&&s["!links"].push([d,S.l]))}}var F=l.CodeName||l.name||a;return f&&je(n,574,fV((i.Views||[])[0])),f&&(s["!merges"]||[]).length&&je(n,229,VV(s["!merges"])),f&&Sq(n,s),je(n,442,Ob(F)),f&&Eq(n,s),je(n,10),n.end()}function Uq(e,t,r){var n=fa(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},l=r.biff==8,u=r.biff==5;if(je(n,2057,$x(e,5,r)),r.bookType=="xla"&&je(n,135),je(n,225,l?Wa(1200):null),je(n,193,kG(2)),u&&je(n,191),u&&je(n,192),je(n,226),je(n,92,ZG("SheetJS",r)),je(n,66,Wa(l?1200:1252)),l&&je(n,353,Wa(0)),l&&je(n,448),je(n,317,sK(e.SheetNames.length)),l&&e.vbaraw&&je(n,211),l&&e.vbaraw){var f=i.CodeName||"ThisWorkbook";je(n,442,Ob(f))}je(n,156,Wa(17)),je(n,25,ea(!1)),je(n,18,ea(!1)),je(n,19,Wa(0)),l&&je(n,431,ea(!1)),l&&je(n,444,Wa(0)),je(n,61,cV()),je(n,64,ea(!1)),je(n,141,Wa(0)),je(n,34,ea(oY(e)=="true")),je(n,14,ea(!0)),l&&je(n,439,ea(!1)),je(n,218,Wa(0)),Bq(n,e,r),Cq(n,e.SSF,r),Tq(n,r),l&&je(n,352,ea(!1));var d=n.end(),p=fa();l&&je(p,140,ZV()),l&&r.Strings&&mq(p,252,aV(r.Strings)),je(p,10);var x=p.end(),y=fa(),C=0,E=0;for(E=0;E<e.SheetNames.length;++E)C+=(l?12:11)+(l?2:1)*e.SheetNames[E].length;var T=d.length+C+x.length;for(E=0;E<e.SheetNames.length;++E){var S=s[E]||{};je(y,133,rV({pos:T,hs:S.Hidden||0,dt:0,name:e.SheetNames[E]},r)),T+=t[E].length}var F=y.end();if(C!=F.length)throw new Error("BS8 "+C+" != "+F.length);var _=[];return d.length&&_.push(d),F.length&&_.push(F),x.length&&_.push(x),Bn(_)}function kq(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ir(vt)),e&&e.SSF&&(Ul(),Wd(e.SSF),r.revssf=Yd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uv(r),r.cellXfs=[],di(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Fq(a,r,e);return n.unshift(Uq(e,n,r)),Bn(n)}function I4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=da(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return kq(e,t);case 4:case 3:case 2:return yq(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function J2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,l=s&&s.index||e.length,u=g9(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,p=0,x=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},C=[];for(i=0;i<u.length;++i){var E=u[i].trim(),T=E.slice(0,3).toLowerCase();if(T=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(T!="<td"&&T!="<th")){var S=E.split(/<\/t[dh]>/i);for(l=0;l<S.length;++l){var F=S[l].trim();if(F.match(/<t[dh]/i)){for(var _=F,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var I=0;I<C.length;++I){var U=C[I];U.s.c==d&&U.s.r<f&&f<=U.e.r&&(d=U.e.c+1,I=-1)}var k=Ct(F.slice(0,F.indexOf(">")));x=k.colspan?+k.colspan:1,((p=+k.rowspan)>1||x>1)&&C.push({s:{r:f,c:d},e:{r:f+(p||1)-1,c:d+x-1}});var G=k.t||k["data-t"]||"";if(!_.length){d+=x;continue}if(_=nb(_),y.s.r>f&&(y.s.r=f),y.e.r<f&&(y.e.r=f),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!_.length){d+=x;continue}var M={t:"s",v:_};r.raw||!_.trim().length||G=="s"||(_==="TRUE"?M={t:"b",v:!0}:_==="FALSE"?M={t:"b",v:!1}:isNaN(gA(_))?isNaN(wl(_).getDate())||(M={t:"d",v:Nr(_)},r.cellDates||(M={t:"n",v:mn(M.v)}),M.z=r.dateNF||vt[14]):M={t:"n",v:gA(_)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=M):n[yt({r:f,c:d})]=M,d+=x}}}}return n["!ref"]=kt(y),C.length&&(n["!merges"]=C),n}function Nq(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>i)&&!(a[f].e.r<r||a[f].e.c<i)){if(a[f].s.r<r||a[f].s.c<i){l=-1;break}l=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(l<0)){var d=yt({r,c:i}),p=n.dense?(e[r]||[])[i]:e[d],x=p&&p.v!=null&&(p.h||Hx(p.w||(ds(p),p.w)||""))||"",y={};l>1&&(y.rowspan=l),u>1&&(y.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+p.l.Target+'">'+x+"</a>")),y.id=(n.id||"sjs")+"-"+d,s.push(Ke("td",x,y))}}var C="<tr>";return C+s.join("")+"</tr>"}var Iq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Qq="</body></html>";function Rq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return fi(J2(r[0],t),t);var n=hv();return r.forEach(function(a,s){gv(n,J2(a,t),"Sheet"+(s+1))}),n}function Dq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Q4(e,t){var r=t||{},n=r.header!=null?r.header:Iq,a=r.footer!=null?r.footer:Qq,s=[n],i=da(e["!ref"]);r.dense=Array.isArray(e),s.push(Dq(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)s.push(Nq(e,i,l,r));return s.push("</table>"+a),s.join("")}function R4(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Or(n.origin):n.origin;a=i.r,s=i.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=da(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),a==-1&&(f.e.r=a=d.e.r+1)}var p=[],x=0,y=e["!rows"]||(e["!rows"]=[]),C=0,E=0,T=0,S=0,F=0,_=0;for(e["!cols"]||(e["!cols"]=[]);C<l.length&&E<u;++C){var N=l[C];if(Y2(N)){if(n.display)continue;y[E]={hidden:!0}}var I=N.children;for(T=S=0;T<I.length;++T){var U=I[T];if(!(n.display&&Y2(U))){var k=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):nb(U.innerHTML),G=U.getAttribute("data-z")||U.getAttribute("z");for(x=0;x<p.length;++x){var M=p[x];M.s.c==S+s&&M.s.r<E+a&&E+a<=M.e.r&&(S=M.e.c+1-s,x=-1)}_=+U.getAttribute("colspan")||1,((F=+U.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:E+a,c:S+s},e:{r:E+a+(F||1)-1,c:S+s+(_||1)-1}});var ee={t:"s",v:k},re=U.getAttribute("data-t")||U.getAttribute("t")||"";k!=null&&(k.length==0?ee.t=re||"z":n.raw||k.trim().length==0||re=="s"||(k==="TRUE"?ee={t:"b",v:!0}:k==="FALSE"?ee={t:"b",v:!1}:isNaN(gA(k))?isNaN(wl(k).getDate())||(ee={t:"d",v:Nr(k)},n.cellDates||(ee={t:"n",v:mn(ee.v)}),ee.z=n.dateNF||vt[14]):ee={t:"n",v:gA(k)})),ee.z===void 0&&G!=null&&(ee.z=G);var q="",se=U.getElementsByTagName("A");if(se&&se.length)for(var Te=0;Te<se.length&&!(se[Te].hasAttribute("href")&&(q=se[Te].getAttribute("href"),q.charAt(0)!="#"));++Te);q&&q.charAt(0)!="#"&&(ee.l={Target:q}),n.dense?(e[E+a]||(e[E+a]=[]),e[E+a][S+s]=ee):e[yt({c:S+s,r:E+a})]=ee,f.e.c<S+s&&(f.e.c=S+s),S+=_}}++E}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,E-1+a),e["!ref"]=kt(f),E>=u&&(e["!fullref"]=kt((f.e.r=l.length-C+E-1+a,f))),e}function D4(e,t){var r=t||{},n=r.dense?[]:{};return R4(n,e,t)}function Mq(e,t){return fi(D4(e,t),t)}function Y2(e){var t="",r=Lq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Lq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Hq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=qt(t.replace(/<[^>]*>/g,""));return[r]}var q2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function M4(e,t){var r=t||{},n=Ox(e),a=[],s,i,l={name:""},u="",f=0,d,p,x={},y=[],C=r.dense?[]:{},E,T,S={value:""},F="",_=0,N=[],I=-1,U=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},G=0,M={},ee=[],re={},q=0,se=0,Te=[],Be=1,Z=1,ie=[],Qe={Names:[]},ae={},Le=["",""],Y=[],Q={},K="",P=0,z=!1,ce=!1,Ce=0;for(pu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=pu.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?C["!ref"]=kt(k):C["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(C["!fullref"]=C["!ref"],k.e.r=r.sheetRows-1,C["!ref"]=kt(k)),ee.length&&(C["!merges"]=ee),Te.length&&(C["!rows"]=Te),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),x[d.name]=C,ce=!1):E[0].charAt(E[0].length-2)!=="/"&&(d=Ct(E[0],!1),I=U=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,C=r.dense?[]:{},ee=[],Te=[],ce=!0);break;case"table-row-group":E[1]==="/"?--G:++G;break;case"table-row":case"":if(E[1]==="/"){I+=Be,Be=1;break}if(p=Ct(E[0],!1),p.?I=p.-1:I==-1&&(I=0),Be=+p["number-rows-repeated"]||1,Be<10)for(Ce=0;Ce<Be;++Ce)G>0&&(Te[I+Ce]={level:G});U=-1;break;case"covered-table-cell":E[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(C[I]||(C[I]=[]),C[I][U]={t:"z"}):C[yt({r:I,c:U})]={t:"z"}),F="",N=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++U,S=Ct(E[0],!1),Z=parseInt(S["number-columns-repeated"]||"1",10),T={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(T.f=z2(qt(S.formula))),(S.||S["value-type"])=="string"&&(T.t="s",T.v=qt(S["string-value"]||""),r.dense?(C[I]||(C[I]=[]),C[I][U]=T):C[yt({r:I,c:U})]=T),U+=Z-1;else if(E[1]!=="/"){++U,F="",_=0,N=[],Z=1;var he=Be?I+Be-1:I;if(U>k.e.c&&(k.e.c=U),U<k.s.c&&(k.s.c=U),I<k.s.r&&(k.s.r=I),he>k.e.r&&(k.e.r=he),S=Ct(E[0],!1),Y=[],Q={},T={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=qt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(q=parseInt(S["number-matrix-rows-spanned"],10)||0,se=parseInt(S["number-matrix-columns-spanned"],10)||0,re={s:{r:I,c:U},e:{r:I+q-1,c:U+se-1}},T.F=kt(re),ie.push([re,T.F])),S.formula)T.f=z2(S.formula);else for(Ce=0;Ce<ie.length;++Ce)I>=ie[Ce][0].s.r&&I<=ie[Ce][0].e.r&&U>=ie[Ce][0].s.c&&U<=ie[Ce][0].e.c&&(T.F=ie[Ce][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(q=parseInt(S["number-rows-spanned"],10)||0,se=parseInt(S["number-columns-spanned"],10)||0,re={s:{r:I,c:U},e:{r:I+q-1,c:U+se-1}},ee.push(re)),S["number-columns-repeated"]&&(Z=parseInt(S["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=kr(S["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(S.value);break;case"percentage":T.t="n",T.v=parseFloat(S.value);break;case"currency":T.t="n",T.v=parseFloat(S.value);break;case"date":T.t="d",T.v=Nr(S["date-value"]),r.cellDates||(T.t="n",T.v=mn(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=f9(S["time-value"])/86400,r.cellDates&&(T.t="d",T.v=qd(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(S.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",S["string-value"]!=null&&(F=qt(S["string-value"]),N=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(z=!1,T.t==="s"&&(T.v=F||"",N.length&&(T.R=N),z=_==0),ae.Target&&(T.l=ae),Y.length>0&&(T.c=Y,Y=[]),F&&r.cellText!==!1&&(T.w=F),z&&(T.t="z",delete T.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var de=0;de<Be;++de){if(Z=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(C[I+de]||(C[I+de]=[]),C[I+de][U]=de==0?T:Ir(T);--Z>0;)C[I+de][U+Z]=Ir(T);else for(C[yt({r:I+de,c:U})]=T;--Z>0;)C[yt({r:I+de,c:U+Z})]=Ir(T);k.e.c<=U&&(k.e.c=U)}Z=parseInt(S["number-columns-repeated"]||"1",10),U+=Z-1,Z=0,T={},F="",N=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((s=a.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((s=a.pop())[0]!==E[3])throw"Bad state: "+s;Q.t=F,N.length&&(Q.R=N),Q.a=K,Y.push(Q)}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);K="",P=0,F="",_=0,N=[];break;case"creator":E[1]==="/"?K=n.slice(P,E.index):P=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((s=a.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);F="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(M[l.name]=u,(s=a.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&(u="",l=Ct(E[0],!1),a.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ct(E[0],!1),u+=q2[E[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ct(E[0],!1),u+=q2[E[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,E.index);break}else f=E.index+E[0].length;break;case"named-range":i=Ct(E[0],!1),Le=zm(i["cell-range-address"]);var ne={Name:i.name,Ref:Le[0]+"!"+Le[1]};ce&&(ne.Sheet=y.length),Qe.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(E[1]==="/"&&(!S||!S["string-value"])){var Ee=Hq(n.slice(_,E.index));F=(F.length>0?F+`
`:"")+Ee[0]}else Ct(E[0],!1),_=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{Le=zm(Ct(E[0])["target-range-address"]),x[Le[0]]["!autofilter"]={ref:Le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ae=Ct(E[0],!1),!ae.href)break;ae.Target=qt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Le=zm(ae.Target.slice(1)),ae.Target="#"+Le[0]+"!"+Le[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var R={Sheets:x,SheetNames:y,Workbook:Qe};return r.bookSheets&&delete R.Sheets,R}function $2(e,t){t=t||{},Xa(e,"META-INF/manifest.xml")&&fG(sn(e,"META-INF/manifest.xml"),t);var r=_a(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=M4(Br(r),t);return Xa(e,"meta.xml")&&(n.Props=_b(sn(e,"meta.xml"))),n}function Z2(e,t){return M4(e,t)}var Oq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+mu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return en+t}})(),eT=(function(){var e=function(s){return mr(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,l){var u=[];u.push('      <table:table table:name="'+mr(i.SheetNames[l])+`" table:style-name="ta1">
`);var f=0,d=0,p=da(s["!ref"]||"A1"),x=s["!merges"]||[],y=0,C=Array.isArray(s);if(s["!cols"])for(d=0;d<=p.e.c;++d)u.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var E="",T=s["!rows"]||[];for(f=0;f<p.s.r;++f)E=T[f]?' table:style-name="ro'+T[f].ods+'"':"",u.push("        <table:table-row"+E+`></table:table-row>
`);for(;f<=p.e.r;++f){for(E=T[f]?' table:style-name="ro'+T[f].ods+'"':"",u.push("        <table:table-row"+E+`>
`),d=0;d<p.s.c;++d)u.push(t);for(;d<=p.e.c;++d){var S=!1,F={},_="";for(y=0;y!=x.length;++y)if(!(x[y].s.c>d)&&!(x[y].s.r>f)&&!(x[y].e.c<d)&&!(x[y].e.r<f)){(x[y].s.c!=d||x[y].s.r!=f)&&(S=!0),F["table:number-columns-spanned"]=x[y].e.c-x[y].s.c+1,F["table:number-rows-spanned"]=x[y].e.r-x[y].s.r+1;break}if(S){u.push(r);continue}var N=yt({r:f,c:d}),I=C?(s[f]||[])[d]:s[N];if(I&&I.f&&(F["table:formula"]=mr(sW(I.f)),I.F&&I.F.slice(0,N.length)==N)){var U=da(I.F);F["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,F["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!I){u.push(t);continue}switch(I.t){case"b":_=I.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=I.v?"true":"false";break;case"n":_=I.w||String(I.v||0),F["office:value-type"]="float",F["office:value"]=I.v||0;break;case"s":case"str":_=I.v==null?"":I.v,F["office:value-type"]="string";break;case"d":_=I.w||Nr(I.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=Nr(I.v).toISOString(),F["table:style-name"]="ce1";break;default:u.push(t);continue}var k=e(_);if(I.l&&I.l.Target){var G=I.l.Target;G=G.charAt(0)=="#"?"#"+iW(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),k=Ke("text:a",k,{"xlink:href":G.replace(/&/g,"&amp;")})}u.push("          "+Ke("table:table-cell",Ke("text:p",k,{}),F)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var p=f["!cols"][d];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ai(p),p.ods=l;var x=f["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++l}}});var u=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=u;var p=f["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,l){var u=[en],f=mu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=mu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(u.push("<office:document"+f+d+`>
`),u.push(Sb().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),a(u,i),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)u.push(n(i.Sheets[i.SheetNames[p]],i,p));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),l.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function L4(e,t){if(t.bookType=="fods")return eT(e,t);var r=Dx(),n="",a=[],s=[];return n="mimetype",Qt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qt(r,n,eT(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Qt(r,n,Oq(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Qt(r,n,en+Sb()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Qt(r,n,gG(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qt(r,n,dG(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ro(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Br(ui(e))}function Pq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Sa(FA(e))}function Gq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ii(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function tT(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Vq(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Kq(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Eu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function hr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function tr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Eu(e,r),s=a&7;a=Math.floor(a/8);var i=0,l;if(a==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Eu(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var f={data:l,type:s};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Un(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(hr(n*8+a.type)),a.type==2&&t.push(hr(a.data.length)),t.push(a.data))})}),ii(t)}function lv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ka(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Eu(e,n),s=tr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Kr(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=tr(l.data),f=Kr(u[3][0].data);i.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=s[3])!=null&&t[0]&&(i.merge=Kr(s[3][0].data)>>>0>0),r.push(i)}return r}function tl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:hr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:hr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:hr(i.data.length)}],n[2].push({data:Un(i.meta),type:2})});var s=Un(n);t.push(hr(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),ii(t)}function jq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Eu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var u=0,f=0;if(s==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ii(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var d=ii(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ja(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jq(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ii(t)}function rl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=hr(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return ii(t)}function zq(e,t,r,n){var a=ro(e),s=a.getUint32(4,!0),i=(n>1?12:8)+tT(s&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(i,!0),i+=4),i+=tT(s&(n>1?12288:4096))*4,s&16&&(u=a.getUint32(i,!0),i+=4),s&32&&(f=a.getFloat64(i,!0),i+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:r[l]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Xq(e,t,r){var n=ro(e),a=n.getUint32(8,!0),s=12,i=-1,l=-1,u=NaN,f=NaN,d=new Date(2001,0,1);a&1&&(u=Vq(e,s),s+=16),a&2&&(f=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[l]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return p}function Wm(e,t){var r=new Uint8Array(32),n=ro(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Kq(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Jm(e,t){var r=new Uint8Array(32),n=ro(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Wq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return zq(e,t,r,e[0]);case 5:return Xq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function On(e){var t=tr(e);return Eu(t[1][0].data)}function rT(e,t){var r=tr(t.data),n=Kr(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var l=tr(i.data),u=Kr(l[1][0].data)>>>0;switch(n){case 1:s[u]=rx(l[3][0].data);break;case 8:{var f=e[On(l[9][0].data)][0],d=tr(f.data),p=e[On(d[1][0].data)][0],x=Kr(p.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var y=tr(p.data);s[u]=y[3].map(function(C){return rx(C.data)}).join("")}break}}),s}function Jq(e,t){var r,n,a,s,i,l,u,f,d,p,x,y,C,E,T=tr(e),S=Kr(T[1][0].data)>>>0,F=Kr(T[2][0].data)>>>0,_=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&Kr(T[8][0].data)>0||!1,N,I;if((s=(a=T[7])==null?void 0:a[0])!=null&&s.data&&t!=0)N=(l=(i=T[7])==null?void 0:i[0])==null?void 0:l.data,I=(f=(u=T[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(d=T[4])==null?void 0:d[0])!=null&&p.data&&t!=1)N=(y=(x=T[4])==null?void 0:x[0])==null?void 0:y.data,I=(E=(C=T[3])==null?void 0:C[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var U=_?4:1,k=ro(N),G=[],M=0;M<N.length/2;++M){var ee=k.getUint16(M*2,!0);ee<65535&&G.push([M,ee])}if(G.length!=F)throw"Expected ".concat(F," cells, found ").concat(G.length);var re=[];for(M=0;M<G.length-1;++M)re[G[M][0]]=I.subarray(G[M][1]*U,G[M+1][1]*U);return G.length>=1&&(re[G[G.length-1][0]]=I.subarray(G[G.length-1][1]*U)),{R:S,cells:re}}function Yq(e,t){var r,n=tr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Kr(n[7][0].data)>>>0>0?1:0:-1,s=lv(n[5],function(i){return Jq(i,a)});return{nrows:Kr(n[4][0].data)>>>0,data:s.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(u,f){if(i[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));i[l.R][f]=u}),i},[])}}function qq(e,t,r){var n,a=tr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Kr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=kt(s);var i=tr(a[4][0].data),l=rT(e,e[On(i[4][0].data)][0]),u=(n=i[17])!=null&&n[0]?rT(e,e[On(i[17][0].data)][0]):[],f=tr(i[3][0].data),d=0;f[1].forEach(function(p){var x=tr(p.data),y=e[On(x[2][0].data)][0],C=Kr(y.meta[1][0].data);if(C!=6002)throw new Error("6001 unexpected reference to ".concat(C));var E=Yq(e,y);E.data.forEach(function(T,S){T.forEach(function(F,_){var N=yt({r:d+S,c:_}),I=Wq(F,l,u);I&&(r[N]=I)})}),d+=E.nrows})}function $q(e,t){var r=tr(t.data),n={"!ref":"A1"},a=e[On(r[2][0].data)],s=Kr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return qq(e,a[0],n),n}function Zq(e,t){var r,n=tr(t.data),a={name:(r=n[1])!=null&&r[0]?rx(n[1][0].data):"",sheets:[]},s=lv(n[2],On);return s.forEach(function(i){e[i].forEach(function(l){var u=Kr(l.meta[1][0].data);u==6e3&&a.sheets.push($q(e,l))})}),a}function e$(e,t){var r=hv(),n=tr(t.data),a=lv(n[1],On);if(a.forEach(function(s){e[s].forEach(function(i){var l=Kr(i.meta[1][0].data);if(l==2){var u=Zq(e,i);u.sheets.forEach(function(f,d){gv(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ym(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=ja(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var d;try{d=Ka(f)}catch(p){return console.log("## "+(p.message||p))}d.forEach(function(p){s[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Kr(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||i.forEach(function(u){s[u].forEach(function(f){var d=Kr(f.meta[1][0].data)>>>0;if(d==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return e$(s,l)}function t$(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Kr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var u=0,f=ro(e[7][0].data),d=0,p=[],x=ro(e[4][0].data),y=0,C=[],E=0;E<t.length;++E){if(t[E]==null){f.setUint16(E*2,65535,!0),x.setUint16(E*2,65535);continue}f.setUint16(E*2,d,!0),x.setUint16(E*2,y,!0);var T,S;switch(typeof t[E]){case"string":T=Wm({t:"s",v:t[E]},r),S=Jm({t:"s",v:t[E]},r);break;case"number":T=Wm({t:"n",v:t[E]},r),S=Jm({t:"n",v:t[E]},r);break;case"boolean":T=Wm({t:"b",v:t[E]},r),S=Jm({t:"b",v:t[E]},r);break;default:throw new Error("Unsupported value "+t[E])}p.push(T),d+=T.length,C.push(S),y+=S.length,++u}for(e[2][0].data=hr(u);E<e[7][0].data.length/2;++E)f.setUint16(E*2,65535,!0),x.setUint16(E*2,65535,!0);return e[6][0].data=ii(p),e[3][0].data=ii(C),u}function r$(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=da(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(kt(n)));var s=_d(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(K){return K.forEach(function(P){typeof P=="string"&&i.push(P)})});var l={},u=[],f=gt.read(t.numbers,{type:"base64"});f.FileIndex.map(function(K,P){return[K,f.FullPaths[P]]}).forEach(function(K){var P=K[0],z=K[1];if(P.type==2&&P.name.match(/\.iwa/)){var ce=P.content,Ce=ja(ce),he=Ka(Ce);he.forEach(function(de){u.push(de.id),l[de.id]={deps:[],location:z,type:Kr(de.messages[0].meta[1][0].data)}})}}),u.sort(function(K,P){return K-P});var d=u.filter(function(K){return K>1}).map(function(K){return[K,hr(K)]});f.FileIndex.map(function(K,P){return[K,f.FullPaths[P]]}).forEach(function(K){var P=K[0];if(K[1],!!P.name.match(/\.iwa/)){var z=Ka(ja(P.content));z.forEach(function(ce){ce.messages.forEach(function(Ce){d.forEach(function(he){ce.messages.some(function(de){return Kr(de.meta[1][0].data)!=11006&&Gq(de.data,he[1])})&&l[he[0]].deps.push(ce.id)})})})}});for(var p=gt.find(f,l[1].location),x=Ka(ja(p.content)),y,C=0;C<x.length;++C){var E=x[C];E.id==1&&(y=E)}var T=On(tr(y.messages[0].data)[1][0].data);for(p=gt.find(f,l[T].location),x=Ka(ja(p.content)),C=0;C<x.length;++C)E=x[C],E.id==T&&(y=E);for(T=On(tr(y.messages[0].data)[2][0].data),p=gt.find(f,l[T].location),x=Ka(ja(p.content)),C=0;C<x.length;++C)E=x[C],E.id==T&&(y=E);for(T=On(tr(y.messages[0].data)[2][0].data),p=gt.find(f,l[T].location),x=Ka(ja(p.content)),C=0;C<x.length;++C)E=x[C],E.id==T&&(y=E);var S=tr(y.messages[0].data);{S[6][0].data=hr(n.e.r+1),S[7][0].data=hr(n.e.c+1);var F=On(S[46][0].data),_=gt.find(f,l[F].location),N=Ka(ja(_.content));{for(var I=0;I<N.length&&N[I].id!=F;++I);if(N[I].id!=F)throw"Bad ColumnRowUIDMapArchive";var U=tr(N[I].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var k=0;k<=n.e.c;++k){var G=[];G[1]=G[2]=[{type:0,data:hr(k+420690)}],U[1].push({type:2,data:Un(G)}),U[2].push({type:0,data:hr(k)}),U[3].push({type:0,data:hr(k)})}U[4]=[],U[5]=[],U[6]=[];for(var M=0;M<=n.e.r;++M)G=[],G[1]=G[2]=[{type:0,data:hr(M+726270)}],U[4].push({type:2,data:Un(G)}),U[5].push({type:0,data:hr(M)}),U[6].push({type:0,data:hr(M)});N[I].messages[0].data=Un(U)}_.content=rl(tl(N)),_.size=_.content.length,delete S[46];var ee=tr(S[4][0].data);{ee[7][0].data=hr(n.e.r+1);var re=tr(ee[1][0].data),q=On(re[2][0].data);_=gt.find(f,l[q].location),N=Ka(ja(_.content));{if(N[0].id!=q)throw"Bad HeaderStorageBucket";var se=tr(N[0].messages[0].data);for(M=0;M<s.length;++M){var Te=tr(se[2][0].data);Te[1][0].data=hr(M),Te[4][0].data=hr(s[M].length),se[2][M]={type:se[2][0].type,data:Un(Te)}}N[0].messages[0].data=Un(se)}_.content=rl(tl(N)),_.size=_.content.length;var Be=On(ee[2][0].data);_=gt.find(f,l[Be].location),N=Ka(ja(_.content));{if(N[0].id!=Be)throw"Bad HeaderStorageBucket";for(se=tr(N[0].messages[0].data),k=0;k<=n.e.c;++k)Te=tr(se[2][0].data),Te[1][0].data=hr(k),Te[4][0].data=hr(n.e.r+1),se[2][k]={type:se[2][0].type,data:Un(Te)};N[0].messages[0].data=Un(se)}_.content=rl(tl(N)),_.size=_.content.length;var Z=On(ee[4][0].data);(function(){for(var K=gt.find(f,l[Z].location),P=Ka(ja(K.content)),z,ce=0;ce<P.length;++ce){var Ce=P[ce];Ce.id==Z&&(z=Ce)}var he=tr(z.messages[0].data);{he[3]=[];var de=[];i.forEach(function(R,Re){de[1]=[{type:0,data:hr(Re)}],de[2]=[{type:0,data:hr(1)}],de[3]=[{type:2,data:Pq(R)}],he[3].push({type:2,data:Un(de)})})}z.messages[0].data=Un(he);var ne=tl(P),Ee=rl(ne);K.content=Ee,K.size=K.content.length})();var ie=tr(ee[3][0].data);{var Qe=ie[1][0];delete ie[2];var ae=tr(Qe.data);{var Le=On(ae[2][0].data);(function(){for(var K=gt.find(f,l[Le].location),P=Ka(ja(K.content)),z,ce=0;ce<P.length;++ce){var Ce=P[ce];Ce.id==Le&&(z=Ce)}var he=tr(z.messages[0].data);{delete he[6],delete ie[7];var de=new Uint8Array(he[5][0].data);he[5]=[];for(var ne=0,Ee=0;Ee<=n.e.r;++Ee){var R=tr(de);ne+=t$(R,s[Ee],i),R[1][0].data=hr(Ee),he[5].push({data:Un(R),type:2})}he[1]=[{type:0,data:hr(n.e.c+1)}],he[2]=[{type:0,data:hr(n.e.r+1)}],he[3]=[{type:0,data:hr(ne)}],he[4]=[{type:0,data:hr(n.e.r+1)}]}z.messages[0].data=Un(he);var Re=tl(P),Ge=rl(Re);K.content=Ge,K.size=K.content.length})()}Qe.data=Un(ae)}ee[3][0].data=Un(ie)}S[4][0].data=Un(ee)}y.messages[0].data=Un(S);var Y=tl(x),Q=rl(Y);return p.content=Q,p.size=p.content.length,f}function H4(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function cv(e){H4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function uv(e){H4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function n$(e){return Lt.WS.indexOf(e)>-1?"sheet":e==Lt.CS?"chart":e==Lt.DS?"dialog":e==Lt.MS?"macro":e&&e.length?e:"sheet"}function a$(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,n$(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function A$(e,t,r,n,a,s,i,l,u,f,d,p){try{s[n]=eu(_a(e,r,!0),t);var x=sn(e,t),y;switch(l){case"sheet":y=_Y(x,t,a,u,s[n],f,d,p);break;case"chart":if(y=bY(x,t,a,u,s[n],f,d,p),!y||!y["!drawel"])break;var C=Vc(y["!drawel"].Target,t),E=xu(C),T=hz(_a(e,C,!0),eu(_a(e,E,!0),C)),S=Vc(T,C),F=xu(S);y=tY(_a(e,S,!0),S,u,eu(_a(e,F,!0),S),f,y);break;case"macro":y=FY(x,t,a,u,s[n],f,d,p);break;case"dialog":y=UY(x,t,a,u,s[n],f,d,p);break;default:throw new Error("Unrecognized sheet type "+l)}i[n]=y;var _=[];s&&s[n]&&jr(s[n]).forEach(function(N){var I="";if(s[n][N].Type==Lt.CMNT){I=Vc(s[n][N].Target,t);var U=QY(sn(e,I,!0),I,u);if(!U||!U.length)return;P2(y,U,!1)}s[n][N].Type==Lt.TCMNT&&(I=Vc(s[n][N].Target,t),_=_.concat(mz(sn(e,I,!0),u)))}),_&&_.length&&P2(y,_,!0,u.people||[])}catch(N){if(u.WTF)throw N}}function Pa(e){return e.charAt(0)=="/"?e.slice(1):e}function s$(e,t){if(Ul(),t=t||{},cv(t),Xa(e,"META-INF/manifest.xml")||Xa(e,"objectdata.xml"))return $2(e,t);if(Xa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ym<"u"){if(e.FileIndex)return Ym(e);var r=gt.utils.cfb_new();return o2(e).forEach(function(Te){Qt(r,Te,p9(e,Te))}),Ym(r)}throw new Error("Unsupported NUMBERS file")}if(!Xa(e,"[Content_Types].xml"))throw Xa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=o2(e),a=cG(_a(e,"[Content_Types].xml")),s=!1,i,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",sn(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!sn(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(tu=[],a.sst)try{tu=IY(sn(e,Pa(a.sst)),a.sst,t)}catch(Te){if(t.WTF)throw Te}t.cellStyles&&a.themes.length&&(u=NY(_a(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=kY(sn(e,Pa(a.style)),a.style,u,t))}a.links.map(function(Te){try{var Be=eu(_a(e,xu(Pa(Te))),Te);return DY(sn(e,Pa(Te)),Be,Te,t)}catch{}});var d=SY(sn(e,Pa(a.workbooks[0])),a.workbooks[0],t),p={},x="";a.coreprops.length&&(x=sn(e,Pa(a.coreprops[0]),!0),x&&(p=_b(x)),a.extprops.length!==0&&(x=sn(e,Pa(a.extprops[0]),!0),x&&pG(x,p,t)));var y={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=_a(e,Pa(a.custprops[0]),!0),x&&(y=vG(x,t)));var C={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(Be){return Be.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(C.Props=p,C.Custprops=y),t.bookSheets&&typeof i<"u"&&(C.SheetNames=i),t.bookSheets?C.SheetNames:t.bookProps))return C;i={};var E={};t.bookDeps&&a.calcchain&&(E=RY(sn(e,Pa(a.calcchain)),a.calcchain));var T=0,S={},F,_;{var N=d.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var I=0;I!=N.length;++I)p.SheetNames[I]=N[I].name}var U=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),G=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Xa(e,G)||(G="xl/_rels/workbook."+U+".rels");var M=eu(_a(e,G,!0),G.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=MY(sn(e,Pa(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=xz(sn(e,Pa(a.people[0])),t)),M&&(M=a$(M,d.Sheets));var ee=sn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=p.Worksheets;++T){var re="sheet";if(M&&M[T]?(F="xl/"+M[T][1].replace(/[\/]?xl\//,""),Xa(e,F)||(F=M[T][1]),Xa(e,F)||(F=G.replace(/_rels\/.*$/,"")+M[T][1]),re=M[T][2]):(F="xl/worksheets/sheet"+(T+1-ee)+"."+U,F=F.replace(/sheet0\./,"sheet.")),_=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(T!=t.sheets)continue e;break;case"string":if(p.SheetNames[T].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var q=!1,se=0;se!=t.sheets.length;++se)typeof t.sheets[se]=="number"&&t.sheets[se]==T&&(q=1),typeof t.sheets[se]=="string"&&t.sheets[se].toLowerCase()==p.SheetNames[T].toLowerCase()&&(q=1);if(!q)continue e}}A$(e,F,_,p.SheetNames[T],T,S,i,re,t,d,u,f)}return C={Directory:a,Workbook:d,Props:p,Custprops:y,Deps:E,Sheets:i,SheetNames:p.SheetNames,Strings:tu,Styles:f,Themes:u,SSF:Ir(vt)},t&&t.bookFiles&&(e.files?(C.keys=n,C.files=e.files):(C.keys=[],C.files={},e.FullPaths.forEach(function(Te,Be){Te=Te.replace(/^Root Entry[\/]/,""),C.keys.push(Te),C.files[Te]=e.FileIndex[Be]}))),t&&t.bookVBA&&(a.vba.length>0?C.vbaraw=sn(e,Pa(a.vba[0]),!0):a.defaults&&a.defaults.bin===Sz&&(C.vbaraw=sn(e,"xl/vbaProject.bin",!0))),C}function i$(e,t){var r=t||{},n="Workbook",a=gt.find(e,n);try{if(n="/!DataSpaces/Version",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(MK(a.content),n="/!DataSpaces/DataSpaceMap",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=HK(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=OK(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);GK(a.content)}catch{}if(n="/EncryptionInfo",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=VK(a.content);if(n="/EncryptedPackage",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function o$(e,t){return t.bookType=="ods"?L4(e,t):t.bookType=="numbers"?r$(e,t):t.bookType=="xlsb"?l$(e,t):c$(e,t)}function l$(e,t){ul=1024,e&&!e.SSF&&(e.SSF=Ir(vt)),e&&e.SSF&&(Ul(),Wd(e.SSF),t.revssf=Yd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ru?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=f4.indexOf(t.bookType)>-1,a=Yx();uv(t=t||{});var s=Dx(),i="",l=0;if(t.cellXfs=[],di(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qt(s,i,bb(e.Props,t)),a.coreprops.push(i),gr(t.rels,2,i,Lt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Qt(s,i,kb(e.Props)),a.extprops.push(i),gr(t.rels,3,i,Lt.EXT_PROPS),e.Custprops!==e.Props&&jr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qt(s,i,Nb(e.Custprops)),a.custprops.push(i),gr(t.rels,4,i,Lt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Qt(s,i,HY(l-1,i,t,e,d)),a.sheets.push(i),gr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Lt.WS[0])}if(p){var y=p["!comments"],C=!1,E="";y&&y.length>0&&(E="xl/comments"+l+"."+r,Qt(s,E,GY(y,E)),a.comments.push(E),gr(d,-1,"../comments"+l+"."+r,Lt.CMNT),C=!0),p["!legacy"]&&C&&Qt(s,"xl/drawings/vmlDrawing"+l+".vml",c4(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&Qt(s,xu(i),ml(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qt(s,i,PY(t.Strings,i,t)),a.strs.push(i),gr(t.wbrels,-1,"sharedStrings."+r,Lt.SST)),i="xl/workbook."+r,Qt(s,i,LY(e,i)),a.workbooks.push(i),gr(t.rels,1,i,Lt.WB),i="xl/theme/theme1.xml",Qt(s,i,rv(e.Themes,t)),a.themes.push(i),gr(t.wbrels,-1,"theme/theme1.xml",Lt.THEME),i="xl/styles."+r,Qt(s,i,OY(e,i,t)),a.styles.push(i),gr(t.wbrels,-1,"styles."+r,Lt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Qt(s,i,e.vbaraw),a.vba.push(i),gr(t.wbrels,-1,"vbaProject.bin",Lt.VBA)),i="xl/metadata."+r,Qt(s,i,VY(i)),a.metadata.push(i),gr(t.wbrels,-1,"metadata."+r,Lt.XLMETA),Qt(s,"[Content_Types].xml",Tb(a,t)),Qt(s,"_rels/.rels",ml(t.rels)),Qt(s,"xl/_rels/workbook."+r+".rels",ml(t.wbrels)),delete t.revssf,delete t.ssf,s}function c$(e,t){ul=1024,e&&!e.SSF&&(e.SSF=Ir(vt)),e&&e.SSF&&(Ul(),Wd(e.SSF),t.revssf=Yd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ru?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=f4.indexOf(t.bookType)>-1,a=Yx();uv(t=t||{});var s=Dx(),i="",l=0;if(t.cellXfs=[],di(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qt(s,i,bb(e.Props,t)),a.coreprops.push(i),gr(t.rels,2,i,Lt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Qt(s,i,kb(e.Props)),a.extprops.push(i),gr(t.rels,3,i,Lt.EXT_PROPS),e.Custprops!==e.Props&&jr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qt(s,i,Nb(e.Custprops)),a.custprops.push(i),gr(t.rels,4,i,Lt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var p={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Qt(s,i,C4(l-1,t,e,p)),a.sheets.push(i),gr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Lt.WS[0])}if(x){var C=x["!comments"],E=!1,T="";if(C&&C.length>0){var S=!1;C.forEach(function(F){F[1].forEach(function(_){_.T==!0&&(S=!0)})}),S&&(T="xl/threadedComments/threadedComment"+l+"."+r,Qt(s,T,pz(C,d,t)),a.threadedcomments.push(T),gr(p,-1,"../threadedComments/threadedComment"+l+"."+r,Lt.TCMNT)),T="xl/comments"+l+"."+r,Qt(s,T,u4(C)),a.comments.push(T),gr(p,-1,"../comments"+l+"."+r,Lt.CMNT),E=!0}x["!legacy"]&&E&&Qt(s,"xl/drawings/vmlDrawing"+l+".vml",c4(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&Qt(s,xu(i),ml(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qt(s,i,$b(t.Strings,t)),a.strs.push(i),gr(t.wbrels,-1,"sharedStrings."+r,Lt.SST)),i="xl/workbook."+r,Qt(s,i,b4(e)),a.workbooks.push(i),gr(t.rels,1,i,Lt.WB),i="xl/theme/theme1.xml",Qt(s,i,rv(e.Themes,t)),a.themes.push(i),gr(t.wbrels,-1,"theme/theme1.xml",Lt.THEME),i="xl/styles."+r,Qt(s,i,s4(e,t)),a.styles.push(i),gr(t.wbrels,-1,"styles."+r,Lt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Qt(s,i,e.vbaraw),a.vba.push(i),gr(t.wbrels,-1,"vbaProject.bin",Lt.VBA)),i="xl/metadata."+r,Qt(s,i,l4()),a.metadata.push(i),gr(t.wbrels,-1,"metadata."+r,Lt.XLMETA),d.length>1&&(i="xl/persons/person.xml",Qt(s,i,vz(d)),a.people.push(i),gr(t.wbrels,-1,"persons/person.xml",Lt.PEOPLE)),Qt(s,"[Content_Types].xml",Tb(a,t)),Qt(s,"_rels/.rels",ml(t.rels)),Qt(s,"xl/_rels/workbook."+r+".rels",ml(t.wbrels)),delete t.revssf,delete t.ssf,s}function fv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Fa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function u$(e,t){return gt.find(e,"EncryptedPackage")?i$(e,t):N4(e,t)}function f$(e,t){var r,n=e,a=t||{};return a.type||(a.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),r=eb(n,a),s$(r,a)}function O4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ex(e.slice(r),t);default:break e}return yl.to_workbook(e,t)}function d$(e,t){var r="",n=fv(e,t);switch(t.type){case"base64":r=Fa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$i(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Br(r)),t.type="binary",O4(r,t)}function h$(e,t){var r=e;return t.type=="base64"&&(r=Fa(r)),r=fu.utils.decode(1200,r.slice(2),"str"),t.type="binary",O4(r,t)}function g$(e){return e.match(/[^\x00-\x7F]/)?FA(e):e}function qm(e,t,r,n){return n?(r.type="string",yl.to_workbook(e,r)):yl.to_workbook(t,r)}function nx(e,t){kx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return nx(new Uint8Array(e),(r=Ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xl={},r.dateNF&&(xl.dateNF=r.dateNF),r.type||(r.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Dt?"buffer":"binary",n=l9(e),typeof Uint8Array<"u"&&!Dt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=g$(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=Ir(r),r.type="array",nx(Nx(n),r)}switch((a=fv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return u$(gt.read(n,r),r);break;case 9:if(a[1]<=8)return N4(n,r);break;case 60:return ex(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return wK(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Yb.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?f$(n,r):qm(e,n,r,s);case 239:return a[3]===60?ex(n,r):qm(e,n,r,s);case 255:if(a[1]===254)return h$(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Ji.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ji.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Zp.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return n4.to_workbook(n,r);break;case 10:case 13:case 32:return d$(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vK.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Zp.to_workbook(n,r):qm(e,n,r,s)}function P4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Nu(t.file,gt.write(e,{type:Dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gt.write(e,t)}function m$(e,t){var r=Ir(t||{}),n=o$(e,r);return p$(n,r)}function p$(e,t){var r={},n=Dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?gt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Xd(a))}return t.password&&typeof encrypt_agile<"u"?P4(encrypt_agile(a,t.password),t):t.type==="file"?Nu(t.file,a):t.type=="string"?Br(a):a}function x$(e,t){var r=t||{},n=gq(e,r);return P4(n,r)}function _A(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return du(FA(n));case"binary":return FA(n);case"string":return e;case"file":return Nu(t.file,n,"utf8");case"buffer":return Dt?ms(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):_A(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function v$(e,t){switch(t.type){case"base64":return du(e);case"binary":return e;case"string":return e;case"file":return Nu(t.file,e,"binary");case"buffer":return Dt?ms(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Rf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?du(r):t.type=="string"?Br(r):r;case"file":return Nu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function G4(e,t){kx(),uY(e);var r=Ir(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=G4(e,r);return r.type="array",Xd(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return _A(oq(e,r),r);case"slk":case"sylk":return _A(Jb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return _A(Q4(e.Sheets[e.SheetNames[a]],r),r);case"txt":return v$(V4(e.Sheets[e.SheetNames[a]],r),r);case"csv":return _A(dv(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return _A(Yb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Rf(Zp.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return _A(yl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return _A(n4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return _A(qb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return _A(L4(e,r),r);case"wk1":return Rf(Ji.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Rf(Ji.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Rf(I4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),x$(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return m$(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function w$(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Au(e,t,r){var n={};return n.type="file",n.file=t,w$(n),G4(e,n)}function y$(e,t,r,n,a,s,i,l){var u=Zr(r),f=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!i||e[r])for(var y=t.s.c;y<=t.e.c;++y){var C=i?e[r][y]:e[n[y]+u];if(C===void 0||C.t===void 0){if(f===void 0)continue;s[y]!=null&&(x[s[y]]=f);continue}var E=C.v;switch(C.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+C.t)}if(s[y]!=null){if(E==null)if(C.t=="e"&&E===null)x[s[y]]=null;else if(f!==void 0)x[s[y]]=f;else if(d&&E===null)x[s[y]]=null;else continue;else x[s[y]]=d&&(C.t!=="n"||C.t==="n"&&l.rawNumbers!==!1)?E:ds(C,E,l);E!=null&&(p=!1)}}return{row:x,isempty:p}}function _d(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=$t(d);break;case"number":u=$t(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(a=0);var p=Zr(u.s.r),x=[],y=[],C=0,E=0,T=Array.isArray(e),S=u.s.r,F=0,_={};T&&!e[S]&&(e[S]=[]);var N=f.skipHidden&&e["!cols"]||[],I=f.skipHidden&&e["!rows"]||[];for(F=u.s.c;F<=u.e.c;++F)if(!(N[F]||{}).hidden)switch(x[F]=Hr(F),r=T?e[S][F]:e[x[F]+p],n){case 1:s[F]=F-u.s.c;break;case 2:s[F]=x[F];break;case 3:s[F]=f.header[F-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=ds(r,null,f),E=_[i]||0,!E)_[i]=1;else{do l=i+"_"+E++;while(_[l]);_[i]=E,_[l]=1}s[F]=l}for(S=u.s.r+a;S<=u.e.r;++S)if(!(I[S]||{}).hidden){var U=y$(e,u,S,x,n,s,T,f);(U.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(y[C++]=U.row)}return y.length=C,y}var nT=/"/g;function B$(e,t,r,n,a,s,i,l){for(var u=!0,f=[],d="",p=Zr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var y=l.dense?(e[r]||[])[x]:e[n[x]+p];if(y==null)d="";else if(y.v!=null){u=!1,d=""+(l.rawNumbers&&y.t=="n"?y.v:ds(y,null,l));for(var C=0,E=0;C!==d.length;++C)if((E=d.charCodeAt(C))===a||E===s||E===34||l.forceQuotes){d='"'+d.replace(nT,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(u=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(nT,'""')+'"')):d="";f.push(d)}return l.blankrows===!1&&u?null:f.join(i)}function dv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=$t(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],C=a.s.c;C<=a.e.c;++C)(x[C]||{}).hidden||(p[C]=Hr(C));for(var E=0,T=a.s.r;T<=a.e.r;++T)(y[T]||{}).hidden||(d=B$(e,a,T,p,i,u,s,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((E++?l:"")+d)));return delete n.dense,r.join("")}function V4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=dv(e,t);return r}function C$(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=$t(e["!ref"]),s="",i=[],l,u=[],f=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)i[l]=Hr(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=Zr(d),l=a.s.c;l<=a.e.c;++l)if(t=i[l]+s,r=f?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function K4(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Or(n.origin):n.origin;i=u.r,l=u.c}var f,d={s:{c:0,r:0},e:{c:l,r:i+t.length-1+a}};if(s["!ref"]){var p=$t(s["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),i==-1&&(i=p.e.r+1,d.e.r=i+t.length-1+a)}else i==-1&&(i=0,d.e.r=t.length-1+a);var x=n.header||[],y=0;t.forEach(function(E,T){jr(E).forEach(function(S){(y=x.indexOf(S))==-1&&(x[y=x.length]=S);var F=E[S],_="z",N="",I=yt({c:l+y,r:i+T+a});f=Tu(s,I),F&&typeof F=="object"&&!(F instanceof Date)?s[I]=F:(typeof F=="number"?_="n":typeof F=="boolean"?_="b":typeof F=="string"?_="s":F instanceof Date?(_="d",n.cellDates||(_="n",F=mn(F)),N=n.dateNF||vt[14]):F===null&&n.nullError&&(_="e",F=0),f?(f.t=_,f.v=F,delete f.w,delete f.R,N&&(f.z=N)):s[I]=f={t:_,v:F},N&&(f.z=N))})}),d.e.c=Math.max(d.e.c,l+x.length-1);var C=Zr(i);if(a)for(y=0;y<x.length;++y)s[Hr(y+l)+C]={t:"s",v:x[y]};return s["!ref"]=kt(d),s}function E$(e,t){return K4(null,e,t)}function Tu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Or(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Tu(e,yt(t)):Tu(e,yt({r:t,c:r||0}))}function T$(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function hv(){return{SheetNames:[],Sheets:{}}}function gv(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(_4(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function S$(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=T$(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function _$(e,t){return e.z=t,e}function j4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function b$(e,t,r){return j4(e,"#"+t,r)}function F$(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function U$(e,t,r,n){for(var a=typeof t!="string"?t:$t(t),s=typeof t=="string"?t:kt(t),i=a.s.r;i<=a.e.r;++i)for(var l=a.s.c;l<=a.e.c;++l){var u=Tu(e,i,l);u.t="n",u.F=s,delete u.v,i==a.s.r&&l==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var Hn={encode_col:Hr,encode_row:Zr,encode_cell:yt,encode_range:kt,decode_col:Kx,decode_row:Vx,split_cell:P9,decode_cell:Or,decode_range:da,format_cell:ds,sheet_add_aoa:xb,sheet_add_json:K4,sheet_add_dom:R4,aoa_to_sheet:kl,json_to_sheet:E$,table_to_sheet:D4,table_to_book:Mq,sheet_to_csv:dv,sheet_to_txt:V4,sheet_to_json:_d,sheet_to_html:Q4,sheet_to_formulae:C$,sheet_to_row_object_array:_d,sheet_get_cell:Tu,book_new:hv,book_append_sheet:gv,book_set_sheet_visibility:S$,cell_set_number_format:_$,cell_set_hyperlink:j4,cell_set_internal_link:b$,cell_add_comment:F$,sheet_set_array_formula:U$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),AT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M21.16,3.16a1.2,1.2,0,0,0-.81-.29H3.65A1.2,1.2,0,0,0,2.45,4.07V19.93a1.2,1.2,0,0,0,1.2,1.2h16.7a1.2,1.2,0,0,0,1.2-1.2V4.07a1.2,1.2,0,0,0-.39-.91ZM14.21,12.19,11.83,15a.34.34,0,0,1-.31.18.33.33,0,0,1-.3-.17l-2.4-2.82a.33.33,0,0,1,.24-.53h1.37a.33.33,0,0,1,.3.17l1,1.18,1-1.18a.33.33,0,0,1,.3-.17h1.37a.33.33,0,0,1,.24.53Z"})}),Df=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),sT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),$m=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),iT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),Zm=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),oT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),k$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Mf=({title:e,value:t,icon:r,colorClass:n})=>h.jsxs("div",{className:`p-6 rounded-xl border shadow-sm flex items-center justify-between transition-transform hover:scale-[1.02] ${n}`,children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium opacity-80 uppercase tracking-wide",children:e}),h.jsx("p",{className:"text-3xl font-bold mt-2",children:t})]}),h.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:r})]}),N$=()=>{const{user:e}=ci(),[t,r]=W.useState([]),[n,a]=W.useState([]),[s,i]=W.useState(!0),[l,u]=W.useState([]),[f,d]=W.useState(!0),[p,x]=W.useState(null),[y,C]=W.useState([]),E=W.useRef({}),[T,S]=W.useState("overview"),[F,_]=W.useState(""),[N,I]=W.useState(null),U=W.useRef({}),[k,G]=W.useState([]),[M,ee]=W.useState([]),[re,q]=W.useState({mode:"closed"}),[se,Te]=W.useState(!1),[Be,Z]=W.useState({name:"",rows:"8",cols:"10"}),[ie,Qe]=W.useState(""),[ae,Le]=W.useState({subject:"",studentCount:""}),[Y,Q]=W.useState(""),K=W.useCallback(async()=>{if(!e)return;i(!0);const[ue,We]=await Promise.all([TS(e.id),dH()]);r(ue),a(We),i(!1)},[e]),P=W.useCallback(async()=>{if(!e)return;d(!0);const ue=await pH(e.id);u(ue),d(!1)},[e]),z=W.useCallback(async()=>{if(!e)return;const ue=await CH(e.id);G(ue)},[e]),ce=W.useCallback(async()=>{if(!e)return;const ue=await SH(e.id);ee(ue)},[e]),Ce=W.useCallback(async()=>{if(!e)return;const ue=await ES(e.id);C(ue)},[e]);W.useEffect(()=>{K(),P(),z(),ce(),Ce()},[K,P,z,ce,Ce]);const he=async ue=>{e&&(await hH(ue,e.id),K(),Ce())},de=async ue=>{await gH(ue),K(),Ce()},ne=async(ue,We)=>{e&&window.confirm(`Are you sure you want to permanently delete the account for "${We}"? This action cannot be undone and will also delete all exams created by this teacher.`)&&(await mH(ue,e.id)?(await K(),await P(),await Ce()):alert("Failed to delete teacher. Ensure you have the correct permissions."))},Ee=async ue=>{e&&window.confirm("Are you sure you want to permanently delete this exam? This action cannot be undone.")&&(await SS(ue,e.id,e.role)?((p==null?void 0:p.id)===ue&&x(null),await P(),await Ce()):alert("Failed to delete exam."))},R=async(ue,We)=>{const _t=E.current[ue];if(!_t||!p)return;const ft=_t.style.boxShadow;_t.style.boxShadow="none";const Bt=await Yc(_t,{scale:2,backgroundColor:"#ffffff"});_t.style.boxShadow=ft;const et=Bt.toDataURL("image/png"),Tt=document.createElement("a"),Rt=p.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),xt=We.replace(/[^a-z0-9]/gi,"_").toLowerCase();Tt.download=`${Rt}_${xt}_plan.png`,Tt.href=et,document.body.appendChild(Tt),Tt.click(),document.body.removeChild(Tt)},Re=ue=>{ue.seatingPlan&&(U.current={},I(ue.id))},Ge=ue=>{if(!ue.seatingPlan){alert("This exam does not have a seating plan to export.");return}const We=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),_t=Hn.book_new();ue.halls.forEach(Bt=>{var zr,Sr,nA,ha;const et=ue.seatingPlan[Bt.id];if(!et)return;const Tt=et.reduce((_r,mt)=>Math.max(_r,mt.length),0);let Rt=[];if(We){const _r=[""];for(let mt=0;mt<Tt;mt++)_r.push(`Seat ${mt+1}`),_r.push(`Student ${mt+1}`);Rt.push(_r);for(let mt=0;mt<et.length;mt++){const Lr=[`Row ${mt+1}`];for(let Er=0;Er<Tt;Er++){const ar=(zr=et[mt])==null?void 0:zr[Er];Lr.push(`r${mt+1}-c${Er+1}`),Lr.push(((Sr=ar==null?void 0:ar.student)==null?void 0:Sr.id)||"")}Rt.push(Lr)}}else{const _r=[""];for(let mt=0;mt<Tt;mt++)_r.push(`Col ${mt+1}`);Rt.push(_r);for(let mt=0;mt<et.length;mt++){const Lr=[`Row ${mt+1}`];for(let Er=0;Er<Tt;Er++){const ar=(nA=et[mt])==null?void 0:nA[Er];Lr.push(((ha=ar==null?void 0:ar.student)==null?void 0:ha.id)||"")}Rt.push(Lr)}}const xt=Hn.aoa_to_sheet(Rt),zt=Bt.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Hn.book_append_sheet(_t,xt,zt)});const ft=ue.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Au(_t,`${ft}_seating_plan.xlsx`)},Ze=ue=>{var zr,Sr,nA,ha;if(!p||!p.seatingPlan){alert("Seating plan not available for this hall.");return}const We=p.seatingPlan[ue.id];if(!We)return;const _t=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),ft=Hn.book_new(),Bt=We.reduce((_r,mt)=>Math.max(_r,mt.length),0);let et=[];if(_t){const _r=[""];for(let mt=0;mt<Bt;mt++)_r.push(`Seat ${mt+1}`),_r.push(`Student ${mt+1}`);et.push(_r);for(let mt=0;mt<We.length;mt++){const Lr=[`Row ${mt+1}`];for(let Er=0;Er<Bt;Er++){const ar=(zr=We[mt])==null?void 0:zr[Er];Lr.push(`r${mt+1}-c${Er+1}`),Lr.push(((Sr=ar==null?void 0:ar.student)==null?void 0:Sr.id)||"")}et.push(Lr)}}else{const _r=[""];for(let mt=0;mt<Bt;mt++)_r.push(`Col ${mt+1}`);et.push(_r);for(let mt=0;mt<We.length;mt++){const Lr=[`Row ${mt+1}`];for(let Er=0;Er<Bt;Er++){const ar=(nA=We[mt])==null?void 0:nA[Er];Lr.push(((ha=ar==null?void 0:ar.student)==null?void 0:ha.id)||"")}et.push(Lr)}}const Tt=Hn.aoa_to_sheet(et),Rt=ue.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Hn.book_append_sheet(ft,Tt,Rt);const xt=p.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),zt=ue.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Au(ft,`${xt}_${zt}_plan.xlsx`)},st=async ue=>{re.mode==="create-template"&&ue.name&&e&&(await Kc({name:ue.name,layout:ue.layout},e.id),await z(),Ce()),q({mode:"closed"})},He=async ue=>{if(ue.preventDefault(),!e)return;Qe("");const{name:We,rows:_t,cols:ft}=Be,Bt=parseInt(_t,10),et=parseInt(ft,10);if(!We.trim()){Qe("Template name cannot be empty.");return}if(k.some(Rt=>Rt.name.toLowerCase()===We.trim().toLowerCase())){Qe("A template with this name already exists.");return}if(isNaN(Bt)||Bt<=0||Bt>50||isNaN(et)||et<=0||et>50){Qe("Rows and columns must be numbers between 1 and 50.");return}const Tt=[];for(let Rt=0;Rt<Bt;Rt++)for(let xt=0;xt<et;xt++)Tt.push({id:`seat-${Rt}-${xt}-${Date.now()}`,row:Rt,col:xt,type:"standard"});await Kc({name:We.trim(),layout:Tt},e.id),await z(),Ce(),Te(!1),Z({name:"",rows:"8",cols:"10"})},it=async ue=>{e&&window.confirm("Are you sure you want to delete this hall template? This cannot be undone.")&&(await _S(ue,e.id,e.role)?await z():alert("Failed to delete template. You may not have permission."))},wt=async ue=>{if(ue.preventDefault(),Q(""),!e)return;const{subject:We,studentCount:_t}=ae,ft=parseInt(_t,10);if(!We.trim()){Q("Subject/code cannot be empty.");return}if(isNaN(ft)||ft<=0){Q("Student count must be a positive number.");return}if(M.some(Bt=>Bt.subject.toLowerCase()===We.trim().toLowerCase())){Q("A template with this subject/code already exists.");return}await vp({subject:We.trim(),studentCount:ft},e.id),Le({subject:"",studentCount:""}),await ce(),Ce()},nr=async ue=>{e&&window.confirm("Are you sure you want to delete this student set template? This cannot be undone.")&&(await bS(ue,e.id,e.role)?await ce():alert("Failed to delete template. You may not have permission."))},Yt=l.find(ue=>ue.id===N);W.useEffect(()=>{if(!Yt||!Yt.seatingPlan)return;const ue=setTimeout(async()=>{const We=Object.entries(U.current).filter(([,ft])=>ft!==null);if(We.length!==Yt.halls.length){I(null);return}const _t=We.map(async([ft,Bt])=>{const et=Yt.halls.find(Sr=>Sr.id===ft);if(!Bt||!et)return;Bt.style.boxShadow="none";const Tt=await Yc(Bt,{scale:2,backgroundColor:"#ffffff"});Bt.style.boxShadow="";const Rt=Tt.toDataURL("image/png"),xt=document.createElement("a"),zt=Yt.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),zr=et.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();xt.download=`${zt}_${zr}_plan.png`,xt.href=Rt,document.body.appendChild(xt),xt.click(),document.body.removeChild(xt)});await Promise.all(_t),I(null)},100);return()=>clearTimeout(ue)},[N,Yt]);const Mr=ue=>{var We;return e&&e.id===ue?`${e.name} (Admin)`:((We=[...t].find(_t=>_t.id===ue))==null?void 0:We.name)||"Unknown User"};if(p)return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"min-h-screen",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx(tt,{onClick:()=>x(null),variant:"secondary",children:" Back to Dashboard"}),h.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[p.seatingPlan&&h.jsxs(h.Fragment,{children:[h.jsx(tt,{onClick:()=>Re(p),disabled:!!N,variant:"secondary",className:"flex items-center",children:N===p.id?"Downloading...":h.jsxs(h.Fragment,{children:[h.jsx(aT,{className:"mr-2 h-4 w-4"})," Download PNGs"]})}),h.jsxs(tt,{onClick:()=>Ge(p),className:"flex items-center",children:[h.jsx(AT,{className:"mr-2 h-4 w-4"}),"Download Excel"]})]}),h.jsx(tt,{onClick:()=>Ee(p.id),variant:"danger",children:"Delete Exam"})]})]}),h.jsx(jt,{className:"mb-6",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-bold text-violet-700 dark:text-violet-400",children:p.title}),h.jsxs("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:["Date: ",p.date]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-300",children:"Created by:"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:Mr(p.createdBy)})]})]})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[h.jsxs(jt,{children:[h.jsxs("h4",{className:"text-lg font-semibold mb-3 border-b pb-2 dark:border-slate-700",children:["Halls (",p.halls.length,")"]}),h.jsx("ul",{className:"space-y-2 text-sm",children:p.halls.map(ue=>h.jsxs("li",{className:"flex justify-between p-2 bg-slate-50 dark:bg-slate-700/50 rounded",children:[h.jsx("span",{children:ue.name}),h.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[ue.layout.filter(We=>We.type!=="faculty").length," seats"]})]},ue.id))})]}),h.jsxs(jt,{children:[h.jsxs("h4",{className:"text-lg font-semibold mb-3 border-b pb-2 dark:border-slate-700",children:["Student Sets (",p.studentSets.length,")"]}),h.jsx("ul",{className:"space-y-2 text-sm",children:p.studentSets.map(ue=>h.jsxs("li",{className:"flex justify-between p-2 bg-slate-50 dark:bg-slate-700/50 rounded",children:[h.jsx("span",{children:ue.subject}),h.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[ue.studentCount," students"]})]},ue.id))})]})]}),h.jsx("div",{className:"lg:col-span-2 space-y-8",children:p.seatingPlan?p.halls.map(ue=>h.jsxs(jt,{ref:We=>{We&&(E.current[ue.id]=We)},children:[h.jsx(ou,{hall:ue,plan:p.seatingPlan,studentSets:p.studentSets}),h.jsxs("div",{className:"text-center mt-4 flex justify-center gap-2",children:[h.jsxs(tt,{onClick:()=>R(ue.id,ue.name),variant:"secondary",className:"flex items-center mx-auto !py-1 !px-3 text-sm",children:[h.jsx(aT,{className:"mr-2 h-4 w-4"})," Download PNG"]}),h.jsxs(tt,{onClick:()=>Ze(ue),variant:"secondary",className:"flex items-center mx-auto !py-1 !px-3 text-sm",children:[h.jsx(AT,{className:"mr-2 h-4 w-4"})," Download Excel"]})]})]},ue.id)):h.jsxs(jt,{children:[h.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Seating Arrangement"}),h.jsx("div",{className:"text-center text-slate-500 dark:text-slate-400 py-10",children:h.jsx("p",{children:"No seating plan has been generated for this exam yet."})})]})})]})]})]}),Yt&&Yt.id===p.id&&Yt.seatingPlan&&h.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px",zIndex:-1},children:Yt.halls.map(ue=>h.jsx("div",{ref:We=>{We&&(U.current[ue.id]=We)},style:{width:"800px",padding:"1px"},children:h.jsx(jt,{children:h.jsx(ou,{hall:ue,plan:Yt.seatingPlan,studentSets:Yt.studentSets})})},ue.id))})]});const un=t.filter(ue=>ue.name.toLowerCase().includes(F.toLowerCase())||ue.email.toLowerCase().includes(F.toLowerCase())),dt=l.filter(ue=>ue.title.toLowerCase().includes(F.toLowerCase()));return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(bA,{}),re.mode==="create-template"&&h.jsx(Bp,{isOpen:!0,onClose:()=>q({mode:"closed"}),onSave:st,initialLayout:[],isTemplateCreationMode:!0}),se&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:()=>Te(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md",onClick:ue=>ue.stopPropagation(),children:[h.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Grid Hall Template"}),h.jsxs("form",{onSubmit:He,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Template Name",id:"grid-template-name",value:Be.name,onChange:ue=>Z({...Be,name:ue.target.value}),required:!0,placeholder:"e.g., Small Classroom"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx(Ut,{label:"Rows",id:"grid-template-rows",type:"number",min:"1",max:"50",value:Be.rows,onChange:ue=>Z({...Be,rows:ue.target.value}),required:!0}),h.jsx(Ut,{label:"Columns",id:"grid-template-cols",type:"number",min:"1",max:"50",value:Be.cols,onChange:ue=>Z({...Be,cols:ue.target.value}),required:!0})]}),ie&&h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:ie})]}),h.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[h.jsx(tt,{type:"button",variant:"secondary",onClick:()=>Te(!1),children:"Cancel"}),h.jsx(tt,{type:"submit",children:"Save Template"})]})]})]})}),h.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h2",{className:"text-3xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Admin Dashboard"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Manage your institution's teachers, exams, and templates."})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[h.jsx(Mf,{title:"Active Exams",value:l.length,icon:h.jsx(Zm,{className:"h-6 w-6 text-violet-600 dark:text-violet-300"}),colorClass:"bg-violet-50 border-violet-100 text-violet-900 dark:bg-violet-900/20 dark:border-violet-900/50 dark:text-violet-100"}),h.jsx(Mf,{title:"Managed Teachers",value:t.length,icon:h.jsx($m,{className:"h-6 w-6 text-blue-600 dark:text-blue-300"}),colorClass:"bg-blue-50 border-blue-100 text-blue-900 dark:bg-blue-900/20 dark:border-blue-900/50 dark:text-blue-100"}),h.jsx(Mf,{title:"Templates",value:k.length+M.length,icon:h.jsx(iT,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-300"}),colorClass:"bg-emerald-50 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-900/50 dark:text-emerald-100"}),h.jsx(Mf,{title:"Pending Approvals",value:n.length,icon:h.jsx(sT,{className:"h-6 w-6 text-amber-600 dark:text-amber-300"}),colorClass:"bg-amber-50 border-amber-100 text-amber-900 dark:bg-amber-900/20 dark:border-amber-900/50 dark:text-amber-100"})]}),h.jsx("div",{className:"mb-6 border-b border-slate-200 dark:border-slate-700",children:h.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:["overview","teachers","exams","templates"].map(ue=>h.jsxs("button",{onClick:()=>{S(ue),_("")},className:`
                                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize transition-colors
                                    ${T===ue?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"}
                                `,children:[ue,ue==="teachers"&&n.length>0&&h.jsx("span",{className:"ml-2 bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200 py-0.5 px-2 rounded-full text-xs",children:n.length})]},ue))})}),h.jsxs("div",{className:"space-y-6",children:[T==="overview"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsx("div",{className:"lg:col-span-2",children:h.jsxs(jt,{className:"h-full",children:[h.jsxs("h3",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:[h.jsx(k$,{className:"h-6 w-6 text-violet-500"})," Recent Activity"]}),h.jsx("div",{className:"max-h-[500px] overflow-y-auto pr-2 custom-scrollbar",children:y.length>0?h.jsx("div",{className:"relative border-l-2 border-slate-200 dark:border-slate-700 ml-3 space-y-6 py-2",children:y.map(ue=>h.jsxs("div",{className:"relative pl-6",children:[h.jsx("div",{className:`absolute -left-[9px] top-1 h-4 w-4 rounded-full border-4 border-white dark:border-slate-800 ${ue.role===lt.ADMIN?"bg-red-500":ue.role===lt.TEACHER?"bg-blue-500":"bg-green-500"}`}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-slate-400 mb-0.5 font-mono",children:new Date(ue.timestamp).toLocaleString()}),h.jsxs("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[h.jsx("span",{className:`${ue.role===lt.ADMIN?"text-red-600 dark:text-red-400":ue.role===lt.TEACHER?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400"} font-bold`,children:ue.actorName}),h.jsx("span",{className:"mx-1 text-slate-400",children:""}),ue.action.replace(/_/g," ")]}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:ue.details})]})]},ue.id))}):h.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 py-10 text-sm",children:"No activity logs found."})})]})}),h.jsx("div",{className:"lg:col-span-1",children:h.jsxs(jt,{className:"bg-gradient-to-br from-violet-50 to-white dark:from-slate-800 dark:to-slate-900 border-violet-100 dark:border-slate-700 h-full",children:[h.jsx("h3",{className:"text-lg font-bold mb-4 text-violet-900 dark:text-violet-100",children:"System Health"}),h.jsxs("ul",{className:"space-y-4",children:[h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Total Exams"}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-200",children:l.length})]}),h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Generated Plans"}),h.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:l.filter(ue=>ue.seatingPlan).length})]}),h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Pending Plans"}),h.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:l.filter(ue=>!ue.seatingPlan).length})]}),h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Active Teachers"}),h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:t.length})]})]})]})})]}),T==="teachers"&&h.jsxs("div",{className:"space-y-6",children:[n.length>0&&h.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-800 rounded-xl p-6 shadow-sm",children:[h.jsxs("h4",{className:"text-lg font-bold text-amber-800 dark:text-amber-200 mb-4 flex items-center gap-2",children:[h.jsx("div",{className:"p-1 bg-amber-200 dark:bg-amber-800 rounded-full",children:h.jsx(sT,{className:"h-4 w-4"})}),"Pending Approvals (",n.length,")"]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(ue=>h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-amber-100 dark:border-slate-700 flex flex-col justify-between h-full",children:[h.jsxs("div",{className:"mb-3",children:[h.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200",children:ue.name}),h.jsx("p",{className:"text-sm text-slate-500 break-all",children:ue.email})]}),h.jsxs("div",{className:"flex gap-2 mt-auto",children:[h.jsx(tt,{variant:"primary",className:"flex-1 !py-1.5 !text-sm bg-emerald-600 hover:bg-emerald-700",onClick:()=>he(ue.id),children:"Approve"}),h.jsx(tt,{type:"button",variant:"danger",className:"!py-1.5 !px-3 !text-sm",onClick:We=>{We.stopPropagation(),ne(ue.id,ue.name)},children:"Reject"})]})]},ue.id))})]}),h.jsxs(jt,{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[h.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[h.jsx($m,{className:"h-6 w-6 text-blue-500"})," Active Staff Directory"]}),h.jsxs("div",{className:"relative w-full sm:w-72",children:[h.jsx(Ut,{placeholder:"Search by name or email...",value:F,onChange:ue=>_(ue.target.value),containerClassName:"mb-0",className:"pl-10"}),h.jsx("div",{className:"absolute left-3 top-2.5 text-slate-400",children:h.jsx(oT,{className:"h-5 w-5"})})]})]}),s?h.jsx("p",{className:"text-center py-8",children:"Loading staff data..."}):h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[un.map(ue=>h.jsxs("div",{className:"group relative p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl border border-transparent hover:border-violet-200 dark:hover:border-slate-600 transition-all shadow-sm hover:shadow-md",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center text-sm font-bold text-white flex-shrink-0 shadow-sm ${ue.permissionGranted?"bg-gradient-to-br from-blue-500 to-blue-600":"bg-red-400"}`,children:ue.name.charAt(0)}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200 truncate",title:ue.name,children:ue.name}),h.jsx("p",{className:"text-xs text-slate-500 truncate",title:ue.email,children:ue.email})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-200 dark:border-slate-700",children:[h.jsx("button",{onClick:()=>ue.permissionGranted?de(ue.id):he(ue.id),className:`px-3 py-1 text-xs rounded-md border transition-colors ${ue.permissionGranted?"border-amber-200 text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20":"border-emerald-200 text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20"}`,children:ue.permissionGranted?"Revoke Access":"Grant Access"}),h.jsx("button",{type:"button",onClick:We=>{We.stopPropagation(),ne(ue.id,ue.name)},className:"p-1 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors",title:"Delete Account",children:h.jsx(Df,{className:"h-4 w-4"})})]})]},ue.id)),un.length===0&&h.jsx("p",{className:"col-span-full text-center py-12 text-slate-500 italic",children:"No teachers found matching your search."})]})]})]}),T==="exams"&&h.jsxs(jt,{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[h.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[h.jsx(Zm,{className:"h-6 w-6 text-violet-500"})," Exam Schedules"]}),h.jsxs("div",{className:"relative w-full sm:w-72",children:[h.jsx(Ut,{placeholder:"Search exams by title...",value:F,onChange:ue=>_(ue.target.value),containerClassName:"mb-0",className:"pl-10"}),h.jsx("div",{className:"absolute left-3 top-2.5 text-slate-400",children:h.jsx(oT,{className:"h-5 w-5"})})]})]}),f?h.jsx("p",{className:"text-center py-8",children:"Loading exams..."}):dt.length>0?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:dt.map(ue=>h.jsxs("div",{className:"group relative flex flex-col justify-between p-5 bg-white border border-slate-200 hover:border-violet-300 hover:shadow-lg dark:bg-slate-800 dark:border-slate-700 dark:hover:border-violet-600 rounded-xl transition-all duration-200 cursor-pointer h-full",onClick:()=>x(ue),children:[h.jsxs("div",{className:"mb-4",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("p",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 line-clamp-2",title:ue.title,children:ue.title}),h.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide flex-shrink-0 ${ue.seatingPlan?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-300"}`,children:ue.seatingPlan?"Generated":"Pending"})]}),h.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 space-y-1",children:[h.jsxs("p",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"opacity-70",children:""})," ",ue.date]}),h.jsxs("p",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"opacity-70",children:""})," ",Mr(ue.createdBy)]}),h.jsxs("p",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"opacity-70",children:""})," ",ue.halls.length," Halls"]})]})]}),h.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100 dark:border-slate-700 mt-auto",children:[h.jsx("div",{className:"text-xs text-slate-400 font-medium group-hover:text-violet-500 transition-colors",children:"View Details "}),h.jsx("button",{type:"button",className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",onClick:We=>{We.stopPropagation(),Ee(ue.id)},title:"Delete Exam",children:h.jsx(Df,{className:"h-5 w-5"})})]})]},ue.id))}):h.jsxs("div",{className:"text-center py-16 bg-slate-50 dark:bg-slate-800/50 rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-700",children:[h.jsx(Zm,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:"No exams found matching your criteria."})]})]}),T==="templates"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h.jsxs(jt,{className:"h-full",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[h.jsx(iT,{className:"h-5 w-5 text-emerald-500"})," Hall Layouts"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(tt,{variant:"secondary",className:"!py-1.5 !px-3 text-xs",onClick:()=>{Te(!0),Qe(""),Z({name:"",rows:"8",cols:"10"})},children:"+ New Grid"}),h.jsx(tt,{variant:"secondary",className:"!py-1.5 !px-3 text-xs",onClick:()=>q({mode:"create-template"}),children:"+ Editor"})]})]}),h.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:[k.map(ue=>h.jsx("div",{className:"group relative p-4 bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-700 rounded-lg hover:shadow-md transition-all hover:border-emerald-300",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200",children:ue.name}),h.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[ue.layout.length," seats defined"]}),h.jsxs("p",{className:"text-[10px] text-slate-400 mt-1",children:["Creator: ",Mr(ue.createdBy)]})]}),h.jsx("button",{type:"button",onClick:We=>{We.stopPropagation(),it(ue.id)},className:"text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:"Delete Template",children:h.jsx(Df,{className:"h-4 w-4"})})]})},ue.id)),k.length===0&&h.jsx("p",{className:"text-center text-sm text-slate-500 py-8 italic",children:"No hall templates created yet."})]})]}),h.jsxs(jt,{className:"h-full",children:[h.jsx("div",{className:"flex justify-between items-center mb-6",children:h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[h.jsx($m,{className:"h-5 w-5 text-blue-500"})," Student Sets"]})}),h.jsxs("form",{onSubmit:wt,className:"flex gap-2 mb-6 bg-slate-100 dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:[h.jsx("input",{className:"flex-grow px-3 py-1.5 text-sm rounded border border-slate-300 dark:bg-slate-700 dark:border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none",placeholder:"Subject (e.g. Math 101)",value:ae.subject,onChange:ue=>Le({...ae,subject:ue.target.value})}),h.jsx("input",{type:"number",className:"w-20 px-3 py-1.5 text-sm rounded border border-slate-300 dark:bg-slate-700 dark:border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none",placeholder:"#",value:ae.studentCount,onChange:ue=>Le({...ae,studentCount:ue.target.value})}),h.jsx(tt,{type:"submit",className:"!py-1.5 !px-3 text-sm whitespace-nowrap",children:"Add"})]}),Y&&h.jsx("p",{className:"text-xs text-red-600 mb-3 -mt-4",children:Y}),h.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:[M.map(ue=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-700 rounded-lg hover:shadow-sm transition-all hover:border-blue-300",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-sm text-slate-800 dark:text-slate-200",children:ue.subject}),h.jsxs("p",{className:"text-xs text-slate-500",children:[ue.studentCount," students"]})]}),h.jsx("button",{type:"button",onClick:We=>{We.stopPropagation(),nr(ue.id)},className:"text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:"Delete Template",children:h.jsx(Df,{className:"h-4 w-4"})})]},ue.id)),M.length===0&&h.jsx("p",{className:"text-center text-sm text-slate-500 py-8 italic",children:"No student set templates created yet."})]})]})]})]})]})]})},I$=({label:e,id:t,containerClassName:r="",...n})=>h.jsxs("div",{className:r,children:[e&&h.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:e}),h.jsx("textarea",{id:t,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:placeholder-slate-400 dark:focus:ring-violet-400 dark:focus:border-violet-400",rows:4,...n})]}),Q$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),R$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),D$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),M$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),L$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),H$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),O$=({isOpen:e,onClose:t,onSave:r,initialPlan:n,halls:a,studentSets:s,seatDimensions:i})=>{var Ce;const[l,u]=W.useState(n),[f,d]=W.useState(((Ce=a[0])==null?void 0:Ce.id)||""),[p,x]=W.useState(new Set),[y,C]=W.useState(null),[E,T]=W.useState(null),[S,F]=W.useState([]),[_,N]=W.useState([]),[I,U]=W.useState(-1),[k,G]=W.useState(null);W.useEffect(()=>{var he;if(e){const de={};Object.keys(n).forEach(Ee=>{de[Ee]=n[Ee].map(R=>R.map(Re=>Re?{...Re}:null))}),u(de),d(((he=a[0])==null?void 0:he.id)||""),F([]),x(new Set),G(null);const ne={plan:JSON.parse(JSON.stringify(de)),holdingStudents:[]};N([ne]),U(0)}},[e,n,a]);const M=(he,de)=>{const ne={plan:JSON.parse(JSON.stringify(he)),holdingStudents:JSON.parse(JSON.stringify(de))},Ee=_.slice(0,I+1);Ee.push(ne),Ee.length>50&&Ee.shift(),N(Ee),U(Ee.length-1),u(he),F(de)},ee=W.useCallback(()=>{if(I>0){const he=I-1,de=_[he];u(JSON.parse(JSON.stringify(de.plan))),F(JSON.parse(JSON.stringify(de.holdingStudents))),U(he),x(new Set)}},[_,I]),re=W.useCallback(()=>{if(I<_.length-1){const he=I+1,de=_[he];u(JSON.parse(JSON.stringify(de.plan))),F(JSON.parse(JSON.stringify(de.holdingStudents))),U(he),x(new Set)}},[_,I]);W.useEffect(()=>{const he=de=>{e&&((de.metaKey||de.ctrlKey)&&de.key==="z"?(de.preventDefault(),de.shiftKey?re():ee()):(de.metaKey||de.ctrlKey)&&de.key==="y"&&(de.preventDefault(),re()))};return window.addEventListener("keydown",he),()=>window.removeEventListener("keydown",he)},[e,ee,re]);const q=(he,de,ne)=>`${he}-${de}-${ne}`,se=(he,de,ne,Ee,R)=>{if(he.stopPropagation(),!R){he.shiftKey||x(new Set);return}const Re=q(de,ne,Ee),Ge=new Set(he.shiftKey?p:[]);Ge.has(Re)?Ge.delete(Re):Ge.add(Re),x(Ge)},Te=()=>{x(new Set)},Be=(he,de,ne,Ee,R)=>{const Re=q(de,ne,Ee);p.has(Re)||x(new Set([Re])),C({hallId:de,row:ne,col:Ee,student:R}),T(null),he.dataTransfer.effectAllowed="move",document.body.classList.add("cursor-grabbing")},Z=(he,de)=>{T(de),C(null),x(new Set),he.dataTransfer.effectAllowed="move"},ie=()=>{document.body.classList.remove("cursor-grabbing")},Qe=he=>{he.preventDefault(),he.dataTransfer.dropEffect="move"},ae=(he,de,ne,Ee)=>{var st;he.preventDefault();const R={};Object.keys(l).forEach(He=>{R[He]=l[He].map(it=>it.map(wt=>wt?{...wt}:null))});const Re=R[de];if(!Re)return;const Ge=(st=Re[ne])==null?void 0:st[Ee];if(!Ge)return;let Ze=[...S];if(y){const He=ne-y.row,it=Ee-y.col,wt=[],nr=[],Yt=(dt,ue,We)=>{var _t,ft;return(ft=(_t=R[dt])==null?void 0:_t[ue])==null?void 0:ft[We]};for(const dt of p){const[ue,We,_t]=dt.split("-"),ft=parseInt(We),Bt=parseInt(_t),et=Yt(ue,ft,Bt);if(et&&et.student){wt.push({hallId:ue,row:ft,col:Bt,student:et.student});const Tt=de,Rt=ft+He,xt=Bt+it,zt=Yt(Tt,Rt,xt);if(!zt)return;nr.push({hallId:Tt,row:Rt,col:xt,existingStudent:zt.student})}}const Mr=new Map;wt.forEach((dt,ue)=>{const We=nr[ue];Mr.set(q(We.hallId,We.row,We.col),dt.student),We.existingStudent?wt.some(ft=>ft.hallId===We.hallId&&ft.row===We.row&&ft.col===We.col)||Mr.set(q(dt.hallId,dt.row,dt.col),We.existingStudent):Mr.has(q(dt.hallId,dt.row,dt.col))||Mr.set(q(dt.hallId,dt.row,dt.col),void 0)}),Mr.forEach((dt,ue)=>{const[We,_t,ft]=ue.split("-"),Bt=Yt(We,parseInt(_t),parseInt(ft));Bt&&(dt?Bt.student=dt:delete Bt.student)});const un=new Set;nr.forEach(dt=>{un.add(q(dt.hallId,dt.row,dt.col))}),x(un),M(R,Ze)}else if(E){if(Ge.student){const He=Ge.student;Ze=Ze.filter(it=>it.id!==E.id),Ze.push(He),Ge.student=E}else Ze=Ze.filter(He=>He.id!==E.id),Ge.student=E;M(R,Ze)}C(null),T(null)},Le=he=>{var de,ne;if(he.preventDefault(),y){const Ee={};Object.keys(l).forEach(Ge=>{Ee[Ge]=l[Ge].map(Ze=>Ze.map(st=>st?{...st}:null))});let R=[...S];const Re=[];if(p.size>0)p.forEach(Ge=>{var wt,nr;const[Ze,st,He]=Ge.split("-"),it=(nr=(wt=Ee[Ze])==null?void 0:wt[parseInt(st)])==null?void 0:nr[parseInt(He)];it&&it.student&&(Re.push(it.student),delete it.student)}),x(new Set);else{const Ge=(ne=(de=Ee[y.hallId])==null?void 0:de[y.row])==null?void 0:ne[y.col];Ge&&Ge.student&&(Re.push(Ge.student),delete Ge.student)}Re.length>0&&(R=[...R,...Re]),M(Ee,R)}C(null),T(null)},Y=()=>{if(S.length>0){G(`Cannot save changes! There are ${S.length} students currently unseated in the holding area.`),setTimeout(()=>G(null),5e3);return}r(l),t()},Q=he=>{const de=s.findIndex(ne=>ne.id===he);return de>=0?Js[de%Js.length]:"bg-gray-200"},K=()=>{if(!f)return;const he=l[f],de=new Set;he.forEach((ne,Ee)=>{ne.forEach((R,Re)=>{R&&R.student&&de.add(q(f,Ee,Re))})}),x(de)};if(!e)return null;const P=i!=null&&i.width?`${i.width/16}rem`:"7rem",z=i!=null&&i.height?`${i.height/16}rem`:"4rem",ce=i!=null&&i.fontSize?`${i.fontSize}px`:"0.75rem";return h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex justify-center items-center z-50 p-4",onClick:t,children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full h-full max-w-[95vw] max-h-[95vh] flex flex-col overflow-hidden relative",onClick:he=>he.stopPropagation(),children:[h.jsxs("header",{className:"bg-white dark:bg-slate-900 border-b dark:border-slate-800 flex flex-col sm:flex-row justify-between items-center px-6 py-3 gap-4 shadow-sm z-20",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-2 bg-violet-100 dark:bg-violet-900/30 rounded-lg",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-violet-600 dark:text-violet-400",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Seating Editor"}),h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 hidden sm:block",children:["Drag to move. ",h.jsx("kbd",{className:"bg-slate-200 dark:bg-slate-700 px-1 rounded font-mono",children:"Shift+Click"})," for multi-select."]})]})]}),h.jsx("div",{className:"flex overflow-x-auto max-w-lg p-1 bg-slate-100 dark:bg-slate-800 rounded-lg no-scrollbar",children:a.map(he=>h.jsx("button",{onClick:de=>{de.stopPropagation(),d(he.id)},className:`px-4 py-2 text-sm font-semibold rounded-md transition-all whitespace-nowrap flex-1 ${f===he.id?"bg-white dark:bg-slate-700 text-violet-600 dark:text-violet-400 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:he.name},he.id))}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"flex gap-1 mr-2 border-r dark:border-slate-700 pr-3",children:[h.jsx("button",{onClick:ee,disabled:I<=0,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Undo (Ctrl+Z)",children:h.jsx(L$,{})}),h.jsx("button",{onClick:re,disabled:I>=_.length-1,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Redo (Ctrl+Y)",children:h.jsx(H$,{})})]}),h.jsx(tt,{onClick:t,variant:"secondary",className:"!px-4",children:"Cancel"}),h.jsxs(tt,{onClick:Y,className:"flex items-center !px-5 shadow-lg shadow-violet-500/20",children:[h.jsx(Q$,{})," Save"]})]})]}),h.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[h.jsxs("aside",{className:"w-80 flex-shrink-0 flex flex-col bg-slate-50 dark:bg-slate-800/50 border-r dark:border-slate-800 shadow-inner",children:[h.jsxs("div",{className:"p-4 flex-grow flex flex-col overflow-hidden",children:[h.jsx("div",{className:"flex justify-between items-center mb-2",children:h.jsxs("h3",{className:"font-bold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:["Holding Area",h.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${S.length>0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-slate-200 text-slate-600 dark:bg-slate-700 dark:text-slate-400"}`,children:S.length})]})}),h.jsxs("div",{className:`flex-grow border-2 border-dashed rounded-xl p-3 overflow-y-auto transition-all ${S.length>0?"border-amber-400 bg-amber-50 dark:bg-amber-900/10 dark:border-amber-500/50":"border-slate-300 dark:border-slate-700 bg-slate-100/50 dark:bg-slate-900/30"} hover:border-violet-400 dark:hover:border-violet-500`,onDragOver:Qe,onDrop:Le,children:[h.jsx("div",{className:"grid grid-cols-2 gap-2",children:S.map(he=>h.jsx("div",{draggable:!0,onDragStart:de=>Z(de,he),onDragEnd:ie,className:`
                                                p-2 rounded-lg text-xs text-center font-bold cursor-grab active:cursor-grabbing 
                                                shadow-sm border border-black/5 text-slate-900 hover:shadow-md transition-all 
                                                ${Q(he.setId)}
                                            `,children:he.id},he.id))}),S.length===0&&h.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 gap-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),h.jsx("p",{className:"text-sm font-medium",children:"Drop Students Here"}),h.jsx("p",{className:"text-xs opacity-75 text-center px-4",children:"Drag students off the grid to unseat them temporarily."})]})]})]}),h.jsxs("div",{className:"p-4 border-t dark:border-slate-800 bg-white dark:bg-slate-900/50",children:[h.jsx("h4",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:"Student Sets"}),h.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:s.map((he,de)=>h.jsxs("div",{className:"flex items-center text-xs group",children:[h.jsx("div",{className:`w-3 h-3 rounded-full mr-2 shadow-sm ${Js[de%Js.length]}`}),h.jsx("span",{className:"truncate font-medium text-slate-700 dark:text-slate-300",children:he.subject}),h.jsx("span",{className:"ml-auto text-slate-400 text-[10px] bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:he.studentCount})]},he.id))})]})]}),h.jsxs("main",{className:"flex-grow flex flex-col bg-slate-100 dark:bg-[#0B1120] relative overflow-auto custom-scrollbar",style:{backgroundImage:"radial-gradient(#CBD5E1 1px, transparent 1px)",backgroundSize:"20px 20px"},onClick:Te,children:[h.jsxs("div",{className:"sticky top-4 left-1/2 transform -translate-x-1/2 bg-white/90 dark:bg-slate-800/90 backdrop-blur shadow-lg rounded-full px-4 py-2 flex items-center gap-3 z-30 border dark:border-slate-700 w-max mx-auto",children:[h.jsxs("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mr-2",children:["Selection: ",p.size]}),h.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"}),h.jsx("button",{onClick:K,className:"text-xs font-medium hover:text-violet-600 dark:hover:text-violet-400 transition-colors",children:"Select All"}),h.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"}),h.jsx("button",{onClick:()=>x(new Set),className:"text-xs font-medium hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Clear"})]}),h.jsx("div",{className:"flex-grow flex justify-center items-start min-h-full min-w-full pt-20 pb-40 pl-40 pr-40",children:f&&l[f]&&(()=>{const he=l[f],de=he.reduce((ne,Ee)=>Math.max(ne,Ee.length),0);return h.jsxs("div",{className:"relative grid gap-4 p-12 bg-white dark:bg-slate-800 rounded-2xl shadow-xl border dark:border-slate-700 w-max",style:{gridTemplateColumns:`repeat(${de}, minmax(${P}, 1fr))`},onClick:ne=>ne.stopPropagation(),children:[h.jsx("div",{className:"absolute -inset-8 border-2 border-transparent pointer-events-none rounded-3xl"}),he.map((ne,Ee)=>ne.map((R,Re)=>{var it;if(!R)return h.jsx("div",{style:{height:z,width:P},className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg opacity-50"},`${Ee}-${Re}`);const Ge=!!R.student,Ze=Ge?Q(R.student.setId):"bg-slate-100 dark:bg-slate-700",st=q(f,Ee,Re),He=p.has(st);return h.jsxs("div",{onDragOver:Qe,onDrop:wt=>ae(wt,f,Ee,Re),draggable:Ge,onDragStart:wt=>Ge&&Be(wt,f,Ee,Re,R.student),onDragEnd:ie,onClick:wt=>se(wt,f,Ee,Re,R.student),className:`
                                                            rounded-xl flex flex-col items-center justify-center font-bold
                                                            border transition-all duration-200 relative px-2
                                                            ${Ze}
                                                            ${Ge?"cursor-grab active:cursor-grabbing border-transparent text-slate-900 shadow-sm hover:shadow-md hover:-translate-y-0.5":"border-slate-200 dark:border-slate-600 border-dashed text-slate-300 dark:text-slate-600"}
                                                            ${R.type==="faculty"?"ring-2 ring-yellow-400":""}
                                                            ${R.type==="accessible"?"ring-2 ring-blue-400":""}
                                                            ${He?"ring-4 ring-indigo-500 z-10 shadow-xl scale-105":""}
                                                        `,style:{height:z,width:P,fontSize:ce},title:`R${Ee+1} C${Re+1} ${R.student?`(${R.student.id})`:"Empty"}`,children:[He&&h.jsx("div",{className:"absolute -top-2 -right-2 bg-indigo-600 text-white rounded-full p-0.5 shadow-md",children:h.jsx(R$,{})}),Ge?h.jsx("span",{className:"break-all text-center leading-tight",children:(it=R.student)==null?void 0:it.id}):h.jsxs("span",{className:"text-[10px] font-mono opacity-50",children:[Ee+1,"-",Re+1]})]},`${R.hallId}-${Ee}-${Re}`)}).concat(Array.from({length:de-ne.length}).map((R,Re)=>h.jsx("div",{style:{height:z,width:P}},`pad-${Ee}-${Re}`))))]})})()})]})]}),k&&h.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 z-50 animate-bounce-in",children:h.jsxs("div",{className:"bg-red-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-4 border border-red-500 max-w-md",children:[h.jsx(M$,{}),h.jsxs("div",{className:"flex-grow",children:[h.jsx("h4",{className:"font-bold",children:"Cannot Save Changes"}),h.jsx("p",{className:"text-sm text-red-100",children:k})]}),h.jsx("button",{onClick:()=>G(null),className:"text-red-200 hover:text-white",children:h.jsx(D$,{})})]})})]})})},Lf=e=>{let t=0;e.forEach(s=>{s.students&&s.students.length>0&&s.students.forEach(i=>{i&&i.length>t&&(t=i.length)})});let r=80,n=60,a=12;return t>10&&t<=15?(r=100,n=70,a=11):t>15&&t<=20?(r=120,n=80,a=10):t>20&&(r=140,n=90,a=9),{width:r,height:n,fontSize:a}},P$=e=>{let t=0;return e.studentSets.forEach(r=>{r.students&&r.students.length>0&&r.students.forEach(n=>{n&&n.length>t&&(t=n.length)})}),t},Hf=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),Of=({className:e})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 20 20",fill:"currentColor",children:[h.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),h.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]}),Pf=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),kc=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm1.8 18H14l-2-3.4-2 3.4H8.2l2.9-4.5L8.2 11H10l2 3.4 2-3.4h1.8l-2.9 4.5 2.9 4.5zM13 9V3.5L18.5 9H13z"})}),Di=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Mi=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Li=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6V4m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM12 10v2m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM12 18v2m-6-16v2m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM6 14v6m6-16v6m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM18 6v10m0 2a2 2 0 100 4v0a2 2 0 100-4v0z"})}),Nc=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),ep=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),G$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),V$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),Ga=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),js=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13 0H11"})}),K$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),lT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),cT=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),uT=e=>{if(e.length===0)return{isGrid:!1};let t=-1,r=-1;for(const i of e)i.row>t&&(t=i.row),i.col>r&&(r=i.col);const n=t+1,a=r+1;if(e.length!==n*a)return{isGrid:!1};const s=new Set(e.map(i=>`${i.row},${i.col}`));for(let i=0;i<n;i++)for(let l=0;l<a;l++)if(!s.has(`${i},${l}`))return{isGrid:!1};return{isGrid:!0,rows:n,cols:a}},j$=()=>{var Ou,mo,Il;const{user:e}=ci(),[t,r]=W.useState([]),[n,a]=W.useState([]),[s,i]=W.useState([]),[l,u]=W.useState([]),[f,d]=W.useState(null),[p,x]=W.useState(!0),[y,C]=W.useState(null),[E,T]=W.useState(""),[S,F]=W.useState(""),[_,N]=W.useState(!1),[I,U]=W.useState({mode:"closed",hallIndex:null}),[k,G]=W.useState(!1),[M,ee]=W.useState({name:"",rows:"8",cols:"10"}),[re,q]=W.useState(""),[se,Te]=W.useState({open:!1,index:null}),Be=W.useRef({}),Z=W.useRef([]),[ie,Qe]=W.useState(null),[ae,Le]=W.useState(null),[Y,Q]=W.useState(!1),K=W.useRef({}),[P,z]=W.useState({subject:"",studentCount:""}),[ce,Ce]=W.useState(""),[he,de]=W.useState(null),[ne,Ee]=W.useState(null),[R,Re]=W.useState([]),[Ge,Ze]=W.useState(null),[st,He]=W.useState([]),[it,wt]=W.useState("ai"),[nr,Yt]=W.useState(!1),[Mr,un]=W.useState(!1),[dt,ue]=W.useState({width:80,height:60,fontSize:12}),We={id:"",title:"",date:"",halls:[],studentSets:[],aiSeatingRules:"",seatingType:"normal",editorMode:"ai",createdBy:(e==null?void 0:e.id)||"",adminId:(e==null?void 0:e.adminId)||""};W.useEffect(()=>{if(y&&y.studentSets.length>0){const{width:X,height:le,fontSize:Se}=Lf(y.studentSets);ue({width:X,height:le,fontSize:Se})}},[y]);const _t=W.useCallback(async()=>{if(e){const X=await vH(e.id);r(X)}},[e]),ft=W.useCallback(async()=>{if(e){const X=await BH(e.id);a(X)}},[e]),Bt=W.useCallback(async()=>{if(e){const X=await TH(e.id);i(X)}},[e]),et=W.useCallback(async()=>{if(e&&e.adminId){const X=await TS(e.adminId);u(X)}},[e]);W.useEffect(()=>{(async()=>{if(e!=null&&e.permissionGranted){if(x(!0),await Promise.all([_t(),ft(),Bt(),et()]),e.adminId){const le=await Fu(e.adminId);d(le||null)}x(!1)}else x(!1)})()},[_t,ft,Bt,et,e]);const Tt=X=>{if(X===(e==null?void 0:e.id))return"Me";const le=l.find(Se=>Se.id===X);return le?le.name:"Unknown"},Rt=(X,le)=>{y&&C(Se=>Se?{...Se,[X]:le}:null)},xt=X=>{y&&C(le=>le?{...le,editorMode:X,seatingType:"normal"}:null)},zt=X=>{y&&C(le=>le?{...le,seatingType:X}:null)},zr=(X,le)=>{if(!y)return;const Se=[...y.halls];Se[X]={...Se[X],name:le},C(ke=>ke?{...ke,halls:Se}:null)},Sr=(X,le)=>{if(!y)return;const Se=[...y.halls];Se[X]={...Se[X],frontDirection:le},C(ke=>ke?{...ke,halls:Se}:null)},nA=()=>{if(!y)return;const X=`Hall ${String.fromCharCode(65+y.halls.length)}`,le={id:`new-hall-${Date.now()}`,name:X,layout:[],constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"};C(Se=>Se?{...Se,halls:[...Se.halls,le]}:null)},ha=(X,le)=>{if(y)if(le==="normal"){const Se=[];for(let Je=0;Je<8;Je++)for(let ct=0;ct<10;ct++)Se.push({id:`seat-${Je}-${ct}-${Date.now()}`,row:Je,col:ct,type:"standard"});const Me=[...y.halls];Me[X]={...Me[X],layout:Se},C(Je=>Je?{...Je,halls:Me}:null)}else U({mode:"edit-hall",hallIndex:X})},_r=(X,le,Se)=>{if(!y)return;const ke=uT(y.halls[X].layout);let oe=ke.isGrid?ke.rows:8,Me=ke.isGrid?ke.cols:10;const Je=parseInt(Se,10);if(isNaN(Je)||Je<=0||Je>50)return;le==="rows"?oe=Je:Me=Je;const ct=[];for(let Nt=0;Nt<oe;Nt++)for(let Pt=0;Pt<Me;Pt++)ct.push({id:`seat-${Nt}-${Pt}-${Date.now()}`,row:Nt,col:Pt,type:"standard"});const Et=[...y.halls];Et[X]={...Et[X],layout:ct},C(Nt=>Nt?{...Nt,halls:Et}:null)},mt=X=>{if(!y)return;let le=X.name;y.halls.some(ke=>ke.name===le)&&(le=`${le} (Copy)`);const Se={id:`hall-from-template-${Date.now()}`,name:le,layout:X.layout.map(ke=>({...ke})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"};C(ke=>ke?{...ke,halls:[...ke.halls,Se]}:null)},Lr=async X=>{if(I.mode==="create-template"&&X.name&&e)await Kc({name:X.name,layout:X.layout},e.id),await ft();else if(I.mode==="edit-template"&&I.templateId&&X.name&&e)await EH(I.templateId,{name:X.name,layout:X.layout},e.id),await ft();else if(I.mode==="edit-hall"&&I.hallIndex!==null&&y){const le=I.hallIndex,Se=[...y.halls];Se[le]={...Se[le],layout:X.layout},C(ke=>ke?{...ke,halls:Se}:null)}U({mode:"closed",hallIndex:null})},Er=X=>{y&&C(le=>le?{...le,halls:le.halls.filter((Se,ke)=>ke!==X)}:null)},ar=(X,le)=>{if(!y)return;const Se=[...y.halls],ke=Se[X];let oe={...ke.constraints||{arrangement:"horizontal"},type:le};le==="advanced"&&(oe.allowedSetIds||(oe.allowedSetIds=[]),oe.setLimits||(oe.setLimits={})),Se[X]={...ke,constraints:oe},C(Me=>Me?{...Me,halls:Se}:null)},MA=(X,le)=>{if(!y)return;const Se=[...y.halls],ke=Se[X];Se[X]={...ke,constraints:{...ke.constraints||{type:"no-limit"},arrangement:le}},C(oe=>oe?{...oe,halls:Se}:null)},LA=(X,le)=>{var Je,ct;if(!y)return;const Se=[...y.halls],ke=Se[X],oe=ke.constraints||{type:"no-limit",arrangement:"horizontal"},Me={enabled:le,strategy:((Je=oe.allocation)==null?void 0:Je.strategy)||"linear",linearDirection:((ct=oe.allocation)==null?void 0:ct.linearDirection)||"horizontal"};Se[X]={...ke,constraints:{...oe,allocation:Me}},C(Et=>Et?{...Et,halls:Se}:null)},uo=(X,le)=>{var oe;if(!y)return;const Se=[...y.halls],ke=Se[X];(oe=ke.constraints)!=null&&oe.allocation&&(Se[X]={...ke,constraints:{...ke.constraints,allocation:{...ke.constraints.allocation,strategy:le}}},C(Me=>Me?{...Me,halls:Se}:null))},hi=(X,le)=>{var oe;if(!y)return;const Se=[...y.halls],ke=Se[X];(oe=ke.constraints)!=null&&oe.allocation&&(Se[X]={...ke,constraints:{...ke.constraints,allocation:{...ke.constraints.allocation,linearDirection:le}}},C(Me=>Me?{...Me,halls:Se}:null))},gi=(X,le,Se)=>{var Me;if(!y)return;const ke=[...y.halls],oe=ke[X];if(((Me=oe.constraints)==null?void 0:Me.type)==="advanced"){const Je=oe.constraints.allowedSetIds||[],ct=Se?[...Je,le]:Je.filter(Nt=>Nt!==le),Et={...oe.constraints.setLimits||{}};Se||delete Et[le],ke[X]={...oe,constraints:{...oe.constraints,allowedSetIds:ct,setLimits:Et}},C(Nt=>Nt?{...Nt,halls:ke}:null)}},HA=(X,le,Se)=>{var Me;if(!y)return;const ke=[...y.halls],oe=ke[X];if(((Me=oe.constraints)==null?void 0:Me.type)==="advanced"){const Je={...oe.constraints.setLimits||{}},ct=parseInt(Se,10);!isNaN(ct)&&ct>=0?Je[le]=ct:Se===""&&delete Je[le],ke[X]={...oe,constraints:{...oe.constraints,setLimits:Je}},C(Et=>Et?{...Et,halls:ke}:null)}},fo=(X,le,Se)=>{if(!y)return;const ke=[...y.studentSets];ke[X]={...ke[X],[le]:Se},C(oe=>oe?{...oe,studentSets:ke}:null)},ho=()=>{if(!y)return;const X={id:`new-set-${Date.now()}`,subject:"",studentCount:"",isPlaceholder:!0};C(le=>le?{...le,studentSets:[...le.studentSets,X]}:null)},OA=(X,le,Se)=>{if(!y)return;const ke=[...y.studentSets];if(le==="custom")ke[X]={...ke[X],subject:"",studentCount:"",isPlaceholder:!1};else if(le==="template"&&Se){let oe=Se.subject;y.studentSets.some((Me,Je)=>Je!==X&&Me.subject===oe)&&(oe=`${oe} (Copy)`),ke[X]={...ke[X],subject:oe,studentCount:Se.studentCount,isPlaceholder:!1}}C(oe=>oe?{...oe,studentSets:ke}:null)},go=(X,le)=>{if(!X.target.files||X.target.files.length===0)return;const Se=X.target.files[0],ke=new FileReader;ke.onload=oe=>{var Me;if((Me=oe.target)!=null&&Me.result)try{const Je=nx(oe.target.result,{type:"binary"}),ct=Je.SheetNames[0];if(!ct){T("The Excel file doesn't contain any sheets.");return}const Et=Je.Sheets[ct],Pt=Hn.sheet_to_json(Et,{header:1,defval:"",blankrows:!1}).flat().map(Mt=>String(Mt).trim()).filter(Mt=>Mt!=="");if(Pt.length>0){const Mt={id:`excel-set-${Date.now()}-${ct}`,subject:ct,studentCount:Pt.length,students:Pt,isPlaceholder:!1};C(xn=>{if(!xn)return null;const Xr=[...xn.studentSets];Xr.splice(le,1,Mt);const{width:Wn,height:Jn,fontSize:ir}=Lf(Xr);return ue({width:Wn,height:Jn,fontSize:ir}),{...xn,studentSets:Xr}}),T("")}else T("No student register numbers found in the Excel sheet. The sheet appears to be empty.")}catch(Je){console.error("Error parsing Excel file:",Je),T("There was an error processing the Excel file. Please ensure it is a valid .xlsx or .xls file.")}finally{X.target&&(X.target.value="")}},ke.onerror=oe=>{console.error("FileReader error:",oe),T("Failed to read the file."),X.target&&(X.target.value="")},ke.readAsBinaryString(Se)},mi=X=>{if(!y)return;const le=[...y.studentSets],Se=le[X].id;le[X]={id:Se,subject:"",studentCount:"",isPlaceholder:!0},C(ke=>ke?{...ke,studentSets:le}:null)},vs=X=>{y&&C(le=>le?{...le,studentSets:le.studentSets.filter((Se,ke)=>ke!==X)}:null)},D=async X=>{if(!e||!X.name.trim()||X.layout.length===0)return;const le=X.name.trim();if(!n.some(Se=>Se.name.toLowerCase()===le.toLowerCase())){Ee(X.id);try{await Kc({name:le,layout:X.layout},e.id),await ft(),Re(Se=>[...Se,X.id]),setTimeout(()=>{Re(Se=>Se.filter(ke=>ke!==X.id))},3e3)}catch(Se){console.error("Failed to save hall template:",Se)}finally{Ee(null)}}},j=async X=>{if(X.preventDefault(),!e)return;q("");const{name:le,rows:Se,cols:ke}=M,oe=parseInt(Se,10),Me=parseInt(ke,10);if(!le.trim()){q("Template name cannot be empty.");return}if(n.some(ct=>ct.name.toLowerCase()===le.trim().toLowerCase())){q("A template with this name already exists.");return}if(isNaN(oe)||oe<=0||oe>50||isNaN(Me)||Me<=0||Me>50){q("Rows and columns must be numbers between 1 and 50.");return}const Je=[];for(let ct=0;ct<oe;ct++)for(let Et=0;Et<Me;Et++)Je.push({id:`seat-${ct}-${Et}-${Date.now()}`,row:ct,col:Et,type:"standard"});await Kc({name:le.trim(),layout:Je},e.id),await ft(),G(!1),ee({name:"",rows:"8",cols:"10"})},H=X=>{U({mode:"edit-template",hallIndex:null,templateId:X.id,templateName:X.name})},O=async X=>{e&&window.confirm("Are you sure you want to delete this hall template? This cannot be undone.")&&(await _S(X,e.id,e.role),await ft())},V=async X=>{if(X.preventDefault(),Ce(""),!e)return;const{subject:le,studentCount:Se}=P,ke=parseInt(Se,10);if(!le.trim()){Ce("Subject/code cannot be empty.");return}if(isNaN(ke)||ke<=0){Ce("Student count must be a positive number.");return}if(he)await _H(he,{subject:le.trim(),studentCount:ke},e.id),de(null);else{if(s.some(oe=>oe.subject.toLowerCase()===le.trim().toLowerCase())){Ce("A template with this subject/code already exists.");return}await vp({subject:le.trim(),studentCount:ke},e.id)}z({subject:"",studentCount:""}),await Bt()},J=X=>{z({subject:X.subject,studentCount:X.studentCount.toString()}),de(X.id)},me=()=>{z({subject:"",studentCount:""}),de(null)},Fe=async X=>{if(!e)return;const le=X.subject.trim(),Se=parseInt(String(X.studentCount),10);if(!(!le||isNaN(Se)||Se<=0)&&!s.some(ke=>ke.subject.toLowerCase()===le.toLowerCase())){Ze(X.id);try{await vp({subject:le,studentCount:Se},e.id),await Bt(),He(ke=>[...ke,X.id]),setTimeout(()=>{He(ke=>ke.filter(oe=>oe!==X.id))},3e3)}catch(ke){console.error("Failed to save student set template:",ke)}finally{Ze(null)}}},xe=async X=>{e&&window.confirm("Are you sure you want to delete this student set template? This cannot be undone.")&&(await bS(X,e.id,e.role),he===X&&me(),await Bt())},ve=()=>{if(!y)return null;if(!y.title.trim()||!y.date||y.halls.length===0||y.studentSets.length===0)return T("Please fill in all exam details, and add at least one hall and one student set."),null;if(y.halls.some(X=>X.layout.length===0))return T("One or more halls has an empty layout. Please design a layout for each hall."),null;if(y.studentSets.some(X=>X.isPlaceholder))return T("Please configure all student sets before saving or generating a plan."),null;try{const X=y.studentSets.map(le=>{const Se=parseInt(String(le.studentCount),10);if(isNaN(Se)||Se<=0)throw new Error(`Invalid student count for set "${le.subject}". Please enter a positive number.`);return{id:le.id||`set-${Date.now()}`,subject:le.subject,studentCount:Se,students:le.students}});return{...y,halls:y.halls.map(le=>({...le,id:le.id||`hall-${Date.now()}`})),studentSets:X,id:y.id||void 0,createdBy:y.createdBy||(e==null?void 0:e.id)||"",adminId:y.adminId||(e==null?void 0:e.adminId)||""}}catch(X){return T(X.message),null}},we=async()=>{if(!y||!e)return;T(""),F("");const X=ve();if(X){if(X.id){const le=t.find(Se=>Se.id===X.id);if(le){const Se=JSON.stringify(X.halls)!==JSON.stringify(le.halls),ke=JSON.stringify(X.studentSets)!==JSON.stringify(le.studentSets),oe=X.aiSeatingRules!==le.aiSeatingRules,Me=X.seatingType!==le.seatingType,Je=X.editorMode!==le.editorMode;(Se||ke||oe||Me||Je)&&X.seatingPlan&&(X.seatingPlan=void 0)}}x(!0),X.id?await gm(X):await wH({title:X.title,date:X.date,halls:X.halls,studentSets:X.studentSets,aiSeatingRules:X.aiSeatingRules,seatingType:X.seatingType,editorMode:X.editorMode},e.id),await _t(),x(!1),C(null)}},Oe=async()=>{if(!y)return;T(""),F("");const X=ve();if(!X)return;x(!0);let le;if(y.editorMode==="classic"||y.editorMode==="advanced"?le=await wp({halls:X.halls,studentSets:X.studentSets,seatingType:X.seatingType||"normal"}):le=await yp({halls:X.halls,studentSets:X.studentSets,rules:X.aiSeatingRules||"",seatingType:X.seatingType||"normal",editorMode:X.editorMode}),le.plan){const Se={...X,id:X.id||`exam${Date.now()}`,seatingPlan:le.plan};await gm(Se),await _t();const ke={...y,id:Se.id,seatingPlan:Se.seatingPlan,halls:Se.halls,studentSets:Se.studentSets};C(ke),le.message&&F(le.message)}else T(le.message||"Failed to generate seating plan. Please check your configuration and try again.");x(!1)},Ve=async(X,le)=>{const Se=Be.current[X];if(!Se||!y)return;const ke=Se.style.boxShadow;Se.style.boxShadow="none";const oe=dt.width>100?1.5:2,Me=await Yc(Se,{scale:oe,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0});Se.style.boxShadow=ke;const Je=Me.toDataURL("image/png"),ct=document.createElement("a"),Et=y.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),Nt=le.replace(/[^a-z0-9]/gi,"_").toLowerCase();ct.download=`${Et}_${Nt}_plan.png`,ct.href=Je,document.body.appendChild(ct),ct.click(),document.body.removeChild(ct)},Ye=X=>{var Xr,Wn,Jn,ir;if(!y||!y.seatingPlan){T("Seating plan not generated yet.");return}const le=y.seatingPlan[X.id];if(!le)return;const Se=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),ke=Hn.book_new(),oe=le.reduce((rt,at)=>Math.max(rt,at.length),0),Me=Se?1+oe*2:1+oe;let Je=[];if(Je.push([(f==null?void 0:f.institutionName)||""]),Je.push([X.name]),Se){const rt=[""];for(let at=0;at<oe;at++)rt.push(`Seat ${at+1}`),rt.push(`Student ${at+1}`);Je.push(rt);for(let at=0;at<le.length;at++){const ur=[`Row ${at+1}`];for(let Xt=0;Xt<oe;Xt++){const br=(Xr=le[at])==null?void 0:Xr[Xt];ur.push(`r${at+1}-c${Xt+1}`),ur.push(((Wn=br==null?void 0:br.student)==null?void 0:Wn.id)||"")}Je.push(ur)}}else{const rt=[""];for(let at=0;at<oe;at++)rt.push(`Col ${at+1}`);Je.push(rt);for(let at=0;at<le.length;at++){const ur=[`Row ${at+1}`];for(let Xt=0;Xt<oe;Xt++){const br=(Jn=le[at])==null?void 0:Jn[Xt];ur.push(((ir=br==null?void 0:br.student)==null?void 0:ir.id)||"")}Je.push(ur)}}const ct=new Set;le.forEach(rt=>rt.forEach(at=>{at!=null&&at.student&&ct.add(at.student.setId)}));const Et=y.studentSets.filter(rt=>ct.has(rt.id)).map(rt=>rt.subject).join(", ");Je.push([]),Je.push([`Student Sets: ${Et}`]);const Nt=Hn.aoa_to_sheet(Je);Nt["!merges"]||(Nt["!merges"]=[]),Nt["!merges"].push({s:{r:0,c:0},e:{r:0,c:Me-1}}),Nt["!merges"].push({s:{r:1,c:0},e:{r:1,c:Me-1}});const Pt=X.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Hn.book_append_sheet(ke,Nt,Pt);const Mt=y.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),xn=X.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Au(ke,`${Mt}_${xn}_plan.xlsx`)},Pe=async()=>{if(!(!y||!y.seatingPlan)){Q(!0),T("");for(const X of y.halls){const le=Be.current[X.id];if(!le)continue;const Se=le.style.boxShadow;le.style.boxShadow="none";try{const ke=dt.width>100?1.5:2,Me=(await Yc(le,{scale:ke,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0})).toDataURL("image/png"),Je=document.createElement("a"),ct=y.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),Et=X.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Je.download=`${ct}_${Et}_plan.png`,Je.href=Me,document.body.appendChild(Je),Je.click(),document.body.removeChild(Je),await new Promise(Nt=>setTimeout(Nt,500))}catch(ke){console.error("Error generating PNG for hall:",X.name,ke),T(`Could not generate PNG for ${X.name}.`)}finally{le.style.boxShadow=Se}}Q(!1)}},Xe=()=>{if(!y||!y.seatingPlan){T("Seating plan not generated yet.");return}const X=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?");T("");const le=Hn.book_new();y.halls.forEach(ke=>{var xn,Xr,Wn,Jn;const oe=y.seatingPlan[ke.id];if(!oe)return;const Me=oe.reduce((ir,rt)=>Math.max(ir,rt.length),0),Je=X?1+Me*2:1+Me;let ct=[];if(ct.push([(f==null?void 0:f.institutionName)||""]),ct.push([ke.name]),X){const ir=[""];for(let rt=0;rt<Me;rt++)ir.push(`Seat ${rt+1}`),ir.push(`Student ${rt+1}`);ct.push(ir);for(let rt=0;rt<oe.length;rt++){const at=[`Row ${rt+1}`];for(let ur=0;ur<Me;ur++){const Xt=(xn=oe[rt])==null?void 0:xn[ur];at.push(`r${rt+1}-c${ur+1}`),at.push(((Xr=Xt==null?void 0:Xt.student)==null?void 0:Xr.id)||"")}ct.push(at)}}else{const ir=[""];for(let rt=0;rt<Me;rt++)ir.push(`Col ${rt+1}`);ct.push(ir);for(let rt=0;rt<oe.length;rt++){const at=[`Row ${rt+1}`];for(let ur=0;ur<Me;ur++){const Xt=(Wn=oe[rt])==null?void 0:Wn[ur];at.push(((Jn=Xt==null?void 0:Xt.student)==null?void 0:Jn.id)||"")}ct.push(at)}}const Et=new Set;oe.forEach(ir=>ir.forEach(rt=>{rt!=null&&rt.student&&Et.add(rt.student.setId)}));const Nt=y.studentSets.filter(ir=>Et.has(ir.id)).map(ir=>ir.subject).join(", ");ct.push([]),ct.push([`Student Sets: ${Nt}`]);const Pt=Hn.aoa_to_sheet(ct);Pt["!merges"]||(Pt["!merges"]=[]),Pt["!merges"].push({s:{r:0,c:0},e:{r:0,c:Je-1}}),Pt["!merges"].push({s:{r:1,c:0},e:{r:1,c:Je-1}});const Mt=ke.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Hn.book_append_sheet(le,Pt,Mt)});const Se=y.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Au(le,`${Se}_full_seating_plan.xlsx`)},ot=async X=>{if(!y||!e)return;x(!0),await yH(y.id,X,e.id)?(C(Se=>Se?{...Se,seatingPlan:X}:null),await _t()):T("Failed to save the updated seating plan."),x(!1)},pr=async X=>{e&&window.confirm("Are you sure you want to permanently delete this exam? This action cannot be undone.")&&(x(!0),await SS(X,e.id,e.role),(y==null?void 0:y.id)===X&&C(null),await _t(),x(!1))},lr=X=>{C({...JSON.parse(JSON.stringify(X)),aiSeatingRules:X.aiSeatingRules||"",seatingType:X.seatingType||"normal",editorMode:X.editorMode||"ai"}),T(""),F("");const{width:le,height:Se,fontSize:ke}=Lf(X.studentSets);ue({width:le,height:Se,fontSize:ke})},cr=X=>{C({...We,createdBy:(e==null?void 0:e.id)||"",adminId:(e==null?void 0:e.adminId)||"",editorMode:X,seatingType:"normal"}),T(""),F("")},na=()=>{C(null),T(""),F("")},PA=async X=>{Qe(X.id);let le;if(X.editorMode==="classic"||X.editorMode==="advanced"?le=await wp({halls:X.halls,studentSets:X.studentSets,seatingType:X.seatingType||"normal"}):le=await yp({halls:X.halls,studentSets:X.studentSets,rules:X.aiSeatingRules||"Arrange students fairly.",seatingType:X.seatingType||"normal",editorMode:X.editorMode}),le.plan){const Se={...X,seatingPlan:le.plan};await gm(Se),await _t(),le.message&&window.alert(le.message)}else window.alert(le.message||"Failed to generate seating plan. Not enough seats for all students.");Qe(null)},vA=X=>{K.current={},Le(X.id)},ka=X=>{if(!X.seatingPlan){alert("This exam does not have a seating plan to export.");return}const le=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),Se=Hn.book_new();X.halls.forEach(oe=>{var Xr,Wn,Jn,ir;const Me=X.seatingPlan[oe.id];if(!Me)return;const Je=Me.reduce((rt,at)=>Math.max(rt,at.length),0),ct=le?1+Je*2:1+Je;let Et=[];if(Et.push([(f==null?void 0:f.institutionName)||""]),Et.push([oe.name]),le){const rt=[""];for(let at=0;at<Je;at++)rt.push(`Seat ${at+1}`),rt.push(`Student ${at+1}`);Et.push(rt);for(let at=0;at<Me.length;at++){const ur=[`Row ${at+1}`];for(let Xt=0;Xt<Je;Xt++){const br=(Xr=Me[at])==null?void 0:Xr[Xt];ur.push(`r${at+1}-c${Xt+1}`),ur.push(((Wn=br==null?void 0:br.student)==null?void 0:Wn.id)||"")}Et.push(ur)}}else{const rt=[""];for(let at=0;at<Je;at++)rt.push(`Col ${at+1}`);Et.push(rt);for(let at=0;at<Me.length;at++){const ur=[`Row ${at+1}`];for(let Xt=0;Xt<Je;Xt++){const br=(Jn=Me[at])==null?void 0:Jn[Xt];ur.push(((ir=br==null?void 0:br.student)==null?void 0:ir.id)||"")}Et.push(ur)}}const Nt=new Set;Me.forEach(rt=>rt.forEach(at=>{at!=null&&at.student&&Nt.add(at.student.setId)}));const Pt=X.studentSets.filter(rt=>Nt.has(rt.id)).map(rt=>rt.subject).join(", ");Et.push([]),Et.push([`Student Sets: ${Pt}`]);const Mt=Hn.aoa_to_sheet(Et);Mt["!merges"]||(Mt["!merges"]=[]),Mt["!merges"].push({s:{r:0,c:0},e:{r:0,c:ct-1}}),Mt["!merges"].push({s:{r:1,c:0},e:{r:1,c:ct-1}});const xn=oe.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Hn.book_append_sheet(Se,Mt,xn)});const ke=X.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Au(Se,`${ke}_seating_plan.xlsx`)},fn=t.find(X=>X.id===ae);if(W.useEffect(()=>{if(!fn||!fn.seatingPlan)return;const X=setTimeout(async()=>{const le=Object.entries(K.current).filter(([,ke])=>ke!==null);if(le.length!==fn.halls.length){Le(null);return}const Se=le.map(async([ke,oe])=>{const Me=fn.halls.find(Xr=>Xr.id===ke);if(!oe||!Me)return;oe.style.boxShadow="none";const ct=P$(fn)>15?1.5:2,Et=await Yc(oe,{scale:ct,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0});oe.style.boxShadow="";const Nt=Et.toDataURL("image/png"),Pt=document.createElement("a"),Mt=fn.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),xn=Me.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Pt.download=`${Mt}_${xn}_plan.png`,Pt.href=Nt,document.body.appendChild(Pt),Pt.click(),document.body.removeChild(Pt)});await Promise.all(Se),Le(null)},100);return()=>clearTimeout(X)},[ae,fn]),!(e!=null&&e.permissionGranted))return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(bA,{}),h.jsx("main",{className:"max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-10 border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-red-100 dark:bg-red-900/20 rounded-full mb-6",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),h.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Permission Required"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg leading-relaxed",children:"Your account does not have the necessary permissions to manage exams. Please contact the system administrator to request access."})]})})]});if(p&&!y)return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(bA,{}),h.jsx("main",{className:"max-w-7xl mx-auto py-12 px-4 text-center",children:h.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[h.jsx("div",{className:"animate-spin rounded-full h-14 w-14 border-b-2 border-blue-600 dark:border-blue-400"}),h.jsx("span",{className:"text-lg text-gray-600 dark:text-gray-400 font-medium",children:"Loading exam data..."})]})})]});if(y){const X=!y.id,le=X?null:t.find(oe=>oe.id===y.id),Se=le?JSON.stringify(y)!==JSON.stringify(le):!0,ke=y.studentSets.filter(oe=>!oe.isPlaceholder).map(oe=>({id:oe.id,subject:oe.subject,studentCount:Number(oe.studentCount)||0,students:oe.students}));return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[_&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-start pt-20 z-50 animate-fadeIn",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700",onClick:oe=>oe.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Ga,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Select Hall Template"})]}),h.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:n.length>0?n.map(oe=>h.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Ga,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:oe.name}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[oe.layout.length," seats"]})]})]}),h.jsx(tt,{variant:"primary",size:"sm",className:"!py-2 !px-4 text-sm",onClick:()=>{mt(oe),N(!1)},children:"Add"})]},oe.id)):h.jsxs("div",{className:"text-center py-10",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:h.jsx(Ga,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No hall templates available"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create templates to reuse hall layouts"})]})}),h.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:h.jsx(tt,{onClick:()=>N(!1),variant:"outline",className:"w-full",children:"Cancel"})})]})}),I.mode!=="closed"&&h.jsx(Bp,{isOpen:!0,onClose:()=>U({mode:"closed",hallIndex:null}),onSave:Lr,initialLayout:I.mode==="edit-hall"&&I.hallIndex!==null?(Ou=y.halls[I.hallIndex])==null?void 0:Ou.layout:I.mode==="edit-template"&&I.templateId?(mo=n.find(oe=>oe.id===I.templateId))==null?void 0:mo.layout:[],initialName:I.mode==="edit-template"?I.templateName:void 0,isTemplateCreationMode:I.mode==="create-template"||I.mode==="edit-template"}),se.open&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-start pt-20 z-50 animate-fadeIn",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700",onClick:oe=>oe.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(js,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Select Student Set Template"})]}),h.jsx("button",{onClick:()=>Te({open:!1,index:null}),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:s.length>0?s.map(oe=>h.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(js,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:oe.subject}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[oe.studentCount," students"]})]})]}),h.jsx(tt,{variant:"primary",size:"sm",className:"!py-2 !px-4 text-sm",onClick:()=>{se.index!==null&&OA(se.index,"template",oe),Te({open:!1,index:null})},children:"Add"})]},oe.id)):h.jsxs("div",{className:"text-center py-10",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:h.jsx(js,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No student set templates available"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create templates to reuse student sets"})]})}),h.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:h.jsx(tt,{onClick:()=>Te({open:!1,index:null}),variant:"outline",className:"w-full",children:"Cancel"})})]})}),Mr&&y.seatingPlan&&h.jsx(O$,{isOpen:!0,onClose:()=>un(!1),onSave:ot,initialPlan:y.seatingPlan,halls:y.halls,studentSets:ke,seatDimensions:dt}),h.jsxs("div",{className:"mb-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:X?"Create New Exam":"Edit Exam Configuration"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:X?"Configure your exam schedule and seating arrangements":"Update your existing exam setup"})]}),h.jsx(tt,{onClick:na,variant:"outline",className:"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500",children:" Back to Dashboard"})]}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(cT,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Exam Information"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Enter the basic details for your exam"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Title"}),h.jsx(Ut,{id:"exam-title",placeholder:"e.g., Fall Semester Final Examinations",value:y.title,onChange:oe=>Rt("title",oe.target.value)})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Date"}),h.jsx(Ut,{id:"exam-date",type:"date",value:y.date,onChange:oe=>Rt("date",oe.target.value)})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:h.jsx(Li,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Editor Mode Selection"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose how you want to arrange seating"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[h.jsxs("div",{onClick:()=>xt("ai"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${y.editorMode==="ai"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${y.editorMode==="ai"?"bg-blue-100 dark:bg-blue-800/30 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(Di,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${y.editorMode==="ai"?"text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:"AI Mode"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Natural language instructions"})]})]}),y.editorMode==="ai"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-blue-500 dark:bg-blue-400"})]}),h.jsxs("div",{onClick:()=>xt("ai-advanced"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${y.editorMode==="ai-advanced"?"border-purple-500 bg-purple-50 dark:bg-purple-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${y.editorMode==="ai-advanced"?"bg-purple-100 dark:bg-purple-800/30 text-purple-600 dark:text-purple-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(Nc,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${y.editorMode==="ai-advanced"?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"}`,children:"AI + Advanced"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"AI with hall constraints"})]})]}),y.editorMode==="ai-advanced"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-purple-500 dark:bg-purple-400"})]}),h.jsxs("div",{onClick:()=>xt("advanced"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${y.editorMode==="advanced"?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${y.editorMode==="advanced"?"bg-cyan-100 dark:bg-cyan-800/30 text-cyan-600 dark:text-cyan-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(Li,{className:"w-5 w-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${y.editorMode==="advanced"?"text-cyan-700 dark:text-cyan-300":"text-gray-700 dark:text-gray-300"}`,children:"Advanced Mode"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Manual control with predictable algorithms"})]})]}),y.editorMode==="advanced"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-cyan-500 dark:bg-cyan-400"})]}),h.jsxs("div",{onClick:()=>xt("classic"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${y.editorMode==="classic"?"border-green-500 bg-green-50 dark:bg-green-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${y.editorMode==="classic"?"bg-green-100 dark:bg-green-800/30 text-green-600 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(Mi,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${y.editorMode==="classic"?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:"Classic Mode"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Simple round-robin distribution"})]})]}),y.editorMode==="classic"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-green-500 dark:bg-green-400"})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:h.jsx(lT,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Exam Halls"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure the physical layout and constraints for each examination hall"})]})]}),h.jsx("div",{className:"space-y-6",children:y.halls.map((oe,Me)=>{var xn,Xr,Wn,Jn,ir,rt,at,ur,Xt,br,Ql,po;const Je=n.some(Wt=>Wt.name.toLowerCase()===oe.name.trim().toLowerCase()),ct=ne===oe.id,Et=R.includes(oe.id),Nt=!oe.name.trim(),Pt=uT(oe.layout),Mt=oe.layout.length===0?"placeholder":Pt.isGrid?"normal":"advanced";return h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsxs("div",{className:"flex-grow",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:h.jsx(lT,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),h.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Hall Configuration"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hall Name"}),h.jsx(Ut,{id:`hall-name-${Me}`,value:oe.name,onChange:Wt=>zr(Me,Wt.target.value),placeholder:"e.g., Main Auditorium"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Front Direction"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:["top","bottom","left","right"].map(Wt=>h.jsx("button",{type:"button",onClick:()=>Sr(Me,Wt),className:`px-3 py-2 text-sm font-medium rounded-md transition-all ${(oe.frontDirection||"top")===Wt?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:Wt.charAt(0).toUpperCase()+Wt.slice(1)},Wt))})]})]})]}),h.jsx("button",{type:"button",onClick:()=>Er(Me),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors ml-4",children:h.jsx(Hf,{})})]}),Mt==="placeholder"&&h.jsxs("div",{className:"mb-6 p-6 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 text-center",children:[h.jsx("h5",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-300",children:"Define Hall Layout"}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4 text-sm",children:"Choose how you want to define the seating layout"}),h.jsxs("div",{className:"flex justify-center gap-4",children:[h.jsx(tt,{variant:"outline",onClick:()=>ha(Me,"normal"),className:"!py-3 !px-6",children:"Grid Layout"}),h.jsx(tt,{variant:"outline",onClick:()=>ha(Me,"advanced"),className:"!py-3 !px-6",children:"Advanced Editor"})]})]}),Mt==="normal"&&Pt.isGrid&&h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rows"}),h.jsx(Ut,{type:"number",value:Pt.rows,min:"1",max:"50",onChange:Wt=>_r(Me,"rows",Wt.target.value)})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Columns"}),h.jsx(Ut,{type:"number",value:Pt.cols,min:"1",max:"50",onChange:Wt=>_r(Me,"cols",Wt.target.value)})]})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:h.jsx(js,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),h.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",h.jsxs("span",{className:"font-semibold",children:[oe.layout.filter(Wt=>Wt.type!=="faculty").length," seats"]})]})]}),h.jsx(tt,{variant:"outline",onClick:()=>U({mode:"edit-hall",hallIndex:Me}),size:"sm",children:"Switch to Advanced Editor"})]})]}),Mt==="advanced"&&h.jsx("div",{className:"mb-6",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:h.jsx(js,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),h.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",h.jsxs("span",{className:"font-semibold",children:[oe.layout.filter(Wt=>Wt.type!=="faculty").length," seats"]})]})]}),h.jsx(tt,{variant:"outline",onClick:()=>U({mode:"edit-hall",hallIndex:Me}),size:"sm",children:"Edit Advanced Layout"})]})}),["advanced","ai-advanced"].includes(y.editorMode||"ai")&&h.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-gray-700",children:[h.jsx("h5",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Hall Constraints"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Student Placement"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{type:"button",onClick:()=>ar(Me,"no-limit"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!((xn=oe.constraints)!=null&&xn.type)||((Xr=oe.constraints)==null?void 0:Xr.type)==="no-limit"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"No Restrictions"}),h.jsx("button",{type:"button",onClick:()=>ar(Me,"advanced"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${((Wn=oe.constraints)==null?void 0:Wn.type)==="advanced"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Restricted Sets"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Seating Direction"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{type:"button",onClick:()=>MA(Me,"horizontal"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!((Jn=oe.constraints)!=null&&Jn.arrangement)||oe.constraints.arrangement==="horizontal"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Horizontal"}),h.jsx("button",{type:"button",onClick:()=>MA(Me,"vertical"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${((ir=oe.constraints)==null?void 0:ir.arrangement)==="vertical"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Vertical"})]})]}),h.jsxs("div",{className:"pt-4 border-t border-gray-100 dark:border-gray-700/50",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("label",{className:"block text-sm font-bold text-gray-800 dark:text-gray-200",children:"Allocation Type"}),h.jsx("span",{className:"px-2 py-0.5 bg-violet-100 text-violet-700 dark:bg-violet-900/30 dark:text-violet-300 rounded text-[10px] font-black uppercase tracking-tighter",children:"Optional"})]}),h.jsx("div",{onClick:()=>{var Wt,aA;return LA(Me,!((aA=(Wt=oe.constraints)==null?void 0:Wt.allocation)!=null&&aA.enabled))},className:`w-12 h-6 flex items-center rounded-full p-1 cursor-pointer transition-colors duration-300 ${(at=(rt=oe.constraints)==null?void 0:rt.allocation)!=null&&at.enabled?"bg-violet-600":"bg-gray-300 dark:bg-gray-600"}`,children:h.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform duration-300 ${(Xt=(ur=oe.constraints)==null?void 0:ur.allocation)!=null&&Xt.enabled?"translate-x-6":"translate-x-0"}`})})]}),((Ql=(br=oe.constraints)==null?void 0:br.allocation)==null?void 0:Ql.enabled)&&h.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("button",{type:"button",onClick:()=>uo(Me,"linear"),className:`flex-1 p-3 rounded-lg border-2 text-left transition-all ${oe.constraints.allocation.strategy==="linear"?"border-violet-500 bg-violet-50 dark:bg-violet-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300"}`,children:[h.jsx("p",{className:`text-sm font-bold ${oe.constraints.allocation.strategy==="linear"?"text-violet-700 dark:text-violet-300":"text-gray-700 dark:text-gray-300"}`,children:"Linear"}),h.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:"Continuous alignment in one direction"})]}),h.jsxs("button",{type:"button",onClick:()=>uo(Me,"diagonal"),className:`flex-1 p-3 rounded-lg border-2 text-left transition-all ${oe.constraints.allocation.strategy==="diagonal"?"border-violet-500 bg-violet-50 dark:bg-violet-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300"}`,children:[h.jsx("p",{className:`text-sm font-bold ${oe.constraints.allocation.strategy==="diagonal"?"text-violet-700 dark:text-violet-300":"text-gray-700 dark:text-gray-300"}`,children:"Diagonal"}),h.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:"Cross-aligned zigzag pattern"})]})]}),oe.constraints.allocation.strategy==="linear"&&h.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg animate-fadeIn",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-600 dark:text-gray-400 mb-2 uppercase tracking-widest",children:"Alignment Direction"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{type:"button",onClick:()=>hi(Me,"horizontal"),className:`flex-1 px-4 py-1.5 text-xs font-bold rounded transition-all ${oe.constraints.allocation.linearDirection==="horizontal"?"bg-violet-600 text-white shadow-md":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-600"}`,children:"Horizontal"}),h.jsx("button",{type:"button",onClick:()=>hi(Me,"vertical"),className:`flex-1 px-4 py-1.5 text-xs font-bold rounded transition-all ${oe.constraints.allocation.linearDirection==="vertical"?"bg-violet-600 text-white shadow-md":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-600"}`,children:"Vertical"})]})]})]})]}),((po=oe.constraints)==null?void 0:po.type)==="advanced"&&h.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Allowed Student Sets & Limits"}),y.studentSets.filter(Wt=>!Wt.isPlaceholder).length>0?h.jsx("div",{className:"space-y-4",children:y.studentSets.filter(Wt=>!Wt.isPlaceholder).map(Wt=>{var aA,Na,xo,ys,AA;return h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsxs("label",{className:"flex items-center gap-3 min-w-[150px]",children:[h.jsx("input",{type:"checkbox",checked:((Na=(aA=oe.constraints)==null?void 0:aA.allowedSetIds)==null?void 0:Na.includes(Wt.id))||!1,onChange:xi=>gi(Me,Wt.id,xi.target.checked),className:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 dark:text-blue-400 focus:ring-blue-500 bg-white dark:bg-gray-800"}),h.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:Wt.subject})]}),((ys=(xo=oe.constraints)==null?void 0:xo.allowedSetIds)==null?void 0:ys.includes(Wt.id))&&h.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[h.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap",children:"Max Students:"}),h.jsx("input",{type:"number",min:"0",placeholder:"Unlimited",value:((AA=oe.constraints.setLimits)==null?void 0:AA[Wt.id])||"",onChange:xi=>HA(Me,Wt.id,xi.target.value),className:"w-100 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white outline-none"})]})]},Wt.id)})}):h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No student sets configured yet"})]})]})]}),h.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:Et?h.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),h.jsx("span",{className:"text-sm font-medium",children:"Saved as Template"})]}):ct?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),h.jsx("span",{className:"text-sm font-medium",children:"Saving..."})]}):Je?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx(Ga,{}),h.jsx("span",{className:"text-sm font-medium",children:"Template Exists"})]}):h.jsxs(tt,{variant:"outline",size:"sm",disabled:Nt||oe.layout.length===0,onClick:()=>D(oe),className:"flex items-center gap-2",children:[h.jsx(Ga,{}),"Save as Template"]})})]},oe.id)})}),h.jsxs("div",{className:"flex flex-wrap gap-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[h.jsxs(tt,{onClick:nA,variant:"outline",className:"flex items-center gap-2",children:[h.jsx(ep,{}),"Add Hall"]}),h.jsxs(tt,{onClick:()=>N(!0),variant:"outline",className:"flex items-center gap-2",children:[h.jsx(Ga,{}),"Add from Template"]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(js,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Student Sets"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Define groups of students participating in the exam"})]})]}),h.jsx("div",{className:"space-y-6",children:y.studentSets.map((oe,Me)=>{if(oe.isPlaceholder)return h.jsxs("div",{className:"p-8 bg-gray-50 dark:bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 text-center",children:[h.jsx("h4",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-300",children:"Configure New Student Set"}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 text-sm",children:"Choose how you want to add student data"}),h.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mb-6",children:[h.jsx(tt,{variant:"outline",onClick:()=>OA(Me,"custom"),className:"!py-3 !px-6",children:"Create Custom Set"}),h.jsx(tt,{variant:"outline",onClick:()=>Te({open:!0,index:Me}),className:"!py-3 !px-6",children:"Use Template"}),h.jsxs(tt,{variant:"outline",className:"!py-3 !px-6 flex items-center gap-2",onClick:()=>{var Mt;return(Mt=Z.current[Me])==null?void 0:Mt.click()},children:[h.jsx(kc,{className:"h-4 w-4"}),"Upload Excel"]}),h.jsx("input",{type:"file",ref:Mt=>{Mt&&(Z.current[Me]=Mt)},hidden:!0,accept:".xlsx, .xls",onChange:Mt=>go(Mt,Me)})]}),h.jsx("button",{type:"button",onClick:()=>vs(Me),className:"text-red-600 hover:text-red-800 text-sm font-medium hover:underline transition",children:"Remove This Set"})]},oe.id);const Je=s.some(Mt=>Mt.subject.toLowerCase()===oe.subject.trim().toLowerCase()),ct=Ge===oe.id,Et=st.includes(oe.id),Nt=!oe.subject.trim()||!(parseInt(String(oe.studentCount),10)>0),Pt=!!oe.students;return h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subject / Set Code"}),h.jsx(Ut,{id:`set-subject-${Me}`,value:oe.subject,onChange:Mt=>fo(Me,"subject",Mt.target.value),placeholder:"e.g., PHYS101"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Number of Students"}),h.jsx(Ut,{id:`set-count-${Me}`,type:"number",min:"1",value:oe.studentCount,onChange:Mt=>fo(Me,"studentCount",Mt.target.value),readOnly:Pt})]}),h.jsx("div",{className:"flex items-end gap-2",children:h.jsxs("button",{type:"button",onClick:()=>mi(Me),className:"w-full h-10 flex items-center justify-center bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors text-gray-700 dark:text-gray-300",title:"Change Set Type",children:[h.jsx(Of,{className:"h-4 w-4 mr-2"}),"Edit Type"]})}),h.jsx("div",{className:"flex items-end",children:h.jsxs("button",{type:"button",onClick:()=>vs(Me),className:"w-full h-10 flex items-center justify-center bg-white dark:bg-gray-700 border border-red-300 dark:border-red-600 rounded-md hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-red-600 dark:text-red-400",children:[h.jsx(Hf,{className:"h-4 w-4 mr-2"}),"Remove"]})})]}),Pt&&h.jsx("div",{className:"mb-4",children:h.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300 rounded-full text-xs font-medium",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Populated from Excel file"]})}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("div",{children:Pt&&h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[h.jsx("span",{className:"font-medium",children:"Note:"})," Count determined by uploaded Excel file"]})}),h.jsx("div",{children:Et?h.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),h.jsx("span",{className:"text-sm font-medium",children:"Saved as Template"})]}):ct?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),h.jsx("span",{className:"text-sm font-medium",children:"Saving..."})]}):Je?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx(Ga,{}),h.jsx("span",{className:"text-sm font-medium",children:"Template Exists"})]}):h.jsxs(tt,{variant:"outline",size:"sm",disabled:Nt||Pt,onClick:()=>Fe(oe),className:"flex items-center gap-2",children:[h.jsx(Ga,{}),"Save as Template"]})})]})]},oe.id)})}),h.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[h.jsxs(tt,{onClick:ho,variant:"outline",className:"flex items-center gap-2",children:[h.jsx(ep,{}),"Add Student Set"]}),h.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg border border-blue-200 dark:border-blue-800",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-800/20 rounded",children:h.jsx(kc,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Excel Upload Guidelines"}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsx("li",{children:" The first sheet name will be used as the set code"}),h.jsx("li",{children:" Format student ID columns as 'Text' to preserve formatting"}),h.jsx("li",{children:" All non-empty cells will be read as student register numbers"}),h.jsx("li",{children:" Supports .xlsx and .xls file formats"})]})]})]})})]})]}),["ai","ai-advanced"].includes(y.editorMode||"ai")&&h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:h.jsx(Di,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"AI Seating Configuration"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Customize seating rules using natural language"})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Seating Strategy"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>zt("normal"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${y.seatingType!=="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${y.seatingType!=="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Normal Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Efficient seating with custom AI instructions"})]})}),h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>zt("fair"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${y.seatingType==="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${y.seatingType==="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fair Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatic alternation with extra spacing"})]})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Custom Instructions"}),h.jsx(I$,{id:"ai-rules",value:y.aiSeatingRules||"",onChange:oe=>Rt("aiSeatingRules",oe.target.value),placeholder:`Enter specific seating rules. For example:
 Prioritize front rows for students with accessibility needs
 Separate students from the same department
 Ensure no two adjacent seats have the same subject code
 Place faculty supervisors at the back of each row`,rows:5,className:"w-full"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"AI will interpret your instructions to create the optimal seating arrangement."})]})]})]}),(y.editorMode==="classic"||y.editorMode==="advanced")&&h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg",children:h.jsx(Li,{className:"h-6 w-6 text-cyan-600 dark:text-cyan-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:y.editorMode==="advanced"?"Advanced Seating Configuration":"Classic Seating Configuration"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.editorMode==="advanced"?"Manual control with predictable algorithms":"Simple round-robin distribution"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-4",children:"Seating Strategy"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>zt("normal"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${y.seatingType!=="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${y.seatingType!=="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Normal Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.editorMode==="advanced"?"Alternates students and fills all remaining seats":"Simple round-robin distribution across all halls"})]})}),h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>zt("fair"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${y.seatingType==="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${y.seatingType==="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fair Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.editorMode==="advanced"?"Alternates students with empty seats between different sets":"Ensures spacing between students of different sets"})]})})]})]})]}),S&&h.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/10 rounded-lg border border-amber-200 dark:border-amber-800",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-1.5 bg-amber-100 dark:bg-amber-800/20 rounded",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h1m0 0h-1m1 0v4m0 0v4m0-8h1m-1 0h-1m1 0V8m0 0h-1m1 0V4m0 0h-1m1 0V0"})})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-300",children:"Note"}),h.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-400 mt-1",children:S})]})]})}),E&&h.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-800",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-1.5 bg-red-100 dark:bg-red-800/20 rounded",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"Validation Error"}),h.jsx("p",{className:"text-sm text-red-700 dark:text-red-400 mt-1",children:E})]})]})}),h.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6",children:h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsx(tt,{onClick:we,variant:"outline",className:"flex-1 !py-4 text-base font-semibold",disabled:p||!Se,children:p?h.jsxs("span",{className:"flex items-center justify-center gap-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}),"Saving..."]}):X?"Save Exam Draft":"Update Exam"}),h.jsx(tt,{onClick:Oe,variant:"primary",className:"flex-1 !py-4 text-base font-semibold",disabled:p,children:p?h.jsxs("span",{className:"flex items-center justify-center gap-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Generating Plan..."]}):"Generate Seating Plan"})]})})]}),y.seatingPlan&&h.jsxs("div",{className:"mt-12 space-y-8",children:[h.jsx(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:h.jsxs("div",{className:"text-center py-8",children:[h.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Pf,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Seating Plan Ready"})]}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto",children:"Your seating arrangement has been generated successfully. Download individual hall plans or export the complete seating chart."}),h.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-8",children:[h.jsxs(tt,{onClick:Pe,variant:"outline",className:"flex items-center justify-center gap-2 !py-3 !px-6",disabled:Y,children:[h.jsx(Pf,{className:"h-5 w-5"}),Y?"Downloading...":"Download All Halls (PNG)"]}),h.jsxs(tt,{onClick:Xe,variant:"primary",className:"flex items-center justify-center gap-2 !py-3 !px-6",children:[h.jsx(kc,{className:"h-5 w-5"}),"Export Full Plan (Excel)"]})]}),h.jsxs("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/10 rounded-xl border border-blue-200 dark:border-blue-800 max-w-lg mx-auto",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/20 rounded-lg",children:h.jsx(Of,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Need manual adjustments?"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Edit individual student placements"})]})]}),h.jsx(tt,{onClick:()=>un(!0),variant:"primary",className:"w-full !py-3",children:"Open Seating Editor"})]})]})}),h.jsx("div",{className:"space-y-8",children:y.halls.map(oe=>{const Me={...oe,layout:oe.layout};return h.jsxs(jt,{ref:Je=>{Je&&(Be.current[oe.id]=Je)},className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 w-full",children:[h.jsx(ou,{hall:Me,plan:y.seatingPlan,studentSets:ke,seatDimensions:dt}),h.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-300",children:oe.name}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Seating Plan"})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsxs(tt,{onClick:()=>Ve(oe.id,oe.name),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(Pf,{})," PNG"]}),h.jsxs(tt,{onClick:()=>Ye(Me),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(kc,{})," Excel"]})]})]})})]},oe.id)})})]})]})]})]})}const pn=t.filter(X=>X.editorMode==="ai"||!X.editorMode),ws=t.filter(X=>X.editorMode==="advanced"),ga=t.filter(X=>X.editorMode==="classic"),Rn=t.filter(X=>X.editorMode==="ai-advanced"),pi=X=>h.jsx("div",{className:"space-y-4",children:X.map(le=>{const Se=ie===le.id,ke=ae===le.id;return h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow",children:[h.jsx("div",{className:"p-5",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>lr(le),children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsxs("div",{className:`p-2 rounded-lg ${le.editorMode==="ai"?"bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":le.editorMode==="ai-advanced"?"bg-purple-100 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400":le.editorMode==="advanced"?"bg-cyan-100 dark:bg-cyan-900/20 text-cyan-600 dark:text-cyan-400":"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400"}`,children:[le.editorMode==="ai"&&h.jsx(Di,{className:"h-5 w-5"}),le.editorMode==="ai-advanced"&&h.jsx(Nc,{className:"h-5 w-5"}),le.editorMode==="advanced"&&h.jsx(Li,{className:"h-5 w-5"}),le.editorMode==="classic"&&h.jsx(Mi,{className:"h-5 w-5"})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 text-lg",children:le.title}),h.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(K$,{className:"h-4 w-4"}),le.date]}),h.jsx("span",{children:""}),h.jsxs("span",{children:["Created by: ",Tt(le.createdBy)]})]})]})]}),h.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[h.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${le.seatingPlan?"bg-green-100 text-green-800 dark:bg-green-500/20 dark:text-green-300":"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300"}`,children:le.seatingPlan?" Plan Generated":" Pending Plan"}),h.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[le.halls.length," Hall",le.halls.length!==1?"s":""]}),h.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[le.studentSets.length," Set",le.studentSets.length!==1?"s":""]})]})]}),h.jsx("button",{onClick:()=>lr(le),className:"ml-4 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx(G$,{})})]})}),h.jsx("div",{className:"px-5 py-4 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700 rounded-b-xl",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("div",{className:"flex items-center gap-2",children:le.seatingPlan?h.jsxs(h.Fragment,{children:[h.jsxs(tt,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:oe=>{oe.stopPropagation(),vA(le)},disabled:ke,children:[h.jsx(Pf,{className:"h-4 w-4"}),ke?"...":"PNGs"]}),h.jsxs(tt,{variant:"primary",size:"sm",className:"flex items-center gap-2",onClick:oe=>{oe.stopPropagation(),ka(le)},children:[h.jsx(kc,{className:"h-4 w-4"}),"Excel"]})]}):h.jsx(tt,{variant:"primary",size:"sm",className:"flex items-center gap-2",onClick:oe=>{oe.stopPropagation(),PA(le)},disabled:Se,children:Se?h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Generating..."]}):h.jsxs(h.Fragment,{children:[h.jsx(Di,{className:"h-4 w-4"}),"Generate Plan"]})})}),h.jsx(tt,{variant:"danger",size:"sm",onClick:oe=>{oe.stopPropagation(),pr(le.id)},children:"Delete"})]})})]},le.id)})});return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(I.mode==="create-template"||I.mode==="edit-template")&&h.jsx(Bp,{isOpen:!0,onClose:()=>U({mode:"closed",hallIndex:null}),onSave:Lr,initialLayout:I.mode==="edit-template"&&I.templateId?(Il=n.find(X=>X.id===I.templateId))==null?void 0:Il.layout:[],initialName:I.mode==="edit-template"?I.templateName:void 0,isTemplateCreationMode:!0}),k&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4 animate-fadeIn",onClick:()=>G(!1),children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700",onClick:X=>X.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Mi,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Create Grid Hall Template"})]}),h.jsxs("form",{onSubmit:j,children:[h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template Name"}),h.jsx(Ut,{id:"grid-template-name",value:M.name,onChange:X=>ee({...M,name:X.target.value}),required:!0,placeholder:"e.g., Main Auditorium Layout"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rows"}),h.jsx(Ut,{id:"grid-template-rows",type:"number",min:"1",max:"50",value:M.rows,onChange:X=>ee({...M,rows:X.target.value}),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Columns"}),h.jsx(Ut,{id:"grid-template-cols",type:"number",min:"1",max:"50",value:M.cols,onChange:X=>ee({...M,cols:X.target.value}),required:!0})]})]}),re&&h.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-800",children:h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:re})})]}),h.jsxs("div",{className:"mt-8 flex justify-end gap-4",children:[h.jsx(tt,{type:"button",variant:"outline",onClick:()=>G(!1),children:"Cancel"}),h.jsx(tt,{type:"submit",variant:"primary",children:"Save Template"})]})]})]})}),h.jsxs("div",{className:"mb-10",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"Exam Seating Management"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create and manage exam schedules with intelligent seating arrangements"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(ep,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Create New Exam"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose an editor mode to begin creating your exam schedule"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{onClick:()=>cr("ai"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(Di,{className:"text-blue-600 dark:text-blue-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"AI-Powered Mode"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Flexible seating with natural language rules"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Natural language instructions"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Intelligent seating optimization"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Flexible rule-based arrangement"]})]})]}),h.jsxs("div",{onClick:()=>cr("ai-advanced"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(Nc,{className:"text-purple-600 dark:text-purple-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"AI + Advanced"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"AI logic with strict hall constraints"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Combined AI and manual control"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Hall-specific set restrictions"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Advanced constraint management"]})]})]}),h.jsxs("div",{onClick:()=>cr("advanced"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-cyan-300 dark:hover:border-cyan-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(Li,{className:"text-cyan-600 dark:text-cyan-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Advanced Mode"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manual control with predictable algorithms"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Granular hall control"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Deterministic seating"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Fast and predictable"]})]})]}),h.jsxs("div",{onClick:()=>cr("classic"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(Mi,{className:"text-green-600 dark:text-green-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Classic Mode"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Simple round-robin distribution"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Simple and fast"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Automatic mixing"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Minimal configuration"]})]})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h1m0 0h-1m1 0v4m0 0v4m0-8h1m-1 0h-1m1 0V8m0 0h-1m1 0V4m0 0h-1m1 0V0"})})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Editor Mode Guide"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Understanding the different seating arrangement methods"})]})]}),h.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",onClick:()=>Yt(!nr),children:h.jsx(V$,{className:`h-6 w-6 transition-transform ${nr?"rotate-180":""}`})})]}),nr&&h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Editor Mode Comparison"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/20 rounded",children:h.jsx(Di,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"AI-Powered Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Best for complex scenarios requiring flexible, intelligent seating based on natural language instructions."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:'Example: "Keep Physics students away from Math students and prioritize front rows for accessibility needs."'})]})]}),h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-800/20 rounded",children:h.jsx(Nc,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"AI + Advanced Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Combines AI intelligence with strict hall-level controls for power users needing precise placement."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Restrict Hall A to Chemistry students only, then apply AI rules within that constraint."})]})]}),h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-cyan-100 dark:bg-cyan-800/20 rounded",children:h.jsx(Li,{className:"h-5 w-5 text-cyan-600 dark:text-cyan-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Advanced Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Manual control with predictable algorithms, perfect for standardized exam setups."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Manually assign specific student sets to specific halls with defined seating directions."})]})]}),h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-800/20 rounded",children:h.jsx(Mi,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Classic Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Simple and fast round-robin distribution for straightforward exam scenarios."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Automatically mix all student sets across all available halls in order."})]})]})]})]}),h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Workflow Overview"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"1"})}),h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Setup"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter exam details, add halls, and configure student sets"})]}),h.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"2"})}),h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Configure"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Choose editor mode and apply seating rules or constraints"})]}),h.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"3"})}),h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Generate & Export"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Generate seating plan and export as Excel or PNG files"})]})]})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:h.jsx(cT,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"My Exam Schedules"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage and monitor all your exam configurations"})]})]}),h.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:h.jsxs("nav",{className:"-mb-px flex flex-wrap gap-x-6","aria-label":"Tabs",children:[h.jsxs("button",{onClick:()=>wt("ai"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${it==="ai"?"border-blue-500 dark:border-blue-400 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["AI Exams (",pn.length,")"]}),h.jsxs("button",{onClick:()=>wt("ai-advanced"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${it==="ai-advanced"?"border-purple-500 dark:border-purple-400 text-purple-600 dark:text-purple-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["AI+Advanced (",Rn.length,")"]}),h.jsxs("button",{onClick:()=>wt("advanced"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${it==="advanced"?"border-cyan-500 dark:border-cyan-400 text-cyan-600 dark:text-cyan-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Advanced (",ws.length,")"]}),h.jsxs("button",{onClick:()=>wt("classic"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${it==="classic"?"border-green-500 dark:border-green-400 text-green-600 dark:text-green-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Classic (",ga.length,")"]})]})}),h.jsxs("div",{className:"mt-6",children:[it==="ai"&&(pn.length>0?pi(pn):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-4",children:h.jsx(Di,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No AI exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create your first AI-powered exam schedule"})]})),it==="ai-advanced"&&(Rn.length>0?pi(Rn):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-purple-100 dark:bg-purple-900/20 rounded-full mb-4",children:h.jsx(Nc,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No AI+Advanced exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Combine AI with advanced constraints"})]})),it==="advanced"&&(ws.length>0?pi(ws):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-cyan-100 dark:bg-cyan-900/20 rounded-full mb-4",children:h.jsx(Li,{className:"h-8 w-8 text-cyan-600 dark:text-cyan-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No Advanced exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create exams with manual control"})]})),it==="classic"&&(ga.length>0?pi(ga):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full mb-4",children:h.jsx(Mi,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No Classic exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create simple round-robin exams"})]}))]})]})]}),h.jsx("div",{className:"space-y-8",children:h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Ga,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Template Library"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Reuse configurations across exams"})]})]}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Hall Layout Templates"}),h.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.length," templates"]})]}),h.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 mb-4 space-y-3",children:[h.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Create New Template"}),h.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.jsxs(tt,{onClick:()=>{G(!0),q(""),ee({name:"",rows:"8",cols:"10"})},variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(Mi,{className:"h-4 w-4"}),"Grid Template"]}),h.jsxs(tt,{onClick:()=>U({mode:"create-template",hallIndex:null}),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(Ga,{className:"h-4 w-4"}),"Custom Layout"]})]})]}),h.jsx("div",{className:"space-y-3",children:n.length>0?n.map(X=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-900/20 rounded",children:h.jsx(Ga,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:X.name}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[X.layout.length," seats"]})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>H(X),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:h.jsx(Of,{className:"h-4 w-4"})}),h.jsx("button",{onClick:()=>O(X.id),className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:h.jsx(Hf,{className:"h-4 w-4"})})]})]},X.id)):h.jsxs("div",{className:"text-center py-6",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full mb-3",children:h.jsx(Ga,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No hall templates"})]})})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Student Set Templates"}),h.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.length," templates"]})]}),h.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 mb-4 space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:he?"Edit Template":"Create New Template"}),he&&h.jsx("button",{type:"button",onClick:me,className:"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 underline",children:"Cancel Edit"})]}),h.jsxs("form",{onSubmit:V,className:"space-y-3",children:[h.jsx(Ut,{placeholder:"Subject / Code",value:P.subject,onChange:X=>z({...P,subject:X.target.value}),inputSize:"sm"}),h.jsx(Ut,{type:"number",min:"1",placeholder:"Student Count",value:P.studentCount,onChange:X=>z({...P,studentCount:X.target.value}),inputSize:"sm"}),ce&&h.jsx("div",{className:"p-2 bg-red-50 dark:bg-red-900/10 rounded border border-red-200 dark:border-red-800",children:h.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:ce})}),h.jsx(tt,{type:"submit",variant:"primary",size:"sm",className:"w-full",children:he?"Update Template":"Save Template"})]})]}),h.jsx("div",{className:"space-y-3",children:s.length>0?s.map(X=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-1.5 bg-green-100 dark:bg-green-900/20 rounded",children:h.jsx(js,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:X.subject}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[X.studentCount," students"]})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>J(X),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:h.jsx(Of,{className:"h-4 w-4"})}),h.jsx("button",{onClick:()=>xe(X.id),className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:h.jsx(Hf,{className:"h-4 w-4"})})]})]},X.id)):h.jsxs("div",{className:"text-center py-6",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full mb-3",children:h.jsx(js,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No student set templates"})]})})]})]})]})})]}),fn&&fn.seatingPlan&&h.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px",zIndex:-1},children:fn.halls.map(X=>h.jsx("div",{ref:le=>{le&&(K.current[X.id]=le)},style:{width:"800px",padding:"1px"},children:h.jsx(jt,{children:h.jsx(ou,{hall:X,plan:fn.seatingPlan,studentSets:fn.studentSets,seatDimensions:Lf(fn.studentSets)})})},X.id))})]})]})},z$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),X$=({className:e})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"})]}),nl=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),W$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),J$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),Y$=({exams:e,onSelectExam:t})=>{const[r,n]=W.useState(new Date),a=W.useMemo(()=>e.reduce((T,S)=>{const F=S.date;return T[F]||(T[F]=[]),T[F].push(S),T},{}),[e]),s=()=>{n(new Date(r.getFullYear(),r.getMonth()-1,1))},i=()=>{n(new Date(r.getFullYear(),r.getMonth()+1,1))},l=r.getFullYear(),u=r.getMonth(),f=r.toLocaleString("default",{month:"long"}),d=new Date(l,u,1).getDay(),p=new Date(l,u+1,0).getDate(),x=Array.from({length:p},(T,S)=>S+1),y=Array.from({length:d}),C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E=T=>{const S=new Date;return T===S.getDate()&&u===S.getMonth()&&l===S.getFullYear()};return h.jsxs(jt,{className:"border border-slate-200 dark:border-slate-700 shadow-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:h.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),h.jsxs("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-200",children:[f," ",l]}),h.jsx("button",{onClick:i,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:h.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),h.jsxs("div",{className:"grid grid-cols-7 gap-px bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden border dark:border-slate-700",children:[C.map(T=>h.jsx("div",{className:"py-2 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-800",children:T},T)),y.map((T,S)=>h.jsx("div",{className:"bg-white dark:bg-slate-800 h-24 sm:h-32"},`empty-${S}`)),x.map(T=>{const S=`${l}-${String(u+1).padStart(2,"0")}-${String(T).padStart(2,"0")}`,F=a[S]||[],_=E(T);return h.jsxs("div",{className:"bg-white dark:bg-slate-800 h-24 sm:h-32 p-1 sm:p-2 flex flex-col relative transition-colors hover:bg-slate-50 dark:hover:bg-slate-750",children:[h.jsx("span",{className:`w-7 h-7 flex items-center justify-center rounded-full text-sm font-medium mb-1 ${_?"bg-violet-600 text-white shadow-md":"text-slate-700 dark:text-slate-300"}`,children:T}),h.jsx("div",{className:"flex-grow space-y-1 overflow-y-auto custom-scrollbar",children:F.map(N=>h.jsx("button",{onClick:()=>t(N),className:"w-full text-left p-1.5 rounded text-[10px] sm:text-xs font-medium bg-violet-100 text-violet-700 dark:bg-violet-500/20 dark:text-violet-300 hover:bg-violet-200 dark:hover:bg-violet-500/30 truncate transition-colors border-l-2 border-violet-500",title:N.title,children:N.title},N.id))})]},T)})]})]})},q$=({exams:e,onSelectExam:t})=>h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(r=>{const n=new Date(r.date),a=n.toLocaleString("default",{month:"short"}).toUpperCase(),s=n.getDate();return h.jsxs("div",{className:"group bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-lg border border-slate-200 dark:border-slate-700 p-0 overflow-hidden transition-all duration-300 cursor-pointer flex flex-col h-full",onClick:()=>t(r),role:"button",tabIndex:0,onKeyPress:i=>(i.key==="Enter"||i.key===" ")&&t(r),children:[h.jsxs("div",{className:"p-5 flex items-start gap-4 flex-grow",children:[h.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-lg w-16 h-16 border border-slate-200 dark:border-slate-600",children:[h.jsx("span",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:a}),h.jsx("span",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:s})]}),h.jsxs("div",{className:"flex-grow min-w-0",children:[h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-1 truncate group-hover:text-violet-600 dark:group-hover:text-violet-400 transition-colors",children:r.title}),h.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:[r.halls.length," Hall",r.halls.length!==1?"s":"","  ",r.studentSets.length," Subject",r.studentSets.length!==1?"s":""]})]})]}),h.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/30 px-5 py-3 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"View details"}),h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-violet-500 transform group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]},r.id)})}),$$=()=>{var U,k;const{user:e}=ci(),[t,r]=W.useState([]),[n,a]=W.useState(null),[s,i]=W.useState(!0),[l,u]=W.useState("calendar"),f=W.useRef({}),[d,p]=W.useState(""),[x,y]=W.useState(""),[C,E]=W.useState(null),T=W.useCallback((G,M)=>{var ee;if(!G.seatingPlan)return null;for(const re in G.seatingPlan){const q=G.seatingPlan[re];for(const se of q)for(const Te of se)if(((ee=Te==null?void 0:Te.student)==null?void 0:ee.id)===M)return Te}return null},[]),S=n&&(e!=null&&e.registerNumber)?T(n,e.registerNumber):null,F=W.useCallback(G=>{if(!G)return;const M=setTimeout(()=>{const ee=f.current[G.hallId],re=document.querySelector("header");if(ee&&re){const q=re.offsetHeight,Te=ee.getBoundingClientRect().top+window.scrollY,Be=window.innerHeight-q,Z=Te-Be/2+ee.offsetHeight/2-q;window.scrollTo({top:Z,behavior:"smooth"})}else ee&&ee.scrollIntoView({behavior:"smooth",block:"center"})},150);return()=>clearTimeout(M)},[]);W.useEffect(()=>{(async()=>{if(!(e!=null&&e.registerNumber)||!e.adminId){i(!1);return}try{i(!0);const M=await xH(e.registerNumber,e.adminId);r(M.sort((ee,re)=>new Date(ee.date).getTime()-new Date(re.date).getTime()))}catch(M){console.error("Error fetching exams:",M)}finally{i(!1)}})()},[e]),W.useEffect(()=>{n&&S?(E(S),p((e==null?void 0:e.registerNumber)||""),F(S)):(E(null),p("")),y("")},[n,S,e==null?void 0:e.registerNumber,F]);const _=G=>{if(G.preventDefault(),!n||!d.trim())return;const M=T(n,d.trim());M?(E(M),y(""),F(M)):(E(null),y(`Register Number "${d.trim()}" not found in this exam.`))},N=()=>{S&&(E(S),p((e==null?void 0:e.registerNumber)||""),y(""),F(S))};if(s)return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-4xl mx-auto py-12 px-4 text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600 mx-auto mb-4"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Loading your exam schedules..."})]})]});if(n){const G=C?n.halls.find(M=>M.id===C.hallId):null;return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsx("div",{className:"mb-6",children:h.jsxs(tt,{onClick:()=>a(null),variant:"secondary",className:"!px-3 !py-1 text-sm flex items-center gap-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to My Schedules"]})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[h.jsxs(jt,{className:"border-t-4 border-t-violet-500",children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:n.title}),h.jsxs("p",{className:"text-slate-500 dark:text-slate-400 flex items-center gap-2",children:[h.jsx(nl,{className:"h-5 w-5 text-violet-500"}),new Date(n.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),h.jsxs(jt,{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-800/50",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-200",children:"Find a Seat"}),h.jsxs("form",{onSubmit:_,className:"flex gap-2 mb-4",children:[h.jsx(Ut,{containerClassName:"flex-grow",id:"search-register-number",placeholder:"Enter Reg. Number",value:d,onChange:M=>p(M.target.value),className:"!bg-white dark:!bg-slate-900"}),h.jsx(tt,{type:"submit",className:"!px-3",children:h.jsx(z$,{className:"h-5 w-5"})})]}),x&&h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-2 rounded border border-red-100 dark:border-red-900/30 mb-4",children:x}),C&&G?h.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[h.jsxs("div",{className:"bg-violet-600 text-white p-3 flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Exam Ticket"}),h.jsx(J$,{className:"h-5 w-5 opacity-80"})]}),h.jsxs("div",{className:"p-4 space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-end border-b border-dashed border-slate-200 dark:border-slate-700 pb-3",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Student ID"}),h.jsx("p",{className:"text-lg font-mono font-bold text-slate-800 dark:text-slate-100",children:(U=C.student)==null?void 0:U.id})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Subject"}),h.jsx("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:(k=C.student)==null?void 0:k.setId})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Hall"}),h.jsx("p",{className:"text-base font-bold text-violet-600 dark:text-violet-400",children:(G==null?void 0:G.name)||"N/A"})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Seat Position"}),h.jsxs("p",{className:"text-base font-bold text-slate-800 dark:text-slate-200",children:["R",C.row+1," - C",C.col+1]})]})]})]})]}):!x&&h.jsx("div",{className:"text-center py-6 text-slate-400 dark:text-slate-500 text-sm italic",children:"Enter a register number above to locate a specific seat."})]})]}),h.jsx("div",{className:"lg:col-span-2 space-y-8",children:n.seatingPlan?n.halls.map(M=>h.jsx("div",{ref:ee=>{ee&&(f.current[M.id]=ee)},children:h.jsxs(jt,{className:"relative overflow-hidden",children:[(C==null?void 0:C.hallId)===M.id&&h.jsx("div",{className:"absolute top-0 right-0 bg-violet-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg shadow-md z-10",children:"Your Hall"}),h.jsx(ou,{hall:M,plan:n.seatingPlan,studentSets:n.studentSets,highlightSeat:(C==null?void 0:C.hallId)===M.id?{row:C.row,col:C.col}:void 0})]})},M.id)):h.jsx(jt,{children:h.jsxs("div",{className:"text-center py-16",children:[h.jsx("div",{className:"inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-800 mb-4",children:h.jsx(nl,{className:"h-8 w-8 text-slate-400"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-slate-100",children:"Seating Plan Unavailable"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 max-w-sm mx-auto",children:"The administrator hasn't generated or published the seating arrangement for this exam yet. Please check back later."})]})})})]}),S&&h.jsxs("button",{onClick:N,className:"fixed bottom-8 right-8 bg-violet-600 text-white p-4 rounded-full shadow-xl hover:bg-violet-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-violet-300 z-50 flex items-center gap-2 group","aria-label":"Find my seat",title:"Find my seat",children:[h.jsx(X$,{className:"h-6 w-6"}),h.jsx("span",{className:"max-w-0 overflow-hidden group-hover:max-w-xs transition-all duration-300 whitespace-nowrap font-medium text-sm",children:"My Seat"})]})]})]})}const I=t.length>0?t[0]:null;return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(bA,{}),h.jsxs("main",{className:"max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100",children:["Hello, ",h.jsx("span",{className:"text-violet-600 dark:text-violet-400",children:(e==null?void 0:e.name)||"Student"}),"!"]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Here is your examination schedule."})]}),I&&h.jsxs("div",{className:"mb-10 p-6 bg-gradient-to-r from-violet-600 to-indigo-600 rounded-2xl shadow-lg text-white relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white opacity-10 rounded-full blur-2xl"}),h.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-violet-200 text-sm font-semibold uppercase tracking-wider mb-1",children:"Next Up"}),h.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-1",children:I.title}),h.jsxs("p",{className:"text-violet-100 flex items-center gap-2",children:[h.jsx(nl,{className:"h-5 w-5"}),new Date(I.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]}),h.jsx(tt,{onClick:()=>a(I),className:"bg-white text-violet-700 hover:bg-violet-50 border-none shadow-none font-bold px-6 py-3",children:"View Details & Seat"})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end mb-6 gap-4 border-b border-slate-200 dark:border-slate-700 pb-4",children:[h.jsxs("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[h.jsx(nl,{className:"h-6 w-6 text-slate-400"})," All Exams"]}),t.length>0&&h.jsxs("div",{className:"flex bg-slate-200 dark:bg-slate-700 rounded-lg p-1",children:[h.jsxs("button",{onClick:()=>u("calendar"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-sm font-medium transition-all ${l==="calendar"?"bg-white dark:bg-slate-600 text-violet-600 dark:text-violet-300 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:[h.jsx(nl,{className:"h-4 w-4"})," Calendar"]}),h.jsxs("button",{onClick:()=>u("list"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-sm font-medium transition-all ${l==="list"?"bg-white dark:bg-slate-600 text-violet-600 dark:text-violet-300 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:[h.jsx(W$,{className:"h-4 w-4"})," List"]})]})]}),t.length>0?h.jsx("div",{className:"animate-fade-in-up",children:l==="calendar"?h.jsx(Y$,{exams:t,onSelectExam:a}):h.jsx(q$,{exams:t,onSelectExam:a})}):h.jsxs("div",{className:"text-center py-20 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-700",children:[h.jsx("div",{className:"inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-700 mb-4",children:h.jsx(nl,{className:"h-10 w-10 text-slate-400"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-slate-100",children:"No Exams Scheduled"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 max-w-md mx-auto",children:"You don't have any upcoming exams assigned to your register number yet. Relax!"})]})]})]})},Gf=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,user:n}=ci(),a=NA();return r?!n||!t.includes(n.role)?h.jsx(rp,{to:"/login",replace:!0}):h.jsx(h.Fragment,{children:e}):h.jsx(rp,{to:"/login",state:{from:a},replace:!0})},Z$=()=>{const{user:e}=ci();return h.jsxs(nN,{children:[h.jsx(Hi,{path:"/login",element:h.jsx(JH,{})}),h.jsx(Hi,{path:"/super-admin",element:h.jsx(Gf,{allowedRoles:[lt.SUPER_ADMIN],children:h.jsx(t6,{})})}),h.jsx(Hi,{path:"/admin",element:h.jsx(Gf,{allowedRoles:[lt.ADMIN],children:h.jsx(N$,{})})}),h.jsx(Hi,{path:"/teacher",element:h.jsx(Gf,{allowedRoles:[lt.TEACHER],children:h.jsx(j$,{})})}),h.jsx(Hi,{path:"/student",element:h.jsx(Gf,{allowedRoles:[lt.STUDENT],children:h.jsx($$,{})})}),h.jsx(Hi,{path:"/",element:h.jsx(rp,{to:e?`/${e.role.toLowerCase().replace("_","-")}`:"/login"})})]})},eZ=()=>h.jsx(RH,{children:h.jsx(QH,{children:h.jsx(_N,{children:h.jsx(Z$,{})})})}),z4=document.getElementById("root");if(!z4)throw new Error("Could not find root element to mount to");const tZ=sk.createRoot(z4);tZ.render(h.jsx($U.StrictMode,{children:h.jsx(eZ,{})}));
