(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const A of document.querySelectorAll('link[rel="modulepreload"]'))n(A);new MutationObserver(A=>{for(const s of A)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(A){const s={};return A.integrity&&(s.integrity=A.integrity),A.referrerPolicy&&(s.referrerPolicy=A.referrerPolicy),A.crossOrigin==="use-credentials"?s.credentials="include":A.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(A){if(A.ep)return;A.ep=!0;const s=r(A);fetch(A.href,s)}})();function Y2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jg={exports:{}},fc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var My;function NU(){if(My)return fc;My=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,A,s){var l=null;if(s!==void 0&&(l=""+s),A.key!==void 0&&(l=""+A.key),"key"in A){s={};for(var o in A)o!=="key"&&(s[o]=A[o])}else s=A;return A=s.ref,{$$typeof:e,type:n,key:l,ref:A!==void 0?A:null,props:s}}return fc.Fragment=t,fc.jsx=r,fc.jsxs=r,fc}var Ly;function IU(){return Ly||(Ly=1,Jg.exports=NU()),Jg.exports}var g=IU(),Yg={exports:{}},Bt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy;function QU(){if(Hy)return Bt;Hy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),x=Symbol.iterator;function y(X){return X===null||typeof X!="object"?null:(X=x&&X[x]||X["@@iterator"],typeof X=="function"?X:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,T={};function _(X,k,K){this.props=X,this.context=k,this.refs=T,this.updater=K||C}_.prototype.isReactComponent={},_.prototype.setState=function(X,k){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,k,"setState")},_.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function F(){}F.prototype=_.prototype;function S(X,k,K){this.props=X,this.context=k,this.refs=T,this.updater=K||C}var I=S.prototype=new F;I.constructor=S,E(I,_.prototype),I.isPureReactComponent=!0;var M=Array.isArray;function Q(){}var U={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function R(X,k,K){var P=K.ref;return{$$typeof:e,type:X,key:k,ref:P!==void 0?P:null,props:K}}function te(X,k){return R(X.type,k,X.props)}function ne(X){return typeof X=="object"&&X!==null&&X.$$typeof===e}function ee(X){var k={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(K){return k[K]})}var ae=/\/+/g;function Se(X,k){return typeof X=="object"&&X!==null&&X.key!=null?ee(""+X.key):k.toString(36)}function Te(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(Q,Q):(X.status="pending",X.then(function(k){X.status==="pending"&&(X.status="fulfilled",X.value=k)},function(k){X.status==="pending"&&(X.status="rejected",X.reason=k)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function q(X,k,K,P,z){var Z=typeof X;(Z==="undefined"||Z==="boolean")&&(X=null);var le=!1;if(X===null)le=!0;else switch(Z){case"bigint":case"string":case"number":le=!0;break;case"object":switch(X.$$typeof){case e:case t:le=!0;break;case d:return le=X._init,q(le(X._payload),k,K,P,z)}}if(le)return z=z(X),le=P===""?"."+Se(X,0):P,M(z)?(K="",le!=null&&(K=le.replace(ae,"$&/")+"/"),q(z,k,K,"",function(Ae){return Ae})):z!=null&&(ne(z)&&(z=te(z,K+(z.key==null||X&&X.key===z.key?"":(""+z.key).replace(ae,"$&/")+"/")+le)),k.push(z)),1;le=0;var Ce=P===""?".":P+":";if(M(X))for(var he=0;he<X.length;he++)P=X[he],Z=Ce+Se(P,he),le+=q(P,k,K,Z,z);else if(he=y(X),typeof he=="function")for(X=he.call(X),he=0;!(P=X.next()).done;)P=P.value,Z=Ce+Se(P,he++),le+=q(P,k,K,Z,z);else if(Z==="object"){if(typeof X.then=="function")return q(Te(X),k,K,P,z);throw k=String(X),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.")}return le}function oe(X,k,K){if(X==null)return X;var P=[],z=0;return q(X,P,"","",function(Z){return k.call(K,Z,z++)}),P}function Re(X){if(X._status===-1){var k=X._result;k=k(),k.then(function(K){(X._status===0||X._status===-1)&&(X._status=1,X._result=K)},function(K){(X._status===0||X._status===-1)&&(X._status=2,X._result=K)}),X._status===-1&&(X._status=0,X._result=k)}if(X._status===1)return X._result.default;throw X._result}var ie=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var k=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(k))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)},Me={map:oe,forEach:function(X,k,K){oe(X,function(){k.apply(this,arguments)},K)},count:function(X){var k=0;return oe(X,function(){k++}),k},toArray:function(X){return oe(X,function(k){return k})||[]},only:function(X){if(!ne(X))throw Error("React.Children.only expected to receive a single React element child.");return X}};return Bt.Activity=m,Bt.Children=Me,Bt.Component=_,Bt.Fragment=r,Bt.Profiler=A,Bt.PureComponent=S,Bt.StrictMode=n,Bt.Suspense=u,Bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Bt.__COMPILER_RUNTIME={__proto__:null,c:function(X){return U.H.useMemoCache(X)}},Bt.cache=function(X){return function(){return X.apply(null,arguments)}},Bt.cacheSignal=function(){return null},Bt.cloneElement=function(X,k,K){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var P=E({},X.props),z=X.key;if(k!=null)for(Z in k.key!==void 0&&(z=""+k.key),k)!G.call(k,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&k.ref===void 0||(P[Z]=k[Z]);var Z=arguments.length-2;if(Z===1)P.children=K;else if(1<Z){for(var le=Array(Z),Ce=0;Ce<Z;Ce++)le[Ce]=arguments[Ce+2];P.children=le}return R(X.type,z,P)},Bt.createContext=function(X){return X={$$typeof:l,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:s,_context:X},X},Bt.createElement=function(X,k,K){var P,z={},Z=null;if(k!=null)for(P in k.key!==void 0&&(Z=""+k.key),k)G.call(k,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(z[P]=k[P]);var le=arguments.length-2;if(le===1)z.children=K;else if(1<le){for(var Ce=Array(le),he=0;he<le;he++)Ce[he]=arguments[he+2];z.children=Ce}if(X&&X.defaultProps)for(P in le=X.defaultProps,le)z[P]===void 0&&(z[P]=le[P]);return R(X,Z,z)},Bt.createRef=function(){return{current:null}},Bt.forwardRef=function(X){return{$$typeof:o,render:X}},Bt.isValidElement=ne,Bt.lazy=function(X){return{$$typeof:d,_payload:{_status:-1,_result:X},_init:Re}},Bt.memo=function(X,k){return{$$typeof:f,type:X,compare:k===void 0?null:k}},Bt.startTransition=function(X){var k=U.T,K={};U.T=K;try{var P=X(),z=U.S;z!==null&&z(K,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(Q,ie)}catch(Z){ie(Z)}finally{k!==null&&K.types!==null&&(k.types=K.types),U.T=k}},Bt.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Bt.use=function(X){return U.H.use(X)},Bt.useActionState=function(X,k,K){return U.H.useActionState(X,k,K)},Bt.useCallback=function(X,k){return U.H.useCallback(X,k)},Bt.useContext=function(X){return U.H.useContext(X)},Bt.useDebugValue=function(){},Bt.useDeferredValue=function(X,k){return U.H.useDeferredValue(X,k)},Bt.useEffect=function(X,k){return U.H.useEffect(X,k)},Bt.useEffectEvent=function(X){return U.H.useEffectEvent(X)},Bt.useId=function(){return U.H.useId()},Bt.useImperativeHandle=function(X,k,K){return U.H.useImperativeHandle(X,k,K)},Bt.useInsertionEffect=function(X,k){return U.H.useInsertionEffect(X,k)},Bt.useLayoutEffect=function(X,k){return U.H.useLayoutEffect(X,k)},Bt.useMemo=function(X,k){return U.H.useMemo(X,k)},Bt.useOptimistic=function(X,k){return U.H.useOptimistic(X,k)},Bt.useReducer=function(X,k,K){return U.H.useReducer(X,k,K)},Bt.useRef=function(X){return U.H.useRef(X)},Bt.useState=function(X){return U.H.useState(X)},Bt.useSyncExternalStore=function(X,k,K){return U.H.useSyncExternalStore(X,k,K)},Bt.useTransition=function(){return U.H.useTransition()},Bt.version="19.2.3",Bt}var Oy;function Xp(){return Oy||(Oy=1,Yg.exports=QU()),Yg.exports}var W=Xp();const RU=Y2(W);var Wg={exports:{}},dc={},qg={exports:{}},$g={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py;function DU(){return Py||(Py=1,(function(e){function t(q,oe){var Re=q.length;q.push(oe);e:for(;0<Re;){var ie=Re-1>>>1,Me=q[ie];if(0<A(Me,oe))q[ie]=oe,q[Re]=Me,Re=ie;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var oe=q[0],Re=q.pop();if(Re!==oe){q[0]=Re;e:for(var ie=0,Me=q.length,X=Me>>>1;ie<X;){var k=2*(ie+1)-1,K=q[k],P=k+1,z=q[P];if(0>A(K,Re))P<Me&&0>A(z,K)?(q[ie]=z,q[P]=Re,ie=P):(q[ie]=K,q[k]=Re,ie=k);else if(P<Me&&0>A(z,Re))q[ie]=z,q[P]=Re,ie=P;else break e}}return oe}function A(q,oe){var Re=q.sortIndex-oe.sortIndex;return Re!==0?Re:q.id-oe.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],f=[],d=1,m=null,x=3,y=!1,C=!1,E=!1,T=!1,_=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function I(q){for(var oe=r(f);oe!==null;){if(oe.callback===null)n(f);else if(oe.startTime<=q)n(f),oe.sortIndex=oe.expirationTime,t(u,oe);else break;oe=r(f)}}function M(q){if(E=!1,I(q),!C)if(r(u)!==null)C=!0,Q||(Q=!0,ee());else{var oe=r(f);oe!==null&&Te(M,oe.startTime-q)}}var Q=!1,U=-1,G=5,R=-1;function te(){return T?!0:!(e.unstable_now()-R<G)}function ne(){if(T=!1,Q){var q=e.unstable_now();R=q;var oe=!0;try{e:{C=!1,E&&(E=!1,F(U),U=-1),y=!0;var Re=x;try{t:{for(I(q),m=r(u);m!==null&&!(m.expirationTime>q&&te());){var ie=m.callback;if(typeof ie=="function"){m.callback=null,x=m.priorityLevel;var Me=ie(m.expirationTime<=q);if(q=e.unstable_now(),typeof Me=="function"){m.callback=Me,I(q),oe=!0;break t}m===r(u)&&n(u),I(q)}else n(u);m=r(u)}if(m!==null)oe=!0;else{var X=r(f);X!==null&&Te(M,X.startTime-q),oe=!1}}break e}finally{m=null,x=Re,y=!1}oe=void 0}}finally{oe?ee():Q=!1}}}var ee;if(typeof S=="function")ee=function(){S(ne)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,Se=ae.port2;ae.port1.onmessage=ne,ee=function(){Se.postMessage(null)}}else ee=function(){_(ne,0)};function Te(q,oe){U=_(function(){q(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(q){switch(x){case 1:case 2:case 3:var oe=3;break;default:oe=x}var Re=x;x=oe;try{return q()}finally{x=Re}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(q,oe){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Re=x;x=q;try{return oe()}finally{x=Re}},e.unstable_scheduleCallback=function(q,oe,Re){var ie=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?ie+Re:ie):Re=ie,q){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=Re+Me,q={id:d++,callback:oe,priorityLevel:q,startTime:Re,expirationTime:Me,sortIndex:-1},Re>ie?(q.sortIndex=Re,t(f,q),r(u)===null&&q===r(f)&&(E?(F(U),U=-1):E=!0,Te(M,Re-ie))):(q.sortIndex=Me,t(u,q),C||y||(C=!0,Q||(Q=!0,ee()))),q},e.unstable_shouldYield=te,e.unstable_wrapCallback=function(q){var oe=x;return function(){var Re=x;x=oe;try{return q.apply(this,arguments)}finally{x=Re}}}})($g)),$g}var Gy;function MU(){return Gy||(Gy=1,qg.exports=DU()),qg.exports}var Zg={exports:{}},bn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vy;function LU(){if(Vy)return bn;Vy=1;var e=Xp();function t(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},A=Symbol.for("react.portal");function s(u,f,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:m==null?null:""+m,children:u,containerInfo:f,implementation:d}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return bn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,bn.createPortal=function(u,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(u,f,null,d)},bn.flushSync=function(u){var f=l.T,d=n.p;try{if(l.T=null,n.p=2,u)return u()}finally{l.T=f,n.p=d,n.d.f()}},bn.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(u,f))},bn.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},bn.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var d=f.as,m=o(d,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:x,fetchPriority:y}):d==="script"&&n.d.X(u,{crossOrigin:m,integrity:x,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},bn.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=o(f.as,f.crossOrigin);n.d.M(u,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(u)},bn.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,m=o(d,f.crossOrigin);n.d.L(u,d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},bn.preloadModule=function(u,f){if(typeof u=="string")if(f){var d=o(f.as,f.crossOrigin);n.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(u)},bn.requestFormReset=function(u){n.d.r(u)},bn.unstable_batchedUpdates=function(u,f){return u(f)},bn.useFormState=function(u,f,d){return l.H.useFormState(u,f,d)},bn.useFormStatus=function(){return l.H.useHostTransitionStatus()},bn.version="19.2.3",bn}var Ky;function HU(){if(Ky)return Zg.exports;Ky=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Zg.exports=LU(),Zg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy;function OU(){if(jy)return dc;jy=1;var e=MU(),t=Xp(),r=HU();function n(a){var i="https://react.dev/errors/"+a;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function A(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var i=a,c=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(c=i.return),a=i.return;while(a)}return i.tag===3?c:null}function l(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function o(a){if(a.tag===31){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function u(a){if(s(a)!==a)throw Error(n(188))}function f(a){var i=a.alternate;if(!i){if(i=s(a),i===null)throw Error(n(188));return i!==a?null:a}for(var c=a,h=i;;){var w=c.return;if(w===null)break;var B=w.alternate;if(B===null){if(h=w.return,h!==null){c=h;continue}break}if(w.child===B.child){for(B=w.child;B;){if(B===c)return u(w),a;if(B===h)return u(w),i;B=B.sibling}throw Error(n(188))}if(c.return!==h.return)c=w,h=B;else{for(var b=!1,D=w.child;D;){if(D===c){b=!0,c=w,h=B;break}if(D===h){b=!0,h=w,c=B;break}D=D.sibling}if(!b){for(D=B.child;D;){if(D===c){b=!0,c=B,h=w;break}if(D===h){b=!0,h=B,c=w;break}D=D.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:i}function d(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a;for(a=a.child;a!==null;){if(i=d(a),i!==null)return i;a=a.sibling}return null}var m=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),S=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),ne=Symbol.iterator;function ee(a){return a===null||typeof a!="object"?null:(a=ne&&a[ne]||a["@@iterator"],typeof a=="function"?a:null)}var ae=Symbol.for("react.client.reference");function Se(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===ae?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case E:return"Fragment";case _:return"Profiler";case T:return"StrictMode";case M:return"Suspense";case Q:return"SuspenseList";case R:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case C:return"Portal";case S:return a.displayName||"Context";case F:return(a._context.displayName||"Context")+".Consumer";case I:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case U:return i=a.displayName||null,i!==null?i:Se(a.type)||"Memo";case G:i=a._payload,a=a._init;try{return Se(a(i))}catch{}}return null}var Te=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},ie=[],Me=-1;function X(a){return{current:a}}function k(a){0>Me||(a.current=ie[Me],ie[Me]=null,Me--)}function K(a,i){Me++,ie[Me]=a.current,a.current=i}var P=X(null),z=X(null),Z=X(null),le=X(null);function Ce(a,i){switch(K(Z,i),K(z,a),K(P,null),i.nodeType){case 9:case 11:a=(a=i.documentElement)&&(a=a.namespaceURI)?sy(a):0;break;default:if(a=i.tagName,i=i.namespaceURI)i=sy(i),a=iy(i,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}k(P),K(P,a)}function he(){k(P),k(z),k(Z)}function Ae(a){a.memoizedState!==null&&K(le,a);var i=P.current,c=iy(i,a.type);i!==c&&(K(z,a),K(P,c))}function ce(a){z.current===a&&(k(P),k(z)),le.current===a&&(k(le),lc._currentValue=Re)}var L,je;function Je(a){if(L===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);L=i&&i[1]||"",je=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+L+a+je}var et=!1;function qe(a,i){if(!a||et)return"";et=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(Ee){var ye=Ee}Reflect.construct(a,[],ke)}else{try{ke.call()}catch(Ee){ye=Ee}a.call(ke.prototype)}}else{try{throw Error()}catch(Ee){ye=Ee}(ke=a())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(Ee){if(Ee&&ye&&typeof Ee.stack=="string")return[Ee.stack,ye.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=h.DetermineComponentFrameRoot(),b=B[0],D=B[1];if(b&&D){var re=b.split(`
`),me=D.split(`
`);for(w=h=0;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;for(;w<me.length&&!me[w].includes("DetermineComponentFrameRoot");)w++;if(h===re.length||w===me.length)for(h=re.length-1,w=me.length-1;1<=h&&0<=w&&re[h]!==me[w];)w--;for(;1<=h&&0<=w;h--,w--)if(re[h]!==me[w]){if(h!==1||w!==1)do if(h--,w--,0>w||re[h]!==me[w]){var Fe=`
`+re[h].replace(" at new "," at ");return a.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",a.displayName)),Fe}while(1<=h&&0<=w);break}}}finally{et=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?Je(c):""}function De(a,i){switch(a.tag){case 26:case 27:case 5:return Je(a.type);case 16:return Je("Lazy");case 13:return a.child!==i&&i!==null?Je("Suspense Fallback"):Je("Suspense");case 19:return Je("SuspenseList");case 0:case 15:return qe(a.type,!1);case 11:return qe(a.type.render,!1);case 1:return qe(a.type,!0);case 31:return Je("Activity");default:return""}}function ct(a){try{var i="",c=null;do i+=De(a,c),c=a,a=a.return;while(a);return i}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Kt=Object.prototype.hasOwnProperty,lr=e.unstable_scheduleCallback,jt=e.unstable_cancelCallback,Ct=e.unstable_shouldYield,wr=e.unstable_requestPaint,mt=e.unstable_now,ue=e.unstable_getCurrentPriorityLevel,Ve=e.unstable_ImmediatePriority,Et=e.unstable_UserBlockingPriority,vt=e.unstable_NormalPriority,Ut=e.unstable_LowPriority,nt=e.unstable_IdlePriority,pt=e.log,Nt=e.unstable_setDisableYieldValue,yt=null,rr=null;function Or(a){if(typeof pt=="function"&&Nt(a),rr&&typeof rr.setStrictMode=="function")try{rr.setStrictMode(yt,a)}catch{}}var yr=Math.clz32?Math.clz32:Pn,or=Math.log,Tn=Math.LN2;function Pn(a){return a>>>=0,a===0?32:31-(or(a)/Tn|0)|0}var hn=256,Ca=262144,Ea=4194304;function Wn(a){var i=a&42;if(i!==0)return i;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ta(a,i,c){var h=a.pendingLanes;if(h===0)return 0;var w=0,B=a.suspendedLanes,b=a.pingedLanes;a=a.warmLanes;var D=h&134217727;return D!==0?(h=D&~B,h!==0?w=Wn(h):(b&=D,b!==0?w=Wn(b):c||(c=D&~a,c!==0&&(w=Wn(c))))):(D=h&~B,D!==0?w=Wn(D):b!==0?w=Wn(b):c||(c=h&~a,c!==0&&(w=Wn(c)))),w===0?0:i!==0&&i!==w&&(i&B)===0&&(B=w&-w,c=i&-i,B>=c||B===32&&(c&4194048)!==0)?i:w}function Sa(a,i){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&i)===0}function Zi(a,i){switch(a){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function el(){var a=Ea;return Ea<<=1,(Ea&62914560)===0&&(Ea=4194304),a}function ni(a){for(var i=[],c=0;31>c;c++)i.push(a);return i}function la(a,i){a.pendingLanes|=i,i!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Co(a,i,c,h,w,B){var b=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var D=a.entanglements,re=a.expirationTimes,me=a.hiddenUpdates;for(c=b&~c;0<c;){var Fe=31-yr(c),ke=1<<Fe;D[Fe]=0,re[Fe]=-1;var ye=me[Fe];if(ye!==null)for(me[Fe]=null,Fe=0;Fe<ye.length;Fe++){var Ee=ye[Fe];Ee!==null&&(Ee.lane&=-536870913)}c&=~ke}h!==0&&tl(a,h,0),B!==0&&w===0&&a.tag!==0&&(a.suspendedLanes|=B&~(b&~i))}function tl(a,i,c){a.pendingLanes|=i,a.suspendedLanes&=~i;var h=31-yr(i);a.entangledLanes|=i,a.entanglements[h]=a.entanglements[h]|1073741824|c&261930}function os(a,i){var c=a.entangledLanes|=i;for(a=a.entanglements;c;){var h=31-yr(c),w=1<<h;w&i|a[h]&i&&(a[h]|=i),c&=~w}}function rl(a,i){var c=i&-i;return c=(c&42)!==0?1:Ai(c),(c&(a.suspendedLanes|i))!==0?0:c}function Ai(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ai(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function N(){var a=oe.p;return a!==0?a:(a=window.event,a===void 0?32:Uy(a.type))}function j(a,i){var c=oe.p;try{return oe.p=a,i()}finally{oe.p=c}}var H=Math.random().toString(36).slice(2),O="__reactFiber$"+H,V="__reactProps$"+H,J="__reactContainer$"+H,pe="__reactEvents$"+H,be="__reactListeners$"+H,xe="__reactHandles$"+H,ve="__reactResources$"+H,we="__reactMarker$"+H;function Le(a){delete a[O],delete a[V],delete a[pe],delete a[be],delete a[xe]}function Oe(a){var i=a[O];if(i)return i;for(var c=a.parentNode;c;){if(i=c[J]||c[O]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(a=hy(a);a!==null;){if(c=a[O])return c;a=hy(a)}return i}a=c,c=a.parentNode}return null}function ze(a){if(a=a[O]||a[J]){var i=a.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return a}return null}function He(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a.stateNode;throw Error(n(33))}function Ke(a){var i=a[ve];return i||(i=a[ve]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function At(a){a[we]=!0}var cr=new Set,Ft={};function ur(a,i){Sn(a,i),Sn(a+"Capture",i)}function Sn(a,i){for(Ft[a]=i,a=0;a<i.length;a++)cr.add(i[a])}var JA=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),BA={},Gn={};function cs(a){return Kt.call(Gn,a)?!0:Kt.call(BA,a)?!1:JA.test(a)?Gn[a]=!0:(BA[a]=!0,!1)}function gn(a,i,c){if(cs(i))if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){a.removeAttribute(i);return}}a.setAttribute(i,""+c)}}function si(a,i,c){if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(i);return}a.setAttribute(i,""+c)}}function CA(a,i,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(i,c,""+h)}}function Y(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function de(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ne(a,i,c){var h=Object.getOwnPropertyDescriptor(a.constructor.prototype,i);if(!a.hasOwnProperty(i)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,B=h.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return w.call(this)},set:function(b){c=""+b,B.call(this,b)}}),Object.defineProperty(a,i,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function Ie(a){if(!a._valueTracker){var i=de(a)?"checked":"value";a._valueTracker=Ne(a,i,""+a[i])}}function Be(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return a&&(h=de(a)?a.checked?"true":"false":a.value),a=h,a!==c?(i.setValue(a),!0):!1}function Xe(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var ot=/[\n"\\]/g;function st(a){return a.replace(ot,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Gt(a,i,c,h,w,B,b,D){a.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?a.type=b:a.removeAttribute("type"),i!=null?b==="number"?(i===0&&a.value===""||a.value!=i)&&(a.value=""+Y(i)):a.value!==""+Y(i)&&(a.value=""+Y(i)):b!=="submit"&&b!=="reset"||a.removeAttribute("value"),i!=null?Rt(a,b,Y(i)):c!=null?Rt(a,b,Y(c)):h!=null&&a.removeAttribute("value"),w==null&&B!=null&&(a.defaultChecked=!!B),w!=null&&(a.checked=w&&typeof w!="function"&&typeof w!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.name=""+Y(D):a.removeAttribute("name")}function fr(a,i,c,h,w,B,b,D){if(B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(a.type=B),i!=null||c!=null){if(!(B!=="submit"&&B!=="reset"||i!=null)){Ie(a);return}c=c!=null?""+Y(c):"",i=i!=null?""+Y(i):c,D||i===a.value||(a.value=i),a.defaultValue=i}h=h??w,h=typeof h!="function"&&typeof h!="symbol"&&!!h,a.checked=D?a.checked:!!h,a.defaultChecked=!!h,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.name=b),Ie(a)}function Rt(a,i,c){i==="number"&&Xe(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function ft(a,i,c,h){if(a=a.options,i){i={};for(var w=0;w<c.length;w++)i["$"+c[w]]=!0;for(c=0;c<a.length;c++)w=i.hasOwnProperty("$"+a[c].value),a[c].selected!==w&&(a[c].selected=w),w&&h&&(a[c].defaultSelected=!0)}else{for(c=""+Y(c),i=null,w=0;w<a.length;w++){if(a[w].value===c){a[w].selected=!0,h&&(a[w].defaultSelected=!0);return}i!==null||a[w].disabled||(i=a[w])}i!==null&&(i.selected=!0)}}function Lt(a,i,c){if(i!=null&&(i=""+Y(i),i!==a.value&&(a.value=i),c==null)){a.defaultValue!==i&&(a.defaultValue=i);return}a.defaultValue=c!=null?""+Y(c):""}function kr(a,i,c,h){if(i==null){if(h!=null){if(c!=null)throw Error(n(92));if(Te(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),i=c}c=Y(i),a.defaultValue=c,h=a.textContent,h===c&&h!==""&&h!==null&&(a.value=h),Ie(a)}function Nr(a,i){if(i){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=i;return}}a.textContent=i}var _n=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function us(a,i,c){var h=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?a.setProperty(i,""):i==="float"?a.cssFloat="":a[i]="":h?a.setProperty(i,c):typeof c!="number"||c===0||_n.has(i)?i==="float"?a.cssFloat=c:a[i]=(""+c).trim():a[i]=c+"px"}function Eo(a,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(a=a.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="");for(var w in i)h=i[w],i.hasOwnProperty(w)&&c[w]!==h&&us(a,w,h)}else for(var B in i)i.hasOwnProperty(B)&&us(a,B,i[B])}function er(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function nl(a){return Fu.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function _a(){}var jd=null;function zd(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Al=null,al=null;function av(a){var i=ze(a);if(i&&(a=i.stateNode)){var c=a[V]||null;e:switch(a=i.stateNode,i.type){case"input":if(Gt(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+st(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==a&&h.form===a.form){var w=h[V]||null;if(!w)throw Error(n(90));Gt(h,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(i=0;i<c.length;i++)h=c[i],h.form===a.form&&Be(h)}break e;case"textarea":Lt(a,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&ft(a,!!c.multiple,i,!1)}}}var Xd=!1;function sv(a,i,c){if(Xd)return a(i,c);Xd=!0;try{var h=a(i);return h}finally{if(Xd=!1,(Al!==null||al!==null)&&(m0(),Al&&(i=Al,a=al,al=Al=null,av(i),a)))for(i=0;i<a.length;i++)av(a[i])}}function To(a,i){var c=a.stateNode;if(c===null)return null;var h=c[V]||null;if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(a=a.type,h=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!h;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var ba=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jd=!1;if(ba)try{var So={};Object.defineProperty(So,"passive",{get:function(){Jd=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{Jd=!1}var fs=null,Yd=null,Uu=null;function iv(){if(Uu)return Uu;var a,i=Yd,c=i.length,h,w="value"in fs?fs.value:fs.textContent,B=w.length;for(a=0;a<c&&i[a]===w[a];a++);var b=c-a;for(h=1;h<=b&&i[c-h]===w[B-h];h++);return Uu=w.slice(a,1<h?1-h:void 0)}function ku(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function Nu(){return!0}function lv(){return!1}function qn(a){function i(c,h,w,B,b){this._reactName=c,this._targetInst=w,this.type=h,this.nativeEvent=B,this.target=b,this.currentTarget=null;for(var D in a)a.hasOwnProperty(D)&&(c=a[D],this[D]=c?c(B):B[D]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?Nu:lv,this.isPropagationStopped=lv,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Nu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Nu)},persist:function(){},isPersistent:Nu}),i}var ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iu=qn(ii),_o=m({},ii,{view:0,detail:0}),Ub=qn(_o),Wd,qd,bo,Qu=m({},_o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==bo&&(bo&&a.type==="mousemove"?(Wd=a.screenX-bo.screenX,qd=a.screenY-bo.screenY):qd=Wd=0,bo=a),Wd)},movementY:function(a){return"movementY"in a?a.movementY:qd}}),ov=qn(Qu),kb=m({},Qu,{dataTransfer:0}),Nb=qn(kb),Ib=m({},_o,{relatedTarget:0}),$d=qn(Ib),Qb=m({},ii,{animationName:0,elapsedTime:0,pseudoElement:0}),Rb=qn(Qb),Db=m({},ii,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Mb=qn(Db),Lb=m({},ii,{data:0}),cv=qn(Lb),Hb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ob={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gb(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=Pb[a])?!!i[a]:!1}function Zd(){return Gb}var Vb=m({},_o,{key:function(a){if(a.key){var i=Hb[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=ku(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Ob[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zd,charCode:function(a){return a.type==="keypress"?ku(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ku(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Kb=qn(Vb),jb=m({},Qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uv=qn(jb),zb=m({},_o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zd}),Xb=qn(zb),Jb=m({},ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yb=qn(Jb),Wb=m({},Qu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),qb=qn(Wb),$b=m({},ii,{newState:0,oldState:0}),Zb=qn($b),eF=[9,13,27,32],eh=ba&&"CompositionEvent"in window,Fo=null;ba&&"documentMode"in document&&(Fo=document.documentMode);var tF=ba&&"TextEvent"in window&&!Fo,fv=ba&&(!eh||Fo&&8<Fo&&11>=Fo),dv=" ",hv=!1;function gv(a,i){switch(a){case"keyup":return eF.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mv(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var sl=!1;function rF(a,i){switch(a){case"compositionend":return mv(i);case"keypress":return i.which!==32?null:(hv=!0,dv);case"textInput":return a=i.data,a===dv&&hv?null:a;default:return null}}function nF(a,i){if(sl)return a==="compositionend"||!eh&&gv(a,i)?(a=iv(),Uu=Yd=fs=null,sl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return fv&&i.locale!=="ko"?null:i.data;default:return null}}var AF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pv(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!AF[a.type]:i==="textarea"}function xv(a,i,c,h){Al?al?al.push(h):al=[h]:Al=h,i=C0(i,"onChange"),0<i.length&&(c=new Iu("onChange","change",null,c,h),a.push({event:c,listeners:i}))}var Uo=null,ko=null;function aF(a){ey(a,0)}function Ru(a){var i=He(a);if(Be(i))return a}function vv(a,i){if(a==="change")return i}var wv=!1;if(ba){var th;if(ba){var rh="oninput"in document;if(!rh){var yv=document.createElement("div");yv.setAttribute("oninput","return;"),rh=typeof yv.oninput=="function"}th=rh}else th=!1;wv=th&&(!document.documentMode||9<document.documentMode)}function Bv(){Uo&&(Uo.detachEvent("onpropertychange",Cv),ko=Uo=null)}function Cv(a){if(a.propertyName==="value"&&Ru(ko)){var i=[];xv(i,ko,a,zd(a)),sv(aF,i)}}function sF(a,i,c){a==="focusin"?(Bv(),Uo=i,ko=c,Uo.attachEvent("onpropertychange",Cv)):a==="focusout"&&Bv()}function iF(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Ru(ko)}function lF(a,i){if(a==="click")return Ru(i)}function oF(a,i){if(a==="input"||a==="change")return Ru(i)}function cF(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var iA=typeof Object.is=="function"?Object.is:cF;function No(a,i){if(iA(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var c=Object.keys(a),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var w=c[h];if(!Kt.call(i,w)||!iA(a[w],i[w]))return!1}return!0}function Ev(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Tv(a,i){var c=Ev(a);a=0;for(var h;c;){if(c.nodeType===3){if(h=a+c.textContent.length,a<=i&&h>=i)return{node:c,offset:i-a};a=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Ev(c)}}function Sv(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?Sv(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function _v(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var i=Xe(a.document);i instanceof a.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)a=i.contentWindow;else break;i=Xe(a.document)}return i}function nh(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}var uF=ba&&"documentMode"in document&&11>=document.documentMode,il=null,Ah=null,Io=null,ah=!1;function bv(a,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ah||il==null||il!==Xe(h)||(h=il,"selectionStart"in h&&nh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Io&&No(Io,h)||(Io=h,h=C0(Ah,"onSelect"),0<h.length&&(i=new Iu("onSelect","select",null,i,c),a.push({event:i,listeners:h}),i.target=il)))}function li(a,i){var c={};return c[a.toLowerCase()]=i.toLowerCase(),c["Webkit"+a]="webkit"+i,c["Moz"+a]="moz"+i,c}var ll={animationend:li("Animation","AnimationEnd"),animationiteration:li("Animation","AnimationIteration"),animationstart:li("Animation","AnimationStart"),transitionrun:li("Transition","TransitionRun"),transitionstart:li("Transition","TransitionStart"),transitioncancel:li("Transition","TransitionCancel"),transitionend:li("Transition","TransitionEnd")},sh={},Fv={};ba&&(Fv=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function oi(a){if(sh[a])return sh[a];if(!ll[a])return a;var i=ll[a],c;for(c in i)if(i.hasOwnProperty(c)&&c in Fv)return sh[a]=i[c];return a}var Uv=oi("animationend"),kv=oi("animationiteration"),Nv=oi("animationstart"),fF=oi("transitionrun"),dF=oi("transitionstart"),hF=oi("transitioncancel"),Iv=oi("transitionend"),Qv=new Map,ih="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ih.push("scrollEnd");function YA(a,i){Qv.set(a,i),ur(i,[a])}var Du=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},EA=[],ol=0,lh=0;function Mu(){for(var a=ol,i=lh=ol=0;i<a;){var c=EA[i];EA[i++]=null;var h=EA[i];EA[i++]=null;var w=EA[i];EA[i++]=null;var B=EA[i];if(EA[i++]=null,h!==null&&w!==null){var b=h.pending;b===null?w.next=w:(w.next=b.next,b.next=w),h.pending=w}B!==0&&Rv(c,w,B)}}function Lu(a,i,c,h){EA[ol++]=a,EA[ol++]=i,EA[ol++]=c,EA[ol++]=h,lh|=h,a.lanes|=h,a=a.alternate,a!==null&&(a.lanes|=h)}function oh(a,i,c,h){return Lu(a,i,c,h),Hu(a)}function ci(a,i){return Lu(a,null,null,i),Hu(a)}function Rv(a,i,c){a.lanes|=c;var h=a.alternate;h!==null&&(h.lanes|=c);for(var w=!1,B=a.return;B!==null;)B.childLanes|=c,h=B.alternate,h!==null&&(h.childLanes|=c),B.tag===22&&(a=B.stateNode,a===null||a._visibility&1||(w=!0)),a=B,B=B.return;return a.tag===3?(B=a.stateNode,w&&i!==null&&(w=31-yr(c),a=B.hiddenUpdates,h=a[w],h===null?a[w]=[i]:h.push(i),i.lane=c|536870912),B):null}function Hu(a){if(50<tc)throw tc=0,xg=null,Error(n(185));for(var i=a.return;i!==null;)a=i,i=a.return;return a.tag===3?a.stateNode:null}var cl={};function gF(a,i,c,h){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lA(a,i,c,h){return new gF(a,i,c,h)}function ch(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Fa(a,i){var c=a.alternate;return c===null?(c=lA(a.tag,i,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=i,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,i=a.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function Dv(a,i){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,i=c.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),a}function Ou(a,i,c,h,w,B){var b=0;if(h=a,typeof a=="function")ch(a)&&(b=1);else if(typeof a=="string")b=wU(a,c,P.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case R:return a=lA(31,c,i,w),a.elementType=R,a.lanes=B,a;case E:return ui(c.children,w,B,i);case T:b=8,w|=24;break;case _:return a=lA(12,c,i,w|2),a.elementType=_,a.lanes=B,a;case M:return a=lA(13,c,i,w),a.elementType=M,a.lanes=B,a;case Q:return a=lA(19,c,i,w),a.elementType=Q,a.lanes=B,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case S:b=10;break e;case F:b=9;break e;case I:b=11;break e;case U:b=14;break e;case G:b=16,h=null;break e}b=29,c=Error(n(130,a===null?"null":typeof a,"")),h=null}return i=lA(b,c,i,w),i.elementType=a,i.type=h,i.lanes=B,i}function ui(a,i,c,h){return a=lA(7,a,h,i),a.lanes=c,a}function uh(a,i,c){return a=lA(6,a,null,i),a.lanes=c,a}function Mv(a){var i=lA(18,null,null,0);return i.stateNode=a,i}function fh(a,i,c){return i=lA(4,a.children!==null?a.children:[],a.key,i),i.lanes=c,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}var Lv=new WeakMap;function TA(a,i){if(typeof a=="object"&&a!==null){var c=Lv.get(a);return c!==void 0?c:(i={value:a,source:i,stack:ct(i)},Lv.set(a,i),i)}return{value:a,source:i,stack:ct(i)}}var ul=[],fl=0,Pu=null,Qo=0,SA=[],_A=0,ds=null,oa=1,ca="";function Ua(a,i){ul[fl++]=Qo,ul[fl++]=Pu,Pu=a,Qo=i}function Hv(a,i,c){SA[_A++]=oa,SA[_A++]=ca,SA[_A++]=ds,ds=a;var h=oa;a=ca;var w=32-yr(h)-1;h&=~(1<<w),c+=1;var B=32-yr(i)+w;if(30<B){var b=w-w%5;B=(h&(1<<b)-1).toString(32),h>>=b,w-=b,oa=1<<32-yr(i)+w|c<<w|h,ca=B+a}else oa=1<<B|c<<w|h,ca=a}function dh(a){a.return!==null&&(Ua(a,1),Hv(a,1,0))}function hh(a){for(;a===Pu;)Pu=ul[--fl],ul[fl]=null,Qo=ul[--fl],ul[fl]=null;for(;a===ds;)ds=SA[--_A],SA[_A]=null,ca=SA[--_A],SA[_A]=null,oa=SA[--_A],SA[_A]=null}function Ov(a,i){SA[_A++]=oa,SA[_A++]=ca,SA[_A++]=ds,oa=i.id,ca=i.overflow,ds=a}var mn=null,Cr=null,Vt=!1,hs=null,bA=!1,gh=Error(n(519));function gs(a){var i=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ro(TA(i,a)),gh}function Pv(a){var i=a.stateNode,c=a.type,h=a.memoizedProps;switch(i[O]=a,i[V]=h,c){case"dialog":Mt("cancel",i),Mt("close",i);break;case"iframe":case"object":case"embed":Mt("load",i);break;case"video":case"audio":for(c=0;c<nc.length;c++)Mt(nc[c],i);break;case"source":Mt("error",i);break;case"img":case"image":case"link":Mt("error",i),Mt("load",i);break;case"details":Mt("toggle",i);break;case"input":Mt("invalid",i),fr(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Mt("invalid",i);break;case"textarea":Mt("invalid",i),kr(i,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||h.suppressHydrationWarning===!0||Ay(i.textContent,c)?(h.popover!=null&&(Mt("beforetoggle",i),Mt("toggle",i)),h.onScroll!=null&&Mt("scroll",i),h.onScrollEnd!=null&&Mt("scrollend",i),h.onClick!=null&&(i.onclick=_a),i=!0):i=!1,i||gs(a,!0)}function Gv(a){for(mn=a.return;mn;)switch(mn.tag){case 5:case 31:case 13:bA=!1;return;case 27:case 3:bA=!0;return;default:mn=mn.return}}function dl(a){if(a!==mn)return!1;if(!Vt)return Gv(a),Vt=!0,!1;var i=a.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Ig(a.type,a.memoizedProps)),c=!c),c&&Cr&&gs(a),Gv(a),i===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Cr=dy(a)}else if(i===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Cr=dy(a)}else i===27?(i=Cr,Fs(a.type)?(a=Lg,Lg=null,Cr=a):Cr=i):Cr=mn?UA(a.stateNode.nextSibling):null;return!0}function fi(){Cr=mn=null,Vt=!1}function mh(){var a=hs;return a!==null&&(tA===null?tA=a:tA.push.apply(tA,a),hs=null),a}function Ro(a){hs===null?hs=[a]:hs.push(a)}var ph=X(null),di=null,ka=null;function ms(a,i,c){K(ph,i._currentValue),i._currentValue=c}function Na(a){a._currentValue=ph.current,k(ph)}function xh(a,i,c){for(;a!==null;){var h=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),a===c)break;a=a.return}}function vh(a,i,c,h){var w=a.child;for(w!==null&&(w.return=a);w!==null;){var B=w.dependencies;if(B!==null){var b=w.child;B=B.firstContext;e:for(;B!==null;){var D=B;B=w;for(var re=0;re<i.length;re++)if(D.context===i[re]){B.lanes|=c,D=B.alternate,D!==null&&(D.lanes|=c),xh(B.return,c,a),h||(b=null);break e}B=D.next}}else if(w.tag===18){if(b=w.return,b===null)throw Error(n(341));b.lanes|=c,B=b.alternate,B!==null&&(B.lanes|=c),xh(b,c,a),b=null}else b=w.child;if(b!==null)b.return=w;else for(b=w;b!==null;){if(b===a){b=null;break}if(w=b.sibling,w!==null){w.return=b.return,b=w;break}b=b.return}w=b}}function hl(a,i,c,h){a=null;for(var w=i,B=!1;w!==null;){if(!B){if((w.flags&524288)!==0)B=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var b=w.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var D=w.type;iA(w.pendingProps.value,b.value)||(a!==null?a.push(D):a=[D])}}else if(w===le.current){if(b=w.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(a!==null?a.push(lc):a=[lc])}w=w.return}a!==null&&vh(i,a,c,h),i.flags|=262144}function Gu(a){for(a=a.firstContext;a!==null;){if(!iA(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function hi(a){di=a,ka=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function pn(a){return Vv(di,a)}function Vu(a,i){return di===null&&hi(a),Vv(a,i)}function Vv(a,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},ka===null){if(a===null)throw Error(n(308));ka=i,a.dependencies={lanes:0,firstContext:i},a.flags|=524288}else ka=ka.next=i;return c}var mF=typeof AbortController<"u"?AbortController:function(){var a=[],i=this.signal={aborted:!1,addEventListener:function(c,h){a.push(h)}};this.abort=function(){i.aborted=!0,a.forEach(function(c){return c()})}},pF=e.unstable_scheduleCallback,xF=e.unstable_NormalPriority,Jr={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wh(){return{controller:new mF,data:new Map,refCount:0}}function Do(a){a.refCount--,a.refCount===0&&pF(xF,function(){a.controller.abort()})}var Mo=null,yh=0,gl=0,ml=null;function vF(a,i){if(Mo===null){var c=Mo=[];yh=0,gl=Eg(),ml={status:"pending",value:void 0,then:function(h){c.push(h)}}}return yh++,i.then(Kv,Kv),i}function Kv(){if(--yh===0&&Mo!==null){ml!==null&&(ml.status="fulfilled");var a=Mo;Mo=null,gl=0,ml=null;for(var i=0;i<a.length;i++)(0,a[i])()}}function wF(a,i){var c=[],h={status:"pending",value:null,reason:null,then:function(w){c.push(w)}};return a.then(function(){h.status="fulfilled",h.value=i;for(var w=0;w<c.length;w++)(0,c[w])(i)},function(w){for(h.status="rejected",h.reason=w,w=0;w<c.length;w++)(0,c[w])(void 0)}),h}var jv=q.S;q.S=function(a,i){bw=mt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&vF(a,i),jv!==null&&jv(a,i)};var gi=X(null);function Bh(){var a=gi.current;return a!==null?a:vr.pooledCache}function Ku(a,i){i===null?K(gi,gi.current):K(gi,i.pool)}function zv(){var a=Bh();return a===null?null:{parent:Jr._currentValue,pool:a}}var pl=Error(n(460)),Ch=Error(n(474)),ju=Error(n(542)),zu={then:function(){}};function Xv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Jv(a,i,c){switch(c=a[c],c===void 0?a.push(i):c!==i&&(i.then(_a,_a),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Wv(a),a;default:if(typeof i.status=="string")i.then(_a,_a);else{if(a=vr,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=i,a.status="pending",a.then(function(h){if(i.status==="pending"){var w=i;w.status="fulfilled",w.value=h}},function(h){if(i.status==="pending"){var w=i;w.status="rejected",w.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Wv(a),a}throw pi=i,pl}}function mi(a){try{var i=a._init;return i(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(pi=c,pl):c}}var pi=null;function Yv(){if(pi===null)throw Error(n(459));var a=pi;return pi=null,a}function Wv(a){if(a===pl||a===ju)throw Error(n(483))}var xl=null,Lo=0;function Xu(a){var i=Lo;return Lo+=1,xl===null&&(xl=[]),Jv(xl,a,i)}function Ho(a,i){i=i.props.ref,a.ref=i!==void 0?i:null}function Ju(a,i){throw i.$$typeof===x?Error(n(525)):(a=Object.prototype.toString.call(i),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)))}function qv(a){function i(fe,se){if(a){var ge=fe.deletions;ge===null?(fe.deletions=[se],fe.flags|=16):ge.push(se)}}function c(fe,se){if(!a)return null;for(;se!==null;)i(fe,se),se=se.sibling;return null}function h(fe){for(var se=new Map;fe!==null;)fe.key!==null?se.set(fe.key,fe):se.set(fe.index,fe),fe=fe.sibling;return se}function w(fe,se){return fe=Fa(fe,se),fe.index=0,fe.sibling=null,fe}function B(fe,se,ge){return fe.index=ge,a?(ge=fe.alternate,ge!==null?(ge=ge.index,ge<se?(fe.flags|=67108866,se):ge):(fe.flags|=67108866,se)):(fe.flags|=1048576,se)}function b(fe){return a&&fe.alternate===null&&(fe.flags|=67108866),fe}function D(fe,se,ge,Ue){return se===null||se.tag!==6?(se=uh(ge,fe.mode,Ue),se.return=fe,se):(se=w(se,ge),se.return=fe,se)}function re(fe,se,ge,Ue){var it=ge.type;return it===E?Fe(fe,se,ge.props.children,Ue,ge.key):se!==null&&(se.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===G&&mi(it)===se.type)?(se=w(se,ge.props),Ho(se,ge),se.return=fe,se):(se=Ou(ge.type,ge.key,ge.props,null,fe.mode,Ue),Ho(se,ge),se.return=fe,se)}function me(fe,se,ge,Ue){return se===null||se.tag!==4||se.stateNode.containerInfo!==ge.containerInfo||se.stateNode.implementation!==ge.implementation?(se=fh(ge,fe.mode,Ue),se.return=fe,se):(se=w(se,ge.children||[]),se.return=fe,se)}function Fe(fe,se,ge,Ue,it){return se===null||se.tag!==7?(se=ui(ge,fe.mode,Ue,it),se.return=fe,se):(se=w(se,ge),se.return=fe,se)}function ke(fe,se,ge){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=uh(""+se,fe.mode,ge),se.return=fe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case y:return ge=Ou(se.type,se.key,se.props,null,fe.mode,ge),Ho(ge,se),ge.return=fe,ge;case C:return se=fh(se,fe.mode,ge),se.return=fe,se;case G:return se=mi(se),ke(fe,se,ge)}if(Te(se)||ee(se))return se=ui(se,fe.mode,ge,null),se.return=fe,se;if(typeof se.then=="function")return ke(fe,Xu(se),ge);if(se.$$typeof===S)return ke(fe,Vu(fe,se),ge);Ju(fe,se)}return null}function ye(fe,se,ge,Ue){var it=se!==null?se.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return it!==null?null:D(fe,se,""+ge,Ue);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case y:return ge.key===it?re(fe,se,ge,Ue):null;case C:return ge.key===it?me(fe,se,ge,Ue):null;case G:return ge=mi(ge),ye(fe,se,ge,Ue)}if(Te(ge)||ee(ge))return it!==null?null:Fe(fe,se,ge,Ue,null);if(typeof ge.then=="function")return ye(fe,se,Xu(ge),Ue);if(ge.$$typeof===S)return ye(fe,se,Vu(fe,ge),Ue);Ju(fe,ge)}return null}function Ee(fe,se,ge,Ue,it){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return fe=fe.get(ge)||null,D(se,fe,""+Ue,it);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case y:return fe=fe.get(Ue.key===null?ge:Ue.key)||null,re(se,fe,Ue,it);case C:return fe=fe.get(Ue.key===null?ge:Ue.key)||null,me(se,fe,Ue,it);case G:return Ue=mi(Ue),Ee(fe,se,ge,Ue,it)}if(Te(Ue)||ee(Ue))return fe=fe.get(ge)||null,Fe(se,fe,Ue,it,null);if(typeof Ue.then=="function")return Ee(fe,se,ge,Xu(Ue),it);if(Ue.$$typeof===S)return Ee(fe,se,ge,Vu(se,Ue),it);Ju(se,Ue)}return null}function tt(fe,se,ge,Ue){for(var it=null,Yt=null,at=se,_t=se=0,Ot=null;at!==null&&_t<ge.length;_t++){at.index>_t?(Ot=at,at=null):Ot=at.sibling;var Wt=ye(fe,at,ge[_t],Ue);if(Wt===null){at===null&&(at=Ot);break}a&&at&&Wt.alternate===null&&i(fe,at),se=B(Wt,se,_t),Yt===null?it=Wt:Yt.sibling=Wt,Yt=Wt,at=Ot}if(_t===ge.length)return c(fe,at),Vt&&Ua(fe,_t),it;if(at===null){for(;_t<ge.length;_t++)at=ke(fe,ge[_t],Ue),at!==null&&(se=B(at,se,_t),Yt===null?it=at:Yt.sibling=at,Yt=at);return Vt&&Ua(fe,_t),it}for(at=h(at);_t<ge.length;_t++)Ot=Ee(at,fe,_t,ge[_t],Ue),Ot!==null&&(a&&Ot.alternate!==null&&at.delete(Ot.key===null?_t:Ot.key),se=B(Ot,se,_t),Yt===null?it=Ot:Yt.sibling=Ot,Yt=Ot);return a&&at.forEach(function(Qs){return i(fe,Qs)}),Vt&&Ua(fe,_t),it}function ut(fe,se,ge,Ue){if(ge==null)throw Error(n(151));for(var it=null,Yt=null,at=se,_t=se=0,Ot=null,Wt=ge.next();at!==null&&!Wt.done;_t++,Wt=ge.next()){at.index>_t?(Ot=at,at=null):Ot=at.sibling;var Qs=ye(fe,at,Wt.value,Ue);if(Qs===null){at===null&&(at=Ot);break}a&&at&&Qs.alternate===null&&i(fe,at),se=B(Qs,se,_t),Yt===null?it=Qs:Yt.sibling=Qs,Yt=Qs,at=Ot}if(Wt.done)return c(fe,at),Vt&&Ua(fe,_t),it;if(at===null){for(;!Wt.done;_t++,Wt=ge.next())Wt=ke(fe,Wt.value,Ue),Wt!==null&&(se=B(Wt,se,_t),Yt===null?it=Wt:Yt.sibling=Wt,Yt=Wt);return Vt&&Ua(fe,_t),it}for(at=h(at);!Wt.done;_t++,Wt=ge.next())Wt=Ee(at,fe,_t,Wt.value,Ue),Wt!==null&&(a&&Wt.alternate!==null&&at.delete(Wt.key===null?_t:Wt.key),se=B(Wt,se,_t),Yt===null?it=Wt:Yt.sibling=Wt,Yt=Wt);return a&&at.forEach(function(kU){return i(fe,kU)}),Vt&&Ua(fe,_t),it}function gr(fe,se,ge,Ue){if(typeof ge=="object"&&ge!==null&&ge.type===E&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case y:e:{for(var it=ge.key;se!==null;){if(se.key===it){if(it=ge.type,it===E){if(se.tag===7){c(fe,se.sibling),Ue=w(se,ge.props.children),Ue.return=fe,fe=Ue;break e}}else if(se.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===G&&mi(it)===se.type){c(fe,se.sibling),Ue=w(se,ge.props),Ho(Ue,ge),Ue.return=fe,fe=Ue;break e}c(fe,se);break}else i(fe,se);se=se.sibling}ge.type===E?(Ue=ui(ge.props.children,fe.mode,Ue,ge.key),Ue.return=fe,fe=Ue):(Ue=Ou(ge.type,ge.key,ge.props,null,fe.mode,Ue),Ho(Ue,ge),Ue.return=fe,fe=Ue)}return b(fe);case C:e:{for(it=ge.key;se!==null;){if(se.key===it)if(se.tag===4&&se.stateNode.containerInfo===ge.containerInfo&&se.stateNode.implementation===ge.implementation){c(fe,se.sibling),Ue=w(se,ge.children||[]),Ue.return=fe,fe=Ue;break e}else{c(fe,se);break}else i(fe,se);se=se.sibling}Ue=fh(ge,fe.mode,Ue),Ue.return=fe,fe=Ue}return b(fe);case G:return ge=mi(ge),gr(fe,se,ge,Ue)}if(Te(ge))return tt(fe,se,ge,Ue);if(ee(ge)){if(it=ee(ge),typeof it!="function")throw Error(n(150));return ge=it.call(ge),ut(fe,se,ge,Ue)}if(typeof ge.then=="function")return gr(fe,se,Xu(ge),Ue);if(ge.$$typeof===S)return gr(fe,se,Vu(fe,ge),Ue);Ju(fe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint"?(ge=""+ge,se!==null&&se.tag===6?(c(fe,se.sibling),Ue=w(se,ge),Ue.return=fe,fe=Ue):(c(fe,se),Ue=uh(ge,fe.mode,Ue),Ue.return=fe,fe=Ue),b(fe)):c(fe,se)}return function(fe,se,ge,Ue){try{Lo=0;var it=gr(fe,se,ge,Ue);return xl=null,it}catch(at){if(at===pl||at===ju)throw at;var Yt=lA(29,at,null,fe.mode);return Yt.lanes=Ue,Yt.return=fe,Yt}finally{}}}var xi=qv(!0),$v=qv(!1),ps=!1;function Eh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Th(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function xs(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function vs(a,i,c){var h=a.updateQueue;if(h===null)return null;if(h=h.shared,(Zt&2)!==0){var w=h.pending;return w===null?i.next=i:(i.next=w.next,w.next=i),h.pending=i,i=Hu(a),Rv(a,null,c),i}return Lu(a,h,i,c),Hu(a)}function Oo(a,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var h=i.lanes;h&=a.pendingLanes,c|=h,i.lanes=c,os(a,c)}}function Sh(a,i){var c=a.updateQueue,h=a.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var w=null,B=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};B===null?w=B=b:B=B.next=b,c=c.next}while(c!==null);B===null?w=B=i:B=B.next=i}else w=B=i;c={baseState:h.baseState,firstBaseUpdate:w,lastBaseUpdate:B,shared:h.shared,callbacks:h.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=i:a.next=i,c.lastBaseUpdate=i}var _h=!1;function Po(){if(_h){var a=ml;if(a!==null)throw a}}function Go(a,i,c,h){_h=!1;var w=a.updateQueue;ps=!1;var B=w.firstBaseUpdate,b=w.lastBaseUpdate,D=w.shared.pending;if(D!==null){w.shared.pending=null;var re=D,me=re.next;re.next=null,b===null?B=me:b.next=me,b=re;var Fe=a.alternate;Fe!==null&&(Fe=Fe.updateQueue,D=Fe.lastBaseUpdate,D!==b&&(D===null?Fe.firstBaseUpdate=me:D.next=me,Fe.lastBaseUpdate=re))}if(B!==null){var ke=w.baseState;b=0,Fe=me=re=null,D=B;do{var ye=D.lane&-536870913,Ee=ye!==D.lane;if(Ee?(Ht&ye)===ye:(h&ye)===ye){ye!==0&&ye===gl&&(_h=!0),Fe!==null&&(Fe=Fe.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var tt=a,ut=D;ye=i;var gr=c;switch(ut.tag){case 1:if(tt=ut.payload,typeof tt=="function"){ke=tt.call(gr,ke,ye);break e}ke=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=ut.payload,ye=typeof tt=="function"?tt.call(gr,ke,ye):tt,ye==null)break e;ke=m({},ke,ye);break e;case 2:ps=!0}}ye=D.callback,ye!==null&&(a.flags|=64,Ee&&(a.flags|=8192),Ee=w.callbacks,Ee===null?w.callbacks=[ye]:Ee.push(ye))}else Ee={lane:ye,tag:D.tag,payload:D.payload,callback:D.callback,next:null},Fe===null?(me=Fe=Ee,re=ke):Fe=Fe.next=Ee,b|=ye;if(D=D.next,D===null){if(D=w.shared.pending,D===null)break;Ee=D,D=Ee.next,Ee.next=null,w.lastBaseUpdate=Ee,w.shared.pending=null}}while(!0);Fe===null&&(re=ke),w.baseState=re,w.firstBaseUpdate=me,w.lastBaseUpdate=Fe,B===null&&(w.shared.lanes=0),Es|=b,a.lanes=b,a.memoizedState=ke}}function Zv(a,i){if(typeof a!="function")throw Error(n(191,a));a.call(i)}function e1(a,i){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)Zv(c[a],i)}var vl=X(null),Yu=X(0);function t1(a,i){a=Pa,K(Yu,a),K(vl,i),Pa=a|i.baseLanes}function bh(){K(Yu,Pa),K(vl,vl.current)}function Fh(){Pa=Yu.current,k(vl),k(Yu)}var oA=X(null),FA=null;function ws(a){var i=a.alternate;K(Pr,Pr.current&1),K(oA,a),FA===null&&(i===null||vl.current!==null||i.memoizedState!==null)&&(FA=a)}function Uh(a){K(Pr,Pr.current),K(oA,a),FA===null&&(FA=a)}function r1(a){a.tag===22?(K(Pr,Pr.current),K(oA,a),FA===null&&(FA=a)):ys()}function ys(){K(Pr,Pr.current),K(oA,oA.current)}function cA(a){k(oA),FA===a&&(FA=null),k(Pr)}var Pr=X(0);function Wu(a){for(var i=a;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Dg(c)||Mg(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ia=0,Tt=null,dr=null,Yr=null,qu=!1,wl=!1,vi=!1,$u=0,Vo=0,yl=null,yF=0;function Rr(){throw Error(n(321))}function kh(a,i){if(i===null)return!1;for(var c=0;c<i.length&&c<a.length;c++)if(!iA(a[c],i[c]))return!1;return!0}function Nh(a,i,c,h,w,B){return Ia=B,Tt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,q.H=a===null||a.memoizedState===null?H1:Xh,vi=!1,B=c(h,w),vi=!1,wl&&(B=A1(i,c,h,w)),n1(a),B}function n1(a){q.H=zo;var i=dr!==null&&dr.next!==null;if(Ia=0,Yr=dr=Tt=null,qu=!1,Vo=0,yl=null,i)throw Error(n(300));a===null||Wr||(a=a.dependencies,a!==null&&Gu(a)&&(Wr=!0))}function A1(a,i,c,h){Tt=a;var w=0;do{if(wl&&(yl=null),Vo=0,wl=!1,25<=w)throw Error(n(301));if(w+=1,Yr=dr=null,a.updateQueue!=null){var B=a.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}q.H=O1,B=i(c,h)}while(wl);return B}function BF(){var a=q.H,i=a.useState()[0];return i=typeof i.then=="function"?Ko(i):i,a=a.useState()[0],(dr!==null?dr.memoizedState:null)!==a&&(Tt.flags|=1024),i}function Ih(){var a=$u!==0;return $u=0,a}function Qh(a,i,c){i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~c}function Rh(a){if(qu){for(a=a.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}qu=!1}Ia=0,Yr=dr=Tt=null,wl=!1,Vo=$u=0,yl=null}function Vn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?Tt.memoizedState=Yr=a:Yr=Yr.next=a,Yr}function Gr(){if(dr===null){var a=Tt.alternate;a=a!==null?a.memoizedState:null}else a=dr.next;var i=Yr===null?Tt.memoizedState:Yr.next;if(i!==null)Yr=i,dr=a;else{if(a===null)throw Tt.alternate===null?Error(n(467)):Error(n(310));dr=a,a={memoizedState:dr.memoizedState,baseState:dr.baseState,baseQueue:dr.baseQueue,queue:dr.queue,next:null},Yr===null?Tt.memoizedState=Yr=a:Yr=Yr.next=a}return Yr}function Zu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ko(a){var i=Vo;return Vo+=1,yl===null&&(yl=[]),a=Jv(yl,a,i),i=Tt,(Yr===null?i.memoizedState:Yr.next)===null&&(i=i.alternate,q.H=i===null||i.memoizedState===null?H1:Xh),a}function e0(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ko(a);if(a.$$typeof===S)return pn(a)}throw Error(n(438,String(a)))}function Dh(a){var i=null,c=Tt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var h=Tt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(w){return w.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=Zu(),Tt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(a),h=0;h<a;h++)c[h]=te;return i.index++,c}function Qa(a,i){return typeof i=="function"?i(a):i}function t0(a){var i=Gr();return Mh(i,dr,a)}function Mh(a,i,c){var h=a.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var w=a.baseQueue,B=h.pending;if(B!==null){if(w!==null){var b=w.next;w.next=B.next,B.next=b}i.baseQueue=w=B,h.pending=null}if(B=a.baseState,w===null)a.memoizedState=B;else{i=w.next;var D=b=null,re=null,me=i,Fe=!1;do{var ke=me.lane&-536870913;if(ke!==me.lane?(Ht&ke)===ke:(Ia&ke)===ke){var ye=me.revertLane;if(ye===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),ke===gl&&(Fe=!0);else if((Ia&ye)===ye){me=me.next,ye===gl&&(Fe=!0);continue}else ke={lane:0,revertLane:me.revertLane,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(D=re=ke,b=B):re=re.next=ke,Tt.lanes|=ye,Es|=ye;ke=me.action,vi&&c(B,ke),B=me.hasEagerState?me.eagerState:c(B,ke)}else ye={lane:ke,revertLane:me.revertLane,gesture:me.gesture,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(D=re=ye,b=B):re=re.next=ye,Tt.lanes|=ke,Es|=ke;me=me.next}while(me!==null&&me!==i);if(re===null?b=B:re.next=D,!iA(B,a.memoizedState)&&(Wr=!0,Fe&&(c=ml,c!==null)))throw c;a.memoizedState=B,a.baseState=b,a.baseQueue=re,h.lastRenderedState=B}return w===null&&(h.lanes=0),[a.memoizedState,h.dispatch]}function Lh(a){var i=Gr(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var h=c.dispatch,w=c.pending,B=i.memoizedState;if(w!==null){c.pending=null;var b=w=w.next;do B=a(B,b.action),b=b.next;while(b!==w);iA(B,i.memoizedState)||(Wr=!0),i.memoizedState=B,i.baseQueue===null&&(i.baseState=B),c.lastRenderedState=B}return[B,h]}function a1(a,i,c){var h=Tt,w=Gr(),B=Vt;if(B){if(c===void 0)throw Error(n(407));c=c()}else c=i();var b=!iA((dr||w).memoizedState,c);if(b&&(w.memoizedState=c,Wr=!0),w=w.queue,Ph(l1.bind(null,h,w,a),[a]),w.getSnapshot!==i||b||Yr!==null&&Yr.memoizedState.tag&1){if(h.flags|=2048,Bl(9,{destroy:void 0},i1.bind(null,h,w,c,i),null),vr===null)throw Error(n(349));B||(Ia&127)!==0||s1(h,i,c)}return c}function s1(a,i,c){a.flags|=16384,a={getSnapshot:i,value:c},i=Tt.updateQueue,i===null?(i=Zu(),Tt.updateQueue=i,i.stores=[a]):(c=i.stores,c===null?i.stores=[a]:c.push(a))}function i1(a,i,c,h){i.value=c,i.getSnapshot=h,o1(i)&&c1(a)}function l1(a,i,c){return c(function(){o1(i)&&c1(a)})}function o1(a){var i=a.getSnapshot;a=a.value;try{var c=i();return!iA(a,c)}catch{return!0}}function c1(a){var i=ci(a,2);i!==null&&rA(i,a,2)}function Hh(a){var i=Vn();if(typeof a=="function"){var c=a;if(a=c(),vi){Or(!0);try{c()}finally{Or(!1)}}}return i.memoizedState=i.baseState=a,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:a},i}function u1(a,i,c,h){return a.baseState=c,Mh(a,dr,typeof h=="function"?h:Qa)}function CF(a,i,c,h,w){if(A0(a))throw Error(n(485));if(a=i.action,a!==null){var B={payload:w,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){B.listeners.push(b)}};q.T!==null?c(!0):B.isTransition=!1,h(B),c=i.pending,c===null?(B.next=i.pending=B,f1(i,B)):(B.next=c.next,i.pending=c.next=B)}}function f1(a,i){var c=i.action,h=i.payload,w=a.state;if(i.isTransition){var B=q.T,b={};q.T=b;try{var D=c(w,h),re=q.S;re!==null&&re(b,D),d1(a,i,D)}catch(me){Oh(a,i,me)}finally{B!==null&&b.types!==null&&(B.types=b.types),q.T=B}}else try{B=c(w,h),d1(a,i,B)}catch(me){Oh(a,i,me)}}function d1(a,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){h1(a,i,h)},function(h){return Oh(a,i,h)}):h1(a,i,c)}function h1(a,i,c){i.status="fulfilled",i.value=c,g1(i),a.state=c,i=a.pending,i!==null&&(c=i.next,c===i?a.pending=null:(c=c.next,i.next=c,f1(a,c)))}function Oh(a,i,c){var h=a.pending;if(a.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=c,g1(i),i=i.next;while(i!==h)}a.action=null}function g1(a){a=a.listeners;for(var i=0;i<a.length;i++)(0,a[i])()}function m1(a,i){return i}function p1(a,i){if(Vt){var c=vr.formState;if(c!==null){e:{var h=Tt;if(Vt){if(Cr){t:{for(var w=Cr,B=bA;w.nodeType!==8;){if(!B){w=null;break t}if(w=UA(w.nextSibling),w===null){w=null;break t}}B=w.data,w=B==="F!"||B==="F"?w:null}if(w){Cr=UA(w.nextSibling),h=w.data==="F!";break e}}gs(h)}h=!1}h&&(i=c[0])}}return c=Vn(),c.memoizedState=c.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m1,lastRenderedState:i},c.queue=h,c=D1.bind(null,Tt,h),h.dispatch=c,h=Hh(!1),B=zh.bind(null,Tt,!1,h.queue),h=Vn(),w={state:i,dispatch:null,action:a,pending:null},h.queue=w,c=CF.bind(null,Tt,w,B,c),w.dispatch=c,h.memoizedState=a,[i,c,!1]}function x1(a){var i=Gr();return v1(i,dr,a)}function v1(a,i,c){if(i=Mh(a,i,m1)[0],a=t0(Qa)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=Ko(i)}catch(b){throw b===pl?ju:b}else h=i;i=Gr();var w=i.queue,B=w.dispatch;return c!==i.memoizedState&&(Tt.flags|=2048,Bl(9,{destroy:void 0},EF.bind(null,w,c),null)),[h,B,a]}function EF(a,i){a.action=i}function w1(a){var i=Gr(),c=dr;if(c!==null)return v1(i,c,a);Gr(),i=i.memoizedState,c=Gr();var h=c.queue.dispatch;return c.memoizedState=a,[i,h,!1]}function Bl(a,i,c,h){return a={tag:a,create:c,deps:h,inst:i,next:null},i=Tt.updateQueue,i===null&&(i=Zu(),Tt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=a.next=a:(h=c.next,c.next=a,a.next=h,i.lastEffect=a),a}function y1(){return Gr().memoizedState}function r0(a,i,c,h){var w=Vn();Tt.flags|=a,w.memoizedState=Bl(1|i,{destroy:void 0},c,h===void 0?null:h)}function n0(a,i,c,h){var w=Gr();h=h===void 0?null:h;var B=w.memoizedState.inst;dr!==null&&h!==null&&kh(h,dr.memoizedState.deps)?w.memoizedState=Bl(i,B,c,h):(Tt.flags|=a,w.memoizedState=Bl(1|i,B,c,h))}function B1(a,i){r0(8390656,8,a,i)}function Ph(a,i){n0(2048,8,a,i)}function TF(a){Tt.flags|=4;var i=Tt.updateQueue;if(i===null)i=Zu(),Tt.updateQueue=i,i.events=[a];else{var c=i.events;c===null?i.events=[a]:c.push(a)}}function C1(a){var i=Gr().memoizedState;return TF({ref:i,nextImpl:a}),function(){if((Zt&2)!==0)throw Error(n(440));return i.impl.apply(void 0,arguments)}}function E1(a,i){return n0(4,2,a,i)}function T1(a,i){return n0(4,4,a,i)}function S1(a,i){if(typeof i=="function"){a=a();var c=i(a);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function _1(a,i,c){c=c!=null?c.concat([a]):null,n0(4,4,S1.bind(null,i,a),c)}function Gh(){}function b1(a,i){var c=Gr();i=i===void 0?null:i;var h=c.memoizedState;return i!==null&&kh(i,h[1])?h[0]:(c.memoizedState=[a,i],a)}function F1(a,i){var c=Gr();i=i===void 0?null:i;var h=c.memoizedState;if(i!==null&&kh(i,h[1]))return h[0];if(h=a(),vi){Or(!0);try{a()}finally{Or(!1)}}return c.memoizedState=[h,i],h}function Vh(a,i,c){return c===void 0||(Ia&1073741824)!==0&&(Ht&261930)===0?a.memoizedState=i:(a.memoizedState=c,a=Uw(),Tt.lanes|=a,Es|=a,c)}function U1(a,i,c,h){return iA(c,i)?c:vl.current!==null?(a=Vh(a,c,h),iA(a,i)||(Wr=!0),a):(Ia&42)===0||(Ia&1073741824)!==0&&(Ht&261930)===0?(Wr=!0,a.memoizedState=c):(a=Uw(),Tt.lanes|=a,Es|=a,i)}function k1(a,i,c,h,w){var B=oe.p;oe.p=B!==0&&8>B?B:8;var b=q.T,D={};q.T=D,zh(a,!1,i,c);try{var re=w(),me=q.S;if(me!==null&&me(D,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Fe=wF(re,h);jo(a,i,Fe,dA(a))}else jo(a,i,h,dA(a))}catch(ke){jo(a,i,{then:function(){},status:"rejected",reason:ke},dA())}finally{oe.p=B,b!==null&&D.types!==null&&(b.types=D.types),q.T=b}}function SF(){}function Kh(a,i,c,h){if(a.tag!==5)throw Error(n(476));var w=N1(a).queue;k1(a,w,i,Re,c===null?SF:function(){return I1(a),c(h)})}function N1(a){var i=a.memoizedState;if(i!==null)return i;i={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:Re},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:c},next:null},a.memoizedState=i,a=a.alternate,a!==null&&(a.memoizedState=i),i}function I1(a){var i=N1(a);i.next===null&&(i=a.alternate.memoizedState),jo(a,i.next.queue,{},dA())}function jh(){return pn(lc)}function Q1(){return Gr().memoizedState}function R1(){return Gr().memoizedState}function _F(a){for(var i=a.return;i!==null;){switch(i.tag){case 24:case 3:var c=dA();a=xs(c);var h=vs(i,a,c);h!==null&&(rA(h,i,c),Oo(h,i,c)),i={cache:wh()},a.payload=i;return}i=i.return}}function bF(a,i,c){var h=dA();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},A0(a)?M1(i,c):(c=oh(a,i,c,h),c!==null&&(rA(c,a,h),L1(c,i,h)))}function D1(a,i,c){var h=dA();jo(a,i,c,h)}function jo(a,i,c,h){var w={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(A0(a))M1(i,w);else{var B=a.alternate;if(a.lanes===0&&(B===null||B.lanes===0)&&(B=i.lastRenderedReducer,B!==null))try{var b=i.lastRenderedState,D=B(b,c);if(w.hasEagerState=!0,w.eagerState=D,iA(D,b))return Lu(a,i,w,0),vr===null&&Mu(),!1}catch{}finally{}if(c=oh(a,i,w,h),c!==null)return rA(c,a,h),L1(c,i,h),!0}return!1}function zh(a,i,c,h){if(h={lane:2,revertLane:Eg(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},A0(a)){if(i)throw Error(n(479))}else i=oh(a,c,h,2),i!==null&&rA(i,a,2)}function A0(a){var i=a.alternate;return a===Tt||i!==null&&i===Tt}function M1(a,i){wl=qu=!0;var c=a.pending;c===null?i.next=i:(i.next=c.next,c.next=i),a.pending=i}function L1(a,i,c){if((c&4194048)!==0){var h=i.lanes;h&=a.pendingLanes,c|=h,i.lanes=c,os(a,c)}}var zo={readContext:pn,use:e0,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useLayoutEffect:Rr,useInsertionEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useSyncExternalStore:Rr,useId:Rr,useHostTransitionStatus:Rr,useFormState:Rr,useActionState:Rr,useOptimistic:Rr,useMemoCache:Rr,useCacheRefresh:Rr};zo.useEffectEvent=Rr;var H1={readContext:pn,use:e0,useCallback:function(a,i){return Vn().memoizedState=[a,i===void 0?null:i],a},useContext:pn,useEffect:B1,useImperativeHandle:function(a,i,c){c=c!=null?c.concat([a]):null,r0(4194308,4,S1.bind(null,i,a),c)},useLayoutEffect:function(a,i){return r0(4194308,4,a,i)},useInsertionEffect:function(a,i){r0(4,2,a,i)},useMemo:function(a,i){var c=Vn();i=i===void 0?null:i;var h=a();if(vi){Or(!0);try{a()}finally{Or(!1)}}return c.memoizedState=[h,i],h},useReducer:function(a,i,c){var h=Vn();if(c!==void 0){var w=c(i);if(vi){Or(!0);try{c(i)}finally{Or(!1)}}}else w=i;return h.memoizedState=h.baseState=w,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:w},h.queue=a,a=a.dispatch=bF.bind(null,Tt,a),[h.memoizedState,a]},useRef:function(a){var i=Vn();return a={current:a},i.memoizedState=a},useState:function(a){a=Hh(a);var i=a.queue,c=D1.bind(null,Tt,i);return i.dispatch=c,[a.memoizedState,c]},useDebugValue:Gh,useDeferredValue:function(a,i){var c=Vn();return Vh(c,a,i)},useTransition:function(){var a=Hh(!1);return a=k1.bind(null,Tt,a.queue,!0,!1),Vn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,i,c){var h=Tt,w=Vn();if(Vt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),vr===null)throw Error(n(349));(Ht&127)!==0||s1(h,i,c)}w.memoizedState=c;var B={value:c,getSnapshot:i};return w.queue=B,B1(l1.bind(null,h,B,a),[a]),h.flags|=2048,Bl(9,{destroy:void 0},i1.bind(null,h,B,c,i),null),c},useId:function(){var a=Vn(),i=vr.identifierPrefix;if(Vt){var c=ca,h=oa;c=(h&~(1<<32-yr(h)-1)).toString(32)+c,i="_"+i+"R_"+c,c=$u++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=yF++,i="_"+i+"r_"+c.toString(32)+"_";return a.memoizedState=i},useHostTransitionStatus:jh,useFormState:p1,useActionState:p1,useOptimistic:function(a){var i=Vn();i.memoizedState=i.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=zh.bind(null,Tt,!0,c),c.dispatch=i,[a,i]},useMemoCache:Dh,useCacheRefresh:function(){return Vn().memoizedState=_F.bind(null,Tt)},useEffectEvent:function(a){var i=Vn(),c={impl:a};return i.memoizedState=c,function(){if((Zt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Xh={readContext:pn,use:e0,useCallback:b1,useContext:pn,useEffect:Ph,useImperativeHandle:_1,useInsertionEffect:E1,useLayoutEffect:T1,useMemo:F1,useReducer:t0,useRef:y1,useState:function(){return t0(Qa)},useDebugValue:Gh,useDeferredValue:function(a,i){var c=Gr();return U1(c,dr.memoizedState,a,i)},useTransition:function(){var a=t0(Qa)[0],i=Gr().memoizedState;return[typeof a=="boolean"?a:Ko(a),i]},useSyncExternalStore:a1,useId:Q1,useHostTransitionStatus:jh,useFormState:x1,useActionState:x1,useOptimistic:function(a,i){var c=Gr();return u1(c,dr,a,i)},useMemoCache:Dh,useCacheRefresh:R1};Xh.useEffectEvent=C1;var O1={readContext:pn,use:e0,useCallback:b1,useContext:pn,useEffect:Ph,useImperativeHandle:_1,useInsertionEffect:E1,useLayoutEffect:T1,useMemo:F1,useReducer:Lh,useRef:y1,useState:function(){return Lh(Qa)},useDebugValue:Gh,useDeferredValue:function(a,i){var c=Gr();return dr===null?Vh(c,a,i):U1(c,dr.memoizedState,a,i)},useTransition:function(){var a=Lh(Qa)[0],i=Gr().memoizedState;return[typeof a=="boolean"?a:Ko(a),i]},useSyncExternalStore:a1,useId:Q1,useHostTransitionStatus:jh,useFormState:w1,useActionState:w1,useOptimistic:function(a,i){var c=Gr();return dr!==null?u1(c,dr,a,i):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:Dh,useCacheRefresh:R1};O1.useEffectEvent=C1;function Jh(a,i,c,h){i=a.memoizedState,c=c(h,i),c=c==null?i:m({},i,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Yh={enqueueSetState:function(a,i,c){a=a._reactInternals;var h=dA(),w=xs(h);w.payload=i,c!=null&&(w.callback=c),i=vs(a,w,h),i!==null&&(rA(i,a,h),Oo(i,a,h))},enqueueReplaceState:function(a,i,c){a=a._reactInternals;var h=dA(),w=xs(h);w.tag=1,w.payload=i,c!=null&&(w.callback=c),i=vs(a,w,h),i!==null&&(rA(i,a,h),Oo(i,a,h))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var c=dA(),h=xs(c);h.tag=2,i!=null&&(h.callback=i),i=vs(a,h,c),i!==null&&(rA(i,a,c),Oo(i,a,c))}};function P1(a,i,c,h,w,B,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(h,B,b):i.prototype&&i.prototype.isPureReactComponent?!No(c,h)||!No(w,B):!0}function G1(a,i,c,h){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==a&&Yh.enqueueReplaceState(i,i.state,null)}function wi(a,i){var c=i;if("ref"in i){c={};for(var h in i)h!=="ref"&&(c[h]=i[h])}if(a=a.defaultProps){c===i&&(c=m({},c));for(var w in a)c[w]===void 0&&(c[w]=a[w])}return c}function V1(a){Du(a)}function K1(a){console.error(a)}function j1(a){Du(a)}function a0(a,i){try{var c=a.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function z1(a,i,c){try{var h=a.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function Wh(a,i,c){return c=xs(c),c.tag=3,c.payload={element:null},c.callback=function(){a0(a,i)},c}function X1(a){return a=xs(a),a.tag=3,a}function J1(a,i,c,h){var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var B=h.value;a.payload=function(){return w(B)},a.callback=function(){z1(i,c,h)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){z1(i,c,h),typeof w!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var D=h.stack;this.componentDidCatch(h.value,{componentStack:D!==null?D:""})})}function FF(a,i,c,h,w){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=c.alternate,i!==null&&hl(i,c,w,!0),c=oA.current,c!==null){switch(c.tag){case 31:case 13:return FA===null?p0():c.alternate===null&&Dr===0&&(Dr=3),c.flags&=-257,c.flags|=65536,c.lanes=w,h===zu?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([h]):i.add(h),yg(a,h,w)),!1;case 22:return c.flags|=65536,h===zu?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([h]):c.add(h)),yg(a,h,w)),!1}throw Error(n(435,c.tag))}return yg(a,h,w),p0(),!1}if(Vt)return i=oA.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=w,h!==gh&&(a=Error(n(422),{cause:h}),Ro(TA(a,c)))):(h!==gh&&(i=Error(n(423),{cause:h}),Ro(TA(i,c))),a=a.current.alternate,a.flags|=65536,w&=-w,a.lanes|=w,h=TA(h,c),w=Wh(a.stateNode,h,w),Sh(a,w),Dr!==4&&(Dr=2)),!1;var B=Error(n(520),{cause:h});if(B=TA(B,c),ec===null?ec=[B]:ec.push(B),Dr!==4&&(Dr=2),i===null)return!0;h=TA(h,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,a=w&-w,c.lanes|=a,a=Wh(c.stateNode,h,a),Sh(c,a),!1;case 1:if(i=c.type,B=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Ts===null||!Ts.has(B))))return c.flags|=65536,w&=-w,c.lanes|=w,w=X1(w),J1(w,a,c,h),Sh(c,w),!1}c=c.return}while(c!==null);return!1}var qh=Error(n(461)),Wr=!1;function xn(a,i,c,h){i.child=a===null?$v(i,null,c,h):xi(i,a.child,c,h)}function Y1(a,i,c,h,w){c=c.render;var B=i.ref;if("ref"in h){var b={};for(var D in h)D!=="ref"&&(b[D]=h[D])}else b=h;return hi(i),h=Nh(a,i,c,b,B,w),D=Ih(),a!==null&&!Wr?(Qh(a,i,w),Ra(a,i,w)):(Vt&&D&&dh(i),i.flags|=1,xn(a,i,h,w),i.child)}function W1(a,i,c,h,w){if(a===null){var B=c.type;return typeof B=="function"&&!ch(B)&&B.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=B,q1(a,i,B,h,w)):(a=Ou(c.type,null,h,i,i.mode,w),a.ref=i.ref,a.return=i,i.child=a)}if(B=a.child,!ag(a,w)){var b=B.memoizedProps;if(c=c.compare,c=c!==null?c:No,c(b,h)&&a.ref===i.ref)return Ra(a,i,w)}return i.flags|=1,a=Fa(B,h),a.ref=i.ref,a.return=i,i.child=a}function q1(a,i,c,h,w){if(a!==null){var B=a.memoizedProps;if(No(B,h)&&a.ref===i.ref)if(Wr=!1,i.pendingProps=h=B,ag(a,w))(a.flags&131072)!==0&&(Wr=!0);else return i.lanes=a.lanes,Ra(a,i,w)}return $h(a,i,c,h,w)}function $1(a,i,c,h){var w=h.children,B=a!==null?a.memoizedState:null;if(a===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((i.flags&128)!==0){if(B=B!==null?B.baseLanes|c:c,a!==null){for(h=i.child=a.child,w=0;h!==null;)w=w|h.lanes|h.childLanes,h=h.sibling;h=w&~B}else h=0,i.child=null;return Z1(a,i,B,c,h)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},a!==null&&Ku(i,B!==null?B.cachePool:null),B!==null?t1(i,B):bh(),r1(i);else return h=i.lanes=536870912,Z1(a,i,B!==null?B.baseLanes|c:c,c,h)}else B!==null?(Ku(i,B.cachePool),t1(i,B),ys(),i.memoizedState=null):(a!==null&&Ku(i,null),bh(),ys());return xn(a,i,w,c),i.child}function Xo(a,i){return a!==null&&a.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Z1(a,i,c,h,w){var B=Bh();return B=B===null?null:{parent:Jr._currentValue,pool:B},i.memoizedState={baseLanes:c,cachePool:B},a!==null&&Ku(i,null),bh(),r1(i),a!==null&&hl(a,i,h,!0),i.childLanes=w,null}function s0(a,i){return i=l0({mode:i.mode,children:i.children},a.mode),i.ref=a.ref,a.child=i,i.return=a,i}function ew(a,i,c){return xi(i,a.child,null,c),a=s0(i,i.pendingProps),a.flags|=2,cA(i),i.memoizedState=null,a}function UF(a,i,c){var h=i.pendingProps,w=(i.flags&128)!==0;if(i.flags&=-129,a===null){if(Vt){if(h.mode==="hidden")return a=s0(i,h),i.lanes=536870912,Xo(null,a);if(Uh(i),(a=Cr)?(a=fy(a,bA),a=a!==null&&a.data==="&"?a:null,a!==null&&(i.memoizedState={dehydrated:a,treeContext:ds!==null?{id:oa,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},c=Mv(a),c.return=i,i.child=c,mn=i,Cr=null)):a=null,a===null)throw gs(i);return i.lanes=536870912,null}return s0(i,h)}var B=a.memoizedState;if(B!==null){var b=B.dehydrated;if(Uh(i),w)if(i.flags&256)i.flags&=-257,i=ew(a,i,c);else if(i.memoizedState!==null)i.child=a.child,i.flags|=128,i=null;else throw Error(n(558));else if(Wr||hl(a,i,c,!1),w=(c&a.childLanes)!==0,Wr||w){if(h=vr,h!==null&&(b=rl(h,c),b!==0&&b!==B.retryLane))throw B.retryLane=b,ci(a,b),rA(h,a,b),qh;p0(),i=ew(a,i,c)}else a=B.treeContext,Cr=UA(b.nextSibling),mn=i,Vt=!0,hs=null,bA=!1,a!==null&&Ov(i,a),i=s0(i,h),i.flags|=4096;return i}return a=Fa(a.child,{mode:h.mode,children:h.children}),a.ref=i.ref,i.child=a,a.return=i,a}function i0(a,i){var c=i.ref;if(c===null)a!==null&&a.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(i.flags|=4194816)}}function $h(a,i,c,h,w){return hi(i),c=Nh(a,i,c,h,void 0,w),h=Ih(),a!==null&&!Wr?(Qh(a,i,w),Ra(a,i,w)):(Vt&&h&&dh(i),i.flags|=1,xn(a,i,c,w),i.child)}function tw(a,i,c,h,w,B){return hi(i),i.updateQueue=null,c=A1(i,h,c,w),n1(a),h=Ih(),a!==null&&!Wr?(Qh(a,i,B),Ra(a,i,B)):(Vt&&h&&dh(i),i.flags|=1,xn(a,i,c,B),i.child)}function rw(a,i,c,h,w){if(hi(i),i.stateNode===null){var B=cl,b=c.contextType;typeof b=="object"&&b!==null&&(B=pn(b)),B=new c(h,B),i.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=Yh,i.stateNode=B,B._reactInternals=i,B=i.stateNode,B.props=h,B.state=i.memoizedState,B.refs={},Eh(i),b=c.contextType,B.context=typeof b=="object"&&b!==null?pn(b):cl,B.state=i.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(Jh(i,c,b,h),B.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(b=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),b!==B.state&&Yh.enqueueReplaceState(B,B.state,null),Go(i,h,B,w),Po(),B.state=i.memoizedState),typeof B.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(a===null){B=i.stateNode;var D=i.memoizedProps,re=wi(c,D);B.props=re;var me=B.context,Fe=c.contextType;b=cl,typeof Fe=="object"&&Fe!==null&&(b=pn(Fe));var ke=c.getDerivedStateFromProps;Fe=typeof ke=="function"||typeof B.getSnapshotBeforeUpdate=="function",D=i.pendingProps!==D,Fe||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(D||me!==b)&&G1(i,B,h,b),ps=!1;var ye=i.memoizedState;B.state=ye,Go(i,h,B,w),Po(),me=i.memoizedState,D||ye!==me||ps?(typeof ke=="function"&&(Jh(i,c,ke,h),me=i.memoizedState),(re=ps||P1(i,c,re,h,ye,me,b))?(Fe||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(i.flags|=4194308)):(typeof B.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=me),B.props=h,B.state=me,B.context=b,h=re):(typeof B.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{B=i.stateNode,Th(a,i),b=i.memoizedProps,Fe=wi(c,b),B.props=Fe,ke=i.pendingProps,ye=B.context,me=c.contextType,re=cl,typeof me=="object"&&me!==null&&(re=pn(me)),D=c.getDerivedStateFromProps,(me=typeof D=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(b!==ke||ye!==re)&&G1(i,B,h,re),ps=!1,ye=i.memoizedState,B.state=ye,Go(i,h,B,w),Po();var Ee=i.memoizedState;b!==ke||ye!==Ee||ps||a!==null&&a.dependencies!==null&&Gu(a.dependencies)?(typeof D=="function"&&(Jh(i,c,D,h),Ee=i.memoizedState),(Fe=ps||P1(i,c,Fe,h,ye,Ee,re)||a!==null&&a.dependencies!==null&&Gu(a.dependencies))?(me||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(h,Ee,re),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(h,Ee,re)),typeof B.componentDidUpdate=="function"&&(i.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof B.componentDidUpdate!="function"||b===a.memoizedProps&&ye===a.memoizedState||(i.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&ye===a.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Ee),B.props=h,B.state=Ee,B.context=re,h=Fe):(typeof B.componentDidUpdate!="function"||b===a.memoizedProps&&ye===a.memoizedState||(i.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&ye===a.memoizedState||(i.flags|=1024),h=!1)}return B=h,i0(a,i),h=(i.flags&128)!==0,B||h?(B=i.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:B.render(),i.flags|=1,a!==null&&h?(i.child=xi(i,a.child,null,w),i.child=xi(i,null,c,w)):xn(a,i,c,w),i.memoizedState=B.state,a=i.child):a=Ra(a,i,w),a}function nw(a,i,c,h){return fi(),i.flags|=256,xn(a,i,c,h),i.child}var Zh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function eg(a){return{baseLanes:a,cachePool:zv()}}function tg(a,i,c){return a=a!==null?a.childLanes&~c:0,i&&(a|=fA),a}function Aw(a,i,c){var h=i.pendingProps,w=!1,B=(i.flags&128)!==0,b;if((b=B)||(b=a!==null&&a.memoizedState===null?!1:(Pr.current&2)!==0),b&&(w=!0,i.flags&=-129),b=(i.flags&32)!==0,i.flags&=-33,a===null){if(Vt){if(w?ws(i):ys(),(a=Cr)?(a=fy(a,bA),a=a!==null&&a.data!=="&"?a:null,a!==null&&(i.memoizedState={dehydrated:a,treeContext:ds!==null?{id:oa,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},c=Mv(a),c.return=i,i.child=c,mn=i,Cr=null)):a=null,a===null)throw gs(i);return Mg(a)?i.lanes=32:i.lanes=536870912,null}var D=h.children;return h=h.fallback,w?(ys(),w=i.mode,D=l0({mode:"hidden",children:D},w),h=ui(h,w,c,null),D.return=i,h.return=i,D.sibling=h,i.child=D,h=i.child,h.memoizedState=eg(c),h.childLanes=tg(a,b,c),i.memoizedState=Zh,Xo(null,h)):(ws(i),rg(i,D))}var re=a.memoizedState;if(re!==null&&(D=re.dehydrated,D!==null)){if(B)i.flags&256?(ws(i),i.flags&=-257,i=ng(a,i,c)):i.memoizedState!==null?(ys(),i.child=a.child,i.flags|=128,i=null):(ys(),D=h.fallback,w=i.mode,h=l0({mode:"visible",children:h.children},w),D=ui(D,w,c,null),D.flags|=2,h.return=i,D.return=i,h.sibling=D,i.child=h,xi(i,a.child,null,c),h=i.child,h.memoizedState=eg(c),h.childLanes=tg(a,b,c),i.memoizedState=Zh,i=Xo(null,h));else if(ws(i),Mg(D)){if(b=D.nextSibling&&D.nextSibling.dataset,b)var me=b.dgst;b=me,h=Error(n(419)),h.stack="",h.digest=b,Ro({value:h,source:null,stack:null}),i=ng(a,i,c)}else if(Wr||hl(a,i,c,!1),b=(c&a.childLanes)!==0,Wr||b){if(b=vr,b!==null&&(h=rl(b,c),h!==0&&h!==re.retryLane))throw re.retryLane=h,ci(a,h),rA(b,a,h),qh;Dg(D)||p0(),i=ng(a,i,c)}else Dg(D)?(i.flags|=192,i.child=a.child,i=null):(a=re.treeContext,Cr=UA(D.nextSibling),mn=i,Vt=!0,hs=null,bA=!1,a!==null&&Ov(i,a),i=rg(i,h.children),i.flags|=4096);return i}return w?(ys(),D=h.fallback,w=i.mode,re=a.child,me=re.sibling,h=Fa(re,{mode:"hidden",children:h.children}),h.subtreeFlags=re.subtreeFlags&65011712,me!==null?D=Fa(me,D):(D=ui(D,w,c,null),D.flags|=2),D.return=i,h.return=i,h.sibling=D,i.child=h,Xo(null,h),h=i.child,D=a.child.memoizedState,D===null?D=eg(c):(w=D.cachePool,w!==null?(re=Jr._currentValue,w=w.parent!==re?{parent:re,pool:re}:w):w=zv(),D={baseLanes:D.baseLanes|c,cachePool:w}),h.memoizedState=D,h.childLanes=tg(a,b,c),i.memoizedState=Zh,Xo(a.child,h)):(ws(i),c=a.child,a=c.sibling,c=Fa(c,{mode:"visible",children:h.children}),c.return=i,c.sibling=null,a!==null&&(b=i.deletions,b===null?(i.deletions=[a],i.flags|=16):b.push(a)),i.child=c,i.memoizedState=null,c)}function rg(a,i){return i=l0({mode:"visible",children:i},a.mode),i.return=a,a.child=i}function l0(a,i){return a=lA(22,a,null,i),a.lanes=0,a}function ng(a,i,c){return xi(i,a.child,null,c),a=rg(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function aw(a,i,c){a.lanes|=i;var h=a.alternate;h!==null&&(h.lanes|=i),xh(a.return,i,c)}function Ag(a,i,c,h,w,B){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:w,treeForkCount:B}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=c,b.tailMode=w,b.treeForkCount=B)}function sw(a,i,c){var h=i.pendingProps,w=h.revealOrder,B=h.tail;h=h.children;var b=Pr.current,D=(b&2)!==0;if(D?(b=b&1|2,i.flags|=128):b&=1,K(Pr,b),xn(a,i,h,c),h=Vt?Qo:0,!D&&a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&aw(a,c,i);else if(a.tag===19)aw(a,c,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(w){case"forwards":for(c=i.child,w=null;c!==null;)a=c.alternate,a!==null&&Wu(a)===null&&(w=c),c=c.sibling;c=w,c===null?(w=i.child,i.child=null):(w=c.sibling,c.sibling=null),Ag(i,!1,w,c,B,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,w=i.child,i.child=null;w!==null;){if(a=w.alternate,a!==null&&Wu(a)===null){i.child=w;break}a=w.sibling,w.sibling=c,c=w,w=a}Ag(i,!0,c,null,B,h);break;case"together":Ag(i,!1,null,null,void 0,h);break;default:i.memoizedState=null}return i.child}function Ra(a,i,c){if(a!==null&&(i.dependencies=a.dependencies),Es|=i.lanes,(c&i.childLanes)===0)if(a!==null){if(hl(a,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(a!==null&&i.child!==a.child)throw Error(n(153));if(i.child!==null){for(a=i.child,c=Fa(a,a.pendingProps),i.child=c,c.return=i;a.sibling!==null;)a=a.sibling,c=c.sibling=Fa(a,a.pendingProps),c.return=i;c.sibling=null}return i.child}function ag(a,i){return(a.lanes&i)!==0?!0:(a=a.dependencies,!!(a!==null&&Gu(a)))}function kF(a,i,c){switch(i.tag){case 3:Ce(i,i.stateNode.containerInfo),ms(i,Jr,a.memoizedState.cache),fi();break;case 27:case 5:Ae(i);break;case 4:Ce(i,i.stateNode.containerInfo);break;case 10:ms(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Uh(i),null;break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(ws(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Aw(a,i,c):(ws(i),a=Ra(a,i,c),a!==null?a.sibling:null);ws(i);break;case 19:var w=(a.flags&128)!==0;if(h=(c&i.childLanes)!==0,h||(hl(a,i,c,!1),h=(c&i.childLanes)!==0),w){if(h)return sw(a,i,c);i.flags|=128}if(w=i.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),K(Pr,Pr.current),h)break;return null;case 22:return i.lanes=0,$1(a,i,c,i.pendingProps);case 24:ms(i,Jr,a.memoizedState.cache)}return Ra(a,i,c)}function iw(a,i,c){if(a!==null)if(a.memoizedProps!==i.pendingProps)Wr=!0;else{if(!ag(a,c)&&(i.flags&128)===0)return Wr=!1,kF(a,i,c);Wr=(a.flags&131072)!==0}else Wr=!1,Vt&&(i.flags&1048576)!==0&&Hv(i,Qo,i.index);switch(i.lanes=0,i.tag){case 16:e:{var h=i.pendingProps;if(a=mi(i.elementType),i.type=a,typeof a=="function")ch(a)?(h=wi(a,h),i.tag=1,i=rw(null,i,a,h,c)):(i.tag=0,i=$h(null,i,a,h,c));else{if(a!=null){var w=a.$$typeof;if(w===I){i.tag=11,i=Y1(null,i,a,h,c);break e}else if(w===U){i.tag=14,i=W1(null,i,a,h,c);break e}}throw i=Se(a)||a,Error(n(306,i,""))}}return i;case 0:return $h(a,i,i.type,i.pendingProps,c);case 1:return h=i.type,w=wi(h,i.pendingProps),rw(a,i,h,w,c);case 3:e:{if(Ce(i,i.stateNode.containerInfo),a===null)throw Error(n(387));h=i.pendingProps;var B=i.memoizedState;w=B.element,Th(a,i),Go(i,h,null,c);var b=i.memoizedState;if(h=b.cache,ms(i,Jr,h),h!==B.cache&&vh(i,[Jr],c,!0),Po(),h=b.element,B.isDehydrated)if(B={element:h,isDehydrated:!1,cache:b.cache},i.updateQueue.baseState=B,i.memoizedState=B,i.flags&256){i=nw(a,i,h,c);break e}else if(h!==w){w=TA(Error(n(424)),i),Ro(w),i=nw(a,i,h,c);break e}else{switch(a=i.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Cr=UA(a.firstChild),mn=i,Vt=!0,hs=null,bA=!0,c=$v(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(fi(),h===w){i=Ra(a,i,c);break e}xn(a,i,h,c)}i=i.child}return i;case 26:return i0(a,i),a===null?(c=xy(i.type,null,i.pendingProps,null))?i.memoizedState=c:Vt||(c=i.type,a=i.pendingProps,h=E0(Z.current).createElement(c),h[O]=i,h[V]=a,vn(h,c,a),At(h),i.stateNode=h):i.memoizedState=xy(i.type,a.memoizedProps,i.pendingProps,a.memoizedState),null;case 27:return Ae(i),a===null&&Vt&&(h=i.stateNode=gy(i.type,i.pendingProps,Z.current),mn=i,bA=!0,w=Cr,Fs(i.type)?(Lg=w,Cr=UA(h.firstChild)):Cr=w),xn(a,i,i.pendingProps.children,c),i0(a,i),a===null&&(i.flags|=4194304),i.child;case 5:return a===null&&Vt&&((w=h=Cr)&&(h=iU(h,i.type,i.pendingProps,bA),h!==null?(i.stateNode=h,mn=i,Cr=UA(h.firstChild),bA=!1,w=!0):w=!1),w||gs(i)),Ae(i),w=i.type,B=i.pendingProps,b=a!==null?a.memoizedProps:null,h=B.children,Ig(w,B)?h=null:b!==null&&Ig(w,b)&&(i.flags|=32),i.memoizedState!==null&&(w=Nh(a,i,BF,null,null,c),lc._currentValue=w),i0(a,i),xn(a,i,h,c),i.child;case 6:return a===null&&Vt&&((a=c=Cr)&&(c=lU(c,i.pendingProps,bA),c!==null?(i.stateNode=c,mn=i,Cr=null,a=!0):a=!1),a||gs(i)),null;case 13:return Aw(a,i,c);case 4:return Ce(i,i.stateNode.containerInfo),h=i.pendingProps,a===null?i.child=xi(i,null,h,c):xn(a,i,h,c),i.child;case 11:return Y1(a,i,i.type,i.pendingProps,c);case 7:return xn(a,i,i.pendingProps,c),i.child;case 8:return xn(a,i,i.pendingProps.children,c),i.child;case 12:return xn(a,i,i.pendingProps.children,c),i.child;case 10:return h=i.pendingProps,ms(i,i.type,h.value),xn(a,i,h.children,c),i.child;case 9:return w=i.type._context,h=i.pendingProps.children,hi(i),w=pn(w),h=h(w),i.flags|=1,xn(a,i,h,c),i.child;case 14:return W1(a,i,i.type,i.pendingProps,c);case 15:return q1(a,i,i.type,i.pendingProps,c);case 19:return sw(a,i,c);case 31:return UF(a,i,c);case 22:return $1(a,i,c,i.pendingProps);case 24:return hi(i),h=pn(Jr),a===null?(w=Bh(),w===null&&(w=vr,B=wh(),w.pooledCache=B,B.refCount++,B!==null&&(w.pooledCacheLanes|=c),w=B),i.memoizedState={parent:h,cache:w},Eh(i),ms(i,Jr,w)):((a.lanes&c)!==0&&(Th(a,i),Go(i,null,null,c),Po()),w=a.memoizedState,B=i.memoizedState,w.parent!==h?(w={parent:h,cache:h},i.memoizedState=w,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=w),ms(i,Jr,h)):(h=B.cache,ms(i,Jr,h),h!==w.cache&&vh(i,[Jr],c,!0))),xn(a,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function Da(a){a.flags|=4}function sg(a,i,c,h,w){if((i=(a.mode&32)!==0)&&(i=!1),i){if(a.flags|=16777216,(w&335544128)===w)if(a.stateNode.complete)a.flags|=8192;else if(Qw())a.flags|=8192;else throw pi=zu,Ch}else a.flags&=-16777217}function lw(a,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Cy(i))if(Qw())a.flags|=8192;else throw pi=zu,Ch}function o0(a,i){i!==null&&(a.flags|=4),a.flags&16384&&(i=a.tag!==22?el():536870912,a.lanes|=i,Sl|=i)}function Jo(a,i){if(!Vt)switch(a.tailMode){case"hidden":i=a.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:h.sibling=null}}function Er(a){var i=a.alternate!==null&&a.alternate.child===a.child,c=0,h=0;if(i)for(var w=a.child;w!==null;)c|=w.lanes|w.childLanes,h|=w.subtreeFlags&65011712,h|=w.flags&65011712,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)c|=w.lanes|w.childLanes,h|=w.subtreeFlags,h|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=h,a.childLanes=c,i}function NF(a,i,c){var h=i.pendingProps;switch(hh(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(i),null;case 1:return Er(i),null;case 3:return c=i.stateNode,h=null,a!==null&&(h=a.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),Na(Jr),he(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(dl(i)?Da(i):a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,mh())),Er(i),null;case 26:var w=i.type,B=i.memoizedState;return a===null?(Da(i),B!==null?(Er(i),lw(i,B)):(Er(i),sg(i,w,null,h,c))):B?B!==a.memoizedState?(Da(i),Er(i),lw(i,B)):(Er(i),i.flags&=-16777217):(a=a.memoizedProps,a!==h&&Da(i),Er(i),sg(i,w,a,h,c)),null;case 27:if(ce(i),c=Z.current,w=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==h&&Da(i);else{if(!h){if(i.stateNode===null)throw Error(n(166));return Er(i),null}a=P.current,dl(i)?Pv(i):(a=gy(w,h,c),i.stateNode=a,Da(i))}return Er(i),null;case 5:if(ce(i),w=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==h&&Da(i);else{if(!h){if(i.stateNode===null)throw Error(n(166));return Er(i),null}if(B=P.current,dl(i))Pv(i);else{var b=E0(Z.current);switch(B){case 1:B=b.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:B=b.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":B=b.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":B=b.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":B=b.createElement("div"),B.innerHTML="<script><\/script>",B=B.removeChild(B.firstChild);break;case"select":B=typeof h.is=="string"?b.createElement("select",{is:h.is}):b.createElement("select"),h.multiple?B.multiple=!0:h.size&&(B.size=h.size);break;default:B=typeof h.is=="string"?b.createElement(w,{is:h.is}):b.createElement(w)}}B[O]=i,B[V]=h;e:for(b=i.child;b!==null;){if(b.tag===5||b.tag===6)B.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===i)break e;for(;b.sibling===null;){if(b.return===null||b.return===i)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}i.stateNode=B;e:switch(vn(B,w,h),w){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Da(i)}}return Er(i),sg(i,i.type,a===null?null:a.memoizedProps,i.pendingProps,c),null;case 6:if(a&&i.stateNode!=null)a.memoizedProps!==h&&Da(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(n(166));if(a=Z.current,dl(i)){if(a=i.stateNode,c=i.memoizedProps,h=null,w=mn,w!==null)switch(w.tag){case 27:case 5:h=w.memoizedProps}a[O]=i,a=!!(a.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Ay(a.nodeValue,c)),a||gs(i,!0)}else a=E0(a).createTextNode(h),a[O]=i,i.stateNode=a}return Er(i),null;case 31:if(c=i.memoizedState,a===null||a.memoizedState!==null){if(h=dl(i),c!==null){if(a===null){if(!h)throw Error(n(318));if(a=i.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[O]=i}else fi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Er(i),a=!1}else c=mh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return i.flags&256?(cA(i),i):(cA(i),null);if((i.flags&128)!==0)throw Error(n(558))}return Er(i),null;case 13:if(h=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(w=dl(i),h!==null&&h.dehydrated!==null){if(a===null){if(!w)throw Error(n(318));if(w=i.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[O]=i}else fi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Er(i),w=!1}else w=mh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=w),w=!0;if(!w)return i.flags&256?(cA(i),i):(cA(i),null)}return cA(i),(i.flags&128)!==0?(i.lanes=c,i):(c=h!==null,a=a!==null&&a.memoizedState!==null,c&&(h=i.child,w=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(w=h.alternate.memoizedState.cachePool.pool),B=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(B=h.memoizedState.cachePool.pool),B!==w&&(h.flags|=2048)),c!==a&&c&&(i.child.flags|=8192),o0(i,i.updateQueue),Er(i),null);case 4:return he(),a===null&&bg(i.stateNode.containerInfo),Er(i),null;case 10:return Na(i.type),Er(i),null;case 19:if(k(Pr),h=i.memoizedState,h===null)return Er(i),null;if(w=(i.flags&128)!==0,B=h.rendering,B===null)if(w)Jo(h,!1);else{if(Dr!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(B=Wu(a),B!==null){for(i.flags|=128,Jo(h,!1),a=B.updateQueue,i.updateQueue=a,o0(i,a),i.subtreeFlags=0,a=c,c=i.child;c!==null;)Dv(c,a),c=c.sibling;return K(Pr,Pr.current&1|2),Vt&&Ua(i,h.treeForkCount),i.child}a=a.sibling}h.tail!==null&&mt()>h0&&(i.flags|=128,w=!0,Jo(h,!1),i.lanes=4194304)}else{if(!w)if(a=Wu(B),a!==null){if(i.flags|=128,w=!0,a=a.updateQueue,i.updateQueue=a,o0(i,a),Jo(h,!0),h.tail===null&&h.tailMode==="hidden"&&!B.alternate&&!Vt)return Er(i),null}else 2*mt()-h.renderingStartTime>h0&&c!==536870912&&(i.flags|=128,w=!0,Jo(h,!1),i.lanes=4194304);h.isBackwards?(B.sibling=i.child,i.child=B):(a=h.last,a!==null?a.sibling=B:i.child=B,h.last=B)}return h.tail!==null?(a=h.tail,h.rendering=a,h.tail=a.sibling,h.renderingStartTime=mt(),a.sibling=null,c=Pr.current,K(Pr,w?c&1|2:c&1),Vt&&Ua(i,h.treeForkCount),a):(Er(i),null);case 22:case 23:return cA(i),Fh(),h=i.memoizedState!==null,a!==null?a.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(c&536870912)!==0&&(i.flags&128)===0&&(Er(i),i.subtreeFlags&6&&(i.flags|=8192)):Er(i),c=i.updateQueue,c!==null&&o0(i,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==c&&(i.flags|=2048),a!==null&&k(gi),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Na(Jr),Er(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function IF(a,i){switch(hh(i),i.tag){case 1:return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return Na(Jr),he(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 26:case 27:case 5:return ce(i),null;case 31:if(i.memoizedState!==null){if(cA(i),i.alternate===null)throw Error(n(340));fi()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 13:if(cA(i),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(n(340));fi()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return k(Pr),null;case 4:return he(),null;case 10:return Na(i.type),null;case 22:case 23:return cA(i),Fh(),a!==null&&k(gi),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 24:return Na(Jr),null;case 25:return null;default:return null}}function ow(a,i){switch(hh(i),i.tag){case 3:Na(Jr),he();break;case 26:case 27:case 5:ce(i);break;case 4:he();break;case 31:i.memoizedState!==null&&cA(i);break;case 13:cA(i);break;case 19:k(Pr);break;case 10:Na(i.type);break;case 22:case 23:cA(i),Fh(),a!==null&&k(gi);break;case 24:Na(Jr)}}function Yo(a,i){try{var c=i.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var w=h.next;c=w;do{if((c.tag&a)===a){h=void 0;var B=c.create,b=c.inst;h=B(),b.destroy=h}c=c.next}while(c!==w)}}catch(D){Ar(i,i.return,D)}}function Bs(a,i,c){try{var h=i.updateQueue,w=h!==null?h.lastEffect:null;if(w!==null){var B=w.next;h=B;do{if((h.tag&a)===a){var b=h.inst,D=b.destroy;if(D!==void 0){b.destroy=void 0,w=i;var re=c,me=D;try{me()}catch(Fe){Ar(w,re,Fe)}}}h=h.next}while(h!==B)}}catch(Fe){Ar(i,i.return,Fe)}}function cw(a){var i=a.updateQueue;if(i!==null){var c=a.stateNode;try{e1(i,c)}catch(h){Ar(a,a.return,h)}}}function uw(a,i,c){c.props=wi(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(h){Ar(a,i,h)}}function Wo(a,i){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var h=a.stateNode;break;case 30:h=a.stateNode;break;default:h=a.stateNode}typeof c=="function"?a.refCleanup=c(h):c.current=h}}catch(w){Ar(a,i,w)}}function ua(a,i){var c=a.ref,h=a.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(w){Ar(a,i,w)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(w){Ar(a,i,w)}else c.current=null}function fw(a){var i=a.type,c=a.memoizedProps,h=a.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(w){Ar(a,a.return,w)}}function ig(a,i,c){try{var h=a.stateNode;tU(h,a.type,c,i),h[V]=i}catch(w){Ar(a,a.return,w)}}function dw(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Fs(a.type)||a.tag===4}function lg(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||dw(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Fs(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function og(a,i,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(a),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=_a));else if(h!==4&&(h===27&&Fs(a.type)&&(c=a.stateNode,i=null),a=a.child,a!==null))for(og(a,i,c),a=a.sibling;a!==null;)og(a,i,c),a=a.sibling}function c0(a,i,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,i?c.insertBefore(a,i):c.appendChild(a);else if(h!==4&&(h===27&&Fs(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(c0(a,i,c),a=a.sibling;a!==null;)c0(a,i,c),a=a.sibling}function hw(a){var i=a.stateNode,c=a.memoizedProps;try{for(var h=a.type,w=i.attributes;w.length;)i.removeAttributeNode(w[0]);vn(i,h,c),i[O]=a,i[V]=c}catch(B){Ar(a,a.return,B)}}var Ma=!1,qr=!1,cg=!1,gw=typeof WeakSet=="function"?WeakSet:Set,ln=null;function QF(a,i){if(a=a.containerInfo,kg=k0,a=_v(a),nh(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var w=h.anchorOffset,B=h.focusNode;h=h.focusOffset;try{c.nodeType,B.nodeType}catch{c=null;break e}var b=0,D=-1,re=-1,me=0,Fe=0,ke=a,ye=null;t:for(;;){for(var Ee;ke!==c||w!==0&&ke.nodeType!==3||(D=b+w),ke!==B||h!==0&&ke.nodeType!==3||(re=b+h),ke.nodeType===3&&(b+=ke.nodeValue.length),(Ee=ke.firstChild)!==null;)ye=ke,ke=Ee;for(;;){if(ke===a)break t;if(ye===c&&++me===w&&(D=b),ye===B&&++Fe===h&&(re=b),(Ee=ke.nextSibling)!==null)break;ke=ye,ye=ke.parentNode}ke=Ee}c=D===-1||re===-1?null:{start:D,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(Ng={focusedElem:a,selectionRange:c},k0=!1,ln=i;ln!==null;)if(i=ln,a=i.child,(i.subtreeFlags&1028)!==0&&a!==null)a.return=i,ln=a;else for(;ln!==null;){switch(i=ln,B=i.alternate,a=i.flags,i.tag){case 0:if((a&4)!==0&&(a=i.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)w=a[c],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&B!==null){a=void 0,c=i,w=B.memoizedProps,B=B.memoizedState,h=c.stateNode;try{var tt=wi(c.type,w);a=h.getSnapshotBeforeUpdate(tt,B),h.__reactInternalSnapshotBeforeUpdate=a}catch(ut){Ar(c,c.return,ut)}}break;case 3:if((a&1024)!==0){if(a=i.stateNode.containerInfo,c=a.nodeType,c===9)Rg(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Rg(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=i.sibling,a!==null){a.return=i.return,ln=a;break}ln=i.return}}function mw(a,i,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Ha(a,c),h&4&&Yo(5,c);break;case 1:if(Ha(a,c),h&4)if(a=c.stateNode,i===null)try{a.componentDidMount()}catch(b){Ar(c,c.return,b)}else{var w=wi(c.type,i.memoizedProps);i=i.memoizedState;try{a.componentDidUpdate(w,i,a.__reactInternalSnapshotBeforeUpdate)}catch(b){Ar(c,c.return,b)}}h&64&&cw(c),h&512&&Wo(c,c.return);break;case 3:if(Ha(a,c),h&64&&(a=c.updateQueue,a!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{e1(a,i)}catch(b){Ar(c,c.return,b)}}break;case 27:i===null&&h&4&&hw(c);case 26:case 5:Ha(a,c),i===null&&h&4&&fw(c),h&512&&Wo(c,c.return);break;case 12:Ha(a,c);break;case 31:Ha(a,c),h&4&&vw(a,c);break;case 13:Ha(a,c),h&4&&ww(a,c),h&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=VF.bind(null,c),oU(a,c))));break;case 22:if(h=c.memoizedState!==null||Ma,!h){i=i!==null&&i.memoizedState!==null||qr,w=Ma;var B=qr;Ma=h,(qr=i)&&!B?Oa(a,c,(c.subtreeFlags&8772)!==0):Ha(a,c),Ma=w,qr=B}break;case 30:break;default:Ha(a,c)}}function pw(a){var i=a.alternate;i!==null&&(a.alternate=null,pw(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&Le(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var br=null,$n=!1;function La(a,i,c){for(c=c.child;c!==null;)xw(a,i,c),c=c.sibling}function xw(a,i,c){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(yt,c)}catch{}switch(c.tag){case 26:qr||ua(c,i),La(a,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:qr||ua(c,i);var h=br,w=$n;Fs(c.type)&&(br=c.stateNode,$n=!1),La(a,i,c),ac(c.stateNode),br=h,$n=w;break;case 5:qr||ua(c,i);case 6:if(h=br,w=$n,br=null,La(a,i,c),br=h,$n=w,br!==null)if($n)try{(br.nodeType===9?br.body:br.nodeName==="HTML"?br.ownerDocument.body:br).removeChild(c.stateNode)}catch(B){Ar(c,i,B)}else try{br.removeChild(c.stateNode)}catch(B){Ar(c,i,B)}break;case 18:br!==null&&($n?(a=br,cy(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),Ql(a)):cy(br,c.stateNode));break;case 4:h=br,w=$n,br=c.stateNode.containerInfo,$n=!0,La(a,i,c),br=h,$n=w;break;case 0:case 11:case 14:case 15:Bs(2,c,i),qr||Bs(4,c,i),La(a,i,c);break;case 1:qr||(ua(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"&&uw(c,i,h)),La(a,i,c);break;case 21:La(a,i,c);break;case 22:qr=(h=qr)||c.memoizedState!==null,La(a,i,c),qr=h;break;default:La(a,i,c)}}function vw(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Ql(a)}catch(c){Ar(i,i.return,c)}}}function ww(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Ql(a)}catch(c){Ar(i,i.return,c)}}function RF(a){switch(a.tag){case 31:case 13:case 19:var i=a.stateNode;return i===null&&(i=a.stateNode=new gw),i;case 22:return a=a.stateNode,i=a._retryCache,i===null&&(i=a._retryCache=new gw),i;default:throw Error(n(435,a.tag))}}function u0(a,i){var c=RF(a);i.forEach(function(h){if(!c.has(h)){c.add(h);var w=KF.bind(null,a,h);h.then(w,w)}})}function Zn(a,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var w=c[h],B=a,b=i,D=b;e:for(;D!==null;){switch(D.tag){case 27:if(Fs(D.type)){br=D.stateNode,$n=!1;break e}break;case 5:br=D.stateNode,$n=!1;break e;case 3:case 4:br=D.stateNode.containerInfo,$n=!0;break e}D=D.return}if(br===null)throw Error(n(160));xw(B,b,w),br=null,$n=!1,B=w.alternate,B!==null&&(B.return=null),w.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)yw(i,a),i=i.sibling}var WA=null;function yw(a,i){var c=a.alternate,h=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Zn(i,a),eA(a),h&4&&(Bs(3,a,a.return),Yo(3,a),Bs(5,a,a.return));break;case 1:Zn(i,a),eA(a),h&512&&(qr||c===null||ua(c,c.return)),h&64&&Ma&&(a=a.updateQueue,a!==null&&(h=a.callbacks,h!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var w=WA;if(Zn(i,a),eA(a),h&512&&(qr||c===null||ua(c,c.return)),h&4){var B=c!==null?c.memoizedState:null;if(h=a.memoizedState,c===null)if(h===null)if(a.stateNode===null){e:{h=a.type,c=a.memoizedProps,w=w.ownerDocument||w;t:switch(h){case"title":B=w.getElementsByTagName("title")[0],(!B||B[we]||B[O]||B.namespaceURI==="http://www.w3.org/2000/svg"||B.hasAttribute("itemprop"))&&(B=w.createElement(h),w.head.insertBefore(B,w.querySelector("head > title"))),vn(B,h,c),B[O]=a,At(B),h=B;break e;case"link":var b=yy("link","href",w).get(h+(c.href||""));if(b){for(var D=0;D<b.length;D++)if(B=b[D],B.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&B.getAttribute("rel")===(c.rel==null?null:c.rel)&&B.getAttribute("title")===(c.title==null?null:c.title)&&B.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(D,1);break t}}B=w.createElement(h),vn(B,h,c),w.head.appendChild(B);break;case"meta":if(b=yy("meta","content",w).get(h+(c.content||""))){for(D=0;D<b.length;D++)if(B=b[D],B.getAttribute("content")===(c.content==null?null:""+c.content)&&B.getAttribute("name")===(c.name==null?null:c.name)&&B.getAttribute("property")===(c.property==null?null:c.property)&&B.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&B.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(D,1);break t}}B=w.createElement(h),vn(B,h,c),w.head.appendChild(B);break;default:throw Error(n(468,h))}B[O]=a,At(B),h=B}a.stateNode=h}else By(w,a.type,a.stateNode);else a.stateNode=wy(w,h,a.memoizedProps);else B!==h?(B===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):B.count--,h===null?By(w,a.type,a.stateNode):wy(w,h,a.memoizedProps)):h===null&&a.stateNode!==null&&ig(a,a.memoizedProps,c.memoizedProps)}break;case 27:Zn(i,a),eA(a),h&512&&(qr||c===null||ua(c,c.return)),c!==null&&h&4&&ig(a,a.memoizedProps,c.memoizedProps);break;case 5:if(Zn(i,a),eA(a),h&512&&(qr||c===null||ua(c,c.return)),a.flags&32){w=a.stateNode;try{Nr(w,"")}catch(tt){Ar(a,a.return,tt)}}h&4&&a.stateNode!=null&&(w=a.memoizedProps,ig(a,w,c!==null?c.memoizedProps:w)),h&1024&&(cg=!0);break;case 6:if(Zn(i,a),eA(a),h&4){if(a.stateNode===null)throw Error(n(162));h=a.memoizedProps,c=a.stateNode;try{c.nodeValue=h}catch(tt){Ar(a,a.return,tt)}}break;case 3:if(_0=null,w=WA,WA=T0(i.containerInfo),Zn(i,a),WA=w,eA(a),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Ql(i.containerInfo)}catch(tt){Ar(a,a.return,tt)}cg&&(cg=!1,Bw(a));break;case 4:h=WA,WA=T0(a.stateNode.containerInfo),Zn(i,a),eA(a),WA=h;break;case 12:Zn(i,a),eA(a);break;case 31:Zn(i,a),eA(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,u0(a,h)));break;case 13:Zn(i,a),eA(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(d0=mt()),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,u0(a,h)));break;case 22:w=a.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,me=Ma,Fe=qr;if(Ma=me||w,qr=Fe||re,Zn(i,a),qr=Fe,Ma=me,eA(a),h&8192)e:for(i=a.stateNode,i._visibility=w?i._visibility&-2:i._visibility|1,w&&(c===null||re||Ma||qr||yi(a)),c=null,i=a;;){if(i.tag===5||i.tag===26){if(c===null){re=c=i;try{if(B=re.stateNode,w)b=B.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{D=re.stateNode;var ke=re.memoizedProps.style,ye=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;D.style.display=ye==null||typeof ye=="boolean"?"":(""+ye).trim()}}catch(tt){Ar(re,re.return,tt)}}}else if(i.tag===6){if(c===null){re=i;try{re.stateNode.nodeValue=w?"":re.memoizedProps}catch(tt){Ar(re,re.return,tt)}}}else if(i.tag===18){if(c===null){re=i;try{var Ee=re.stateNode;w?uy(Ee,!0):uy(re.stateNode,!1)}catch(tt){Ar(re,re.return,tt)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=a.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,u0(a,c))));break;case 19:Zn(i,a),eA(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,u0(a,h)));break;case 30:break;case 21:break;default:Zn(i,a),eA(a)}}function eA(a){var i=a.flags;if(i&2){try{for(var c,h=a.return;h!==null;){if(dw(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var w=c.stateNode,B=lg(a);c0(a,B,w);break;case 5:var b=c.stateNode;c.flags&32&&(Nr(b,""),c.flags&=-33);var D=lg(a);c0(a,D,b);break;case 3:case 4:var re=c.stateNode.containerInfo,me=lg(a);og(a,me,re);break;default:throw Error(n(161))}}catch(Fe){Ar(a,a.return,Fe)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function Bw(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var i=a;Bw(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),a=a.sibling}}function Ha(a,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)mw(a,i.alternate,i),i=i.sibling}function yi(a){for(a=a.child;a!==null;){var i=a;switch(i.tag){case 0:case 11:case 14:case 15:Bs(4,i,i.return),yi(i);break;case 1:ua(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&uw(i,i.return,c),yi(i);break;case 27:ac(i.stateNode);case 26:case 5:ua(i,i.return),yi(i);break;case 22:i.memoizedState===null&&yi(i);break;case 30:yi(i);break;default:yi(i)}a=a.sibling}}function Oa(a,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,w=a,B=i,b=B.flags;switch(B.tag){case 0:case 11:case 15:Oa(w,B,c),Yo(4,B);break;case 1:if(Oa(w,B,c),h=B,w=h.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(me){Ar(h,h.return,me)}if(h=B,w=h.updateQueue,w!==null){var D=h.stateNode;try{var re=w.shared.hiddenCallbacks;if(re!==null)for(w.shared.hiddenCallbacks=null,w=0;w<re.length;w++)Zv(re[w],D)}catch(me){Ar(h,h.return,me)}}c&&b&64&&cw(B),Wo(B,B.return);break;case 27:hw(B);case 26:case 5:Oa(w,B,c),c&&h===null&&b&4&&fw(B),Wo(B,B.return);break;case 12:Oa(w,B,c);break;case 31:Oa(w,B,c),c&&b&4&&vw(w,B);break;case 13:Oa(w,B,c),c&&b&4&&ww(w,B);break;case 22:B.memoizedState===null&&Oa(w,B,c),Wo(B,B.return);break;case 30:break;default:Oa(w,B,c)}i=i.sibling}}function ug(a,i){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&Do(c))}function fg(a,i){a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&Do(a))}function qA(a,i,c,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Cw(a,i,c,h),i=i.sibling}function Cw(a,i,c,h){var w=i.flags;switch(i.tag){case 0:case 11:case 15:qA(a,i,c,h),w&2048&&Yo(9,i);break;case 1:qA(a,i,c,h);break;case 3:qA(a,i,c,h),w&2048&&(a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&Do(a)));break;case 12:if(w&2048){qA(a,i,c,h),a=i.stateNode;try{var B=i.memoizedProps,b=B.id,D=B.onPostCommit;typeof D=="function"&&D(b,i.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(re){Ar(i,i.return,re)}}else qA(a,i,c,h);break;case 31:qA(a,i,c,h);break;case 13:qA(a,i,c,h);break;case 23:break;case 22:B=i.stateNode,b=i.alternate,i.memoizedState!==null?B._visibility&2?qA(a,i,c,h):qo(a,i):B._visibility&2?qA(a,i,c,h):(B._visibility|=2,Cl(a,i,c,h,(i.subtreeFlags&10256)!==0||!1)),w&2048&&ug(b,i);break;case 24:qA(a,i,c,h),w&2048&&fg(i.alternate,i);break;default:qA(a,i,c,h)}}function Cl(a,i,c,h,w){for(w=w&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var B=a,b=i,D=c,re=h,me=b.flags;switch(b.tag){case 0:case 11:case 15:Cl(B,b,D,re,w),Yo(8,b);break;case 23:break;case 22:var Fe=b.stateNode;b.memoizedState!==null?Fe._visibility&2?Cl(B,b,D,re,w):qo(B,b):(Fe._visibility|=2,Cl(B,b,D,re,w)),w&&me&2048&&ug(b.alternate,b);break;case 24:Cl(B,b,D,re,w),w&&me&2048&&fg(b.alternate,b);break;default:Cl(B,b,D,re,w)}i=i.sibling}}function qo(a,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=a,h=i,w=h.flags;switch(h.tag){case 22:qo(c,h),w&2048&&ug(h.alternate,h);break;case 24:qo(c,h),w&2048&&fg(h.alternate,h);break;default:qo(c,h)}i=i.sibling}}var $o=8192;function El(a,i,c){if(a.subtreeFlags&$o)for(a=a.child;a!==null;)Ew(a,i,c),a=a.sibling}function Ew(a,i,c){switch(a.tag){case 26:El(a,i,c),a.flags&$o&&a.memoizedState!==null&&yU(c,WA,a.memoizedState,a.memoizedProps);break;case 5:El(a,i,c);break;case 3:case 4:var h=WA;WA=T0(a.stateNode.containerInfo),El(a,i,c),WA=h;break;case 22:a.memoizedState===null&&(h=a.alternate,h!==null&&h.memoizedState!==null?(h=$o,$o=16777216,El(a,i,c),$o=h):El(a,i,c));break;default:El(a,i,c)}}function Tw(a){var i=a.alternate;if(i!==null&&(a=i.child,a!==null)){i.child=null;do i=a.sibling,a.sibling=null,a=i;while(a!==null)}}function Zo(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var h=i[c];ln=h,_w(h,a)}Tw(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Sw(a),a=a.sibling}function Sw(a){switch(a.tag){case 0:case 11:case 15:Zo(a),a.flags&2048&&Bs(9,a,a.return);break;case 3:Zo(a);break;case 12:Zo(a);break;case 22:var i=a.stateNode;a.memoizedState!==null&&i._visibility&2&&(a.return===null||a.return.tag!==13)?(i._visibility&=-3,f0(a)):Zo(a);break;default:Zo(a)}}function f0(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var h=i[c];ln=h,_w(h,a)}Tw(a)}for(a=a.child;a!==null;){switch(i=a,i.tag){case 0:case 11:case 15:Bs(8,i,i.return),f0(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,f0(i));break;default:f0(i)}a=a.sibling}}function _w(a,i){for(;ln!==null;){var c=ln;switch(c.tag){case 0:case 11:case 15:Bs(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Do(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,ln=h;else e:for(c=a;ln!==null;){h=ln;var w=h.sibling,B=h.return;if(pw(h),h===c){ln=null;break e}if(w!==null){w.return=B,ln=w;break e}ln=B}}}var DF={getCacheForType:function(a){var i=pn(Jr),c=i.data.get(a);return c===void 0&&(c=a(),i.data.set(a,c)),c},cacheSignal:function(){return pn(Jr).controller.signal}},MF=typeof WeakMap=="function"?WeakMap:Map,Zt=0,vr=null,Dt=null,Ht=0,nr=0,uA=null,Cs=!1,Tl=!1,dg=!1,Pa=0,Dr=0,Es=0,Bi=0,hg=0,fA=0,Sl=0,ec=null,tA=null,gg=!1,d0=0,bw=0,h0=1/0,g0=null,Ts=null,nn=0,Ss=null,_l=null,Ga=0,mg=0,pg=null,Fw=null,tc=0,xg=null;function dA(){return(Zt&2)!==0&&Ht!==0?Ht&-Ht:q.T!==null?Eg():N()}function Uw(){if(fA===0)if((Ht&536870912)===0||Vt){var a=Ca;Ca<<=1,(Ca&3932160)===0&&(Ca=262144),fA=a}else fA=536870912;return a=oA.current,a!==null&&(a.flags|=32),fA}function rA(a,i,c){(a===vr&&(nr===2||nr===9)||a.cancelPendingCommit!==null)&&(bl(a,0),_s(a,Ht,fA,!1)),la(a,c),((Zt&2)===0||a!==vr)&&(a===vr&&((Zt&2)===0&&(Bi|=c),Dr===4&&_s(a,Ht,fA,!1)),fa(a))}function kw(a,i,c){if((Zt&6)!==0)throw Error(n(327));var h=!c&&(i&127)===0&&(i&a.expiredLanes)===0||Sa(a,i),w=h?OF(a,i):wg(a,i,!0),B=h;do{if(w===0){Tl&&!h&&_s(a,i,0,!1);break}else{if(c=a.current.alternate,B&&!LF(c)){w=wg(a,i,!1),B=!1;continue}if(w===2){if(B=i,a.errorRecoveryDisabledLanes&B)var b=0;else b=a.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){i=b;e:{var D=a;w=ec;var re=D.current.memoizedState.isDehydrated;if(re&&(bl(D,b).flags|=256),b=wg(D,b,!1),b!==2){if(dg&&!re){D.errorRecoveryDisabledLanes|=B,Bi|=B,w=4;break e}B=tA,tA=w,B!==null&&(tA===null?tA=B:tA.push.apply(tA,B))}w=b}if(B=!1,w!==2)continue}}if(w===1){bl(a,0),_s(a,i,0,!0);break}e:{switch(h=a,B=w,B){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:_s(h,i,fA,!Cs);break e;case 2:tA=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(w=d0+300-mt(),10<w)){if(_s(h,i,fA,!Cs),Ta(h,0,!0)!==0)break e;Ga=i,h.timeoutHandle=ly(Nw.bind(null,h,c,tA,g0,gg,i,fA,Bi,Sl,Cs,B,"Throttled",-0,0),w);break e}Nw(h,c,tA,g0,gg,i,fA,Bi,Sl,Cs,B,null,-0,0)}}break}while(!0);fa(a)}function Nw(a,i,c,h,w,B,b,D,re,me,Fe,ke,ye,Ee){if(a.timeoutHandle=-1,ke=i.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_a},Ew(i,B,ke);var tt=(B&62914560)===B?d0-mt():(B&4194048)===B?bw-mt():0;if(tt=BU(ke,tt),tt!==null){Ga=B,a.cancelPendingCommit=tt(Ow.bind(null,a,i,B,c,h,w,b,D,re,Fe,ke,null,ye,Ee)),_s(a,B,b,!me);return}}Ow(a,i,B,c,h,w,b,D,re)}function LF(a){for(var i=a;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var w=c[h],B=w.getSnapshot;w=w.value;try{if(!iA(B(),w))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function _s(a,i,c,h){i&=~hg,i&=~Bi,a.suspendedLanes|=i,a.pingedLanes&=~i,h&&(a.warmLanes|=i),h=a.expirationTimes;for(var w=i;0<w;){var B=31-yr(w),b=1<<B;h[B]=-1,w&=~b}c!==0&&tl(a,c,i)}function m0(){return(Zt&6)===0?(rc(0),!1):!0}function vg(){if(Dt!==null){if(nr===0)var a=Dt.return;else a=Dt,ka=di=null,Rh(a),xl=null,Lo=0,a=Dt;for(;a!==null;)ow(a.alternate,a),a=a.return;Dt=null}}function bl(a,i){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,AU(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),Ga=0,vg(),vr=a,Dt=c=Fa(a.current,null),Ht=i,nr=0,uA=null,Cs=!1,Tl=Sa(a,i),dg=!1,Sl=fA=hg=Bi=Es=Dr=0,tA=ec=null,gg=!1,(i&8)!==0&&(i|=i&32);var h=a.entangledLanes;if(h!==0)for(a=a.entanglements,h&=i;0<h;){var w=31-yr(h),B=1<<w;i|=a[w],h&=~B}return Pa=i,Mu(),c}function Iw(a,i){Tt=null,q.H=zo,i===pl||i===ju?(i=Yv(),nr=3):i===Ch?(i=Yv(),nr=4):nr=i===qh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,uA=i,Dt===null&&(Dr=1,a0(a,TA(i,a.current)))}function Qw(){var a=oA.current;return a===null?!0:(Ht&4194048)===Ht?FA===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?a===FA:!1}function Rw(){var a=q.H;return q.H=zo,a===null?zo:a}function Dw(){var a=q.A;return q.A=DF,a}function p0(){Dr=4,Cs||(Ht&4194048)!==Ht&&oA.current!==null||(Tl=!0),(Es&134217727)===0&&(Bi&134217727)===0||vr===null||_s(vr,Ht,fA,!1)}function wg(a,i,c){var h=Zt;Zt|=2;var w=Rw(),B=Dw();(vr!==a||Ht!==i)&&(g0=null,bl(a,i)),i=!1;var b=Dr;e:do try{if(nr!==0&&Dt!==null){var D=Dt,re=uA;switch(nr){case 8:vg(),b=6;break e;case 3:case 2:case 9:case 6:oA.current===null&&(i=!0);var me=nr;if(nr=0,uA=null,Fl(a,D,re,me),c&&Tl){b=0;break e}break;default:me=nr,nr=0,uA=null,Fl(a,D,re,me)}}HF(),b=Dr;break}catch(Fe){Iw(a,Fe)}while(!0);return i&&a.shellSuspendCounter++,ka=di=null,Zt=h,q.H=w,q.A=B,Dt===null&&(vr=null,Ht=0,Mu()),b}function HF(){for(;Dt!==null;)Mw(Dt)}function OF(a,i){var c=Zt;Zt|=2;var h=Rw(),w=Dw();vr!==a||Ht!==i?(g0=null,h0=mt()+500,bl(a,i)):Tl=Sa(a,i);e:do try{if(nr!==0&&Dt!==null){i=Dt;var B=uA;t:switch(nr){case 1:nr=0,uA=null,Fl(a,i,B,1);break;case 2:case 9:if(Xv(B)){nr=0,uA=null,Lw(i);break}i=function(){nr!==2&&nr!==9||vr!==a||(nr=7),fa(a)},B.then(i,i);break e;case 3:nr=7;break e;case 4:nr=5;break e;case 7:Xv(B)?(nr=0,uA=null,Lw(i)):(nr=0,uA=null,Fl(a,i,B,7));break;case 5:var b=null;switch(Dt.tag){case 26:b=Dt.memoizedState;case 5:case 27:var D=Dt;if(b?Cy(b):D.stateNode.complete){nr=0,uA=null;var re=D.sibling;if(re!==null)Dt=re;else{var me=D.return;me!==null?(Dt=me,x0(me)):Dt=null}break t}}nr=0,uA=null,Fl(a,i,B,5);break;case 6:nr=0,uA=null,Fl(a,i,B,6);break;case 8:vg(),Dr=6;break e;default:throw Error(n(462))}}PF();break}catch(Fe){Iw(a,Fe)}while(!0);return ka=di=null,q.H=h,q.A=w,Zt=c,Dt!==null?0:(vr=null,Ht=0,Mu(),Dr)}function PF(){for(;Dt!==null&&!Ct();)Mw(Dt)}function Mw(a){var i=iw(a.alternate,a,Pa);a.memoizedProps=a.pendingProps,i===null?x0(a):Dt=i}function Lw(a){var i=a,c=i.alternate;switch(i.tag){case 15:case 0:i=tw(c,i,i.pendingProps,i.type,void 0,Ht);break;case 11:i=tw(c,i,i.pendingProps,i.type.render,i.ref,Ht);break;case 5:Rh(i);default:ow(c,i),i=Dt=Dv(i,Pa),i=iw(c,i,Pa)}a.memoizedProps=a.pendingProps,i===null?x0(a):Dt=i}function Fl(a,i,c,h){ka=di=null,Rh(i),xl=null,Lo=0;var w=i.return;try{if(FF(a,w,i,c,Ht)){Dr=1,a0(a,TA(c,a.current)),Dt=null;return}}catch(B){if(w!==null)throw Dt=w,B;Dr=1,a0(a,TA(c,a.current)),Dt=null;return}i.flags&32768?(Vt||h===1?a=!0:Tl||(Ht&536870912)!==0?a=!1:(Cs=a=!0,(h===2||h===9||h===3||h===6)&&(h=oA.current,h!==null&&h.tag===13&&(h.flags|=16384))),Hw(i,a)):x0(i)}function x0(a){var i=a;do{if((i.flags&32768)!==0){Hw(i,Cs);return}a=i.return;var c=NF(i.alternate,i,Pa);if(c!==null){Dt=c;return}if(i=i.sibling,i!==null){Dt=i;return}Dt=i=a}while(i!==null);Dr===0&&(Dr=5)}function Hw(a,i){do{var c=IF(a.alternate,a);if(c!==null){c.flags&=32767,Dt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(a=a.sibling,a!==null)){Dt=a;return}Dt=a=c}while(a!==null);Dr=6,Dt=null}function Ow(a,i,c,h,w,B,b,D,re){a.cancelPendingCommit=null;do v0();while(nn!==0);if((Zt&6)!==0)throw Error(n(327));if(i!==null){if(i===a.current)throw Error(n(177));if(B=i.lanes|i.childLanes,B|=lh,Co(a,c,B,b,D,re),a===vr&&(Dt=vr=null,Ht=0),_l=i,Ss=a,Ga=c,mg=B,pg=w,Fw=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,jF(vt,function(){return jw(),null})):(a.callbackNode=null,a.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=q.T,q.T=null,w=oe.p,oe.p=2,b=Zt,Zt|=4;try{QF(a,i,c)}finally{Zt=b,oe.p=w,q.T=h}}nn=1,Pw(),Gw(),Vw()}}function Pw(){if(nn===1){nn=0;var a=Ss,i=_l,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=q.T,q.T=null;var h=oe.p;oe.p=2;var w=Zt;Zt|=4;try{yw(i,a);var B=Ng,b=_v(a.containerInfo),D=B.focusedElem,re=B.selectionRange;if(b!==D&&D&&D.ownerDocument&&Sv(D.ownerDocument.documentElement,D)){if(re!==null&&nh(D)){var me=re.start,Fe=re.end;if(Fe===void 0&&(Fe=me),"selectionStart"in D)D.selectionStart=me,D.selectionEnd=Math.min(Fe,D.value.length);else{var ke=D.ownerDocument||document,ye=ke&&ke.defaultView||window;if(ye.getSelection){var Ee=ye.getSelection(),tt=D.textContent.length,ut=Math.min(re.start,tt),gr=re.end===void 0?ut:Math.min(re.end,tt);!Ee.extend&&ut>gr&&(b=gr,gr=ut,ut=b);var fe=Tv(D,ut),se=Tv(D,gr);if(fe&&se&&(Ee.rangeCount!==1||Ee.anchorNode!==fe.node||Ee.anchorOffset!==fe.offset||Ee.focusNode!==se.node||Ee.focusOffset!==se.offset)){var ge=ke.createRange();ge.setStart(fe.node,fe.offset),Ee.removeAllRanges(),ut>gr?(Ee.addRange(ge),Ee.extend(se.node,se.offset)):(ge.setEnd(se.node,se.offset),Ee.addRange(ge))}}}}for(ke=[],Ee=D;Ee=Ee.parentNode;)Ee.nodeType===1&&ke.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ke.length;D++){var Ue=ke[D];Ue.element.scrollLeft=Ue.left,Ue.element.scrollTop=Ue.top}}k0=!!kg,Ng=kg=null}finally{Zt=w,oe.p=h,q.T=c}}a.current=i,nn=2}}function Gw(){if(nn===2){nn=0;var a=Ss,i=_l,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=q.T,q.T=null;var h=oe.p;oe.p=2;var w=Zt;Zt|=4;try{mw(a,i.alternate,i)}finally{Zt=w,oe.p=h,q.T=c}}nn=3}}function Vw(){if(nn===4||nn===3){nn=0,wr();var a=Ss,i=_l,c=Ga,h=Fw;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?nn=5:(nn=0,_l=Ss=null,Kw(a,a.pendingLanes));var w=a.pendingLanes;if(w===0&&(Ts=null),ai(c),i=i.stateNode,rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(yt,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=q.T,w=oe.p,oe.p=2,q.T=null;try{for(var B=a.onRecoverableError,b=0;b<h.length;b++){var D=h[b];B(D.value,{componentStack:D.stack})}}finally{q.T=i,oe.p=w}}(Ga&3)!==0&&v0(),fa(a),w=a.pendingLanes,(c&261930)!==0&&(w&42)!==0?a===xg?tc++:(tc=0,xg=a):tc=0,rc(0)}}function Kw(a,i){(a.pooledCacheLanes&=i)===0&&(i=a.pooledCache,i!=null&&(a.pooledCache=null,Do(i)))}function v0(){return Pw(),Gw(),Vw(),jw()}function jw(){if(nn!==5)return!1;var a=Ss,i=mg;mg=0;var c=ai(Ga),h=q.T,w=oe.p;try{oe.p=32>c?32:c,q.T=null,c=pg,pg=null;var B=Ss,b=Ga;if(nn=0,_l=Ss=null,Ga=0,(Zt&6)!==0)throw Error(n(331));var D=Zt;if(Zt|=4,Sw(B.current),Cw(B,B.current,b,c),Zt=D,rc(0,!1),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(yt,B)}catch{}return!0}finally{oe.p=w,q.T=h,Kw(a,i)}}function zw(a,i,c){i=TA(c,i),i=Wh(a.stateNode,i,2),a=vs(a,i,2),a!==null&&(la(a,2),fa(a))}function Ar(a,i,c){if(a.tag===3)zw(a,a,c);else for(;i!==null;){if(i.tag===3){zw(i,a,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ts===null||!Ts.has(h))){a=TA(c,a),c=X1(2),h=vs(i,c,2),h!==null&&(J1(c,h,i,a),la(h,2),fa(h));break}}i=i.return}}function yg(a,i,c){var h=a.pingCache;if(h===null){h=a.pingCache=new MF;var w=new Set;h.set(i,w)}else w=h.get(i),w===void 0&&(w=new Set,h.set(i,w));w.has(c)||(dg=!0,w.add(c),a=GF.bind(null,a,i,c),i.then(a,a))}function GF(a,i,c){var h=a.pingCache;h!==null&&h.delete(i),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,vr===a&&(Ht&c)===c&&(Dr===4||Dr===3&&(Ht&62914560)===Ht&&300>mt()-d0?(Zt&2)===0&&bl(a,0):hg|=c,Sl===Ht&&(Sl=0)),fa(a)}function Xw(a,i){i===0&&(i=el()),a=ci(a,i),a!==null&&(la(a,i),fa(a))}function VF(a){var i=a.memoizedState,c=0;i!==null&&(c=i.retryLane),Xw(a,c)}function KF(a,i){var c=0;switch(a.tag){case 31:case 13:var h=a.stateNode,w=a.memoizedState;w!==null&&(c=w.retryLane);break;case 19:h=a.stateNode;break;case 22:h=a.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(i),Xw(a,c)}function jF(a,i){return lr(a,i)}var w0=null,Ul=null,Bg=!1,y0=!1,Cg=!1,bs=0;function fa(a){a!==Ul&&a.next===null&&(Ul===null?w0=Ul=a:Ul=Ul.next=a),y0=!0,Bg||(Bg=!0,XF())}function rc(a,i){if(!Cg&&y0){Cg=!0;do for(var c=!1,h=w0;h!==null;){if(a!==0){var w=h.pendingLanes;if(w===0)var B=0;else{var b=h.suspendedLanes,D=h.pingedLanes;B=(1<<31-yr(42|a)+1)-1,B&=w&~(b&~D),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(c=!0,qw(h,B))}else B=Ht,B=Ta(h,h===vr?B:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(B&3)===0||Sa(h,B)||(c=!0,qw(h,B));h=h.next}while(c);Cg=!1}}function zF(){Jw()}function Jw(){y0=Bg=!1;var a=0;bs!==0&&nU()&&(a=bs);for(var i=mt(),c=null,h=w0;h!==null;){var w=h.next,B=Yw(h,i);B===0?(h.next=null,c===null?w0=w:c.next=w,w===null&&(Ul=c)):(c=h,(a!==0||(B&3)!==0)&&(y0=!0)),h=w}nn!==0&&nn!==5||rc(a),bs!==0&&(bs=0)}function Yw(a,i){for(var c=a.suspendedLanes,h=a.pingedLanes,w=a.expirationTimes,B=a.pendingLanes&-62914561;0<B;){var b=31-yr(B),D=1<<b,re=w[b];re===-1?((D&c)===0||(D&h)!==0)&&(w[b]=Zi(D,i)):re<=i&&(a.expiredLanes|=D),B&=~D}if(i=vr,c=Ht,c=Ta(a,a===i?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h=a.callbackNode,c===0||a===i&&(nr===2||nr===9)||a.cancelPendingCommit!==null)return h!==null&&h!==null&&jt(h),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||Sa(a,c)){if(i=c&-c,i===a.callbackPriority)return i;switch(h!==null&&jt(h),ai(c)){case 2:case 8:c=Et;break;case 32:c=vt;break;case 268435456:c=nt;break;default:c=vt}return h=Ww.bind(null,a),c=lr(c,h),a.callbackPriority=i,a.callbackNode=c,i}return h!==null&&h!==null&&jt(h),a.callbackPriority=2,a.callbackNode=null,2}function Ww(a,i){if(nn!==0&&nn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(v0()&&a.callbackNode!==c)return null;var h=Ht;return h=Ta(a,a===vr?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h===0?null:(kw(a,h,i),Yw(a,mt()),a.callbackNode!=null&&a.callbackNode===c?Ww.bind(null,a):null)}function qw(a,i){if(v0())return null;kw(a,i,!0)}function XF(){aU(function(){(Zt&6)!==0?lr(Ve,zF):Jw()})}function Eg(){if(bs===0){var a=gl;a===0&&(a=hn,hn<<=1,(hn&261888)===0&&(hn=256)),bs=a}return bs}function $w(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:nl(""+a)}function Zw(a,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,a.id&&c.setAttribute("form",a.id),i.parentNode.insertBefore(c,i),a=new FormData(a),c.parentNode.removeChild(c),a}function JF(a,i,c,h,w){if(i==="submit"&&c&&c.stateNode===w){var B=$w((w[V]||null).action),b=h.submitter;b&&(i=(i=b[V]||null)?$w(i.formAction):b.getAttribute("formAction"),i!==null&&(B=i,b=null));var D=new Iu("action","action",null,h,w);a.push({event:D,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(bs!==0){var re=b?Zw(w,b):new FormData(w);Kh(c,{pending:!0,data:re,method:w.method,action:B},null,re)}}else typeof B=="function"&&(D.preventDefault(),re=b?Zw(w,b):new FormData(w),Kh(c,{pending:!0,data:re,method:w.method,action:B},B,re))},currentTarget:w}]})}}for(var Tg=0;Tg<ih.length;Tg++){var Sg=ih[Tg],YF=Sg.toLowerCase(),WF=Sg[0].toUpperCase()+Sg.slice(1);YA(YF,"on"+WF)}YA(Uv,"onAnimationEnd"),YA(kv,"onAnimationIteration"),YA(Nv,"onAnimationStart"),YA("dblclick","onDoubleClick"),YA("focusin","onFocus"),YA("focusout","onBlur"),YA(fF,"onTransitionRun"),YA(dF,"onTransitionStart"),YA(hF,"onTransitionCancel"),YA(Iv,"onTransitionEnd"),Sn("onMouseEnter",["mouseout","mouseover"]),Sn("onMouseLeave",["mouseout","mouseover"]),Sn("onPointerEnter",["pointerout","pointerover"]),Sn("onPointerLeave",["pointerout","pointerover"]),ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ur("onBeforeInput",["compositionend","keypress","textInput","paste"]),ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nc));function ey(a,i){i=(i&4)!==0;for(var c=0;c<a.length;c++){var h=a[c],w=h.event;h=h.listeners;e:{var B=void 0;if(i)for(var b=h.length-1;0<=b;b--){var D=h[b],re=D.instance,me=D.currentTarget;if(D=D.listener,re!==B&&w.isPropagationStopped())break e;B=D,w.currentTarget=me;try{B(w)}catch(Fe){Du(Fe)}w.currentTarget=null,B=re}else for(b=0;b<h.length;b++){if(D=h[b],re=D.instance,me=D.currentTarget,D=D.listener,re!==B&&w.isPropagationStopped())break e;B=D,w.currentTarget=me;try{B(w)}catch(Fe){Du(Fe)}w.currentTarget=null,B=re}}}}function Mt(a,i){var c=i[pe];c===void 0&&(c=i[pe]=new Set);var h=a+"__bubble";c.has(h)||(ty(i,a,2,!1),c.add(h))}function _g(a,i,c){var h=0;i&&(h|=4),ty(c,a,h,i)}var B0="_reactListening"+Math.random().toString(36).slice(2);function bg(a){if(!a[B0]){a[B0]=!0,cr.forEach(function(c){c!=="selectionchange"&&(qF.has(c)||_g(c,!1,a),_g(c,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[B0]||(i[B0]=!0,_g("selectionchange",!1,i))}}function ty(a,i,c,h){switch(Uy(i)){case 2:var w=TU;break;case 8:w=SU;break;default:w=Vg}c=w.bind(null,i,c,a),w=void 0,!Jd||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(w=!0),h?w!==void 0?a.addEventListener(i,c,{capture:!0,passive:w}):a.addEventListener(i,c,!0):w!==void 0?a.addEventListener(i,c,{passive:w}):a.addEventListener(i,c,!1)}function Fg(a,i,c,h,w){var B=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var D=h.stateNode.containerInfo;if(D===w)break;if(b===4)for(b=h.return;b!==null;){var re=b.tag;if((re===3||re===4)&&b.stateNode.containerInfo===w)return;b=b.return}for(;D!==null;){if(b=Oe(D),b===null)return;if(re=b.tag,re===5||re===6||re===26||re===27){h=B=b;continue e}D=D.parentNode}}h=h.return}sv(function(){var me=B,Fe=zd(c),ke=[];e:{var ye=Qv.get(a);if(ye!==void 0){var Ee=Iu,tt=a;switch(a){case"keypress":if(ku(c)===0)break e;case"keydown":case"keyup":Ee=Kb;break;case"focusin":tt="focus",Ee=$d;break;case"focusout":tt="blur",Ee=$d;break;case"beforeblur":case"afterblur":Ee=$d;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=ov;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=Nb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=Xb;break;case Uv:case kv:case Nv:Ee=Rb;break;case Iv:Ee=Yb;break;case"scroll":case"scrollend":Ee=Ub;break;case"wheel":Ee=qb;break;case"copy":case"cut":case"paste":Ee=Mb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=uv;break;case"toggle":case"beforetoggle":Ee=Zb}var ut=(i&4)!==0,gr=!ut&&(a==="scroll"||a==="scrollend"),fe=ut?ye!==null?ye+"Capture":null:ye;ut=[];for(var se=me,ge;se!==null;){var Ue=se;if(ge=Ue.stateNode,Ue=Ue.tag,Ue!==5&&Ue!==26&&Ue!==27||ge===null||fe===null||(Ue=To(se,fe),Ue!=null&&ut.push(Ac(se,Ue,ge))),gr)break;se=se.return}0<ut.length&&(ye=new Ee(ye,tt,null,c,Fe),ke.push({event:ye,listeners:ut}))}}if((i&7)===0){e:{if(ye=a==="mouseover"||a==="pointerover",Ee=a==="mouseout"||a==="pointerout",ye&&c!==jd&&(tt=c.relatedTarget||c.fromElement)&&(Oe(tt)||tt[J]))break e;if((Ee||ye)&&(ye=Fe.window===Fe?Fe:(ye=Fe.ownerDocument)?ye.defaultView||ye.parentWindow:window,Ee?(tt=c.relatedTarget||c.toElement,Ee=me,tt=tt?Oe(tt):null,tt!==null&&(gr=s(tt),ut=tt.tag,tt!==gr||ut!==5&&ut!==27&&ut!==6)&&(tt=null)):(Ee=null,tt=me),Ee!==tt)){if(ut=ov,Ue="onMouseLeave",fe="onMouseEnter",se="mouse",(a==="pointerout"||a==="pointerover")&&(ut=uv,Ue="onPointerLeave",fe="onPointerEnter",se="pointer"),gr=Ee==null?ye:He(Ee),ge=tt==null?ye:He(tt),ye=new ut(Ue,se+"leave",Ee,c,Fe),ye.target=gr,ye.relatedTarget=ge,Ue=null,Oe(Fe)===me&&(ut=new ut(fe,se+"enter",tt,c,Fe),ut.target=ge,ut.relatedTarget=gr,Ue=ut),gr=Ue,Ee&&tt)t:{for(ut=$F,fe=Ee,se=tt,ge=0,Ue=fe;Ue;Ue=ut(Ue))ge++;Ue=0;for(var it=se;it;it=ut(it))Ue++;for(;0<ge-Ue;)fe=ut(fe),ge--;for(;0<Ue-ge;)se=ut(se),Ue--;for(;ge--;){if(fe===se||se!==null&&fe===se.alternate){ut=fe;break t}fe=ut(fe),se=ut(se)}ut=null}else ut=null;Ee!==null&&ry(ke,ye,Ee,ut,!1),tt!==null&&gr!==null&&ry(ke,gr,tt,ut,!0)}}e:{if(ye=me?He(me):window,Ee=ye.nodeName&&ye.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&ye.type==="file")var Yt=vv;else if(pv(ye))if(wv)Yt=oF;else{Yt=iF;var at=sF}else Ee=ye.nodeName,!Ee||Ee.toLowerCase()!=="input"||ye.type!=="checkbox"&&ye.type!=="radio"?me&&er(me.elementType)&&(Yt=vv):Yt=lF;if(Yt&&(Yt=Yt(a,me))){xv(ke,Yt,c,Fe);break e}at&&at(a,ye,me),a==="focusout"&&me&&ye.type==="number"&&me.memoizedProps.value!=null&&Rt(ye,"number",ye.value)}switch(at=me?He(me):window,a){case"focusin":(pv(at)||at.contentEditable==="true")&&(il=at,Ah=me,Io=null);break;case"focusout":Io=Ah=il=null;break;case"mousedown":ah=!0;break;case"contextmenu":case"mouseup":case"dragend":ah=!1,bv(ke,c,Fe);break;case"selectionchange":if(uF)break;case"keydown":case"keyup":bv(ke,c,Fe)}var _t;if(eh)e:{switch(a){case"compositionstart":var Ot="onCompositionStart";break e;case"compositionend":Ot="onCompositionEnd";break e;case"compositionupdate":Ot="onCompositionUpdate";break e}Ot=void 0}else sl?gv(a,c)&&(Ot="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Ot="onCompositionStart");Ot&&(fv&&c.locale!=="ko"&&(sl||Ot!=="onCompositionStart"?Ot==="onCompositionEnd"&&sl&&(_t=iv()):(fs=Fe,Yd="value"in fs?fs.value:fs.textContent,sl=!0)),at=C0(me,Ot),0<at.length&&(Ot=new cv(Ot,a,null,c,Fe),ke.push({event:Ot,listeners:at}),_t?Ot.data=_t:(_t=mv(c),_t!==null&&(Ot.data=_t)))),(_t=tF?rF(a,c):nF(a,c))&&(Ot=C0(me,"onBeforeInput"),0<Ot.length&&(at=new cv("onBeforeInput","beforeinput",null,c,Fe),ke.push({event:at,listeners:Ot}),at.data=_t)),JF(ke,a,me,c,Fe)}ey(ke,i)})}function Ac(a,i,c){return{instance:a,listener:i,currentTarget:c}}function C0(a,i){for(var c=i+"Capture",h=[];a!==null;){var w=a,B=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||B===null||(w=To(a,c),w!=null&&h.unshift(Ac(a,w,B)),w=To(a,i),w!=null&&h.push(Ac(a,w,B))),a.tag===3)return h;a=a.return}return[]}function $F(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function ry(a,i,c,h,w){for(var B=i._reactName,b=[];c!==null&&c!==h;){var D=c,re=D.alternate,me=D.stateNode;if(D=D.tag,re!==null&&re===h)break;D!==5&&D!==26&&D!==27||me===null||(re=me,w?(me=To(c,B),me!=null&&b.unshift(Ac(c,me,re))):w||(me=To(c,B),me!=null&&b.push(Ac(c,me,re)))),c=c.return}b.length!==0&&a.push({event:i,listeners:b})}var ZF=/\r\n?/g,eU=/\u0000|\uFFFD/g;function ny(a){return(typeof a=="string"?a:""+a).replace(ZF,`
`).replace(eU,"")}function Ay(a,i){return i=ny(i),ny(a)===i}function hr(a,i,c,h,w,B){switch(c){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||Nr(a,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&Nr(a,""+h);break;case"className":si(a,"class",h);break;case"tabIndex":si(a,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":si(a,c,h);break;case"style":Eo(a,h,B);break;case"data":if(i!=="object"){si(a,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||c!=="href")){a.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=nl(""+h),a.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof B=="function"&&(c==="formAction"?(i!=="input"&&hr(a,i,"name",w.name,w,null),hr(a,i,"formEncType",w.formEncType,w,null),hr(a,i,"formMethod",w.formMethod,w,null),hr(a,i,"formTarget",w.formTarget,w,null)):(hr(a,i,"encType",w.encType,w,null),hr(a,i,"method",w.method,w,null),hr(a,i,"target",w.target,w,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=nl(""+h),a.setAttribute(c,h);break;case"onClick":h!=null&&(a.onclick=_a);break;case"onScroll":h!=null&&Mt("scroll",a);break;case"onScrollEnd":h!=null&&Mt("scrollend",a);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(w.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":a.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){a.removeAttribute("xlink:href");break}c=nl(""+h),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""+h):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":h===!0?a.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,h):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?a.setAttribute(c,h):a.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?a.removeAttribute(c):a.setAttribute(c,h);break;case"popover":Mt("beforetoggle",a),Mt("toggle",a),gn(a,"popover",h);break;case"xlinkActuate":CA(a,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":CA(a,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":CA(a,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":CA(a,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":CA(a,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":CA(a,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":CA(a,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":CA(a,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":CA(a,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":gn(a,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=bu.get(c)||c,gn(a,c,h))}}function Ug(a,i,c,h,w,B){switch(c){case"style":Eo(a,h,B);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(w.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof h=="string"?Nr(a,h):(typeof h=="number"||typeof h=="bigint")&&Nr(a,""+h);break;case"onScroll":h!=null&&Mt("scroll",a);break;case"onScrollEnd":h!=null&&Mt("scrollend",a);break;case"onClick":h!=null&&(a.onclick=_a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ft.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(w=c.endsWith("Capture"),i=c.slice(2,w?c.length-7:void 0),B=a[V]||null,B=B!=null?B[c]:null,typeof B=="function"&&a.removeEventListener(i,B,w),typeof h=="function")){typeof B!="function"&&B!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(i,h,w);break e}c in a?a[c]=h:h===!0?a.setAttribute(c,""):gn(a,c,h)}}}function vn(a,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",a),Mt("load",a);var h=!1,w=!1,B;for(B in c)if(c.hasOwnProperty(B)){var b=c[B];if(b!=null)switch(B){case"src":h=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:hr(a,i,B,b,c,null)}}w&&hr(a,i,"srcSet",c.srcSet,c,null),h&&hr(a,i,"src",c.src,c,null);return;case"input":Mt("invalid",a);var D=B=b=w=null,re=null,me=null;for(h in c)if(c.hasOwnProperty(h)){var Fe=c[h];if(Fe!=null)switch(h){case"name":w=Fe;break;case"type":b=Fe;break;case"checked":re=Fe;break;case"defaultChecked":me=Fe;break;case"value":B=Fe;break;case"defaultValue":D=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(n(137,i));break;default:hr(a,i,h,Fe,c,null)}}fr(a,B,D,re,me,b,w,!1);return;case"select":Mt("invalid",a),h=b=B=null;for(w in c)if(c.hasOwnProperty(w)&&(D=c[w],D!=null))switch(w){case"value":B=D;break;case"defaultValue":b=D;break;case"multiple":h=D;default:hr(a,i,w,D,c,null)}i=B,c=b,a.multiple=!!h,i!=null?ft(a,!!h,i,!1):c!=null&&ft(a,!!h,c,!0);return;case"textarea":Mt("invalid",a),B=w=h=null;for(b in c)if(c.hasOwnProperty(b)&&(D=c[b],D!=null))switch(b){case"value":h=D;break;case"defaultValue":w=D;break;case"children":B=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:hr(a,i,b,D,c,null)}kr(a,h,w,B);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(h=c[re],h!=null))switch(re){case"selected":a.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:hr(a,i,re,h,c,null)}return;case"dialog":Mt("beforetoggle",a),Mt("toggle",a),Mt("cancel",a),Mt("close",a);break;case"iframe":case"object":Mt("load",a);break;case"video":case"audio":for(h=0;h<nc.length;h++)Mt(nc[h],a);break;case"image":Mt("error",a),Mt("load",a);break;case"details":Mt("toggle",a);break;case"embed":case"source":case"link":Mt("error",a),Mt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in c)if(c.hasOwnProperty(me)&&(h=c[me],h!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:hr(a,i,me,h,c,null)}return;default:if(er(i)){for(Fe in c)c.hasOwnProperty(Fe)&&(h=c[Fe],h!==void 0&&Ug(a,i,Fe,h,c,void 0));return}}for(D in c)c.hasOwnProperty(D)&&(h=c[D],h!=null&&hr(a,i,D,h,c,null))}function tU(a,i,c,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,B=null,b=null,D=null,re=null,me=null,Fe=null;for(Ee in c){var ke=c[Ee];if(c.hasOwnProperty(Ee)&&ke!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":re=ke;default:h.hasOwnProperty(Ee)||hr(a,i,Ee,null,h,ke)}}for(var ye in h){var Ee=h[ye];if(ke=c[ye],h.hasOwnProperty(ye)&&(Ee!=null||ke!=null))switch(ye){case"type":B=Ee;break;case"name":w=Ee;break;case"checked":me=Ee;break;case"defaultChecked":Fe=Ee;break;case"value":b=Ee;break;case"defaultValue":D=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,i));break;default:Ee!==ke&&hr(a,i,ye,Ee,h,ke)}}Gt(a,b,D,re,me,Fe,B,w);return;case"select":Ee=b=D=ye=null;for(B in c)if(re=c[B],c.hasOwnProperty(B)&&re!=null)switch(B){case"value":break;case"multiple":Ee=re;default:h.hasOwnProperty(B)||hr(a,i,B,null,h,re)}for(w in h)if(B=h[w],re=c[w],h.hasOwnProperty(w)&&(B!=null||re!=null))switch(w){case"value":ye=B;break;case"defaultValue":D=B;break;case"multiple":b=B;default:B!==re&&hr(a,i,w,B,h,re)}i=D,c=b,h=Ee,ye!=null?ft(a,!!c,ye,!1):!!h!=!!c&&(i!=null?ft(a,!!c,i,!0):ft(a,!!c,c?[]:"",!1));return;case"textarea":Ee=ye=null;for(D in c)if(w=c[D],c.hasOwnProperty(D)&&w!=null&&!h.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:hr(a,i,D,null,h,w)}for(b in h)if(w=h[b],B=c[b],h.hasOwnProperty(b)&&(w!=null||B!=null))switch(b){case"value":ye=w;break;case"defaultValue":Ee=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==B&&hr(a,i,b,w,h,B)}Lt(a,ye,Ee);return;case"option":for(var tt in c)if(ye=c[tt],c.hasOwnProperty(tt)&&ye!=null&&!h.hasOwnProperty(tt))switch(tt){case"selected":a.selected=!1;break;default:hr(a,i,tt,null,h,ye)}for(re in h)if(ye=h[re],Ee=c[re],h.hasOwnProperty(re)&&ye!==Ee&&(ye!=null||Ee!=null))switch(re){case"selected":a.selected=ye&&typeof ye!="function"&&typeof ye!="symbol";break;default:hr(a,i,re,ye,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in c)ye=c[ut],c.hasOwnProperty(ut)&&ye!=null&&!h.hasOwnProperty(ut)&&hr(a,i,ut,null,h,ye);for(me in h)if(ye=h[me],Ee=c[me],h.hasOwnProperty(me)&&ye!==Ee&&(ye!=null||Ee!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,i));break;default:hr(a,i,me,ye,h,Ee)}return;default:if(er(i)){for(var gr in c)ye=c[gr],c.hasOwnProperty(gr)&&ye!==void 0&&!h.hasOwnProperty(gr)&&Ug(a,i,gr,void 0,h,ye);for(Fe in h)ye=h[Fe],Ee=c[Fe],!h.hasOwnProperty(Fe)||ye===Ee||ye===void 0&&Ee===void 0||Ug(a,i,Fe,ye,h,Ee);return}}for(var fe in c)ye=c[fe],c.hasOwnProperty(fe)&&ye!=null&&!h.hasOwnProperty(fe)&&hr(a,i,fe,null,h,ye);for(ke in h)ye=h[ke],Ee=c[ke],!h.hasOwnProperty(ke)||ye===Ee||ye==null&&Ee==null||hr(a,i,ke,ye,h,Ee)}function ay(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function rU(){if(typeof performance.getEntriesByType=="function"){for(var a=0,i=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var w=c[h],B=w.transferSize,b=w.initiatorType,D=w.duration;if(B&&D&&ay(b)){for(b=0,D=w.responseEnd,h+=1;h<c.length;h++){var re=c[h],me=re.startTime;if(me>D)break;var Fe=re.transferSize,ke=re.initiatorType;Fe&&ay(ke)&&(re=re.responseEnd,b+=Fe*(re<D?1:(D-me)/(re-me)))}if(--h,i+=8*(B+b)/(w.duration/1e3),a++,10<a)break}}if(0<a)return i/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var kg=null,Ng=null;function E0(a){return a.nodeType===9?a:a.ownerDocument}function sy(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iy(a,i){if(a===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&i==="foreignObject"?0:a}function Ig(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Qg=null;function nU(){var a=window.event;return a&&a.type==="popstate"?a===Qg?!1:(Qg=a,!0):(Qg=null,!1)}var ly=typeof setTimeout=="function"?setTimeout:void 0,AU=typeof clearTimeout=="function"?clearTimeout:void 0,oy=typeof Promise=="function"?Promise:void 0,aU=typeof queueMicrotask=="function"?queueMicrotask:typeof oy<"u"?function(a){return oy.resolve(null).then(a).catch(sU)}:ly;function sU(a){setTimeout(function(){throw a})}function Fs(a){return a==="head"}function cy(a,i){var c=i,h=0;do{var w=c.nextSibling;if(a.removeChild(c),w&&w.nodeType===8)if(c=w.data,c==="/$"||c==="/&"){if(h===0){a.removeChild(w),Ql(i);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")ac(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,ac(c);for(var B=c.firstChild;B;){var b=B.nextSibling,D=B.nodeName;B[we]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&B.rel.toLowerCase()==="stylesheet"||c.removeChild(B),B=b}}else c==="body"&&ac(a.ownerDocument.body);c=w}while(c);Ql(i)}function uy(a,i){var c=a;a=0;do{var h=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=h}while(c)}function Rg(a){var i=a.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Rg(c),Le(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function iU(a,i,c,h){for(;a.nodeType===1;){var w=c;if(a.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(h){if(!a[we])switch(i){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(B=a.getAttribute("rel"),B==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(B!==w.rel||a.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||a.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||a.getAttribute("title")!==(w.title==null?null:w.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(B=a.getAttribute("src"),(B!==(w.src==null?null:w.src)||a.getAttribute("type")!==(w.type==null?null:w.type)||a.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&B&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(i==="input"&&a.type==="hidden"){var B=w.name==null?null:""+w.name;if(w.type==="hidden"&&a.getAttribute("name")===B)return a}else return a;if(a=UA(a.nextSibling),a===null)break}return null}function lU(a,i,c){if(i==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=UA(a.nextSibling),a===null))return null;return a}function fy(a,i){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!i||(a=UA(a.nextSibling),a===null))return null;return a}function Dg(a){return a.data==="$?"||a.data==="$~"}function Mg(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function oU(a,i){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=i;else if(a.data!=="$?"||c.readyState!=="loading")i();else{var h=function(){i(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),a._reactRetry=h}}function UA(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return a}var Lg=null;function dy(a){a=a.nextSibling;for(var i=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(i===0)return UA(a.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}a=a.nextSibling}return null}function hy(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return a;i--}else c!=="/$"&&c!=="/&"||i++}a=a.previousSibling}return null}function gy(a,i,c){switch(i=E0(c),a){case"html":if(a=i.documentElement,!a)throw Error(n(452));return a;case"head":if(a=i.head,!a)throw Error(n(453));return a;case"body":if(a=i.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function ac(a){for(var i=a.attributes;i.length;)a.removeAttributeNode(i[0]);Le(a)}var kA=new Map,my=new Set;function T0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Va=oe.d;oe.d={f:cU,r:uU,D:fU,C:dU,L:hU,m:gU,X:pU,S:mU,M:xU};function cU(){var a=Va.f(),i=m0();return a||i}function uU(a){var i=ze(a);i!==null&&i.tag===5&&i.type==="form"?I1(i):Va.r(a)}var kl=typeof document>"u"?null:document;function py(a,i,c){var h=kl;if(h&&typeof i=="string"&&i){var w=st(i);w='link[rel="'+a+'"][href="'+w+'"]',typeof c=="string"&&(w+='[crossorigin="'+c+'"]'),my.has(w)||(my.add(w),a={rel:a,crossOrigin:c,href:i},h.querySelector(w)===null&&(i=h.createElement("link"),vn(i,"link",a),At(i),h.head.appendChild(i)))}}function fU(a){Va.D(a),py("dns-prefetch",a,null)}function dU(a,i){Va.C(a,i),py("preconnect",a,i)}function hU(a,i,c){Va.L(a,i,c);var h=kl;if(h&&a&&i){var w='link[rel="preload"][as="'+st(i)+'"]';i==="image"&&c&&c.imageSrcSet?(w+='[imagesrcset="'+st(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(w+='[imagesizes="'+st(c.imageSizes)+'"]')):w+='[href="'+st(a)+'"]';var B=w;switch(i){case"style":B=Nl(a);break;case"script":B=Il(a)}kA.has(B)||(a=m({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:a,as:i},c),kA.set(B,a),h.querySelector(w)!==null||i==="style"&&h.querySelector(sc(B))||i==="script"&&h.querySelector(ic(B))||(i=h.createElement("link"),vn(i,"link",a),At(i),h.head.appendChild(i)))}}function gU(a,i){Va.m(a,i);var c=kl;if(c&&a){var h=i&&typeof i.as=="string"?i.as:"script",w='link[rel="modulepreload"][as="'+st(h)+'"][href="'+st(a)+'"]',B=w;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":B=Il(a)}if(!kA.has(B)&&(a=m({rel:"modulepreload",href:a},i),kA.set(B,a),c.querySelector(w)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ic(B)))return}h=c.createElement("link"),vn(h,"link",a),At(h),c.head.appendChild(h)}}}function mU(a,i,c){Va.S(a,i,c);var h=kl;if(h&&a){var w=Ke(h).hoistableStyles,B=Nl(a);i=i||"default";var b=w.get(B);if(!b){var D={loading:0,preload:null};if(b=h.querySelector(sc(B)))D.loading=5;else{a=m({rel:"stylesheet",href:a,"data-precedence":i},c),(c=kA.get(B))&&Hg(a,c);var re=b=h.createElement("link");At(re),vn(re,"link",a),re._p=new Promise(function(me,Fe){re.onload=me,re.onerror=Fe}),re.addEventListener("load",function(){D.loading|=1}),re.addEventListener("error",function(){D.loading|=2}),D.loading|=4,S0(b,i,h)}b={type:"stylesheet",instance:b,count:1,state:D},w.set(B,b)}}}function pU(a,i){Va.X(a,i);var c=kl;if(c&&a){var h=Ke(c).hoistableScripts,w=Il(a),B=h.get(w);B||(B=c.querySelector(ic(w)),B||(a=m({src:a,async:!0},i),(i=kA.get(w))&&Og(a,i),B=c.createElement("script"),At(B),vn(B,"link",a),c.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},h.set(w,B))}}function xU(a,i){Va.M(a,i);var c=kl;if(c&&a){var h=Ke(c).hoistableScripts,w=Il(a),B=h.get(w);B||(B=c.querySelector(ic(w)),B||(a=m({src:a,async:!0,type:"module"},i),(i=kA.get(w))&&Og(a,i),B=c.createElement("script"),At(B),vn(B,"link",a),c.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},h.set(w,B))}}function xy(a,i,c,h){var w=(w=Z.current)?T0(w):null;if(!w)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Nl(c.href),c=Ke(w).hoistableStyles,h=c.get(i),h||(h={type:"style",instance:null,count:0,state:null},c.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=Nl(c.href);var B=Ke(w).hoistableStyles,b=B.get(a);if(b||(w=w.ownerDocument||w,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},B.set(a,b),(B=w.querySelector(sc(a)))&&!B._p&&(b.instance=B,b.state.loading=5),kA.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},kA.set(a,c),B||vU(w,a,c,b.state))),i&&h===null)throw Error(n(528,""));return b}if(i&&h!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Il(c),c=Ke(w).hoistableScripts,h=c.get(i),h||(h={type:"script",instance:null,count:0,state:null},c.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function Nl(a){return'href="'+st(a)+'"'}function sc(a){return'link[rel="stylesheet"]['+a+"]"}function vy(a){return m({},a,{"data-precedence":a.precedence,precedence:null})}function vU(a,i,c,h){a.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=a.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),vn(i,"link",c),At(i),a.head.appendChild(i))}function Il(a){return'[src="'+st(a)+'"]'}function ic(a){return"script[async]"+a}function wy(a,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var h=a.querySelector('style[data-href~="'+st(c.href)+'"]');if(h)return i.instance=h,At(h),h;var w=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(a.ownerDocument||a).createElement("style"),At(h),vn(h,"style",w),S0(h,c.precedence,a),i.instance=h;case"stylesheet":w=Nl(c.href);var B=a.querySelector(sc(w));if(B)return i.state.loading|=4,i.instance=B,At(B),B;h=vy(c),(w=kA.get(w))&&Hg(h,w),B=(a.ownerDocument||a).createElement("link"),At(B);var b=B;return b._p=new Promise(function(D,re){b.onload=D,b.onerror=re}),vn(B,"link",h),i.state.loading|=4,S0(B,c.precedence,a),i.instance=B;case"script":return B=Il(c.src),(w=a.querySelector(ic(B)))?(i.instance=w,At(w),w):(h=c,(w=kA.get(B))&&(h=m({},c),Og(h,w)),a=a.ownerDocument||a,w=a.createElement("script"),At(w),vn(w,"link",h),a.head.appendChild(w),i.instance=w);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,S0(h,c.precedence,a));return i.instance}function S0(a,i,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=h.length?h[h.length-1]:null,B=w,b=0;b<h.length;b++){var D=h[b];if(D.dataset.precedence===i)B=D;else if(B!==w)break}B?B.parentNode.insertBefore(a,B.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(a,i.firstChild))}function Hg(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.title==null&&(a.title=i.title)}function Og(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.integrity==null&&(a.integrity=i.integrity)}var _0=null;function yy(a,i,c){if(_0===null){var h=new Map,w=_0=new Map;w.set(c,h)}else w=_0,h=w.get(c),h||(h=new Map,w.set(c,h));if(h.has(a))return h;for(h.set(a,null),c=c.getElementsByTagName(a),w=0;w<c.length;w++){var B=c[w];if(!(B[we]||B[O]||a==="link"&&B.getAttribute("rel")==="stylesheet")&&B.namespaceURI!=="http://www.w3.org/2000/svg"){var b=B.getAttribute(i)||"";b=a+b;var D=h.get(b);D?D.push(B):h.set(b,[B])}}return h}function By(a,i,c){a=a.ownerDocument||a,a.head.insertBefore(c,i==="title"?a.querySelector("head > title"):null)}function wU(a,i,c){if(c===1||i.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return a=i.disabled,typeof i.precedence=="string"&&a==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Cy(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function yU(a,i,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=Nl(h.href),B=i.querySelector(sc(w));if(B){i=B._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(a.count++,a=b0.bind(a),i.then(a,a)),c.state.loading|=4,c.instance=B,At(B);return}B=i.ownerDocument||i,h=vy(h),(w=kA.get(w))&&Hg(h,w),B=B.createElement("link"),At(B);var b=B;b._p=new Promise(function(D,re){b.onload=D,b.onerror=re}),vn(B,"link",h),c.instance=B}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=b0.bind(a),i.addEventListener("load",c),i.addEventListener("error",c))}}var Pg=0;function BU(a,i){return a.stylesheets&&a.count===0&&U0(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var h=setTimeout(function(){if(a.stylesheets&&U0(a,a.stylesheets),a.unsuspend){var B=a.unsuspend;a.unsuspend=null,B()}},6e4+i);0<a.imgBytes&&Pg===0&&(Pg=62500*rU());var w=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&U0(a,a.stylesheets),a.unsuspend)){var B=a.unsuspend;a.unsuspend=null,B()}},(a.imgBytes>Pg?50:800)+i);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(h),clearTimeout(w)}}:null}function b0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)U0(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var F0=null;function U0(a,i){a.stylesheets=null,a.unsuspend!==null&&(a.count++,F0=new Map,i.forEach(CU,a),F0=null,b0.call(a))}function CU(a,i){if(!(i.state.loading&4)){var c=F0.get(a);if(c)var h=c.get(null);else{c=new Map,F0.set(a,c);for(var w=a.querySelectorAll("link[data-precedence],style[data-precedence]"),B=0;B<w.length;B++){var b=w[B];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),h=b)}h&&c.set(null,h)}w=i.instance,b=w.getAttribute("data-precedence"),B=c.get(b)||h,B===h&&c.set(null,w),c.set(b,w),this.count++,h=b0.bind(this),w.addEventListener("load",h),w.addEventListener("error",h),B?B.parentNode.insertBefore(w,B.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(w,a.firstChild)),i.state.loading|=4}}var lc={$$typeof:S,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function EU(a,i,c,h,w,B,b,D,re){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ni(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ni(0),this.hiddenUpdates=ni(null),this.identifierPrefix=h,this.onUncaughtError=w,this.onCaughtError=B,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function Ey(a,i,c,h,w,B,b,D,re,me,Fe,ke){return a=new EU(a,i,c,b,re,me,Fe,ke,D),i=1,B===!0&&(i|=24),B=lA(3,null,null,i),a.current=B,B.stateNode=a,i=wh(),i.refCount++,a.pooledCache=i,i.refCount++,B.memoizedState={element:h,isDehydrated:c,cache:i},Eh(B),a}function Ty(a){return a?(a=cl,a):cl}function Sy(a,i,c,h,w,B){w=Ty(w),h.context===null?h.context=w:h.pendingContext=w,h=xs(i),h.payload={element:c},B=B===void 0?null:B,B!==null&&(h.callback=B),c=vs(a,h,i),c!==null&&(rA(c,a,i),Oo(c,a,i))}function _y(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<i?c:i}}function Gg(a,i){_y(a,i),(a=a.alternate)&&_y(a,i)}function by(a){if(a.tag===13||a.tag===31){var i=ci(a,67108864);i!==null&&rA(i,a,67108864),Gg(a,67108864)}}function Fy(a){if(a.tag===13||a.tag===31){var i=dA();i=Ai(i);var c=ci(a,i);c!==null&&rA(c,a,i),Gg(a,i)}}var k0=!0;function TU(a,i,c,h){var w=q.T;q.T=null;var B=oe.p;try{oe.p=2,Vg(a,i,c,h)}finally{oe.p=B,q.T=w}}function SU(a,i,c,h){var w=q.T;q.T=null;var B=oe.p;try{oe.p=8,Vg(a,i,c,h)}finally{oe.p=B,q.T=w}}function Vg(a,i,c,h){if(k0){var w=Kg(h);if(w===null)Fg(a,i,h,N0,c),ky(a,h);else if(bU(w,a,i,c,h))h.stopPropagation();else if(ky(a,h),i&4&&-1<_U.indexOf(a)){for(;w!==null;){var B=ze(w);if(B!==null)switch(B.tag){case 3:if(B=B.stateNode,B.current.memoizedState.isDehydrated){var b=Wn(B.pendingLanes);if(b!==0){var D=B;for(D.pendingLanes|=2,D.entangledLanes|=2;b;){var re=1<<31-yr(b);D.entanglements[1]|=re,b&=~re}fa(B),(Zt&6)===0&&(h0=mt()+500,rc(0))}}break;case 31:case 13:D=ci(B,2),D!==null&&rA(D,B,2),m0(),Gg(B,2)}if(B=Kg(h),B===null&&Fg(a,i,h,N0,c),B===w)break;w=B}w!==null&&h.stopPropagation()}else Fg(a,i,h,null,c)}}function Kg(a){return a=zd(a),jg(a)}var N0=null;function jg(a){if(N0=null,a=Oe(a),a!==null){var i=s(a);if(i===null)a=null;else{var c=i.tag;if(c===13){if(a=l(i),a!==null)return a;a=null}else if(c===31){if(a=o(i),a!==null)return a;a=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return N0=a,null}function Uy(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case Ve:return 2;case Et:return 8;case vt:case Ut:return 32;case nt:return 268435456;default:return 32}default:return 32}}var zg=!1,Us=null,ks=null,Ns=null,oc=new Map,cc=new Map,Is=[],_U="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ky(a,i){switch(a){case"focusin":case"focusout":Us=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":cc.delete(i.pointerId)}}function uc(a,i,c,h,w,B){return a===null||a.nativeEvent!==B?(a={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:B,targetContainers:[w]},i!==null&&(i=ze(i),i!==null&&by(i)),a):(a.eventSystemFlags|=h,i=a.targetContainers,w!==null&&i.indexOf(w)===-1&&i.push(w),a)}function bU(a,i,c,h,w){switch(i){case"focusin":return Us=uc(Us,a,i,c,h,w),!0;case"dragenter":return ks=uc(ks,a,i,c,h,w),!0;case"mouseover":return Ns=uc(Ns,a,i,c,h,w),!0;case"pointerover":var B=w.pointerId;return oc.set(B,uc(oc.get(B)||null,a,i,c,h,w)),!0;case"gotpointercapture":return B=w.pointerId,cc.set(B,uc(cc.get(B)||null,a,i,c,h,w)),!0}return!1}function Ny(a){var i=Oe(a.target);if(i!==null){var c=s(i);if(c!==null){if(i=c.tag,i===13){if(i=l(c),i!==null){a.blockedOn=i,j(a.priority,function(){Fy(c)});return}}else if(i===31){if(i=o(c),i!==null){a.blockedOn=i,j(a.priority,function(){Fy(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function I0(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var c=Kg(a.nativeEvent);if(c===null){c=a.nativeEvent;var h=new c.constructor(c.type,c);jd=h,c.target.dispatchEvent(h),jd=null}else return i=ze(c),i!==null&&by(i),a.blockedOn=c,!1;i.shift()}return!0}function Iy(a,i,c){I0(a)&&c.delete(i)}function FU(){zg=!1,Us!==null&&I0(Us)&&(Us=null),ks!==null&&I0(ks)&&(ks=null),Ns!==null&&I0(Ns)&&(Ns=null),oc.forEach(Iy),cc.forEach(Iy)}function Q0(a,i){a.blockedOn===i&&(a.blockedOn=null,zg||(zg=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,FU)))}var R0=null;function Qy(a){R0!==a&&(R0=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){R0===a&&(R0=null);for(var i=0;i<a.length;i+=3){var c=a[i],h=a[i+1],w=a[i+2];if(typeof h!="function"){if(jg(h||c)===null)continue;break}var B=ze(c);B!==null&&(a.splice(i,3),i-=3,Kh(B,{pending:!0,data:w,method:c.method,action:h},h,w))}}))}function Ql(a){function i(re){return Q0(re,a)}Us!==null&&Q0(Us,a),ks!==null&&Q0(ks,a),Ns!==null&&Q0(Ns,a),oc.forEach(i),cc.forEach(i);for(var c=0;c<Is.length;c++){var h=Is[c];h.blockedOn===a&&(h.blockedOn=null)}for(;0<Is.length&&(c=Is[0],c.blockedOn===null);)Ny(c),c.blockedOn===null&&Is.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var w=c[h],B=c[h+1],b=w[V]||null;if(typeof B=="function")b||Qy(c);else if(b){var D=null;if(B&&B.hasAttribute("formAction")){if(w=B,b=B[V]||null)D=b.formAction;else if(jg(w)!==null)continue}else D=b.action;typeof D=="function"?c[h+1]=D:(c.splice(h,3),h-=3),Qy(c)}}}function Ry(){function a(B){B.canIntercept&&B.info==="react-transition"&&B.intercept({handler:function(){return new Promise(function(b){return w=b})},focusReset:"manual",scroll:"manual"})}function i(){w!==null&&(w(),w=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var B=navigation.currentEntry;B&&B.url!=null&&navigation.navigate(B.url,{state:B.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,w=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),w!==null&&(w(),w=null)}}}function Xg(a){this._internalRoot=a}D0.prototype.render=Xg.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,h=dA();Sy(c,h,a,i,null,null)},D0.prototype.unmount=Xg.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;Sy(a.current,2,null,a,null,null),m0(),i[J]=null}};function D0(a){this._internalRoot=a}D0.prototype.unstable_scheduleHydration=function(a){if(a){var i=N();a={blockedOn:null,target:a,priority:i};for(var c=0;c<Is.length&&i!==0&&i<Is[c].priority;c++);Is.splice(c,0,a),c===0&&Ny(a)}};var Dy=t.version;if(Dy!=="19.2.3")throw Error(n(527,Dy,"19.2.3"));oe.findDOMNode=function(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=f(i),a=a!==null?d(a):null,a=a===null?null:a.stateNode,a};var UU={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var M0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!M0.isDisabled&&M0.supportsFiber)try{yt=M0.inject(UU),rr=M0}catch{}}return dc.createRoot=function(a,i){if(!A(a))throw Error(n(299));var c=!1,h="",w=V1,B=K1,b=j1;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(w=i.onUncaughtError),i.onCaughtError!==void 0&&(B=i.onCaughtError),i.onRecoverableError!==void 0&&(b=i.onRecoverableError)),i=Ey(a,1,!1,null,null,c,h,null,w,B,b,Ry),a[J]=i.current,bg(a),new Xg(i)},dc.hydrateRoot=function(a,i,c){if(!A(a))throw Error(n(299));var h=!1,w="",B=V1,b=K1,D=j1,re=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onUncaughtError!==void 0&&(B=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.formState!==void 0&&(re=c.formState)),i=Ey(a,1,!0,i,c??null,h,w,re,B,b,D,Ry),i.context=Ty(null),c=i.current,h=dA(),h=Ai(h),w=xs(h),w.callback=null,vs(c,w,h),c=h,i.current.lanes=c,la(i,c),fa(i),a[J]=i.current,bg(a),new D0(i)},dc.version="19.2.3",dc}var zy;function PU(){if(zy)return Wg.exports;zy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Wg.exports=OU(),Wg.exports}var GU=PU();const VU=Y2(GU);/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Xy="popstate";function KU(e={}){function t(A,s){let{pathname:l="/",search:o="",hash:u=""}=Ki(A.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),jm("",{pathname:l,search:o,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(A,s){let l=A.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let u=A.location.href,f=u.indexOf("#");o=f===-1?u:u.slice(0,f)}return o+"#"+(typeof s=="string"?s:qc(s))}function n(A,s){vA(A.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return zU(t,r,n,e)}function Ur(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function vA(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function jU(){return Math.random().toString(36).substring(2,10)}function Jy(e,t){return{usr:e.state,key:e.key,idx:t}}function jm(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Ki(t):t,state:r,key:t&&t.key||n||jU()}}function qc({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ki(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function zU(e,t,r,n={}){let{window:A=document.defaultView,v5Compat:s=!1}=n,l=A.history,o="POP",u=null,f=d();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function d(){return(l.state||{idx:null}).idx}function m(){o="POP";let T=d(),_=T==null?null:T-f;f=T,u&&u({action:o,location:E.location,delta:_})}function x(T,_){o="PUSH";let F=jm(E.location,T,_);r&&r(F,T),f=d()+1;let S=Jy(F,f),I=E.createHref(F);try{l.pushState(S,"",I)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;A.location.assign(I)}s&&u&&u({action:o,location:E.location,delta:1})}function y(T,_){o="REPLACE";let F=jm(E.location,T,_);r&&r(F,T),f=d();let S=Jy(F,f),I=E.createHref(F);l.replaceState(S,"",I),s&&u&&u({action:o,location:E.location,delta:0})}function C(T){return XU(T)}let E={get action(){return o},get location(){return e(A,l)},listen(T){if(u)throw new Error("A history only accepts one active listener");return A.addEventListener(Xy,m),u=T,()=>{A.removeEventListener(Xy,m),u=null}},createHref(T){return t(A,T)},createURL:C,encodeLocation(T){let _=C(T);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:x,replace:y,go(T){return l.go(T)}};return E}function XU(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Ur(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:qc(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function W2(e,t,r="/"){return JU(e,t,r,!1)}function JU(e,t,r,n){let A=typeof t=="string"?Ki(t):t,s=Za(A.pathname||"/",r);if(s==null)return null;let l=q2(e);YU(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let f=sk(s);o=Ak(l[u],f,n)}return o}function q2(e,t=[],r=[],n="",A=!1){let s=(l,o,u=A,f)=>{let d={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&u)return;Ur(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let m=Ja([n,d.relativePath]),x=r.concat(d);l.children&&l.children.length>0&&(Ur(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),q2(l.children,t,x,m,u)),!(l.path==null&&!l.index)&&t.push({path:m,score:rk(m,l.index),routesMeta:x})};return e.forEach((l,o)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))s(l,o);else for(let f of $2(l.path))s(l,o,!0,f)}),t}function $2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,A=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return A?[s,""]:[s];let l=$2(n.join("/")),o=[];return o.push(...l.map(u=>u===""?s:[s,u].join("/"))),A&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function YU(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:nk(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var WU=/^:[\w-]+$/,qU=3,$U=2,ZU=1,ek=10,tk=-2,Yy=e=>e==="*";function rk(e,t){let r=e.split("/"),n=r.length;return r.some(Yy)&&(n+=tk),t&&(n+=$U),r.filter(A=>!Yy(A)).reduce((A,s)=>A+(WU.test(s)?qU:s===""?ZU:ek),n)}function nk(e,t){return e.length===t.length&&e.slice(0,-1).every((n,A)=>n===t[A])?e[e.length-1]-t[t.length-1]:0}function Ak(e,t,r=!1){let{routesMeta:n}=e,A={},s="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],f=o===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",m=Hf({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},d),x=u.route;if(!m&&f&&r&&!n[n.length-1].route.index&&(m=Hf({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(A,m.params),l.push({params:A,pathname:Ja([s,m.pathname]),pathnameBase:ck(Ja([s,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(s=Ja([s,m.pathnameBase]))}return l}function Hf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=ak(e.path,e.caseSensitive,e.end),A=t.match(r);if(!A)return null;let s=A[0],l=s.replace(/(.)\/+$/,"$1"),o=A.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:m},x)=>{if(d==="*"){let C=o[x]||"";l=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const y=o[x];return m&&!y?f[d]=void 0:f[d]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:l,pattern:e}}function ak(e,t=!1,r=!0){vA(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],A="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),A+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?A+="\\/*$":e!==""&&e!=="/"&&(A+="(?:(?=\\/|$))"),[new RegExp(A,t?void 0:"i"),n]}function sk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return vA(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Za(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var Z2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ik=e=>Z2.test(e);function lk(e,t="/"){let{pathname:r,search:n="",hash:A=""}=typeof e=="string"?Ki(e):e,s;if(r)if(ik(r))s=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),vA(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${r}`)}r.startsWith("/")?s=Wy(r.substring(1),"/"):s=Wy(r,t)}else s=t;return{pathname:s,search:uk(n),hash:fk(A)}}function Wy(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(A=>{A===".."?r.length>1&&r.pop():A!=="."&&r.push(A)}),r.length>1?r.join("/"):"/"}function em(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ok(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Jp(e){let t=ok(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Yp(e,t,r,n=!1){let A;typeof e=="string"?A=Ki(e):(A={...e},Ur(!A.pathname||!A.pathname.includes("?"),em("?","pathname","search",A)),Ur(!A.pathname||!A.pathname.includes("#"),em("#","pathname","hash",A)),Ur(!A.search||!A.search.includes("#"),em("#","search","hash",A)));let s=e===""||A.pathname==="",l=s?"/":A.pathname,o;if(l==null)o=r;else{let m=t.length-1;if(!n&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),m-=1;A.pathname=x.join("/")}o=m>=0?t[m]:"/"}let u=lk(A,o),f=l&&l!=="/"&&l.endsWith("/"),d=(s||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||d)&&(u.pathname+="/"),u}var Ja=e=>e.join("/").replace(/\/\/+/g,"/"),ck=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,fk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,dk=class{constructor(e,t,r,n=!1){this.status=e,this.statusText=t||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function hk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function gk(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var eT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function tT(e,t){let r=e;if(typeof r!="string"||!Z2.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,A=!1;if(eT)try{let s=new URL(window.location.href),l=r.startsWith("//")?new URL(s.protocol+r):new URL(r),o=Za(l.pathname,t);l.origin===s.origin&&o!=null?r=o+l.search+l.hash:A=!0}catch{vA(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:A,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rT=["POST","PUT","PATCH","DELETE"];new Set(rT);var mk=["GET",...rT];new Set(mk);var uo=W.createContext(null);uo.displayName="DataRouter";var gd=W.createContext(null);gd.displayName="DataRouterState";var pk=W.createContext(!1),nT=W.createContext({isTransitioning:!1});nT.displayName="ViewTransition";var xk=W.createContext(new Map);xk.displayName="Fetchers";var vk=W.createContext(null);vk.displayName="Await";var yA=W.createContext(null);yA.displayName="Navigation";var mu=W.createContext(null);mu.displayName="Location";var xa=W.createContext({outlet:null,matches:[],isDataRoute:!1});xa.displayName="Route";var Wp=W.createContext(null);Wp.displayName="RouteError";var AT="REACT_ROUTER_ERROR",wk="REDIRECT",yk="ROUTE_ERROR_RESPONSE";function Bk(e){if(e.startsWith(`${AT}:${wk}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Ck(e){if(e.startsWith(`${AT}:${yk}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new dk(t.status,t.statusText,t.data)}catch{}}function Ek(e,{relative:t}={}){Ur(fo(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=W.useContext(yA),{hash:A,pathname:s,search:l}=pu(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:Ja([r,s])),n.createHref({pathname:o,search:l,hash:A})}function fo(){return W.useContext(mu)!=null}function ns(){return Ur(fo(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(mu).location}var aT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sT(e){W.useContext(yA).static||W.useLayoutEffect(e)}function md(){let{isDataRoute:e}=W.useContext(xa);return e?Mk():Tk()}function Tk(){Ur(fo(),"useNavigate() may be used only in the context of a <Router> component.");let e=W.useContext(uo),{basename:t,navigator:r}=W.useContext(yA),{matches:n}=W.useContext(xa),{pathname:A}=ns(),s=JSON.stringify(Jp(n)),l=W.useRef(!1);return sT(()=>{l.current=!0}),W.useCallback((u,f={})=>{if(vA(l.current,aT),!l.current)return;if(typeof u=="number"){r.go(u);return}let d=Yp(u,JSON.parse(s),A,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ja([t,d.pathname])),(f.replace?r.replace:r.push)(d,f.state,f)},[t,r,s,A,e])}W.createContext(null);function pu(e,{relative:t}={}){let{matches:r}=W.useContext(xa),{pathname:n}=ns(),A=JSON.stringify(Jp(r));return W.useMemo(()=>Yp(e,JSON.parse(A),n,t==="path"),[e,A,n,t])}function Sk(e,t){return iT(e,t)}function iT(e,t,r,n,A){var F;Ur(fo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=W.useContext(yA),{matches:l}=W.useContext(xa),o=l[l.length-1],u=o?o.params:{},f=o?o.pathname:"/",d=o?o.pathnameBase:"/",m=o&&o.route;{let S=m&&m.path||"";oT(f,!m||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let x=ns(),y;if(t){let S=typeof t=="string"?Ki(t):t;Ur(d==="/"||((F=S.pathname)==null?void 0:F.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${S.pathname}" was given in the \`location\` prop.`),y=S}else y=x;let C=y.pathname||"/",E=C;if(d!=="/"){let S=d.replace(/^\//,"").split("/");E="/"+C.replace(/^\//,"").split("/").slice(S.length).join("/")}let T=W2(e,{pathname:E});vA(m||T!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),vA(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=kk(T&&T.map(S=>Object.assign({},S,{params:Object.assign({},u,S.params),pathname:Ja([d,s.encodeLocation?s.encodeLocation(S.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?d:Ja([d,s.encodeLocation?s.encodeLocation(S.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathnameBase])})),l,r,n,A);return t&&_?W.createElement(mu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},_):_}function _k(){let e=Dk(),t=hk(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",A={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=W.createElement(W.Fragment,null,W.createElement("p",null," Hey developer "),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:s},"ErrorBoundary")," or"," ",W.createElement("code",{style:s},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},t),r?W.createElement("pre",{style:A},r):null,l)}var bk=W.createElement(_k,null),lT=class extends W.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=Ck(e.digest);r&&(e=r)}let t=e!==void 0?W.createElement(xa.Provider,{value:this.props.routeContext},W.createElement(Wp.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?W.createElement(Fk,{error:e},t):t}};lT.contextType=pk;var tm=new WeakMap;function Fk({children:e,error:t}){let{basename:r}=W.useContext(yA);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=Bk(t.digest);if(n){let A=tm.get(t);if(A)throw A;let s=tT(n.location,r);if(eT&&!tm.get(t))if(s.isExternal||n.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:n.replace}));throw tm.set(t,l),l}return W.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return e}function Uk({routeContext:e,match:t,children:r}){let n=W.useContext(uo);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),W.createElement(xa.Provider,{value:e},r)}function kk(e,t=[],r=null,n=null,A=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=r==null?void 0:r.errors;if(l!=null){let d=s.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);Ur(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),s=s.slice(0,Math.min(s.length,d+1))}let o=!1,u=-1;if(r)for(let d=0;d<s.length;d++){let m=s[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:x,errors:y}=r,C=m.route.loader&&!x.hasOwnProperty(m.route.id)&&(!y||y[m.route.id]===void 0);if(m.route.lazy||C){o=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}let f=r&&n?(d,m)=>{var x,y;n(d,{location:r.location,params:((y=(x=r.matches)==null?void 0:x[0])==null?void 0:y.params)??{},unstable_pattern:gk(r.matches),errorInfo:m})}:void 0;return s.reduceRight((d,m,x)=>{let y,C=!1,E=null,T=null;r&&(y=l&&m.route.id?l[m.route.id]:void 0,E=m.route.errorElement||bk,o&&(u<0&&x===0?(oT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,T=null):u===x&&(C=!0,T=m.route.hydrateFallbackElement||null)));let _=t.concat(s.slice(0,x+1)),F=()=>{let S;return y?S=E:C?S=T:m.route.Component?S=W.createElement(m.route.Component,null):m.route.element?S=m.route.element:S=d,W.createElement(Uk,{match:m,routeContext:{outlet:d,matches:_,isDataRoute:r!=null},children:S})};return r&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?W.createElement(lT,{location:r.location,revalidation:r.revalidation,component:E,error:y,children:F(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:f}):F()},null)}function qp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Nk(e){let t=W.useContext(uo);return Ur(t,qp(e)),t}function Ik(e){let t=W.useContext(gd);return Ur(t,qp(e)),t}function Qk(e){let t=W.useContext(xa);return Ur(t,qp(e)),t}function $p(e){let t=Qk(e),r=t.matches[t.matches.length-1];return Ur(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Rk(){return $p("useRouteId")}function Dk(){var n;let e=W.useContext(Wp),t=Ik("useRouteError"),r=$p("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Mk(){let{router:e}=Nk("useNavigate"),t=$p("useNavigate"),r=W.useRef(!1);return sT(()=>{r.current=!0}),W.useCallback(async(A,s={})=>{vA(r.current,aT),r.current&&(typeof A=="number"?await e.navigate(A):await e.navigate(A,{fromRouteId:t,...s}))},[e,t])}var qy={};function oT(e,t,r){!t&&!qy[e]&&(qy[e]=!0,vA(!1,r))}W.memo(Lk);function Lk({routes:e,future:t,state:r,onError:n}){return iT(e,void 0,r,n,t)}function zm({to:e,replace:t,state:r,relative:n}){Ur(fo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:A}=W.useContext(yA);vA(!A,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=W.useContext(xa),{pathname:l}=ns(),o=md(),u=Yp(e,Jp(s),l,n==="path"),f=JSON.stringify(u);return W.useEffect(()=>{o(JSON.parse(f),{replace:t,state:r,relative:n})},[o,f,n,t,r]),null}function jl(e){Ur(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Hk({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:A,static:s=!1,unstable_useTransitions:l}){Ur(!fo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),u=W.useMemo(()=>({basename:o,navigator:A,static:s,unstable_useTransitions:l,future:{}}),[o,A,s,l]);typeof r=="string"&&(r=Ki(r));let{pathname:f="/",search:d="",hash:m="",state:x=null,key:y="default"}=r,C=W.useMemo(()=>{let E=Za(f,o);return E==null?null:{location:{pathname:E,search:d,hash:m,state:x,key:y},navigationType:n}},[o,f,d,m,x,y,n]);return vA(C!=null,`<Router basename="${o}"> is not able to match the URL "${f}${d}${m}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:W.createElement(yA.Provider,{value:u},W.createElement(mu.Provider,{children:t,value:C}))}function Ok({children:e,location:t}){return Sk(Xm(e),t)}function Xm(e,t=[]){let r=[];return W.Children.forEach(e,(n,A)=>{if(!W.isValidElement(n))return;let s=[...t,A];if(n.type===W.Fragment){r.push.apply(r,Xm(n.props.children,s));return}Ur(n.type===jl,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ur(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Xm(n.props.children,s)),r.push(l)}),r}var kf="get",Nf="application/x-www-form-urlencoded";function pd(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Pk(e){return pd(e)&&e.tagName.toLowerCase()==="button"}function Gk(e){return pd(e)&&e.tagName.toLowerCase()==="form"}function Vk(e){return pd(e)&&e.tagName.toLowerCase()==="input"}function Kk(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jk(e,t){return e.button===0&&(!t||t==="_self")&&!Kk(e)}var L0=null;function zk(){if(L0===null)try{new FormData(document.createElement("form"),0),L0=!1}catch{L0=!0}return L0}var Xk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rm(e){return e!=null&&!Xk.has(e)?(vA(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Nf}"`),null):e}function Jk(e,t){let r,n,A,s,l;if(Gk(e)){let o=e.getAttribute("action");n=o?Za(o,t):null,r=e.getAttribute("method")||kf,A=rm(e.getAttribute("enctype"))||Nf,s=new FormData(e)}else if(Pk(e)||Vk(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||o.getAttribute("action");if(n=u?Za(u,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||kf,A=rm(e.getAttribute("formenctype"))||rm(o.getAttribute("enctype"))||Nf,s=new FormData(o,e),!zk()){let{name:f,type:d,value:m}=e;if(d==="image"){let x=f?`${f}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else f&&s.append(f,m)}}else{if(pd(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=kf,n=null,A=Nf,l=e}return s&&A==="text/plain"&&(l=s,s=void 0),{action:n,method:r.toLowerCase(),encType:A,formData:s,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Zp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Yk(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&Za(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function Wk(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qk(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function $k(e,t,r){let n=await Promise.all(e.map(async A=>{let s=t.routes[A.route.id];if(s){let l=await Wk(s,r);return l.links?l.links():[]}return[]}));return rN(n.flat(1).filter(qk).filter(A=>A.rel==="stylesheet"||A.rel==="preload").map(A=>A.rel==="stylesheet"?{...A,rel:"prefetch",as:"style"}:{...A,rel:"prefetch"}))}function $y(e,t,r,n,A,s){let l=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,o=(u,f)=>{var d;return r[f].pathname!==u.pathname||((d=r[f].route.path)==null?void 0:d.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return s==="assets"?t.filter((u,f)=>l(u,f)||o(u,f)):s==="data"?t.filter((u,f)=>{var m;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(l(u,f)||o(u,f))return!0;if(u.route.shouldRevalidate){let x=u.route.shouldRevalidate({currentUrl:new URL(A.pathname+A.search+A.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function Zk(e,t,{includeHydrateFallback:r}={}){return eN(e.map(n=>{let A=t.routes[n.route.id];if(!A)return[];let s=[A.module];return A.clientActionModule&&(s=s.concat(A.clientActionModule)),A.clientLoaderModule&&(s=s.concat(A.clientLoaderModule)),r&&A.hydrateFallbackModule&&(s=s.concat(A.hydrateFallbackModule)),A.imports&&(s=s.concat(A.imports)),s}).flat(1))}function eN(e){return[...new Set(e)]}function tN(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function rN(e,t){let r=new Set;return new Set(t),e.reduce((n,A)=>{let s=JSON.stringify(tN(A));return r.has(s)||(r.add(s),n.push({key:s,link:A})),n},[])}function cT(){let e=W.useContext(uo);return Zp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function nN(){let e=W.useContext(gd);return Zp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var ex=W.createContext(void 0);ex.displayName="FrameworkContext";function uT(){let e=W.useContext(ex);return Zp(e,"You must render this element inside a <HydratedRouter> element"),e}function AN(e,t){let r=W.useContext(ex),[n,A]=W.useState(!1),[s,l]=W.useState(!1),{onFocus:o,onBlur:u,onMouseEnter:f,onMouseLeave:d,onTouchStart:m}=t,x=W.useRef(null);W.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let E=_=>{_.forEach(F=>{l(F.isIntersecting)})},T=new IntersectionObserver(E,{threshold:.5});return x.current&&T.observe(x.current),()=>{T.disconnect()}}},[e]),W.useEffect(()=>{if(n){let E=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(E)}}},[n]);let y=()=>{A(!0)},C=()=>{A(!1),l(!1)};return r?e!=="intent"?[s,x,{}]:[s,x,{onFocus:hc(o,y),onBlur:hc(u,C),onMouseEnter:hc(f,y),onMouseLeave:hc(d,C),onTouchStart:hc(m,y)}]:[!1,x,{}]}function hc(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function aN({page:e,...t}){let{router:r}=cT(),n=W.useMemo(()=>W2(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?W.createElement(iN,{page:e,matches:n,...t}):null}function sN(e){let{manifest:t,routeModules:r}=uT(),[n,A]=W.useState([]);return W.useEffect(()=>{let s=!1;return $k(e,t,r).then(l=>{s||A(l)}),()=>{s=!0}},[e,t,r]),n}function iN({page:e,matches:t,...r}){let n=ns(),{manifest:A,routeModules:s}=uT(),{basename:l}=cT(),{loaderData:o,matches:u}=nN(),f=W.useMemo(()=>$y(e,t,u,A,n,"data"),[e,t,u,A,n]),d=W.useMemo(()=>$y(e,t,u,A,n,"assets"),[e,t,u,A,n]),m=W.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let C=new Set,E=!1;if(t.forEach(_=>{var S;let F=A.routes[_.route.id];!F||!F.hasLoader||(!f.some(I=>I.route.id===_.route.id)&&_.route.id in o&&((S=s[_.route.id])!=null&&S.shouldRevalidate)||F.hasClientLoader?E=!0:C.add(_.route.id))}),C.size===0)return[];let T=Yk(e,l,"data");return E&&C.size>0&&T.searchParams.set("_routes",t.filter(_=>C.has(_.route.id)).map(_=>_.route.id).join(",")),[T.pathname+T.search]},[l,o,n,A,f,t,e,s]),x=W.useMemo(()=>Zk(d,A),[d,A]),y=sN(d);return W.createElement(W.Fragment,null,m.map(C=>W.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...r})),x.map(C=>W.createElement("link",{key:C,rel:"modulepreload",href:C,...r})),y.map(({key:C,link:E})=>W.createElement("link",{key:C,nonce:r.nonce,...E})))}function lN(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var oN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oN&&(window.__reactRouterVersion="7.11.0")}catch{}function cN({basename:e,children:t,unstable_useTransitions:r,window:n}){let A=W.useRef();A.current==null&&(A.current=KU({window:n,v5Compat:!0}));let s=A.current,[l,o]=W.useState({action:s.action,location:s.location}),u=W.useCallback(f=>{r===!1?o(f):W.startTransition(()=>o(f))},[r]);return W.useLayoutEffect(()=>s.listen(u),[s,u]),W.createElement(Hk,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:s,unstable_useTransitions:r})}var fT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dT=W.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:A,reloadDocument:s,replace:l,state:o,target:u,to:f,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:x,...y},C){let{basename:E,unstable_useTransitions:T}=W.useContext(yA),_=typeof f=="string"&&fT.test(f),F=tT(f,E);f=F.to;let S=Ek(f,{relative:A}),[I,M,Q]=AN(n,y),U=hN(f,{replace:l,state:o,target:u,preventScrollReset:d,relative:A,viewTransition:m,unstable_defaultShouldRevalidate:x,unstable_useTransitions:T});function G(te){t&&t(te),te.defaultPrevented||U(te)}let R=W.createElement("a",{...y,...Q,href:F.absoluteURL||S,onClick:F.isExternal||s?t:G,ref:lN(C,M),target:u,"data-discover":!_&&r==="render"?"true":void 0});return I&&!_?W.createElement(W.Fragment,null,R,W.createElement(aN,{page:S})):R});dT.displayName="Link";var uN=W.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:A=!1,style:s,to:l,viewTransition:o,children:u,...f},d){let m=pu(l,{relative:f.relative}),x=ns(),y=W.useContext(gd),{navigator:C,basename:E}=W.useContext(yA),T=y!=null&&vN(m)&&o===!0,_=C.encodeLocation?C.encodeLocation(m).pathname:m.pathname,F=x.pathname,S=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(F=F.toLowerCase(),S=S?S.toLowerCase():null,_=_.toLowerCase()),S&&E&&(S=Za(S,E)||S);const I=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let M=F===_||!A&&F.startsWith(_)&&F.charAt(I)==="/",Q=S!=null&&(S===_||!A&&S.startsWith(_)&&S.charAt(_.length)==="/"),U={isActive:M,isPending:Q,isTransitioning:T},G=M?t:void 0,R;typeof n=="function"?R=n(U):R=[n,M?"active":null,Q?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let te=typeof s=="function"?s(U):s;return W.createElement(dT,{...f,"aria-current":G,className:R,ref:d,style:te,to:l,viewTransition:o},typeof u=="function"?u(U):u)});uN.displayName="NavLink";var fN=W.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:A,state:s,method:l=kf,action:o,onSubmit:u,relative:f,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:x,...y},C)=>{let{unstable_useTransitions:E}=W.useContext(yA),T=pN(),_=xN(o,{relative:f}),F=l.toLowerCase()==="get"?"get":"post",S=typeof o=="string"&&fT.test(o),I=M=>{if(u&&u(M),M.defaultPrevented)return;M.preventDefault();let Q=M.nativeEvent.submitter,U=(Q==null?void 0:Q.getAttribute("formmethod"))||l,G=()=>T(Q||M.currentTarget,{fetcherKey:t,method:U,navigate:r,replace:A,state:s,relative:f,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:x});E&&r!==!1?W.startTransition(()=>G()):G()};return W.createElement("form",{ref:C,method:F,action:_,onSubmit:n?u:I,...y,"data-discover":!S&&e==="render"?"true":void 0})});fN.displayName="Form";function dN(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hT(e){let t=W.useContext(uo);return Ur(t,dN(e)),t}function hN(e,{target:t,replace:r,state:n,preventScrollReset:A,relative:s,viewTransition:l,unstable_defaultShouldRevalidate:o,unstable_useTransitions:u}={}){let f=md(),d=ns(),m=pu(e,{relative:s});return W.useCallback(x=>{if(jk(x,t)){x.preventDefault();let y=r!==void 0?r:qc(d)===qc(m),C=()=>f(e,{replace:y,state:n,preventScrollReset:A,relative:s,viewTransition:l,unstable_defaultShouldRevalidate:o});u?W.startTransition(()=>C()):C()}},[d,f,m,r,n,t,e,A,s,l,o,u])}var gN=0,mN=()=>`__${String(++gN)}__`;function pN(){let{router:e}=hT("useSubmit"),{basename:t}=W.useContext(yA),r=Rk(),n=e.fetch,A=e.navigate;return W.useCallback(async(s,l={})=>{let{action:o,method:u,encType:f,formData:d,body:m}=Jk(s,t);if(l.navigate===!1){let x=l.fetcherKey||mN();await n(x,r,l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:d,body:m,formMethod:l.method||u,formEncType:l.encType||f,flushSync:l.flushSync})}else await A(l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:d,body:m,formMethod:l.method||u,formEncType:l.encType||f,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[n,A,t,r])}function xN(e,{relative:t}={}){let{basename:r}=W.useContext(yA),n=W.useContext(xa);Ur(n,"useFormAction must be used inside a RouteContext");let[A]=n.matches.slice(-1),s={...pu(e||".",{relative:t})},l=ns();if(e==null){s.search=l.search;let o=new URLSearchParams(s.search),u=o.getAll("index");if(u.some(d=>d==="")){o.delete("index"),u.filter(m=>m).forEach(m=>o.append("index",m));let d=o.toString();s.search=d?`?${d}`:""}}return(!e||e===".")&&A.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Ja([r,s.pathname])),qc(s)}function vN(e,{relative:t}={}){let r=W.useContext(nT);Ur(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=hT("useViewTransitionState"),A=pu(e,{relative:t});if(!r.isTransitioning)return!1;let s=Za(r.currentLocation.pathname,n)||r.currentLocation.pathname,l=Za(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Hf(A.pathname,l)!=null||Hf(A.pathname,s)!=null}var xt=(e=>(e.ADMIN="ADMIN",e.TEACHER="TEACHER",e.STUDENT="STUDENT",e))(xt||{}),wN={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let yN,BN;function CN(){return{geminiUrl:yN,vertexUrl:BN}}function EN(e,t,r,n){var A,s;if(!(e!=null&&e.baseUrl)){const l=CN();return t?(A=l.vertexUrl)!==null&&A!==void 0?A:r:(s=l.geminiUrl)!==null&&s!==void 0?s:n}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class As{}function Ye(e,t){const r=/\{([^}]+)\}/g;return e.replace(r,(n,A)=>{if(Object.prototype.hasOwnProperty.call(t,A)){const s=t[A];return s!=null?String(s):""}else throw new Error(`Key '${A}' not found in valueMap.`)})}function v(e,t,r){for(let s=0;s<t.length-1;s++){const l=t[s];if(l.endsWith("[]")){const o=l.slice(0,-2);if(!(o in e))if(Array.isArray(r))e[o]=Array.from({length:r.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[o])){const u=e[o];if(Array.isArray(r))for(let f=0;f<u.length;f++){const d=u[f];v(d,t.slice(s+1),r[f])}else for(const f of u)v(f,t.slice(s+1),r)}return}else if(l.endsWith("[0]")){const o=l.slice(0,-3);o in e||(e[o]=[{}]);const u=e[o];v(u[0],t.slice(s+1),r);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const n=t[t.length-1],A=e[n];if(A!==void 0){if(!r||typeof r=="object"&&Object.keys(r).length===0||r===A)return;if(typeof A=="object"&&typeof r=="object"&&A!==null&&r!==null)Object.assign(A,r);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(e,r):e[n]=r}function p(e,t,r=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return r;const A=t[n];if(A.endsWith("[]")){const s=A.slice(0,-2);if(s in e){const l=e[s];return Array.isArray(l)?l.map(o=>p(o,t.slice(n+1),r)):r}else return r}else e=e[A]}return e}catch(n){if(n instanceof TypeError)return r;throw n}}function TN(e,t){for(const[r,n]of Object.entries(t)){const A=r.split("."),s=n.split("."),l=new Set;let o=-1;for(let u=0;u<A.length;u++)if(A[u]==="*"){o=u;break}if(o!==-1&&s.length>o)for(let u=o;u<s.length;u++){const f=s[u];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}Jm(e,A,s,0,l)}}function Jm(e,t,r,n,A){if(n>=t.length||typeof e!="object"||e===null)return;const s=t[n];if(s.endsWith("[]")){const l=s.slice(0,-2),o=e;if(l in o&&Array.isArray(o[l]))for(const u of o[l])Jm(u,t,r,n+1,A)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const l=e,o=Object.keys(l).filter(f=>!f.startsWith("_")&&!A.has(f)),u={};for(const f of o)u[f]=l[f];for(const[f,d]of Object.entries(u)){const m=[];for(const x of r.slice(n))x==="*"?m.push(f):m.push(x);v(l,m,d)}for(const f of o)delete l[f]}}else{const l=e;s in l&&Jm(l[s],t,r,n+1,A)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tx(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SN(e){const t={},r=p(e,["operationName"]);r!=null&&v(t,["operationName"],r);const n=p(e,["resourceName"]);return n!=null&&v(t,["_url","resourceName"],n),t}function _N(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response","generateVideoResponse"]);return l!=null&&v(t,["response"],FN(l)),t}function bN(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],UN(l)),t}function FN(e){const t={},r=p(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>kN(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const A=p(e,["raiMediaFilteredReasons"]);return A!=null&&v(t,["raiMediaFilteredReasons"],A),t}function UN(e){const t={},r=p(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>NN(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const A=p(e,["raiMediaFilteredReasons"]);return A!=null&&v(t,["raiMediaFilteredReasons"],A),t}function kN(e){const t={},r=p(e,["video"]);return r!=null&&v(t,["video"],LN(r)),t}function NN(e){const t={},r=p(e,["_self"]);return r!=null&&v(t,["video"],HN(r)),t}function IN(e){const t={},r=p(e,["operationName"]);return r!=null&&v(t,["_url","operationName"],r),t}function QN(e){const t={},r=p(e,["operationName"]);return r!=null&&v(t,["_url","operationName"],r),t}function RN(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],DN(l)),t}function DN(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["parent"]);n!=null&&v(t,["parent"],n);const A=p(e,["documentName"]);return A!=null&&v(t,["documentName"],A),t}function gT(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],MN(l)),t}function MN(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["parent"]);n!=null&&v(t,["parent"],n);const A=p(e,["documentName"]);return A!=null&&v(t,["documentName"],A),t}function LN(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["uri"],r);const n=p(e,["encodedVideo"]);n!=null&&v(t,["videoBytes"],tx(n));const A=p(e,["encoding"]);return A!=null&&v(t,["mimeType"],A),t}function HN(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["uri"],r);const n=p(e,["bytesBase64Encoded"]);n!=null&&v(t,["videoBytes"],tx(n));const A=p(e,["mimeType"]);return A!=null&&v(t,["mimeType"],A),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Zy;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Zy||(Zy={}));var eB;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(eB||(eB={}));var tB;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(tB||(tB={}));var tn;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(tn||(tn={}));var rB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(rB||(rB={}));var nB;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(nB||(nB={}));var AB;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(AB||(AB={}));var aB;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(aB||(aB={}));var sB;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(sB||(sB={}));var iB;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(iB||(iB={}));var lB;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(lB||(lB={}));var oB;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(oB||(oB={}));var cB;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(cB||(cB={}));var uB;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(uB||(uB={}));var fB;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(fB||(fB={}));var dB;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(dB||(dB={}));var hB;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(hB||(hB={}));var gB;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(gB||(gB={}));var mB;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(mB||(mB={}));var Of;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Of||(Of={}));var pB;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(pB||(pB={}));var xB;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(xB||(xB={}));var vB;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(vB||(vB={}));var Ym;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ym||(Ym={}));var wB;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(wB||(wB={}));var yB;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(yB||(yB={}));var BB;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(BB||(BB={}));var CB;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(CB||(CB={}));var EB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(EB||(EB={}));var TB;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(TB||(TB={}));var SB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(SB||(SB={}));var _B;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(_B||(_B={}));var bB;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(bB||(bB={}));var FB;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(FB||(FB={}));var UB;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(UB||(UB={}));var kB;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(kB||(kB={}));var NB;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(NB||(NB={}));var IB;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(IB||(IB={}));var QB;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(QB||(QB={}));var RB;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(RB||(RB={}));var DB;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(DB||(DB={}));var MB;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(MB||(MB={}));var LB;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(LB||(LB={}));var HB;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(HB||(HB={}));var OB;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(OB||(OB={}));var PB;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(PB||(PB={}));var GB;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(GB||(GB={}));var VB;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(VB||(VB={}));var KB;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(KB||(KB={}));var jB;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(jB||(jB={}));var zB;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(zB||(zB={}));var XB;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(XB||(XB={}));var JB;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(JB||(JB={}));var YB;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(YB||(YB={}));var WB;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(WB||(WB={}));var Wl;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Wl||(Wl={}));class Wm{constructor(t){const r={};for(const n of t.headers.entries())r[n[0]]=n[1];this.headers=r,this.responseInternal=t}json(){return this.responseInternal.json()}}class gc{get text(){var t,r,n,A,s,l,o,u;if(((A=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||A===void 0?void 0:A.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",d=!1;const m=[];for(const x of(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)!==null&&u!==void 0?u:[]){for(const[y,C]of Object.entries(x))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(C!==null||C!==void 0)&&m.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;d=!0,f+=x.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?f:void 0}get data(){var t,r,n,A,s,l,o,u;if(((A=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||A===void 0?void 0:A.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const d=[];for(const m of(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)!==null&&u!==void 0?u:[]){for(const[x,y]of Object.entries(m))x!=="inlineData"&&(y!==null||y!==void 0)&&d.push(x);m.inlineData&&typeof m.inlineData.data=="string"&&(f+=atob(m.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var t,r,n,A,s,l,o,u;if(((A=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||A===void 0?void 0:A.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var t,r,n,A,s,l,o,u,f;if(((A=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||A===void 0?void 0:A.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var t,r,n,A,s,l,o,u,f;if(((A=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||A===void 0?void 0:A.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.output}}class qB{}class $B{}class ON{}class PN{}class GN{}class VN{}class ZB{}class eC{}class tC{}class KN{}class Pf{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new Pf;let A;const s=t;return r?A=bN(s):A=_N(s),Object.assign(n,A),n}}class rC{}class nC{}class AC{}class aC{}class jN{}class zN{}class XN{}class rx{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new rx,s=RN(t);return Object.assign(n,s),n}}class JN{}class YN{}class WN{}class sC{}class qN{get text(){var t,r,n;let A="",s=!1;const l=[];for(const o of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[u,f]of Object.entries(o))u!=="text"&&u!=="thought"&&f!==null&&l.push(u);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;s=!0,A+=o.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?A:void 0}get data(){var t,r,n;let A="";const s=[];for(const l of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[o,u]of Object.entries(l))o!=="inlineData"&&u!==null&&s.push(o);l.inlineData&&typeof l.inlineData.data=="string"&&(A+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),A.length>0?btoa(A):void 0}}class $N{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class nx{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new nx,s=gT(t);return Object.assign(n,s),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $t(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const r=t.split("/",2);return`publishers/${r[0]}/models/${r[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function mT(e,t){const r=$t(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function pT(e){return Array.isArray(e)?e.map(t=>Gf(t)):[Gf(e)]}function Gf(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function xT(e){const t=Gf(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function vT(e){const t=Gf(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function iC(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function wT(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>iC(t)):[iC(e)]}function qm(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function lC(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function oC(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Mn(e){if(e==null)throw new Error("ContentUnion is required");return qm(e)?e:{role:"user",parts:wT(e)}}function Ax(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(r=>{const n=Mn(r);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(e.isVertexAI()){const r=Mn(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]}return Array.isArray(t)?t.map(r=>Mn(r)):[Mn(t)]}function VA(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(lC(e)||oC(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Mn(e)]}const t=[],r=[],n=qm(e[0]);for(const A of e){const s=qm(A);if(s!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(A);else{if(lC(A)||oC(A))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(A)}}return n||t.push({role:"user",parts:wT(r)}),t}function ZN(e,t){e.includes("null")&&(t.nullable=!0);const r=e.filter(n=>n!=="null");if(r.length===1)t.type=Object.values(tn).includes(r[0].toUpperCase())?r[0].toUpperCase():tn.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of r)t.anyOf.push({type:Object.values(tn).includes(n.toUpperCase())?n.toUpperCase():tn.TYPE_UNSPECIFIED})}}function eo(e){const t={},r=["items"],n=["anyOf"],A=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&ZN(e.type,t);for(const[l,o]of Object.entries(e))if(o!=null)if(l=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;t.type=Object.values(tn).includes(o.toUpperCase())?o.toUpperCase():tn.TYPE_UNSPECIFIED}else if(r.includes(l))t[l]=eo(o);else if(n.includes(l)){const u=[];for(const f of o){if(f.type=="null"){t.nullable=!0;continue}u.push(eo(f))}t[l]=u}else if(A.includes(l)){const u={};for(const[f,d]of Object.entries(o))u[f]=eo(d);t[l]=u}else{if(l==="additionalProperties")continue;t[l]=o}return t}function ax(e){return eo(e)}function sx(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function ix(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function ho(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=eo(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=eo(t.response));return e}function go(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function eI(e,t,r,n=1){const A=!t.startsWith(`${r}/`)&&t.split("/").length===n;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${r}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:A?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`:t:A?`${r}/${t}`:t}function as(e,t){if(typeof t!="string")throw new Error("name must be a string");return eI(e,t,"cachedContents")}function yT(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Zs(e){return tx(e)}function tI(e){return e!=null&&typeof e=="object"&&"name"in e}function rI(e){return e!=null&&typeof e=="object"&&"video"in e}function nI(e){return e!=null&&typeof e=="object"&&"uri"in e}function BT(e){var t;let r;if(tI(e)&&(r=e.name),!(nI(e)&&(r=e.uri,r===void 0))&&!(rI(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const A=r.split("files/")[1].match(/[a-z0-9]+/);if(A===null)throw new Error(`Could not extract file name from URI ${r}`);r=A[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function CT(e,t){let r;return e.isVertexAI()?r=t?"publishers/google/models":"models":r=t?"models":"tunedModels",r}function ET(e){for(const t of["models","tunedModels","publisherModels"])if(AI(e,t))return e[t];return[]}function AI(e,t){return e!==null&&typeof e=="object"&&t in e}function aI(e,t={}){const r=e,n={name:r.name,description:r.description,parametersJsonSchema:r.inputSchema};return r.outputSchema&&(n.responseJsonSchema=r.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}function sI(e,t={}){const r=[],n=new Set;for(const A of e){const s=A.name;if(n.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);n.add(s);const l=aI(A,t);l.functionDeclarations&&r.push(...l.functionDeclarations)}return{functionDeclarations:r}}function TT(e,t){let r;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))r={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;const n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,A=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(A>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||A!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function iI(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function ST(e){if(typeof e!="object"||e===null)return{};const t=e,r=t.inlinedResponses;if(typeof r!="object"||r===null)return e;const A=r.inlinedResponses;if(!Array.isArray(A)||A.length===0)return e;let s=!1;for(const l of A){if(typeof l!="object"||l===null)continue;const u=l.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function mo(e,t){const r=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(r))return r.split("/").pop();throw new Error(`Invalid batch job name: ${r}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(r))return r.split("/").pop();if(/^\d+$/.test(r))return r;throw new Error(`Invalid batch job name: ${r}.`)}function _T(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lI(e){const t={},r=p(e,["responsesFile"]);r!=null&&v(t,["fileName"],r);const n=p(e,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>GI(l))),v(t,["inlinedResponses"],s)}const A=p(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["inlinedEmbedContentResponses"],s)}return t}function oI(e){const t={},r=p(e,["predictionsFormat"]);r!=null&&v(t,["format"],r);const n=p(e,["gcsDestination","outputUriPrefix"]);n!=null&&v(t,["gcsUri"],n);const A=p(e,["bigqueryDestination","outputUri"]);return A!=null&&v(t,["bigqueryUri"],A),t}function cI(e){const t={},r=p(e,["format"]);r!=null&&v(t,["predictionsFormat"],r);const n=p(e,["gcsUri"]);n!=null&&v(t,["gcsDestination","outputUriPrefix"],n);const A=p(e,["bigqueryUri"]);if(A!=null&&v(t,["bigqueryDestination","outputUri"],A),p(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function If(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata","displayName"]);n!=null&&v(t,["displayName"],n);const A=p(e,["metadata","state"]);A!=null&&v(t,["state"],_T(A));const s=p(e,["metadata","createTime"]);s!=null&&v(t,["createTime"],s);const l=p(e,["metadata","endTime"]);l!=null&&v(t,["endTime"],l);const o=p(e,["metadata","updateTime"]);o!=null&&v(t,["updateTime"],o);const u=p(e,["metadata","model"]);u!=null&&v(t,["model"],u);const f=p(e,["metadata","output"]);return f!=null&&v(t,["dest"],lI(ST(f))),t}function $m(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["displayName"]);n!=null&&v(t,["displayName"],n);const A=p(e,["state"]);A!=null&&v(t,["state"],_T(A));const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["createTime"]);l!=null&&v(t,["createTime"],l);const o=p(e,["startTime"]);o!=null&&v(t,["startTime"],o);const u=p(e,["endTime"]);u!=null&&v(t,["endTime"],u);const f=p(e,["updateTime"]);f!=null&&v(t,["updateTime"],f);const d=p(e,["model"]);d!=null&&v(t,["model"],d);const m=p(e,["inputConfig"]);m!=null&&v(t,["src"],uI(m));const x=p(e,["outputConfig"]);x!=null&&v(t,["dest"],oI(ST(x)));const y=p(e,["completionStats"]);return y!=null&&v(t,["completionStats"],y),t}function uI(e){const t={},r=p(e,["instancesFormat"]);r!=null&&v(t,["format"],r);const n=p(e,["gcsSource","uris"]);n!=null&&v(t,["gcsUri"],n);const A=p(e,["bigquerySource","inputUri"]);return A!=null&&v(t,["bigqueryUri"],A),t}function fI(e,t){const r={};if(p(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=p(t,["fileName"]);n!=null&&v(r,["fileName"],n);const A=p(t,["inlinedRequests"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>PI(e,l))),v(r,["requests","requests"],s)}return r}function dI(e){const t={},r=p(e,["format"]);r!=null&&v(t,["instancesFormat"],r);const n=p(e,["gcsUri"]);n!=null&&v(t,["gcsSource","uris"],n);const A=p(e,["bigqueryUri"]);if(A!=null&&v(t,["bigquerySource","inputUri"],A),p(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function hI(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function gI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],mo(e,n)),r}function mI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],mo(e,n)),r}function pI(e){const t={},r=p(e,["content"]);r!=null&&v(t,["content"],r);const n=p(e,["citationMetadata"]);n!=null&&v(t,["citationMetadata"],xI(n));const A=p(e,["tokenCount"]);A!=null&&v(t,["tokenCount"],A);const s=p(e,["finishReason"]);s!=null&&v(t,["finishReason"],s);const l=p(e,["avgLogprobs"]);l!=null&&v(t,["avgLogprobs"],l);const o=p(e,["groundingMetadata"]);o!=null&&v(t,["groundingMetadata"],o);const u=p(e,["index"]);u!=null&&v(t,["index"],u);const f=p(e,["logprobsResult"]);f!=null&&v(t,["logprobsResult"],f);const d=p(e,["safetyRatings"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(y=>y)),v(t,["safetyRatings"],x)}const m=p(e,["urlContextMetadata"]);return m!=null&&v(t,["urlContextMetadata"],m),t}function xI(e){const t={},r=p(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(A=>A)),v(t,["citations"],n)}return t}function bT(e){const t={},r=p(e,["parts"]);if(r!=null){let A=r;Array.isArray(A)&&(A=A.map(s=>YI(s))),v(t,["parts"],A)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function vI(e,t){const r={},n=p(e,["displayName"]);if(t!==void 0&&n!=null&&v(t,["batch","displayName"],n),p(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return r}function wI(e,t){const r={},n=p(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const A=p(e,["dest"]);return t!==void 0&&A!=null&&v(t,["outputConfig"],cI(iI(A))),r}function cC(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["src"]);A!=null&&v(r,["batch","inputConfig"],fI(e,TT(e,A)));const s=p(t,["config"]);return s!=null&&vI(s,r),r}function yI(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["model"],$t(e,n));const A=p(t,["src"]);A!=null&&v(r,["inputConfig"],dI(TT(e,A)));const s=p(t,["config"]);return s!=null&&wI(s,r),r}function BI(e,t){const r={},n=p(e,["displayName"]);return t!==void 0&&n!=null&&v(t,["batch","displayName"],n),r}function CI(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["src"]);A!=null&&v(r,["batch","inputConfig"],UI(e,A));const s=p(t,["config"]);return s!=null&&BI(s,r),r}function EI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],mo(e,n)),r}function TI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],mo(e,n)),r}function SI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);return s!=null&&v(t,["error"],s),t}function _I(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);return s!=null&&v(t,["error"],s),t}function bI(e,t){const r={},n=p(t,["contents"]);if(n!=null){let s=Ax(e,n);Array.isArray(s)&&(s=s.map(l=>l)),v(r,["requests[]","request","content"],s)}const A=p(t,["config"]);return A!=null&&(v(r,["_self"],FI(A,r)),TN(r,{"requests[].*":"requests[].request.*"})),r}function FI(e,t){const r={},n=p(e,["taskType"]);t!==void 0&&n!=null&&v(t,["requests[]","taskType"],n);const A=p(e,["title"]);t!==void 0&&A!=null&&v(t,["requests[]","title"],A);const s=p(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&v(t,["requests[]","outputDimensionality"],s),p(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function UI(e,t){const r={},n=p(t,["fileName"]);n!=null&&v(r,["file_name"],n);const A=p(t,["inlinedRequests"]);return A!=null&&v(r,["requests"],bI(e,A)),r}function kI(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function NI(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const A=p(e,["name"]);if(A!=null&&v(t,["name"],A),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function II(e){const t={},r=p(e,["mode"]);r!=null&&v(t,["mode"],r);const n=p(e,["allowedFunctionNames"]);if(n!=null&&v(t,["allowedFunctionNames"],n),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function QI(e,t,r){const n={},A=p(t,["systemInstruction"]);r!==void 0&&A!=null&&v(r,["systemInstruction"],bT(Mn(A)));const s=p(t,["temperature"]);s!=null&&v(n,["temperature"],s);const l=p(t,["topP"]);l!=null&&v(n,["topP"],l);const o=p(t,["topK"]);o!=null&&v(n,["topK"],o);const u=p(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=p(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=p(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const m=p(t,["responseLogprobs"]);m!=null&&v(n,["responseLogprobs"],m);const x=p(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=p(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const C=p(t,["frequencyPenalty"]);C!=null&&v(n,["frequencyPenalty"],C);const E=p(t,["seed"]);E!=null&&v(n,["seed"],E);const T=p(t,["responseMimeType"]);T!=null&&v(n,["responseMimeType"],T);const _=p(t,["responseSchema"]);_!=null&&v(n,["responseSchema"],ax(_));const F=p(t,["responseJsonSchema"]);if(F!=null&&v(n,["responseJsonSchema"],F),p(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=p(t,["safetySettings"]);if(r!==void 0&&S!=null){let ae=S;Array.isArray(ae)&&(ae=ae.map(Se=>WI(Se))),v(r,["safetySettings"],ae)}const I=p(t,["tools"]);if(r!==void 0&&I!=null){let ae=go(I);Array.isArray(ae)&&(ae=ae.map(Se=>$I(ho(Se)))),v(r,["tools"],ae)}const M=p(t,["toolConfig"]);if(r!==void 0&&M!=null&&v(r,["toolConfig"],qI(M)),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Q=p(t,["cachedContent"]);r!==void 0&&Q!=null&&v(r,["cachedContent"],as(e,Q));const U=p(t,["responseModalities"]);U!=null&&v(n,["responseModalities"],U);const G=p(t,["mediaResolution"]);G!=null&&v(n,["mediaResolution"],G);const R=p(t,["speechConfig"]);if(R!=null&&v(n,["speechConfig"],sx(R)),p(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=p(t,["thinkingConfig"]);te!=null&&v(n,["thinkingConfig"],te);const ne=p(t,["imageConfig"]);ne!=null&&v(n,["imageConfig"],OI(ne));const ee=p(t,["enableEnhancedCivicAnswers"]);return ee!=null&&v(n,["enableEnhancedCivicAnswers"],ee),n}function RI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>pI(f))),v(t,["candidates"],u)}const A=p(e,["modelVersion"]);A!=null&&v(t,["modelVersion"],A);const s=p(e,["promptFeedback"]);s!=null&&v(t,["promptFeedback"],s);const l=p(e,["responseId"]);l!=null&&v(t,["responseId"],l);const o=p(e,["usageMetadata"]);return o!=null&&v(t,["usageMetadata"],o),t}function DI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],mo(e,n)),r}function MI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],mo(e,n)),r}function LI(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function HI(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function OI(e){const t={},r=p(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=p(e,["imageSize"]);if(n!=null&&v(t,["imageSize"],n),p(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function PI(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["request","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let o=VA(A);Array.isArray(o)&&(o=o.map(u=>bT(u))),v(r,["request","contents"],o)}const s=p(t,["metadata"]);s!=null&&v(r,["metadata"],s);const l=p(t,["config"]);return l!=null&&v(r,["request","generationConfig"],QI(e,l,p(r,["request"],{}))),r}function GI(e){const t={},r=p(e,["response"]);r!=null&&v(t,["response"],RI(r));const n=p(e,["error"]);return n!=null&&v(t,["error"],n),t}function VI(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);if(t!==void 0&&A!=null&&v(t,["_query","pageToken"],A),p(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return r}function KI(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);t!==void 0&&A!=null&&v(t,["_query","pageToken"],A);const s=p(e,["filter"]);return t!==void 0&&s!=null&&v(t,["_query","filter"],s),r}function jI(e){const t={},r=p(e,["config"]);return r!=null&&VI(r,t),t}function zI(e){const t={},r=p(e,["config"]);return r!=null&&KI(r,t),t}function XI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["operations"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>If(l))),v(t,["batchJobs"],s)}return t}function JI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["batchPredictionJobs"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>$m(l))),v(t,["batchJobs"],s)}return t}function YI(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const A=p(e,["executableCode"]);A!=null&&v(t,["executableCode"],A);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],kI(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],NI(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],hI(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function WI(e){const t={},r=p(e,["category"]);if(r!=null&&v(t,["category"],r),p(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=p(e,["threshold"]);return n!=null&&v(t,["threshold"],n),t}function qI(e){const t={},r=p(e,["functionCallingConfig"]);r!=null&&v(t,["functionCallingConfig"],II(r));const n=p(e,["retrievalConfig"]);return n!=null&&v(t,["retrievalConfig"],n),t}function $I(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["googleSearchRetrieval"]);n!=null&&v(t,["googleSearchRetrieval"],n);const A=p(e,["computerUse"]);A!=null&&v(t,["computerUse"],A);const s=p(e,["fileSearch"]);s!=null&&v(t,["fileSearch"],s);const l=p(e,["codeExecution"]);if(l!=null&&v(t,["codeExecution"],l),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],LI(o));const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],HI(u));const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var es;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(es||(es={}));class ji{constructor(t,r,n,A){this.pageInternal=[],this.paramsInternal={},this.requestInternal=r,this.init(t,n,A)}init(t,r,n){var A,s;this.nameInternal=t,this.pageInternal=r[this.nameInternal]||[],this.sdkHttpResponseInternal=r==null?void 0:r.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=r.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(A=l.config)===null||A===void 0?void 0:A.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZI extends As{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ji(es.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.create=async r=>(this.apiClient.isVertexAI()&&(r.config=this.formatDestination(r.src,r.config)),this.createInternal(r)),this.createEmbeddings=async r=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(r)}}createInlinedGenerateContentRequest(t){const r=cC(this.apiClient,t),n=r._url,A=Ye("{model}:batchGenerateContent",n),o=r.batch.inputConfig.requests,u=o.requests,f=[];for(const d of u){const m=Object.assign({},d);if(m.systemInstruction){const x=m.systemInstruction;delete m.systemInstruction;const y=m.request;y.systemInstruction=x,m.request=y}f.push(m)}return o.requests=f,delete r.config,delete r._url,delete r._query,{path:A,body:r}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,r){const n=r?Object.assign({},r):{},A=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${A}`),n.dest===void 0){const s=this.getGcsUri(t),l=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?n.dest=`${s.slice(0,-6)}/dest`:n.dest=`${s}_dest_${A}`;else if(l)n.dest=`${l}_dest_${A}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=yI(this.apiClient,t);return o=Ye("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>$m(d))}else{const f=cC(this.apiClient,t);return o=Ye("{model}:batchGenerateContent",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>If(d))}}async createEmbeddingsInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=CI(this.apiClient,t);return s=Ye("{model}:asyncBatchEmbedContent",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>If(u))}}async get(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=MI(this.apiClient,t);return o=Ye("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>$m(d))}else{const f=DI(this.apiClient,t);return o=Ye("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>If(d))}}async cancel(t){var r,n,A,s;let l="",o={};if(this.apiClient.isVertexAI()){const u=mI(this.apiClient,t);l=Ye("batchPredictionJobs/{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const u=gI(this.apiClient,t);l=Ye("batches/{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=zI(t);return o=Ye("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=JI(d),x=new sC;return Object.assign(x,m),x})}else{const f=jI(t);return o=Ye("batches",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=XI(d),x=new sC;return Object.assign(x,m),x})}}async delete(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=TI(this.apiClient,t);return o=Ye("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>_I(d))}else{const f=EI(this.apiClient,t);return o=Ye("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>SI(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eQ(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function uC(e){const t={},r=p(e,["parts"]);if(r!=null){let A=r;Array.isArray(A)&&(A=A.map(s=>CQ(s))),v(t,["parts"],A)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function tQ(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const A=p(e,["expireTime"]);t!==void 0&&A!=null&&v(t,["expireTime"],A);const s=p(e,["displayName"]);t!==void 0&&s!=null&&v(t,["displayName"],s);const l=p(e,["contents"]);if(t!==void 0&&l!=null){let d=VA(l);Array.isArray(d)&&(d=d.map(m=>uC(m))),v(t,["contents"],d)}const o=p(e,["systemInstruction"]);t!==void 0&&o!=null&&v(t,["systemInstruction"],uC(Mn(o)));const u=p(e,["tools"]);if(t!==void 0&&u!=null){let d=u;Array.isArray(d)&&(d=d.map(m=>TQ(m))),v(t,["tools"],d)}const f=p(e,["toolConfig"]);if(t!==void 0&&f!=null&&v(t,["toolConfig"],EQ(f)),p(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function rQ(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const A=p(e,["expireTime"]);t!==void 0&&A!=null&&v(t,["expireTime"],A);const s=p(e,["displayName"]);t!==void 0&&s!=null&&v(t,["displayName"],s);const l=p(e,["contents"]);if(t!==void 0&&l!=null){let m=VA(l);Array.isArray(m)&&(m=m.map(x=>x)),v(t,["contents"],m)}const o=p(e,["systemInstruction"]);t!==void 0&&o!=null&&v(t,["systemInstruction"],Mn(o));const u=p(e,["tools"]);if(t!==void 0&&u!=null){let m=u;Array.isArray(m)&&(m=m.map(x=>SQ(x))),v(t,["tools"],m)}const f=p(e,["toolConfig"]);t!==void 0&&f!=null&&v(t,["toolConfig"],f);const d=p(e,["kmsKeyName"]);return t!==void 0&&d!=null&&v(t,["encryption_spec","kmsKeyName"],d),r}function nQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["model"],mT(e,n));const A=p(t,["config"]);return A!=null&&tQ(A,r),r}function AQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["model"],mT(e,n));const A=p(t,["config"]);return A!=null&&rQ(A,r),r}function aQ(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],as(e,n)),r}function sQ(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],as(e,n)),r}function iQ(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function lQ(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function oQ(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function cQ(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const A=p(e,["name"]);if(A!=null&&v(t,["name"],A),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function uQ(e){const t={},r=p(e,["mode"]);r!=null&&v(t,["mode"],r);const n=p(e,["allowedFunctionNames"]);if(n!=null&&v(t,["allowedFunctionNames"],n),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function fQ(e){const t={};if(p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=p(e,["description"]);r!=null&&v(t,["description"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const A=p(e,["parameters"]);A!=null&&v(t,["parameters"],A);const s=p(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const l=p(e,["response"]);l!=null&&v(t,["response"],l);const o=p(e,["responseJsonSchema"]);return o!=null&&v(t,["responseJsonSchema"],o),t}function dQ(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],as(e,n)),r}function hQ(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],as(e,n)),r}function gQ(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function mQ(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function pQ(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);return t!==void 0&&A!=null&&v(t,["_query","pageToken"],A),r}function xQ(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);return t!==void 0&&A!=null&&v(t,["_query","pageToken"],A),r}function vQ(e){const t={},r=p(e,["config"]);return r!=null&&pQ(r,t),t}function wQ(e){const t={},r=p(e,["config"]);return r!=null&&xQ(r,t),t}function yQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["cachedContents"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["cachedContents"],s)}return t}function BQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["cachedContents"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["cachedContents"],s)}return t}function CQ(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const A=p(e,["executableCode"]);A!=null&&v(t,["executableCode"],A);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],oQ(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],cQ(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],eQ(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function EQ(e){const t={},r=p(e,["functionCallingConfig"]);r!=null&&v(t,["functionCallingConfig"],uQ(r));const n=p(e,["retrievalConfig"]);return n!=null&&v(t,["retrievalConfig"],n),t}function TQ(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["googleSearchRetrieval"]);n!=null&&v(t,["googleSearchRetrieval"],n);const A=p(e,["computerUse"]);A!=null&&v(t,["computerUse"],A);const s=p(e,["fileSearch"]);s!=null&&v(t,["fileSearch"],s);const l=p(e,["codeExecution"]);if(l!=null&&v(t,["codeExecution"],l),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],gQ(o));const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],mQ(u));const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}function SQ(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(x=>fQ(x))),v(t,["functionDeclarations"],m)}const n=p(e,["retrieval"]);n!=null&&v(t,["retrieval"],n);const A=p(e,["googleSearchRetrieval"]);A!=null&&v(t,["googleSearchRetrieval"],A);const s=p(e,["computerUse"]);if(s!=null&&v(t,["computerUse"],s),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(e,["codeExecution"]);l!=null&&v(t,["codeExecution"],l);const o=p(e,["enterpriseWebSearch"]);o!=null&&v(t,["enterpriseWebSearch"],o);const u=p(e,["googleMaps"]);u!=null&&v(t,["googleMaps"],u);const f=p(e,["googleSearch"]);f!=null&&v(t,["googleSearch"],f);const d=p(e,["urlContext"]);return d!=null&&v(t,["urlContext"],d),t}function _Q(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const A=p(e,["expireTime"]);return t!==void 0&&A!=null&&v(t,["expireTime"],A),r}function bQ(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const A=p(e,["expireTime"]);return t!==void 0&&A!=null&&v(t,["expireTime"],A),r}function FQ(e,t){const r={},n=p(t,["name"]);n!=null&&v(r,["_url","name"],as(e,n));const A=p(t,["config"]);return A!=null&&_Q(A,r),r}function UQ(e,t){const r={},n=p(t,["name"]);n!=null&&v(r,["_url","name"],as(e,n));const A=p(t,["config"]);return A!=null&&bQ(A,r),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kQ extends As{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ji(es.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(r),r)}async create(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=AQ(this.apiClient,t);return o=Ye("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>d)}else{const f=nQ(this.apiClient,t);return o=Ye("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>d)}}async get(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=hQ(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>d)}else{const f=dQ(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>d)}}async delete(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=sQ(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=lQ(d),x=new AC;return Object.assign(x,m),x})}else{const f=aQ(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=iQ(d),x=new AC;return Object.assign(x,m),x})}}async update(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=UQ(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>d)}else{const f=FQ(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>d)}}async listInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=wQ(t);return o=Ye("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=BQ(d),x=new aC;return Object.assign(x,m),x})}else{const f=vQ(t);return o=Ye("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=yQ(d),x=new aC;return Object.assign(x,m),x})}}}function Vf(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var A=0,n=Object.getOwnPropertySymbols(e);A<n.length;A++)t.indexOf(n[A])<0&&Object.prototype.propertyIsEnumerable.call(e,n[A])&&(r[n[A]]=e[n[A]]);return r}function fC(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function wt(e){return this instanceof wt?(this.v=e,this):new wt(e)}function ra(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),A,s=[];return A=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",l),A[Symbol.asyncIterator]=function(){return this},A;function l(y){return function(C){return Promise.resolve(C).then(y,m)}}function o(y,C){n[y]&&(A[y]=function(E){return new Promise(function(T,_){s.push([y,E,T,_])>1||u(y,E)})},C&&(A[y]=C(A[y])))}function u(y,C){try{f(n[y](C))}catch(E){x(s[0][3],E)}}function f(y){y.value instanceof wt?Promise.resolve(y.value.v).then(d,m):x(s[0][2],y)}function d(y){u("next",y)}function m(y){u("throw",y)}function x(y,C){y(C),s.shift(),s.length&&u(s[0][0],s[0][1])}}function na(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof fC=="function"?fC(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(l){return new Promise(function(o,u){l=e[s](l),A(o,u,l.done,l.value)})}}function A(s,l,o,u){Promise.resolve(u).then(function(f){s({value:f,done:o})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NQ(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const r=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return r===void 0?!1:FT(r)}function FT(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function IQ(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function dC(e){if(e===void 0||e.length===0)return[];const t=[],r=e.length;let n=0;for(;n<r;)if(e[n].role==="user")t.push(e[n]),n++;else{const A=[];let s=!0;for(;n<r&&e[n].role==="model";)A.push(e[n]),s&&!FT(e[n])&&(s=!1),n++;s?t.push(...A):t.pop()}return t}class QQ{constructor(t,r){this.modelsModule=t,this.apiClient=r}create(t){return new RQ(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class RQ{constructor(t,r,n,A={},s=[]){this.apiClient=t,this.modelsModule=r,this.model=n,this.config=A,this.history=s,this.sendPromise=Promise.resolve(),IQ(s)}async sendMessage(t){var r;await this.sendPromise;const n=Mn(t.message),A=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});return this.sendPromise=(async()=>{var s,l,o;const u=await A,f=(l=(s=u.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,d=u.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let x=[];d!=null&&(x=(o=d.slice(m))!==null&&o!==void 0?o:[]);const y=f?[f]:[];this.recordHistory(n,y,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),A}async sendMessageStream(t){var r;await this.sendPromise;const n=Mn(t.message),A=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});this.sendPromise=A.then(()=>{}).catch(()=>{});const s=await A;return this.processStreamResponse(s,n)}getHistory(t=!1){const r=t?dC(this.history):this.history;return structuredClone(r)}processStreamResponse(t,r){return ra(this,arguments,function*(){var A,s,l,o,u,f;const d=[];try{for(var m=!0,x=na(t),y;y=yield wt(x.next()),A=y.done,!A;m=!0){o=y.value,m=!1;const C=o;if(NQ(C)){const E=(f=(u=C.candidates)===null||u===void 0?void 0:u[0])===null||f===void 0?void 0:f.content;E!==void 0&&d.push(E)}yield yield wt(C)}}catch(C){s={error:C}}finally{try{!m&&!A&&(l=x.return)&&(yield wt(l.call(x)))}finally{if(s)throw s.error}}this.recordHistory(r,d)})}recordHistory(t,r,n){let A=[];r.length>0&&r.every(s=>s.role!==void 0)?A=r:A.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...dC(n)):this.history.push(t),this.history.push(...A)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xd extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,xd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DQ(e){const t={},r=p(e,["file"]);return r!=null&&v(t,["file"],r),t}function MQ(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function LQ(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","file"],BT(r)),t}function HQ(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function OQ(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","file"],BT(r)),t}function PQ(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);return t!==void 0&&A!=null&&v(t,["_query","pageToken"],A),r}function GQ(e){const t={},r=p(e,["config"]);return r!=null&&PQ(r,t),t}function VQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["files"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KQ extends As{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ji(es.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(r),r)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(r=>r)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=GQ(t);return s=Ye("files",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>{const f=VQ(u),d=new JN;return Object.assign(d,f),d})}}async createInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=DQ(t);return s=Ye("upload/v1beta/files",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=MQ(u),d=new YN;return Object.assign(d,f),d})}}async get(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=OQ(t);return s=Ye("files/{file}",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>u)}}async delete(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=LQ(t);return s=Ye("files/{file}",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>{const f=HQ(u),d=new WN;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qf(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function jQ(e){const t={},r=p(e,["parts"]);if(r!=null){let A=r;Array.isArray(A)&&(A=A.map(s=>i3(s))),v(t,["parts"],A)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function zQ(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function XQ(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const A=p(e,["name"]);if(A!=null&&v(t,["name"],A),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function JQ(e){const t={};if(p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=p(e,["description"]);r!=null&&v(t,["description"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const A=p(e,["parameters"]);A!=null&&v(t,["parameters"],A);const s=p(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const l=p(e,["response"]);l!=null&&v(t,["response"],l);const o=p(e,["responseJsonSchema"]);return o!=null&&v(t,["responseJsonSchema"],o),t}function YQ(e){const t={},r=p(e,["modelSelectionConfig"]);r!=null&&v(t,["modelConfig"],r);const n=p(e,["responseJsonSchema"]);n!=null&&v(t,["responseJsonSchema"],n);const A=p(e,["audioTimestamp"]);A!=null&&v(t,["audioTimestamp"],A);const s=p(e,["candidateCount"]);s!=null&&v(t,["candidateCount"],s);const l=p(e,["enableAffectiveDialog"]);l!=null&&v(t,["enableAffectiveDialog"],l);const o=p(e,["frequencyPenalty"]);o!=null&&v(t,["frequencyPenalty"],o);const u=p(e,["logprobs"]);u!=null&&v(t,["logprobs"],u);const f=p(e,["maxOutputTokens"]);f!=null&&v(t,["maxOutputTokens"],f);const d=p(e,["mediaResolution"]);d!=null&&v(t,["mediaResolution"],d);const m=p(e,["presencePenalty"]);m!=null&&v(t,["presencePenalty"],m);const x=p(e,["responseLogprobs"]);x!=null&&v(t,["responseLogprobs"],x);const y=p(e,["responseMimeType"]);y!=null&&v(t,["responseMimeType"],y);const C=p(e,["responseModalities"]);C!=null&&v(t,["responseModalities"],C);const E=p(e,["responseSchema"]);E!=null&&v(t,["responseSchema"],E);const T=p(e,["routingConfig"]);T!=null&&v(t,["routingConfig"],T);const _=p(e,["seed"]);_!=null&&v(t,["seed"],_);const F=p(e,["speechConfig"]);F!=null&&v(t,["speechConfig"],F);const S=p(e,["stopSequences"]);S!=null&&v(t,["stopSequences"],S);const I=p(e,["temperature"]);I!=null&&v(t,["temperature"],I);const M=p(e,["thinkingConfig"]);M!=null&&v(t,["thinkingConfig"],M);const Q=p(e,["topK"]);Q!=null&&v(t,["topK"],Q);const U=p(e,["topP"]);if(U!=null&&v(t,["topP"],U),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function WQ(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function qQ(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function $Q(e,t){const r={},n=p(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],n);const A=p(e,["responseModalities"]);t!==void 0&&A!=null&&v(t,["setup","generationConfig","responseModalities"],A);const s=p(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const l=p(e,["topP"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topP"],l);const o=p(e,["topK"]);t!==void 0&&o!=null&&v(t,["setup","generationConfig","topK"],o);const u=p(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=p(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const m=p(e,["speechConfig"]);t!==void 0&&m!=null&&v(t,["setup","generationConfig","speechConfig"],ix(m));const x=p(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=p(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const C=p(e,["systemInstruction"]);t!==void 0&&C!=null&&v(t,["setup","systemInstruction"],jQ(Mn(C)));const E=p(e,["tools"]);if(t!==void 0&&E!=null){let Q=go(E);Array.isArray(Q)&&(Q=Q.map(U=>o3(ho(U)))),v(t,["setup","tools"],Q)}const T=p(e,["sessionResumption"]);t!==void 0&&T!=null&&v(t,["setup","sessionResumption"],l3(T));const _=p(e,["inputAudioTranscription"]);t!==void 0&&_!=null&&v(t,["setup","inputAudioTranscription"],_);const F=p(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const S=p(e,["realtimeInputConfig"]);t!==void 0&&S!=null&&v(t,["setup","realtimeInputConfig"],S);const I=p(e,["contextWindowCompression"]);t!==void 0&&I!=null&&v(t,["setup","contextWindowCompression"],I);const M=p(e,["proactivity"]);if(t!==void 0&&M!=null&&v(t,["setup","proactivity"],M),p(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return r}function ZQ(e,t){const r={},n=p(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],YQ(n));const A=p(e,["responseModalities"]);t!==void 0&&A!=null&&v(t,["setup","generationConfig","responseModalities"],A);const s=p(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const l=p(e,["topP"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topP"],l);const o=p(e,["topK"]);t!==void 0&&o!=null&&v(t,["setup","generationConfig","topK"],o);const u=p(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=p(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const m=p(e,["speechConfig"]);t!==void 0&&m!=null&&v(t,["setup","generationConfig","speechConfig"],ix(m));const x=p(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=p(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const C=p(e,["systemInstruction"]);t!==void 0&&C!=null&&v(t,["setup","systemInstruction"],Mn(C));const E=p(e,["tools"]);if(t!==void 0&&E!=null){let U=go(E);Array.isArray(U)&&(U=U.map(G=>c3(ho(G)))),v(t,["setup","tools"],U)}const T=p(e,["sessionResumption"]);t!==void 0&&T!=null&&v(t,["setup","sessionResumption"],T);const _=p(e,["inputAudioTranscription"]);t!==void 0&&_!=null&&v(t,["setup","inputAudioTranscription"],_);const F=p(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const S=p(e,["realtimeInputConfig"]);t!==void 0&&S!=null&&v(t,["setup","realtimeInputConfig"],S);const I=p(e,["contextWindowCompression"]);t!==void 0&&I!=null&&v(t,["setup","contextWindowCompression"],I);const M=p(e,["proactivity"]);t!==void 0&&M!=null&&v(t,["setup","proactivity"],M);const Q=p(e,["explicitVadSignal"]);return t!==void 0&&Q!=null&&v(t,["setup","explicitVadSignal"],Q),r}function e3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["setup","model"],$t(e,n));const A=p(t,["config"]);return A!=null&&v(r,["config"],$Q(A,r)),r}function t3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["setup","model"],$t(e,n));const A=p(t,["config"]);return A!=null&&v(r,["config"],ZQ(A,r)),r}function r3(e){const t={},r=p(e,["musicGenerationConfig"]);return r!=null&&v(t,["musicGenerationConfig"],r),t}function n3(e){const t={},r=p(e,["weightedPrompts"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(A=>A)),v(t,["weightedPrompts"],n)}return t}function A3(e){const t={},r=p(e,["media"]);if(r!=null){let f=pT(r);Array.isArray(f)&&(f=f.map(d=>Qf(d))),v(t,["mediaChunks"],f)}const n=p(e,["audio"]);n!=null&&v(t,["audio"],Qf(vT(n)));const A=p(e,["audioStreamEnd"]);A!=null&&v(t,["audioStreamEnd"],A);const s=p(e,["video"]);s!=null&&v(t,["video"],Qf(xT(s)));const l=p(e,["text"]);l!=null&&v(t,["text"],l);const o=p(e,["activityStart"]);o!=null&&v(t,["activityStart"],o);const u=p(e,["activityEnd"]);return u!=null&&v(t,["activityEnd"],u),t}function a3(e){const t={},r=p(e,["media"]);if(r!=null){let f=pT(r);Array.isArray(f)&&(f=f.map(d=>d)),v(t,["mediaChunks"],f)}const n=p(e,["audio"]);n!=null&&v(t,["audio"],vT(n));const A=p(e,["audioStreamEnd"]);A!=null&&v(t,["audioStreamEnd"],A);const s=p(e,["video"]);s!=null&&v(t,["video"],xT(s));const l=p(e,["text"]);l!=null&&v(t,["text"],l);const o=p(e,["activityStart"]);o!=null&&v(t,["activityStart"],o);const u=p(e,["activityEnd"]);return u!=null&&v(t,["activityEnd"],u),t}function s3(e){const t={},r=p(e,["setupComplete"]);r!=null&&v(t,["setupComplete"],r);const n=p(e,["serverContent"]);n!=null&&v(t,["serverContent"],n);const A=p(e,["toolCall"]);A!=null&&v(t,["toolCall"],A);const s=p(e,["toolCallCancellation"]);s!=null&&v(t,["toolCallCancellation"],s);const l=p(e,["usageMetadata"]);l!=null&&v(t,["usageMetadata"],u3(l));const o=p(e,["goAway"]);o!=null&&v(t,["goAway"],o);const u=p(e,["sessionResumptionUpdate"]);u!=null&&v(t,["sessionResumptionUpdate"],u);const f=p(e,["voiceActivityDetectionSignal"]);return f!=null&&v(t,["voiceActivityDetectionSignal"],f),t}function i3(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const A=p(e,["executableCode"]);A!=null&&v(t,["executableCode"],A);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],zQ(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],XQ(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],Qf(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function l3(e){const t={},r=p(e,["handle"]);if(r!=null&&v(t,["handle"],r),p(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function o3(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["googleSearchRetrieval"]);n!=null&&v(t,["googleSearchRetrieval"],n);const A=p(e,["computerUse"]);A!=null&&v(t,["computerUse"],A);const s=p(e,["fileSearch"]);s!=null&&v(t,["fileSearch"],s);const l=p(e,["codeExecution"]);if(l!=null&&v(t,["codeExecution"],l),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],WQ(o));const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],qQ(u));const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}function c3(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(x=>JQ(x))),v(t,["functionDeclarations"],m)}const n=p(e,["retrieval"]);n!=null&&v(t,["retrieval"],n);const A=p(e,["googleSearchRetrieval"]);A!=null&&v(t,["googleSearchRetrieval"],A);const s=p(e,["computerUse"]);if(s!=null&&v(t,["computerUse"],s),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(e,["codeExecution"]);l!=null&&v(t,["codeExecution"],l);const o=p(e,["enterpriseWebSearch"]);o!=null&&v(t,["enterpriseWebSearch"],o);const u=p(e,["googleMaps"]);u!=null&&v(t,["googleMaps"],u);const f=p(e,["googleSearch"]);f!=null&&v(t,["googleSearch"],f);const d=p(e,["urlContext"]);return d!=null&&v(t,["urlContext"],d),t}function u3(e){const t={},r=p(e,["promptTokenCount"]);r!=null&&v(t,["promptTokenCount"],r);const n=p(e,["cachedContentTokenCount"]);n!=null&&v(t,["cachedContentTokenCount"],n);const A=p(e,["candidatesTokenCount"]);A!=null&&v(t,["responseTokenCount"],A);const s=p(e,["toolUsePromptTokenCount"]);s!=null&&v(t,["toolUsePromptTokenCount"],s);const l=p(e,["thoughtsTokenCount"]);l!=null&&v(t,["thoughtsTokenCount"],l);const o=p(e,["totalTokenCount"]);o!=null&&v(t,["totalTokenCount"],o);const u=p(e,["promptTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["promptTokensDetails"],y)}const f=p(e,["cacheTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["cacheTokensDetails"],y)}const d=p(e,["candidatesTokensDetails"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["responseTokensDetails"],y)}const m=p(e,["toolUsePromptTokensDetails"]);if(m!=null){let y=m;Array.isArray(y)&&(y=y.map(C=>C)),v(t,["toolUsePromptTokensDetails"],y)}const x=p(e,["trafficType"]);return x!=null&&v(t,["trafficType"],x),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f3(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function d3(e){const t={},r=p(e,["content"]);r!=null&&v(t,["content"],r);const n=p(e,["citationMetadata"]);n!=null&&v(t,["citationMetadata"],h3(n));const A=p(e,["tokenCount"]);A!=null&&v(t,["tokenCount"],A);const s=p(e,["finishReason"]);s!=null&&v(t,["finishReason"],s);const l=p(e,["avgLogprobs"]);l!=null&&v(t,["avgLogprobs"],l);const o=p(e,["groundingMetadata"]);o!=null&&v(t,["groundingMetadata"],o);const u=p(e,["index"]);u!=null&&v(t,["index"],u);const f=p(e,["logprobsResult"]);f!=null&&v(t,["logprobsResult"],f);const d=p(e,["safetyRatings"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(y=>y)),v(t,["safetyRatings"],x)}const m=p(e,["urlContextMetadata"]);return m!=null&&v(t,["urlContextMetadata"],m),t}function h3(e){const t={},r=p(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(A=>A)),v(t,["citations"],n)}return t}function g3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let s=VA(A);Array.isArray(s)&&(s=s.map(l=>l)),v(r,["contents"],s)}return r}function m3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["tokensInfo"]);if(n!=null){let A=n;Array.isArray(A)&&(A=A.map(s=>s)),v(t,["tokensInfo"],A)}return t}function p3(e){const t={},r=p(e,["values"]);r!=null&&v(t,["values"],r);const n=p(e,["statistics"]);return n!=null&&v(t,["statistics"],x3(n)),t}function x3(e){const t={},r=p(e,["truncated"]);r!=null&&v(t,["truncated"],r);const n=p(e,["token_count"]);return n!=null&&v(t,["tokenCount"],n),t}function vd(e){const t={},r=p(e,["parts"]);if(r!=null){let A=r;Array.isArray(A)&&(A=A.map(s=>_R(s))),v(t,["parts"],A)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function v3(e){const t={},r=p(e,["controlType"]);r!=null&&v(t,["controlType"],r);const n=p(e,["enableControlImageComputation"]);return n!=null&&v(t,["computeControl"],n),t}function w3(e){const t={};if(p(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function y3(e,t){const r={},n=p(e,["systemInstruction"]);t!==void 0&&n!=null&&v(t,["systemInstruction"],Mn(n));const A=p(e,["tools"]);if(t!==void 0&&A!=null){let l=A;Array.isArray(l)&&(l=l.map(o=>IT(o))),v(t,["tools"],l)}const s=p(e,["generationConfig"]);return t!==void 0&&s!=null&&v(t,["generationConfig"],fR(s)),r}function B3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let l=VA(A);Array.isArray(l)&&(l=l.map(o=>vd(o))),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&w3(s),r}function C3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let l=VA(A);Array.isArray(l)&&(l=l.map(o=>o)),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&y3(s,r),r}function E3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["totalTokens"]);n!=null&&v(t,["totalTokens"],n);const A=p(e,["cachedContentTokenCount"]);return A!=null&&v(t,["cachedContentTokenCount"],A),t}function T3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["totalTokens"]);return n!=null&&v(t,["totalTokens"],n),t}function S3(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],$t(e,n)),r}function _3(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],$t(e,n)),r}function b3(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function F3(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function U3(e,t){const r={},n=p(e,["outputGcsUri"]);t!==void 0&&n!=null&&v(t,["parameters","storageUri"],n);const A=p(e,["negativePrompt"]);t!==void 0&&A!=null&&v(t,["parameters","negativePrompt"],A);const s=p(e,["numberOfImages"]);t!==void 0&&s!=null&&v(t,["parameters","sampleCount"],s);const l=p(e,["aspectRatio"]);t!==void 0&&l!=null&&v(t,["parameters","aspectRatio"],l);const o=p(e,["guidanceScale"]);t!==void 0&&o!=null&&v(t,["parameters","guidanceScale"],o);const u=p(e,["seed"]);t!==void 0&&u!=null&&v(t,["parameters","seed"],u);const f=p(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&v(t,["parameters","safetySetting"],f);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&v(t,["parameters","personGeneration"],d);const m=p(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&v(t,["parameters","includeSafetyAttributes"],m);const x=p(e,["includeRaiReason"]);t!==void 0&&x!=null&&v(t,["parameters","includeRaiReason"],x);const y=p(e,["language"]);t!==void 0&&y!=null&&v(t,["parameters","language"],y);const C=p(e,["outputMimeType"]);t!==void 0&&C!=null&&v(t,["parameters","outputOptions","mimeType"],C);const E=p(e,["outputCompressionQuality"]);t!==void 0&&E!=null&&v(t,["parameters","outputOptions","compressionQuality"],E);const T=p(e,["addWatermark"]);t!==void 0&&T!=null&&v(t,["parameters","addWatermark"],T);const _=p(e,["labels"]);t!==void 0&&_!=null&&v(t,["labels"],_);const F=p(e,["editMode"]);t!==void 0&&F!=null&&v(t,["parameters","editMode"],F);const S=p(e,["baseSteps"]);return t!==void 0&&S!=null&&v(t,["parameters","editConfig","baseSteps"],S),r}function k3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["prompt"]);A!=null&&v(r,["instances[0]","prompt"],A);const s=p(t,["referenceImages"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>IR(u))),v(r,["instances[0]","referenceImages"],o)}const l=p(t,["config"]);return l!=null&&U3(l,r),r}function N3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let A=n;Array.isArray(A)&&(A=A.map(s=>wd(s))),v(t,["generatedImages"],A)}return t}function I3(e,t){const r={},n=p(e,["taskType"]);t!==void 0&&n!=null&&v(t,["requests[]","taskType"],n);const A=p(e,["title"]);t!==void 0&&A!=null&&v(t,["requests[]","title"],A);const s=p(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&v(t,["requests[]","outputDimensionality"],s),p(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Q3(e,t){const r={},n=p(e,["taskType"]);t!==void 0&&n!=null&&v(t,["instances[]","task_type"],n);const A=p(e,["title"]);t!==void 0&&A!=null&&v(t,["instances[]","title"],A);const s=p(e,["outputDimensionality"]);t!==void 0&&s!=null&&v(t,["parameters","outputDimensionality"],s);const l=p(e,["mimeType"]);t!==void 0&&l!=null&&v(t,["instances[]","mimeType"],l);const o=p(e,["autoTruncate"]);return t!==void 0&&o!=null&&v(t,["parameters","autoTruncate"],o),r}function R3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let o=Ax(e,A);Array.isArray(o)&&(o=o.map(u=>u)),v(r,["requests[]","content"],o)}const s=p(t,["config"]);s!=null&&I3(s,r);const l=p(t,["model"]);return l!==void 0&&v(r,["requests[]","model"],$t(e,l)),r}function D3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let l=Ax(e,A);Array.isArray(l)&&(l=l.map(o=>o)),v(r,["instances[]","content"],l)}const s=p(t,["config"]);return s!=null&&Q3(s,r),r}function M3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["embeddings"],s)}const A=p(e,["metadata"]);return A!=null&&v(t,["metadata"],A),t}function L3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>p3(l))),v(t,["embeddings"],s)}const A=p(e,["metadata"]);return A!=null&&v(t,["metadata"],A),t}function H3(e){const t={},r=p(e,["endpoint"]);r!=null&&v(t,["name"],r);const n=p(e,["deployedModelId"]);return n!=null&&v(t,["deployedModelId"],n),t}function O3(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function P3(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const A=p(e,["name"]);if(A!=null&&v(t,["name"],A),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function G3(e){const t={},r=p(e,["mode"]);r!=null&&v(t,["mode"],r);const n=p(e,["allowedFunctionNames"]);if(n!=null&&v(t,["allowedFunctionNames"],n),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function V3(e){const t={};if(p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=p(e,["description"]);r!=null&&v(t,["description"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const A=p(e,["parameters"]);A!=null&&v(t,["parameters"],A);const s=p(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const l=p(e,["response"]);l!=null&&v(t,["response"],l);const o=p(e,["responseJsonSchema"]);return o!=null&&v(t,["responseJsonSchema"],o),t}function K3(e,t,r){const n={},A=p(t,["systemInstruction"]);r!==void 0&&A!=null&&v(r,["systemInstruction"],vd(Mn(A)));const s=p(t,["temperature"]);s!=null&&v(n,["temperature"],s);const l=p(t,["topP"]);l!=null&&v(n,["topP"],l);const o=p(t,["topK"]);o!=null&&v(n,["topK"],o);const u=p(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=p(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=p(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const m=p(t,["responseLogprobs"]);m!=null&&v(n,["responseLogprobs"],m);const x=p(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=p(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const C=p(t,["frequencyPenalty"]);C!=null&&v(n,["frequencyPenalty"],C);const E=p(t,["seed"]);E!=null&&v(n,["seed"],E);const T=p(t,["responseMimeType"]);T!=null&&v(n,["responseMimeType"],T);const _=p(t,["responseSchema"]);_!=null&&v(n,["responseSchema"],ax(_));const F=p(t,["responseJsonSchema"]);if(F!=null&&v(n,["responseJsonSchema"],F),p(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=p(t,["safetySettings"]);if(r!==void 0&&S!=null){let ae=S;Array.isArray(ae)&&(ae=ae.map(Se=>QR(Se))),v(r,["safetySettings"],ae)}const I=p(t,["tools"]);if(r!==void 0&&I!=null){let ae=go(I);Array.isArray(ae)&&(ae=ae.map(Se=>PR(ho(Se)))),v(r,["tools"],ae)}const M=p(t,["toolConfig"]);if(r!==void 0&&M!=null&&v(r,["toolConfig"],OR(M)),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Q=p(t,["cachedContent"]);r!==void 0&&Q!=null&&v(r,["cachedContent"],as(e,Q));const U=p(t,["responseModalities"]);U!=null&&v(n,["responseModalities"],U);const G=p(t,["mediaResolution"]);G!=null&&v(n,["mediaResolution"],G);const R=p(t,["speechConfig"]);if(R!=null&&v(n,["speechConfig"],sx(R)),p(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=p(t,["thinkingConfig"]);te!=null&&v(n,["thinkingConfig"],te);const ne=p(t,["imageConfig"]);ne!=null&&v(n,["imageConfig"],pR(ne));const ee=p(t,["enableEnhancedCivicAnswers"]);return ee!=null&&v(n,["enableEnhancedCivicAnswers"],ee),n}function j3(e,t,r){const n={},A=p(t,["systemInstruction"]);r!==void 0&&A!=null&&v(r,["systemInstruction"],Mn(A));const s=p(t,["temperature"]);s!=null&&v(n,["temperature"],s);const l=p(t,["topP"]);l!=null&&v(n,["topP"],l);const o=p(t,["topK"]);o!=null&&v(n,["topK"],o);const u=p(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=p(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=p(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const m=p(t,["responseLogprobs"]);m!=null&&v(n,["responseLogprobs"],m);const x=p(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=p(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const C=p(t,["frequencyPenalty"]);C!=null&&v(n,["frequencyPenalty"],C);const E=p(t,["seed"]);E!=null&&v(n,["seed"],E);const T=p(t,["responseMimeType"]);T!=null&&v(n,["responseMimeType"],T);const _=p(t,["responseSchema"]);_!=null&&v(n,["responseSchema"],ax(_));const F=p(t,["responseJsonSchema"]);F!=null&&v(n,["responseJsonSchema"],F);const S=p(t,["routingConfig"]);S!=null&&v(n,["routingConfig"],S);const I=p(t,["modelSelectionConfig"]);I!=null&&v(n,["modelConfig"],I);const M=p(t,["safetySettings"]);if(r!==void 0&&M!=null){let q=M;Array.isArray(q)&&(q=q.map(oe=>oe)),v(r,["safetySettings"],q)}const Q=p(t,["tools"]);if(r!==void 0&&Q!=null){let q=go(Q);Array.isArray(q)&&(q=q.map(oe=>IT(ho(oe)))),v(r,["tools"],q)}const U=p(t,["toolConfig"]);r!==void 0&&U!=null&&v(r,["toolConfig"],U);const G=p(t,["labels"]);r!==void 0&&G!=null&&v(r,["labels"],G);const R=p(t,["cachedContent"]);r!==void 0&&R!=null&&v(r,["cachedContent"],as(e,R));const te=p(t,["responseModalities"]);te!=null&&v(n,["responseModalities"],te);const ne=p(t,["mediaResolution"]);ne!=null&&v(n,["mediaResolution"],ne);const ee=p(t,["speechConfig"]);ee!=null&&v(n,["speechConfig"],sx(ee));const ae=p(t,["audioTimestamp"]);ae!=null&&v(n,["audioTimestamp"],ae);const Se=p(t,["thinkingConfig"]);Se!=null&&v(n,["thinkingConfig"],Se);const Te=p(t,["imageConfig"]);if(Te!=null&&v(n,["imageConfig"],xR(Te)),p(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function hC(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let l=VA(A);Array.isArray(l)&&(l=l.map(o=>vd(o))),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&v(r,["generationConfig"],K3(e,s,r)),r}function gC(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["contents"]);if(A!=null){let l=VA(A);Array.isArray(l)&&(l=l.map(o=>o)),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&v(r,["generationConfig"],j3(e,s,r)),r}function mC(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>d3(f))),v(t,["candidates"],u)}const A=p(e,["modelVersion"]);A!=null&&v(t,["modelVersion"],A);const s=p(e,["promptFeedback"]);s!=null&&v(t,["promptFeedback"],s);const l=p(e,["responseId"]);l!=null&&v(t,["responseId"],l);const o=p(e,["usageMetadata"]);return o!=null&&v(t,["usageMetadata"],o),t}function pC(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>d)),v(t,["candidates"],f)}const A=p(e,["createTime"]);A!=null&&v(t,["createTime"],A);const s=p(e,["modelVersion"]);s!=null&&v(t,["modelVersion"],s);const l=p(e,["promptFeedback"]);l!=null&&v(t,["promptFeedback"],l);const o=p(e,["responseId"]);o!=null&&v(t,["responseId"],o);const u=p(e,["usageMetadata"]);return u!=null&&v(t,["usageMetadata"],u),t}function z3(e,t){const r={};if(p(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=p(e,["numberOfImages"]);t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n);const A=p(e,["aspectRatio"]);t!==void 0&&A!=null&&v(t,["parameters","aspectRatio"],A);const s=p(e,["guidanceScale"]);if(t!==void 0&&s!=null&&v(t,["parameters","guidanceScale"],s),p(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=p(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&v(t,["parameters","safetySetting"],l);const o=p(e,["personGeneration"]);t!==void 0&&o!=null&&v(t,["parameters","personGeneration"],o);const u=p(e,["includeSafetyAttributes"]);t!==void 0&&u!=null&&v(t,["parameters","includeSafetyAttributes"],u);const f=p(e,["includeRaiReason"]);t!==void 0&&f!=null&&v(t,["parameters","includeRaiReason"],f);const d=p(e,["language"]);t!==void 0&&d!=null&&v(t,["parameters","language"],d);const m=p(e,["outputMimeType"]);t!==void 0&&m!=null&&v(t,["parameters","outputOptions","mimeType"],m);const x=p(e,["outputCompressionQuality"]);if(t!==void 0&&x!=null&&v(t,["parameters","outputOptions","compressionQuality"],x),p(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const y=p(e,["imageSize"]);if(t!==void 0&&y!=null&&v(t,["parameters","sampleImageSize"],y),p(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function X3(e,t){const r={},n=p(e,["outputGcsUri"]);t!==void 0&&n!=null&&v(t,["parameters","storageUri"],n);const A=p(e,["negativePrompt"]);t!==void 0&&A!=null&&v(t,["parameters","negativePrompt"],A);const s=p(e,["numberOfImages"]);t!==void 0&&s!=null&&v(t,["parameters","sampleCount"],s);const l=p(e,["aspectRatio"]);t!==void 0&&l!=null&&v(t,["parameters","aspectRatio"],l);const o=p(e,["guidanceScale"]);t!==void 0&&o!=null&&v(t,["parameters","guidanceScale"],o);const u=p(e,["seed"]);t!==void 0&&u!=null&&v(t,["parameters","seed"],u);const f=p(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&v(t,["parameters","safetySetting"],f);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&v(t,["parameters","personGeneration"],d);const m=p(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&v(t,["parameters","includeSafetyAttributes"],m);const x=p(e,["includeRaiReason"]);t!==void 0&&x!=null&&v(t,["parameters","includeRaiReason"],x);const y=p(e,["language"]);t!==void 0&&y!=null&&v(t,["parameters","language"],y);const C=p(e,["outputMimeType"]);t!==void 0&&C!=null&&v(t,["parameters","outputOptions","mimeType"],C);const E=p(e,["outputCompressionQuality"]);t!==void 0&&E!=null&&v(t,["parameters","outputOptions","compressionQuality"],E);const T=p(e,["addWatermark"]);t!==void 0&&T!=null&&v(t,["parameters","addWatermark"],T);const _=p(e,["labels"]);t!==void 0&&_!=null&&v(t,["labels"],_);const F=p(e,["imageSize"]);t!==void 0&&F!=null&&v(t,["parameters","sampleImageSize"],F);const S=p(e,["enhancePrompt"]);return t!==void 0&&S!=null&&v(t,["parameters","enhancePrompt"],S),r}function J3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["prompt"]);A!=null&&v(r,["instances[0]","prompt"],A);const s=p(t,["config"]);return s!=null&&z3(s,r),r}function Y3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["prompt"]);A!=null&&v(r,["instances[0]","prompt"],A);const s=p(t,["config"]);return s!=null&&X3(s,r),r}function W3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>lR(l))),v(t,["generatedImages"],s)}const A=p(e,["positivePromptSafetyAttributes"]);return A!=null&&v(t,["positivePromptSafetyAttributes"],kT(A)),t}function q3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>wd(l))),v(t,["generatedImages"],s)}const A=p(e,["positivePromptSafetyAttributes"]);return A!=null&&v(t,["positivePromptSafetyAttributes"],NT(A)),t}function $3(e,t){const r={},n=p(e,["numberOfVideos"]);if(t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n),p(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const A=p(e,["durationSeconds"]);if(t!==void 0&&A!=null&&v(t,["parameters","durationSeconds"],A),p(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=p(e,["aspectRatio"]);t!==void 0&&s!=null&&v(t,["parameters","aspectRatio"],s);const l=p(e,["resolution"]);t!==void 0&&l!=null&&v(t,["parameters","resolution"],l);const o=p(e,["personGeneration"]);if(t!==void 0&&o!=null&&v(t,["parameters","personGeneration"],o),p(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=p(e,["negativePrompt"]);t!==void 0&&u!=null&&v(t,["parameters","negativePrompt"],u);const f=p(e,["enhancePrompt"]);if(t!==void 0&&f!=null&&v(t,["parameters","enhancePrompt"],f),p(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=p(e,["lastFrame"]);t!==void 0&&d!=null&&v(t,["instances[0]","lastFrame"],yd(d));const m=p(e,["referenceImages"]);if(t!==void 0&&m!=null){let x=m;Array.isArray(x)&&(x=x.map(y=>eD(y))),v(t,["instances[0]","referenceImages"],x)}if(p(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function Z3(e,t){const r={},n=p(e,["numberOfVideos"]);t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n);const A=p(e,["outputGcsUri"]);t!==void 0&&A!=null&&v(t,["parameters","storageUri"],A);const s=p(e,["fps"]);t!==void 0&&s!=null&&v(t,["parameters","fps"],s);const l=p(e,["durationSeconds"]);t!==void 0&&l!=null&&v(t,["parameters","durationSeconds"],l);const o=p(e,["seed"]);t!==void 0&&o!=null&&v(t,["parameters","seed"],o);const u=p(e,["aspectRatio"]);t!==void 0&&u!=null&&v(t,["parameters","aspectRatio"],u);const f=p(e,["resolution"]);t!==void 0&&f!=null&&v(t,["parameters","resolution"],f);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&v(t,["parameters","personGeneration"],d);const m=p(e,["pubsubTopic"]);t!==void 0&&m!=null&&v(t,["parameters","pubsubTopic"],m);const x=p(e,["negativePrompt"]);t!==void 0&&x!=null&&v(t,["parameters","negativePrompt"],x);const y=p(e,["enhancePrompt"]);t!==void 0&&y!=null&&v(t,["parameters","enhancePrompt"],y);const C=p(e,["generateAudio"]);t!==void 0&&C!=null&&v(t,["parameters","generateAudio"],C);const E=p(e,["lastFrame"]);t!==void 0&&E!=null&&v(t,["instances[0]","lastFrame"],sa(E));const T=p(e,["referenceImages"]);if(t!==void 0&&T!=null){let S=T;Array.isArray(S)&&(S=S.map(I=>tD(I))),v(t,["instances[0]","referenceImages"],S)}const _=p(e,["mask"]);t!==void 0&&_!=null&&v(t,["instances[0]","mask"],ZR(_));const F=p(e,["compressionQuality"]);return t!==void 0&&F!=null&&v(t,["parameters","compressionQuality"],F),r}function eR(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response","generateVideoResponse"]);return l!=null&&v(t,["response"],AR(l)),t}function tR(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],aR(l)),t}function rR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["prompt"]);A!=null&&v(r,["instances[0]","prompt"],A);const s=p(t,["image"]);s!=null&&v(r,["instances[0]","image"],yd(s));const l=p(t,["video"]);l!=null&&v(r,["instances[0]","video"],QT(l));const o=p(t,["source"]);o!=null&&sR(o,r);const u=p(t,["config"]);return u!=null&&$3(u,r),r}function nR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["prompt"]);A!=null&&v(r,["instances[0]","prompt"],A);const s=p(t,["image"]);s!=null&&v(r,["instances[0]","image"],sa(s));const l=p(t,["video"]);l!=null&&v(r,["instances[0]","video"],RT(l));const o=p(t,["source"]);o!=null&&iR(o,r);const u=p(t,["config"]);return u!=null&&Z3(u,r),r}function AR(e){const t={},r=p(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>cR(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const A=p(e,["raiMediaFilteredReasons"]);return A!=null&&v(t,["raiMediaFilteredReasons"],A),t}function aR(e){const t={},r=p(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>uR(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const A=p(e,["raiMediaFilteredReasons"]);return A!=null&&v(t,["raiMediaFilteredReasons"],A),t}function sR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const A=p(e,["image"]);t!==void 0&&A!=null&&v(t,["instances[0]","image"],yd(A));const s=p(e,["video"]);return t!==void 0&&s!=null&&v(t,["instances[0]","video"],QT(s)),r}function iR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const A=p(e,["image"]);t!==void 0&&A!=null&&v(t,["instances[0]","image"],sa(A));const s=p(e,["video"]);return t!==void 0&&s!=null&&v(t,["instances[0]","video"],RT(s)),r}function lR(e){const t={},r=p(e,["_self"]);r!=null&&v(t,["image"],vR(r));const n=p(e,["raiFilteredReason"]);n!=null&&v(t,["raiFilteredReason"],n);const A=p(e,["_self"]);return A!=null&&v(t,["safetyAttributes"],kT(A)),t}function wd(e){const t={},r=p(e,["_self"]);r!=null&&v(t,["image"],UT(r));const n=p(e,["raiFilteredReason"]);n!=null&&v(t,["raiFilteredReason"],n);const A=p(e,["_self"]);A!=null&&v(t,["safetyAttributes"],NT(A));const s=p(e,["prompt"]);return s!=null&&v(t,["enhancedPrompt"],s),t}function oR(e){const t={},r=p(e,["_self"]);r!=null&&v(t,["mask"],UT(r));const n=p(e,["labels"]);if(n!=null){let A=n;Array.isArray(A)&&(A=A.map(s=>s)),v(t,["labels"],A)}return t}function cR(e){const t={},r=p(e,["video"]);return r!=null&&v(t,["video"],qR(r)),t}function uR(e){const t={},r=p(e,["_self"]);return r!=null&&v(t,["video"],$R(r)),t}function fR(e){const t={},r=p(e,["modelSelectionConfig"]);r!=null&&v(t,["modelConfig"],r);const n=p(e,["responseJsonSchema"]);n!=null&&v(t,["responseJsonSchema"],n);const A=p(e,["audioTimestamp"]);A!=null&&v(t,["audioTimestamp"],A);const s=p(e,["candidateCount"]);s!=null&&v(t,["candidateCount"],s);const l=p(e,["enableAffectiveDialog"]);l!=null&&v(t,["enableAffectiveDialog"],l);const o=p(e,["frequencyPenalty"]);o!=null&&v(t,["frequencyPenalty"],o);const u=p(e,["logprobs"]);u!=null&&v(t,["logprobs"],u);const f=p(e,["maxOutputTokens"]);f!=null&&v(t,["maxOutputTokens"],f);const d=p(e,["mediaResolution"]);d!=null&&v(t,["mediaResolution"],d);const m=p(e,["presencePenalty"]);m!=null&&v(t,["presencePenalty"],m);const x=p(e,["responseLogprobs"]);x!=null&&v(t,["responseLogprobs"],x);const y=p(e,["responseMimeType"]);y!=null&&v(t,["responseMimeType"],y);const C=p(e,["responseModalities"]);C!=null&&v(t,["responseModalities"],C);const E=p(e,["responseSchema"]);E!=null&&v(t,["responseSchema"],E);const T=p(e,["routingConfig"]);T!=null&&v(t,["routingConfig"],T);const _=p(e,["seed"]);_!=null&&v(t,["seed"],_);const F=p(e,["speechConfig"]);F!=null&&v(t,["speechConfig"],F);const S=p(e,["stopSequences"]);S!=null&&v(t,["stopSequences"],S);const I=p(e,["temperature"]);I!=null&&v(t,["temperature"],I);const M=p(e,["thinkingConfig"]);M!=null&&v(t,["thinkingConfig"],M);const Q=p(e,["topK"]);Q!=null&&v(t,["topK"],Q);const U=p(e,["topP"]);if(U!=null&&v(t,["topP"],U),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function dR(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],$t(e,n)),r}function hR(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],$t(e,n)),r}function gR(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function mR(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function pR(e){const t={},r=p(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=p(e,["imageSize"]);if(n!=null&&v(t,["imageSize"],n),p(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function xR(e){const t={},r=p(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=p(e,["imageSize"]);n!=null&&v(t,["imageSize"],n);const A=p(e,["outputMimeType"]);A!=null&&v(t,["imageOutputOptions","mimeType"],A);const s=p(e,["outputCompressionQuality"]);return s!=null&&v(t,["imageOutputOptions","compressionQuality"],s),t}function vR(e){const t={},r=p(e,["bytesBase64Encoded"]);r!=null&&v(t,["imageBytes"],Zs(r));const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function UT(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["gcsUri"],r);const n=p(e,["bytesBase64Encoded"]);n!=null&&v(t,["imageBytes"],Zs(n));const A=p(e,["mimeType"]);return A!=null&&v(t,["mimeType"],A),t}function yd(e){const t={};if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=p(e,["imageBytes"]);r!=null&&v(t,["bytesBase64Encoded"],Zs(r));const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function sa(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["gcsUri"],r);const n=p(e,["imageBytes"]);n!=null&&v(t,["bytesBase64Encoded"],Zs(n));const A=p(e,["mimeType"]);return A!=null&&v(t,["mimeType"],A),t}function wR(e,t,r){const n={},A=p(t,["pageSize"]);r!==void 0&&A!=null&&v(r,["_query","pageSize"],A);const s=p(t,["pageToken"]);r!==void 0&&s!=null&&v(r,["_query","pageToken"],s);const l=p(t,["filter"]);r!==void 0&&l!=null&&v(r,["_query","filter"],l);const o=p(t,["queryBase"]);return r!==void 0&&o!=null&&v(r,["_url","models_url"],CT(e,o)),n}function yR(e,t,r){const n={},A=p(t,["pageSize"]);r!==void 0&&A!=null&&v(r,["_query","pageSize"],A);const s=p(t,["pageToken"]);r!==void 0&&s!=null&&v(r,["_query","pageToken"],s);const l=p(t,["filter"]);r!==void 0&&l!=null&&v(r,["_query","filter"],l);const o=p(t,["queryBase"]);return r!==void 0&&o!=null&&v(r,["_url","models_url"],CT(e,o)),n}function BR(e,t){const r={},n=p(t,["config"]);return n!=null&&wR(e,n,r),r}function CR(e,t){const r={},n=p(t,["config"]);return n!=null&&yR(e,n,r),r}function ER(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["_self"]);if(A!=null){let s=ET(A);Array.isArray(s)&&(s=s.map(l=>Zm(l))),v(t,["models"],s)}return t}function TR(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["_self"]);if(A!=null){let s=ET(A);Array.isArray(s)&&(s=s.map(l=>ep(l))),v(t,["models"],s)}return t}function SR(e){const t={},r=p(e,["maskMode"]);r!=null&&v(t,["maskMode"],r);const n=p(e,["segmentationClasses"]);n!=null&&v(t,["maskClasses"],n);const A=p(e,["maskDilation"]);return A!=null&&v(t,["dilation"],A),t}function Zm(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["displayName"]);n!=null&&v(t,["displayName"],n);const A=p(e,["description"]);A!=null&&v(t,["description"],A);const s=p(e,["version"]);s!=null&&v(t,["version"],s);const l=p(e,["_self"]);l!=null&&v(t,["tunedModelInfo"],GR(l));const o=p(e,["inputTokenLimit"]);o!=null&&v(t,["inputTokenLimit"],o);const u=p(e,["outputTokenLimit"]);u!=null&&v(t,["outputTokenLimit"],u);const f=p(e,["supportedGenerationMethods"]);f!=null&&v(t,["supportedActions"],f);const d=p(e,["temperature"]);d!=null&&v(t,["temperature"],d);const m=p(e,["maxTemperature"]);m!=null&&v(t,["maxTemperature"],m);const x=p(e,["topP"]);x!=null&&v(t,["topP"],x);const y=p(e,["topK"]);y!=null&&v(t,["topK"],y);const C=p(e,["thinking"]);return C!=null&&v(t,["thinking"],C),t}function ep(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["displayName"]);n!=null&&v(t,["displayName"],n);const A=p(e,["description"]);A!=null&&v(t,["description"],A);const s=p(e,["versionId"]);s!=null&&v(t,["version"],s);const l=p(e,["deployedModels"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(x=>H3(x))),v(t,["endpoints"],m)}const o=p(e,["labels"]);o!=null&&v(t,["labels"],o);const u=p(e,["_self"]);u!=null&&v(t,["tunedModelInfo"],VR(u));const f=p(e,["defaultCheckpointId"]);f!=null&&v(t,["defaultCheckpointId"],f);const d=p(e,["checkpoints"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(x=>x)),v(t,["checkpoints"],m)}return t}function _R(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const A=p(e,["executableCode"]);A!=null&&v(t,["executableCode"],A);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],O3(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],P3(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],f3(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function bR(e){const t={},r=p(e,["productImage"]);return r!=null&&v(t,["image"],sa(r)),t}function FR(e,t){const r={},n=p(e,["numberOfImages"]);t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n);const A=p(e,["baseSteps"]);t!==void 0&&A!=null&&v(t,["parameters","baseSteps"],A);const s=p(e,["outputGcsUri"]);t!==void 0&&s!=null&&v(t,["parameters","storageUri"],s);const l=p(e,["seed"]);t!==void 0&&l!=null&&v(t,["parameters","seed"],l);const o=p(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&v(t,["parameters","safetySetting"],o);const u=p(e,["personGeneration"]);t!==void 0&&u!=null&&v(t,["parameters","personGeneration"],u);const f=p(e,["addWatermark"]);t!==void 0&&f!=null&&v(t,["parameters","addWatermark"],f);const d=p(e,["outputMimeType"]);t!==void 0&&d!=null&&v(t,["parameters","outputOptions","mimeType"],d);const m=p(e,["outputCompressionQuality"]);t!==void 0&&m!=null&&v(t,["parameters","outputOptions","compressionQuality"],m);const x=p(e,["enhancePrompt"]);t!==void 0&&x!=null&&v(t,["parameters","enhancePrompt"],x);const y=p(e,["labels"]);return t!==void 0&&y!=null&&v(t,["labels"],y),r}function UR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["source"]);A!=null&&NR(A,r);const s=p(t,["config"]);return s!=null&&FR(s,r),r}function kR(e){const t={},r=p(e,["predictions"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(A=>wd(A))),v(t,["generatedImages"],n)}return t}function NR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const A=p(e,["personImage"]);t!==void 0&&A!=null&&v(t,["instances[0]","personImage","image"],sa(A));const s=p(e,["productImages"]);if(t!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>bR(o))),v(t,["instances[0]","productImages"],l)}return r}function IR(e){const t={},r=p(e,["referenceImage"]);r!=null&&v(t,["referenceImage"],sa(r));const n=p(e,["referenceId"]);n!=null&&v(t,["referenceId"],n);const A=p(e,["referenceType"]);A!=null&&v(t,["referenceType"],A);const s=p(e,["maskImageConfig"]);s!=null&&v(t,["maskImageConfig"],SR(s));const l=p(e,["controlImageConfig"]);l!=null&&v(t,["controlImageConfig"],v3(l));const o=p(e,["styleImageConfig"]);o!=null&&v(t,["styleImageConfig"],o);const u=p(e,["subjectImageConfig"]);return u!=null&&v(t,["subjectImageConfig"],u),t}function kT(e){const t={},r=p(e,["safetyAttributes","categories"]);r!=null&&v(t,["categories"],r);const n=p(e,["safetyAttributes","scores"]);n!=null&&v(t,["scores"],n);const A=p(e,["contentType"]);return A!=null&&v(t,["contentType"],A),t}function NT(e){const t={},r=p(e,["safetyAttributes","categories"]);r!=null&&v(t,["categories"],r);const n=p(e,["safetyAttributes","scores"]);n!=null&&v(t,["scores"],n);const A=p(e,["contentType"]);return A!=null&&v(t,["contentType"],A),t}function QR(e){const t={},r=p(e,["category"]);if(r!=null&&v(t,["category"],r),p(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=p(e,["threshold"]);return n!=null&&v(t,["threshold"],n),t}function RR(e){const t={},r=p(e,["image"]);return r!=null&&v(t,["image"],sa(r)),t}function DR(e,t){const r={},n=p(e,["mode"]);t!==void 0&&n!=null&&v(t,["parameters","mode"],n);const A=p(e,["maxPredictions"]);t!==void 0&&A!=null&&v(t,["parameters","maxPredictions"],A);const s=p(e,["confidenceThreshold"]);t!==void 0&&s!=null&&v(t,["parameters","confidenceThreshold"],s);const l=p(e,["maskDilation"]);t!==void 0&&l!=null&&v(t,["parameters","maskDilation"],l);const o=p(e,["binaryColorThreshold"]);t!==void 0&&o!=null&&v(t,["parameters","binaryColorThreshold"],o);const u=p(e,["labels"]);return t!==void 0&&u!=null&&v(t,["labels"],u),r}function MR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["source"]);A!=null&&HR(A,r);const s=p(t,["config"]);return s!=null&&DR(s,r),r}function LR(e){const t={},r=p(e,["predictions"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(A=>oR(A))),v(t,["generatedMasks"],n)}return t}function HR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const A=p(e,["image"]);t!==void 0&&A!=null&&v(t,["instances[0]","image"],sa(A));const s=p(e,["scribbleImage"]);return t!==void 0&&s!=null&&v(t,["instances[0]","scribble"],RR(s)),r}function OR(e){const t={},r=p(e,["functionCallingConfig"]);r!=null&&v(t,["functionCallingConfig"],G3(r));const n=p(e,["retrievalConfig"]);return n!=null&&v(t,["retrievalConfig"],n),t}function PR(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["googleSearchRetrieval"]);n!=null&&v(t,["googleSearchRetrieval"],n);const A=p(e,["computerUse"]);A!=null&&v(t,["computerUse"],A);const s=p(e,["fileSearch"]);s!=null&&v(t,["fileSearch"],s);const l=p(e,["codeExecution"]);if(l!=null&&v(t,["codeExecution"],l),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],gR(o));const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],mR(u));const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}function IT(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(x=>V3(x))),v(t,["functionDeclarations"],m)}const n=p(e,["retrieval"]);n!=null&&v(t,["retrieval"],n);const A=p(e,["googleSearchRetrieval"]);A!=null&&v(t,["googleSearchRetrieval"],A);const s=p(e,["computerUse"]);if(s!=null&&v(t,["computerUse"],s),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=p(e,["codeExecution"]);l!=null&&v(t,["codeExecution"],l);const o=p(e,["enterpriseWebSearch"]);o!=null&&v(t,["enterpriseWebSearch"],o);const u=p(e,["googleMaps"]);u!=null&&v(t,["googleMaps"],u);const f=p(e,["googleSearch"]);f!=null&&v(t,["googleSearch"],f);const d=p(e,["urlContext"]);return d!=null&&v(t,["urlContext"],d),t}function GR(e){const t={},r=p(e,["baseModel"]);r!=null&&v(t,["baseModel"],r);const n=p(e,["createTime"]);n!=null&&v(t,["createTime"],n);const A=p(e,["updateTime"]);return A!=null&&v(t,["updateTime"],A),t}function VR(e){const t={},r=p(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&v(t,["baseModel"],r);const n=p(e,["createTime"]);n!=null&&v(t,["createTime"],n);const A=p(e,["updateTime"]);return A!=null&&v(t,["updateTime"],A),t}function KR(e,t){const r={},n=p(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const A=p(e,["description"]);t!==void 0&&A!=null&&v(t,["description"],A);const s=p(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&v(t,["defaultCheckpointId"],s),r}function jR(e,t){const r={},n=p(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const A=p(e,["description"]);t!==void 0&&A!=null&&v(t,["description"],A);const s=p(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&v(t,["defaultCheckpointId"],s),r}function zR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","name"],$t(e,n));const A=p(t,["config"]);return A!=null&&KR(A,r),r}function XR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["config"]);return A!=null&&jR(A,r),r}function JR(e,t){const r={},n=p(e,["outputGcsUri"]);t!==void 0&&n!=null&&v(t,["parameters","storageUri"],n);const A=p(e,["safetyFilterLevel"]);t!==void 0&&A!=null&&v(t,["parameters","safetySetting"],A);const s=p(e,["personGeneration"]);t!==void 0&&s!=null&&v(t,["parameters","personGeneration"],s);const l=p(e,["includeRaiReason"]);t!==void 0&&l!=null&&v(t,["parameters","includeRaiReason"],l);const o=p(e,["outputMimeType"]);t!==void 0&&o!=null&&v(t,["parameters","outputOptions","mimeType"],o);const u=p(e,["outputCompressionQuality"]);t!==void 0&&u!=null&&v(t,["parameters","outputOptions","compressionQuality"],u);const f=p(e,["enhanceInputImage"]);t!==void 0&&f!=null&&v(t,["parameters","upscaleConfig","enhanceInputImage"],f);const d=p(e,["imagePreservationFactor"]);t!==void 0&&d!=null&&v(t,["parameters","upscaleConfig","imagePreservationFactor"],d);const m=p(e,["labels"]);t!==void 0&&m!=null&&v(t,["labels"],m);const x=p(e,["numberOfImages"]);t!==void 0&&x!=null&&v(t,["parameters","sampleCount"],x);const y=p(e,["mode"]);return t!==void 0&&y!=null&&v(t,["parameters","mode"],y),r}function YR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],$t(e,n));const A=p(t,["image"]);A!=null&&v(r,["instances[0]","image"],sa(A));const s=p(t,["upscaleFactor"]);s!=null&&v(r,["parameters","upscaleConfig","upscaleFactor"],s);const l=p(t,["config"]);return l!=null&&JR(l,r),r}function WR(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let A=n;Array.isArray(A)&&(A=A.map(s=>wd(s))),v(t,["generatedImages"],A)}return t}function qR(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["uri"],r);const n=p(e,["encodedVideo"]);n!=null&&v(t,["videoBytes"],Zs(n));const A=p(e,["encoding"]);return A!=null&&v(t,["mimeType"],A),t}function $R(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["uri"],r);const n=p(e,["bytesBase64Encoded"]);n!=null&&v(t,["videoBytes"],Zs(n));const A=p(e,["mimeType"]);return A!=null&&v(t,["mimeType"],A),t}function ZR(e){const t={},r=p(e,["image"]);r!=null&&v(t,["_self"],sa(r));const n=p(e,["maskMode"]);return n!=null&&v(t,["maskMode"],n),t}function eD(e){const t={},r=p(e,["image"]);r!=null&&v(t,["image"],yd(r));const n=p(e,["referenceType"]);return n!=null&&v(t,["referenceType"],n),t}function tD(e){const t={},r=p(e,["image"]);r!=null&&v(t,["image"],sa(r));const n=p(e,["referenceType"]);return n!=null&&v(t,["referenceType"],n),t}function QT(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["uri"],r);const n=p(e,["videoBytes"]);n!=null&&v(t,["encodedVideo"],Zs(n));const A=p(e,["mimeType"]);return A!=null&&v(t,["encoding"],A),t}function RT(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["gcsUri"],r);const n=p(e,["videoBytes"]);n!=null&&v(t,["bytesBase64Encoded"],Zs(n));const A=p(e,["mimeType"]);return A!=null&&v(t,["mimeType"],A),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rD(e,t){const r={},n=p(e,["displayName"]);return t!==void 0&&n!=null&&v(t,["displayName"],n),r}function nD(e){const t={},r=p(e,["config"]);return r!=null&&rD(r,t),t}function AD(e,t){const r={},n=p(e,["force"]);return t!==void 0&&n!=null&&v(t,["_query","force"],n),r}function aD(e){const t={},r=p(e,["name"]);r!=null&&v(t,["_url","name"],r);const n=p(e,["config"]);return n!=null&&AD(n,t),t}function sD(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","name"],r),t}function iD(e,t){const r={},n=p(e,["customMetadata"]);if(t!==void 0&&n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["customMetadata"],s)}const A=p(e,["chunkingConfig"]);return t!==void 0&&A!=null&&v(t,["chunkingConfig"],A),r}function lD(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const A=p(e,["done"]);A!=null&&v(t,["done"],A);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],cD(l)),t}function oD(e){const t={},r=p(e,["fileSearchStoreName"]);r!=null&&v(t,["_url","file_search_store_name"],r);const n=p(e,["fileName"]);n!=null&&v(t,["fileName"],n);const A=p(e,["config"]);return A!=null&&iD(A,t),t}function cD(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["parent"]);n!=null&&v(t,["parent"],n);const A=p(e,["documentName"]);return A!=null&&v(t,["documentName"],A),t}function uD(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);return t!==void 0&&A!=null&&v(t,["_query","pageToken"],A),r}function fD(e){const t={},r=p(e,["config"]);return r!=null&&uD(r,t),t}function dD(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["fileSearchStores"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["fileSearchStores"],s)}return t}function DT(e,t){const r={},n=p(e,["mimeType"]);t!==void 0&&n!=null&&v(t,["mimeType"],n);const A=p(e,["displayName"]);t!==void 0&&A!=null&&v(t,["displayName"],A);const s=p(e,["customMetadata"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>u)),v(t,["customMetadata"],o)}const l=p(e,["chunkingConfig"]);return t!==void 0&&l!=null&&v(t,["chunkingConfig"],l),r}function hD(e){const t={},r=p(e,["fileSearchStoreName"]);r!=null&&v(t,["_url","file_search_store_name"],r);const n=p(e,["config"]);return n!=null&&DT(n,t),t}function gD(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mD="Content-Type",pD="X-Server-Timeout",xD="User-Agent",tp="x-goog-api-client",vD="1.34.0",wD=`google-genai-sdk/${vD}`,yD="v1beta1",BD="v1beta";class CD{constructor(t){var r,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const A={};this.clientOptions.vertexai?(A.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:yD,A.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(A.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:BD,A.baseUrl="https://generativelanguage.googleapis.com/"),A.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=A,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(A,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),r=new URL(t);return r.protocol=r.protocol=="http:"?"ws":"wss",r.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,r,n){const A=[this.getRequestUrlInternal(r)];return n&&A.push(this.getBaseResourcePath()),t!==""&&A.push(t),new URL(`${A.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),A=this.constructUrl(t.path,r,n);if(t.queryParams)for(const[l,o]of Object.entries(t.queryParams))A.searchParams.append(l,String(o));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,r,A.toString(),t.abortSignal),this.unaryApiCall(A,s,t.httpMethod)}patchHttpOptions(t,r){const n=JSON.parse(JSON.stringify(t));for(const[A,s]of Object.entries(r))typeof s=="object"?n[A]=Object.assign(Object.assign({},n[A]),s):s!==void 0&&(n[A]=s);return n}async requestStream(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),A=this.constructUrl(t.path,r,n);(!A.searchParams.has("alt")||A.searchParams.get("alt")!=="sse")&&A.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,r,A.toString(),t.abortSignal),this.streamApiCall(A,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,r,n,A){if(r&&r.timeout||A){const s=new AbortController,l=s.signal;if(r.timeout&&(r==null?void 0:r.timeout)>0){const o=setTimeout(()=>s.abort(),r.timeout);o&&typeof o.unref=="function"&&o.unref()}A&&A.addEventListener("abort",()=>{s.abort()}),t.signal=l}return r&&r.extraBody!==null&&ED(t,r.extraBody),t.headers=await this.getHeadersInternal(r,n),t}async unaryApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async A=>(await xC(A),new Wm(A))).catch(A=>{throw A instanceof Error?A:new Error(JSON.stringify(A))})}async streamApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async A=>(await xC(A),this.processStreamResponse(A))).catch(A=>{throw A instanceof Error?A:new Error(JSON.stringify(A))})}processStreamResponse(t){return ra(this,arguments,function*(){var n;const A=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!A)throw new Error("Response body is empty");try{let l="";const o="data:",u=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:d}=yield wt(A.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=s.decode(d,{stream:!0});try{const C=JSON.parse(m);if("error"in C){const E=JSON.parse(JSON.stringify(C.error)),T=E.status,_=E.code,F=`got status: ${T}. ${JSON.stringify(C)}`;if(_>=400&&_<600)throw new xd({message:F,status:_})}}catch(C){if(C.name==="ApiError")throw C}l+=m;let x=-1,y=0;for(;;){x=-1,y=0;for(const T of u){const _=l.indexOf(T);_!==-1&&(x===-1||_<x)&&(x=_,y=T.length)}if(x===-1)break;const C=l.substring(0,x);l=l.substring(x+y);const E=C.trim();if(E.startsWith(o)){const T=E.substring(o.length).trim();try{const _=new Response(T,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield wt(new Wm(_))}catch(_){throw new Error(`exception parsing stream chunk ${T}. ${_}`)}}}}}finally{A.releaseLock()}})}async apiCall(t,r){return fetch(t,r).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},r=wD+" "+this.clientOptions.userAgentExtra;return t[xD]=r,t[tp]=r,t[mD]="application/json",t}async getHeadersInternal(t,r){const n=new Headers;if(t&&t.headers){for(const[A,s]of Object.entries(t.headers))n.append(A,s);t.timeout&&t.timeout>0&&n.append(pD,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,r),n}getFileName(t){var r;let n="";return typeof t=="string"&&(n=t.replace(/[/\\]+$/,""),n=(r=n.split(/[/\\]/).pop())!==null&&r!==void 0?r:""),n}async uploadFile(t,r){var n;const A={};r!=null&&(A.mimeType=r.mimeType,A.name=r.name,A.displayName=r.displayName),A.name&&!A.name.startsWith("files/")&&(A.name=`files/${A.name}`);const s=this.clientOptions.uploader,l=await s.stat(t);A.sizeBytes=String(l.size);const o=(n=r==null?void 0:r.mimeType)!==null&&n!==void 0?n:l.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");A.mimeType=o;const u={file:A},f=this.getFileName(t),d=Ye("upload/v1beta/files",u._url),m=await this.fetchUploadUrl(d,A.sizeBytes,A.mimeType,f,u,r==null?void 0:r.httpOptions);return s.upload(t,m,this)}async uploadFileToFileSearchStore(t,r,n){var A;const s=this.clientOptions.uploader,l=await s.stat(r),o=String(l.size),u=(A=n==null?void 0:n.mimeType)!==null&&A!==void 0?A:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${t}:uploadToFileSearchStore`,d=this.getFileName(r),m={};n!=null&&DT(n,m);const x=await this.fetchUploadUrl(f,o,u,d,m,n==null?void 0:n.httpOptions);return s.uploadToFileSearchStore(r,x,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,r,n,A,s,l){var o;let u={};l?u=l:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r}`,"X-Goog-Upload-Header-Content-Type":`${n}`},A?{"X-Goog-Upload-File-Name":A}:{})};const f=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:u});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(o=f==null?void 0:f.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function xC(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const r=e.status;let n;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?n=await e.json():n={error:{message:await e.text(),code:e.status,status:e.statusText}};const A=JSON.stringify(n);throw r>=400&&r<600?new xd({message:A,status:r}):new Error(A)}}function ED(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let r={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))r=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(s,l){const o=Object.assign({},s);for(const u in l)if(Object.prototype.hasOwnProperty.call(l,u)){const f=l[u],d=o[u];f&&typeof f=="object"&&!Array.isArray(f)&&d&&typeof d=="object"&&!Array.isArray(d)?o[u]=n(d,f):(d&&f&&typeof d!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof d}, New type: ${typeof f}. Overwriting.`),o[u]=f)}return o}const A=n(r,t);e.body=JSON.stringify(A)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TD="mcp_used/unknown";let SD=!1;function MT(e){for(const t of e)if(_D(t)||typeof t=="object"&&"inputSchema"in t)return!0;return SD}function LT(e){var t;const r=(t=e[tp])!==null&&t!==void 0?t:"";e[tp]=(r+` ${TD}`).trimStart()}function _D(e){return e!==null&&typeof e=="object"&&e instanceof lx}function bD(e){return ra(this,arguments,function*(r,n=100){let A,s=0;for(;s<n;){const l=yield wt(r.listTools({cursor:A}));for(const o of l.tools)yield yield wt(o),s++;if(!l.nextCursor)break;A=l.nextCursor}})}class lx{constructor(t=[],r){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=r}static create(t,r){return new lx(t,r)}async initialize(){var t,r,n,A;if(this.mcpTools.length>0)return;const s={},l=[];for(const d of this.mcpClients)try{for(var o=!0,u=(r=void 0,na(bD(d))),f;f=await u.next(),t=f.done,!t;o=!0){A=f.value,o=!1;const m=A;l.push(m);const x=m.name;if(s[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);s[x]=d}}catch(m){r={error:m}}finally{try{!o&&!t&&(n=u.return)&&await n.call(u)}finally{if(r)throw r.error}}this.mcpTools=l,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),sI(this.mcpTools,this.config)}async callTool(t){await this.initialize();const r=[];for(const n of t)if(n.name in this.functionNameToMcpClient){const A=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const l=await A.callTool({name:n.name,arguments:n.args},void 0,s);r.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function FD(e,t,r){const n=new $N;let A;r.data instanceof Blob?A=JSON.parse(await r.data.text()):A=JSON.parse(r.data),Object.assign(n,A),t(n)}class UD{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n}async connect(t){var r,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const A=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=ID(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),u=`${A}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${o}`;let f=()=>{};const d=new Promise(S=>{f=S}),m=t.callbacks,x=function(){f({})},y=this.apiClient,C={onopen:x,onmessage:S=>{FD(y,m.onmessage,S)},onerror:(r=m==null?void 0:m.onerror)!==null&&r!==void 0?r:function(S){},onclose:(n=m==null?void 0:m.onclose)!==null&&n!==void 0?n:function(S){}},E=this.webSocketFactory.create(u,ND(l),C);E.connect(),await d;const F={setup:{model:$t(this.apiClient,t.model)}};return E.send(JSON.stringify(F)),new kD(E,this.apiClient)}}class kD{constructor(t,r){this.conn=t,this.apiClient=r}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const r=n3(t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const r=r3(t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const r={playbackControl:t};this.conn.send(JSON.stringify(r))}play(){this.sendPlaybackControl(Wl.PLAY)}pause(){this.sendPlaybackControl(Wl.PAUSE)}stop(){this.sendPlaybackControl(Wl.STOP)}resetContext(){this.sendPlaybackControl(Wl.RESET_CONTEXT)}close(){this.conn.close()}}function ND(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function ID(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const QD="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function RD(e,t,r){const n=new qN;let A;r.data instanceof Blob?A=await r.data.text():r.data instanceof ArrayBuffer?A=new TextDecoder().decode(r.data):A=r.data;const s=JSON.parse(A);if(e.isVertexAI()){const l=s3(s);Object.assign(n,l)}else Object.assign(n,s);t(n)}class DD{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n,this.music=new UD(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var r,n,A,s,l,o;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let d;const m=this.apiClient.getHeaders();t.config&&t.config.tools&&MT(t.config.tools)&&LT(m);const x=OD(m);if(this.apiClient.isVertexAI())d=`${u}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x,d);else{const R=this.apiClient.getApiKey();let te="BidiGenerateContent",ne="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),te="BidiGenerateContentConstrained",ne="access_token"),d=`${u}/ws/google.ai.generativelanguage.${f}.GenerativeService.${te}?${ne}=${R}`}let y=()=>{};const C=new Promise(R=>{y=R}),E=t.callbacks,T=function(){var R;(R=E==null?void 0:E.onopen)===null||R===void 0||R.call(E),y({})},_=this.apiClient,F={onopen:T,onmessage:R=>{RD(_,E.onmessage,R)},onerror:(r=E==null?void 0:E.onerror)!==null&&r!==void 0?r:function(R){},onclose:(n=E==null?void 0:E.onclose)!==null&&n!==void 0?n:function(R){}},S=this.webSocketFactory.create(d,HD(x),F);S.connect(),await C;let I=$t(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const R=this.apiClient.getProject(),te=this.apiClient.getLocation();I=`projects/${R}/locations/${te}/`+I}let M={};this.apiClient.isVertexAI()&&((A=t.config)===null||A===void 0?void 0:A.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Of.AUDIO]}:t.config.responseModalities=[Of.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const Q=(o=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&o!==void 0?o:[],U=[];for(const R of Q)if(this.isCallableTool(R)){const te=R;U.push(await te.tool())}else U.push(R);U.length>0&&(t.config.tools=U);const G={model:I,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?M=t3(this.apiClient,G):M=e3(this.apiClient,G),delete M.config,S.send(JSON.stringify(M)),new LD(S,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const MD={turnComplete:!0};class LD{constructor(t,r){this.conn=t,this.apiClient=r}tLiveClientContent(t,r){if(r.turns!==null&&r.turns!==void 0){let n=[];try{n=VA(r.turns),t.isVertexAI()||(n=n.map(A=>vd(A)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof r.turns}'`)}return{clientContent:{turns:n,turnComplete:r.turnComplete}}}return{clientContent:{turnComplete:r.turnComplete}}}tLiveClienttToolResponse(t,r){let n=[];if(r.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(r.functionResponses)?n=r.functionResponses:n=[r.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(QD)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},MD),t);const r=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendRealtimeInput(t){let r={};this.apiClient.isVertexAI()?r={realtimeInput:a3(t)}:r={realtimeInput:A3(t)},this.conn.send(JSON.stringify(r))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const r=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(r))}close(){this.conn.close()}}function HD(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function OD(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vC=10;function wC(e){var t,r,n;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let A=!1;for(const l of(r=e==null?void 0:e.tools)!==null&&r!==void 0?r:[])if(to(l)){A=!0;break}if(!A)return!0;const s=(n=e==null?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function to(e){return"callTool"in e&&typeof e.callTool=="function"}function PD(e){var t,r,n;return(n=(r=(t=e.config)===null||t===void 0?void 0:t.tools)===null||r===void 0?void 0:r.some(A=>to(A)))!==null&&n!==void 0?n:!1}function yC(e){var t;const r=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((n,A)=>{if(to(n))return;const s=n;s.functionDeclarations&&s.functionDeclarations.length>0&&r.push(A)}),r}function BC(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GD extends As{constructor(t){super(),this.apiClient=t,this.generateContent=async r=>{var n,A,s,l,o;const u=await this.processParamsMaybeAddMcpUsage(r);if(this.maybeMoveToResponseJsonSchem(r),!PD(r)||wC(r.config))return await this.generateContentInternal(u);const f=yC(r);if(f.length>0){const E=f.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let d,m;const x=VA(u.contents),y=(s=(A=(n=u.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||A===void 0?void 0:A.maximumRemoteCalls)!==null&&s!==void 0?s:vC;let C=0;for(;C<y&&(d=await this.generateContentInternal(u),!(!d.functionCalls||d.functionCalls.length===0));){const E=d.candidates[0].content,T=[];for(const _ of(o=(l=r.config)===null||l===void 0?void 0:l.tools)!==null&&o!==void 0?o:[])if(to(_)){const S=await _.callTool(d.functionCalls);T.push(...S)}C++,m={role:"user",parts:T},u.contents=VA(u.contents),u.contents.push(E),u.contents.push(m),BC(u.config)&&(x.push(E),x.push(m))}return BC(u.config)&&(d.automaticFunctionCallingHistory=x),d},this.generateContentStream=async r=>{var n,A,s,l,o;if(this.maybeMoveToResponseJsonSchem(r),wC(r.config)){const m=await this.processParamsMaybeAddMcpUsage(r);return await this.generateContentStreamInternal(m)}const u=yC(r);if(u.length>0){const m=u.map(x=>`tools[${x}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(s=(A=(n=r==null?void 0:r.config)===null||n===void 0?void 0:n.toolConfig)===null||A===void 0?void 0:A.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,d=(o=(l=r==null?void 0:r.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||o===void 0?void 0:o.disable;if(f&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(r)},this.generateImages=async r=>await this.generateImagesInternal(r).then(n=>{var A;let s;const l=[];if(n!=null&&n.generatedImages)for(const u of n.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((A=u==null?void 0:u.safetyAttributes)===null||A===void 0?void 0:A.contentType)==="Positive Prompt"?s=u==null?void 0:u.safetyAttributes:l.push(u);let o;return s?o={generatedImages:l,positivePromptSafetyAttributes:s,sdkHttpResponse:n.sdkHttpResponse}:o={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},o}),this.list=async r=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),r==null?void 0:r.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ji(es.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(l),l)},this.editImage=async r=>{const n={model:r.model,prompt:r.prompt,referenceImages:[],config:r.config};return r.referenceImages&&r.referenceImages&&(n.referenceImages=r.referenceImages.map(A=>A.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async r=>{let n={numberOfImages:1,mode:"upscale"};r.config&&(n=Object.assign(Object.assign({},n),r.config));const A={model:r.model,image:r.image,upscaleFactor:r.upscaleFactor,config:n};return await this.upscaleImageInternal(A)},this.generateVideos=async r=>{var n,A,s,l,o,u;if((r.prompt||r.image||r.video)&&r.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=r.video)===null||n===void 0)&&n.uri&&(!((A=r.video)===null||A===void 0)&&A.videoBytes)?r.video={uri:r.video.uri,mimeType:r.video.mimeType}:!((l=(s=r.source)===null||s===void 0?void 0:s.video)===null||l===void 0)&&l.uri&&(!((u=(o=r.source)===null||o===void 0?void 0:o.video)===null||u===void 0)&&u.videoBytes)&&(r.source.video={uri:r.source.video.uri,mimeType:r.source.video.mimeType})),await this.generateVideosInternal(r)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var r,n,A;const s=(r=t.config)===null||r===void 0?void 0:r.tools;if(!s)return t;const l=await Promise.all(s.map(async u=>to(u)?await u.tool():u)),o={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:l})};if(o.config.tools=l,t.config&&t.config.tools&&MT(t.config.tools)){const u=(A=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&A!==void 0?A:{};let f=Object.assign({},u);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),LT(f),o.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:f})}return o}async initAfcToolsMap(t){var r,n,A;const s=new Map;for(const l of(n=(r=t.config)===null||r===void 0?void 0:r.tools)!==null&&n!==void 0?n:[])if(to(l)){const o=l,u=await o.tool();for(const f of(A=u.functionDeclarations)!==null&&A!==void 0?A:[]){if(!f.name)throw new Error("Function declaration name is required.");if(s.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);s.set(f.name,o)}}return s}async processAfcStream(t){var r,n,A;const s=(A=(n=(r=t.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&A!==void 0?A:vC;let l=!1,o=0;const u=await this.initAfcToolsMap(t);return(function(f,d,m){return ra(this,arguments,function*(){for(var x,y,C,E,T,_;o<s;){l&&(o++,l=!1);const M=yield wt(f.processParamsMaybeAddMcpUsage(m)),Q=yield wt(f.generateContentStreamInternal(M)),U=[],G=[];try{for(var F=!0,S=(y=void 0,na(Q)),I;I=yield wt(S.next()),x=I.done,!x;F=!0){E=I.value,F=!1;const R=E;if(yield yield wt(R),R.candidates&&(!((T=R.candidates[0])===null||T===void 0)&&T.content)){G.push(R.candidates[0].content);for(const te of(_=R.candidates[0].content.parts)!==null&&_!==void 0?_:[])if(o<s&&te.functionCall){if(!te.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(te.functionCall.name)){const ne=yield wt(d.get(te.functionCall.name).callTool([te.functionCall]));U.push(...ne)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${te.functionCall.name}`)}}}}catch(R){y={error:R}}finally{try{!F&&!x&&(C=S.return)&&(yield wt(C.call(S)))}finally{if(y)throw y.error}}if(U.length>0){l=!0;const R=new gc;R.candidates=[{content:{role:"user",parts:U}}],yield yield wt(R);const te=[];te.push(...G),te.push({role:"user",parts:U});const ne=VA(m.contents).concat(te);m.contents=ne}else break}})})(this,u,t)}async generateContentInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=gC(this.apiClient,t);return o=Ye("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=pC(d),x=new gc;return Object.assign(x,m),x})}else{const f=hC(this.apiClient,t);return o=Ye("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=mC(d),x=new gc;return Object.assign(x,m),x})}}async generateContentStreamInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=gC(this.apiClient,t);return o=Ye("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(m){return ra(this,arguments,function*(){var x,y,C,E;try{for(var T=!0,_=na(m),F;F=yield wt(_.next()),x=F.done,!x;T=!0){E=F.value,T=!1;const S=E,I=pC(yield wt(S.json()));I.sdkHttpResponse={headers:S.headers};const M=new gc;Object.assign(M,I),yield yield wt(M)}}catch(S){y={error:S}}finally{try{!T&&!x&&(C=_.return)&&(yield wt(C.call(_)))}finally{if(y)throw y.error}}})})}else{const f=hC(this.apiClient,t);return o=Ye("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(m){return ra(this,arguments,function*(){var x,y,C,E;try{for(var T=!0,_=na(m),F;F=yield wt(_.next()),x=F.done,!x;T=!0){E=F.value,T=!1;const S=E,I=mC(yield wt(S.json()));I.sdkHttpResponse={headers:S.headers};const M=new gc;Object.assign(M,I),yield yield wt(M)}}catch(S){y={error:S}}finally{try{!T&&!x&&(C=_.return)&&(yield wt(C.call(_)))}finally{if(y)throw y.error}}})})}}async embedContent(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=D3(this.apiClient,t);return o=Ye("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=L3(d),x=new qB;return Object.assign(x,m),x})}else{const f=R3(this.apiClient,t);return o=Ye("{model}:batchEmbedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=M3(d),x=new qB;return Object.assign(x,m),x})}}async generateImagesInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=Y3(this.apiClient,t);return o=Ye("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=q3(d),x=new $B;return Object.assign(x,m),x})}else{const f=J3(this.apiClient,t);return o=Ye("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=W3(d),x=new $B;return Object.assign(x,m),x})}}async editImageInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=k3(this.apiClient,t);return s=Ye("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>{const f=N3(u),d=new ON;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=YR(this.apiClient,t);return s=Ye("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>{const f=WR(u),d=new PN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=UR(this.apiClient,t);return s=Ye("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=kR(u),d=new GN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=MR(this.apiClient,t);return s=Ye("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=LR(u),d=new VN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=hR(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>ep(d))}else{const f=dR(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>Zm(d))}}async listInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=CR(this.apiClient,t);return o=Ye("{models_url}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=TR(d),x=new ZB;return Object.assign(x,m),x})}else{const f=BR(this.apiClient,t);return o=Ye("{models_url}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=ER(d),x=new ZB;return Object.assign(x,m),x})}}async update(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=XR(this.apiClient,t);return o=Ye("{model}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>ep(d))}else{const f=zR(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>Zm(d))}}async delete(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=_3(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=F3(d),x=new eC;return Object.assign(x,m),x})}else{const f=S3(this.apiClient,t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=b3(d),x=new eC;return Object.assign(x,m),x})}}async countTokens(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=C3(this.apiClient,t);return o=Ye("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=T3(d),x=new tC;return Object.assign(x,m),x})}else{const f=B3(this.apiClient,t);return o=Ye("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=E3(d),x=new tC;return Object.assign(x,m),x})}}async computeTokens(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=g3(this.apiClient,t);return s=Ye("{model}:computeTokens",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>{const f=m3(u),d=new KN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=nR(this.apiClient,t);return o=Ye("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>{const m=tR(d),x=new Pf;return Object.assign(x,m),x})}else{const f=rR(this.apiClient,t);return o=Ye("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>{const m=eR(d),x=new Pf;return Object.assign(x,m),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VD extends As{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const A=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:A,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const A=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:A,_isVertexAI:!1})}}async get(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const A=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:A,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const A=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:A,_isVertexAI:!1})}}async getVideosOperationInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=QN(t);return o=Ye("{operationName}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l}else{const f=IN(t);return o=Ye("{operationName}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l}}async fetchPredictVideosOperationInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=SN(t);return s=Ye("{resourceName}:fetchPredictOperation",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KD(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function jD(e){const t={},r=p(e,["parts"]);if(r!=null){let A=r;Array.isArray(A)&&(A=A.map(s=>eM(s))),v(t,["parts"],A)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function zD(e,t,r){const n={},A=p(t,["expireTime"]);r!==void 0&&A!=null&&v(r,["expireTime"],A);const s=p(t,["newSessionExpireTime"]);r!==void 0&&s!=null&&v(r,["newSessionExpireTime"],s);const l=p(t,["uses"]);r!==void 0&&l!=null&&v(r,["uses"],l);const o=p(t,["liveConnectConstraints"]);r!==void 0&&o!=null&&v(r,["bidiGenerateContentSetup"],ZD(e,o));const u=p(t,["lockAdditionalFields"]);return r!==void 0&&u!=null&&v(r,["fieldMask"],u),n}function XD(e,t){const r={},n=p(t,["config"]);return n!=null&&v(r,["config"],zD(e,n,r)),r}function JD(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function YD(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const A=p(e,["name"]);if(A!=null&&v(t,["name"],A),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function WD(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function qD(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function $D(e,t){const r={},n=p(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],n);const A=p(e,["responseModalities"]);t!==void 0&&A!=null&&v(t,["setup","generationConfig","responseModalities"],A);const s=p(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const l=p(e,["topP"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topP"],l);const o=p(e,["topK"]);t!==void 0&&o!=null&&v(t,["setup","generationConfig","topK"],o);const u=p(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=p(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const m=p(e,["speechConfig"]);t!==void 0&&m!=null&&v(t,["setup","generationConfig","speechConfig"],ix(m));const x=p(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=p(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const C=p(e,["systemInstruction"]);t!==void 0&&C!=null&&v(t,["setup","systemInstruction"],jD(Mn(C)));const E=p(e,["tools"]);if(t!==void 0&&E!=null){let Q=go(E);Array.isArray(Q)&&(Q=Q.map(U=>rM(ho(U)))),v(t,["setup","tools"],Q)}const T=p(e,["sessionResumption"]);t!==void 0&&T!=null&&v(t,["setup","sessionResumption"],tM(T));const _=p(e,["inputAudioTranscription"]);t!==void 0&&_!=null&&v(t,["setup","inputAudioTranscription"],_);const F=p(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const S=p(e,["realtimeInputConfig"]);t!==void 0&&S!=null&&v(t,["setup","realtimeInputConfig"],S);const I=p(e,["contextWindowCompression"]);t!==void 0&&I!=null&&v(t,["setup","contextWindowCompression"],I);const M=p(e,["proactivity"]);if(t!==void 0&&M!=null&&v(t,["setup","proactivity"],M),p(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return r}function ZD(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["setup","model"],$t(e,n));const A=p(t,["config"]);return A!=null&&v(r,["config"],$D(A,r)),r}function eM(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const A=p(e,["executableCode"]);A!=null&&v(t,["executableCode"],A);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],JD(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],YD(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],KD(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function tM(e){const t={},r=p(e,["handle"]);if(r!=null&&v(t,["handle"],r),p(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function rM(e){const t={},r=p(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["googleSearchRetrieval"]);n!=null&&v(t,["googleSearchRetrieval"],n);const A=p(e,["computerUse"]);A!=null&&v(t,["computerUse"],A);const s=p(e,["fileSearch"]);s!=null&&v(t,["fileSearch"],s);const l=p(e,["codeExecution"]);if(l!=null&&v(t,["codeExecution"],l),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],WD(o));const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],qD(u));const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nM(e){const t=[];for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=e[r];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const A=Object.keys(n).map(s=>`${r}.${s}`);t.push(...A)}else t.push(r)}return t.join(",")}function AM(e,t){let r=null;const n=e.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const s=n.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,r=s):delete e.bidiGenerateContentSetup}else n!==void 0&&delete e.bidiGenerateContentSetup;const A=e.fieldMask;if(r){const s=nM(r);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&A!==null&&Array.isArray(A)&&A.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];A.length>0&&(o=A.map(f=>l.includes(f)?`generationConfig.${f}`:f));const u=[];s&&u.push(s),o.length>0&&u.push(...o),u.length>0?e.fieldMask=u.join(","):delete e.fieldMask}else delete e.fieldMask}else A!==null&&Array.isArray(A)&&A.length>0?e.fieldMask=A.join(","):delete e.fieldMask;return e}class aM extends As{constructor(t){super(),this.apiClient=t}async create(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=XD(this.apiClient,t);s=Ye("auth_tokens",o._url),l=o._query,delete o.config,delete o._url,delete o._query;const u=AM(o,t.config);return A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),A.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sM(e,t){const r={},n=p(e,["force"]);return t!==void 0&&n!=null&&v(t,["_query","force"],n),r}function iM(e){const t={},r=p(e,["name"]);r!=null&&v(t,["_url","name"],r);const n=p(e,["config"]);return n!=null&&sM(n,t),t}function lM(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","name"],r),t}function oM(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const A=p(e,["pageToken"]);return t!==void 0&&A!=null&&v(t,["_query","pageToken"],A),r}function cM(e){const t={},r=p(e,["parent"]);r!=null&&v(t,["_url","parent"],r);const n=p(e,["config"]);return n!=null&&oM(n,t),t}function uM(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const A=p(e,["documents"]);if(A!=null){let s=A;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fM extends As{constructor(t){super(),this.apiClient=t,this.list=async r=>new ji(es.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:r.parent,config:n.config}),await this.listInternal(r),r)}async get(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=lM(t);return s=Ye("{name}",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>u)}}async delete(t){var r,n;let A="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=iM(t);A=Ye("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:A,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=cM(t);return s=Ye("{parent}/documents",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=uM(u),d=new jN;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dM extends As{constructor(t,r=new fM(t)){super(),this.apiClient=t,this.documents=r,this.list=async(n={})=>new ji(es.PAGED_ITEM_FILE_SEARCH_STORES,A=>this.listInternal(A),await this.listInternal(n),n)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=nD(t);return s=Ye("fileSearchStores",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>u)}}async get(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=sD(t);return s=Ye("{name}",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>u)}}async delete(t){var r,n;let A="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=aD(t);A=Ye("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:A,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=fD(t);return s=Ye("fileSearchStores",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=dD(u),d=new zN;return Object.assign(d,f),d})}}async uploadToFileSearchStoreInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=hD(t);return s=Ye("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=gD(u),d=new XN;return Object.assign(d,f),d})}}async importFile(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=oD(t);return s=Ye("{file_search_store_name}:importFile",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),A.then(u=>{const f=lD(u),d=new rx;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let HT=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return HT=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),r=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^r()&15>>+n/4).toString(16))};const hM=()=>HT();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rp(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const np=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jA extends Error{}class Yn extends jA{constructor(t,r,n,A){super(`${Yn.makeMessage(t,r,n)}`),this.status=t,this.headers=A,this.error=r}static makeMessage(t,r,n){const A=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return t&&A?`${t} ${A}`:t?`${t} status code (no body)`:A||"(no status code or body)"}static generate(t,r,n,A){if(!t||!A)return new Bd({message:n,cause:np(r)});const s=r;return t===400?new PT(t,s,n,A):t===401?new GT(t,s,n,A):t===403?new VT(t,s,n,A):t===404?new KT(t,s,n,A):t===409?new jT(t,s,n,A):t===422?new zT(t,s,n,A):t===429?new XT(t,s,n,A):t>=500?new JT(t,s,n,A):new Yn(t,s,n,A)}}class Ap extends Yn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Bd extends Yn{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class OT extends Bd{constructor({message:t}={}){super({message:t??"Request timed out."})}}class PT extends Yn{}class GT extends Yn{}class VT extends Yn{}class KT extends Yn{}class jT extends Yn{}class zT extends Yn{}class XT extends Yn{}class JT extends Yn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gM=/^[a-z][a-z0-9+.-]*:/i,mM=e=>gM.test(e);let ap=e=>(ap=Array.isArray,ap(e));const pM=ap;let xM=pM;const CC=xM;function vM(e){if(!e)return!0;for(const t in e)return!1;return!0}function wM(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const yM=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new jA(`${e} must be an integer`);if(t<0)throw new jA(`${e} must be a positive integer`);return t},BM=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CM=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EM(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const TM=()=>{var e,t,r,n,A;const s=EM();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zl,"X-Stainless-OS":TC(Deno.build.os),"X-Stainless-Arch":EC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zl,"X-Stainless-OS":TC((r=globalThis.process.platform)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Arch":EC((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(A=globalThis.process.version)!==null&&A!==void 0?A:"unknown"};const l=SM();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function SM(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const n=r.exec(navigator.userAgent);if(n){const A=n[1]||0,s=n[2]||0,l=n[3]||0;return{browser:t,version:`${A}.${s}.${l}`}}}return null}const EC=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",TC=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let H0;const _M=()=>H0??(H0=TM());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bM(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function YT(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function FM(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return YT({start(){},async pull(r){const{done:n,value:A}=await t.next();n?r.close():r.enqueue(A)},async cancel(){var r;await((r=t.return)===null||r===void 0?void 0:r.call(t))}})}function WT(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function UM(e){var t,r;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((r=(t=e[Symbol.asyncIterator]()).return)===null||r===void 0?void 0:r.call(t));return}const n=e.getReader(),A=n.cancel();n.releaseLock(),await A}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kM=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qT=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,r=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(r?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function nm(e,t,r){return qT(),new File(e,t??"unknown_file",r)}function NM(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const IM=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $T=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",QM=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&$T(e),RM=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function DM(e,t,r){if(qT(),e=await e,QM(e))return e instanceof File?e:nm([await e.arrayBuffer()],e.name);if(RM(e)){const A=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),nm(await sp(A),t,r)}const n=await sp(e);if(t||(t=NM(e)),!(r!=null&&r.type)){const A=n.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof A=="string"&&(r=Object.assign(Object.assign({},r),{type:A}))}return nm(n,t,r)}async function sp(e){var t,r,n,A,s;let l=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)l.push(e);else if($T(e))l.push(e instanceof Blob?e:await e.arrayBuffer());else if(IM(e))try{for(var o=!0,u=na(e),f;f=await u.next(),t=f.done,!t;o=!0){A=f.value,o=!1;const d=A;l.push(...await sp(d))}}catch(d){r={error:d}}finally{try{!o&&!t&&(n=u.return)&&await n.call(u)}finally{if(r)throw r.error}}else{const d=(s=e==null?void 0:e.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof e}${d?`; constructor: ${d}`:""}${MM(e)}`)}return l}function MM(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(r=>`"${r}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZT{constructor(t){this._client=t}}ZT._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eS(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const SC=Object.freeze(Object.create(null)),LM=(e=eS)=>(function(r,...n){if(r.length===1)return r[0];let A=!1;const s=[],l=r.reduce((d,m,x)=>{var y,C,E;/[?#]/.test(m)&&(A=!0);const T=n[x];let _=(A?encodeURIComponent:e)(""+T);return x!==n.length&&(T==null||typeof T=="object"&&T.toString===((E=Object.getPrototypeOf((C=Object.getPrototypeOf((y=T.hasOwnProperty)!==null&&y!==void 0?y:SC))!==null&&C!==void 0?C:SC))===null||E===void 0?void 0:E.toString))&&(_=T+"",s.push({start:d.length+m.length,length:_.length,error:`Value of type ${Object.prototype.toString.call(T).slice(8,-1)} is not a valid path parameter`})),d+m+(x===n.length?"":_)},""),o=l.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=u.exec(o))!==null;)s.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(s.sort((d,m)=>d.start-m.start),s.length>0){let d=0;const m=s.reduce((x,y)=>{const C=" ".repeat(y.start-d),E="^".repeat(y.length);return d=y.start+y.length,x+C+E},"");throw new jA(`Path parameters result in path with invalid segments:
${s.map(x=>x.error).join(`
`)}
${l}
${m}`)}return l}),O0=LM(eS);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tS extends ZT{create(t,r){var n;const{api_version:A=this._client.apiVersion}=t,s=Vf(t,["api_version"]);if("model"in s&&"agent_config"in s)throw new jA("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new jA("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(O0`/${A}/interactions`,Object.assign(Object.assign({body:s},r),{stream:(n=t.stream)!==null&&n!==void 0?n:!1}))}delete(t,r={},n){const{api_version:A=this._client.apiVersion}=r??{};return this._client.delete(O0`/${A}/interactions/${t}`,n)}cancel(t,r={},n){const{api_version:A=this._client.apiVersion}=r??{};return this._client.post(O0`/${A}/interactions/${t}/cancel`,n)}get(t,r={},n){var A;const s=r??{},{api_version:l=this._client.apiVersion}=s,o=Vf(s,["api_version"]);return this._client.get(O0`/${l}/interactions/${t}`,Object.assign(Object.assign({query:o},n),{stream:(A=r==null?void 0:r.stream)!==null&&A!==void 0?A:!1}))}}tS._key=Object.freeze(["interactions"]);class rS extends tS{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HM(e){let t=0;for(const A of e)t+=A.length;const r=new Uint8Array(t);let n=0;for(const A of e)r.set(A,n),n+=A.length;return r}let P0;function ox(e){let t;return(P0??(t=new globalThis.TextEncoder,P0=t.encode.bind(t)))(e)}let G0;function _C(e){let t;return(G0??(t=new globalThis.TextDecoder,G0=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cd{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?ox(t):t;this.buffer=HM([this.buffer,r]);const n=[];let A;for(;(A=OM(this.buffer,this.carriageReturnIndex))!=null;){if(A.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=A.index;continue}if(this.carriageReturnIndex!=null&&(A.index!==this.carriageReturnIndex+1||A.carriage)){n.push(_C(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?A.preceding-1:A.preceding,l=_C(this.buffer.subarray(0,s));n.push(l),this.buffer=this.buffer.subarray(A.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}Cd.NEWLINE_CHARS=new Set([`
`,"\r"]);Cd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function OM(e,t){for(let A=t??0;A<e.length;A++){if(e[A]===10)return{preceding:A,index:A+1,carriage:!1};if(e[A]===13)return{preceding:A,index:A+1,carriage:!0}}return null}function PM(e){for(let n=0;n<e.length-1;n++){if(e[n]===10&&e[n+1]===10||e[n]===13&&e[n+1]===13)return n+2;if(e[n]===13&&e[n+1]===10&&n+3<e.length&&e[n+2]===13&&e[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Kf={off:0,error:200,warn:300,info:400,debug:500},bC=(e,t,r)=>{if(e){if(wM(Kf,e))return e;Kn(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(Kf))}`)}};function Ec(){}function V0(e,t,r){return!t||Kf[e]>Kf[r]?Ec:t[e].bind(t)}const GM={error:Ec,warn:Ec,info:Ec,debug:Ec};let FC=new WeakMap;function Kn(e){var t;const r=e.logger,n=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!r)return GM;const A=FC.get(r);if(A&&A[0]===n)return A[1];const s={error:V0("error",r,n),warn:V0("warn",r,n),info:V0("info",r,n),debug:V0("debug",r,n)};return FC.set(r,[n,s]),s}const _i=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,r])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":r]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ql{constructor(t,r,n){this.iterator=t,this.controller=r,this.client=n}static fromSSEResponse(t,r,n){let A=!1;const s=n?Kn(n):console;function l(){return ra(this,arguments,function*(){var u,f,d,m;if(A)throw new jA("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");A=!0;let x=!1;try{try{for(var y=!0,C=na(VM(t,r)),E;E=yield wt(C.next()),u=E.done,!u;y=!0){m=E.value,y=!1;const T=m;if(!x)if(T.data.startsWith("[DONE]")){x=!0;continue}else try{yield yield wt(JSON.parse(T.data))}catch(_){throw s.error("Could not parse message into JSON:",T.data),s.error("From chunk:",T.raw),_}}}catch(T){f={error:T}}finally{try{!y&&!u&&(d=C.return)&&(yield wt(d.call(C)))}finally{if(f)throw f.error}}x=!0}catch(T){if(rp(T))return yield wt(void 0);throw T}finally{x||r.abort()}})}return new ql(l,r,n)}static fromReadableStream(t,r,n){let A=!1;function s(){return ra(this,arguments,function*(){var u,f,d,m;const x=new Cd,y=WT(t);try{for(var C=!0,E=na(y),T;T=yield wt(E.next()),u=T.done,!u;C=!0){m=T.value,C=!1;const _=m;for(const F of x.decode(_))yield yield wt(F)}}catch(_){f={error:_}}finally{try{!C&&!u&&(d=E.return)&&(yield wt(d.call(E)))}finally{if(f)throw f.error}}for(const _ of x.flush())yield yield wt(_)})}function l(){return ra(this,arguments,function*(){var u,f,d,m;if(A)throw new jA("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");A=!0;let x=!1;try{try{for(var y=!0,C=na(s()),E;E=yield wt(C.next()),u=E.done,!u;y=!0){m=E.value,y=!1;const T=m;x||T&&(yield yield wt(JSON.parse(T)))}}catch(T){f={error:T}}finally{try{!y&&!u&&(d=C.return)&&(yield wt(d.call(C)))}finally{if(f)throw f.error}}x=!0}catch(T){if(rp(T))return yield wt(void 0);throw T}finally{x||r.abort()}})}return new ql(l,r,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],n=this.iterator(),A=s=>({next:()=>{if(s.length===0){const l=n.next();t.push(l),r.push(l)}return s.shift()}});return[new ql(()=>A(t),this.controller,this.client),new ql(()=>A(r),this.controller,this.client)]}toReadableStream(){const t=this;let r;return YT({async start(){r=t[Symbol.asyncIterator]()},async pull(n){try{const{value:A,done:s}=await r.next();if(s)return n.close();const l=ox(JSON.stringify(A)+`
`);n.enqueue(l)}catch(A){n.error(A)}},async cancel(){var n;await((n=r.return)===null||n===void 0?void 0:n.call(r))}})}}function VM(e,t){return ra(this,arguments,function*(){var n,A,s,l;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new jA("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new jA("Attempted to iterate over a response with no body");const o=new jM,u=new Cd,f=WT(e.body);try{for(var d=!0,m=na(KM(f)),x;x=yield wt(m.next()),n=x.done,!n;d=!0){l=x.value,d=!1;const y=l;for(const C of u.decode(y)){const E=o.decode(C);E&&(yield yield wt(E))}}}catch(y){A={error:y}}finally{try{!d&&!n&&(s=m.return)&&(yield wt(s.call(m)))}finally{if(A)throw A.error}}for(const y of u.flush()){const C=o.decode(y);C&&(yield yield wt(C))}})}function KM(e){return ra(this,arguments,function*(){var r,n,A,s;let l=new Uint8Array;try{for(var o=!0,u=na(e),f;f=yield wt(u.next()),r=f.done,!r;o=!0){s=f.value,o=!1;const d=s;if(d==null)continue;const m=d instanceof ArrayBuffer?new Uint8Array(d):typeof d=="string"?ox(d):d;let x=new Uint8Array(l.length+m.length);x.set(l),x.set(m,l.length),l=x;let y;for(;(y=PM(l))!==-1;)yield yield wt(l.slice(0,y)),l=l.slice(y)}}catch(d){n={error:d}}finally{try{!o&&!r&&(A=u.return)&&(yield wt(A.call(u)))}finally{if(n)throw n.error}}l.length>0&&(yield yield wt(l))})}class jM{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,n,A]=zM(t,":");return A.startsWith(" ")&&(A=A.substring(1)),r==="event"?this.event=A:r==="data"&&this.data.push(A),null}}function zM(e,t){const r=e.indexOf(t);return r!==-1?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function XM(e,t){const{response:r,requestLogID:n,retryOfRequestLogID:A,startTime:s}=t,l=await(async()=>{var o;if(t.options.stream)return Kn(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(r,t.controller,e):ql.fromSSEResponse(r,t.controller,e);if(r.status===204)return null;if(t.options.__binaryResponse)return r;const u=r.headers.get("content-type"),f=(o=u==null?void 0:u.split(";")[0])===null||o===void 0?void 0:o.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await r.json():await r.text()})();return Kn(e).debug(`[${n}] response parsed`,_i({retryOfRequestLogID:A,url:r.url,status:r.status,body:l,durationMs:Date.now()-s})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cx extends Promise{constructor(t,r,n=XM){super(A=>{A(null)}),this.responsePromise=r,this.parseResponse=n,this.client=t}_thenUnwrap(t){return new cx(this.client,this.responsePromise,async(r,n)=>t(await this.parseResponse(r,n),n))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nS=Symbol("brand.privateNullableHeaders");function*JM(e){if(!e)return;if(nS in e){const{values:n,nulls:A}=e;yield*n.entries();for(const s of A)yield[s,null];return}let t=!1,r;e instanceof Headers?r=e.entries():CC(e)?r=e:(t=!0,r=Object.entries(e??{}));for(let n of r){const A=n[0];if(typeof A!="string")throw new TypeError("expected header name to be a string");const s=CC(n[1])?n[1]:[n[1]];let l=!1;for(const o of s)o!==void 0&&(t&&!l&&(l=!0,yield[A,null]),yield[A,o])}}const mc=e=>{const t=new Headers,r=new Set;for(const n of e){const A=new Set;for(const[s,l]of JM(n)){const o=s.toLowerCase();A.has(o)||(t.delete(s),A.add(o)),l===null?(t.delete(s),r.add(o)):(t.append(s,l),r.delete(o))}}return{[nS]:!0,values:t,nulls:r}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Am=e=>{var t,r,n,A,s,l;if(typeof globalThis.process<"u")return(n=(r=(t=wN)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(s=(A=globalThis.Deno.env)===null||A===void 0?void 0:A.get)===null||s===void 0?void 0:s.call(A,e))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var AS;class Ed{constructor(t){var r,n,A,s,l,o,u,{baseURL:f=Am("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:d=(r=Am("GEMINI_API_KEY"))!==null&&r!==void 0?r:null,apiVersion:m="v1beta"}=t,x=Vf(t,["baseURL","apiKey","apiVersion"]);const y=Object.assign(Object.assign({apiKey:d,apiVersion:m},x),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=y.baseURL,this.timeout=(n=y.timeout)!==null&&n!==void 0?n:Ed.DEFAULT_TIMEOUT,this.logger=(A=y.logger)!==null&&A!==void 0?A:console;const C="warn";this.logLevel=C,this.logLevel=(l=(s=bC(y.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:bC(Am("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:C,this.fetchOptions=y.fetchOptions,this.maxRetries=(o=y.maxRetries)!==null&&o!==void 0?o:2,this.fetch=(u=y.fetch)!==null&&u!==void 0?u:bM(),this.encoder=kM,this._options=y,this.apiKey=d,this.apiVersion=m,this.clientAdapter=y.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:r}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!r.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const r=mc([t.headers]);if(!(r.values.has("authorization")||r.values.has("x-goog-api-key"))){if(this.apiKey)return mc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return mc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new jA(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${zl}`}defaultIdempotencyKey(){return`stainless-node-retry-${hM()}`}makeStatusError(t,r,n,A){return Yn.generate(t,r,n,A)}buildURL(t,r,n){const A=!this.baseURLOverridden()&&n||this.baseURL,s=mM(t)?new URL(t):new URL(A+(A.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),l=this.defaultQuery();return vM(l)||(r=Object.assign(Object.assign({},l),r)),typeof r=="object"&&r&&!Array.isArray(r)&&(s.search=this.stringifyQuery(r)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const r=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${r}`}}async prepareRequest(t,{url:r,options:n}){}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,n){return this.request(Promise.resolve(n).then(A=>Object.assign({method:t,path:r},A)))}request(t,r=null){return new cx(this,this.makeRequest(t,r,void 0))}async makeRequest(t,r,n){var A,s,l;const o=await t,u=(A=o.maxRetries)!==null&&A!==void 0?A:this.maxRetries;r==null&&(r=u),await this.prepareOptions(o);const{req:f,url:d,timeout:m}=await this.buildRequest(o,{retryCount:u-r});await this.prepareRequest(f,{url:d,options:o});const x="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),y=n===void 0?"":`, retryOf: ${n}`,C=Date.now();if(Kn(this).debug(`[${x}] sending request`,_i({retryOfRequestLogID:n,method:o.method,url:d,options:o,headers:f.headers})),!((s=o.signal)===null||s===void 0)&&s.aborted)throw new Ap;const E=new AbortController,T=await this.fetchWithTimeout(d,f,m,E).catch(np),_=Date.now();if(T instanceof globalThis.Error){const S=`retrying, ${r} attempts remaining`;if(!((l=o.signal)===null||l===void 0)&&l.aborted)throw new Ap;const I=rp(T)||/timed? ?out/i.test(String(T)+("cause"in T?String(T.cause):""));if(r)return Kn(this).info(`[${x}] connection ${I?"timed out":"failed"} - ${S}`),Kn(this).debug(`[${x}] connection ${I?"timed out":"failed"} (${S})`,_i({retryOfRequestLogID:n,url:d,durationMs:_-C,message:T.message})),this.retryRequest(o,r,n??x);throw Kn(this).info(`[${x}] connection ${I?"timed out":"failed"} - error; no more retries left`),Kn(this).debug(`[${x}] connection ${I?"timed out":"failed"} (error; no more retries left)`,_i({retryOfRequestLogID:n,url:d,durationMs:_-C,message:T.message})),I?new OT:new Bd({cause:T})}const F=`[${x}${y}] ${f.method} ${d} ${T.ok?"succeeded":"failed"} with status ${T.status} in ${_-C}ms`;if(!T.ok){const S=await this.shouldRetry(T);if(r&&S){const R=`retrying, ${r} attempts remaining`;return await UM(T.body),Kn(this).info(`${F} - ${R}`),Kn(this).debug(`[${x}] response error (${R})`,_i({retryOfRequestLogID:n,url:T.url,status:T.status,headers:T.headers,durationMs:_-C})),this.retryRequest(o,r,n??x,T.headers)}const I=S?"error; no more retries left":"error; not retryable";Kn(this).info(`${F} - ${I}`);const M=await T.text().catch(R=>np(R).message),Q=BM(M),U=Q?void 0:M;throw Kn(this).debug(`[${x}] response error (${I})`,_i({retryOfRequestLogID:n,url:T.url,status:T.status,headers:T.headers,message:U,durationMs:Date.now()-C})),this.makeStatusError(T.status,Q,U,T.headers)}return Kn(this).info(F),Kn(this).debug(`[${x}] response start`,_i({retryOfRequestLogID:n,url:T.url,status:T.status,headers:T.headers,durationMs:_-C})),{response:T,options:o,controller:E,requestLogID:x,retryOfRequestLogID:n,startTime:C}}async fetchWithTimeout(t,r,n,A){const s=r||{},{signal:l,method:o}=s,u=Vf(s,["signal","method"]);l&&l.addEventListener("abort",()=>A.abort());const f=setTimeout(()=>A.abort(),n),d=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,m=Object.assign(Object.assign(Object.assign({signal:A.signal},d?{duplex:"half"}:{}),{method:"GET"}),u);o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,t,m)}finally{clearTimeout(f)}}async shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,n,A){var s;let l;const o=A==null?void 0:A.get("retry-after-ms");if(o){const f=parseFloat(o);Number.isNaN(f)||(l=f)}const u=A==null?void 0:A.get("retry-after");if(u&&!l){const f=parseFloat(u);Number.isNaN(f)?l=Date.parse(u)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(r,f)}return await CM(l),this.makeRequest(t,r-1,n)}calculateDefaultRetryTimeoutMillis(t,r){const s=r-t,l=Math.min(.5*Math.pow(2,s),8),o=1-Math.random()*.25;return l*o*1e3}async buildRequest(t,{retryCount:r=0}={}){var n,A,s;const l=Object.assign({},t),{method:o,path:u,query:f,defaultBaseURL:d}=l,m=this.buildURL(u,f,d);"timeout"in l&&yM("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:x,body:y}=this.buildBody({options:l}),C=await this.buildHeaders({options:t,method:o,bodyHeaders:x,retryCount:r});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:C},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&y instanceof globalThis.ReadableStream&&{duplex:"half"}),y&&{body:y}),(A=this.fetchOptions)!==null&&A!==void 0?A:{}),(s=l.fetchOptions)!==null&&s!==void 0?s:{}),url:m,timeout:l.timeout}}async buildHeaders({options:t,method:r,bodyHeaders:n,retryCount:A}){let s={};this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);const l=await this.authHeaders(t);let o=mc([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(A)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),_M()),this._options.defaultHeaders,n,t.headers,l]);return this.validateHeaders(o),o.values}buildBody({options:{body:t,headers:r}}){if(!t)return{bodyHeaders:void 0,body:void 0};const n=mc([r]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&n.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:FM(t)}:this.encoder({body:t,headers:n})}}Ed.DEFAULT_TIMEOUT=6e4;class dn extends Ed{constructor(){super(...arguments),this.interactions=new rS(this)}}AS=dn;dn.GeminiNextGenAPIClient=AS;dn.GeminiNextGenAPIClientError=jA;dn.APIError=Yn;dn.APIConnectionError=Bd;dn.APIConnectionTimeoutError=OT;dn.APIUserAbortError=Ap;dn.NotFoundError=KT;dn.ConflictError=jT;dn.RateLimitError=XT;dn.BadRequestError=PT;dn.AuthenticationError=GT;dn.InternalServerError=JT;dn.PermissionDeniedError=VT;dn.UnprocessableEntityError=zT;dn.toFile=DM;dn.Interactions=rS;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YM(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function WM(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function qM(e,t){const r={},n=p(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function $M(e,t){const r={},n=p(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function ZM(e,t,r){const n={};if(p(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const A=p(e,["tunedModelDisplayName"]);if(t!==void 0&&A!=null&&v(t,["displayName"],A),p(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=p(e,["epochCount"]);t!==void 0&&s!=null&&v(t,["tuningTask","hyperparameters","epochCount"],s);const l=p(e,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),p(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=p(e,["batchSize"]);t!==void 0&&o!=null&&v(t,["tuningTask","hyperparameters","batchSize"],o);const u=p(e,["learningRate"]);if(t!==void 0&&u!=null&&v(t,["tuningTask","hyperparameters","learningRate"],u),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function eL(e,t,r){const n={};let A=p(r,["config","method"]);if(A===void 0&&(A="SUPERVISED_FINE_TUNING"),A==="SUPERVISED_FINE_TUNING"){const y=p(e,["validationDataset"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec"],UC(y))}else if(A==="PREFERENCE_TUNING"){const y=p(e,["validationDataset"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec"],UC(y))}const s=p(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&v(t,["tunedModelDisplayName"],s);const l=p(e,["description"]);t!==void 0&&l!=null&&v(t,["description"],l);let o=p(r,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const y=p(e,["epochCount"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","hyperParameters","epochCount"],y)}else if(o==="PREFERENCE_TUNING"){const y=p(e,["epochCount"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],y)}let u=p(r,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const y=p(e,["learningRateMultiplier"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],y)}else if(u==="PREFERENCE_TUNING"){const y=p(e,["learningRateMultiplier"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],y)}let f=p(r,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const y=p(e,["exportLastCheckpointOnly"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","exportLastCheckpointOnly"],y)}else if(f==="PREFERENCE_TUNING"){const y=p(e,["exportLastCheckpointOnly"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],y)}let d=p(r,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const y=p(e,["adapterSize"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","hyperParameters","adapterSize"],y)}else if(d==="PREFERENCE_TUNING"){const y=p(e,["adapterSize"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],y)}if(p(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=p(e,["labels"]);t!==void 0&&m!=null&&v(t,["labels"],m);const x=p(e,["beta"]);return t!==void 0&&x!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","beta"],x),n}function tL(e,t){const r={},n=p(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const A=p(e,["preTunedModel"]);A!=null&&v(r,["preTunedModel"],A);const s=p(e,["trainingDataset"]);s!=null&&fL(s);const l=p(e,["config"]);return l!=null&&ZM(l,r),r}function rL(e,t){const r={},n=p(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const A=p(e,["preTunedModel"]);A!=null&&v(r,["preTunedModel"],A);const s=p(e,["trainingDataset"]);s!=null&&dL(s,r,t);const l=p(e,["config"]);return l!=null&&eL(l,r,t),r}function nL(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function AL(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function aL(e,t,r){const n={},A=p(e,["pageSize"]);t!==void 0&&A!=null&&v(t,["_query","pageSize"],A);const s=p(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const l=p(e,["filter"]);return t!==void 0&&l!=null&&v(t,["_query","filter"],l),n}function sL(e,t,r){const n={},A=p(e,["pageSize"]);t!==void 0&&A!=null&&v(t,["_query","pageSize"],A);const s=p(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const l=p(e,["filter"]);return t!==void 0&&l!=null&&v(t,["_query","filter"],l),n}function iL(e,t){const r={},n=p(e,["config"]);return n!=null&&aL(n,r),r}function lL(e,t){const r={},n=p(e,["config"]);return n!=null&&sL(n,r),r}function oL(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const A=p(e,["nextPageToken"]);A!=null&&v(r,["nextPageToken"],A);const s=p(e,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>aS(o))),v(r,["tuningJobs"],l)}return r}function cL(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const A=p(e,["nextPageToken"]);A!=null&&v(r,["nextPageToken"],A);const s=p(e,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>ip(o))),v(r,["tuningJobs"],l)}return r}function uL(e,t){const r={},n=p(e,["name"]);n!=null&&v(r,["model"],n);const A=p(e,["name"]);return A!=null&&v(r,["endpoint"],A),r}function fL(e,t){const r={};if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=p(e,["examples"]);if(n!=null){let A=n;Array.isArray(A)&&(A=A.map(s=>s)),v(r,["examples","examples"],A)}return r}function dL(e,t,r){const n={};let A=p(r,["config","method"]);if(A===void 0&&(A="SUPERVISED_FINE_TUNING"),A==="SUPERVISED_FINE_TUNING"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&v(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(A==="PREFERENCE_TUNING"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&v(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let s=p(r,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&v(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&v(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(p(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function aS(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const A=p(e,["name"]);A!=null&&v(r,["name"],A);const s=p(e,["state"]);s!=null&&v(r,["state"],yT(s));const l=p(e,["createTime"]);l!=null&&v(r,["createTime"],l);const o=p(e,["tuningTask","startTime"]);o!=null&&v(r,["startTime"],o);const u=p(e,["tuningTask","completeTime"]);u!=null&&v(r,["endTime"],u);const f=p(e,["updateTime"]);f!=null&&v(r,["updateTime"],f);const d=p(e,["description"]);d!=null&&v(r,["description"],d);const m=p(e,["baseModel"]);m!=null&&v(r,["baseModel"],m);const x=p(e,["_self"]);return x!=null&&v(r,["tunedModel"],uL(x)),r}function ip(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const A=p(e,["name"]);A!=null&&v(r,["name"],A);const s=p(e,["state"]);s!=null&&v(r,["state"],yT(s));const l=p(e,["createTime"]);l!=null&&v(r,["createTime"],l);const o=p(e,["startTime"]);o!=null&&v(r,["startTime"],o);const u=p(e,["endTime"]);u!=null&&v(r,["endTime"],u);const f=p(e,["updateTime"]);f!=null&&v(r,["updateTime"],f);const d=p(e,["error"]);d!=null&&v(r,["error"],d);const m=p(e,["description"]);m!=null&&v(r,["description"],m);const x=p(e,["baseModel"]);x!=null&&v(r,["baseModel"],x);const y=p(e,["tunedModel"]);y!=null&&v(r,["tunedModel"],y);const C=p(e,["preTunedModel"]);C!=null&&v(r,["preTunedModel"],C);const E=p(e,["supervisedTuningSpec"]);E!=null&&v(r,["supervisedTuningSpec"],E);const T=p(e,["preferenceOptimizationSpec"]);T!=null&&v(r,["preferenceOptimizationSpec"],T);const _=p(e,["tuningDataStats"]);_!=null&&v(r,["tuningDataStats"],_);const F=p(e,["encryptionSpec"]);F!=null&&v(r,["encryptionSpec"],F);const S=p(e,["partnerModelTuningSpec"]);S!=null&&v(r,["partnerModelTuningSpec"],S);const I=p(e,["customBaseModel"]);I!=null&&v(r,["customBaseModel"],I);const M=p(e,["experiment"]);M!=null&&v(r,["experiment"],M);const Q=p(e,["labels"]);Q!=null&&v(r,["labels"],Q);const U=p(e,["outputUri"]);U!=null&&v(r,["outputUri"],U);const G=p(e,["pipelineJob"]);G!=null&&v(r,["pipelineJob"],G);const R=p(e,["serviceAccount"]);R!=null&&v(r,["serviceAccount"],R);const te=p(e,["tunedModelDisplayName"]);te!=null&&v(r,["tunedModelDisplayName"],te);const ne=p(e,["veoTuningSpec"]);return ne!=null&&v(r,["veoTuningSpec"],ne),r}function hL(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const A=p(e,["name"]);A!=null&&v(r,["name"],A);const s=p(e,["metadata"]);s!=null&&v(r,["metadata"],s);const l=p(e,["done"]);l!=null&&v(r,["done"],l);const o=p(e,["error"]);return o!=null&&v(r,["error"],o),r}function UC(e,t){const r={},n=p(e,["gcsUri"]);n!=null&&v(r,["validationDatasetUri"],n);const A=p(e,["vertexDatasetResource"]);return A!=null&&v(r,["validationDatasetUri"],A),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gL extends As{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ji(es.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.get=async r=>await this.getInternal(r),this.tune=async r=>{var n;if(this.apiClient.isVertexAI())if(r.baseModel.startsWith("projects/")){const A={tunedModelName:r.baseModel};!((n=r.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(A.checkpointId=r.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},r),{preTunedModel:A});return s.baseModel=void 0,await this.tuneInternal(s)}else{const A=Object.assign({},r);return await this.tuneInternal(A)}else{const A=Object.assign({},r),s=await this.tuneMldevInternal(A);let l="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?l=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(l=s.name.split("/operations/")[0]),{name:l,state:Ym.JOB_STATE_QUEUED}}}}async getInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=AL(t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>ip(d))}else{const f=nL(t);return o=Ye("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>aS(d))}}async listInternal(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=lL(t);return o=Ye("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=cL(d),x=new rC;return Object.assign(x,m),x})}else{const f=iL(t);return o=Ye("tunedModels",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=oL(d),x=new rC;return Object.assign(x,m),x})}}async cancel(t){var r,n,A,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=WM(t);return o=Ye("{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=$M(d),x=new nC;return Object.assign(x,m),x})}else{const f=YM(t);return o=Ye("{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(A=t.config)===null||A===void 0?void 0:A.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=qM(d),x=new nC;return Object.assign(x,m),x})}}async tuneInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI()){const o=rL(t,t);return s=Ye("tuningJobs",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>ip(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var r,n;let A,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=tL(t);return s=Ye("tunedModels",o._url),l=o._query,delete o._url,delete o._query,A=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),A.then(u=>hL(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mL{async download(t,r){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const pL=1024*1024*8,xL=3,vL=1e3,wL=2,jf="x-goog-upload-status";async function yL(e,t,r){var n;const A=await sS(e,t,r),s=await(A==null?void 0:A.json());if(((n=A==null?void 0:A.headers)===null||n===void 0?void 0:n[jf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function BL(e,t,r){var n;const A=await sS(e,t,r),s=await(A==null?void 0:A.json());if(((n=A==null?void 0:A.headers)===null||n===void 0?void 0:n[jf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=gT(s),o=new nx;return Object.assign(o,l),o}async function sS(e,t,r){var n,A;let s=0,l=0,o=new Wm(new Response),u="upload";for(s=e.size;l<s;){const f=Math.min(pL,s-l),d=e.slice(l,l+f);l+f>=s&&(u+=", finalize");let m=0,x=vL;for(;m<xL&&(o=await r.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((n=o==null?void 0:o.headers)===null||n===void 0)&&n[jf]));)m++,await EL(x),x=x*wL;if(l+=f,((A=o==null?void 0:o.headers)===null||A===void 0?void 0:A[jf])!=="active")break;if(s<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return o}async function CL(e){return{size:e.size,type:e.type}}function EL(e){return new Promise(t=>setTimeout(t,e))}class TL{async upload(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await yL(t,r,n)}async uploadToFileSearchStore(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await BL(t,r,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await CL(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SL{create(t,r,n){return new _L(t,r,n)}}class _L{constructor(t,r,n){this.url=t,this.headers=r,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kC="x-goog-api-key";class bL{constructor(t){this.apiKey=t}async addAuthHeaders(t,r){if(t.get(kC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(kC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const FL="gl-node/";class iS{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const r=new dn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=r.interactions,this._interactions}constructor(t){var r;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(r=t.vertexai)!==null&&r!==void 0?r:!1,this.apiKey=t.apiKey;const n=EN(t.httpOptions,t.vertexai,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const A=new bL(this.apiKey);this.apiClient=new CD({auth:A,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:FL+"web",uploader:new TL,downloader:new mL}),this.models=new GD(this.apiClient),this.live=new DD(this.apiClient,A,new SL),this.batches=new ZI(this.apiClient),this.chats=new QQ(this.models,this.apiClient),this.caches=new kQ(this.apiClient),this.files=new KQ(this.apiClient),this.operations=new VD(this.apiClient),this.authTokens=new aM(this.apiClient),this.tunings=new gL(this.apiClient),this.fileSearchStores=new dM(this.apiClient)}}const UL={users:[{id:"admin01",name:"Admin User",email:"admin@exam.com",role:xt.ADMIN,password:"password123",institutionName:"Global Tech University"},{id:"admin02",name:"Second Admin",email:"admin2@exam.com",role:xt.ADMIN,password:"password123",institutionName:"Innovate Institute"},{id:"teacher01",name:"Dr. Evelyn Reed",email:"teacher1@exam.com",role:xt.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"},{id:"teacher02",name:"Mr. Samuel Chen",email:"teacher2@exam.com",role:xt.TEACHER,permissionGranted:!1,password:"password123"},{id:"teacher03",name:"Ms. Anya Sharma",email:"teacher3@exam.com",role:xt.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"},{id:"teacher04",name:"Ms. Nitya",email:"teacher4@exam.com",role:xt.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"}],exams:[{id:"exam01",title:"Mid-Term Examinations",date:"2024-09-15",halls:[{id:"hallA",name:"Hall A",layout:Array.from({length:64},(e,t)=>({id:`s${t}`,row:Math.floor(t/8),col:t%8,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"},{id:"hallB",name:"Hall B",layout:Array.from({length:42},(e,t)=>({id:`s${t}`,row:Math.floor(t/7),col:t%7,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"}],studentSets:[{id:"set101",subject:"101",studentCount:50},{id:"set102",subject:"102",studentCount:45}],seatingPlan:void 0,seatingType:"normal",editorMode:"ai",createdBy:"teacher01",adminId:"admin01"},{id:"exam02",title:"Finals - Advanced Mode",date:"2024-12-10",halls:[{id:"hallC",name:"Hall C",layout:Array.from({length:50},(e,t)=>({id:`s${t}`,row:Math.floor(t/10),col:t%10,type:"standard"})),constraints:{type:"advanced",allowedSetIds:["set201"],arrangement:"vertical"},frontDirection:"left"}],studentSets:[{id:"set201",subject:"201",studentCount:30},{id:"set202",subject:"202",studentCount:20}],seatingPlan:void 0,seatingType:"normal",editorMode:"advanced",createdBy:"teacher03",adminId:"admin01"},{id:"exam03",title:"Pop Quiz - Classic Mode",date:"2024-10-25",halls:[{id:"hallD",name:"Hall D",layout:Array.from({length:30},(e,t)=>({id:`s${t}`,row:Math.floor(t/5),col:t%5,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"bottom"}],studentSets:[{id:"set301",subject:"301",studentCount:25}],seatingPlan:void 0,seatingType:"fair",editorMode:"classic",createdBy:"teacher01",adminId:"admin01"}],hallTemplates:[{id:"template01",name:"Main Auditorium",layout:Array.from({length:100},(e,t)=>({id:`s${t}`,row:Math.floor(t/10),col:t%10,type:"standard"})),createdBy:"teacher01",adminId:"admin01"},{id:"template02",name:"Computer Lab 1",layout:Array.from({length:40},(e,t)=>({id:`s${t}`,row:Math.floor(t/8),col:t%8,type:"standard"})),createdBy:"teacher01",adminId:"admin01"}],studentSetTemplates:[{id:"settemplate01",subject:"Physics 101",studentCount:50,createdBy:"teacher01",adminId:"admin01"},{id:"settemplate02",subject:"Chemistry Lab",studentCount:24,createdBy:"teacher01",adminId:"admin01"},{id:"settemplate03",subject:"Calculus III",studentCount:45,createdBy:"teacher03",adminId:"admin01"}],auditLogs:[{id:"log1",adminId:"admin01",actorName:"Dr. Evelyn Reed",role:xt.TEACHER,action:"CREATED_EXAM",details:'Created exam "Mid-Term Examinations"',timestamp:new Date(Date.now()-864e5*2).toISOString()},{id:"log2",adminId:"admin01",actorName:"Student 101001",role:xt.STUDENT,action:"STUDENT_LOGIN",details:"Accessed dashboard",timestamp:new Date(Date.now()-36e5).toISOString()}]};let Ze=JSON.parse(JSON.stringify(UL));const xr=200,po=(e,t,r,n,A)=>{const s={id:`log${Date.now()}${Math.random().toString(36).substr(2,5)}`,adminId:e,actorName:t,role:r,action:n,details:A,timestamp:new Date().toISOString()};Ze.auditLogs.unshift(s)},kL=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve(Ze.auditLogs.filter(t=>t.adminId===e).sort((t,r)=>new Date(r.timestamp).getTime()-new Date(t.timestamp).getTime()))),NL=async()=>{await new Promise(t=>setTimeout(t,xr));const e=Ze.users.filter(t=>t.role===xt.ADMIN&&t.institutionName).map(t=>({id:t.id,name:t.institutionName})).sort((t,r)=>t.name.localeCompare(r.name));return Promise.resolve(e)},IL=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve(Ze.users.find(t=>t.email.toLowerCase()===e.toLowerCase()))),Td=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve(Ze.users.find(t=>t.id===e))),QL=async(e,t,r,n)=>{if(await new Promise(s=>setTimeout(s,xr)),Ze.users.some(s=>s.email.toLowerCase()===t.toLowerCase()))return Promise.resolve(null);const A={id:`admin${Date.now()}`,name:e,email:t,role:xt.ADMIN,password:r,institutionName:n};return Ze.users=[...Ze.users,A],Promise.resolve(A)},RL=async(e,t,r,n)=>{if(await new Promise(l=>setTimeout(l,xr)),Ze.users.some(l=>l.email.toLowerCase()===t.toLowerCase()))return Promise.resolve(null);const A=Ze.users.find(l=>{var o;return l.role===xt.ADMIN&&(l.id===n||((o=l.institutionName)==null?void 0:o.toLowerCase())===n.toLowerCase())});if(!A)return Promise.resolve(null);const s={id:`teacher${Date.now()}`,name:e,email:t,role:xt.TEACHER,permissionGranted:!1,password:r,adminId:A.id};return Ze.users=[...Ze.users,s],Promise.resolve(s)},lS=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve(Ze.users.filter(t=>t.role==="TEACHER"&&t.adminId===e))),DL=async()=>(await new Promise(e=>setTimeout(e,xr)),Promise.resolve(Ze.users.filter(e=>e.role==="TEACHER"&&!e.permissionGranted))),ML=async(e,t)=>{await new Promise(n=>setTimeout(n,xr));let r;return Ze.users=Ze.users.map(n=>n.id===e&&n.role==="TEACHER"?(r={...n,permissionGranted:!0,adminId:t},r):n),r&&po(t,"Admin",xt.ADMIN,"GRANTED_PERMISSION",`Approved teacher account: ${r.name}`),Promise.resolve(r)},LL=async e=>{await new Promise(r=>setTimeout(r,xr));let t;return Ze.users=Ze.users.map(r=>r.id===e&&r.role==="TEACHER"?(t={...r,permissionGranted:!1},t):r),t&&t.adminId&&po(t.adminId,"Admin",xt.ADMIN,"REVOKED_PERMISSION",`Revoked permission for: ${t.name}`),Promise.resolve(t)},HL=async(e,t)=>{await new Promise(n=>setTimeout(n,xr));const r=Ze.users.length;return Ze.users=Ze.users.filter(n=>n.id!==e),Ze.users.length===r?Promise.resolve(!1):(Ze.exams=Ze.exams.filter(n=>n.createdBy!==e),Ze.hallTemplates=Ze.hallTemplates.filter(n=>n.createdBy!==e),Ze.studentSetTemplates=Ze.studentSetTemplates.filter(n=>n.createdBy!==e),po(t,"Admin",xt.ADMIN,"DELETED_TEACHER","Deleted teacher account."),Promise.resolve(!0))},OL=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve([...Ze.exams].filter(t=>t.adminId===e).sort((t,r)=>r.id.localeCompare(t.id)))),PL=async(e,t)=>{await new Promise(n=>setTimeout(n,xr));for(const n of Ze.exams)if(!n.seatingPlan&&n.adminId===t){let A;n.editorMode==="classic"||n.editorMode==="advanced"?A=await op({halls:n.halls,studentSets:n.studentSets,seatingType:n.seatingType}):A=await cp({halls:n.halls,studentSets:n.studentSets,rules:n.aiSeatingRules,seatingType:n.seatingType,editorMode:n.editorMode}),A.plan&&(n.seatingPlan=A.plan)}const r=Ze.exams.filter(n=>n.adminId!==t||!n.seatingPlan?!1:Object.values(n.seatingPlan).some(A=>A.some(s=>s.some(l=>{var o;return((o=l==null?void 0:l.student)==null?void 0:o.id)===e}))));return Promise.resolve(r.sort((n,A)=>A.id.localeCompare(n.id)))},GL=async e=>{await new Promise(r=>setTimeout(r,xr));const t=Ze.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(Ze.exams.filter(r=>r.adminId===t.adminId).sort((r,n)=>n.id.localeCompare(r.id)))},VL=async(e,t)=>{await new Promise(A=>setTimeout(A,xr));const r=await Td(t);if(!r||!r.adminId)throw new Error("Teacher not assigned.");const n={...e,id:`exam${Date.now()}`,createdBy:t,adminId:r.adminId,halls:e.halls.map((A,s)=>({...A,id:`hall${Date.now()}${s}`})),studentSets:e.studentSets.map((A,s)=>({...A,id:`set${Date.now()}${s}`})),seatingPlan:void 0};return Ze.exams=[...Ze.exams,n],po(r.adminId,r.name,xt.TEACHER,"CREATED_EXAM",`Created new exam: "${n.title}"`),Promise.resolve(n)},am=async e=>{await new Promise(r=>setTimeout(r,xr));const t=Ze.users.find(r=>r.id===e.createdBy);return Ze.exams=Ze.exams.map(r=>r.id===e.id?e:r),t&&t.adminId&&po(t.adminId,t.name,xt.TEACHER,"UPDATED_EXAM",`Updated exam: "${e.title}"`),Promise.resolve(e)},KL=async(e,t,r)=>{await new Promise(A=>setTimeout(A,xr));const n=Ze.exams.findIndex(A=>A.id===e);return n===-1?Promise.resolve(!1):(Ze.exams[n].seatingPlan=t,Promise.resolve(!0))},oS=async(e,t,r)=>{await new Promise(s=>setTimeout(s,xr));const n=Ze.exams.find(s=>s.id===e);if(!n)return Promise.resolve(!1);if(r===xt.ADMIN&&n.adminId===t||r===xt.TEACHER){const s=Ze.exams.length;if(Ze.exams=Ze.exams.filter(l=>l.id!==e),Ze.exams.length<s)return po(n.adminId,r===xt.ADMIN?"Admin":"Teacher",r,"DELETED_EXAM",`Deleted exam: "${n.title}"`),Promise.resolve(!0)}return Promise.resolve(!1)},jL=async e=>{await new Promise(r=>setTimeout(r,xr));const t=Ze.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(Ze.hallTemplates.filter(r=>r.adminId===t.adminId))},zL=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve(Ze.hallTemplates.filter(t=>t.adminId===e))),Rc=async(e,t)=>{await new Promise(s=>setTimeout(s,xr));const r=await Td(t);if(!r)throw new Error("Creator not found.");const n=r.role===xt.ADMIN?r.id:r.adminId,A={...e,id:`template${Date.now()}`,createdBy:t,adminId:n};return Ze.hallTemplates=[...Ze.hallTemplates,A],Promise.resolve(A)},XL=async(e,t,r)=>{await new Promise(s=>setTimeout(s,xr));const n=Ze.hallTemplates.findIndex(s=>s.id===e);if(n===-1)return Promise.resolve(null);const A={...Ze.hallTemplates[n],...t};return Ze.hallTemplates[n]=A,Promise.resolve(A)},cS=async(e,t,r)=>{await new Promise(A=>setTimeout(A,xr));const n=Ze.hallTemplates.length;return Ze.hallTemplates=Ze.hallTemplates.filter(A=>A.id!==e),Promise.resolve(Ze.hallTemplates.length<n)},JL=async e=>{await new Promise(r=>setTimeout(r,xr));const t=Ze.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(Ze.studentSetTemplates.filter(r=>r.adminId===t.adminId))},YL=async e=>(await new Promise(t=>setTimeout(t,xr)),Promise.resolve(Ze.studentSetTemplates.filter(t=>t.adminId===e))),lp=async(e,t)=>{await new Promise(s=>setTimeout(s,xr));const r=await Td(t);if(!r)throw new Error("Creator not found.");const n=r.role===xt.ADMIN?r.id:r.adminId,A={...e,id:`settemplate${Date.now()}`,createdBy:t,adminId:n};return Ze.studentSetTemplates=[...Ze.studentSetTemplates,A],Promise.resolve(A)},WL=async(e,t,r)=>{await new Promise(s=>setTimeout(s,xr));const n=Ze.studentSetTemplates.findIndex(s=>s.id===e);if(n===-1)return Promise.resolve(null);const A={...Ze.studentSetTemplates[n],...t};return Ze.studentSetTemplates[n]=A,Promise.resolve(A)},uS=async(e,t,r)=>{await new Promise(A=>setTimeout(A,xr));const n=Ze.studentSetTemplates.length;return Ze.studentSetTemplates=Ze.studentSetTemplates.filter(A=>A.id!==e),Promise.resolve(Ze.studentSetTemplates.length<n)},fS=e=>{const t=[];return e.forEach(r=>{if(r.students&&r.students.length>0)r.students.forEach((n,A)=>t.push({id:n,setId:r.id,setNumber:A+1}));else{const n=Number(r.studentCount),A=Math.max(2,n.toString().length),s=/^\d+$/.test(r.subject)?r.subject:r.subject.substring(0,3).toUpperCase();for(let l=0;l<n;l++){const o=(l+1).toString().padStart(A,"0");t.push({id:`${s}${o}`,setId:r.id,setNumber:l+1})}}}),t},op=async e=>{var f;const{halls:t,studentSets:r,seatingType:n="normal"}=e,A=fS(r),s=new Map,l={};if(r.forEach(d=>{l[d.id]=A.filter(m=>m.setId===d.id)}),n==="fair"){let d=0,m=0;for(const x of t){const y=x.layout.filter(E=>E.type!=="faculty").sort((E,T)=>{var F;return(((F=x.constraints)==null?void 0:F.arrangement)||"horizontal")==="vertical"?E.col!==T.col?E.col-T.col:E.row-T.row:E.row!==T.row?E.row-T.row:E.col-T.col}),C=((f=x.constraints)==null?void 0:f.type)==="advanced"?x.constraints.allowedSetIds:Object.keys(l);for(const E of y){const T=C.filter(_=>l[_].length>0);if(T.length===0)break;if(T.length===1){if(d>0){d--;continue}const _=T[0];if(l[_]&&l[_].length>0){const F=l[_].shift();s.set(`${x.id}-${E.row}-${E.col}`,F),d=1}else break}else{let _,F=0;for(;!_&&F<T.length;){const S=T[m%T.length];l[S].length>0&&(_=l[S].shift()),m++,F++}if(_)s.set(`${x.id}-${E.row}-${E.col}`,_);else break}}}}else{let d=0;for(const m of t){const x=m.layout.filter(C=>C.type!=="faculty").sort((C,E)=>{var _;return(((_=m.constraints)==null?void 0:_.arrangement)||"horizontal")==="vertical"?C.col!==E.col?C.col-E.col:C.row-E.row:C.row!==E.row?C.row-E.row:C.col-E.col}),y=()=>{var T;const C=Object.keys(l).filter(_=>l[_].length>0),E=((T=m.constraints)==null?void 0:T.type)==="advanced"?m.constraints.allowedSetIds:null;return E?C.filter(_=>E.includes(_)):C};for(const C of x){const E=y();if(E.length===0)break;let T,_=0;for(;!T&&_<E.length;){const F=E[d%E.length];l[F].length>0&&(T=l[F].shift()),d++,_++}if(T)s.set(`${m.id}-${C.row}-${C.col}`,T);else break}}}const o=Object.values(l).flat();if(o.length>0)return n==="fair"?{plan:null,message:"not enough seats for fair seating"}:{plan:null,message:`Failed to assign all students. ${o.length} students remain unplaced, possibly due to lack of seats.`};const u={};return t.forEach(d=>{const m=Math.max(-1,...d.layout.map(C=>C.row)),x=Math.max(-1,...d.layout.map(C=>C.col)),y=Array.from({length:m+1},()=>Array(x+1).fill(null));d.layout.forEach(C=>{const E=s.get(`${d.id}-${C.row}-${C.col}`);y[C.row][C.col]={...C,hallId:d.id,...E&&{student:E}}}),u[d.id]=y}),{plan:u,message:"Classic seating plan generated successfully!"}},cp=async e=>{const{halls:t,studentSets:r,rules:n,seatingType:A,editorMode:s}=e,l=fS(r),o=t.flatMap(x=>x.layout.filter(y=>y.type!=="faculty"));if(A!=="fair"&&l.length>o.length)return{plan:null,message:`Not enough seats. Required: ${l.length}, Available: ${o.length}.`};const u={halls:t.map(x=>({id:x.id,name:x.name,seats:x.layout.map(y=>({row:y.row,col:y.col,type:y.type})),constraints:x.constraints})),studentSets:r.map(x=>({id:x.id,subject:x.subject,students:l.filter(y=>y.setId===x.id).map(y=>y.id)}))};let f="";A==="fair"?f=`
            **CRITICAL: DYNAMIC HALL-CENTRIC FAIR SEATING ALGORITHM**
            Your primary goal is to create a fair seating arrangement. This requires a dynamic, hall-centric approach.
            Process halls in the order they are provided. For each seat in a hall:
            1.  **Re-evaluate:** Determine the list of student sets that are eligible for the CURRENT hall (based on hall constraints) and still have students left to be seated.
            2.  **Decide Strategy:**
                *   If the list from step 1 contains only ONE set, you MUST use **"Fair Spacing" mode** for this seat. This means you place one student, and then you MUST leave the next available seat EMPTY. The pattern must be [STUDENT], [EMPTY], [STUDENT], [EMPTY].
                *   If the list from step 1 contains MULTIPLE sets, you MUST use **"Normal Placement" mode**. This means you use a round-robin approach to pick a student from the eligible sets and you MUST fill the current seat without leaving a gap.
            3.  **Repeat:** Move to the next seat and go back to step 1. This re-evaluation for every seat is the most important rule.
            If you cannot place every single student while following these rules (especially the spacing rule when required), you MUST return a plan with fewer students than the total, which will signal an error.
        `:f=`
            **CRITICAL: NORMAL SEATING ALGORITHM**
            You must fill every available seat without leaving any empty spaces between students. When placing students while multiple sets still have unseated students, assign them by cycling through each student set (e.g., Set A, Set B, Set C, then back to Set A...). This ensures students from the same set are not adjacent.
        `;let d="";s==="ai-advanced"&&(d=`
            **CRITICAL: STRICT HARD CONSTRAINTS**
            You are operating in 'AI+Advanced' mode. The user has defined specific constraints for halls AND likely provided custom AI instructions.
            1. **HARD CONSTRAINTS (Absolute Priority):** The 'constraints.allowedSetIds' for each hall are inviolable. You MUST NEVER place a student in a hall if their Set ID is not in that hall's allowed list (unless the list is empty/no-limit).
            2. **ARRANGEMENT:** Strict adherence to 'constraints.arrangement' (horizontal vs vertical filling).
            3. **USER INSTRUCTIONS:** Apply the user's custom instructions (below) ONLY within the boundaries of the Hard Constraints. If a user instruction contradicts a Hard Constraint, the Constraint wins.
        `);const m=`
        You are a highly intelligent exam seating arrangement assistant. Your task is to assign every student to a unique seat based on the provided data and rules.

        **JSON Data:**
        \`\`\`json
        ${JSON.stringify(u,null,2)}
        \`\`\`
        
        **Seating Rules (Apply these based on the exam's seating type):**
        ${f}

        **AI+Advanced Constraints (STRICTLY FOLLOW IF IN AI+ADVANCED MODE):**
        ${d}

        **Additional User-Provided Rules:**
        ${n||"No additional rules."}


        **Your Task:**
        Assign EVERY student from the JSON data to a unique 'standard' or 'accessible' seat. Do not use 'faculty' seats.
        You MUST return your response as a single, valid JSON object. The JSON object must conform to the provided schema. The root of the object must be a key named "assignments", which is an array of assignment objects.
        Do not output any text or explanation before or after the JSON object.
    `;try{const x=new iS({apiKey:"AIzaSyBumtcIHDN6qmX36rFxIqvjuEo7xjCZ2EM"}),y={type:tn.OBJECT,properties:{assignments:{type:tn.ARRAY,items:{type:tn.OBJECT,properties:{studentId:{type:tn.STRING},hallId:{type:tn.STRING},row:{type:tn.INTEGER},col:{type:tn.INTEGER}},required:["studentId","hallId","row","col"]}}},required:["assignments"]},C=await x.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:m}]}],config:{responseMimeType:"application/json",responseSchema:y}}),T=JSON.parse(C.text).assignments;if(T.length!==l.length)return A==="fair"?{plan:null,message:"not enough seats for fair seating"}:{plan:null,message:`AI Error: The AI did not return an assignment for every student. Expected ${l.length}, got ${T.length}. This may be because a constraint made a full assignment impossible.`};const _=new Map;T.forEach(S=>{const I=l.find(M=>M.id===S.studentId);I&&_.set(`${S.hallId}-${S.row}-${S.col}`,I)});const F={};return t.forEach(S=>{const I=Math.max(-1,...S.layout.map(U=>U.row)),M=Math.max(-1,...S.layout.map(U=>U.col)),Q=Array.from({length:I+1},()=>Array(M+1).fill(null));S.layout.forEach(U=>{const G=_.get(`${S.id}-${U.row}-${U.col}`);Q[U.row][U.col]={...U,hallId:S.id,...G&&{student:G}}}),F[S.id]=Q}),{plan:F,message:"AI-powered seating plan generated successfully!"}}catch(x){return console.error("Error calling Gemini API:",x),{plan:null,message:`An error occurred while communicating with the AI service: ${x.message}`}}},qL=async(e,t)=>{const r=new iS({apiKey:"AIzaSyBumtcIHDN6qmX36rFxIqvjuEo7xjCZ2EM"}),n=`
        You are an expert in extracting structured data from visual seating plans.
        The user has uploaded an image of a classroom layout (photo, blueprint, or hand-drawn sketch).
        Your job is to digitize this into a grid.

        **Instructions:**
        1. **Analyze the Grid:** Identify the rows and columns of student seats.
        2. **Ignore Irrelevant Objects:** Do not count teacher's desks, windows, or doors as seats.
        3. **Represent Aisles:** If there is a walkway between groups of seats, represent it as a column of '0's (zeros).
        4. **Represent Seats:** Represent each student seat as a '1' (one).
        5. **Rectify Geometry:** If the image is a perspective shot (angled), flatten it mentally to a 2D top-down view.
        6. **Consistency:** Ensure all rows have the same length by padding with '0's if necessary.

        **Output:** A JSON object with the grid matrix.
    `;try{const s=(await r.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:t,data:e}},{text:n}]},config:{responseMimeType:"application/json",responseSchema:{type:tn.OBJECT,properties:{rows:{type:tn.INTEGER},cols:{type:tn.INTEGER},matrix:{type:tn.ARRAY,items:{type:tn.STRING}}},required:["rows","cols","matrix"]}}})).text;if(!s)return null;const o=JSON.parse(s).matrix;if(!o||!Array.isArray(o)||o.length===0)return null;const u=o.length,f=Math.max(...o.map(m=>m.length)),d=[];for(let m=0;m<u;m++){const x=o[m];for(let y=0;y<x.length;y++)x[y]==="1"&&d.push({id:`seat-${m}-${y}-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,row:m,col:y,type:"standard"})}return{layout:d,rows:u,cols:f}}catch(A){return console.error("AI Image Analysis Failed",A),null}},$L=async(e,t)=>{const r=await IL(e);return r&&r.password===t?(r.role===xt.TEACHER&&!r.permissionGranted&&console.warn(`Teacher ${r.name} login attempt failed: Permission not granted.`),Promise.resolve(r)):Promise.resolve(null)},ZL=(e,t,r,n)=>QL(e,t,r,n),eH=(e,t,r,n)=>RL(e,t,r,n),tH=(e,t)=>{if(/^\d+$/.test(e)&&e.length>0){const r={id:e,name:`Student ${e}`,email:"",role:xt.STUDENT,registerNumber:e,adminId:t};return Promise.resolve(r)}else return Promise.resolve(null)},rH=()=>(console.log("User logged out."),Promise.resolve()),dS=W.createContext(void 0),nH=({children:e})=>{const[t,r]=W.useState(()=>{const f=localStorage.getItem("user");return f?JSON.parse(f):null}),n=async(f,d)=>{const m=await $L(f,d);return m&&(r(m),localStorage.setItem("user",JSON.stringify(m))),m},A=async(f,d,m,x)=>await eH(f,d,m,x),s=async(f,d,m,x)=>await ZL(f,d,m,x),l=async(f,d)=>{const m=await tH(f,d);return m&&(r(m),localStorage.setItem("user",JSON.stringify(m))),m},o=()=>{rH(),r(null),localStorage.removeItem("user")},u=!!t;return g.jsx(dS.Provider,{value:{user:t,isAuthenticated:u,login:n,logout:o,loginStudent:l,registerTeacher:A,registerAdmin:s},children:e})},zi=()=>{const e=W.useContext(dS);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},hS=W.createContext(void 0),AH=({children:e})=>{const[t,r]=W.useState(()=>{const A=localStorage.getItem("theme");return A||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});W.useEffect(()=>{const A=window.document.documentElement;A.classList.remove("dark","black","lavender","lightblue","limegreen","lightred","lightyellow","lightpink","lightindigo"),t==="dark"?A.classList.add("dark"):t==="black"?A.classList.add("dark","black"):t==="lavender"?A.classList.add("lavender"):t==="lightblue"?A.classList.add("lightblue"):t==="limegreen"?A.classList.add("limegreen"):t==="lightred"?A.classList.add("lightred"):t==="lightyellow"?A.classList.add("lightyellow"):t==="lightpink"?A.classList.add("lightpink"):t==="lightindigo"&&A.classList.add("lightindigo"),localStorage.setItem("theme",t)},[t]);const n=()=>{r(A=>A==="light"?"dark":A==="dark"?"black":A==="black"?"lavender":A==="lavender"?"lightblue":A==="lightblue"?"limegreen":A==="limegreen"?"lightred":A==="lightred"?"lightyellow":A==="lightyellow"?"lightpink":A==="lightpink"?"lightindigo":"light")};return g.jsx(hS.Provider,{value:{theme:t,toggleTheme:n},children:e})},aH=()=>{const e=W.useContext(hS);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},zt=W.forwardRef(({children:e,className:t="",...r},n)=>g.jsx("div",{ref:n,className:`bg-white dark:bg-slate-800 rounded-xl shadow-md dark:shadow-none dark:border dark:border-slate-700 overflow-hidden p-6 sm:p-8 ${t}`,...r,children:e}));zt.displayName="Card";const sH=({className:e})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),iH=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),It=({label:e,id:t,containerClassName:r="",type:n="text",inputSize:A="md",...s})=>{const[l,o]=W.useState(!1),u=n==="password",f=()=>{o(!l)},d=u?l?"text":"password":n,m={sm:"px-2 py-1 text-sm",md:"px-3 py-2",lg:"px-4 py-3 text-lg"};return g.jsxs("div",{className:r,children:[e&&g.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:e}),g.jsxs("div",{className:"relative",children:[g.jsx("input",{id:t,type:d,className:`w-full ${m[A]} border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:placeholder-slate-400 dark:focus:ring-violet-400 dark:focus:border-violet-400 ${u?"pr-10":""}`,...s}),u&&g.jsx("button",{type:"button",onClick:f,className:"absolute inset-y-0 right-0 px-3 flex items-center text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors focus:outline-none",tabIndex:-1,children:l?g.jsx(iH,{className:"h-5 w-5"}):g.jsx(sH,{className:"h-5 w-5"})})]})]})},rt=({children:e,variant:t="primary",size:r="md",className:n="",type:A="button",...s})=>{const l="font-bold rounded-lg transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:scale-100 flex items-center justify-center",o={sm:"py-1 px-3 text-sm",md:"py-2 px-4",lg:"py-3 px-6 text-lg"},u={primary:"bg-violet-600 text-white hover:bg-violet-700 shadow-md",secondary:"bg-slate-200 text-slate-800 hover:bg-slate-300 dark:bg-slate-700 dark:text-slate-200 dark:hover:bg-slate-600",danger:"bg-red-500 text-white hover:bg-red-600 shadow-md",outline:"border-2 border-slate-300 text-slate-600 hover:bg-slate-50 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-800"};return g.jsx("button",{type:A,className:`${l} ${o[r]} ${u[t]} ${n}`,...s,children:e})},gS=({className:e="h-8 w-8",...t})=>g.jsx("img",{src:"https://img.icons8.com/plasticine/100/graduation-cap.png",alt:"Smart Exam Planner Logo",className:`object-contain ${e}`,...t}),lH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),oH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),cH=()=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"}),g.jsx("path",{d:"M12 3a9 9 0 000 18V3z",fill:"currentColor"})]}),uH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),fH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),dH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 21.75H18.75m-13.5 0v-8.25h13.5v8.25m-13.5 0H3.375c-.621 0-1.125-.504-1.125-1.125V9.375c0-.621.504-1.125 1.125-1.125h1.5c.621 0 1.125.504 1.125 1.125v11.25m0-11.25h10.5m0 0v-1.125c0-.621-.504-1.125-1.125-1.125h-7.5c-.621 0-1.125.504-1.125 1.125V9.375m10.5 0h1.875c.621 0 1.125-.504 1.125-1.125V6.375c0-.621-.504-1.125-1.125-1.125h-1.5c-.621 0-1.125.504-1.125 1.125V9.375"})}),hH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),gH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),mH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),pH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),mS=()=>{const{theme:e,toggleTheme:t}=aH();return g.jsxs("button",{onClick:t,className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500 dark:focus:ring-offset-slate-800 transition-colors","aria-label":"Toggle theme",children:[e==="light"&&g.jsx(oH,{}),e==="dark"&&g.jsx(cH,{}),e==="black"&&g.jsx(uH,{}),e==="lavender"&&g.jsx(fH,{}),e==="lightblue"&&g.jsx(dH,{}),e==="limegreen"&&g.jsx(hH,{}),e==="lightred"&&g.jsx(mH,{}),e==="lightyellow"&&g.jsx(gH,{}),e==="lightpink"&&g.jsx(pH,{}),e==="lightindigo"&&g.jsx(lH,{})]})},xH=()=>{const[e,t]=W.useState(""),[r,n]=W.useState(""),[A,s]=W.useState(""),[l,o]=W.useState("admin"),[u,f]=W.useState("login"),[d,m]=W.useState(""),[x,y]=W.useState(""),[C,E]=W.useState(""),[T,_]=W.useState(""),[F,S]=W.useState(""),[I,M]=W.useState([]),[Q,U]=W.useState(""),[G,R]=W.useState(""),[te,ne]=W.useState(1),[ee,ae]=W.useState(""),[Se,Te]=W.useState(""),[q,oe]=W.useState(!1),{login:Re,loginStudent:ie,registerTeacher:Me,registerAdmin:X}=zi(),k=md();W.useEffect(()=>{(async()=>{try{const L=await NL();M(L)}catch(L){console.error("Failed to fetch institutions:",L),ae("Could not load list of institutions.")}})()},[]);const K=async ce=>{ce.preventDefault(),oe(!0),ae(""),Te(""),setTimeout(()=>{oe(!1),ne(2)},500)},P=async ce=>{if(ce.preventDefault(),oe(!0),ae(""),Te(""),G!=="123456"){ae("Invalid OTP. Please use 123456 for this demo."),oe(!1);return}const L=await Re(e,r);oe(!1),L?l==="admin"?L.role===xt.ADMIN?k("/admin"):(ae("This account does not have admin privileges."),ne(1)):l==="teacher"&&(L.role===xt.TEACHER?k("/teacher"):(ae("This account is not a teacher account."),ne(1))):(ae("Invalid credentials. Please try again."),ne(1))},z=async ce=>{if(ce.preventDefault(),oe(!0),ae(""),Te(""),!d||!e||!x||!T){ae("Please fill in all fields."),oe(!1);return}if(x!==C){ae("Passwords do not match."),oe(!1);return}if(x.length<6){ae("Password must be at least 6 characters long."),oe(!1);return}const L=await X(d,e,x,T);oe(!1),L?(Te("Admin account created successfully. You can now log in."),f("login"),m(""),t(""),y(""),E(""),_("")):ae("An account with this email already exists.")},Z=async ce=>{if(ce.preventDefault(),oe(!0),ae(""),Te(""),!d||!e||!x||!F){ae("Please fill in all fields."),oe(!1);return}if(x!==C){ae("Passwords do not match."),oe(!1);return}if(x.length<6){ae("Password must be at least 6 characters long."),oe(!1);return}const L=await Me(d,e,x,F);oe(!1),L?(Te("Account created. An admin must grant permission before you can log in."),f("login"),m(""),t(""),y(""),E(""),S("")):ae("Registration failed. Please check your details. The admin ID or institution may not exist, or an account with this email already exists.")},le=async ce=>{if(ce.preventDefault(),oe(!0),ae(""),!Q){ae("Please select your institution."),oe(!1);return}const L=await ie(A,Q);oe(!1),L?k("/student"):ae("Please enter a valid, numeric Register Number.")},Ce=ce=>{o(ce),ae(""),Te(""),ne(1),t(""),n(""),R(""),s(""),f("login"),m(""),y(""),E(""),_(""),S(""),U("")},he=()=>u==="register"?g.jsxs("form",{onSubmit:z,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:"Create Admin Account"}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(It,{label:"Full Name",id:"registerName",type:"text",value:d,onChange:ce=>m(ce.target.value),required:!0,placeholder:"e.g., Jane Doe"}),g.jsx(It,{label:"Email Address",id:"email",type:"email",value:e,onChange:ce=>t(ce.target.value),required:!0,placeholder:"e.g., admin@exam.com"}),g.jsx(It,{label:"Institution / Organization Name",id:"registerInstitution",type:"text",value:T,onChange:ce=>_(ce.target.value),required:!0,placeholder:"e.g., Global Tech University"}),g.jsx(It,{label:"Password",id:"registerPassword",type:"password",value:x,onChange:ce=>y(ce.target.value),required:!0,placeholder:"Minimum 6 characters"}),g.jsx(It,{label:"Confirm Password",id:"confirmPassword",type:"password",value:C,onChange:ce=>E(ce.target.value),required:!0,placeholder:"Re-enter your password"})]}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Creating...":"Create Account"}),g.jsx(rt,{variant:"secondary",onClick:()=>{f("login"),ae(""),Te("")},className:"w-full mt-2",children:"Back to Login"})]}):g.jsx(g.Fragment,{children:te===1?g.jsxs("form",{onSubmit:K,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:"Admin Login"}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(It,{label:"Email Address",id:"email",type:"email",value:e,onChange:ce=>t(ce.target.value),required:!0,placeholder:"e.g., admin@exam.com"}),g.jsx(It,{label:"Password",id:"password",type:"password",value:r,onChange:ce=>n(ce.target.value),required:!0,placeholder:"Enter your password"})]}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Loading...":"Continue"}),g.jsxs("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400 mt-4",children:["Need an admin account?"," ",g.jsx("button",{type:"button",onClick:()=>{f("register"),ae("")},className:"font-semibold text-violet-600 hover:text-violet-500 dark:text-violet-400 dark:hover:text-violet-300 focus:outline-none",children:"Create one"})]})]}):g.jsxs("form",{onSubmit:P,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-2",children:"2-Step Verification"}),g.jsxs("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:['An OTP has been "sent" to your email. ',g.jsx("br",{}),"(Hint: use ",g.jsx("strong",{children:"123456"}),")"]}),g.jsx("div",{className:"space-y-4",children:g.jsx(It,{label:"One-Time Password",id:"otp",type:"text",value:G,onChange:ce=>R(ce.target.value),required:!0,placeholder:"Enter 6-digit code"})}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Verifying...":"Verify & Login"}),g.jsx(rt,{variant:"secondary",onClick:()=>{ne(1),ae("")},className:"w-full mt-2",children:"Back"})]})}),Ae=()=>u==="register"?g.jsxs("form",{onSubmit:Z,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:"Create Teacher Account"}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(It,{label:"Full Name",id:"teacherName",type:"text",value:d,onChange:ce=>m(ce.target.value),required:!0,placeholder:"e.g., Dr. Evelyn Reed"}),g.jsx(It,{label:"Email Address",id:"email",type:"email",value:e,onChange:ce=>t(ce.target.value),required:!0,placeholder:"e.g., teacher@exam.com"}),g.jsx(It,{label:"Admin ID or Institution Name",id:"adminIdentifier",type:"text",value:F,onChange:ce=>S(ce.target.value),required:!0,placeholder:"Enter your institution's name or admin ID"}),g.jsx(It,{label:"Password",id:"teacherPassword",type:"password",value:x,onChange:ce=>y(ce.target.value),required:!0,placeholder:"Minimum 6 characters"}),g.jsx(It,{label:"Confirm Password",id:"confirmPassword",type:"password",value:C,onChange:ce=>E(ce.target.value),required:!0,placeholder:"Re-enter your password"}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 text-center",children:"An administrator will need to grant you access after creation."})]}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Creating...":"Create Account"}),g.jsx(rt,{variant:"secondary",onClick:()=>{f("login"),ae(""),Te("")},className:"w-full mt-2",children:"Back to Login"})]}):g.jsx(g.Fragment,{children:te===1?g.jsxs("form",{onSubmit:K,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:"Teacher Login"}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(It,{label:"Email Address",id:"email",type:"email",value:e,onChange:ce=>t(ce.target.value),required:!0,placeholder:"e.g., teacher1@exam.com"}),g.jsx(It,{label:"Password",id:"password",type:"password",value:r,onChange:ce=>n(ce.target.value),required:!0,placeholder:"Enter your password"})]}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Loading...":"Continue"}),g.jsxs("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400 mt-4",children:["Don't have an account?"," ",g.jsx("button",{type:"button",onClick:()=>{f("register"),ae("")},className:"font-semibold text-violet-600 hover:text-violet-500 dark:text-violet-400 dark:hover:text-violet-300 focus:outline-none",children:"Create one"})]})]}):g.jsxs("form",{onSubmit:P,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-2",children:"2-Step Verification"}),g.jsxs("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:['An OTP has been "sent" to your email. ',g.jsx("br",{}),"(Hint: use ",g.jsx("strong",{children:"123456"}),")"]}),g.jsx("div",{className:"space-y-4",children:g.jsx(It,{label:"One-Time Password",id:"otp",type:"text",value:G,onChange:ce=>R(ce.target.value),required:!0,placeholder:"Enter 6-digit code"})}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Verifying...":"Verify & Login"}),g.jsx(rt,{variant:"secondary",onClick:()=>{ne(1),ae("")},className:"w-full mt-2",children:"Back"})]})});return g.jsxs("div",{className:"min-h-screen flex flex-col justify-center items-center p-4 relative",children:[g.jsx("div",{className:"absolute top-4 right-4",children:g.jsx(mS,{})}),g.jsxs("div",{className:"text-center mb-8 flex flex-col items-center gap-4",children:[g.jsx(gS,{className:"h-16 w-16"}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-4xl font-bold text-violet-700 dark:text-violet-400",children:"Smart Exam Planner"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"Please log in to access your dashboard."})]})]}),g.jsxs(zt,{className:"w-full max-w-md",children:[g.jsxs("div",{className:"flex justify-center border-b border-slate-200 dark:border-slate-700 mb-6",children:[g.jsx("button",{onClick:()=>Ce("admin"),className:`px-4 py-2 text-sm font-semibold transition-colors ${l==="admin"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:"Admin"}),g.jsx("button",{onClick:()=>Ce("teacher"),className:`px-4 py-2 text-sm font-semibold transition-colors ${l==="teacher"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:"Teacher"}),g.jsx("button",{onClick:()=>Ce("student"),className:`px-4 py-2 text-sm font-semibold transition-colors ${l==="student"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:"Student"})]}),Se&&g.jsx("p",{className:"text-green-600 bg-green-50 dark:text-green-400 dark:bg-green-500/10 p-3 rounded-md text-sm mb-4 text-center",children:Se}),ee&&g.jsx("p",{className:"text-red-600 bg-red-100 dark:text-red-300 dark:bg-red-500/20 p-3 rounded-md text-sm mb-4 text-center",children:ee}),l==="admin"&&he(),l==="teacher"&&Ae(),l==="student"&&g.jsxs("form",{onSubmit:le,children:[g.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:"Student Login"}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"institution-select",className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Institution / Organization"}),g.jsxs("select",{id:"institution-select",value:Q,onChange:ce=>U(ce.target.value),required:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200",children:[g.jsx("option",{value:"",disabled:!0,children:"Select your institution"}),I.map(ce=>g.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),g.jsx(It,{label:"Register Number",id:"registerNumber",type:"text",value:A,onChange:ce=>s(ce.target.value),required:!0,placeholder:"e.g., 101001"})]}),g.jsx(rt,{type:"submit",className:"w-full mt-6",disabled:q||!Q,children:q?"Logging In...":"Login"})]})]})]})},vH=({user:e,isOpen:t,onClose:r})=>{const[n,A]=W.useState(""),[s,l]=W.useState(!1);if(W.useEffect(()=>{t&&(l(!0),e.role===xt.ADMIN?(A(e.institutionName||"N/A"),l(!1)):e.role===xt.TEACHER&&e.adminId?Td(e.adminId).then(u=>{A(u?u.institutionName||"N/A":"Institution not found"),l(!1)}):(A("N/A"),l(!1)))},[e,t]),!t)return null;const o=u=>{switch(u){case xt.ADMIN:return"Admin";case xt.TEACHER:return"Teacher";case xt.STUDENT:return"Student";default:return""}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:r,children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md",onClick:u=>u.stopPropagation(),children:[g.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-slate-800 dark:text-slate-200",children:"User Profile"}),g.jsx(zt,{children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Username"}),g.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:e.name})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Email ID"}),g.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300 break-all",children:e.email})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Institution / Organization"}),g.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:s?"Loading...":n})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Role"}),g.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:o(e.role)})]})]})}),g.jsx("div",{className:"mt-6 text-right",children:g.jsx(rt,{onClick:r,variant:"secondary",children:"Close"})})]})})},wH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),yH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),za=()=>{const{user:e,logout:t}=zi(),r=md(),[n,A]=W.useState(!1),s=()=>{t(),r("/login")},l=o=>{switch(o){case xt.ADMIN:return"Admin";case xt.TEACHER:return"Teacher";case xt.STUDENT:return"Student";default:return""}};return g.jsxs(g.Fragment,{children:[g.jsx("header",{className:"sticky top-0 z-50 w-full bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm shadow-md dark:shadow-none dark:border-b dark:border-slate-700",children:g.jsxs("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(gS,{className:"h-9 w-9"}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-violet-700 dark:text-violet-400",children:"Smart Exam Planner"}),e&&g.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Welcome, ",e.name," (",l(e.role),")"]})]})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[e&&g.jsxs(g.Fragment,{children:[(e.role===xt.ADMIN||e.role===xt.TEACHER)&&g.jsxs("button",{onClick:()=>A(!0),className:"hidden sm:flex items-center text-slate-600 hover:text-violet-700 dark:text-slate-300 dark:hover:text-violet-400 transition","aria-label":"View Profile",children:[g.jsx(yH,{}),g.jsx("span",{className:"hidden lg:inline",children:"Profile"})]}),g.jsxs("button",{onClick:s,className:"flex items-center text-slate-600 hover:text-violet-700 dark:text-slate-300 dark:hover:text-violet-400 transition","aria-label":"Logout",children:[g.jsx(wH,{}),g.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}),g.jsx(mS,{})]})]})}),e&&(e.role===xt.ADMIN||e.role===xt.TEACHER)&&g.jsx(vH,{user:e,isOpen:n,onClose:()=>A(!1)})]})},Os=["bg-sky-200","bg-emerald-200","bg-amber-200","bg-violet-200","bg-rose-200","bg-cyan-200","bg-lime-200","bg-orange-200","bg-purple-200","bg-pink-200"],BH=e=>{switch(e){case"accessible":return{icon:g.jsx("span",{title:"Accessible Seating",children:""}),baseBg:"bg-blue-200 dark:bg-blue-600"};case"faculty":return{icon:g.jsx("span",{title:"Faculty/Invigilator Seat",children:""}),baseBg:"bg-yellow-200 dark:bg-yellow-600"};case"standard":default:return{icon:null,baseBg:"bg-slate-200 dark:bg-slate-600"}}},$c=({hall:e,plan:t,studentSets:r,highlightSeat:n,seatDimensions:A})=>{const s=t[e.id];if(!s)return g.jsxs("p",{children:["Seating plan for ",e.name," not available."]});const l=r.reduce((C,E,T)=>(C[E.id]=Os[T%Os.length],C),{}),o=s.reduce((C,E)=>Math.max(C,E.length),0),u=e.frontDirection||"top",f={top:"flex-col",bottom:"flex-col-reverse",left:"flex-row",right:"flex-row-reverse"},d=u==="left"||u==="right"?"w-10 flex-shrink-0 flex items-center justify-center py-4":"w-full py-2",m={top:"mb-4",bottom:"mt-4",left:"mr-4",right:"ml-4"},x=u==="left"||u==="right",y=A||{width:80,height:60,fontSize:14};return g.jsxs("div",{className:"w-full",children:[g.jsx("h3",{className:"text-xl font-bold mb-6 text-center text-slate-700 dark:text-slate-300",children:e.name}),g.jsxs("div",{className:`flex ${f[u]} items-stretch justify-center w-full`,children:[g.jsx("div",{className:`bg-slate-200 dark:bg-slate-700 rounded-md text-sm font-bold text-slate-600 dark:text-slate-300 shadow-inner flex items-center justify-center ${d} ${m[u]}`,children:g.jsx("span",{style:{writingMode:x?"vertical-rl":"horizontal-tb",transform:x?"rotate(180deg)":"none"},children:"FRONT OF HALL"})}),g.jsx("div",{className:"overflow-x-auto bg-slate-100 dark:bg-slate-800 p-6 rounded-xl flex-grow border border-slate-200 dark:border-slate-700",children:g.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${o}, minmax(${y.width/16}rem, 1fr))`},children:s.map((C,E)=>C.map((T,_)=>{if(!T)return g.jsx("div",{style:{height:`${y.height/16}rem`}},`empty-${E}-${_}`);const F=BH(T.type),S=T.student?l[T.student.setId]:F.baseBg,M=n&&T.row===n.row&&T.col===n.col?"ring-4 ring-offset-2 ring-violet-500 dark:ring-violet-400 z-10":"border border-slate-300 dark:border-slate-500 shadow-sm";let Q=F.icon;return T.student&&(Q=T.student.id),g.jsx("div",{title:T.student?`Seat: R${T.row+1}C${T.col+1} - Student ID: ${T.student.id}`:`${T.type} Seat: R${T.row+1}C${T.col+1}`,style:{height:`${y.height/16}rem`,fontSize:`${y.fontSize/16}rem`},className:`w-full rounded-lg flex items-center justify-center text-center font-bold text-slate-800 dark:text-slate-900 transition-all break-all px-2 py-1 ${S} ${M}`,children:Q},`${T.id}-${E}-${_}`)}).concat(Array.from({length:o-C.length}).map((T,_)=>g.jsx("div",{style:{height:`${y.height/16}rem`}},`pad-${E}-${C.length+_}`))))})})]}),g.jsx("div",{className:"mt-6 flex flex-wrap gap-4 justify-center",children:r.map((C,E)=>g.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 px-3 py-1.5 rounded-full border border-slate-200 dark:border-slate-700 shadow-sm",children:[g.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${Os[E%Os.length]}`}),g.jsxs("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:["Set: ",C.subject]})]},C.id))})]})},NC=[{type:"standard",label:"Standard",style:"bg-slate-300 dark:bg-slate-600",icon:null},{type:"accessible",label:"Accessible",style:"bg-blue-300 dark:bg-blue-600",icon:g.jsx("span",{title:"Accessible Seating",children:""})},{type:"faculty",label:"Faculty",style:"bg-yellow-300 dark:bg-yellow-600",icon:g.jsx("span",{title:"Faculty/Invigilator Seat",children:""})}],CH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),EH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M6.672 1.911a1 1 0 10-1.932.524l1.822 6.723L1.94 11.23a1 1 0 00.72 1.916h3.417l2.128 6.384a1 1 0 001.902-.619l-1.077-3.23 3.616 1.808a1 1 0 001.378-.868l1.37-7.533a1 1 0 00-1.37-1.171l-7.353 3.16.822-6.166z",clipRule:"evenodd"})}),TH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),SH=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),up=({isOpen:e,onClose:t,onSave:r,initialLayout:n,initialName:A,isTemplateCreationMode:s})=>{const[l,o]=W.useState(n||[]),[u,f]=W.useState(10),[d,m]=W.useState(10),[x,y]=W.useState(null),[C,E]=W.useState(""),[T,_]=W.useState(""),[F,S]=W.useState(!1),[I,M]=W.useState(new Set),[Q,U]=W.useState(!1),[G,R]=W.useState([]),[te,ne]=W.useState(-1),ee=W.useRef(null);W.useEffect(()=>{let Ae=[],ce=10,L=10;if(n&&n.length>0){Ae=n;const Je=Math.max(9,...n.map(qe=>qe.row)),et=Math.max(9,...n.map(qe=>qe.col));ce=Je+1,L=et+1}o(Ae),f(ce),m(L),E(A||""),_(""),M(new Set),R([{seats:Ae,rows:ce,cols:L}]),ne(0)},[n,A,e]);const ae=W.useCallback((Ae,ce,L)=>{R(je=>[...je.slice(0,te+1),{seats:Ae,rows:ce,cols:L}]),ne(je=>je+1),o(Ae),f(ce),m(L)},[te]),Se=W.useCallback(()=>{if(te>0){const Ae=te-1,ce=G[Ae];o(ce.seats),f(ce.rows),m(ce.cols),ne(Ae),M(new Set)}},[G,te]),Te=W.useCallback(()=>{if(te<G.length-1){const Ae=te+1,ce=G[Ae];o(ce.seats),f(ce.rows),m(ce.cols),ne(Ae),M(new Set)}},[G,te]);W.useEffect(()=>{const Ae=ce=>{e&&((ce.metaKey||ce.ctrlKey)&&ce.key==="z"?(ce.preventDefault(),ce.shiftKey?Te():Se()):(ce.metaKey||ce.ctrlKey)&&ce.key==="y"&&(ce.preventDefault(),Te()))};return window.addEventListener("keydown",Ae),()=>window.removeEventListener("keydown",Ae)},[e,Se,Te]);const q=(Ae,ce)=>{Ae.stopPropagation();const L=new Set(I);Ae.shiftKey||Q?(L.has(ce)?L.delete(ce):L.add(ce),M(L)):I.has(ce)?M(new Set([ce])):M(new Set([ce]))},oe=()=>{M(new Set)},Re=(Ae,ce,L)=>{if(Ae.preventDefault(),x){if("type"in x){if(l.some(et=>et.row===ce&&et.col===L))return;const je={id:`seat-${Date.now()}-${Math.random()}`,row:ce,col:L,type:x.type},Je=[...l,je];ae(Je,u,d),M(new Set([je.id]))}else if("id"in x){const je=l.find(ct=>ct.id===x.id);if(!je)return;const Je=ce-je.row,et=L-je.col;if(l.filter(ct=>I.has(ct.id)).every(ct=>{const Kt=ct.row+Je,lr=ct.col+et;return!(Kt<0||Kt>=u||lr<0||lr>=d||l.find(Ct=>Ct.row===Kt&&Ct.col===lr&&!I.has(Ct.id)))})){const ct=l.map(Kt=>I.has(Kt.id)?{...Kt,row:Kt.row+Je,col:Kt.col+et}:Kt);ae(ct,u,d)}}}y(null),Ae.currentTarget.classList.remove("bg-violet-200","dark:bg-violet-700/50")},ie=(Ae,ce)=>{y({type:ce}),Ae.dataTransfer.effectAllowed="copy",M(new Set)},Me=(Ae,ce)=>{I.has(ce.id)||M(new Set([ce.id])),y({id:ce.id}),Ae.dataTransfer.effectAllowed="move"},X=Ae=>{Ae.preventDefault(),Ae.currentTarget.classList.add("bg-violet-200","dark:bg-violet-700/50")},k=Ae=>{Ae.currentTarget.classList.remove("bg-violet-200","dark:bg-violet-700/50")},K=Ae=>{if(Ae.preventDefault(),x&&"id"in x){const ce=l.filter(L=>!I.has(L.id));ae(ce,u,d),M(new Set)}y(null),Ae.currentTarget.classList.remove("bg-red-500/50")},P=()=>{M(new Set(l.map(Ae=>Ae.id)))},z=()=>{M(new Set)},Z=()=>{if(s){if(!C.trim()){_("Template name is required.");return}r({layout:l,name:C})}else r({layout:l})},le=(Ae,ce)=>{const L=Math.max(1,Math.min(50,ce));let je=l;Ae==="rows"?(je=l.filter(Je=>Je.row<L),ae(je,L,d)):(je=l.filter(Je=>Je.col<L),ae(je,u,L))},Ce=async Ae=>{if(Ae.target.files&&Ae.target.files[0]){S(!0);const ce=Ae.target.files[0],L=new FileReader;L.onloadend=async()=>{try{const je=L.result.split(",")[1],Je=ce.type,et=await qL(je,Je);et?ae(et.layout,et.rows,et.cols):alert("Could not analyze image. Please try again with a clearer image of the seating arrangement.")}catch(je){console.error(je),alert("An error occurred during image processing.")}finally{S(!1),ee.current&&(ee.current.value="")}},L.readAsDataURL(ce)}};if(!e)return null;const he=new Map(l.map(Ae=>[`${Ae.row}-${Ae.col}`,Ae]));return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",onClick:t,children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full h-full max-w-7xl max-h-[95vh] flex flex-col",onClick:Ae=>Ae.stopPropagation(),children:[g.jsxs("header",{className:"p-4 border-b dark:border-slate-700 flex justify-between items-center",children:[g.jsx("h2",{className:"text-xl font-bold",children:s?"Create Hall Template":"Hall Layout Editor"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("div",{className:"flex gap-1 mr-4 border-r dark:border-slate-700 pr-4",children:[g.jsx("button",{onClick:Se,disabled:te<=0,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Undo (Ctrl+Z)",children:g.jsx(TH,{})}),g.jsx("button",{onClick:Te,disabled:te>=G.length-1,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Redo (Ctrl+Y)",children:g.jsx(SH,{})})]}),g.jsx(rt,{onClick:t,variant:"secondary",children:"Close"})]})]}),g.jsxs("div",{className:"flex-grow flex overflow-hidden relative",children:[F&&g.jsxs("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-900/80 z-50 flex flex-col items-center justify-center",children:[g.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600 mb-4"}),g.jsx("p",{className:"text-violet-700 dark:text-violet-400 font-semibold",children:"AI is analyzing your image to generate the layout..."})]}),g.jsxs("aside",{className:"w-64 p-4 border-r dark:border-slate-700 flex flex-col gap-4 bg-slate-50 dark:bg-slate-800/50 overflow-y-auto",children:[g.jsxs("div",{className:"mb-4",children:[g.jsx("h3",{className:"font-semibold mb-2",children:"Tools"}),g.jsx("input",{type:"file",ref:ee,onChange:Ce,accept:"image/*",className:"hidden"}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("button",{onClick:()=>{var Ae;return(Ae=ee.current)==null?void 0:Ae.click()},className:"w-full flex items-center justify-center gap-2 p-2 bg-violet-100 text-violet-700 dark:bg-violet-500/20 dark:text-violet-300 hover:bg-violet-200 dark:hover:bg-violet-500/30 rounded-md transition-colors text-sm font-medium",disabled:F,children:[g.jsx(CH,{})," Import from Image"]}),g.jsxs("button",{onClick:()=>U(!Q),className:`w-full flex items-center justify-center gap-2 p-2 rounded-md transition-colors text-sm font-medium ${Q?"bg-violet-600 text-white":"bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-600"}`,children:[g.jsx(EH,{})," ",Q?"Multi-Select On":"Multi-Select Off"]})]})]}),g.jsxs("div",{className:"mb-2",children:[g.jsx("h3",{className:"font-semibold",children:"Selection"}),g.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:[I.size," seat",I.size!==1?"s":""," selected"]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:P,className:"flex-1 text-xs bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 px-2 py-1 rounded",children:"Select All"}),g.jsx("button",{onClick:z,className:"flex-1 text-xs bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 px-2 py-1 rounded",children:"Clear"})]})]}),g.jsx("h3",{className:"font-semibold",children:"Seat Palette"}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Drag a seat type onto the grid."}),NC.map(({type:Ae,label:ce,style:L,icon:je})=>g.jsxs("div",{draggable:!0,onDragStart:Je=>ie(Je,Ae),className:`p-2 rounded-md cursor-grab flex items-center gap-2 ${L}`,children:[g.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center font-bold text-slate-800 dark:text-slate-900 border border-slate-400 dark:border-slate-500",children:je}),g.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-slate-200",children:ce})]},Ae)),g.jsx("div",{className:"mt-auto pt-4 border-t dark:border-slate-700",children:g.jsxs("div",{onDragOver:Ae=>{Ae.preventDefault(),Ae.currentTarget.classList.add("bg-red-500/50")},onDragLeave:Ae=>Ae.currentTarget.classList.remove("bg-red-500/50"),onDrop:K,className:"border-2 border-dashed border-red-500 rounded-lg p-4 text-center text-red-500 transition-colors",children:[g.jsx("p",{className:"font-bold",children:"Trash"}),g.jsx("p",{className:"text-xs",children:"Drag seat(s) here to remove."})]})})]}),g.jsxs("main",{className:"flex-grow flex flex-col p-4 overflow-auto bg-white dark:bg-slate-900",onClick:oe,children:[s&&g.jsxs("div",{className:"mb-4",children:[g.jsx(It,{label:"Template Name",id:"template-name",value:C,onChange:Ae=>{E(Ae.target.value),_("")},placeholder:"e.g., Main Auditorium",required:!0,onClick:Ae=>Ae.stopPropagation()}),T&&g.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:T})]}),g.jsxs("div",{className:"flex items-center gap-4 mb-4",onClick:Ae=>Ae.stopPropagation(),children:[g.jsx(It,{label:"Rows",type:"number",value:u,onChange:Ae=>le("rows",parseInt(Ae.target.value)||0),containerClassName:"w-24"}),g.jsx(It,{label:"Columns",type:"number",value:d,onChange:Ae=>le("cols",parseInt(Ae.target.value)||0),containerClassName:"w-24"}),g.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Total Seats: ",g.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:l.length})]}),g.jsxs("div",{className:"ml-auto text-xs text-slate-400",children:["Tip: Hold ",g.jsx("b",{children:"Shift"})," to select multiple seats. Use ",g.jsx("b",{children:"Ctrl+Z"})," to Undo."]})]}),g.jsx("div",{className:"flex-grow overflow-auto p-2 bg-slate-100 dark:bg-slate-800/50 rounded-md border dark:border-slate-700",children:g.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${d}, 2.5rem)`,gridTemplateRows:`repeat(${u}, 2.5rem)`},children:Array.from({length:u*d}).map((Ae,ce)=>{const L=Math.floor(ce/d),je=ce%d,Je=he.get(`${L}-${je}`);if(Je){const et=Je,qe=NC.find(ct=>ct.type===et.type),De=I.has(et.id);return g.jsxs("div",{draggable:!0,onDragStart:ct=>Me(ct,et),onClick:ct=>q(ct,et.id),className:`
                                                    w-10 h-10 rounded cursor-move flex items-center justify-center 
                                                    font-bold text-slate-800 dark:text-slate-900 border 
                                                    ${qe.style}
                                                    ${De?"ring-4 ring-offset-2 ring-violet-500 dark:ring-violet-400 z-10":"border-slate-400 dark:border-slate-500 hover:brightness-110"}
                                                `,title:`${qe.label} Seat (R${L+1}, C${je+1})`,children:[De&&g.jsx("div",{className:"absolute top-0 right-0 -mt-1 -mr-1 w-3 h-3 bg-violet-600 rounded-full border border-white"}),qe.icon]},et.id)}return g.jsx("div",{onDrop:et=>Re(et,L,je),onDragOver:X,onDragLeave:k,className:"w-10 h-10 bg-slate-200 dark:bg-slate-700/30 rounded-sm transition-colors"},`cell-${L}-${je}`)})})})]})]}),g.jsx("footer",{className:"p-4 border-t dark:border-slate-700 text-right",children:g.jsxs(rt,{onClick:Z,children:["Save ",s?"Template":"Layout"]})})]})})};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fp=function(e,t){return fp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var A in n)Object.prototype.hasOwnProperty.call(n,A)&&(r[A]=n[A])},fp(e,t)};function ia(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");fp(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var dp=function(){return dp=Object.assign||function(t){for(var r,n=1,A=arguments.length;n<A;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},dp.apply(this,arguments)};function jn(e,t,r,n){function A(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(d){try{f(n.next(d))}catch(m){l(m)}}function u(d){try{f(n.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):A(d.value).then(o,u)}f((n=n.apply(e,[])).next())})}function Un(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,A,s,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(f){return function(d){return u([f,d])}}function u(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,A&&(s=f[0]&2?A.return:f[0]?A.throw||((s=A.return)&&s.call(A),0):A.next)&&!(s=s.call(A,f[1])).done)return s;switch(A=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,A=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],A=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function K0(e,t,r){if(arguments.length===2)for(var n=0,A=t.length,s;n<A;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||t)}var ts=(function(){function e(t,r,n,A){this.left=t,this.top=r,this.width=n,this.height=A}return e.prototype.add=function(t,r,n,A){return new e(this.left+t,this.top+r,this.width+n,this.height+A)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(A){return A.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e})(),Sd=function(e,t){return ts.fromClientRect(e,t.getBoundingClientRect())},_H=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),A=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new ts(0,0,n,A)},_d=function(e){for(var t=[],r=0,n=e.length;r<n;){var A=e.charCodeAt(r++);if(A>=55296&&A<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((A&1023)<<10)+(s&1023)+65536):(t.push(A),r--)}else t.push(A)}return t},jr=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],A=-1,s="";++A<r;){var l=e[A];l<=65535?n.push(l):(l-=65536,n.push((l>>10)+55296,l%1024+56320)),(A+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},IC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bH=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var j0=0;j0<IC.length;j0++)bH[IC.charCodeAt(j0)]=j0;var QC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var z0=0;z0<QC.length;z0++)Tc[QC.charCodeAt(z0)]=z0;var FH=function(e){var t=e.length*.75,r=e.length,n,A=0,s,l,o,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<r;n+=4)s=Tc[e.charCodeAt(n)],l=Tc[e.charCodeAt(n+1)],o=Tc[e.charCodeAt(n+2)],u=Tc[e.charCodeAt(n+3)],d[A++]=s<<2|l>>4,d[A++]=(l&15)<<4|o>>2,d[A++]=(o&3)<<6|u&63;return f},UH=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},kH=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Ni=5,ux=11,sm=2,NH=ux-Ni,pS=65536>>Ni,IH=1<<Ni,im=IH-1,QH=1024>>Ni,RH=pS+QH,DH=RH,MH=32,LH=DH+MH,HH=65536>>ux,OH=1<<NH,PH=OH-1,RC=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},GH=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},VH=function(e,t){var r=FH(e),n=Array.isArray(r)?kH(r):new Uint32Array(r),A=Array.isArray(r)?UH(r):new Uint16Array(r),s=24,l=RC(A,s/2,n[4]/2),o=n[5]===2?RC(A,(s+n[4])/2):GH(n,Math.ceil((s+n[4])/4));return new KH(n[0],n[1],n[2],n[3],l,o)},KH=(function(){function e(t,r,n,A,s,l){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=A,this.index=s,this.data=l}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Ni],r=(r<<sm)+(t&im),this.data[r];if(t<=65535)return r=this.index[pS+(t-55296>>Ni)],r=(r<<sm)+(t&im),this.data[r];if(t<this.highStart)return r=LH-HH+(t>>ux),r=this.index[r],r+=t>>Ni&PH,r=this.index[r],r=(r<<sm)+(t&im),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),DC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jH=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var X0=0;X0<DC.length;X0++)jH[DC.charCodeAt(X0)]=X0;var zH="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",MC=50,XH=1,xS=2,vS=3,JH=4,YH=5,LC=7,wS=8,HC=9,Ps=10,hp=11,OC=12,gp=13,WH=14,Sc=15,mp=16,J0=17,pc=18,qH=19,PC=20,pp=21,xc=22,lm=23,Rl=24,hA=25,_c=26,bc=27,Dl=28,$H=29,bi=30,ZH=31,Y0=32,W0=33,xp=34,vp=35,wp=36,Zc=37,yp=38,Rf=39,Df=40,om=41,yS=42,e6=43,t6=[9001,65288],BS="!",Pt="",q0="",Bp=VH(zH),Ka=[bi,wp],Cp=[XH,xS,vS,YH],CS=[Ps,wS],GC=[bc,_c],r6=Cp.concat(CS),VC=[yp,Rf,Df,xp,vp],n6=[Sc,gp],A6=function(e,t){t===void 0&&(t="strict");var r=[],n=[],A=[];return e.forEach(function(s,l){var o=Bp.get(s);if(o>MC?(A.push(!0),o-=MC):A.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(l),r.push(mp);if(o===JH||o===hp){if(l===0)return n.push(l),r.push(bi);var u=r[l-1];return r6.indexOf(u)===-1?(n.push(n[l-1]),r.push(u)):(n.push(l),r.push(bi))}if(n.push(l),o===ZH)return r.push(t==="strict"?pp:Zc);if(o===yS||o===$H)return r.push(bi);if(o===e6)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(Zc):r.push(bi);r.push(o)}),[n,r,A]},cm=function(e,t,r,n){var A=n[r];if(Array.isArray(e)?e.indexOf(A)!==-1:e===A)for(var s=r;s<=n.length;){s++;var l=n[s];if(l===t)return!0;if(l!==Ps)break}if(A===Ps)for(var s=r;s>0;){s--;var o=n[s];if(Array.isArray(e)?e.indexOf(o)!==-1:e===o)for(var u=r;u<=n.length;){u++;var l=n[u];if(l===t)return!0;if(l!==Ps)break}if(o!==Ps)break}return!1},KC=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===Ps)r--;else return n}return 0},a6=function(e,t,r,n,A){if(r[n]===0)return Pt;var s=n-1;if(Array.isArray(A)&&A[s]===!0)return Pt;var l=s-1,o=s+1,u=t[s],f=l>=0?t[l]:0,d=t[o];if(u===xS&&d===vS)return Pt;if(Cp.indexOf(u)!==-1)return BS;if(Cp.indexOf(d)!==-1||CS.indexOf(d)!==-1)return Pt;if(KC(s,t)===wS)return q0;if(Bp.get(e[s])===hp||(u===Y0||u===W0)&&Bp.get(e[o])===hp||u===LC||d===LC||u===HC||[Ps,gp,Sc].indexOf(u)===-1&&d===HC||[J0,pc,qH,Rl,Dl].indexOf(d)!==-1||KC(s,t)===xc||cm(lm,xc,s,t)||cm([J0,pc],pp,s,t)||cm(OC,OC,s,t))return Pt;if(u===Ps)return q0;if(u===lm||d===lm)return Pt;if(d===mp||u===mp)return q0;if([gp,Sc,pp].indexOf(d)!==-1||u===WH||f===wp&&n6.indexOf(u)!==-1||u===Dl&&d===wp||d===PC||Ka.indexOf(d)!==-1&&u===hA||Ka.indexOf(u)!==-1&&d===hA||u===bc&&[Zc,Y0,W0].indexOf(d)!==-1||[Zc,Y0,W0].indexOf(u)!==-1&&d===_c||Ka.indexOf(u)!==-1&&GC.indexOf(d)!==-1||GC.indexOf(u)!==-1&&Ka.indexOf(d)!==-1||[bc,_c].indexOf(u)!==-1&&(d===hA||[xc,Sc].indexOf(d)!==-1&&t[o+1]===hA)||[xc,Sc].indexOf(u)!==-1&&d===hA||u===hA&&[hA,Dl,Rl].indexOf(d)!==-1)return Pt;if([hA,Dl,Rl,J0,pc].indexOf(d)!==-1)for(var m=s;m>=0;){var x=t[m];if(x===hA)return Pt;if([Dl,Rl].indexOf(x)!==-1)m--;else break}if([bc,_c].indexOf(d)!==-1)for(var m=[J0,pc].indexOf(u)!==-1?l:s;m>=0;){var x=t[m];if(x===hA)return Pt;if([Dl,Rl].indexOf(x)!==-1)m--;else break}if(yp===u&&[yp,Rf,xp,vp].indexOf(d)!==-1||[Rf,xp].indexOf(u)!==-1&&[Rf,Df].indexOf(d)!==-1||[Df,vp].indexOf(u)!==-1&&d===Df||VC.indexOf(u)!==-1&&[PC,_c].indexOf(d)!==-1||VC.indexOf(d)!==-1&&u===bc||Ka.indexOf(u)!==-1&&Ka.indexOf(d)!==-1||u===Rl&&Ka.indexOf(d)!==-1||Ka.concat(hA).indexOf(u)!==-1&&d===xc&&t6.indexOf(e[o])===-1||Ka.concat(hA).indexOf(d)!==-1&&u===pc)return Pt;if(u===om&&d===om){for(var y=r[s],C=1;y>0&&(y--,t[y]===om);)C++;if(C%2!==0)return Pt}return u===Y0&&d===W0?Pt:q0},s6=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=A6(e,t.lineBreak),n=r[0],A=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(A=A.map(function(o){return[hA,bi,yS].indexOf(o)!==-1?Zc:o}));var l=t.wordBreak==="keep-all"?s.map(function(o,u){return o&&e[u]>=19968&&e[u]<=40959}):void 0;return[n,A,l]},i6=(function(){function e(t,r,n,A){this.codePoints=t,this.required=r===BS,this.start=n,this.end=A}return e.prototype.slice=function(){return jr.apply(void 0,this.codePoints.slice(this.start,this.end))},e})(),l6=function(e,t){var r=_d(e),n=s6(r,t),A=n[0],s=n[1],l=n[2],o=r.length,u=0,f=0;return{next:function(){if(f>=o)return{done:!0,value:null};for(var d=Pt;f<o&&(d=a6(r,s,A,++f,l))===Pt;);if(d!==Pt||f===o){var m=new i6(r,d,u,f);return u=f,{value:m,done:!1}}return{done:!0,value:null}}}},o6=1,c6=2,xu=4,jC=8,zf=10,zC=47,Dc=92,u6=9,f6=32,$0=34,vc=61,d6=35,h6=36,g6=37,Z0=39,ef=40,wc=41,m6=95,AA=45,p6=33,x6=60,v6=62,w6=64,y6=91,B6=93,C6=61,E6=123,tf=63,T6=125,XC=124,S6=126,_6=128,JC=65533,um=42,Ui=43,b6=44,F6=58,U6=59,eu=46,k6=0,N6=8,I6=11,Q6=14,R6=31,D6=127,da=-1,ES=48,TS=97,SS=101,M6=102,L6=117,H6=122,_S=65,bS=69,FS=70,O6=85,P6=90,In=function(e){return e>=ES&&e<=57},G6=function(e){return e>=55296&&e<=57343},Ml=function(e){return In(e)||e>=_S&&e<=FS||e>=TS&&e<=M6},V6=function(e){return e>=TS&&e<=H6},K6=function(e){return e>=_S&&e<=P6},j6=function(e){return V6(e)||K6(e)},z6=function(e){return e>=_6},rf=function(e){return e===zf||e===u6||e===f6},Xf=function(e){return j6(e)||z6(e)||e===m6},YC=function(e){return Xf(e)||In(e)||e===AA},X6=function(e){return e>=k6&&e<=N6||e===I6||e>=Q6&&e<=R6||e===D6},Hs=function(e,t){return e!==Dc?!1:t!==zf},nf=function(e,t,r){return e===AA?Xf(t)||Hs(t,r):Xf(e)?!0:!!(e===Dc&&Hs(e,t))},fm=function(e,t,r){return e===Ui||e===AA?In(t)?!0:t===eu&&In(r):In(e===eu?t:e)},J6=function(e){var t=0,r=1;(e[t]===Ui||e[t]===AA)&&(e[t]===AA&&(r=-1),t++);for(var n=[];In(e[t]);)n.push(e[t++]);var A=n.length?parseInt(jr.apply(void 0,n),10):0;e[t]===eu&&t++;for(var s=[];In(e[t]);)s.push(e[t++]);var l=s.length,o=l?parseInt(jr.apply(void 0,s),10):0;(e[t]===bS||e[t]===SS)&&t++;var u=1;(e[t]===Ui||e[t]===AA)&&(e[t]===AA&&(u=-1),t++);for(var f=[];In(e[t]);)f.push(e[t++]);var d=f.length?parseInt(jr.apply(void 0,f),10):0;return r*(A+o*Math.pow(10,-l))*Math.pow(10,u*d)},Y6={type:2},W6={type:3},q6={type:4},$6={type:13},Z6={type:8},e8={type:21},t8={type:9},r8={type:10},n8={type:11},A8={type:12},a8={type:14},Af={type:23},s8={type:1},i8={type:25},l8={type:24},o8={type:26},c8={type:27},u8={type:28},f8={type:29},d8={type:31},Ep={type:32},US=(function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(_d(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Ep;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case $0:return this.consumeStringToken($0);case d6:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),A=this.peekCodePoint(2);if(YC(r)||Hs(n,A)){var s=nf(r,n,A)?c6:o6,l=this.consumeName();return{type:5,value:l,flags:s}}break;case h6:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),$6;break;case Z0:return this.consumeStringToken(Z0);case ef:return Y6;case wc:return W6;case um:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),a8;break;case Ui:if(fm(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case b6:return q6;case AA:var o=t,u=this.peekCodePoint(0),f=this.peekCodePoint(1);if(fm(o,u,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(nf(o,u,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(u===AA&&f===v6)return this.consumeCodePoint(),this.consumeCodePoint(),l8;break;case eu:if(fm(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case zC:if(this.peekCodePoint(0)===um)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===um&&(d=this.consumeCodePoint(),d===zC))return this.consumeToken();if(d===da)return this.consumeToken()}break;case F6:return o8;case U6:return c8;case x6:if(this.peekCodePoint(0)===p6&&this.peekCodePoint(1)===AA&&this.peekCodePoint(2)===AA)return this.consumeCodePoint(),this.consumeCodePoint(),i8;break;case w6:var m=this.peekCodePoint(0),x=this.peekCodePoint(1),y=this.peekCodePoint(2);if(nf(m,x,y)){var l=this.consumeName();return{type:7,value:l}}break;case y6:return u8;case Dc:if(Hs(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case B6:return f8;case C6:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),Z6;break;case E6:return n8;case T6:return A8;case L6:case O6:var C=this.peekCodePoint(0),E=this.peekCodePoint(1);return C===Ui&&(Ml(E)||E===tf)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case XC:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),t8;if(this.peekCodePoint(0)===XC)return this.consumeCodePoint(),e8;break;case S6:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),r8;break;case da:return Ep}return rf(t)?(this.consumeWhiteSpace(),d8):In(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Xf(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:jr(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Ml(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===tf&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var A=parseInt(jr.apply(void 0,t.map(function(u){return u===tf?ES:u})),16),s=parseInt(jr.apply(void 0,t.map(function(u){return u===tf?FS:u})),16);return{type:30,start:A,end:s}}var l=parseInt(jr.apply(void 0,t),16);if(this.peekCodePoint(0)===AA&&Ml(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var o=[];Ml(r)&&o.length<6;)o.push(r),r=this.consumeCodePoint();var s=parseInt(jr.apply(void 0,o),16);return{type:30,start:l,end:s}}else return{type:30,start:l,end:l}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===ef?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===ef?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===da)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Z0||r===$0){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===da||this.peekCodePoint(0)===wc)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Af)}for(;;){var A=this.consumeCodePoint();if(A===da||A===wc)return{type:22,value:jr.apply(void 0,t)};if(rf(A))return this.consumeWhiteSpace(),this.peekCodePoint(0)===da||this.peekCodePoint(0)===wc?(this.consumeCodePoint(),{type:22,value:jr.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Af);if(A===$0||A===Z0||A===ef||X6(A))return this.consumeBadUrlRemnants(),Af;if(A===Dc)if(Hs(A,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Af;else t.push(A)}},e.prototype.consumeWhiteSpace=function(){for(;rf(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===wc||t===da)return;Hs(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var A=Math.min(r,t);n+=jr.apply(void 0,this._value.splice(0,A)),t-=A}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var A=this._value[n];if(A===da||A===void 0||A===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(A===zf)return this._value.splice(0,n),s8;if(A===Dc){var s=this._value[n+1];s!==da&&s!==void 0&&(s===zf?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):Hs(A,s)&&(r+=this.consumeStringSlice(n),r+=jr(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=xu,n=this.peekCodePoint(0);for((n===Ui||n===AA)&&t.push(this.consumeCodePoint());In(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var A=this.peekCodePoint(1);if(n===eu&&In(A))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=jC;In(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),A=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===bS||n===SS)&&((A===Ui||A===AA)&&In(s)||In(A)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=jC;In(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[J6(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],A=this.peekCodePoint(0),s=this.peekCodePoint(1),l=this.peekCodePoint(2);if(nf(A,s,l)){var o=this.consumeName();return{type:15,number:r,flags:n,unit:o}}return A===g6?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Ml(t)){for(var r=jr(t);Ml(this.peekCodePoint(0))&&r.length<6;)r+=jr(this.consumeCodePoint());rf(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||G6(n)||n>1114111?JC:n}return t===da?JC:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(YC(r))t+=jr(r);else if(Hs(r,this.peekCodePoint(0)))t+=jr(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e})(),kS=(function(){function e(t){this._tokens=t}return e.create=function(t){var r=new US;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||g8(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Ep:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e})(),vu=function(e){return e.type===15},xo=function(e){return e.type===17},mr=function(e){return e.type===20},h8=function(e){return e.type===0},Tp=function(e,t){return mr(e)&&e.value===t},NS=function(e){return e.type!==31},io=function(e){return e.type!==31&&e.type!==4},va=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},g8=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Js=function(e){return e.type===17||e.type===15},rn=function(e){return e.type===16||Js(e)},IS=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},En={type:17,number:0,flags:xu},fx={type:16,number:50,flags:xu},Gs={type:16,number:100,flags:xu},Fc=function(e,t,r){var n=e[0],A=e[1];return[Br(n,t),Br(typeof A<"u"?A:n,r)]},Br=function(e,t){if(e.type===16)return e.number/100*t;if(vu(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},QS="deg",RS="grad",DS="rad",MS="turn",bd={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case QS:return Math.PI*t.number/180;case RS:return Math.PI/200*t.number;case DS:return t.number;case MS:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},LS=function(e){return e.type===15&&(e.unit===QS||e.unit===RS||e.unit===DS||e.unit===MS)},HS=function(e){var t=e.filter(mr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[En,En];case"to top":case"bottom":return PA(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[En,Gs];case"to right":case"left":return PA(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Gs,Gs];case"to bottom":case"top":return PA(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Gs,En];case"to left":case"right":return PA(270)}return 0},PA=function(e){return Math.PI*e/180},zs={name:"color",parse:function(e,t){if(t.type===18){var r=m8[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),A=t.value.substring(1,2),s=t.value.substring(2,3);return Vs(parseInt(n+n,16),parseInt(A+A,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),A=t.value.substring(1,2),s=t.value.substring(2,3),l=t.value.substring(3,4);return Vs(parseInt(n+n,16),parseInt(A+A,16),parseInt(s+s,16),parseInt(l+l,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),A=t.value.substring(2,4),s=t.value.substring(4,6);return Vs(parseInt(n,16),parseInt(A,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),A=t.value.substring(2,4),s=t.value.substring(4,6),l=t.value.substring(6,8);return Vs(parseInt(n,16),parseInt(A,16),parseInt(s,16),parseInt(l,16)/255)}}if(t.type===20){var o=Ya[t.value.toUpperCase()];if(typeof o<"u")return o}return Ya.TRANSPARENT}},Xs=function(e){return(255&e)===0},on=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,A=255&e>>24;return t<255?"rgba("+A+","+n+","+r+","+t/255+")":"rgb("+A+","+n+","+r+")"},Vs=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},WC=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},qC=function(e,t){var r=t.filter(io);if(r.length===3){var n=r.map(WC),A=n[0],s=n[1],l=n[2];return Vs(A,s,l,1)}if(r.length===4){var o=r.map(WC),A=o[0],s=o[1],l=o[2],u=o[3];return Vs(A,s,l,u)}return 0};function dm(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var $C=function(e,t){var r=t.filter(io),n=r[0],A=r[1],s=r[2],l=r[3],o=(n.type===17?PA(n.number):bd.parse(e,n))/(Math.PI*2),u=rn(A)?A.number/100:0,f=rn(s)?s.number/100:0,d=typeof l<"u"&&rn(l)?Br(l,1):1;if(u===0)return Vs(f*255,f*255,f*255,1);var m=f<=.5?f*(u+1):f+u-f*u,x=f*2-m,y=dm(x,m,o+1/3),C=dm(x,m,o),E=dm(x,m,o-1/3);return Vs(y*255,C*255,E*255,d)},m8={hsl:$C,hsla:$C,rgb:qC,rgba:qC},Mc=function(e,t){return zs.parse(e,kS.create(t).parseComponentValue())},Ya={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},p8={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(mr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},x8={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Fd=function(e,t){var r=zs.parse(e,t[0]),n=t[1];return n&&rn(n)?{color:r,stop:n}:{color:r,stop:null}},ZC=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=En),n.stop===null&&(n.stop=Gs);for(var A=[],s=0,l=0;l<e.length;l++){var o=e[l].stop;if(o!==null){var u=Br(o,t);u>s?A.push(u):A.push(s),s=u}else A.push(null)}for(var f=null,l=0;l<A.length;l++){var d=A[l];if(d===null)f===null&&(f=l);else if(f!==null){for(var m=l-f,x=A[f-1],y=(d-x)/(m+1),C=1;C<=m;C++)A[f+C-1]=y*C;f=null}}return e.map(function(E,T){var _=E.color;return{color:_,stop:Math.max(Math.min(1,A[T]/t),0)}})},v8=function(e,t,r){var n=t/2,A=r/2,s=Br(e[0],t)-n,l=A-Br(e[1],r);return(Math.atan2(l,s)+Math.PI*2)%(Math.PI*2)},w8=function(e,t,r){var n=typeof e=="number"?e:v8(e,t,r),A=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),s=t/2,l=r/2,o=A/2,u=Math.sin(n-Math.PI/2)*o,f=Math.cos(n-Math.PI/2)*o;return[A,s-f,s+f,l-u,l+u]},ZA=function(e,t){return Math.sqrt(e*e+t*t)},eE=function(e,t,r,n,A){var s=[[0,0],[0,t],[e,0],[e,t]];return s.reduce(function(l,o){var u=o[0],f=o[1],d=ZA(r-u,n-f);return(A?d<l.optimumDistance:d>l.optimumDistance)?{optimumCorner:o,optimumDistance:d}:l},{optimumDistance:A?1/0:-1/0,optimumCorner:null}).optimumCorner},y8=function(e,t,r,n,A){var s=0,l=0;switch(e.size){case 0:e.shape===0?s=l=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-A)):e.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),l=Math.min(Math.abs(r),Math.abs(r-A)));break;case 2:if(e.shape===0)s=l=Math.min(ZA(t,r),ZA(t,r-A),ZA(t-n,r),ZA(t-n,r-A));else if(e.shape===1){var o=Math.min(Math.abs(r),Math.abs(r-A))/Math.min(Math.abs(t),Math.abs(t-n)),u=eE(n,A,t,r,!0),f=u[0],d=u[1];s=ZA(f-t,(d-r)/o),l=o*s}break;case 1:e.shape===0?s=l=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-A)):e.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),l=Math.max(Math.abs(r),Math.abs(r-A)));break;case 3:if(e.shape===0)s=l=Math.max(ZA(t,r),ZA(t,r-A),ZA(t-n,r),ZA(t-n,r-A));else if(e.shape===1){var o=Math.max(Math.abs(r),Math.abs(r-A))/Math.max(Math.abs(t),Math.abs(t-n)),m=eE(n,A,t,r,!1),f=m[0],d=m[1];s=ZA(f-t,(d-r)/o),l=o*s}break}return Array.isArray(e.size)&&(s=Br(e.size[0],n),l=e.size.length===2?Br(e.size[1],A):s),[s,l]},B8=function(e,t){var r=PA(180),n=[];return va(t).forEach(function(A,s){if(s===0){var l=A[0];if(l.type===20&&l.value==="to"){r=HS(A);return}else if(LS(l)){r=bd.parse(e,l);return}}var o=Fd(e,A);n.push(o)}),{angle:r,stops:n,type:1}},af=function(e,t){var r=PA(180),n=[];return va(t).forEach(function(A,s){if(s===0){var l=A[0];if(l.type===20&&["top","left","right","bottom"].indexOf(l.value)!==-1){r=HS(A);return}else if(LS(l)){r=(bd.parse(e,l)+PA(270))%PA(360);return}}var o=Fd(e,A);n.push(o)}),{angle:r,stops:n,type:1}},C8=function(e,t){var r=PA(180),n=[],A=1,s=0,l=3,o=[];return va(t).forEach(function(u,f){var d=u[0];if(f===0){if(mr(d)&&d.value==="linear"){A=1;return}else if(mr(d)&&d.value==="radial"){A=2;return}}if(d.type===18){if(d.name==="from"){var m=zs.parse(e,d.values[0]);n.push({stop:En,color:m})}else if(d.name==="to"){var m=zs.parse(e,d.values[0]);n.push({stop:Gs,color:m})}else if(d.name==="color-stop"){var x=d.values.filter(io);if(x.length===2){var m=zs.parse(e,x[1]),y=x[0];xo(y)&&n.push({stop:{type:16,number:y.number*100,flags:y.flags},color:m})}}}}),A===1?{angle:(r+PA(180))%PA(360),stops:n,type:A}:{size:l,shape:s,stops:n,position:o,type:A}},OS="closest-side",PS="farthest-side",GS="closest-corner",VS="farthest-corner",KS="circle",jS="ellipse",zS="cover",XS="contain",E8=function(e,t){var r=0,n=3,A=[],s=[];return va(t).forEach(function(l,o){var u=!0;if(o===0){var f=!1;u=l.reduce(function(m,x){if(f)if(mr(x))switch(x.value){case"center":return s.push(fx),m;case"top":case"left":return s.push(En),m;case"right":case"bottom":return s.push(Gs),m}else(rn(x)||Js(x))&&s.push(x);else if(mr(x))switch(x.value){case KS:return r=0,!1;case jS:return r=1,!1;case"at":return f=!0,!1;case OS:return n=0,!1;case zS:case PS:return n=1,!1;case XS:case GS:return n=2,!1;case VS:return n=3,!1}else if(Js(x)||rn(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return m},u)}if(u){var d=Fd(e,l);A.push(d)}}),{size:n,shape:r,stops:A,position:s,type:2}},sf=function(e,t){var r=0,n=3,A=[],s=[];return va(t).forEach(function(l,o){var u=!0;if(o===0?u=l.reduce(function(d,m){if(mr(m))switch(m.value){case"center":return s.push(fx),!1;case"top":case"left":return s.push(En),!1;case"right":case"bottom":return s.push(Gs),!1}else if(rn(m)||Js(m))return s.push(m),!1;return d},u):o===1&&(u=l.reduce(function(d,m){if(mr(m))switch(m.value){case KS:return r=0,!1;case jS:return r=1,!1;case XS:case OS:return n=0,!1;case PS:return n=1,!1;case GS:return n=2,!1;case zS:case VS:return n=3,!1}else if(Js(m)||rn(m))return Array.isArray(n)||(n=[]),n.push(m),!1;return d},u)),u){var f=Fd(e,l);A.push(f)}}),{size:n,shape:r,stops:A,position:s,type:2}},T8=function(e){return e.type===1},S8=function(e){return e.type===2},dx={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=JS[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function _8(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!JS[e.name])}var JS={"linear-gradient":B8,"-moz-linear-gradient":af,"-ms-linear-gradient":af,"-o-linear-gradient":af,"-webkit-linear-gradient":af,"radial-gradient":E8,"-moz-radial-gradient":sf,"-ms-radial-gradient":sf,"-o-radial-gradient":sf,"-webkit-radial-gradient":sf,"-webkit-gradient":C8},b8={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return io(n)&&_8(n)}).map(function(n){return dx.parse(e,n)})}},F8={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(mr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},U8={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return va(t).map(function(r){return r.filter(rn)}).map(IS)}},k8={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return va(t).map(function(r){return r.filter(mr).map(function(n){return n.value}).join(" ")}).map(N8)}},N8=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},ro;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(ro||(ro={}));var I8={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return va(t).map(function(r){return r.filter(Q8)})}},Q8=function(e){return mr(e)||rn(e)},Ud=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},R8=Ud("top"),D8=Ud("right"),M8=Ud("bottom"),L8=Ud("left"),kd=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return IS(r.filter(rn))}}},H8=kd("top-left"),O8=kd("top-right"),P8=kd("bottom-right"),G8=kd("bottom-left"),Nd=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},V8=Nd("top"),K8=Nd("right"),j8=Nd("bottom"),z8=Nd("left"),Id=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return vu(r)?r.number:0}}},X8=Id("top"),J8=Id("right"),Y8=Id("bottom"),W8=Id("left"),q8={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},$8={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Z8={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(mr).reduce(function(r,n){return r|e5(n.value)},0)}},e5=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},t5={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},r5={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},Jf;(function(e){e.NORMAL="normal",e.STRICT="strict"})(Jf||(Jf={}));var n5={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return Jf.STRICT;case"normal":default:return Jf.NORMAL}}},A5={name:"line-height",initialValue:"normal",prefix:!1,type:4},tE=function(e,t){return mr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:rn(e)?Br(e,t):t},a5={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:dx.parse(e,t)}},s5={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},Sp={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Qd=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},i5=Qd("top"),l5=Qd("right"),o5=Qd("bottom"),c5=Qd("left"),u5={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(mr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},f5={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Rd=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},d5=Rd("top"),h5=Rd("right"),g5=Rd("bottom"),m5=Rd("left"),p5={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},x5={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},v5={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Tp(t[0],"none")?[]:va(t).map(function(r){for(var n={color:Ya.TRANSPARENT,offsetX:En,offsetY:En,blur:En},A=0,s=0;s<r.length;s++){var l=r[s];Js(l)?(A===0?n.offsetX=l:A===1?n.offsetY=l:n.blur=l,A++):n.color=zs.parse(e,l)}return n})}},w5={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},y5={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=E5[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},B5=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},C5=function(e){var t=e.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=t[0],n=t[1];t[2],t[3];var A=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var l=t[12],o=t[13];return t[14],t[15],t.length===16?[r,n,A,s,l,o]:null},E5={matrix:B5,matrix3d:C5},rE={type:16,number:50,flags:xu},T5=[rE,rE],S5={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(rn);return r.length!==2?T5:[r[0],r[1]]}},_5={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Lc;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(Lc||(Lc={}));var b5={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return Lc.BREAK_ALL;case"keep-all":return Lc.KEEP_ALL;case"normal":default:return Lc.NORMAL}}},F5={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(xo(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},YS={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},U5={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return xo(t)?t.number:1}},k5={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},N5={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(mr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},I5={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(A){switch(A.type){case 20:case 0:r.push(A.value);break;case 17:r.push(A.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(A){return A.indexOf(" ")===-1?A:"'"+A+"'"})}},Q5={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},R5={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(xo(t))return t.number;if(mr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},D5={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(mr).map(function(r){return r.value})}},M5={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},An=function(e,t){return(e&t)!==0},L5={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},H5={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],A=t.filter(NS),s=0;s<A.length;s++){var l=A[s],o=A[s+1];if(l.type===20){var u=o&&xo(o)?o.number:1;n.push({counter:l.value,increment:u})}}return n}},O5={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(NS),A=0;A<n.length;A++){var s=n[A],l=n[A+1];if(mr(s)&&s.value!=="none"){var o=l&&xo(l)?l.number:0;r.push({counter:s.value,reset:o})}}return r}},P5={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(vu).map(function(r){return YS.parse(e,r)})}},G5={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],A=t.filter(h8);if(A.length%2!==0)return null;for(var s=0;s<A.length;s+=2){var l=A[s].value,o=A[s+1].value;n.push({open:l,close:o})}return n}},nE=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},V5={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Tp(t[0],"none")?[]:va(t).map(function(r){for(var n={color:255,offsetX:En,offsetY:En,blur:En,spread:En,inset:!1},A=0,s=0;s<r.length;s++){var l=r[s];Tp(l,"inset")?n.inset=!0:Js(l)?(A===0?n.offsetX=l:A===1?n.offsetY=l:A===2?n.blur=l:n.spread=l,A++):n.color=zs.parse(e,l)}return n})}},K5={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(mr).forEach(function(A){switch(A.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(A){n.indexOf(A)===-1&&n.push(A)}),n}},j5={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},z5={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return vu(t)?t.number:0}},X5=(function(){function e(t,r){var n,A;this.animationDuration=$e(t,P5,r.animationDuration),this.backgroundClip=$e(t,p8,r.backgroundClip),this.backgroundColor=$e(t,x8,r.backgroundColor),this.backgroundImage=$e(t,b8,r.backgroundImage),this.backgroundOrigin=$e(t,F8,r.backgroundOrigin),this.backgroundPosition=$e(t,U8,r.backgroundPosition),this.backgroundRepeat=$e(t,k8,r.backgroundRepeat),this.backgroundSize=$e(t,I8,r.backgroundSize),this.borderTopColor=$e(t,R8,r.borderTopColor),this.borderRightColor=$e(t,D8,r.borderRightColor),this.borderBottomColor=$e(t,M8,r.borderBottomColor),this.borderLeftColor=$e(t,L8,r.borderLeftColor),this.borderTopLeftRadius=$e(t,H8,r.borderTopLeftRadius),this.borderTopRightRadius=$e(t,O8,r.borderTopRightRadius),this.borderBottomRightRadius=$e(t,P8,r.borderBottomRightRadius),this.borderBottomLeftRadius=$e(t,G8,r.borderBottomLeftRadius),this.borderTopStyle=$e(t,V8,r.borderTopStyle),this.borderRightStyle=$e(t,K8,r.borderRightStyle),this.borderBottomStyle=$e(t,j8,r.borderBottomStyle),this.borderLeftStyle=$e(t,z8,r.borderLeftStyle),this.borderTopWidth=$e(t,X8,r.borderTopWidth),this.borderRightWidth=$e(t,J8,r.borderRightWidth),this.borderBottomWidth=$e(t,Y8,r.borderBottomWidth),this.borderLeftWidth=$e(t,W8,r.borderLeftWidth),this.boxShadow=$e(t,V5,r.boxShadow),this.color=$e(t,q8,r.color),this.direction=$e(t,$8,r.direction),this.display=$e(t,Z8,r.display),this.float=$e(t,t5,r.cssFloat),this.fontFamily=$e(t,I5,r.fontFamily),this.fontSize=$e(t,Q5,r.fontSize),this.fontStyle=$e(t,M5,r.fontStyle),this.fontVariant=$e(t,D5,r.fontVariant),this.fontWeight=$e(t,R5,r.fontWeight),this.letterSpacing=$e(t,r5,r.letterSpacing),this.lineBreak=$e(t,n5,r.lineBreak),this.lineHeight=$e(t,A5,r.lineHeight),this.listStyleImage=$e(t,a5,r.listStyleImage),this.listStylePosition=$e(t,s5,r.listStylePosition),this.listStyleType=$e(t,Sp,r.listStyleType),this.marginTop=$e(t,i5,r.marginTop),this.marginRight=$e(t,l5,r.marginRight),this.marginBottom=$e(t,o5,r.marginBottom),this.marginLeft=$e(t,c5,r.marginLeft),this.opacity=$e(t,U5,r.opacity);var s=$e(t,u5,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=$e(t,f5,r.overflowWrap),this.paddingTop=$e(t,d5,r.paddingTop),this.paddingRight=$e(t,h5,r.paddingRight),this.paddingBottom=$e(t,g5,r.paddingBottom),this.paddingLeft=$e(t,m5,r.paddingLeft),this.paintOrder=$e(t,K5,r.paintOrder),this.position=$e(t,x5,r.position),this.textAlign=$e(t,p5,r.textAlign),this.textDecorationColor=$e(t,k5,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=$e(t,N5,(A=r.textDecorationLine)!==null&&A!==void 0?A:r.textDecoration),this.textShadow=$e(t,v5,r.textShadow),this.textTransform=$e(t,w5,r.textTransform),this.transform=$e(t,y5,r.transform),this.transformOrigin=$e(t,S5,r.transformOrigin),this.visibility=$e(t,_5,r.visibility),this.webkitTextStrokeColor=$e(t,j5,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=$e(t,z5,r.webkitTextStrokeWidth),this.wordBreak=$e(t,b5,r.wordBreak),this.zIndex=$e(t,F5,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Xs(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return An(this.display,4)||An(this.display,33554432)||An(this.display,268435456)||An(this.display,536870912)||An(this.display,67108864)||An(this.display,134217728)},e})(),J5=(function(){function e(t,r){this.content=$e(t,L5,r.content),this.quotes=$e(t,G5,r.quotes)}return e})(),AE=(function(){function e(t,r){this.counterIncrement=$e(t,H5,r.counterIncrement),this.counterReset=$e(t,O5,r.counterReset)}return e})(),$e=function(e,t,r){var n=new US,A=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(A);var s=new kS(n.read());switch(t.type){case 2:var l=s.parseComponentValue();return t.parse(e,mr(l)?l.value:t.initialValue);case 0:return t.parse(e,s.parseComponentValue());case 1:return t.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return bd.parse(e,s.parseComponentValue());case"color":return zs.parse(e,s.parseComponentValue());case"image":return dx.parse(e,s.parseComponentValue());case"length":var o=s.parseComponentValue();return Js(o)?o:En;case"length-percentage":var u=s.parseComponentValue();return rn(u)?u:En;case"time":return YS.parse(e,s.parseComponentValue())}break}},Y5="data-html2canvas-debug",W5=function(e){var t=e.getAttribute(Y5);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},_p=function(e,t){var r=W5(e);return r===1||t===r},wa=(function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,_p(r,3))debugger;this.styles=new X5(t,window.getComputedStyle(r,null)),Up(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Sd(this.context,r),_p(r,4)&&(this.flags|=16)}return e})(),q5="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",aE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Uc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lf=0;lf<aE.length;lf++)Uc[aE.charCodeAt(lf)]=lf;var $5=function(e){var t=e.length*.75,r=e.length,n,A=0,s,l,o,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<r;n+=4)s=Uc[e.charCodeAt(n)],l=Uc[e.charCodeAt(n+1)],o=Uc[e.charCodeAt(n+2)],u=Uc[e.charCodeAt(n+3)],d[A++]=s<<2|l>>4,d[A++]=(l&15)<<4|o>>2,d[A++]=(o&3)<<6|u&63;return f},Z5=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},eO=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Ii=5,hx=11,hm=2,tO=hx-Ii,WS=65536>>Ii,rO=1<<Ii,gm=rO-1,nO=1024>>Ii,AO=WS+nO,aO=AO,sO=32,iO=aO+sO,lO=65536>>hx,oO=1<<tO,cO=oO-1,sE=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},uO=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},fO=function(e,t){var r=$5(e),n=Array.isArray(r)?eO(r):new Uint32Array(r),A=Array.isArray(r)?Z5(r):new Uint16Array(r),s=24,l=sE(A,s/2,n[4]/2),o=n[5]===2?sE(A,(s+n[4])/2):uO(n,Math.ceil((s+n[4])/4));return new dO(n[0],n[1],n[2],n[3],l,o)},dO=(function(){function e(t,r,n,A,s,l){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=A,this.index=s,this.data=l}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Ii],r=(r<<hm)+(t&gm),this.data[r];if(t<=65535)return r=this.index[WS+(t-55296>>Ii)],r=(r<<hm)+(t&gm),this.data[r];if(t<this.highStart)return r=iO-lO+(t>>hx),r=this.index[r],r+=t>>Ii&cO,r=this.index[r],r=(r<<hm)+(t&gm),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),iE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hO=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var of=0;of<iE.length;of++)hO[iE.charCodeAt(of)]=of;var gO=1,mm=2,pm=3,lE=4,oE=5,mO=7,cE=8,xm=9,vm=10,uE=11,fE=12,dE=13,hE=14,wm=15,pO=function(e){for(var t=[],r=0,n=e.length;r<n;){var A=e.charCodeAt(r++);if(A>=55296&&A<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((A&1023)<<10)+(s&1023)+65536):(t.push(A),r--)}else t.push(A)}return t},xO=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],A=-1,s="";++A<r;){var l=e[A];l<=65535?n.push(l):(l-=65536,n.push((l>>10)+55296,l%1024+56320)),(A+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},vO=fO(q5),MA="",ym="",wO=function(e){return vO.get(e)},yO=function(e,t,r){var n=r-2,A=t[n],s=t[r-1],l=t[r];if(s===mm&&l===pm)return MA;if(s===mm||s===pm||s===lE||l===mm||l===pm||l===lE)return ym;if(s===cE&&[cE,xm,uE,fE].indexOf(l)!==-1||(s===uE||s===xm)&&(l===xm||l===vm)||(s===fE||s===vm)&&l===vm||l===dE||l===oE||l===mO||s===gO)return MA;if(s===dE&&l===hE){for(;A===oE;)A=t[--n];if(A===hE)return MA}if(s===wm&&l===wm){for(var o=0;A===wm;)o++,A=t[--n];if(o%2===0)return MA}return ym},BO=function(e){var t=pO(e),r=t.length,n=0,A=0,s=t.map(wO);return{next:function(){if(n>=r)return{done:!0,value:null};for(var l=MA;n<r&&(l=yO(t,s,++n))===MA;);if(l!==MA||n===r){var o=xO.apply(null,t.slice(A,n));return A=n,{value:o,done:!1}}return{done:!0,value:null}}}},CO=function(e){for(var t=BO(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},EO=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var A=r.getBoundingClientRect(),s=Math.round(A.height);if(e.body.removeChild(n),s===t)return!0}}return!1},TO=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,A=_d(n.data).map(function(u){return jr(u)}),s=0,l={},o=A.every(function(u,f){r.setStart(n,s),r.setEnd(n,s+u.length);var d=r.getBoundingClientRect();s+=u.length;var m=d.x>l.x||d.y>l.y;return l=d,f===0?!0:m});return e.body.removeChild(t),o},SO=function(){return typeof new Image().crossOrigin<"u"},_O=function(){return typeof new XMLHttpRequest().responseType=="string"},bO=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},gE=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},FO=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var A=new Image,s=t.toDataURL();A.src=s;var l=bp(r,r,0,0,A);return n.fillStyle="red",n.fillRect(0,0,r,r),mE(l).then(function(o){n.drawImage(o,0,0);var u=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var f=e.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=r+"px",gE(u)?mE(bp(r,r,0,0,f)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),gE(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},bp=function(e,t,r,n,A){var s="http://www.w3.org/2000/svg",l=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return l.setAttributeNS(null,"width",e.toString()),l.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",r.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),l.appendChild(o),o.appendChild(A),l},mE=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},yn={get SUPPORT_RANGE_BOUNDS(){var e=EO(document);return Object.defineProperty(yn,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=yn.SUPPORT_RANGE_BOUNDS&&TO(document);return Object.defineProperty(yn,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=bO(document);return Object.defineProperty(yn,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?FO(document):Promise.resolve(!1);return Object.defineProperty(yn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=SO();return Object.defineProperty(yn,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=_O();return Object.defineProperty(yn,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(yn,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(yn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Hc=(function(){function e(t,r){this.text=t,this.bounds=r}return e})(),UO=function(e,t,r,n){var A=IO(t,r),s=[],l=0;return A.forEach(function(o){if(r.textDecorationLine.length||o.trim().length>0)if(yn.SUPPORT_RANGE_BOUNDS){var u=pE(n,l,o.length).getClientRects();if(u.length>1){var f=gx(o),d=0;f.forEach(function(x){s.push(new Hc(x,ts.fromDOMRectList(e,pE(n,d+l,x.length).getClientRects()))),d+=x.length})}else s.push(new Hc(o,ts.fromDOMRectList(e,u)))}else{var m=n.splitText(o.length);s.push(new Hc(o,kO(e,n))),n=m}else yn.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));l+=o.length}),s},kO=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var A=t.parentNode;if(A){A.replaceChild(n,t);var s=Sd(e,n);return n.firstChild&&A.replaceChild(n.firstChild,n),s}}return ts.EMPTY},pE=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var A=n.createRange();return A.setStart(e,t),A.setEnd(e,t+r),A},gx=function(e){if(yn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return CO(e)},NO=function(e,t){if(yn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return RO(e,t)},IO=function(e,t){return t.letterSpacing!==0?gx(e):NO(e,t)},QO=[32,160,4961,65792,65793,4153,4241],RO=function(e,t){for(var r=l6(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],A,s=function(){if(A.value){var l=A.value.slice(),o=_d(l),u="";o.forEach(function(f){QO.indexOf(f)===-1?u+=jr(f):(u.length&&n.push(u),n.push(jr(f)),u="")}),u.length&&n.push(u)}};!(A=r.next()).done;)s();return n},DO=(function(){function e(t,r,n){this.text=MO(r.data,n.textTransform),this.textBounds=UO(t,this.text,n,r)}return e})(),MO=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(LO,HO);case 2:return e.toUpperCase();default:return e}},LO=/(^|\s|:|-|\(|\))([a-z])/g,HO=function(e,t,r){return e.length>0?t+r.toUpperCase():e},qS=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A.src=n.currentSrc||n.src,A.intrinsicWidth=n.naturalWidth,A.intrinsicHeight=n.naturalHeight,A.context.cache.addImage(A.src),A}return t})(wa),$S=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A.canvas=n,A.intrinsicWidth=n.width,A.intrinsicHeight=n.height,A}return t})(wa),ZS=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this,s=new XMLSerializer,l=Sd(r,n);return n.setAttribute("width",l.width+"px"),n.setAttribute("height",l.height+"px"),A.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),A.intrinsicWidth=n.width.baseVal.value,A.intrinsicHeight=n.height.baseVal.value,A.context.cache.addImage(A.svg),A}return t})(wa),e_=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A.value=n.value,A}return t})(wa),Fp=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A.start=n.start,A.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,A}return t})(wa),OO=[{type:15,flags:0,unit:"px",number:3}],PO=[{type:16,flags:0,number:50}],GO=function(e){return e.width>e.height?new ts(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new ts(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},VO=function(e){var t=e.type===KO?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},Yf="checkbox",Wf="radio",KO="password",xE=707406591,mx=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;switch(A.type=n.type.toLowerCase(),A.checked=n.checked,A.value=VO(n),(A.type===Yf||A.type===Wf)&&(A.styles.backgroundColor=3739148031,A.styles.borderTopColor=A.styles.borderRightColor=A.styles.borderBottomColor=A.styles.borderLeftColor=2779096575,A.styles.borderTopWidth=A.styles.borderRightWidth=A.styles.borderBottomWidth=A.styles.borderLeftWidth=1,A.styles.borderTopStyle=A.styles.borderRightStyle=A.styles.borderBottomStyle=A.styles.borderLeftStyle=1,A.styles.backgroundClip=[0],A.styles.backgroundOrigin=[0],A.bounds=GO(A.bounds)),A.type){case Yf:A.styles.borderTopRightRadius=A.styles.borderTopLeftRadius=A.styles.borderBottomRightRadius=A.styles.borderBottomLeftRadius=OO;break;case Wf:A.styles.borderTopRightRadius=A.styles.borderTopLeftRadius=A.styles.borderBottomRightRadius=A.styles.borderBottomLeftRadius=PO;break}return A}return t})(wa),t_=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return A.value=s&&s.text||"",A}return t})(wa),r_=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A.value=n.value,A}return t})(wa),n_=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;A.src=n.src,A.width=parseInt(n.width,10)||0,A.height=parseInt(n.height,10)||0,A.backgroundColor=A.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){A.tree=a_(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?Mc(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Ya.TRANSPARENT,l=n.contentWindow.document.body?Mc(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):Ya.TRANSPARENT;A.backgroundColor=Xs(s)?Xs(l)?A.styles.backgroundColor:l:s}}catch{}return A}return t})(wa),jO=["OL","UL","MENU"],Mf=function(e,t,r,n){for(var A=t.firstChild,s=void 0;A;A=s)if(s=A.nextSibling,s_(A)&&A.data.trim().length>0)r.textNodes.push(new DO(e,A,r.styles));else if($l(A))if(c_(A)&&A.assignedNodes)A.assignedNodes().forEach(function(o){return Mf(e,o,r,n)});else{var l=A_(e,A);l.styles.isVisible()&&(zO(A,l,n)?l.flags|=4:XO(l.styles)&&(l.flags|=2),jO.indexOf(A.tagName)!==-1&&(l.flags|=8),r.elements.push(l),A.slot,A.shadowRoot?Mf(e,A.shadowRoot,l,n):!qf(A)&&!i_(A)&&!$f(A)&&Mf(e,A,l,n))}},A_=function(e,t){return kp(t)?new qS(e,t):l_(t)?new $S(e,t):i_(t)?new ZS(e,t):JO(t)?new e_(e,t):YO(t)?new Fp(e,t):WO(t)?new mx(e,t):$f(t)?new t_(e,t):qf(t)?new r_(e,t):o_(t)?new n_(e,t):new wa(e,t)},a_=function(e,t){var r=A_(e,t);return r.flags|=4,Mf(e,t,r,r),r},zO=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||px(e)&&r.styles.isTransparent()},XO=function(e){return e.isPositioned()||e.isFloating()},s_=function(e){return e.nodeType===Node.TEXT_NODE},$l=function(e){return e.nodeType===Node.ELEMENT_NODE},Up=function(e){return $l(e)&&typeof e.style<"u"&&!Lf(e)},Lf=function(e){return typeof e.className=="object"},JO=function(e){return e.tagName==="LI"},YO=function(e){return e.tagName==="OL"},WO=function(e){return e.tagName==="INPUT"},qO=function(e){return e.tagName==="HTML"},i_=function(e){return e.tagName==="svg"},px=function(e){return e.tagName==="BODY"},l_=function(e){return e.tagName==="CANVAS"},vE=function(e){return e.tagName==="VIDEO"},kp=function(e){return e.tagName==="IMG"},o_=function(e){return e.tagName==="IFRAME"},wE=function(e){return e.tagName==="STYLE"},$O=function(e){return e.tagName==="SCRIPT"},qf=function(e){return e.tagName==="TEXTAREA"},$f=function(e){return e.tagName==="SELECT"},c_=function(e){return e.tagName==="SLOT"},yE=function(e){return e.tagName.indexOf("-")>0},ZO=(function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,A=t.counterReset,s=!0;n!==null&&n.forEach(function(o){var u=r.counters[o.counter];u&&o.increment!==0&&(s=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=o.increment)});var l=[];return s&&A.forEach(function(o){var u=r.counters[o.counter];l.push(o.counter),u||(u=r.counters[o.counter]=[]),u.push(o.reset)}),l},e})(),BE={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},CE={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},eP={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},tP={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Ll=function(e,t,r,n,A,s){return e<t||e>r?tu(e,A,s.length>0):n.integers.reduce(function(l,o,u){for(;e>=o;)e-=o,l+=n.values[u];return l},"")+s},u_=function(e,t,r,n){var A="";do r||e--,A=n(e)+A,e/=t;while(e*t>=t);return A},Vr=function(e,t,r,n,A){var s=r-t+1;return(e<0?"-":"")+(u_(Math.abs(e),s,n,function(l){return jr(Math.floor(l%s)+t)})+A)},Ci=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return u_(Math.abs(e),n,!1,function(A){return t[Math.floor(A%n)]})+r},Xl=1,Ms=2,Ls=4,kc=8,ja=function(e,t,r,n,A,s){if(e<-9999||e>9999)return tu(e,4,A.length>0);var l=Math.abs(e),o=A;if(l===0)return t[0]+o;for(var u=0;l>0&&u<=4;u++){var f=l%10;f===0&&An(s,Xl)&&o!==""?o=t[f]+o:f>1||f===1&&u===0||f===1&&u===1&&An(s,Ms)||f===1&&u===1&&An(s,Ls)&&e>100||f===1&&u>1&&An(s,kc)?o=t[f]+(u>0?r[u-1]:"")+o:f===1&&u>0&&(o=r[u-1]+o),l=Math.floor(l/10)}return(e<0?n:"")+o},EE="",TE="",SE="",Bm="",tu=function(e,t,r){var n=r?". ":"",A=r?"":"",s=r?", ":"",l=r?" ":"";switch(t){case 0:return""+l;case 1:return""+l;case 2:return""+l;case 5:var o=Vr(e,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return Ci(e,"",A);case 6:return Ll(e,1,3999,BE,3,n).toLowerCase();case 7:return Ll(e,1,3999,BE,3,n);case 8:return Vr(e,945,969,!1,n);case 9:return Vr(e,97,122,!1,n);case 10:return Vr(e,65,90,!1,n);case 11:return Vr(e,1632,1641,!0,n);case 12:case 49:return Ll(e,1,9999,CE,3,n);case 35:return Ll(e,1,9999,CE,3,n).toLowerCase();case 13:return Vr(e,2534,2543,!0,n);case 14:case 30:return Vr(e,6112,6121,!0,n);case 15:return Ci(e,"",A);case 16:return Ci(e,"",A);case 17:case 48:return ja(e,"",EE,"",A,Ms|Ls|kc);case 47:return ja(e,"",TE,"",A,Xl|Ms|Ls|kc);case 42:return ja(e,"",EE,"",A,Ms|Ls|kc);case 41:return ja(e,"",TE,"",A,Xl|Ms|Ls|kc);case 26:return ja(e,"","",SE,A,0);case 25:return ja(e,"","",SE,A,Xl|Ms|Ls);case 31:return ja(e,"","",Bm,s,Xl|Ms|Ls);case 33:return ja(e,"","",Bm,s,0);case 32:return ja(e,"","",Bm,s,Xl|Ms|Ls);case 18:return Vr(e,2406,2415,!0,n);case 20:return Ll(e,1,19999,tP,3,n);case 21:return Vr(e,2790,2799,!0,n);case 22:return Vr(e,2662,2671,!0,n);case 22:return Ll(e,1,10999,eP,3,n);case 23:return Ci(e,"");case 24:return Ci(e,"");case 27:return Vr(e,3302,3311,!0,n);case 28:return Ci(e,"",A);case 29:return Ci(e,"",A);case 34:return Vr(e,3792,3801,!0,n);case 37:return Vr(e,6160,6169,!0,n);case 38:return Vr(e,4160,4169,!0,n);case 39:return Vr(e,2918,2927,!0,n);case 40:return Vr(e,1776,1785,!0,n);case 43:return Vr(e,3046,3055,!0,n);case 44:return Vr(e,3174,3183,!0,n);case 45:return Vr(e,3664,3673,!0,n);case 46:return Vr(e,3872,3881,!0,n);case 3:default:return Vr(e,48,57,!0,n)}},f_="data-html2canvas-ignore",_E=(function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new ZO,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,A=rP(t,r);if(!A.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,l=t.defaultView.pageYOffset,o=A.contentWindow,u=o.document,f=aP(A).then(function(){return jn(n,void 0,void 0,function(){var d,m;return Un(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(oP),o&&(o.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==r.top||o.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-r.left,o.scrollY-r.top,0,0))),d=this.options.onclone,m=this.clonedReferenceElement,typeof m>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,AP(u)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(u,m)}).then(function(){return A})]:[2,A]}})})});return u.open(),u.write(iP(document.doctype)+"<html></html>"),lP(this.referenceElement.ownerDocument,s,l),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),f},e.prototype.createElementClone=function(t){if(_p(t,2))debugger;if(l_(t))return this.createCanvasClone(t);if(vE(t))return this.createVideoClone(t);if(wE(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return kp(r)&&(kp(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),yE(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return Cm(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,l){return l&&typeof l.cssText=="string"?s+l.cssText:s},""),A=t.cloneNode(!1);return A.textContent=n,A}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var A=t.cloneNode(!1);try{A.width=t.width,A.height=t.height;var s=t.getContext("2d"),l=A.getContext("2d");if(l)if(!this.options.allowTaint&&s)l.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var o=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(o){var u=o.getContextAttributes();(u==null?void 0:u.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}l.drawImage(t,0,0)}return A}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return A},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var A=t.ownerDocument.createElement("canvas");return A.width=t.offsetWidth,A.height=t.offsetHeight,A},e.prototype.appendChildNode=function(t,r,n){(!$l(r)||!$O(r)&&!r.hasAttribute(f_)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!$l(r)||!wE(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var A=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if($l(s)&&c_(s)&&typeof s.assignedNodes=="function"){var l=s.assignedNodes();l.length&&l.forEach(function(o){return A.appendChildNode(r,o,n)})}else this.appendChildNode(r,s,n)},e.prototype.cloneNode=function(t,r){if(s_(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&$l(t)&&(Up(t)||Lf(t))){var A=this.createElementClone(t);A.style.transitionProperty="none";var s=n.getComputedStyle(t),l=n.getComputedStyle(t,":before"),o=n.getComputedStyle(t,":after");this.referenceElement===t&&Up(A)&&(this.clonedReferenceElement=A),px(A)&&fP(A);var u=this.counters.parse(new AE(this.context,s)),f=this.resolvePseudoContent(t,A,l,Oc.BEFORE);yE(t)&&(r=!0),vE(t)||this.cloneChildNodes(t,A,r),f&&A.insertBefore(f,A.firstChild);var d=this.resolvePseudoContent(t,A,o,Oc.AFTER);return d&&A.appendChild(d),this.counters.pop(u),(s&&(this.options.copyStyles||Lf(t))&&!o_(t)||r)&&Cm(s,A),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([A,t.scrollLeft,t.scrollTop]),(qf(t)||$f(t))&&(qf(A)||$f(A))&&(A.value=t.value),A}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,A){var s=this;if(n){var l=n.content,o=r.ownerDocument;if(!(!o||!l||l==="none"||l==="-moz-alt-content"||n.display==="none")){this.counters.parse(new AE(this.context,n));var u=new J5(this.context,n),f=o.createElement("html2canvaspseudoelement");Cm(n,f),u.content.forEach(function(m){if(m.type===0)f.appendChild(o.createTextNode(m.value));else if(m.type===22){var x=o.createElement("img");x.src=m.value,x.style.opacity="1",f.appendChild(x)}else if(m.type===18){if(m.name==="attr"){var y=m.values.filter(mr);y.length&&f.appendChild(o.createTextNode(t.getAttribute(y[0].value)||""))}else if(m.name==="counter"){var C=m.values.filter(io),E=C[0],T=C[1];if(E&&mr(E)){var _=s.counters.getCounterValue(E.value),F=T&&mr(T)?Sp.parse(s.context,T.value):3;f.appendChild(o.createTextNode(tu(_,F,!1)))}}else if(m.name==="counters"){var S=m.values.filter(io),E=S[0],I=S[1],T=S[2];if(E&&mr(E)){var M=s.counters.getCounterValues(E.value),Q=T&&mr(T)?Sp.parse(s.context,T.value):3,U=I&&I.type===0?I.value:"",G=M.map(function(ne){return tu(ne,Q,!1)}).join(U);f.appendChild(o.createTextNode(G))}}}else if(m.type===20)switch(m.value){case"open-quote":f.appendChild(o.createTextNode(nE(u.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(o.createTextNode(nE(u.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(o.createTextNode(m.value))}}),f.className=Np+" "+Ip;var d=A===Oc.BEFORE?" "+Np:" "+Ip;return Lf(r)?r.className.baseValue+=d:r.className+=d,f}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e})(),Oc;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(Oc||(Oc={}));var rP=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(f_,"true"),e.body.appendChild(r),r},nP=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},AP=function(e){return Promise.all([].slice.call(e.images,0).map(nP))},aP=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var A=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var s=setInterval(function(){A.body.childNodes.length>0&&A.readyState==="complete"&&(clearInterval(s),t(e))},50)}})},sP=["all","d","content"],Cm=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);sP.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},iP=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},lP=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},oP=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},cP=":before",uP=":after",Np="___html2canvas___pseudoelement_before",Ip="___html2canvas___pseudoelement_after",bE=`{
    content: "" !important;
    display: none !important;
}`,fP=function(e){dP(e,"."+Np+cP+bE+`
         .`+Ip+uP+bE)},dP=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},d_=(function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e})(),hP=(function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(Tm(t)||xP(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return jn(this,void 0,void 0,function(){var r,n,A,s,l=this;return Un(this,function(o){switch(o.label){case 0:return r=d_.isSameOrigin(t),n=!Em(t)&&this._options.useCORS===!0&&yn.SUPPORT_CORS_IMAGES&&!r,A=!Em(t)&&!r&&!Tm(t)&&typeof this._options.proxy=="string"&&yn.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!Em(t)&&!Tm(t)&&!A&&!n?[2]:(s=t,A?[4,this.proxy(s)]:[3,2]);case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(u,f){var d=new Image;d.onload=function(){return u(d)},d.onerror=f,(vP(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return u(d)},500),l._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+l._options.imageTimeout+"ms) loading image")},l._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var A=t.substring(0,256);return new Promise(function(s,l){var o=yn.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(o==="text")s(u.response);else{var m=new FileReader;m.addEventListener("load",function(){return s(m.result)},!1),m.addEventListener("error",function(x){return l(x)},!1),m.readAsDataURL(u.response)}else l("Failed to proxy resource "+A+" with status code "+u.status)},u.onerror=l;var f=n.indexOf("?")>-1?"&":"?";if(u.open("GET",""+n+f+"url="+encodeURIComponent(t)+"&responseType="+o),o!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=o),r._options.imageTimeout){var d=r._options.imageTimeout;u.timeout=d,u.ontimeout=function(){return l("Timed out ("+d+"ms) proxying "+A)}}u.send()})},e})(),gP=/^data:image\/svg\+xml/i,mP=/^data:image\/.*;base64,/i,pP=/^data:image\/.*/i,xP=function(e){return yn.SUPPORT_SVG_DRAWING||!wP(e)},Em=function(e){return pP.test(e)},vP=function(e){return mP.test(e)},Tm=function(e){return e.substr(0,4)==="blob"},wP=function(e){return e.substr(-3).toLowerCase()==="svg"||gP.test(e)},We=(function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e})(),Hl=function(e,t,r){return new We(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},cf=(function(){function e(t,r,n,A){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=A}return e.prototype.subdivide=function(t,r){var n=Hl(this.start,this.startControl,t),A=Hl(this.startControl,this.endControl,t),s=Hl(this.endControl,this.end,t),l=Hl(n,A,t),o=Hl(A,s,t),u=Hl(l,o,t);return r?new e(this.start,n,l,u):new e(u,o,s,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),OA=function(e){return e.type===1},yP=(function(){function e(t){var r=t.styles,n=t.bounds,A=Fc(r.borderTopLeftRadius,n.width,n.height),s=A[0],l=A[1],o=Fc(r.borderTopRightRadius,n.width,n.height),u=o[0],f=o[1],d=Fc(r.borderBottomRightRadius,n.width,n.height),m=d[0],x=d[1],y=Fc(r.borderBottomLeftRadius,n.width,n.height),C=y[0],E=y[1],T=[];T.push((s+u)/n.width),T.push((C+m)/n.width),T.push((l+E)/n.height),T.push((f+x)/n.height);var _=Math.max.apply(Math,T);_>1&&(s/=_,l/=_,u/=_,f/=_,m/=_,x/=_,C/=_,E/=_);var F=n.width-u,S=n.height-x,I=n.width-m,M=n.height-E,Q=r.borderTopWidth,U=r.borderRightWidth,G=r.borderBottomWidth,R=r.borderLeftWidth,te=Br(r.paddingTop,t.bounds.width),ne=Br(r.paddingRight,t.bounds.width),ee=Br(r.paddingBottom,t.bounds.width),ae=Br(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||l>0?Fr(n.left+R/3,n.top+Q/3,s-R/3,l-Q/3,tr.TOP_LEFT):new We(n.left+R/3,n.top+Q/3),this.topRightBorderDoubleOuterBox=s>0||l>0?Fr(n.left+F,n.top+Q/3,u-U/3,f-Q/3,tr.TOP_RIGHT):new We(n.left+n.width-U/3,n.top+Q/3),this.bottomRightBorderDoubleOuterBox=m>0||x>0?Fr(n.left+I,n.top+S,m-U/3,x-G/3,tr.BOTTOM_RIGHT):new We(n.left+n.width-U/3,n.top+n.height-G/3),this.bottomLeftBorderDoubleOuterBox=C>0||E>0?Fr(n.left+R/3,n.top+M,C-R/3,E-G/3,tr.BOTTOM_LEFT):new We(n.left+R/3,n.top+n.height-G/3),this.topLeftBorderDoubleInnerBox=s>0||l>0?Fr(n.left+R*2/3,n.top+Q*2/3,s-R*2/3,l-Q*2/3,tr.TOP_LEFT):new We(n.left+R*2/3,n.top+Q*2/3),this.topRightBorderDoubleInnerBox=s>0||l>0?Fr(n.left+F,n.top+Q*2/3,u-U*2/3,f-Q*2/3,tr.TOP_RIGHT):new We(n.left+n.width-U*2/3,n.top+Q*2/3),this.bottomRightBorderDoubleInnerBox=m>0||x>0?Fr(n.left+I,n.top+S,m-U*2/3,x-G*2/3,tr.BOTTOM_RIGHT):new We(n.left+n.width-U*2/3,n.top+n.height-G*2/3),this.bottomLeftBorderDoubleInnerBox=C>0||E>0?Fr(n.left+R*2/3,n.top+M,C-R*2/3,E-G*2/3,tr.BOTTOM_LEFT):new We(n.left+R*2/3,n.top+n.height-G*2/3),this.topLeftBorderStroke=s>0||l>0?Fr(n.left+R/2,n.top+Q/2,s-R/2,l-Q/2,tr.TOP_LEFT):new We(n.left+R/2,n.top+Q/2),this.topRightBorderStroke=s>0||l>0?Fr(n.left+F,n.top+Q/2,u-U/2,f-Q/2,tr.TOP_RIGHT):new We(n.left+n.width-U/2,n.top+Q/2),this.bottomRightBorderStroke=m>0||x>0?Fr(n.left+I,n.top+S,m-U/2,x-G/2,tr.BOTTOM_RIGHT):new We(n.left+n.width-U/2,n.top+n.height-G/2),this.bottomLeftBorderStroke=C>0||E>0?Fr(n.left+R/2,n.top+M,C-R/2,E-G/2,tr.BOTTOM_LEFT):new We(n.left+R/2,n.top+n.height-G/2),this.topLeftBorderBox=s>0||l>0?Fr(n.left,n.top,s,l,tr.TOP_LEFT):new We(n.left,n.top),this.topRightBorderBox=u>0||f>0?Fr(n.left+F,n.top,u,f,tr.TOP_RIGHT):new We(n.left+n.width,n.top),this.bottomRightBorderBox=m>0||x>0?Fr(n.left+I,n.top+S,m,x,tr.BOTTOM_RIGHT):new We(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=C>0||E>0?Fr(n.left,n.top+M,C,E,tr.BOTTOM_LEFT):new We(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||l>0?Fr(n.left+R,n.top+Q,Math.max(0,s-R),Math.max(0,l-Q),tr.TOP_LEFT):new We(n.left+R,n.top+Q),this.topRightPaddingBox=u>0||f>0?Fr(n.left+Math.min(F,n.width-U),n.top+Q,F>n.width+U?0:Math.max(0,u-U),Math.max(0,f-Q),tr.TOP_RIGHT):new We(n.left+n.width-U,n.top+Q),this.bottomRightPaddingBox=m>0||x>0?Fr(n.left+Math.min(I,n.width-R),n.top+Math.min(S,n.height-G),Math.max(0,m-U),Math.max(0,x-G),tr.BOTTOM_RIGHT):new We(n.left+n.width-U,n.top+n.height-G),this.bottomLeftPaddingBox=C>0||E>0?Fr(n.left+R,n.top+Math.min(M,n.height-G),Math.max(0,C-R),Math.max(0,E-G),tr.BOTTOM_LEFT):new We(n.left+R,n.top+n.height-G),this.topLeftContentBox=s>0||l>0?Fr(n.left+R+ae,n.top+Q+te,Math.max(0,s-(R+ae)),Math.max(0,l-(Q+te)),tr.TOP_LEFT):new We(n.left+R+ae,n.top+Q+te),this.topRightContentBox=u>0||f>0?Fr(n.left+Math.min(F,n.width+R+ae),n.top+Q+te,F>n.width+R+ae?0:u-R+ae,f-(Q+te),tr.TOP_RIGHT):new We(n.left+n.width-(U+ne),n.top+Q+te),this.bottomRightContentBox=m>0||x>0?Fr(n.left+Math.min(I,n.width-(R+ae)),n.top+Math.min(S,n.height+Q+te),Math.max(0,m-(U+ne)),x-(G+ee),tr.BOTTOM_RIGHT):new We(n.left+n.width-(U+ne),n.top+n.height-(G+ee)),this.bottomLeftContentBox=C>0||E>0?Fr(n.left+R+ae,n.top+M,Math.max(0,C-(R+ae)),E-(G+ee),tr.BOTTOM_LEFT):new We(n.left+R+ae,n.top+n.height-(G+ee))}return e})(),tr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(tr||(tr={}));var Fr=function(e,t,r,n,A){var s=4*((Math.sqrt(2)-1)/3),l=r*s,o=n*s,u=e+r,f=t+n;switch(A){case tr.TOP_LEFT:return new cf(new We(e,f),new We(e,f-o),new We(u-l,t),new We(u,t));case tr.TOP_RIGHT:return new cf(new We(e,t),new We(e+l,t),new We(u,f-o),new We(u,f));case tr.BOTTOM_RIGHT:return new cf(new We(u,t),new We(u,t+o),new We(e+l,f),new We(e,f));case tr.BOTTOM_LEFT:default:return new cf(new We(u,f),new We(u-l,f),new We(e,t+o),new We(e,t))}},Zf=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},BP=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},ed=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},CP=(function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e})(),uf=(function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e})(),EP=(function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e})(),TP=function(e){return e.type===0},h_=function(e){return e.type===1},SP=function(e){return e.type===2},FE=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},_P=function(e,t,r,n,A){return e.map(function(s,l){switch(l){case 0:return s.add(t,r);case 1:return s.add(t+n,r);case 2:return s.add(t+n,r+A);case 3:return s.add(t,r+A)}return s})},g_=(function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),m_=(function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new yP(this.container),this.container.styles.opacity<1&&this.effects.push(new EP(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,A=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new CP(n,A,s))}if(this.container.styles.overflowX!==0){var l=Zf(this.curves),o=ed(this.curves);FE(l,o)?this.effects.push(new uf(l,6)):(this.effects.push(new uf(l,2)),this.effects.push(new uf(o,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,A=this.effects.slice(0);n;){var s=n.effects.filter(function(u){return!h_(u)});if(r||n.container.styles.position!==0||!n.parent){if(A.unshift.apply(A,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var l=Zf(n.curves),o=ed(n.curves);FE(l,o)||A.unshift(new uf(o,6))}}else A.unshift.apply(A,s);n=n.parent}return A.filter(function(u){return An(u.target,t)})},e})(),Qp=function(e,t,r,n){e.container.elements.forEach(function(A){var s=An(A.flags,4),l=An(A.flags,2),o=new m_(A,e);An(A.styles.display,2048)&&n.push(o);var u=An(A.flags,8)?[]:n;if(s||l){var f=s||A.styles.isPositioned()?r:t,d=new g_(o);if(A.styles.isPositioned()||A.styles.opacity<1||A.styles.isTransformed()){var m=A.styles.zIndex.order;if(m<0){var x=0;f.negativeZIndex.some(function(C,E){return m>C.element.container.styles.zIndex.order?(x=E,!1):x>0}),f.negativeZIndex.splice(x,0,d)}else if(m>0){var y=0;f.positiveZIndex.some(function(C,E){return m>=C.element.container.styles.zIndex.order?(y=E+1,!1):y>0}),f.positiveZIndex.splice(y,0,d)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else A.styles.isFloating()?f.nonPositionedFloats.push(d):f.nonPositionedInlineLevel.push(d);Qp(o,d,s?d:r,u)}else A.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),Qp(o,t,r,u);An(A.flags,8)&&p_(A,u)})},p_=function(e,t){for(var r=e instanceof Fp?e.start:1,n=e instanceof Fp?e.reversed:!1,A=0;A<t.length;A++){var s=t[A];s.container instanceof e_&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=tu(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},bP=function(e){var t=new m_(e,null),r=new g_(t),n=[];return Qp(t,r,r,n),p_(t.container,n),r},UE=function(e,t){switch(t){case 0:return GA(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return GA(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return GA(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return GA(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},FP=function(e,t){switch(t){case 0:return GA(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return GA(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return GA(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return GA(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},UP=function(e,t){switch(t){case 0:return GA(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return GA(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return GA(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return GA(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},kP=function(e,t){switch(t){case 0:return ff(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return ff(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return ff(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return ff(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},ff=function(e,t){var r=[];return OA(e)?r.push(e.subdivide(.5,!1)):r.push(e),OA(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},GA=function(e,t,r,n){var A=[];return OA(e)?A.push(e.subdivide(.5,!1)):A.push(e),OA(r)?A.push(r.subdivide(.5,!0)):A.push(r),OA(n)?A.push(n.subdivide(.5,!0).reverse()):A.push(n),OA(t)?A.push(t.subdivide(.5,!1).reverse()):A.push(t),A},x_=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},td=function(e){var t=e.styles,r=e.bounds,n=Br(t.paddingLeft,r.width),A=Br(t.paddingRight,r.width),s=Br(t.paddingTop,r.width),l=Br(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+A),-(t.borderTopWidth+t.borderBottomWidth+s+l))},NP=function(e,t){return e===0?t.bounds:e===2?td(t):x_(t)},IP=function(e,t){return e===0?t.bounds:e===2?td(t):x_(t)},Sm=function(e,t,r){var n=NP(Jl(e.styles.backgroundOrigin,t),e),A=IP(Jl(e.styles.backgroundClip,t),e),s=QP(Jl(e.styles.backgroundSize,t),r,n),l=s[0],o=s[1],u=Fc(Jl(e.styles.backgroundPosition,t),n.width-l,n.height-o),f=RP(Jl(e.styles.backgroundRepeat,t),u,s,n,A),d=Math.round(n.left+u[0]),m=Math.round(n.top+u[1]);return[f,d,m,l,o]},Ol=function(e){return mr(e)&&e.value===ro.AUTO},df=function(e){return typeof e=="number"},QP=function(e,t,r){var n=t[0],A=t[1],s=t[2],l=e[0],o=e[1];if(!l)return[0,0];if(rn(l)&&o&&rn(o))return[Br(l,r.width),Br(o,r.height)];var u=df(s);if(mr(l)&&(l.value===ro.CONTAIN||l.value===ro.COVER)){if(df(s)){var f=r.width/r.height;return f<s!=(l.value===ro.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=df(n),m=df(A),x=d||m;if(Ol(l)&&(!o||Ol(o))){if(d&&m)return[n,A];if(!u&&!x)return[r.width,r.height];if(x&&u){var y=d?n:A*s,C=m?A:n/s;return[y,C]}var E=d?n:r.width,T=m?A:r.height;return[E,T]}if(u){var _=0,F=0;return rn(l)?_=Br(l,r.width):rn(o)&&(F=Br(o,r.height)),Ol(l)?_=F*s:(!o||Ol(o))&&(F=_/s),[_,F]}var S=null,I=null;if(rn(l)?S=Br(l,r.width):o&&rn(o)&&(I=Br(o,r.height)),S!==null&&(!o||Ol(o))&&(I=d&&m?S/n*A:r.height),I!==null&&Ol(l)&&(S=d&&m?I/A*n:r.width),S!==null&&I!==null)return[S,I];throw new Error("Unable to calculate background-size for element")},Jl=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},RP=function(e,t,r,n,A){var s=t[0],l=t[1],o=r[0],u=r[1];switch(e){case 2:return[new We(Math.round(n.left),Math.round(n.top+l)),new We(Math.round(n.left+n.width),Math.round(n.top+l)),new We(Math.round(n.left+n.width),Math.round(u+n.top+l)),new We(Math.round(n.left),Math.round(u+n.top+l))];case 3:return[new We(Math.round(n.left+s),Math.round(n.top)),new We(Math.round(n.left+s+o),Math.round(n.top)),new We(Math.round(n.left+s+o),Math.round(n.height+n.top)),new We(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new We(Math.round(n.left+s),Math.round(n.top+l)),new We(Math.round(n.left+s+o),Math.round(n.top+l)),new We(Math.round(n.left+s+o),Math.round(n.top+l+u)),new We(Math.round(n.left+s),Math.round(n.top+l+u))];default:return[new We(Math.round(A.left),Math.round(A.top)),new We(Math.round(A.left+A.width),Math.round(A.top)),new We(Math.round(A.left+A.width),Math.round(A.height+A.top)),new We(Math.round(A.left),Math.round(A.height+A.top))]}},DP="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",kE="Hidden Text",MP=(function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),A=this._document.createElement("img"),s=this._document.createElement("span"),l=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",l.appendChild(n),A.src=DP,A.width=1,A.height=1,A.style.margin="0",A.style.padding="0",A.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(kE)),n.appendChild(s),n.appendChild(A);var o=A.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(kE)),n.style.lineHeight="normal",A.style.verticalAlign="super";var u=A.offsetTop-n.offsetTop+2;return l.removeChild(n),{baseline:o,middle:u}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e})(),v_=(function(){function e(t,r){this.context=t,this.options=r}return e})(),LP=1e4,HP=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A._activeEffects=[],A.canvas=n.canvas?n.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),n.canvas||(A.canvas.width=Math.floor(n.width*n.scale),A.canvas.height=Math.floor(n.height*n.scale),A.canvas.style.width=n.width+"px",A.canvas.style.height=n.height+"px"),A.fontMetrics=new MP(document),A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-n.x,-n.y),A.ctx.textBaseline="bottom",A._activeEffects=[],A.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),A}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(A){return n.applyEffect(A)})},t.prototype.applyEffect=function(r){this.ctx.save(),SP(r)&&(this.ctx.globalAlpha=r.opacity),TP(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),h_(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return jn(this,void 0,void 0,function(){var n;return Un(this,function(A){switch(A.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:A.sent(),A.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return jn(this,void 0,void 0,function(){return Un(this,function(n){switch(n.label){case 0:if(An(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,A){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+A);else{var l=gx(r.text);l.reduce(function(o,u){return s.ctx.fillText(u,o,r.bounds.top+A),o+s.ctx.measureText(u).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(l){return l==="normal"||l==="small-caps"}).join(""),A=KP(r.fontFamily).join(", "),s=vu(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,A].join(" "),A,s]},t.prototype.renderTextNode=function(r,n){return jn(this,void 0,void 0,function(){var A,s,l,o,u,f,d,m,x=this;return Un(this,function(y){return A=this.createFontStyle(n),s=A[0],l=A[1],o=A[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(l,o),f=u.baseline,d=u.middle,m=n.paintOrder,r.textBounds.forEach(function(C){m.forEach(function(E){switch(E){case 0:x.ctx.fillStyle=on(n.color),x.renderTextWithLetterSpacing(C,n.letterSpacing,f);var T=n.textShadow;T.length&&C.text.trim().length&&(T.slice(0).reverse().forEach(function(_){x.ctx.shadowColor=on(_.color),x.ctx.shadowOffsetX=_.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=_.offsetY.number*x.options.scale,x.ctx.shadowBlur=_.blur.number,x.renderTextWithLetterSpacing(C,n.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=on(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(_){switch(_){case 1:x.ctx.fillRect(C.bounds.left,Math.round(C.bounds.top+f),C.bounds.width,1);break;case 2:x.ctx.fillRect(C.bounds.left,Math.round(C.bounds.top),C.bounds.width,1);break;case 3:x.ctx.fillRect(C.bounds.left,Math.ceil(C.bounds.top+d),C.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&C.text.trim().length&&(x.ctx.strokeStyle=on(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(C.text,C.bounds.left,C.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,A){if(A&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=td(r),l=ed(n);this.path(l),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(A,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return jn(this,void 0,void 0,function(){var n,A,s,l,o,u,F,F,f,d,m,x,I,y,C,M,E,T,_,F,S,I,M;return Un(this,function(Q){switch(Q.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,A=r.curves,s=n.styles,l=0,o=n.textNodes,Q.label=1;case 1:return l<o.length?(u=o[l],[4,this.renderTextNode(u,s)]):[3,4];case 2:Q.sent(),Q.label=3;case 3:return l++,[3,1];case 4:if(!(n instanceof qS))return[3,8];Q.label=5;case 5:return Q.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return F=Q.sent(),this.renderReplacedElement(n,A,F),[3,8];case 7:return Q.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof $S&&this.renderReplacedElement(n,A,n.canvas),!(n instanceof ZS))return[3,12];Q.label=9;case 9:return Q.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return F=Q.sent(),this.renderReplacedElement(n,A,F),[3,12];case 11:return Q.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof n_&&n.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,f.render(n.tree)]):[3,14];case 13:d=Q.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),Q.label=14;case 14:if(n instanceof mx&&(m=Math.min(n.bounds.width,n.bounds.height),n.type===Yf?n.checked&&(this.ctx.save(),this.path([new We(n.bounds.left+m*.39363,n.bounds.top+m*.79),new We(n.bounds.left+m*.16,n.bounds.top+m*.5549),new We(n.bounds.left+m*.27347,n.bounds.top+m*.44071),new We(n.bounds.left+m*.39694,n.bounds.top+m*.5649),new We(n.bounds.left+m*.72983,n.bounds.top+m*.23),new We(n.bounds.left+m*.84,n.bounds.top+m*.34085),new We(n.bounds.left+m*.39363,n.bounds.top+m*.79)]),this.ctx.fillStyle=on(xE),this.ctx.fill(),this.ctx.restore()):n.type===Wf&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+m/2,n.bounds.top+m/2,m/4,0,Math.PI*2,!0),this.ctx.fillStyle=on(xE),this.ctx.fill(),this.ctx.restore())),OP(n)&&n.value.length){switch(x=this.createFontStyle(s),I=x[0],y=x[1],C=this.fontMetrics.getMetrics(I,y).baseline,this.ctx.font=I,this.ctx.fillStyle=on(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=GP(n.styles.textAlign),M=td(n),E=0,n.styles.textAlign){case 1:E+=M.width/2;break;case 2:E+=M.width;break}T=M.add(E,0,0,-M.height/2+1),this.ctx.save(),this.path([new We(M.left,M.top),new We(M.left+M.width,M.top),new We(M.left+M.width,M.top+M.height),new We(M.left,M.top+M.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Hc(n.value,T),s.letterSpacing,C),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!An(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(_=n.styles.listStyleImage,_.type!==0)return[3,18];F=void 0,S=_.url,Q.label=15;case 15:return Q.trys.push([15,17,,18]),[4,this.context.cache.match(S)];case 16:return F=Q.sent(),this.ctx.drawImage(F,n.bounds.left-(F.width+10),n.bounds.top),[3,18];case 17:return Q.sent(),this.context.logger.error("Error loading list-style-image "+S),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(I=this.createFontStyle(s)[0],this.ctx.font=I,this.ctx.fillStyle=on(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",M=new ts(n.bounds.left,n.bounds.top+Br(n.styles.paddingTop,n.bounds.width),n.bounds.width,tE(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Hc(r.listValue,M),s.letterSpacing,tE(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Q.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return jn(this,void 0,void 0,function(){var n,A,_,s,l,_,o,u,_,f,d,_,m,x,_,y,C,_,E,T,_;return Un(this,function(F){switch(F.label){case 0:if(An(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:F.sent(),n=0,A=r.negativeZIndex,F.label=2;case 2:return n<A.length?(_=A[n],[4,this.renderStack(_)]):[3,5];case 3:F.sent(),F.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:F.sent(),s=0,l=r.nonInlineLevel,F.label=7;case 7:return s<l.length?(_=l[s],[4,this.renderNode(_)]):[3,10];case 8:F.sent(),F.label=9;case 9:return s++,[3,7];case 10:o=0,u=r.nonPositionedFloats,F.label=11;case 11:return o<u.length?(_=u[o],[4,this.renderStack(_)]):[3,14];case 12:F.sent(),F.label=13;case 13:return o++,[3,11];case 14:f=0,d=r.nonPositionedInlineLevel,F.label=15;case 15:return f<d.length?(_=d[f],[4,this.renderStack(_)]):[3,18];case 16:F.sent(),F.label=17;case 17:return f++,[3,15];case 18:m=0,x=r.inlineLevel,F.label=19;case 19:return m<x.length?(_=x[m],[4,this.renderNode(_)]):[3,22];case 20:F.sent(),F.label=21;case 21:return m++,[3,19];case 22:y=0,C=r.zeroOrAutoZIndexOrTransformedOrOpacity,F.label=23;case 23:return y<C.length?(_=C[y],[4,this.renderStack(_)]):[3,26];case 24:F.sent(),F.label=25;case 25:return y++,[3,23];case 26:E=0,T=r.positiveZIndex,F.label=27;case 27:return E<T.length?(_=T[E],[4,this.renderStack(_)]):[3,30];case 28:F.sent(),F.label=29;case 29:return E++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(A,s){var l=OA(A)?A.start:A;s===0?n.ctx.moveTo(l.x,l.y):n.ctx.lineTo(l.x,l.y),OA(A)&&n.ctx.bezierCurveTo(A.startControl.x,A.startControl.y,A.endControl.x,A.endControl.y,A.end.x,A.end.y)})},t.prototype.renderRepeat=function(r,n,A,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(A,s),this.ctx.fill(),this.ctx.translate(-A,-s)},t.prototype.resizeImage=function(r,n,A){var s;if(r.width===n&&r.height===A)return r;var l=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,o=l.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,A);var u=o.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,n,A),o},t.prototype.renderBackgroundImage=function(r){return jn(this,void 0,void 0,function(){var n,A,s,l,o,u;return Un(this,function(f){switch(f.label){case 0:n=r.styles.backgroundImage.length-1,A=function(d){var m,x,y,te,q,oe,ae,Se,G,C,te,q,oe,ae,Se,E,T,_,F,S,I,M,Q,U,G,R,te,ne,ee,ae,Se,Te,q,oe,Re,ie,Me,X,k,K,P,z;return Un(this,function(Z){switch(Z.label){case 0:if(d.type!==0)return[3,5];m=void 0,x=d.url,Z.label=1;case 1:return Z.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return m=Z.sent(),[3,4];case 3:return Z.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return m&&(y=Sm(r,n,[m.width,m.height,m.width/m.height]),te=y[0],q=y[1],oe=y[2],ae=y[3],Se=y[4],G=s.ctx.createPattern(s.resizeImage(m,ae,Se),"repeat"),s.renderRepeat(te,G,q,oe)),[3,6];case 5:T8(d)?(C=Sm(r,n,[null,null,null]),te=C[0],q=C[1],oe=C[2],ae=C[3],Se=C[4],E=w8(d.angle,ae,Se),T=E[0],_=E[1],F=E[2],S=E[3],I=E[4],M=document.createElement("canvas"),M.width=ae,M.height=Se,Q=M.getContext("2d"),U=Q.createLinearGradient(_,S,F,I),ZC(d.stops,T).forEach(function(le){return U.addColorStop(le.stop,on(le.color))}),Q.fillStyle=U,Q.fillRect(0,0,ae,Se),ae>0&&Se>0&&(G=s.ctx.createPattern(M,"repeat"),s.renderRepeat(te,G,q,oe))):S8(d)&&(R=Sm(r,n,[null,null,null]),te=R[0],ne=R[1],ee=R[2],ae=R[3],Se=R[4],Te=d.position.length===0?[fx]:d.position,q=Br(Te[0],ae),oe=Br(Te[Te.length-1],Se),Re=y8(d,q,oe,ae,Se),ie=Re[0],Me=Re[1],ie>0&&Me>0&&(X=s.ctx.createRadialGradient(ne+q,ee+oe,0,ne+q,ee+oe,ie),ZC(d.stops,ie*2).forEach(function(le){return X.addColorStop(le.stop,on(le.color))}),s.path(te),s.ctx.fillStyle=X,ie!==Me?(k=r.bounds.left+.5*r.bounds.width,K=r.bounds.top+.5*r.bounds.height,P=Me/ie,z=1/P,s.ctx.save(),s.ctx.translate(k,K),s.ctx.transform(1,0,0,P,0,0),s.ctx.translate(-k,-K),s.ctx.fillRect(ne,z*(ee-K)+K,ae,Se*z),s.ctx.restore()):s.ctx.fill())),Z.label=6;case 6:return n--,[2]}})},s=this,l=0,o=r.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return l<o.length?(u=o[l],[5,A(u)]):[3,4];case 2:f.sent(),f.label=3;case 3:return l++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,A){return jn(this,void 0,void 0,function(){return Un(this,function(s){return this.path(UE(A,n)),this.ctx.fillStyle=on(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,A,s){return jn(this,void 0,void 0,function(){var l,o;return Un(this,function(u){switch(u.label){case 0:return n<3?[4,this.renderSolidBorder(r,A,s)]:[3,2];case 1:return u.sent(),[2];case 2:return l=FP(s,A),this.path(l),this.ctx.fillStyle=on(r),this.ctx.fill(),o=UP(s,A),this.path(o),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return jn(this,void 0,void 0,function(){var n,A,s,l,o,u,f,d,m=this;return Un(this,function(x){switch(x.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,A=!Xs(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],l=PP(Jl(n.backgroundClip,0),r.curves),A||n.boxShadow.length?(this.ctx.save(),this.path(l),this.ctx.clip(),Xs(n.backgroundColor)||(this.ctx.fillStyle=on(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(y){m.ctx.save();var C=Zf(r.curves),E=y.inset?0:LP,T=_P(C,-E+(y.inset?1:-1)*y.spread.number,(y.inset?1:-1)*y.spread.number,y.spread.number*(y.inset?-2:2),y.spread.number*(y.inset?-2:2));y.inset?(m.path(C),m.ctx.clip(),m.mask(T)):(m.mask(C),m.ctx.clip(),m.path(T)),m.ctx.shadowOffsetX=y.offsetX.number+E,m.ctx.shadowOffsetY=y.offsetY.number,m.ctx.shadowColor=on(y.color),m.ctx.shadowBlur=y.blur.number,m.ctx.fillStyle=y.inset?on(y.color):"rgba(0,0,0,1)",m.ctx.fill(),m.ctx.restore()}),x.label=2;case 2:o=0,u=0,f=s,x.label=3;case 3:return u<f.length?(d=f[u],d.style!==0&&!Xs(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,o,r.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,o,r.curves,3)];case 6:return x.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,o,r.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,o,r.curves)];case 10:x.sent(),x.label=11;case 11:o++,x.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,A,s,l){return jn(this,void 0,void 0,function(){var o,u,f,d,m,x,y,C,E,T,_,F,S,I,M,Q,M,Q;return Un(this,function(U){return this.ctx.save(),o=kP(s,A),u=UE(s,A),l===2&&(this.path(u),this.ctx.clip()),OA(u[0])?(f=u[0].start.x,d=u[0].start.y):(f=u[0].x,d=u[0].y),OA(u[1])?(m=u[1].end.x,x=u[1].end.y):(m=u[1].x,x=u[1].y),A===0||A===2?y=Math.abs(f-m):y=Math.abs(d-x),this.ctx.beginPath(),l===3?this.formatPath(o):this.formatPath(u.slice(0,2)),C=n<3?n*3:n*2,E=n<3?n*2:n,l===3&&(C=n,E=n),T=!0,y<=C*2?T=!1:y<=C*2+E?(_=y/(2*C+E),C*=_,E*=_):(F=Math.floor((y+E)/(C+E)),S=(y-F*C)/(F-1),I=(y-(F+1)*C)/F,E=I<=0||Math.abs(E-S)<Math.abs(E-I)?S:I),T&&(l===3?this.ctx.setLineDash([0,C+E]):this.ctx.setLineDash([C,E])),l===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=on(r),this.ctx.stroke(),this.ctx.setLineDash([]),l===2&&(OA(u[0])&&(M=u[3],Q=u[0],this.ctx.beginPath(),this.formatPath([new We(M.end.x,M.end.y),new We(Q.start.x,Q.start.y)]),this.ctx.stroke()),OA(u[1])&&(M=u[1],Q=u[2],this.ctx.beginPath(),this.formatPath([new We(M.end.x,M.end.y),new We(Q.start.x,Q.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return jn(this,void 0,void 0,function(){var n;return Un(this,function(A){switch(A.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=on(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=bP(r),[4,this.renderStack(n)];case 1:return A.sent(),this.applyEffects([]),[2,this.canvas]}})})},t})(v_),OP=function(e){return e instanceof r_||e instanceof t_?!0:e instanceof mx&&e.type!==Wf&&e.type!==Yf},PP=function(e,t){switch(e){case 0:return Zf(t);case 2:return BP(t);case 1:default:return ed(t)}},GP=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},VP=["-apple-system","system-ui"],KP=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return VP.indexOf(t)===-1}):e},jP=(function(e){ia(t,e);function t(r,n){var A=e.call(this,r,n)||this;return A.canvas=n.canvas?n.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),A.options=n,A.canvas.width=Math.floor(n.width*n.scale),A.canvas.height=Math.floor(n.height*n.scale),A.canvas.style.width=n.width+"px",A.canvas.style.height=n.height+"px",A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-n.x,-n.y),A.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),A}return t.prototype.render=function(r){return jn(this,void 0,void 0,function(){var n,A;return Un(this,function(s){switch(s.label){case 0:return n=bp(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,zP(n)];case 1:return A=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=on(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(A,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t})(v_),zP=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},XP=(function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,K0([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,K0([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,K0([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,K0([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e})(),JP=(function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new XP({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new hP(this,t)}return e.instanceCount=1,e})(),Pc=function(e,t){return t===void 0&&(t={}),YP(e,t)};typeof window<"u"&&d_.setContext(window);var YP=function(e,t){return jn(void 0,void 0,void 0,function(){var r,n,A,s,l,o,u,f,d,m,x,y,C,E,T,_,F,S,I,M,U,Q,U,G,R,te,ne,ee,ae,Se,Te,q,oe,Re,ie,Me,X,k,K,P;return Un(this,function(z){switch(z.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return A={allowTaint:(G=t.allowTaint)!==null&&G!==void 0?G:!1,imageTimeout:(R=t.imageTimeout)!==null&&R!==void 0?R:15e3,proxy:t.proxy,useCORS:(te=t.useCORS)!==null&&te!==void 0?te:!1},s=dp({logging:(ne=t.logging)!==null&&ne!==void 0?ne:!0,cache:t.cache},A),l={windowWidth:(ee=t.windowWidth)!==null&&ee!==void 0?ee:n.innerWidth,windowHeight:(ae=t.windowHeight)!==null&&ae!==void 0?ae:n.innerHeight,scrollX:(Se=t.scrollX)!==null&&Se!==void 0?Se:n.pageXOffset,scrollY:(Te=t.scrollY)!==null&&Te!==void 0?Te:n.pageYOffset},o=new ts(l.scrollX,l.scrollY,l.windowWidth,l.windowHeight),u=new JP(s,o),f=(q=t.foreignObjectRendering)!==null&&q!==void 0?q:!1,d={allowTaint:(oe=t.allowTaint)!==null&&oe!==void 0?oe:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},u.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),m=new _E(u,e,d),x=m.clonedReferenceElement,x?[4,m.toIFrame(r,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return y=z.sent(),C=px(x)||qO(x)?_H(x.ownerDocument):Sd(u,x),E=C.width,T=C.height,_=C.left,F=C.top,S=WP(u,x,t.backgroundColor),I={canvas:t.canvas,backgroundColor:S,scale:(ie=(Re=t.scale)!==null&&Re!==void 0?Re:n.devicePixelRatio)!==null&&ie!==void 0?ie:1,x:((Me=t.x)!==null&&Me!==void 0?Me:0)+_,y:((X=t.y)!==null&&X!==void 0?X:0)+F,width:(k=t.width)!==null&&k!==void 0?k:Math.ceil(E),height:(K=t.height)!==null&&K!==void 0?K:Math.ceil(T)},f?(u.logger.debug("Document cloned, using foreign object rendering"),U=new jP(u,I),[4,U.render(x)]):[3,3];case 2:return M=z.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+_+","+F+" with size "+E+"x"+T+" using computed rendering"),u.logger.debug("Starting DOM parsing"),Q=a_(u,x),S===Q.styles.backgroundColor&&(Q.styles.backgroundColor=Ya.TRANSPARENT),u.logger.debug("Starting renderer for element at "+I.x+","+I.y+" with size "+I.width+"x"+I.height),U=new HP(u,I),[4,U.render(Q)];case 4:M=z.sent(),z.label=5;case 5:return(!((P=t.removeContainer)!==null&&P!==void 0)||P)&&(_E.destroy(y)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,M]}})})},WP=function(e,t,r){var n=t.ownerDocument,A=n.documentElement?Mc(e,getComputedStyle(n.documentElement).backgroundColor):Ya.TRANSPARENT,s=n.body?Mc(e,getComputedStyle(n.body).backgroundColor):Ya.TRANSPARENT,l=typeof r=="string"?Mc(e,r):r===null?Ya.TRANSPARENT:4294967295;return t===n.documentElement?Xs(A)?Xs(s)?l:s:A:l};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rd={};rd.version="0.18.5";var w_=1252,qP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vx=function(e){qP.indexOf(e)!=-1&&(w_=xx[0]=e)};function $P(){vx(1252)}var ea=function(e){vx(e)};function wx(){ea(1200),$P()}function NE(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function ZP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function y_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Nc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?ZP(e.slice(2)):t==254&&r==255?y_(e.slice(2)):t==65279?e.slice(1):e},hf=function(t){return String.fromCharCode(t)},IE=function(t){return String.fromCharCode(t)},ru,Ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function nu(e){for(var t="",r=0,n=0,A=0,s=0,l=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),s=r>>2,n=e.charCodeAt(f++),l=(r&3)<<4|n>>4,A=e.charCodeAt(f++),o=(n&15)<<2|A>>6,u=A&63,isNaN(n)?o=u=64:isNaN(A)&&(u=64),t+=Ks.charAt(s)+Ks.charAt(l)+Ks.charAt(o)+Ks.charAt(u);return t}function wA(e){var t="",r=0,n=0,A=0,s=0,l=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)s=Ks.indexOf(e.charAt(f++)),l=Ks.indexOf(e.charAt(f++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=Ks.indexOf(e.charAt(f++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=Ks.indexOf(e.charAt(f++)),A=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(A));return t}var kt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ss=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ys(e){return kt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function QE(e){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var pA=function(t){return kt?ss(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Dd(e){if(typeof ArrayBuffer>"u")return pA(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ei(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function e7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function yx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return yx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var un=kt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ss(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),A=0;for(t=0,r=0;t<e.length;r+=A,++t)if(A=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function t7(e){for(var t=[],r=0,n=e.length+250,A=Ys(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)A[r++]=l;else if(l<2048)A[r++]=192|l>>6&31,A[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;A[r++]=240|l>>8&7,A[r++]=128|l>>2&63,A[r++]=128|o>>6&15|(l&3)<<4,A[r++]=128|o&63}else A[r++]=224|l>>12&15,A[r++]=128|l>>6&63,A[r++]=128|l&63;r>n&&(t.push(A.slice(0,r)),r=0,A=Ys(65535),n=65530)}return t.push(A.slice(0,r)),un(t)}var Jn=/\u0000/g,Ic=/[\u0001-\u0006]/g;function no(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ta(e,t){var r=""+e;return r.length>=t?r:Mr("0",t-r.length)+r}function Bx(e,t){var r=""+e;return r.length>=t?r:Mr(" ",t-r.length)+r}function nd(e,t){var r=""+e;return r.length>=t?r:r+Mr(" ",t-r.length)}function r7(e,t){var r=""+Math.round(e);return r.length>=t?r:Mr("0",t-r.length)+r}function n7(e,t){var r=""+e;return r.length>=t?r:Mr("0",t-r.length)+r}var RE=Math.pow(2,32);function Pl(e,t){if(e>RE||e<-RE)return r7(e,t);var r=Math.round(e);return n7(r,t)}function Ad(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var DE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_m=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function A7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var dt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ME={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ad(e,t,r){for(var n=e<0?-1:1,A=e*n,s=0,l=1,o=0,u=1,f=0,d=0,m=Math.floor(A);f<t&&(m=Math.floor(A),o=m*l+s,d=m*f+u,!(A-m<5e-8));)A=1/(A-m),s=l,l=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=s):(d=f,o=l)),!r)return[0,n*o,d];var x=Math.floor(n*o/d);return[x,n*o-x*d,d]}function ki(e,t,r){if(e>2958465||e<0)return null;var n=e|0,A=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:A,u:86400*(e-n)-A,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++A==86400&&(o.T=A=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),l=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=u7(u,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=A%60,A=Math.floor(A/60),o.M=A%60,A=Math.floor(A/60),o.H=A,o.q=s,o}var B_=new Date(1899,11,31,0,0,0),s7=B_.getTime(),i7=new Date(1900,2,1,0,0,0);function C_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=i7&&(r+=1440*60*1e3),(r-(s7+(e.getTimezoneOffset()-B_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Cx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function l7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function o7(e){var t=e<0?12:11,r=Cx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function c7(e){var t=Cx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Au(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=o7(e):t===10?r=e.toFixed(10).substr(0,12):r=c7(e),Cx(l7(r.toUpperCase()))}function Li(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Au(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return zA(14,C_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function u7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function f7(e,t,r,n){var A="",s=0,l=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return _m[r.m-1][1];case 5:return _m[r.m-1][0];default:return _m[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return DE[r.q][0];default:return DE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ta(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(A=ta(s,2+n),t==="ss"?A.substr(0,2):"."+A.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?ta(u,f):"";return d}function js(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var E_=/%/g;function d7(e,t,r){var n=t.replace(E_,""),A=t.length-n.length;return Wa(e,n,r*Math.pow(10,2*A))+Mr("%",A)}function h7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function T_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+T_(e,-t);var A=e.indexOf(".");A===-1&&(A=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%A;if(s<0&&(s+=A),r=(t/Math.pow(10,s)).toPrecision(n+1+(A+s)%A),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,A)+"."+r.substr(2+A),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(A+s)%A)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var S_=/# (\?+)( ?)\/( ?)(\d+)/;function g7(e,t,r){var n=parseInt(e[4],10),A=Math.round(t*n),s=Math.floor(A/n),l=A-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?Mr(" ",e[1].length+1+e[4].length):Bx(l,e[1].length)+e[2]+"/"+e[3]+ta(o,e[4].length))}function m7(e,t,r){return r+(t===0?"":""+t)+Mr(" ",e[1].length+2+e[4].length)}var __=/^#*0*\.([0#]+)/,b_=/\).*[0#]/,F_=/\(###\) ###\\?-####/;function zn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function LE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function HE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function p7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function x7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function QA(e,t,r){if(e.charCodeAt(0)===40&&!t.match(b_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?QA("n",n,r):"("+QA("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return h7(e,t,r);if(t.indexOf("%")!==-1)return d7(e,t,r);if(t.indexOf("E")!==-1)return T_(t,r);if(t.charCodeAt(0)===36)return"$"+QA(e,t.substr(t.charAt(1)==" "?2:1),r);var A,s,l,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Pl(u,t.length);if(t.match(/^[#?]+$/))return A=Pl(r,0),A==="0"&&(A=""),A.length>t.length?A:zn(t.substr(0,t.length-A.length))+A;if(s=t.match(S_))return g7(s,u,f);if(t.match(/^#+0+$/))return f+Pl(u,t.length-t.indexOf("0"));if(s=t.match(__))return A=LE(r,s[1].length).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])).replace(/\.(\d*)$/,function(C,E){return"."+E+Mr("0",zn(s[1]).length-E.length)}),t.indexOf("0.")!==-1?A:A.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+LE(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+js(Pl(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+QA(e,t,-r):js(""+(Math.floor(r)+p7(r,s[1].length)))+"."+ta(HE(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return QA(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return A=no(QA(e,t.replace(/[\\-]/g,""),r)),l=0,no(no(t.replace(/\\/g,"")).replace(/[0#]/g,function(C){return l<A.length?A.charAt(l++):C==="0"?"0":""}));if(t.match(F_))return A=QA(e,"##########",r),"("+A.substr(0,3)+") "+A.substr(3,3)+"-"+A.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=ad(u,Math.pow(10,l)-1,!1),A=""+f,d=Wa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),A+=d+s[2]+"/"+s[3],d=nd(o[2],l),d.length<s[4].length&&(d=zn(s[4].substr(s[4].length-d.length))+d),A+=d,A;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=ad(u,Math.pow(10,l)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bx(o[1],l)+s[2]+"/"+s[3]+nd(o[2],l):Mr(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return A=Pl(r,0),t.length<=A.length?A:zn(t.substr(0,t.length-A.length))+A;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){A=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=A.indexOf(".");var m=t.indexOf(".")-l,x=t.length-A.length-m;return zn(t.substr(0,m)+A+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=HE(r,s[1].length),r<0?"-"+QA(e,t,-r):js(x7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?ta(0,3-C.length):"")+C})+"."+ta(l,s[1].length);switch(t){case"###,##0.00":return QA(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=js(Pl(u,0));return y!=="0"?f+y:"";case"###,###.00":return QA(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return QA(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function v7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function w7(e,t,r){var n=t.replace(E_,""),A=t.length-n.length;return Wa(e,n,r*Math.pow(10,2*A))+Mr("%",A)}function U_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+U_(e,-t);var A=e.indexOf(".");A===-1&&(A=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%A;if(s<0&&(s+=A),r=(t/Math.pow(10,s)).toPrecision(n+1+(A+s)%A),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(A+s)%A)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ga(e,t,r){if(e.charCodeAt(0)===40&&!t.match(b_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ga("n",n,r):"("+ga("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return v7(e,t,r);if(t.indexOf("%")!==-1)return w7(e,t,r);if(t.indexOf("E")!==-1)return U_(t,r);if(t.charCodeAt(0)===36)return"$"+ga(e,t.substr(t.charAt(1)==" "?2:1),r);var A,s,l,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ta(u,t.length);if(t.match(/^[#?]+$/))return A=""+r,r===0&&(A=""),A.length>t.length?A:zn(t.substr(0,t.length-A.length))+A;if(s=t.match(S_))return m7(s,u,f);if(t.match(/^#+0+$/))return f+ta(u,t.length-t.indexOf("0"));if(s=t.match(__))return A=(""+r).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])),A=A.replace(/\.(\d*)$/,function(C,E){return"."+E+Mr("0",zn(s[1]).length-E.length)}),t.indexOf("0.")!==-1?A:A.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+js(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ga(e,t,-r):js(""+r)+"."+Mr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ga(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return A=no(ga(e,t.replace(/[\\-]/g,""),r)),l=0,no(no(t.replace(/\\/g,"")).replace(/[0#]/g,function(C){return l<A.length?A.charAt(l++):C==="0"?"0":""}));if(t.match(F_))return A=ga(e,"##########",r),"("+A.substr(0,3)+") "+A.substr(3,3)+"-"+A.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=ad(u,Math.pow(10,l)-1,!1),A=""+f,d=Wa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),A+=d+s[2]+"/"+s[3],d=nd(o[2],l),d.length<s[4].length&&(d=zn(s[4].substr(s[4].length-d.length))+d),A+=d,A;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=ad(u,Math.pow(10,l)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bx(o[1],l)+s[2]+"/"+s[3]+nd(o[2],l):Mr(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return A=""+r,t.length<=A.length?A:zn(t.substr(0,t.length-A.length))+A;if(s=t.match(/^([#0]+)\.([#0]+)$/)){A=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=A.indexOf(".");var m=t.indexOf(".")-l,x=t.length-A.length-m;return zn(t.substr(0,m)+A+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ga(e,t,-r):js(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?ta(0,3-C.length):"")+C})+"."+ta(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=js(""+u);return y!=="0"?f+y:"";default:if(t.match(/\.[0#?]*$/))return ga(e,t.slice(0,t.lastIndexOf(".")),r)+zn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wa(e,t,r){return(r|0)===r?ga(e,t,r):QA(e,t,r)}function y7(e){for(var t=[],r=!1,n=0,A=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(A,n-A),A=n+1}if(t[t.length]=e.substr(A),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var k_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function vo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ad(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(k_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function B7(e,t,r,n){for(var A=[],s="",l=0,o="",u="t",f,d,m,x="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Ad(e,l))throw new Error("unrecognized character "+o+" in "+e);A[A.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(m=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(m);A[A.length]={t:"t",v:s},++l;break;case"\\":var y=e.charAt(++l),C=y==="("||y===")"?y:"t";A[A.length]={t:C,v:y},++l;break;case"_":A[A.length]={t:"t",v:" "},l+=2;break;case"@":A[A.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(f==null&&(f=ki(t,r,e.charAt(l+1)==="2"),f==null))return"";A[A.length]={t:"X",v:e.substr(l,2)},u=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=ki(t,r),f==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=x),A[A.length]={t:o,v:s},u=o;break;case"A":case"a":case"":var E={t:o,v:o};if(f==null&&(f=ki(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(E.v=f.H>=12?"P":"A"),E.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(E.v=f.H>=12?"PM":"AM"),E.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="/"?(f!=null&&(E.v=f.H>=12?"":""),E.t="T",l+=5,x="h"):(E.t="t",++l),f==null&&E.t==="T")return"";A[A.length]=E,u=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(k_)){if(f==null&&(f=ki(t,r),f==null))return"";A[A.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",vo(e)||(A[A.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;A[A.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;A[A.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;A[A.length]={t:o,v:s},u=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":A[A.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);A[A.length]={t:"D",v:s};break;case" ":A[A.length]={t:o,v:o},++l;break;case"$":A[A.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);A[A.length]={t:"t",v:o},++l;break}var T=0,_=0,F;for(l=A.length-1,u="t";l>=0;--l)switch(A[l].t){case"h":case"H":A[l].t=x,u="h",T<1&&(T=1);break;case"s":(F=A[l].v.match(/\.0+$/))&&(_=Math.max(_,F[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":u=A[l].t;break;case"m":u==="s"&&(A[l].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&A[l].v.match(/[Hh]/)&&(T=1),T<2&&A[l].v.match(/[Mm]/)&&(T=2),T<3&&A[l].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",I;for(l=0;l<A.length;++l)switch(A[l].t){case"t":case"T":case" ":case"D":break;case"X":A[l].v="",A[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":A[l].v=f7(A[l].t.charCodeAt(0),A[l].v,f,_),A[l].t="t";break;case"n":case"?":for(I=l+1;A[I]!=null&&((o=A[I].t)==="?"||o==="D"||(o===" "||o==="t")&&A[I+1]!=null&&(A[I+1].t==="?"||A[I+1].t==="t"&&A[I+1].v==="/")||A[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(A[I].v==="/"||A[I].v===" "&&A[I+1]!=null&&A[I+1].t=="?"));)A[l].v+=A[I].v,A[I]={v:"",t:";"},++I;S+=A[l].v,l=I-1;break;case"G":A[l].t="t",A[l].v=Li(t,r);break}var M="",Q,U;if(S.length>0){S.charCodeAt(0)==40?(Q=t<0&&S.charCodeAt(0)===45?-t:t,U=Wa("n",S,Q)):(Q=t<0&&n>1?-t:t,U=Wa("n",S,Q),Q<0&&A[0]&&A[0].t=="t"&&(U=U.substr(1),A[0].v="-"+A[0].v)),I=U.length-1;var G=A.length;for(l=0;l<A.length;++l)if(A[l]!=null&&A[l].t!="t"&&A[l].v.indexOf(".")>-1){G=l;break}var R=A.length;if(G===A.length&&U.indexOf("E")===-1){for(l=A.length-1;l>=0;--l)A[l]==null||"n?".indexOf(A[l].t)===-1||(I>=A[l].v.length-1?(I-=A[l].v.length,A[l].v=U.substr(I+1,A[l].v.length)):I<0?A[l].v="":(A[l].v=U.substr(0,I+1),I=-1),A[l].t="t",R=l);I>=0&&R<A.length&&(A[R].v=U.substr(0,I+1)+A[R].v)}else if(G!==A.length&&U.indexOf("E")===-1){for(I=U.indexOf(".")-1,l=G;l>=0;--l)if(!(A[l]==null||"n?".indexOf(A[l].t)===-1)){for(d=A[l].v.indexOf(".")>-1&&l===G?A[l].v.indexOf(".")-1:A[l].v.length-1,M=A[l].v.substr(d+1);d>=0;--d)I>=0&&(A[l].v.charAt(d)==="0"||A[l].v.charAt(d)==="#")&&(M=U.charAt(I--)+M);A[l].v=M,A[l].t="t",R=l}for(I>=0&&R<A.length&&(A[R].v=U.substr(0,I+1)+A[R].v),I=U.indexOf(".")+1,l=G;l<A.length;++l)if(!(A[l]==null||"n?(".indexOf(A[l].t)===-1&&l!==G)){for(d=A[l].v.indexOf(".")>-1&&l===G?A[l].v.indexOf(".")+1:0,M=A[l].v.substr(0,d);d<A[l].v.length;++d)I<U.length&&(M+=U.charAt(I++));A[l].v=M,A[l].t="t",R=l}}}for(l=0;l<A.length;++l)A[l]!=null&&"n?".indexOf(A[l].t)>-1&&(Q=n>1&&t<0&&l>0&&A[l-1].v==="-"?-t:t,A[l].v=Wa(A[l].t,A[l].v,Q),A[l].t="t");var te="";for(l=0;l!==A.length;++l)A[l]!=null&&(te+=A[l].v);return te}var OE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function PE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function C7(e,t){var r=y7(e),n=r.length,A=r[n-1].indexOf("@");if(n<4&&A>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||A>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=A>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=A>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=A>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(OE),o=r[1].match(OE);return PE(t,l)?[n,r[0]]:PE(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function zA(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:dt)[e],n==null&&(n=r.table&&r.table[ME[e]]||dt[ME[e]]),n==null&&(n=a7[e]||"General");break}if(Ad(n,0))return Li(t,r);t instanceof Date&&(t=C_(t,r.date1904));var A=C7(n,t);if(Ad(A[1]))return Li(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return B7(A[1],t,r,A[0])}function qa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(dt[r]==null){t<0&&(t=r);continue}if(dt[r]==e){t=r;break}}t<0&&(t=391)}return dt[t]=e,t}function Md(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qa(e[t],t)}function wo(){dt=A7()}var E7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},N_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function T7(e){var t=typeof e=="number"?dt[e]:e;return t=t.replace(N_,"(\\d+)"),new RegExp("^"+t+"$")}function S7(e,t,r){var n=-1,A=-1,s=-1,l=-1,o=-1,u=-1;(t.match(N_)||[]).forEach(function(m,x){var y=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":l=y;break;case"s":u=y;break;case"m":l>=0?o=y:A=y;break}}),u>=0&&o==-1&&A>=0&&(o=A,A=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(A>=1?A:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return l==-1&&o==-1&&u==-1?f:n==-1&&A==-1&&s==-1?d:f+"T"+d}var _7=(function(){var e={};e.version="1.2.0";function t(){for(var U=0,G=new Array(256),R=0;R!=256;++R)U=R,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,G[R]=U;return typeof Int32Array<"u"?new Int32Array(G):G}var r=t();function n(U){var G=0,R=0,te=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)ne[te]=U[te];for(te=0;te!=256;++te)for(R=U[te],G=256+te;G<4096;G+=256)R=ne[G]=R>>>8^U[R&255];var ee=[];for(te=1;te!=16;++te)ee[te-1]=typeof Int32Array<"u"?ne.subarray(te*256,te*256+256):ne.slice(te*256,te*256+256);return ee}var A=n(r),s=A[0],l=A[1],o=A[2],u=A[3],f=A[4],d=A[5],m=A[6],x=A[7],y=A[8],C=A[9],E=A[10],T=A[11],_=A[12],F=A[13],S=A[14];function I(U,G){for(var R=G^-1,te=0,ne=U.length;te<ne;)R=R>>>8^r[(R^U.charCodeAt(te++))&255];return~R}function M(U,G){for(var R=G^-1,te=U.length-15,ne=0;ne<te;)R=S[U[ne++]^R&255]^F[U[ne++]^R>>8&255]^_[U[ne++]^R>>16&255]^T[U[ne++]^R>>>24]^E[U[ne++]]^C[U[ne++]]^y[U[ne++]]^x[U[ne++]]^m[U[ne++]]^d[U[ne++]]^f[U[ne++]]^u[U[ne++]]^o[U[ne++]]^l[U[ne++]]^s[U[ne++]]^r[U[ne++]];for(te+=15;ne<te;)R=R>>>8^r[(R^U[ne++])&255];return~R}function Q(U,G){for(var R=G^-1,te=0,ne=U.length,ee=0,ae=0;te<ne;)ee=U.charCodeAt(te++),ee<128?R=R>>>8^r[(R^ee)&255]:ee<2048?(R=R>>>8^r[(R^(192|ee>>6&31))&255],R=R>>>8^r[(R^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,ae=U.charCodeAt(te++)&1023,R=R>>>8^r[(R^(240|ee>>8&7))&255],R=R>>>8^r[(R^(128|ee>>2&63))&255],R=R>>>8^r[(R^(128|ae>>6&15|(ee&3)<<4))&255],R=R>>>8^r[(R^(128|ae&63))&255]):(R=R>>>8^r[(R^(224|ee>>12&15))&255],R=R>>>8^r[(R^(128|ee>>6&63))&255],R=R>>>8^r[(R^(128|ee&63))&255]);return~R}return e.table=r,e.bstr=I,e.buf=M,e.str=Q,e})(),lt=(function(){var t={};t.version="1.2.1";function r(N,j){for(var H=N.split("/"),O=j.split("/"),V=0,J=0,pe=Math.min(H.length,O.length);V<pe;++V){if(J=H[V].length-O[V].length)return J;if(H[V]!=O[V])return H[V]<O[V]?-1:1}return H.length-O.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var j=N.lastIndexOf("/");return j===-1?N:N.slice(0,j+1)}function A(N){if(N.charAt(N.length-1)=="/")return A(N.slice(0,-1));var j=N.lastIndexOf("/");return j===-1?N:N.slice(j+1)}function s(N,j){typeof j=="string"&&(j=new Date(j));var H=j.getHours();H=H<<6|j.getMinutes(),H=H<<5|j.getSeconds()>>>1,N.write_shift(2,H);var O=j.getFullYear()-1980;O=O<<4|j.getMonth()+1,O=O<<5|j.getDate(),N.write_shift(2,O)}function l(N){var j=N.read_shift(2)&65535,H=N.read_shift(2)&65535,O=new Date,V=H&31;H>>>=5;var J=H&15;H>>>=4,O.setMilliseconds(0),O.setFullYear(H+1980),O.setMonth(J-1),O.setDate(V);var pe=j&31;j>>>=5;var be=j&63;return j>>>=6,O.setHours(j),O.setMinutes(be),O.setSeconds(pe<<1),O}function o(N){Bn(N,0);for(var j={},H=0;N.l<=N.length-4;){var O=N.read_shift(2),V=N.read_shift(2),J=N.l+V,pe={};switch(O){case 21589:H=N.read_shift(1),H&1&&(pe.mtime=N.read_shift(4)),V>5&&(H&2&&(pe.atime=N.read_shift(4)),H&4&&(pe.ctime=N.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}N.l=J,j[O]=pe}return j}var u;function f(){return u||(u={})}function d(N,j){if(N[0]==80&&N[1]==75)return hn(N,j);if((N[0]|32)==109&&(N[1]|32)==105)return la(N,j);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var H=3,O=512,V=0,J=0,pe=0,be=0,xe=0,ve=[],we=N.slice(0,512);Bn(we,0);var Le=m(we);switch(H=Le[0],H){case 3:O=512;break;case 4:O=4096;break;case 0:if(Le[1]==0)return hn(N,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}O!==512&&(we=N.slice(0,O),Bn(we,28));var Oe=N.slice(0,O);x(we,H);var ze=we.read_shift(4,"i");if(H===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);we.l+=4,pe=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),be=we.read_shift(4,"i"),V=we.read_shift(4,"i"),xe=we.read_shift(4,"i"),J=we.read_shift(4,"i");for(var He=-1,Ke=0;Ke<109&&(He=we.read_shift(4,"i"),!(He<0));++Ke)ve[Ke]=He;var At=y(N,O);T(xe,J,At,O,ve);var cr=F(At,pe,ve,O);cr[pe].name="!Directory",V>0&&be!==ae&&(cr[be].name="!MiniFAT"),cr[ve[0]].name="!FAT",cr.fat_addrs=ve,cr.ssz=O;var Ft={},ur=[],Sn=[],JA=[];S(pe,cr,At,ur,V,Ft,Sn,be),C(Sn,JA,ur),ur.shift();var BA={FileIndex:Sn,FullPaths:JA};return j&&j.raw&&(BA.raw={header:Oe,sectors:At}),BA}function m(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Se,"Header Signature: "),N.l+=16;var j=N.read_shift(2,"u");return[N.read_shift(2,"u"),j]}function x(N,j){var H=9;switch(N.l+=2,H=N.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function y(N,j){for(var H=Math.ceil(N.length/j)-1,O=[],V=1;V<H;++V)O[V-1]=N.slice(V*j,(V+1)*j);return O[H-1]=N.slice(H*j),O}function C(N,j,H){for(var O=0,V=0,J=0,pe=0,be=0,xe=H.length,ve=[],we=[];O<xe;++O)ve[O]=we[O]=O,j[O]=H[O];for(;be<we.length;++be)O=we[be],V=N[O].L,J=N[O].R,pe=N[O].C,ve[O]===O&&(V!==-1&&ve[V]!==V&&(ve[O]=ve[V]),J!==-1&&ve[J]!==J&&(ve[O]=ve[J])),pe!==-1&&(ve[pe]=O),V!==-1&&O!=ve[O]&&(ve[V]=ve[O],we.lastIndexOf(V)<be&&we.push(V)),J!==-1&&O!=ve[O]&&(ve[J]=ve[O],we.lastIndexOf(J)<be&&we.push(J));for(O=1;O<xe;++O)ve[O]===O&&(J!==-1&&ve[J]!==J?ve[O]=ve[J]:V!==-1&&ve[V]!==V&&(ve[O]=ve[V]));for(O=1;O<xe;++O)if(N[O].type!==0){if(be=O,be!=ve[be])do be=ve[be],j[O]=j[be]+"/"+j[O];while(be!==0&&ve[be]!==-1&&be!=ve[be]);ve[O]=-1}for(j[0]+="/",O=1;O<xe;++O)N[O].type!==2&&(j[O]+="/")}function E(N,j,H){for(var O=N.start,V=N.size,J=[],pe=O;H&&V>0&&pe>=0;)J.push(j.slice(pe*ee,pe*ee+ee)),V-=ee,pe=Fi(H,pe*4);return J.length===0?_e(0):un(J).slice(0,N.size)}function T(N,j,H,O,V){var J=ae;if(N===ae){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var pe=H[N],be=(O>>>2)-1;if(!pe)return;for(var xe=0;xe<be&&(J=Fi(pe,xe*4))!==ae;++xe)V.push(J);T(Fi(pe,O-4),j-1,H,O,V)}}function _(N,j,H,O,V){var J=[],pe=[];V||(V=[]);var be=O-1,xe=0,ve=0;for(xe=j;xe>=0;){V[xe]=!0,J[J.length]=xe,pe.push(N[xe]);var we=H[Math.floor(xe*4/O)];if(ve=xe*4&be,O<4+ve)throw new Error("FAT boundary crossed: "+xe+" 4 "+O);if(!N[we])break;xe=Fi(N[we],ve)}return{nodes:J,data:ZE([pe])}}function F(N,j,H,O){var V=N.length,J=[],pe=[],be=[],xe=[],ve=O-1,we=0,Le=0,Oe=0,ze=0;for(we=0;we<V;++we)if(be=[],Oe=we+j,Oe>=V&&(Oe-=V),!pe[Oe]){xe=[];var He=[];for(Le=Oe;Le>=0;){He[Le]=!0,pe[Le]=!0,be[be.length]=Le,xe.push(N[Le]);var Ke=H[Math.floor(Le*4/O)];if(ze=Le*4&ve,O<4+ze)throw new Error("FAT boundary crossed: "+Le+" 4 "+O);if(!N[Ke]||(Le=Fi(N[Ke],ze),He[Le]))break}J[Oe]={nodes:be,data:ZE([xe])}}return J}function S(N,j,H,O,V,J,pe,be){for(var xe=0,ve=O.length?2:0,we=j[N].data,Le=0,Oe=0,ze;Le<we.length;Le+=128){var He=we.slice(Le,Le+128);Bn(He,64),Oe=He.read_shift(2),ze=Ux(He,0,Oe-ve),O.push(ze);var Ke={name:ze,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},At=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);At!==0&&(Ke.ct=I(He,He.l-8));var cr=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);cr!==0&&(Ke.mt=I(He,He.l-8)),Ke.start=He.read_shift(4,"i"),Ke.size=He.read_shift(4,"i"),Ke.size<0&&Ke.start<0&&(Ke.size=Ke.type=0,Ke.start=ae,Ke.name=""),Ke.type===5?(xe=Ke.start,V>0&&xe!==ae&&(j[xe].name="!StreamData")):Ke.size>=4096?(Ke.storage="fat",j[Ke.start]===void 0&&(j[Ke.start]=_(H,Ke.start,j.fat_addrs,j.ssz)),j[Ke.start].name=Ke.name,Ke.content=j[Ke.start].data.slice(0,Ke.size)):(Ke.storage="minifat",Ke.size<0?Ke.size=0:xe!==ae&&Ke.start!==ae&&j[xe]&&(Ke.content=E(Ke,j[xe].data,(j[be]||{}).data))),Ke.content&&Bn(Ke.content,0),J[ze]=Ke,pe.push(Ke)}}function I(N,j){return new Date((mA(N,j+4)/1e7*Math.pow(2,32)+mA(N,j)/1e7-11644473600)*1e3)}function M(N,j){return f(),d(u.readFileSync(N),j)}function Q(N,j){var H=j&&j.type;switch(H||kt&&Buffer.isBuffer(N)&&(H="buffer"),H||"base64"){case"file":return M(N,j);case"base64":return d(pA(wA(N)),j);case"binary":return d(pA(N),j)}return d(N,j)}function U(N,j){var H=j||{},O=H.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=O+"/",N.FileIndex[0]={name:O,type:5}),H.CLSID&&(N.FileIndex[0].clsid=H.CLSID),G(N)}function G(N){var j="Sh33tJ5";if(!lt.find(N,"/"+j)){var H=_e(4);H[0]=55,H[1]=H[3]=50,H[2]=54,N.FileIndex.push({name:j,type:2,content:H,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+j),R(N)}}function R(N,j){U(N);for(var H=!1,O=!1,V=N.FullPaths.length-1;V>=0;--V){var J=N.FileIndex[V];switch(J.type){case 0:O?H=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(J.R*J.L*J.C)&&(H=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!j)){var pe=new Date(1987,1,19),be=0,xe=Object.create?Object.create(null):{},ve=[];for(V=0;V<N.FullPaths.length;++V)xe[N.FullPaths[V]]=!0,N.FileIndex[V].type!==0&&ve.push([N.FullPaths[V],N.FileIndex[V]]);for(V=0;V<ve.length;++V){var we=n(ve[V][0]);O=xe[we],O||(ve.push([we,{name:A(we).replace("/",""),type:1,clsid:q,ct:pe,mt:pe,content:null}]),xe[we]=!0)}for(ve.sort(function(ze,He){return r(ze[0],He[0])}),N.FullPaths=[],N.FileIndex=[],V=0;V<ve.length;++V)N.FullPaths[V]=ve[V][0],N.FileIndex[V]=ve[V][1];for(V=0;V<ve.length;++V){var Le=N.FileIndex[V],Oe=N.FullPaths[V];if(Le.name=A(Oe).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||q,V===0)Le.C=ve.length>1?1:-1,Le.size=0,Le.type=5;else if(Oe.slice(-1)=="/"){for(be=V+1;be<ve.length&&n(N.FullPaths[be])!=Oe;++be);for(Le.C=be>=ve.length?-1:be,be=V+1;be<ve.length&&n(N.FullPaths[be])!=n(Oe);++be);Le.R=be>=ve.length?-1:be,Le.type=1}else n(N.FullPaths[V+1]||"")==n(Oe)&&(Le.R=V+1),Le.type=2}}}function te(N,j){var H=j||{};if(H.fileType=="mad")return Co(N,H);switch(R(N),H.fileType){case"zip":return Ea(N,H)}var O=(function(ze){for(var He=0,Ke=0,At=0;At<ze.FileIndex.length;++At){var cr=ze.FileIndex[At];if(cr.content){var Ft=cr.content.length;Ft>0&&(Ft<4096?He+=Ft+63>>6:Ke+=Ft+511>>9)}}for(var ur=ze.FullPaths.length+3>>2,Sn=He+7>>3,JA=He+127>>7,BA=Sn+Ke+ur+JA,Gn=BA+127>>7,cs=Gn<=109?0:Math.ceil((Gn-109)/127);BA+Gn+cs+127>>7>Gn;)cs=++Gn<=109?0:Math.ceil((Gn-109)/127);var gn=[1,cs,Gn,JA,ur,Ke,He,0];return ze.FileIndex[0].size=He<<6,gn[7]=(ze.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn})(N),V=_e(O[7]<<9),J=0,pe=0;{for(J=0;J<8;++J)V.write_shift(1,Te[J]);for(J=0;J<8;++J)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),J=0;J<3;++J)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,O[2]),V.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:ae),V.write_shift(4,O[3]),V.write_shift(-4,O[1]?O[0]-1:ae),V.write_shift(4,O[1]),J=0;J<109;++J)V.write_shift(-4,J<O[2]?O[1]+J:-1)}if(O[1])for(pe=0;pe<O[1];++pe){for(;J<236+pe*127;++J)V.write_shift(-4,J<O[2]?O[1]+J:-1);V.write_shift(-4,pe===O[1]-1?ae:pe+1)}var be=function(ze){for(pe+=ze;J<pe-1;++J)V.write_shift(-4,J+1);ze&&(++J,V.write_shift(-4,ae))};for(pe=J=0,pe+=O[1];J<pe;++J)V.write_shift(-4,oe.DIFSECT);for(pe+=O[2];J<pe;++J)V.write_shift(-4,oe.FATSECT);be(O[3]),be(O[4]);for(var xe=0,ve=0,we=N.FileIndex[0];xe<N.FileIndex.length;++xe)we=N.FileIndex[xe],we.content&&(ve=we.content.length,!(ve<4096)&&(we.start=pe,be(ve+511>>9)));for(be(O[6]+7>>3);V.l&511;)V.write_shift(-4,oe.ENDOFCHAIN);for(pe=J=0,xe=0;xe<N.FileIndex.length;++xe)we=N.FileIndex[xe],we.content&&(ve=we.content.length,!(!ve||ve>=4096)&&(we.start=pe,be(ve+63>>6)));for(;V.l&511;)V.write_shift(-4,oe.ENDOFCHAIN);for(J=0;J<O[4]<<2;++J){var Le=N.FullPaths[J];if(!Le||Le.length===0){for(xe=0;xe<17;++xe)V.write_shift(4,0);for(xe=0;xe<3;++xe)V.write_shift(4,-1);for(xe=0;xe<12;++xe)V.write_shift(4,0);continue}we=N.FileIndex[J],J===0&&(we.start=we.size?we.start-1:ae);var Oe=J===0&&H.root||we.name;if(ve=2*(Oe.length+1),V.write_shift(64,Oe,"utf16le"),V.write_shift(2,ve),V.write_shift(1,we.type),V.write_shift(1,we.color),V.write_shift(-4,we.L),V.write_shift(-4,we.R),V.write_shift(-4,we.C),we.clsid)V.write_shift(16,we.clsid,"hex");else for(xe=0;xe<4;++xe)V.write_shift(4,0);V.write_shift(4,we.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,we.start),V.write_shift(4,we.size),V.write_shift(4,0)}for(J=1;J<N.FileIndex.length;++J)if(we=N.FileIndex[J],we.size>=4096)if(V.l=we.start+1<<9,kt&&Buffer.isBuffer(we.content))we.content.copy(V,V.l,0,we.size),V.l+=we.size+511&-512;else{for(xe=0;xe<we.size;++xe)V.write_shift(1,we.content[xe]);for(;xe&511;++xe)V.write_shift(1,0)}for(J=1;J<N.FileIndex.length;++J)if(we=N.FileIndex[J],we.size>0&&we.size<4096)if(kt&&Buffer.isBuffer(we.content))we.content.copy(V,V.l,0,we.size),V.l+=we.size+63&-64;else{for(xe=0;xe<we.size;++xe)V.write_shift(1,we.content[xe]);for(;xe&63;++xe)V.write_shift(1,0)}if(kt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function ne(N,j){var H=N.FullPaths.map(function(xe){return xe.toUpperCase()}),O=H.map(function(xe){var ve=xe.split("/");return ve[ve.length-(xe.slice(-1)=="/"?2:1)]}),V=!1;j.charCodeAt(0)===47?(V=!0,j=H[0].slice(0,-1)+j):V=j.indexOf("/")!==-1;var J=j.toUpperCase(),pe=V===!0?H.indexOf(J):O.indexOf(J);if(pe!==-1)return N.FileIndex[pe];var be=!J.match(Ic);for(J=J.replace(Jn,""),be&&(J=J.replace(Ic,"!")),pe=0;pe<H.length;++pe)if((be?H[pe].replace(Ic,"!"):H[pe]).replace(Jn,"")==J||(be?O[pe].replace(Ic,"!"):O[pe]).replace(Jn,"")==J)return N.FileIndex[pe];return null}var ee=64,ae=-2,Se="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:Se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(N,j,H){f();var O=te(N,H);u.writeFileSync(j,O)}function ie(N){for(var j=new Array(N.length),H=0;H<N.length;++H)j[H]=String.fromCharCode(N[H]);return j.join("")}function Me(N,j){var H=te(N,j);switch(j&&j.type||"buffer"){case"file":return f(),u.writeFileSync(j.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return nu(typeof H=="string"?H:ie(H));case"buffer":if(kt)return Buffer.isBuffer(H)?H:ss(H);case"array":return typeof H=="string"?pA(H):H}return H}var X;function k(N){try{var j=N.InflateRaw,H=new j;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)X=N;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function K(N,j){if(!X)return Tn(N,j);var H=X.InflateRaw,O=new H,V=O._processChunk(N.slice(N.l),O._finishFlushFlag);return N.l+=O.bytesRead,V}function P(N){return X?X.deflateRawSync(N):nt(N)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(N){var j=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(j>>16|j>>8|j)&255}for(var he=typeof Uint8Array<"u",Ae=he?new Uint8Array(256):[],ce=0;ce<256;++ce)Ae[ce]=Ce(ce);function L(N,j){var H=Ae[N&255];return j<=8?H>>>8-j:(H=H<<8|Ae[N>>8&255],j<=16?H>>>16-j:(H=H<<8|Ae[N>>16&255],H>>>24-j))}function je(N,j){var H=j&7,O=j>>>3;return(N[O]|(H<=6?0:N[O+1]<<8))>>>H&3}function Je(N,j){var H=j&7,O=j>>>3;return(N[O]|(H<=5?0:N[O+1]<<8))>>>H&7}function et(N,j){var H=j&7,O=j>>>3;return(N[O]|(H<=4?0:N[O+1]<<8))>>>H&15}function qe(N,j){var H=j&7,O=j>>>3;return(N[O]|(H<=3?0:N[O+1]<<8))>>>H&31}function De(N,j){var H=j&7,O=j>>>3;return(N[O]|(H<=1?0:N[O+1]<<8))>>>H&127}function ct(N,j,H){var O=j&7,V=j>>>3,J=(1<<H)-1,pe=N[V]>>>O;return H<8-O||(pe|=N[V+1]<<8-O,H<16-O)||(pe|=N[V+2]<<16-O,H<24-O)||(pe|=N[V+3]<<24-O),pe&J}function Kt(N,j,H){var O=j&7,V=j>>>3;return O<=5?N[V]|=(H&7)<<O:(N[V]|=H<<O&255,N[V+1]=(H&7)>>8-O),j+3}function lr(N,j,H){var O=j&7,V=j>>>3;return H=(H&1)<<O,N[V]|=H,j+1}function jt(N,j,H){var O=j&7,V=j>>>3;return H<<=O,N[V]|=H&255,H>>>=8,N[V+1]=H,j+8}function Ct(N,j,H){var O=j&7,V=j>>>3;return H<<=O,N[V]|=H&255,H>>>=8,N[V+1]=H&255,N[V+2]=H>>>8,j+16}function wr(N,j){var H=N.length,O=2*H>j?2*H:j+5,V=0;if(H>=j)return N;if(kt){var J=QE(O);if(N.copy)N.copy(J);else for(;V<N.length;++V)J[V]=N[V];return J}else if(he){var pe=new Uint8Array(O);if(pe.set)pe.set(N);else for(;V<H;++V)pe[V]=N[V];return pe}return N.length=O,N}function mt(N){for(var j=new Array(N),H=0;H<N;++H)j[H]=0;return j}function ue(N,j,H){var O=1,V=0,J=0,pe=0,be=0,xe=N.length,ve=he?new Uint16Array(32):mt(32);for(J=0;J<32;++J)ve[J]=0;for(J=xe;J<H;++J)N[J]=0;xe=N.length;var we=he?new Uint16Array(xe):mt(xe);for(J=0;J<xe;++J)ve[V=N[J]]++,O<V&&(O=V),we[J]=0;for(ve[0]=0,J=1;J<=O;++J)ve[J+16]=be=be+ve[J-1]<<1;for(J=0;J<xe;++J)be=N[J],be!=0&&(we[J]=ve[be+16]++);var Le=0;for(J=0;J<xe;++J)if(Le=N[J],Le!=0)for(be=L(we[J],O)>>O-Le,pe=(1<<O+4-Le)-1;pe>=0;--pe)j[be|pe<<Le]=Le&15|J<<4;return O}var Ve=he?new Uint16Array(512):mt(512),Et=he?new Uint16Array(32):mt(32);if(!he){for(var vt=0;vt<512;++vt)Ve[vt]=0;for(vt=0;vt<32;++vt)Et[vt]=0}(function(){for(var N=[],j=0;j<32;j++)N.push(5);ue(N,Et,32);var H=[];for(j=0;j<=143;j++)H.push(8);for(;j<=255;j++)H.push(9);for(;j<=279;j++)H.push(7);for(;j<=287;j++)H.push(8);ue(H,Ve,288)})();var Ut=(function(){for(var j=he?new Uint8Array(32768):[],H=0,O=0;H<le.length-1;++H)for(;O<le[H+1];++O)j[O]=H;for(;O<32768;++O)j[O]=29;var V=he?new Uint8Array(259):[];for(H=0,O=0;H<Z.length-1;++H)for(;O<Z[H+1];++O)V[O]=H;function J(be,xe){for(var ve=0;ve<be.length;){var we=Math.min(65535,be.length-ve),Le=ve+we==be.length;for(xe.write_shift(1,+Le),xe.write_shift(2,we),xe.write_shift(2,~we&65535);we-- >0;)xe[xe.l++]=be[ve++]}return xe.l}function pe(be,xe){for(var ve=0,we=0,Le=he?new Uint16Array(32768):[];we<be.length;){var Oe=Math.min(65535,be.length-we);if(Oe<10){for(ve=Kt(xe,ve,+(we+Oe==be.length)),ve&7&&(ve+=8-(ve&7)),xe.l=ve/8|0,xe.write_shift(2,Oe),xe.write_shift(2,~Oe&65535);Oe-- >0;)xe[xe.l++]=be[we++];ve=xe.l*8;continue}ve=Kt(xe,ve,+(we+Oe==be.length)+2);for(var ze=0;Oe-- >0;){var He=be[we];ze=(ze<<5^He)&32767;var Ke=-1,At=0;if((Ke=Le[ze])&&(Ke|=we&-32768,Ke>we&&(Ke-=32768),Ke<we))for(;be[Ke+At]==be[we+At]&&At<250;)++At;if(At>2){He=V[At],He<=22?ve=jt(xe,ve,Ae[He+1]>>1)-1:(jt(xe,ve,3),ve+=5,jt(xe,ve,Ae[He-23]>>5),ve+=3);var cr=He<8?0:He-4>>2;cr>0&&(Ct(xe,ve,At-Z[He]),ve+=cr),He=j[we-Ke],ve=jt(xe,ve,Ae[He]>>3),ve-=3;var Ft=He<4?0:He-2>>1;Ft>0&&(Ct(xe,ve,we-Ke-le[He]),ve+=Ft);for(var ur=0;ur<At;++ur)Le[ze]=we&32767,ze=(ze<<5^be[we])&32767,++we;Oe-=At-1}else He<=143?He=He+48:ve=lr(xe,ve,1),ve=jt(xe,ve,Ae[He]),Le[ze]=we&32767,++we}ve=jt(xe,ve,0)-1}return xe.l=(ve+7)/8|0,xe.l}return function(xe,ve){return xe.length<8?J(xe,ve):pe(xe,ve)}})();function nt(N){var j=_e(50+Math.floor(N.length*1.1)),H=Ut(N,j);return j.slice(0,H)}var pt=he?new Uint16Array(32768):mt(32768),Nt=he?new Uint16Array(32768):mt(32768),yt=he?new Uint16Array(128):mt(128),rr=1,Or=1;function yr(N,j){var H=qe(N,j)+257;j+=5;var O=qe(N,j)+1;j+=5;var V=et(N,j)+4;j+=4;for(var J=0,pe=he?new Uint8Array(19):mt(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,ve=he?new Uint8Array(8):mt(8),we=he?new Uint8Array(8):mt(8),Le=pe.length,Oe=0;Oe<V;++Oe)pe[z[Oe]]=J=Je(N,j),xe<J&&(xe=J),ve[J]++,j+=3;var ze=0;for(ve[0]=0,Oe=1;Oe<=xe;++Oe)we[Oe]=ze=ze+ve[Oe-1]<<1;for(Oe=0;Oe<Le;++Oe)(ze=pe[Oe])!=0&&(be[Oe]=we[ze]++);var He=0;for(Oe=0;Oe<Le;++Oe)if(He=pe[Oe],He!=0){ze=Ae[be[Oe]]>>8-He;for(var Ke=(1<<7-He)-1;Ke>=0;--Ke)yt[ze|Ke<<He]=He&7|Oe<<3}var At=[];for(xe=1;At.length<H+O;)switch(ze=yt[De(N,j)],j+=ze&7,ze>>>=3){case 16:for(J=3+je(N,j),j+=2,ze=At[At.length-1];J-- >0;)At.push(ze);break;case 17:for(J=3+Je(N,j),j+=3;J-- >0;)At.push(0);break;case 18:for(J=11+De(N,j),j+=7;J-- >0;)At.push(0);break;default:At.push(ze),xe<ze&&(xe=ze);break}var cr=At.slice(0,H),Ft=At.slice(H);for(Oe=H;Oe<286;++Oe)cr[Oe]=0;for(Oe=O;Oe<30;++Oe)Ft[Oe]=0;return rr=ue(cr,pt,286),Or=ue(Ft,Nt,30),j}function or(N,j){if(N[0]==3&&!(N[1]&3))return[Ys(j),2];for(var H=0,O=0,V=QE(j||1<<18),J=0,pe=V.length>>>0,be=0,xe=0;(O&1)==0;){if(O=Je(N,H),H+=3,O>>>1)O>>1==1?(be=9,xe=5):(H=yr(N,H),be=rr,xe=Or);else{H&7&&(H+=8-(H&7));var ve=N[H>>>3]|N[(H>>>3)+1]<<8;if(H+=32,ve>0)for(!j&&pe<J+ve&&(V=wr(V,J+ve),pe=V.length);ve-- >0;)V[J++]=N[H>>>3],H+=8;continue}for(;;){!j&&pe<J+32767&&(V=wr(V,J+32767),pe=V.length);var we=ct(N,H,be),Le=O>>>1==1?Ve[we]:pt[we];if(H+=Le&15,Le>>>=4,(Le>>>8&255)===0)V[J++]=Le;else{if(Le==256)break;Le-=257;var Oe=Le<8?0:Le-4>>2;Oe>5&&(Oe=0);var ze=J+Z[Le];Oe>0&&(ze+=ct(N,H,Oe),H+=Oe),we=ct(N,H,xe),Le=O>>>1==1?Et[we]:Nt[we],H+=Le&15,Le>>>=4;var He=Le<4?0:Le-2>>1,Ke=le[Le];for(He>0&&(Ke+=ct(N,H,He),H+=He),!j&&pe<ze&&(V=wr(V,ze+100),pe=V.length);J<ze;)V[J]=V[J-Ke],++J}}}return j?[V,H+7>>>3]:[V.slice(0,J),H+7>>>3]}function Tn(N,j){var H=N.slice(N.l||0),O=or(H,j);return N.l+=O[1],O[0]}function Pn(N,j){if(N)typeof console<"u"&&console.error(j);else throw new Error(j)}function hn(N,j){var H=N;Bn(H,0);var O=[],V=[],J={FileIndex:O,FullPaths:V};U(J,{root:j.root});for(var pe=H.length-4;(H[pe]!=80||H[pe+1]!=75||H[pe+2]!=5||H[pe+3]!=6)&&pe>=0;)--pe;H.l=pe+4,H.l+=4;var be=H.read_shift(2);H.l+=6;var xe=H.read_shift(4);for(H.l=xe,pe=0;pe<be;++pe){H.l+=20;var ve=H.read_shift(4),we=H.read_shift(4),Le=H.read_shift(2),Oe=H.read_shift(2),ze=H.read_shift(2);H.l+=8;var He=H.read_shift(4),Ke=o(H.slice(H.l+Le,H.l+Le+Oe));H.l+=Le+Oe+ze;var At=H.l;H.l=He+4,Ca(H,ve,we,J,Ke),H.l=At}return J}function Ca(N,j,H,O,V){N.l+=2;var J=N.read_shift(2),pe=N.read_shift(2),be=l(N);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var xe=N.read_shift(4),ve=N.read_shift(4),we=N.read_shift(4),Le=N.read_shift(2),Oe=N.read_shift(2),ze="",He=0;He<Le;++He)ze+=String.fromCharCode(N[N.l++]);if(Oe){var Ke=o(N.slice(N.l,N.l+Oe));(Ke[21589]||{}).mt&&(be=Ke[21589].mt),((V||{})[21589]||{}).mt&&(be=V[21589].mt)}N.l+=Oe;var At=N.slice(N.l,N.l+ve);switch(pe){case 8:At=K(N,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var cr=!1;J&8&&(xe=N.read_shift(4),xe==134695760&&(xe=N.read_shift(4),cr=!0),ve=N.read_shift(4),we=N.read_shift(4)),ve!=j&&Pn(cr,"Bad compressed size: "+j+" != "+ve),we!=H&&Pn(cr,"Bad uncompressed size: "+H+" != "+we),os(O,ze,At,{unsafe:!0,mt:be})}function Ea(N,j){var H=j||{},O=[],V=[],J=_e(1),pe=H.compression?8:0,be=0,xe=0,ve=0,we=0,Le=0,Oe=N.FullPaths[0],ze=Oe,He=N.FileIndex[0],Ke=[],At=0;for(xe=1;xe<N.FullPaths.length;++xe)if(ze=N.FullPaths[xe].slice(Oe.length),He=N.FileIndex[xe],!(!He.size||!He.content||ze=="Sh33tJ5")){var cr=we,Ft=_e(ze.length);for(ve=0;ve<ze.length;++ve)Ft.write_shift(1,ze.charCodeAt(ve)&127);Ft=Ft.slice(0,Ft.l),Ke[Le]=_7.buf(He.content,0);var ur=He.content;pe==8&&(ur=P(ur)),J=_e(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,be),J.write_shift(2,pe),He.mt?s(J,He.mt):J.write_shift(4,0),J.write_shift(-4,Ke[Le]),J.write_shift(4,ur.length),J.write_shift(4,He.content.length),J.write_shift(2,Ft.length),J.write_shift(2,0),we+=J.length,O.push(J),we+=Ft.length,O.push(Ft),we+=ur.length,O.push(ur),J=_e(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,be),J.write_shift(2,pe),J.write_shift(4,0),J.write_shift(-4,Ke[Le]),J.write_shift(4,ur.length),J.write_shift(4,He.content.length),J.write_shift(2,Ft.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,cr),At+=J.l,V.push(J),At+=Ft.length,V.push(Ft),++Le}return J=_e(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Le),J.write_shift(2,Le),J.write_shift(4,At),J.write_shift(4,we),J.write_shift(2,0),un([un(O),un(V),J])}var Wn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ta(N,j){if(N.ctype)return N.ctype;var H=N.name||"",O=H.match(/\.([^\.]+)$/);return O&&Wn[O[1]]||j&&(O=(H=j).match(/[\.\\]([^\.\\])+$/),O&&Wn[O[1]])?Wn[O[1]]:"application/octet-stream"}function Sa(N){for(var j=nu(N),H=[],O=0;O<j.length;O+=76)H.push(j.slice(O,O+76));return H.join(`\r
`)+`\r
`}function Zi(N){var j=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var we=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],O=j.split(`\r
`),V=0;V<O.length;++V){var J=O[V];if(J.length==0){H.push("");continue}for(var pe=0;pe<J.length;){var be=76,xe=J.slice(pe,pe+be);xe.charAt(be-1)=="="?be--:xe.charAt(be-2)=="="?be-=2:xe.charAt(be-3)=="="&&(be-=3),xe=J.slice(pe,pe+be),pe+=be,pe<J.length&&(xe+="="),H.push(xe)}}return H.join(`\r
`)}function el(N){for(var j=[],H=0;H<N.length;++H){for(var O=N[H];H<=N.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+N[++H];j.push(O)}for(var V=0;V<j.length;++V)j[V]=j[V].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return pA(j.join(`\r
`))}function ni(N,j,H){for(var O="",V="",J="",pe,be=0;be<10;++be){var xe=j[be];if(!xe||xe.match(/^\s*$/))break;var ve=xe.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":O=ve[2].trim();break;case"content-type":J=ve[2].trim();break;case"content-transfer-encoding":V=ve[2].trim();break}}switch(++be,V.toLowerCase()){case"base64":pe=pA(wA(j.slice(be).join("")));break;case"quoted-printable":pe=el(j.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var we=os(N,O.slice(H.length),pe,{unsafe:!0});J&&(we.ctype=J)}function la(N,j){if(ie(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=j&&j.root||"",O=(kt&&Buffer.isBuffer(N)?N.toString("binary"):ie(N)).split(`\r
`),V=0,J="";for(V=0;V<O.length;++V)if(J=O[V],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),H||(H=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),J.slice(0,H.length)!=H););var pe=(O[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var be="--"+(pe[1]||""),xe=[],ve=[],we={FileIndex:xe,FullPaths:ve};U(we);var Le,Oe=0;for(V=0;V<O.length;++V){var ze=O[V];ze!==be&&ze!==be+"--"||(Oe++&&ni(we,O.slice(Le,V),H),Le=V)}return we}function Co(N,j){var H=j||{},O=H.boundary||"SheetJS";O="------="+O;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],J=N.FullPaths[0],pe=J,be=N.FileIndex[0],xe=1;xe<N.FullPaths.length;++xe)if(pe=N.FullPaths[xe].slice(J.length),be=N.FileIndex[xe],!(!be.size||!be.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(At){return"_x"+At.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(At){return"_u"+At.charCodeAt(0).toString(16)+"_"});for(var ve=be.content,we=kt&&Buffer.isBuffer(ve)?ve.toString("binary"):ie(ve),Le=0,Oe=Math.min(1024,we.length),ze=0,He=0;He<=Oe;++He)(ze=we.charCodeAt(He))>=32&&ze<128&&++Le;var Ke=Le>=Oe*4/5;V.push(O),V.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+pe),V.push("Content-Transfer-Encoding: "+(Ke?"quoted-printable":"base64")),V.push("Content-Type: "+Ta(be,pe)),V.push(""),V.push(Ke?Zi(we):Sa(we))}return V.push(O+`--\r
`),V.join(`\r
`)}function tl(N){var j={};return U(j,N),j}function os(N,j,H,O){var V=O&&O.unsafe;V||U(N);var J=!V&&lt.find(N,j);if(!J){var pe=N.FullPaths[0];j.slice(0,pe.length)==pe?pe=j:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+j).replace("//","/")),J={name:A(j),type:2},N.FileIndex.push(J),N.FullPaths.push(pe),V||lt.utils.cfb_gc(N)}return J.content=H,J.size=H?H.length:0,O&&(O.CLSID&&(J.clsid=O.CLSID),O.mt&&(J.mt=O.mt),O.ct&&(J.ct=O.ct)),J}function rl(N,j){U(N);var H=lt.find(N,j);if(H){for(var O=0;O<N.FileIndex.length;++O)if(N.FileIndex[O]==H)return N.FileIndex.splice(O,1),N.FullPaths.splice(O,1),!0}return!1}function Ai(N,j,H){U(N);var O=lt.find(N,j);if(O){for(var V=0;V<N.FileIndex.length;++V)if(N.FileIndex[V]==O)return N.FileIndex[V].name=A(H),N.FullPaths[V]=H,!0}return!1}function ai(N){R(N,!0)}return t.find=ne,t.read=Q,t.parse=d,t.write=Me,t.writeFile=Re,t.utils={cfb_new:tl,cfb_add:os,cfb_del:rl,cfb_mov:Ai,cfb_gc:ai,ReadShift:Gc,CheckField:e4,prep_blob:Bn,bconcat:un,use_zlib:k,_deflateRaw:nt,_inflateRaw:Tn,consts:oe},t})();function b7(e){return typeof e=="string"?Dd(e):Array.isArray(e)?e7(e):e}function wu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Dd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?pa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var A=new Blob([b7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(A,e);if(typeof saveAs<"u")return saveAs(A,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(A);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ei(t)),o.write(t),o.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function F7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Hr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function GE(e,t){for(var r=[],n=Hr(e),A=0;A!==n.length;++A)r[e[n[A]][t]]==null&&(r[e[n[A]][t]]=n[A]);return r}function Ld(e){for(var t=[],r=Hr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Hd(e){for(var t=[],r=Hr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function U7(e){for(var t=[],r=Hr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var sd=new Date(1899,11,30,0,0,0);function sn(e,t){var r=e.getTime(),n=sd.getTime()+(e.getTimezoneOffset()-sd.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var I_=new Date,k7=sd.getTime()+(I_.getTimezoneOffset()-sd.getTimezoneOffset())*6e4,VE=I_.getTimezoneOffset();function Od(e){var t=new Date;return t.setTime(e*24*60*60*1e3+k7),t.getTimezoneOffset()!==VE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-VE)*6e4),t}function N7(e){var t=0,r=0,n=!1,A=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!A)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=A.length;++s)if(A[s]){switch(r=1,s>3&&(n=!0),A[s].slice(A[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+A[s].slice(A[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(A[s],10)}return t}var KE=new Date("2017-02-19T19:06:09.000Z"),Q_=isNaN(KE.getFullYear())?new Date("2/19/17"):KE,I7=Q_.getFullYear()==2017;function Sr(e,t){var r=new Date(e);if(I7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Q_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var A=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+A[0],+A[1]-1,+A[2],+A[3]||0,+A[4]||0,+A[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Hi(e,t){if(kt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return pa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return pa(y_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return pa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return pa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],A=0;A!=e.length;++A)n.push(String.fromCharCode(e[A]));return n.join("")}function _r(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_r(e[r]));return t}function Mr(e,t){for(var r="";r.length<t;)r+=e;return r}function Aa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(A,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Q7=["january","february","march","april","may","june","july","august","september","october","november","december"];function lo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),A=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&Q7.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(A>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var R7=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,A){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(A),l.push(s[o]);return l}})();function R_(e){return e?e.content&&e.type?Hi(e.content,!0):e.data?Nc(e.data):e.asNodeBuffer&&kt?Nc(e.asNodeBuffer().toString("binary")):e.asBinary?Nc(e.asBinary()):e._data&&e._data.getContent?Nc(Hi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function D_(e){if(!e)return null;if(e.data)return NE(e.data);if(e.asNodeBuffer&&kt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?NE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function D7(e){return e&&e.name.slice(-4)===".bin"?D_(e):R_(e)}function LA(e,t){for(var r=e.FullPaths||Hr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),A=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||A==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ex(e,t){var r=LA(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Zr(e,t,r){if(!r)return D7(Ex(e,t));if(!t)return null;try{return Zr(e,t)}catch{return null}}function xA(e,t,r){if(!r)return R_(Ex(e,t));if(!t)return null;try{return xA(e,t)}catch{return null}}function M7(e,t,r){return D_(Ex(e,t))}function jE(e){for(var t=e.FullPaths||Hr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function bt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return kt?n=ss(r):n=t7(r),lt.utils.cfb_add(e,t,n)}lt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Tx(){return lt.utils.cfb_new()}function M_(e,t){switch(t.type){case"base64":return lt.read(e,{type:"base64"});case"binary":return lt.read(e,{type:"binary"});case"buffer":case"array":return lt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Qc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var A=n.shift();A===".."?r.pop():A!=="."&&r.push(A)}return r.join("/")}var Xr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,L7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,zE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,H7=/<[^>]*>/g,On=Xr.match(zE)?zE:H7,O7=/<\w*:/,P7=/<(\/?)\w+:/;function gt(e,t,r){for(var n={},A=0,s=0;A!==e.length&&!((s=e.charCodeAt(A))===32||s===10||s===13);++A);if(t||(n[0]=e.slice(0,A)),A===e.length)return n;var l=e.match(L7),o=0,u="",f=0,d="",m="",x=1;if(l)for(f=0;f!=l.length;++f){for(m=l[f],s=0;s!=m.length&&m.charCodeAt(s)!==61;++s);for(d=m.slice(0,s).trim();m.charCodeAt(s+1)==32;)++s;for(x=(A=m.charCodeAt(s+1))==34||A==39?1:0,u=m.slice(s+1+x,m.length-x),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var y=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[y]&&d.slice(o-3,o)=="ext")continue;n[y]=u,n[y.toLowerCase()]=u}}return n}function ya(e){return e.replace(P7,"<$1")}var L_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sx=Ld(L_),Xt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var A=n+"",s=A.indexOf("<![CDATA[");if(s==-1)return A.replace(e,function(o,u){return L_[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var l=A.indexOf("]]>");return r(A.slice(0,s))+A.slice(s+9,l)+r(A.slice(l+3))}})(),_x=/[&<>'"]/g,G7=/[\u0000-\u0008\u000b-\u001f]/g;function ir(e){var t=e+"";return t.replace(_x,function(r){return Sx[r]}).replace(G7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function XE(e){return ir(e).replace(/ /g,"_x0020_")}var H_=/[\u0000-\u001f]/g;function bx(e){var t=e+"";return t.replace(_x,function(r){return Sx[r]}).replace(/\n/g,"<br/>").replace(H_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function V7(e){var t=e+"";return t.replace(_x,function(r){return Sx[r]}).replace(H_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var JE=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function K7(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Tr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bm(e){for(var t="",r=0,n=0,A=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(A=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=A&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(A&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(A&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function YE(e){var t=Ys(2*e.length),r,n,A=1,s=0,l=0,o;for(n=0;n<e.length;n+=A)A=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),A=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),A=3):(A=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function WE(e){return ss(e,"binary").toString("utf8")}var gf="foo bar baz",pr=kt&&(WE(gf)==bm(gf)&&WE||YE(gf)==bm(gf)&&YE)||bm,pa=kt?function(e){return ss(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,A=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,A=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(A>>18&7))),t.push(String.fromCharCode(144+(A>>12&63))),t.push(String.fromCharCode(128+(A>>6&63))),t.push(String.fromCharCode(128+(A&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},au=(function(){var e={};return function(r,n){var A=r+"|"+(n||"");return e[A]?e[A]:e[A]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),O_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),A=0;A<e.length;++A)n=n.replace(e[A][0],e[A][1]);return n}})(),j7=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),z7=/<\/?(?:vt:)?variant>/g,X7=/<(?:vt:)([^>]*)>([\s\S]*)</;function qE(e,t){var r=gt(e),n=e.match(j7(r.baseType))||[],A=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return A}return n.forEach(function(s){var l=s.replace(z7,"").match(X7);l&&A.push({v:pr(l[2]),t:l[1]})}),A}var P_=/(^\s|\s$|\n)/;function Cn(e,t){return"<"+e+(t.match(P_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function su(e){return Hr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pe(e,t,r){return"<"+e+(r!=null?su(r):"")+(t!=null?(t.match(P_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Rp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function J7(e,t){switch(typeof e){case"string":var r=Pe("vt:lpwstr",ir(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",ir(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",Rp(e));throw new Error("Unable to serialize "+e)}function Fx(e){if(kt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return pr(ei(yx(e)));throw new Error("Bad input format: expected Buffer or string")}var iu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,an={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Xi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],gA={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Y7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),A=e[t+6]&15,s=5;s>=0;--s)A=A*256+e[t+s];return n==2047?A==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,A+=Math.pow(2,52)),r*Math.pow(2,n-52)*A)}function W7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,A=0,s=0,l=n?-t:t;isFinite(l)?l==0?A=s=0:(A=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-A),A<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?A=-1022:(s-=Math.pow(2,52),A+=1023)):(A=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(A&15)<<4|s&15,e[r+7]=A>>4|n}var $E=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var A=0,s=e[0][n].length;A<s;A+=r)t.push.apply(t,e[0][n].slice(A,A+r));return t},ZE=kt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ss(t)})):$E(e)}:$E,e2=function(e,t,r){for(var n=[],A=t;A<r;A+=2)n.push(String.fromCharCode(Xa(e,A)));return n.join("").replace(Jn,"")},Ux=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Jn,""):e2(e,t,r)}:e2,t2=function(e,t,r){for(var n=[],A=t;A<t+r;++A)n.push(("0"+e[A].toString(16)).slice(-2));return n.join("")},G_=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):t2(e,t,r)}:t2,r2=function(e,t,r){for(var n=[],A=t;A<r;A++)n.push(String.fromCharCode(Yl(e,A)));return n.join("")},yu=kt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):r2(t,r,n)}:r2,V_=function(e,t){var r=mA(e,t);return r>0?yu(e,t+4,t+4+r-1):""},K_=V_,j_=function(e,t){var r=mA(e,t);return r>0?yu(e,t+4,t+4+r-1):""},z_=j_,X_=function(e,t){var r=2*mA(e,t);return r>0?yu(e,t+4,t+4+r-1):""},J_=X_,Y_=function(t,r){var n=mA(t,r);return n>0?Ux(t,r+4,r+4+n):""},W_=Y_,q_=function(e,t){var r=mA(e,t);return r>0?yu(e,t+4,t+4+r):""},$_=q_,Z_=function(e,t){return Y7(e,t)},id=Z_,kx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};kt&&(K_=function(t,r){if(!Buffer.isBuffer(t))return V_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},z_=function(t,r){if(!Buffer.isBuffer(t))return j_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},J_=function(t,r){if(!Buffer.isBuffer(t))return X_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},W_=function(t,r){if(!Buffer.isBuffer(t))return Y_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},$_=function(t,r){if(!Buffer.isBuffer(t))return q_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},id=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Z_(t,r)},kx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Yl=function(e,t){return e[t]},Xa=function(e,t){return e[t+1]*256+e[t]},q7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},mA=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},$7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Gc(e,t){var r="",n,A,s=[],l,o,u,f;switch(t){case"dbcs":if(f=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Xa(this,f)),f+=2;e*=2;break;case"utf8":r=yu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ux(this,this.l,this.l+e);break;case"wstr":return Gc.call(this,e,"dbcs");case"lpstr-ansi":r=K_(this,this.l),e=4+mA(this,this.l);break;case"lpstr-cp":r=z_(this,this.l),e=4+mA(this,this.l);break;case"lpwstr":r=J_(this,this.l),e=4+2*mA(this,this.l);break;case"lpp4":e=4+mA(this,this.l),r=W_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+mA(this,this.l),r=$_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Yl(this,this.l+e++))!==0;)s.push(hf(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=Xa(this,this.l+e))!==0;)s.push(hf(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Yl(this,f),this.l=f+1,o=Gc.call(this,e-u,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(hf(Xa(this,f))),f+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Yl(this,f),this.l=f+1,o=Gc.call(this,e-u,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(hf(Yl(this,f))),f+=1}r=s.join("");break;default:switch(e){case 1:return n=Yl(this,this.l),this.l++,n;case 2:return n=(t==="i"?q7:Xa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Fi:$7)(this,this.l),this.l+=4,n):(A=mA(this,this.l),this.l+=4,A);case 8:case-8:if(t==="f")return e==8?A=id(this,this.l):A=id([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,A;e=8;case 16:r=G_(this,this.l,e);break}}return this.l+=e,r}var Z7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},e9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},t9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function r9(e,t,r){var n=0,A=0;if(r==="dbcs"){for(A=0;A!=t.length;++A)t9(this,t.charCodeAt(A),this.l+2*A);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),A=0;A!=t.length;++A)this[this.l+A]=t.charCodeAt(A)&255;n=t.length}else if(r==="hex"){for(;A<e;++A)this[this.l++]=parseInt(t.slice(2*A,2*A+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(A=0;A<Math.min(t.length,e);++A){var l=t.charCodeAt(A);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Z7(this,t,this.l);break;case 8:if(n=8,r==="f"){W7(this,t,this.l);break}case 16:break;case-4:n=4,e9(this,t,this.l);break}return this.l+=n,this}function e4(e,t){var r=G_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Bn(e,t){e.l=t,e.read_shift=Gc,e.chk=e4,e.write_shift=r9}function Hn(e,t){e.l+=t}function _e(e){var t=Ys(e);return Bn(t,0),t}function is(e,t,r){if(e){var n,A,s;Bn(e,e.l||0);for(var l=e.length,o=0,u=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=du[o]||du[65535];for(n=e.read_shift(1),s=n&127,A=1;A<4&&n&128;++A)s+=((n=e.read_shift(1))&127)<<7*A;u=e.l+s;var d=f.f&&f.f(e,s,r);if(e.l=u,t(d,f,o))return}}}function aA(){var e=[],t=kt?256:2048,r=function(f){var d=_e(f);return Bn(d,0),d},n=r(t),A=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(f){return n&&f<n.length-n.l?n:(A(),n=r(Math.max(f+1,t)))},l=function(){return A(),un(e)},o=function(f){A(),n=f,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function Qe(e,t,r,n){var A=+t,s;if(!isNaN(A)){n||(n=du[A].p||(r||[]).length||0),s=1+(A>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);A<=127?l.write_shift(1,A):(l.write_shift(1,(A&127)+128),l.write_shift(1,A>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&kx(r)&&e.push(r)}}function Vc(e,t,r){var n=_r(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function n2(e,t,r){var n=_r(e);return n.s=Vc(n.s,t.s,r),n.e=Vc(n.e,t.s,r),n}function Kc(e,t){if(e.cRel&&e.c<0)for(e=_r(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_r(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ht(e);return!e.cRel&&e.cRel!=null&&(r=a9(r)),!e.rRel&&e.rRel!=null&&(r=n9(r)),r}function Fm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ir(e.s.c)+":"+(e.e.cRel?"":"$")+Ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zr(e.s.r)+":"+(e.e.rRel?"":"$")+zr(e.e.r):Kc(e.s,t.biff)+":"+Kc(e.e,t.biff)}function Nx(e){return parseInt(A9(e),10)-1}function zr(e){return""+(e+1)}function n9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function A9(e){return e.replace(/\$(\d+)$/,"$1")}function Ix(e){for(var t=s9(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ir(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function a9(e){return e.replace(/^([A-Z])/,"$$$1")}function s9(e){return e.replace(/^\$([A-Z])/,"$1")}function i9(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var A=e.charCodeAt(n);A>=48&&A<=57?t=10*t+(A-48):A>=65&&A<=90&&(r=26*r+(A-64))}return{c:r-1,r:t-1}}function ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function sA(e){var t=e.indexOf(":");return t==-1?{s:Qr(e),e:Qr(e)}:{s:Qr(e.slice(0,t)),e:Qr(e.slice(t+1))}}function St(e,t){return typeof t>"u"||typeof t=="number"?St(e.s,e.e):(typeof e!="string"&&(e=ht(e)),typeof t!="string"&&(t=ht(t)),e==t?e:e+":"+t)}function Jt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,A=0,s=e.length;for(r=0;n<s&&!((A=e.charCodeAt(n)-64)<1||A>26);++n)r=26*r+A;for(t.s.c=--r,r=0;n<s&&!((A=e.charCodeAt(n)-48)<0||A>9);++n)r=10*r+A;if(t.s.r=--r,n===s||A!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((A=e.charCodeAt(n)-64)<1||A>26);++n)r=26*r+A;for(t.e.c=--r,r=0;n!=s&&!((A=e.charCodeAt(n)-48)<0||A>9);++n)r=10*r+A;return t.e.r=--r,t}function A2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=zA(e.z,r?sn(t):t)}catch{}try{return e.w=zA((e.XF||{}).numFmtId||(r?14:0),r?sn(t):t)}catch{return""+t}}function rs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ls[e.v]||e.v:t==null?A2(e,e.v):A2(e,t))}function ti(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function t4(e,t,r){var n=r||{},A=e?Array.isArray(e):n.dense,s=e||(A?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var u=typeof n.origin=="string"?Qr(n.origin):n.origin;l=u.r,o=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Jt(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),l==-1&&(f.e.r=l=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var y={v:t[m][x]},C=l+m,E=o+x;if(f.s.r>C&&(f.s.r=C),f.s.c>E&&(f.s.c=E),f.e.r<C&&(f.e.r=C),f.e.c<E&&(f.e.c=E),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))y=t[m][x];else if(Array.isArray(y.v)&&(y.f=t[m][x][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||dt[14],n.cellDates?(y.t="d",y.w=zA(y.z,sn(y.v))):(y.t="n",y.v=sn(y.v),y.w=zA(y.z,y.v))):y.t="s";if(A)s[C]||(s[C]=[]),s[C][E]&&s[C][E].z&&(y.z=s[C][E].z),s[C][E]=y;else{var T=ht({c:E,r:C});s[T]&&s[T].z&&(y.z=s[T].z),s[T]=y}}}return f.s.c<1e7&&(s["!ref"]=St(f)),s}function yo(e,t){return t4(null,e,t)}function l9(e){return e.read_shift(4,"i")}function aa(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function Ln(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function fn(e,t){var r=!1;return t==null&&(r=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function o9(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function c9(e,t){return t||(t=_e(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Qx(e,t){var r=e.l,n=e.read_shift(1),A=Ln(e),s=[],l={t:A,h:A};if((n&1)!==0){for(var o=e.read_shift(4),u=0;u!=o;++u)s.push(o9(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function u9(e,t){var r=!1;return t==null&&(r=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),fn(e.t,t),r?t.slice(0,t.l):t}var f9=Qx;function d9(e,t){var r=!1;return t==null&&(r=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),fn(e.t,t),t.write_shift(4,1),c9({},t),r?t.slice(0,t.l):t}function XA(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ji(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Yi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Wi(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var h9=Ln,r4=fn;function Rx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ld(e,t){var r=!1;return t==null&&(r=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var g9=Ln,Dp=Rx,Dx=ld;function Mx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var A=n===0?id([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fi(t,0)>>2;return r?A/100:A}function n4(e,t){t==null&&(t=_e(4));var r=0,n=0,A=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:A==(A|0)&&A>=-536870912&&A<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?A:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function m9(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var qi=A4,Bo=m9;function Dn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Oi(e,t){return(t||_e(8)).write_shift(8,e,"f")}function p9(e){var t={},r=e.read_shift(1),n=r>>>1,A=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=A;var f=Qi[A];f&&(t.rgb=ou(f));break;case 2:t.rgb=ou([l,o,u]);break;case 3:t.theme=A;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function od(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function x9(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function v9(e,t){t||(t=_e(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function a4(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function w9(e){return a4(e,1)}function y9(e){return a4(e,2)}var Lx=2,nA=3,mf=11,a2=12,cd=19,pf=64,B9=65,C9=71,E9=4108,T9=4126,cn=80,s4=81,S9=[cn,s4],Mp={1:{n:"CodePage",t:Lx},2:{n:"Category",t:cn},3:{n:"PresentationFormat",t:cn},4:{n:"ByteCount",t:nA},5:{n:"LineCount",t:nA},6:{n:"ParagraphCount",t:nA},7:{n:"SlideCount",t:nA},8:{n:"NoteCount",t:nA},9:{n:"HiddenCount",t:nA},10:{n:"MultimediaClipCount",t:nA},11:{n:"ScaleCrop",t:mf},12:{n:"HeadingPairs",t:E9},13:{n:"TitlesOfParts",t:T9},14:{n:"Manager",t:cn},15:{n:"Company",t:cn},16:{n:"LinksUpToDate",t:mf},17:{n:"CharacterCount",t:nA},19:{n:"SharedDoc",t:mf},22:{n:"HyperlinksChanged",t:mf},23:{n:"AppVersion",t:nA,p:"version"},24:{n:"DigSig",t:B9},26:{n:"ContentType",t:cn},27:{n:"ContentStatus",t:cn},28:{n:"Language",t:cn},29:{n:"Version",t:cn},255:{},2147483648:{n:"Locale",t:cd},2147483651:{n:"Behavior",t:cd},1919054434:{}},Lp={1:{n:"CodePage",t:Lx},2:{n:"Title",t:cn},3:{n:"Subject",t:cn},4:{n:"Author",t:cn},5:{n:"Keywords",t:cn},6:{n:"Comments",t:cn},7:{n:"Template",t:cn},8:{n:"LastAuthor",t:cn},9:{n:"RevNumber",t:cn},10:{n:"EditTime",t:pf},11:{n:"LastPrinted",t:pf},12:{n:"CreatedDate",t:pf},13:{n:"ModifiedDate",t:pf},14:{n:"PageCount",t:nA},15:{n:"WordCount",t:nA},16:{n:"CharCount",t:nA},17:{n:"Thumbnail",t:C9},18:{n:"Application",t:cn},19:{n:"DocSecurity",t:nA},255:{},2147483648:{n:"Locale",t:cd},2147483651:{n:"Behavior",t:cd},1919054434:{}},s2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_9=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function b9(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var F9=b9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qi=_r(F9),ls={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},i4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Hp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},xf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Hx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function U9(e){var t=Hx();if(!e||!e.match)return t;var r={};if((e.match(On)||[]).forEach(function(n){var A=gt(n);switch(A[0].replace(O7,"<")){case"<?xml":break;case"<Types":t.xmlns=A["xmlns"+(A[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[A.Extension]=A.ContentType;break;case"<Override":t[Hp[A.ContentType]]!==void 0&&t[Hp[A.ContentType]].push(A.PartName);break}}),t.xmlns!==an.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function l4(e,t){var r=U7(Hp),n=[],A;n[n.length]=Xr,n[n.length]=Pe("Types",null,{xmlns:an.CT,"xmlns:xsd":an.xsd,"xmlns:xsi":an.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Pe("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(A=e[u][0],n[n.length]=Pe("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:xf[u][t.bookType]||xf[u].xlsx}))},l=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Pe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:xf[u][t.bookType]||xf[u].xlsx})})},o=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Pe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[u][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Qt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function jc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(On)||[]).forEach(function(A){var s=gt(A);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Qc(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function Ao(e){var t=[Xr,Pe("Relationships",null,{xmlns:an.RELS})];return Hr(e["!id"]).forEach(function(r){t[t.length]=Pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function sr(e,t,r,n,A,s){if(A||(A={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,A.Id="rId"+t,A.Type=n,A.Target=r,[Qt.HLINK,Qt.XPATH,Qt.XMISS].indexOf(A.Type)>-1&&(A.TargetMode="External"),e["!id"][A.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][A.Id]=A,e[("/"+A.Target).replace("//","/")]=A,t}var k9="application/vnd.oasis.opendocument.spreadsheet";function N9(e,t){for(var r=Fx(e),n,A;n=iu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(A=gt(n[0],!1),A.path=="/"&&A.type!==k9)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function I9(e){var t=[Xr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function i2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Q9(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function R9(e){var t=[Xr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(i2(e[r][0],e[r][1])),t.push(Q9("",e[r][0]));return t.push(i2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function o4(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rd.version+"</meta:generator></office:meta></office:document-meta>"}var KA=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],D9=(function(){for(var e=new Array(KA.length),t=0;t<KA.length;++t){var r=KA[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function c4(e){var t={};e=pr(e);for(var r=0;r<KA.length;++r){var n=KA[r],A=e.match(D9[r]);A!=null&&A.length>0&&(t[n[1]]=Xt(A[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Sr(t[n[1]]))}return t}function Um(e,t,r,n,A){A[e]!=null||t==null||t===""||(A[e]=t,t=ir(t),n[n.length]=r?Pe(e,t,r):Cn(e,t))}function u4(e,t){var r=t||{},n=[Xr,Pe("cp:coreProperties",null,{"xmlns:cp":an.CORE_PROPS,"xmlns:dc":an.dc,"xmlns:dcterms":an.dcterms,"xmlns:dcmitype":an.dcmitype,"xmlns:xsi":an.xsi})],A={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Um("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Rp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,A),e.ModifiedDate!=null&&Um("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Rp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,A));for(var s=0;s!=KA.length;++s){var l=KA[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Um(l[0],o,null,n,A)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ri=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],f4=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function d4(e,t,r,n){var A=[];if(typeof e=="string")A=qE(e,n);else for(var s=0;s<e.length;++s)A=A.concat(e[s].map(function(d){return{v:d}}));var l=typeof t=="string"?qE(t,n).map(function(d){return d.v}):t,o=0,u=0;if(l.length>0)for(var f=0;f!==A.length;f+=2){switch(u=+A[f+1].v,A[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=l.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=l.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=l.slice(o,o+u);break}o+=u}}function M9(e,t,r){var n={};return t||(t={}),e=pr(e),Ri.forEach(function(A){var s=(e.match(au(A[0]))||[])[1];switch(A[2]){case"string":s&&(t[A[1]]=Xt(s));break;case"bool":t[A[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+A[0]+"[^>]*>([\\s\\S]*?)</"+A[0]+">"));l&&l.length>0&&(n[A[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&d4(n.HeadingPairs,n.TitlesOfParts,t,r),t}function h4(e){var t=[],r=Pe;return e||(e={}),e.Application="SheetJS",t[t.length]=Xr,t[t.length]=Pe("Properties",null,{xmlns:an.EXT_PROPS,"xmlns:vt":an.vt}),Ri.forEach(function(n){if(e[n[1]]!==void 0){var A;switch(n[2]){case"string":A=ir(String(e[n[1]]));break;case"bool":A=e[n[1]]?"true":"false";break}A!==void 0&&(t[t.length]=r(n[0],A))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ir(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var L9=/<[^>]+>[^<]*/g;function H9(e,t){var r={},n="",A=e.match(L9);if(A)for(var s=0;s!=A.length;++s){var l=A[s],o=gt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Xt(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var u=l.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Xt(d);break;case"bool":r[n]=Tr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Sr(d);break;case"cy":case"error":r[n]=Xt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,u)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function g4(e){var t=[Xr,Pe("Properties",null,{xmlns:an.CUST_PROPS,"xmlns:vt":an.vt})];if(!e)return t.join("");var r=1;return Hr(e).forEach(function(A){++r,t[t.length]=Pe("property",J7(e[A]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ir(A)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Op={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},km;function O9(e,t,r){km||(km=Ld(Op)),t=km[t]||t,e[t]=r}function P9(e,t){var r=[];return Hr(Op).map(function(n){for(var A=0;A<KA.length;++A)if(KA[A][1]==n)return KA[A];for(A=0;A<Ri.length;++A)if(Ri[A][1]==n)return Ri[A];throw n}).forEach(function(n){if(e[n[1]]!=null){var A=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":A=new Date(A).toISOString().replace(/\.\d*Z/,"Z");break}typeof A=="number"?A=String(A):A===!0||A===!1?A=A?"1":"0":A instanceof Date&&(A=new Date(A).toISOString().replace(/\.\d*Z/,"")),r.push(Cn(Op[n[1]]||n[1],A))}}),Pe("DocumentProperties",r.join(""),{xmlns:gA.o})}function G9(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",A=[];return e&&Hr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<KA.length;++l)if(s==KA[l][1])return;for(l=0;l<Ri.length;++l)if(s==Ri[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),A.push(Pe(XE(s),o,{"dt:dt":u}))}}),t&&Hr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),A.push(Pe(XE(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+gA.o+'">'+A.join("")+"</"+n+">"}function Ox(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function V9(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),A=(r-n)/Math.pow(2,32);n*=1e7,A*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),A+=s);var l=_e(8);return l.write_shift(4,n),l.write_shift(4,A),l}function m4(e,t,r){var n=e.l,A=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return A}function p4(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function x4(e,t,r){return t===31?p4(e):m4(e,t,r)}function Pp(e,t,r){return x4(e,t,r===!1?0:4)}function K9(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return x4(e,t,0)}function j9(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var A=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Jn,""),e.l-A&2&&(e.l+=2)}return r}function z9(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Jn,"");return r}function X9(e){var t=e.l,r=ud(e,s4);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ud(e,nA);return[r,n]}function J9(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(X9(e));return r}function l2(e,t){for(var r=e.read_shift(4),n={},A=0;A!=r;++A){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Jn,"").replace(Ic,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function v4(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Y9(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ud(e,t,r){var n=e.read_shift(2),A,s=r||{};if(e.l+=2,t!==a2&&n!==t&&S9.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===a2?n:t){case 2:return A=e.read_shift(2,"i"),s.raw||(e.l+=2),A;case 3:return A=e.read_shift(4,"i"),A;case 11:return e.read_shift(4)!==0;case 19:return A=e.read_shift(4),A;case 30:return m4(e,n,4).replace(Jn,"");case 31:return p4(e);case 64:return Ox(e);case 65:return v4(e);case 71:return Y9(e);case 80:return Pp(e,n,!s.raw).replace(Jn,"");case 81:return K9(e,n).replace(Jn,"");case 4108:return J9(e);case 4126:case 4127:return n==4127?j9(e):z9(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function o2(e,t){var r=_e(4),n=_e(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_e(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=V9(t);break;case 31:case 80:for(n=_e(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return un([r,n])}function c2(e,t){var r=e.l,n=e.read_shift(4),A=e.read_shift(4),s=[],l=0,o=0,u=-1,f={};for(l=0;l!=A;++l){var d=e.read_shift(4),m=e.read_shift(4);s[l]=[d,m+r]}s.sort(function(F,S){return F[1]-S[1]});var x={};for(l=0;l!=A;++l){if(e.l!==s[l][1]){var y=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],y=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],y=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(y=!1,e.l=s[l][1]),y)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var C=t[s[l][0]];if(x[C.n]=ud(e,C.t,{raw:!0}),C.p==="version"&&(x[C.n]=String(x[C.n]>>16)+"."+("0000"+String(x[C.n]&65535)).slice(-4)),C.n=="CodePage")switch(x[C.n]){case 0:x[C.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ea(o=x[C.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[C.n])}}else if(s[l][0]===1){if(o=x.CodePage=ud(e,Lx),ea(o),u!==-1){var E=e.l;e.l=s[u][1],f=l2(e,o),e.l=E}}else if(s[l][0]===0){if(o===0){u=l,e.l=s[l+1][1];continue}f=l2(e,o)}else{var T=f[s[l][0]],_;switch(e[e.l]){case 65:e.l+=4,_=v4(e);break;case 30:e.l+=4,_=Pp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Pp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Kr(e,4);break;case 64:e.l+=4,_=Sr(Ox(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[T]=_}}return e.l=r+n,x}var w4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function W9(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function u2(e,t,r){var n=_e(8),A=[],s=[],l=8,o=0,u=_e(8),f=_e(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),A.push(f),l+=8+u.length,!t){f=_e(8),f.write_shift(4,0),A.unshift(f);var d=[_e(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(u=_e(8+2*(m.length+1)+(m.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,m.length+1),u.write_shift(0,m,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=un(d),s.unshift(u),l+=8+u.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(w4.indexOf(e[o][0])>-1||f4.indexOf(e[o][0])>-1)&&e[o][1]!=null){var x=e[o][1],y=0;if(t){y=+t[e[o][0]];var C=r[y];if(C.p=="version"&&typeof x=="string"){var E=x.split(".");x=(+E[0]<<16)+(+E[1]||0)}u=o2(C.t,x)}else{var T=W9(x);T==-1&&(T=31,x=String(x)),u=o2(T,x)}s.push(u),f=_e(8),f.write_shift(4,t?y:2+o),A.push(f),l+=8+u.length}var _=8*(s.length+1);for(o=0;o<s.length;++o)A[o].write_shift(4,_),_+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),un([n].concat(A).concat(s))}function f2(e,t,r){var n=e.content;if(!n)return{};Bn(n,0);var A,s,l,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==lt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(A=n.read_shift(4),A!==1&&A!==2)throw new Error("Unrecognized #Sets: "+A);if(s=n.read_shift(16),o=n.read_shift(4),A===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);A===2&&(l=n.read_shift(16),u=n.read_shift(4));var m=c2(n,t),x={SystemIdentifier:f};for(var y in m)x[y]=m[y];if(x.FMTID=s,A===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var C;try{C=c2(n,null)}catch{}for(y in C)x[y]=C[y];return x.FMTID=[s,l],x}function d2(e,t,r,n,A,s){var l=_e(A?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,lt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,A?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,A?68:48);var u=u2(e,r,n);if(o.push(u),A){var f=u2(A,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+u.length),o.push(f)}return un(o)}function Rs(e,t){return e.read_shift(t),null}function q9(e,t){t||(t=_e(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function $9(e,t,r){for(var n=[],A=e.l+t;e.l<A;)n.push(r(e,A-e.l));if(A!==e.l)throw new Error("Slurp error");return n}function Kr(e,t){return e.read_shift(t)===1}function Xn(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function en(e){return e.read_shift(2,"u")}function HA(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function y4(e,t){return $9(e,t,en)}function Z9(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function B4(e,t,r){return r||(r=_e(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Bu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),A="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(A="dbcs-cont")}else r.biff==12&&(A="wstr");r.biff>=2&&r.biff<=5&&(A="cpstr");var l=n?e.read_shift(n,A):"";return l}function eG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,A=r&8,s=1+(r&1),l=0,o,u={};A&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return A&&(e.l+=4*l),n&&(e.l+=o),u.t=d,A||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function tG(e){var t=e.t||"",r=_e(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_e(2*t.length);n.write_shift(2*t.length,t,"utf16le");var A=[r,n];return un(A)}function Pi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var A=e.read_shift(1);return A===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Cu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Pi(e,n,r)}function $i(e,t,r){if(r.biff>5)return Cu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function C4(e,t,r){return r||(r=_e(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function rG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function nG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var A=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Jn,"");return n&&(e.l+=24),A}function AG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var A=e.read_shift(4);if(A===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(Jn,"");return r+l}function aG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nG(e);case"0303000000000000c000000000000046":return AG(e);default:throw new Error("Unsupported Moniker "+r)}}function vf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Jn,""):"";return r}function h2(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function sG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var A=e.read_shift(2);e.l+=2;var s,l,o,u,f="",d,m;A&16&&(s=vf(e,r-e.l)),A&128&&(l=vf(e,r-e.l)),(A&257)===257&&(o=vf(e,r-e.l)),(A&257)===1&&(u=aG(e,r-e.l)),A&8&&(f=vf(e,r-e.l)),A&32&&(d=e.read_shift(16)),A&64&&(m=Ox(e)),e.l=r;var x=l||o||u||"";x&&f&&(x+="#"+f),x||(x="#"+f),A&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var y={Target:x};return d&&(y.guid=d),m&&(y.time=m),s&&(y.Tooltip=s),y}function iG(e){var t=_e(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var A=n.indexOf("#"),s=A>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),h2(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=A>-1?n.slice(0,A):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&h2(A>-1?n.slice(A+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)t.write_shift(1,n.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function E4(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),A=e.read_shift(1);return[t,r,n,A]}function T4(e,t){var r=E4(e);return r[3]=0,r}function Ba(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Gi(e,t,r,n){return n||(n=_e(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function lG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oG(e,t,r){return t===0?"":$i(e,t,r)}function cG(e,t,r){var n=r.biff>8?4:2,A=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[A,s,l]}function S4(e){var t=e.read_shift(2),r=Mx(e);return[t,r]}function uG(e,t,r){e.l+=4,t-=4;var n=e.l+t,A=Bu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,A}function Pd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),A=e.read_shift(2);return{s:{c:n,r:t},e:{c:A,r}}}function _4(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function b4(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),A=e.read_shift(1);return{s:{c:n,r:t},e:{c:A,r}}}var fG=b4;function F4(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function dG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function hG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Fn(e){e.l+=2,e.l+=e.read_shift(2)}var gG={0:Fn,4:Fn,5:Fn,6:Fn,7:hG,8:Fn,9:Fn,10:Fn,11:Fn,12:Fn,13:dG,14:Fn,15:Fn,16:Fn,17:Fn,18:Fn,19:Fn,20:Fn,21:F4};function mG(e,t){for(var r=e.l+t,n=[];e.l<r;){var A=e.read_shift(2);e.l-=2;try{n.push(gG[A](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function wf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Px(e,t,r){var n=1536,A=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,A=8;break;case"biff4":n=4,A=6;break;case"biff3":n=3,A=6;break;case"biff2":n=2,A=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_e(A);return s.write_shift(2,n),s.write_shift(2,t),A>4&&s.write_shift(2,29282),A>6&&s.write_shift(2,1997),A>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function pG(e,t){return t===0||e.read_shift(2),1200}function xG(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,A=$i(e,0,r);return e.read_shift(t+n-e.l),A}function vG(e,t){var r=!t||t.biff==8,n=_e(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function wG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function yG(e,t,r){var n=e.read_shift(4),A=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Bu(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:A,dt:s,name:l}}function BG(e,t){var r=!t||t.biff>=8?2:1,n=_e(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var A=n.slice(0,n.l);return A.l=n.l,A}function CG(e,t){for(var r=e.l+t,n=e.read_shift(4),A=e.read_shift(4),s=[],l=0;l!=A&&e.l<r;++l)s.push(eG(e));return s.Count=n,s.Unique=A,s}function EG(e,t){var r=_e(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],A=0;A<e.length;++A)n[A]=tG(e[A]);var s=un([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function TG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function SG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function _G(e){var t=lG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function bG(e){return e.read_shift(2),e.read_shift(4)}function g2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var A=e.read_shift(2);r&&r.biff==2&&(n=1-(A>>15),A&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,A]}function FG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),A=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,A],Flags:s,CurTab:l,FirstTab:o,Selected:u,TabRatio:f}}function UG(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function kG(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function NG(e){var t=_e(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function IG(){}function QG(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Bu(e,0,r),n}function RG(e,t){var r=e.name||"Arial",n=t&&t.biff==5,A=n?15+r.length:16+2*r.length,s=_e(A);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function DG(e){var t=Ba(e);return t.isst=e.read_shift(4),t}function MG(e,t,r,n){var A=_e(10);return Gi(e,t,n,A),A.write_shift(4,r),A}function LG(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,A=Ba(e);r.biff==2&&e.l++;var s=Cu(e,n-e.l,r);return A.val=s,A}function HG(e,t,r,n,A){var s=!A||A.biff==8,l=_e(8+ +s+(1+s)*r.length);return Gi(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function OG(e,t,r){var n=e.read_shift(2),A=$i(e,0,r);return[n,A]}function PG(e,t,r,n){var A=r&&r.biff==5;n||(n=_e(A?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(A?1:2,t.length),A||n.write_shift(1,1),n.write_shift((A?1:2)*t.length,t,A?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var GG=$i;function m2(e,t,r){var n=e.l+t,A=r.biff==8||!r.biff?4:2,s=e.read_shift(A),l=e.read_shift(A),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:u}}}function VG(e,t){var r=t.biff==8||!t.biff?4:2,n=_e(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function KG(e){var t=e.read_shift(2),r=e.read_shift(2),n=S4(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function jG(e,t){for(var r=e.l+t-2,n=e.read_shift(2),A=e.read_shift(2),s=[];e.l<r;)s.push(S4(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-A+1)throw new Error("MulRK length mismatch");return{r:n,c:A,C:l,rkrec:s}}function zG(e,t){for(var r=e.l+t-2,n=e.read_shift(2),A=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-A+1)throw new Error("MulBlank length mismatch");return{r:n,c:A,C:l,ixfe:s}}function XG(e,t,r,n){var A={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return A.patternType=_9[o>>26],n.cellStyles&&(A.alc=s&7,A.fWrap=s>>3&1,A.alcV=s>>4&7,A.fJustLast=s>>7&1,A.trot=s>>8&255,A.cIndent=s>>16&15,A.fShrinkToFit=s>>20&1,A.iReadOrder=s>>22&2,A.fAtrNum=s>>26&1,A.fAtrFnt=s>>27&1,A.fAtrAlc=s>>28&1,A.fAtrBdr=s>>29&1,A.fAtrPat=s>>30&1,A.fAtrProt=s>>31&1,A.dgLeft=l&15,A.dgRight=l>>4&15,A.dgTop=l>>8&15,A.dgBottom=l>>12&15,A.icvLeft=l>>16&127,A.icvRight=l>>23&127,A.grbitDiag=l>>30&3,A.icvTop=o&127,A.icvBottom=o>>7&127,A.icvDiag=o>>14&127,A.dgDiag=o>>21&15,A.icvFore=u&127,A.icvBack=u>>7&127,A.fsxButton=u>>14&1),A}function JG(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=XG(e,t,n.fStyle,r),n}function p2(e,t,r,n){var A=r&&r.biff==5;n||(n=_e(A?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&A&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),A||n.write_shift(4,0),n.write_shift(2,0),n}function YG(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function WG(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function x2(e,t,r){var n=Ba(e);(r.biff==2||t==9)&&++e.l;var A=Z9(e);return n.val=A,n.t=A===!0||A===!1?"b":"e",n}function qG(e,t,r,n,A,s){var l=_e(8);return Gi(e,t,n,l),B4(r,s,l),l}function $G(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ba(e),A=Dn(e);return n.val=A,n}function ZG(e,t,r,n){var A=_e(14);return Gi(e,t,n,A),Oi(r,A),A}var v2=oG;function eV(e,t,r){var n=e.l+t,A=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,A];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Pi(e,s),o=[];n>e.l;)o.push(Cu(e));return[s,A,l,o]}function w2(e,t,r){var n=e.read_shift(2),A,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(A=uG(e,t-2,r)),s.body=A||e.read_shift(t-2),typeof A=="string"&&(s.Name=A),s}var tV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function y2(e,t,r){var n=e.l+t,A=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Pi(e,l,r);A&32&&(f=tV[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var m=n==e.l||o===0||!(d>0)?[]:mX(e,d,r,o);return{chKey:s,Name:f,itab:u,rgce:m}}function U4(e,t,r){if(r.biff<8)return rV(e,t,r);for(var n=[],A=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(cG(e,r.biff>8?12:6,r));if(e.l!=A)throw new Error("Bad ExternSheet: "+e.l+" != "+A);return n}function rV(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Bu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function nV(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),A=e.read_shift(2),s=Pi(e,n,r),l=Pi(e,A,r);return[s,l]}function AV(e,t,r){var n=b4(e);e.l++;var A=e.read_shift(1);return t-=8,[pX(e,t,r),A,n]}function B2(e,t,r){var n=fG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,hX(e,t,r)]}function aV(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function sV(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),A=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=$i(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:A},o,l,s]}}function iV(e,t,r){return sV(e,t,r)}function lV(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Pd(e));return r}function oV(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)_4(e[r],t);return t}function cV(e,t,r){if(r&&r.biff<8)return fV(e,t,r);var n=F4(e),A=mG(e,t-22,n[1]);return{cmo:n,ft:A}}var uV={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var A=e.read_shift(1);return e.l+=A,e.l=r,{fmt:n}}};function fV(e,t,r){e.l+=4;var n=e.read_shift(2),A=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((uV[n]||Hn)(e,t,r)),{cmo:[A,n,s],ft:l}}function dV(e,t,r){var n=e.l,A="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=rG(e,6,r);var o=e.read_shift(2);e.read_shift(2),en(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],m=Pi(e,e.lens[f+1]-e.lens[f]-1);if(A+=m,A.length>=(d?o:2*o))break}if(A.length!==o&&A.length!==o*2)throw new Error("cchText: "+o+" != "+A.length);return e.l=n+t,{t:A}}catch{return e.l=n+t,{t:A}}}function hV(e,t){var r=Pd(e);e.l+=16;var n=sG(e,t-24);return[r,n]}function gV(e){var t=_e(24),r=Qr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),A=0;A<16;++A)t.write_shift(1,parseInt(n[A],16));return un([t,iG(e[1])])}function mV(e,t){e.read_shift(2);var r=Pd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Jn,""),[r,n]}function pV(e){var t=e[1].Tooltip,r=_e(10+2*(t.length+1));r.write_shift(2,2048);var n=Qr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var A=0;A<t.length;++A)r.write_shift(2,t.charCodeAt(A));return r.write_shift(2,0),r}function xV(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=s2[r]||r,r=e.read_shift(2),t[1]=s2[r]||r,t}function vV(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function wV(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(T4(e));return r}function yV(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(T4(e));return r}function BV(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function k4(e,t,r){if(!r.cellStyles)return Hn(e,t);var n=r&&r.biff>=12?4:2,A=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:A,e:s,w:l,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function CV(e,t){var r=_e(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function EV(e,t){var r={};return t<32||(e.l+=16,r.header=Dn(e),r.footer=Dn(e),e.l+=2),r}function TV(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var A=e.read_shift(1);return e.l+=3,A&16&&(n.area=!0),n}function SV(e){for(var t=_e(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var _V=Ba,bV=y4,FV=Cu;function UV(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),A={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,A}function kV(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ba(e);++e.l;var A=$i(e,t-7,r);return n.t="str",n.val=A,n}function NV(e){var t=Ba(e);++e.l;var r=Dn(e);return t.t="n",t.val=r,t}function IV(e,t,r){var n=_e(15);return _u(n,e,t),n.write_shift(8,r,"f"),n}function QV(e){var t=Ba(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function RV(e,t,r){var n=_e(9);return _u(n,e,t),n.write_shift(2,r),n}function DV(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function MV(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function LV(e,t,r){var n=e.l+t,A=Ba(e),s=e.read_shift(2),l=Pi(e,s,r);return e.l=n,A.t="str",A.val=l,A}var HV=[2,3,48,49,131,139,140,245],Gp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ld({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ys(1);switch(u.type){case"base64":d=pA(wA(o));break;case"binary":d=pA(o);break;case"buffer":case"array":d=o;break}Bn(d,0);var m=d.read_shift(1),x=!!(m&136),y=!1,C=!1;switch(m){case 2:break;case 3:break;case 48:y=!0,x=!0;break;case 49:y=!0,x=!0;break;case 131:break;case 139:break;case 140:C=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var E=0,T=521;m==2&&(E=d.read_shift(2)),d.l+=3,m!=2&&(E=d.read_shift(4)),E>1048576&&(E=1e6),m!=2&&(T=d.read_shift(2));var _=d.read_shift(2),F=u.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=e[d[d.l]]),d.l+=1,d.l+=2),C&&(d.l+=36);for(var S=[],I={},M=Math.min(d.length,m==2?521:T-10-(y?264:0)),Q=C?32:11;d.l<M&&d[d.l]!=13;)switch(I={},I.name=ru.utils.decode(F,d.slice(d.l,d.l+Q)).replace(/[\u0000\r\n].*$/g,""),d.l+=Q,I.type=String.fromCharCode(d.read_shift(1)),m!=2&&!C&&(I.offset=d.read_shift(4)),I.len=d.read_shift(1),m==2&&(I.offset=d.read_shift(2)),I.dec=d.read_shift(1),I.name.length&&S.push(I),m!=2&&(d.l+=C?13:14),I.type){case"B":(!y||I.len!=8)&&u.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(d[d.l]!==13&&(d.l=T-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=T;var U=0,G=0;for(f[0]=[],G=0;G!=S.length;++G)f[0][G]=S[G].name;for(;E-- >0;){if(d[d.l]===42){d.l+=_;continue}for(++d.l,f[++U]=[],G=0,G=0;G!=S.length;++G){var R=d.slice(d.l,d.l+S[G].len);d.l+=S[G].len,Bn(R,0);var te=ru.utils.decode(F,R);switch(S[G].type){case"C":te.trim().length&&(f[U][G]=te.replace(/\s+$/,""));break;case"D":te.length===8?f[U][G]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):f[U][G]=te;break;case"F":f[U][G]=parseFloat(te.trim());break;case"+":case"I":f[U][G]=C?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":f[U][G]=!0;break;case"N":case"F":f[U][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[U][G]="##MEMO##"+(C?parseInt(te.trim(),10):R.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(f[U][G]=+te||0);break;case"@":f[U][G]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":f[U][G]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":f[U][G]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[U][G]=-R.read_shift(-8,"f");break;case"B":if(y&&S[G].len==8){f[U][G]=R.read_shift(8,"f");break}case"G":case"P":R.l+=S[G].len;break;case"0":if(S[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[G].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=S,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=yo(r(o,f),f);return d["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,d}function A(o,u){try{return ti(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,u){var f=u||{};if(+f.codepage>=0&&ea(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=aA(),m=hd(o,{header:1,raw:!0,cellDates:!0}),x=m[0],y=m.slice(1),C=o["!cols"]||[],E=0,T=0,_=0,F=1;for(E=0;E<x.length;++E){if(((C[E]||{}).DBF||{}).name){x[E]=C[E].DBF.name,++_;continue}if(x[E]!=null){if(++_,typeof x[E]=="number"&&(x[E]=x[E].toString(10)),typeof x[E]!="string")throw new Error("DBF Invalid column name "+x[E]+" |"+typeof x[E]+"|");if(x.indexOf(x[E])!==E){for(T=0;T<1024;++T)if(x.indexOf(x[E]+"_"+T)==-1){x[E]+="_"+T;break}}}}var S=Jt(o["!ref"]),I=[],M=[],Q=[];for(E=0;E<=S.e.c-S.s.c;++E){var U="",G="",R=0,te=[];for(T=0;T<y.length;++T)y[T][E]!=null&&te.push(y[T][E]);if(te.length==0||x[E]==null){I[E]="?";continue}for(T=0;T<te.length;++T){switch(typeof te[T]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=te[T]instanceof Date?"D":"C";break;default:G="C"}R=Math.max(R,String(te[T]).length),U=U&&U!=G?"C":G}R>250&&(R=250),G=((C[E]||{}).DBF||{}).type,G=="C"&&C[E].DBF.len>R&&(R=C[E].DBF.len),U=="B"&&G=="N"&&(U="N",Q[E]=C[E].DBF.dec,R=C[E].DBF.len),M[E]=U=="C"||G=="N"?R:s[U]||0,F+=M[E],I[E]=U}var ne=d.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,y.length),ne.write_shift(2,296+32*_),ne.write_shift(2,F),E=0;E<4;++E)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[w_]||3)<<8),E=0,T=0;E<x.length;++E)if(x[E]!=null){var ee=d.next(32),ae=(x[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,ae,"sbcs"),ee.write_shift(1,I[E]=="?"?"C":I[E],"sbcs"),ee.write_shift(4,T),ee.write_shift(1,M[E]||s[I[E]]||0),ee.write_shift(1,Q[E]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),T+=M[E]||s[I[E]]||0}var Se=d.next(264);for(Se.write_shift(4,13),E=0;E<65;++E)Se.write_shift(4,0);for(E=0;E<y.length;++E){var Te=d.next(F);for(Te.write_shift(1,0),T=0;T<x.length;++T)if(x[T]!=null)switch(I[T]){case"L":Te.write_shift(1,y[E][T]==null?63:y[E][T]?84:70);break;case"B":Te.write_shift(8,y[E][T]||0,"f");break;case"N":var q="0";for(typeof y[E][T]=="number"&&(q=y[E][T].toFixed(Q[T]||0)),_=0;_<M[T]-q.length;++_)Te.write_shift(1,32);Te.write_shift(1,q,"sbcs");break;case"D":y[E][T]?(Te.write_shift(4,("0000"+y[E][T].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(y[E][T].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+y[E][T].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(y[E][T]!=null?y[E][T]:"").slice(0,M[T]);for(Te.write_shift(1,oe,"sbcs"),_=0;_<M[T]-oe.length;++_)Te.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:A,to_sheet:n,from_sheet:l}})(),N4=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Hr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,y){var C=e[y];return typeof C=="number"?IE(C):C},n=function(x,y,C){var E=y.charCodeAt(0)-32<<4|C.charCodeAt(0)-48;return E==59?x:IE(E)};e["|"]=254;function A(x,y){switch(y.type){case"base64":return s(wA(x),y);case"binary":return s(x,y);case"buffer":return s(kt&&Buffer.isBuffer(x)?x.toString("binary"):ei(x),y);case"array":return s(Hi(x),y)}throw new Error("Unrecognized type "+y.type)}function s(x,y){var C=x.split(/[\n\r]+/),E=-1,T=-1,_=0,F=0,S=[],I=[],M=null,Q={},U=[],G=[],R=[],te=0,ne;for(+y.codepage>=0&&ea(+y.codepage);_!==C.length;++_){te=0;var ee=C[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ae=ee.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Se=ae[0],Te;if(ee.length>0)switch(Se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&I.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,oe=!1,Re=!1,ie=!1,Me=-1,X=-1;for(F=1;F<ae.length;++F)switch(ae[F].charAt(0)){case"A":break;case"X":T=parseInt(ae[F].slice(1))-1,oe=!0;break;case"Y":for(E=parseInt(ae[F].slice(1))-1,oe||(T=0),ne=S.length;ne<=E;++ne)S[ne]=[];break;case"K":Te=ae[F].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(Aa(Te))?isNaN(lo(Te).getDate())||(Te=Sr(Te)):(Te=Aa(Te),M!==null&&vo(M)&&(Te=Od(Te))),q=!0;break;case"E":ie=!0;var k=ao(ae[F].slice(1),{r:E,c:T});S[E][T]=[S[E][T],k];break;case"S":Re=!0,S[E][T]=[S[E][T],"S5S"];break;case"G":break;case"R":Me=parseInt(ae[F].slice(1))-1;break;case"C":X=parseInt(ae[F].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ee)}if(q&&(S[E][T]&&S[E][T].length==2?S[E][T][0]=Te:S[E][T]=Te,M=null),Re){if(ie)throw new Error("SYLK shared formula cannot have own formula");var K=Me>-1&&S[Me][X];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");S[E][T][1]=W4(K[1],{r:E-Me,c:T-X})}break;case"F":var P=0;for(F=1;F<ae.length;++F)switch(ae[F].charAt(0)){case"X":T=parseInt(ae[F].slice(1))-1,++P;break;case"Y":for(E=parseInt(ae[F].slice(1))-1,ne=S.length;ne<=E;++ne)S[ne]=[];break;case"M":te=parseInt(ae[F].slice(1))/20;break;case"F":break;case"G":break;case"P":M=I[parseInt(ae[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=ae[F].slice(1).split(" "),ne=parseInt(R[0],10);ne<=parseInt(R[1],10);++ne)te=parseInt(R[2],10),G[ne-1]=te===0?{hidden:!0}:{wch:te},Ws(G[ne-1]);break;case"C":T=parseInt(ae[F].slice(1))-1,G[T]||(G[T]={});break;case"R":E=parseInt(ae[F].slice(1))-1,U[E]||(U[E]={}),te>0?(U[E].hpt=te,U[E].hpx=co(te)):te===0&&(U[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ee)}P<1&&(M=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ee)}}return U.length>0&&(Q["!rows"]=U),G.length>0&&(Q["!cols"]=G),y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),[S,Q]}function l(x,y){var C=A(x,y),E=C[0],T=C[1],_=yo(E,y);return Hr(T).forEach(function(F){_[F]=T[F]}),_}function o(x,y){return ti(l(x,y),y)}function u(x,y,C,E){var T="C;Y"+(C+1)+";X"+(E+1)+";K";switch(x.t){case"n":T+=x.v||0,x.f&&!x.F&&(T+=";E"+Xx(x.f,{r:C,c:E}));break;case"b":T+=x.v?"TRUE":"FALSE";break;case"e":T+=x.w||x.v;break;case"d":T+='"'+(x.w||x.v)+'"';break;case"s":T+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function f(x,y){y.forEach(function(C,E){var T="F;W"+(E+1)+" "+(E+1)+" ";C.hidden?T+="0":(typeof C.width=="number"&&!C.wpx&&(C.wpx=cu(C.width)),typeof C.wpx=="number"&&!C.wch&&(C.wch=uu(C.wpx)),typeof C.wch=="number"&&(T+=Math.round(C.wch))),T.charAt(T.length-1)!=" "&&x.push(T)})}function d(x,y){y.forEach(function(C,E){var T="F;";C.hidden?T+="M0;":C.hpt?T+="M"+20*C.hpt+";":C.hpx&&(T+="M"+20*fu(C.hpx)+";"),T.length>2&&x.push(T+"R"+(E+1))})}function m(x,y){var C=["ID;PWXL;N;E"],E=[],T=Jt(x["!ref"]),_,F=Array.isArray(x),S=`\r
`;C.push("P;PGeneral"),C.push("F;P0;DG0G8;M255"),x["!cols"]&&f(C,x["!cols"]),x["!rows"]&&d(C,x["!rows"]),C.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var I=T.s.r;I<=T.e.r;++I)for(var M=T.s.c;M<=T.e.c;++M){var Q=ht({r:I,c:M});_=F?(x[I]||[])[M]:x[Q],!(!_||_.v==null&&(!_.f||_.F))&&E.push(u(_,x,I,M))}return C.join(S)+S+E.join(S)+S+"E"+S}return{to_workbook:o,to_sheet:l,from_sheet:m}})(),I4=(function(){function e(s,l){switch(l.type){case"base64":return t(wA(s),l);case"binary":return t(s,l);case"buffer":return t(kt&&Buffer.isBuffer(s)?s.toString("binary"):ei(s),l);case"array":return t(Hi(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),u=-1,f=-1,d=0,m=[];d!==o.length;++d){if(o[d].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var x=o[d].trim().split(","),y=x[0],C=x[1];++d;for(var E=o[d]||"";(E.match(/["]/g)||[]).length&1&&d<o.length-1;)E+=`
`+o[++d];switch(E=E.trim(),+y){case-1:if(E==="BOT"){m[++u]=[],f=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?m[u][f]=!0:E==="FALSE"?m[u][f]=!1:isNaN(Aa(C))?isNaN(lo(C).getDate())?m[u][f]=C:m[u][f]=Sr(C):m[u][f]=Aa(C),++f;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),m[u][f++]=E!==""?E:null;break}if(E==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function r(s,l){return yo(e(s,l),l)}function n(s,l){return ti(r(s,l),l)}var A=(function(){var s=function(u,f,d,m,x){u.push(f),u.push(d+","+m),u.push('"'+x.replace(/"/g,'""')+'"')},l=function(u,f,d,m){u.push(f+","+d),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],d=Jt(u["!ref"]),m,x=Array.isArray(u);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,d.e.r-d.s.r+1,""),s(f,"TUPLES",0,d.e.c-d.s.c+1,""),s(f,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){l(f,-1,0,"BOT");for(var C=d.s.c;C<=d.e.c;++C){var E=ht({r:y,c:C});if(m=x?(u[y]||[])[C]:u[E],!m){l(f,1,0,"");continue}switch(m.t){case"n":var T=m.w;!T&&m.v!=null&&(T=m.v),T==null?m.f&&!m.F?l(f,1,0,"="+m.f):l(f,1,0,""):l(f,0,T,"V");break;case"b":l(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=zA(m.z||dt[14],sn(Sr(m.v)))),l(f,0,m.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var _=`\r
`,F=f.join(_);return F}})();return{to_workbook:n,to_sheet:r,from_sheet:A}})(),Q4=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var y=m.split(`
`),C=-1,E=-1,T=0,_=[];T!==y.length;++T){var F=y[T].trim().split(":");if(F[0]==="cell"){var S=Qr(F[1]);if(_.length<=S.r)for(C=_.length;C<=S.r;++C)_[C]||(_[C]=[]);switch(C=S.r,E=S.c,F[2]){case"t":_[C][E]=e(F[3]);break;case"v":_[C][E]=+F[3];break;case"vtf":var I=F[F.length-1];case"vtc":switch(F[3]){case"nl":_[C][E]=!!+F[4];break;default:_[C][E]=+F[4];break}F[2]=="vtf"&&(_[C][E]=[_[C][E],I])}}}return x&&x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}function n(m,x){return yo(r(m,x),x)}function A(m,x){return ti(n(m,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var x=[],y=[],C,E="",T=sA(m["!ref"]),_=Array.isArray(m),F=T.s.r;F<=T.e.r;++F)for(var S=T.s.c;S<=T.e.c;++S)if(E=ht({r:F,c:S}),C=_?(m[F]||[])[S]:m[E],!(!C||C.v==null||C.t==="z")){switch(y=["cell",E,"t"],C.t){case"s":case"str":y.push(t(C.v));break;case"n":C.f?(y[2]="vtf",y[3]="n",y[4]=C.v,y[5]=t(C.f)):(y[2]="v",y[3]=C.v);break;case"b":y[2]="vt"+(C.f?"f":"c"),y[3]="nl",y[4]=C.v?"1":"0",y[5]=t(C.f||(C.v?"TRUE":"FALSE"));break;case"d":var I=sn(Sr(C.v));y[2]="vtc",y[3]="nd",y[4]=""+I,y[5]=C.w||zA(C.z||dt[14],I);break;case"e":continue}x.push(y.join(":"))}return x.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(m){return[s,l,o,l,f(m),u].join(`
`)}return{to_workbook:A,to_sheet:n,from_sheet:d}})(),oo=(function(){function e(d,m,x,y,C){C.raw?m[x][y]=d:d===""||(d==="TRUE"?m[x][y]=!0:d==="FALSE"?m[x][y]=!1:isNaN(Aa(d))?isNaN(lo(d).getDate())?m[x][y]=d:m[x][y]=Sr(d):m[x][y]=Aa(d))}function t(d,m){var x=m||{},y=[];if(!d||d.length===0)return y;for(var C=d.split(/[\r\n]/),E=C.length-1;E>=0&&C[E].length===0;)--E;for(var T=10,_=0,F=0;F<=E;++F)_=C[F].indexOf(" "),_==-1?_=C[F].length:_++,T=Math.max(T,_);for(F=0;F<=E;++F){y[F]=[];var S=0;for(e(C[F].slice(0,T).trim(),y,F,S,x),S=1;S<=(C[F].length-T)/10+1;++S)e(C[F].slice(T+(S-1)*10,T+S*10).trim(),y,F,S,x)}return x.sheetRows&&(y=y.slice(0,x.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function A(d){for(var m={},x=!1,y=0,C=0;y<d.length;++y)(C=d.charCodeAt(y))==34?x=!x:!x&&C in r&&(m[C]=(m[C]||0)+1);C=[];for(y in m)Object.prototype.hasOwnProperty.call(m,y)&&C.push([m[y],y]);if(!C.length){m=n;for(y in m)Object.prototype.hasOwnProperty.call(m,y)&&C.push([m[y],y])}return C.sort(function(E,T){return E[0]-T[0]||n[E[1]]-n[T[1]]}),r[C.pop()[1]]||44}function s(d,m){var x=m||{},y="",C=x.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=A(d.slice(0,1024)):x&&x.FS?y=x.FS:y=A(d.slice(0,1024));var T=0,_=0,F=0,S=0,I=0,M=y.charCodeAt(0),Q=!1,U=0,G=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var R=x.dateNF!=null?T7(x.dateNF):null;function te(){var ne=d.slice(S,I),ee={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)ee.t="z";else if(x.raw)ee.t="s",ee.v=ne;else if(ne.trim().length===0)ee.t="s",ee.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(ee.t="s",ee.v=ne.slice(2,-1).replace(/""/g,'"')):ez(ne)?(ee.t="n",ee.f=ne.slice(1)):(ee.t="s",ee.v=ne);else if(ne=="TRUE")ee.t="b",ee.v=!0;else if(ne=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(F=Aa(ne)))ee.t="n",x.cellText!==!1&&(ee.w=ne),ee.v=F;else if(!isNaN(lo(ne).getDate())||R&&ne.match(R)){ee.z=x.dateNF||dt[14];var ae=0;R&&ne.match(R)&&(ne=S7(ne,x.dateNF,ne.match(R)||[]),ae=1),x.cellDates?(ee.t="d",ee.v=Sr(ne,ae)):(ee.t="n",ee.v=sn(Sr(ne,ae))),x.cellText!==!1&&(ee.w=zA(ee.z,ee.v instanceof Date?sn(ee.v):ee.v)),x.cellNF||delete ee.z}else ee.t="s",ee.v=ne;if(ee.t=="z"||(x.dense?(C[T]||(C[T]=[]),C[T][_]=ee):C[ht({c:_,r:T})]=ee),S=I+1,G=d.charCodeAt(S),E.e.c<_&&(E.e.c=_),E.e.r<T&&(E.e.r=T),U==M)++_;else if(_=0,++T,x.sheetRows&&x.sheetRows<=T)return!0}e:for(;I<d.length;++I)switch(U=d.charCodeAt(I)){case 34:G===34&&(Q=!Q);break;case M:case 10:case 13:if(!Q&&te())break e;break}return I-S>0&&te(),C["!ref"]=St(E),C}function l(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,m):yo(t(d,m),m)}function o(d,m){var x="",y=m.type=="string"?[0,0,0,0]:tv(d,m);switch(m.type){case"base64":x=wA(d);break;case"binary":x=d;break;case"buffer":m.codepage==65001?x=d.toString("utf8"):m.codepage&&typeof ru<"u"||(x=kt&&Buffer.isBuffer(d)?d.toString("binary"):ei(d));break;case"array":x=Hi(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+m.type)}return y[0]==239&&y[1]==187&&y[2]==191?x=pr(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=pr(x):m.type=="binary"&&typeof ru<"u",x.slice(0,19)=="socialcalc:version:"?Q4.to_sheet(m.type=="string"?x:pr(x),m):l(x,m)}function u(d,m){return ti(o(d,m),m)}function f(d){for(var m=[],x=Jt(d["!ref"]),y,C=Array.isArray(d),E=x.s.r;E<=x.e.r;++E){for(var T=[],_=x.s.c;_<=x.e.c;++_){var F=ht({r:E,c:_});if(y=C?(d[E]||[])[_]:d[F],!y||y.v==null){T.push("          ");continue}for(var S=(y.w||(rs(y),y.w)||"").slice(0,10);S.length<10;)S+=" ";T.push(S+(_===0?" ":""))}m.push(T.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}})();function OV(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var A=N4.to_workbook(e,r);return r.WTF=n,A}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return oo.to_workbook(e,t)}}var Di=(function(){function e(k,K,P){if(k){Bn(k,k.l||0);for(var z=P.Enum||Me;k.l<k.length;){var Z=k.read_shift(2),le=z[Z]||z[65535],Ce=k.read_shift(2),he=k.l+Ce,Ae=le.f&&le.f(k,Ce,P);if(k.l=he,K(Ae,le,Z))return}}}function t(k,K){switch(K.type){case"base64":return r(pA(wA(k)),K);case"binary":return r(pA(k),K);case"buffer":case"array":return r(k,K)}throw"Unsupported type "+K.type}function r(k,K){if(!k)return k;var P=K||{},z=P.dense?[]:{},Z="Sheet1",le="",Ce=0,he={},Ae=[],ce=[],L={s:{r:0,c:0},e:{r:0,c:0}},je=P.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)P.Enum=Me,e(k,function(De,ct,Kt){switch(Kt){case 0:P.vers=De,De>=4096&&(P.qpro=!0);break;case 6:L=De;break;case 204:De&&(le=De);break;case 222:le=De;break;case 15:case 51:P.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Kt==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=P.dateNF||dt[14],P.cellDates&&(De[1].t="d",De[1].v=Od(De[1].v))),P.qpro&&De[3]>Ce&&(z["!ref"]=St(L),he[Z]=z,Ae.push(Z),z=P.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},Ce=De[3],Z=le||"Sheet"+(Ce+1),le="");var lr=P.dense?(z[De[0].r]||[])[De[0].c]:z[ht(De[0])];if(lr){lr.t=De[1].t,lr.v=De[1].v,De[1].z!=null&&(lr.z=De[1].z),De[1].f!=null&&(lr.f=De[1].f);break}P.dense?(z[De[0].r]||(z[De[0].r]=[]),z[De[0].r][De[0].c]=De[1]):z[ht(De[0])]=De[1];break}},P);else if(k[2]==26||k[2]==14)P.Enum=X,k[2]==14&&(P.qpro=!0,k.l=0),e(k,function(De,ct,Kt){switch(Kt){case 204:Z=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>Ce&&(z["!ref"]=St(L),he[Z]=z,Ae.push(Z),z=P.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},Ce=De[3],Z="Sheet"+(Ce+1)),je>0&&De[0].r>=je)break;P.dense?(z[De[0].r]||(z[De[0].r]=[]),z[De[0].r][De[0].c]=De[1]):z[ht(De[0])]=De[1],L.e.c<De[0].c&&(L.e.c=De[0].c),L.e.r<De[0].r&&(L.e.r=De[0].r);break;case 27:De[14e3]&&(ce[De[14e3][0]]=De[14e3][1]);break;case 1537:ce[De[0]]=De[1],De[0]==Ce&&(Z=De[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(z["!ref"]=St(L),he[le||Z]=z,Ae.push(le||Z),!ce.length)return{SheetNames:Ae,Sheets:he};for(var Je={},et=[],qe=0;qe<ce.length;++qe)he[Ae[qe]]?(et.push(ce[qe]||Ae[qe]),Je[ce[qe]]=he[ce[qe]]||he[Ae[qe]]):(et.push(ce[qe]),Je[ce[qe]]={"!ref":"A1"});return{SheetNames:et,Sheets:Je}}function n(k,K){var P=K||{};if(+P.codepage>=0&&ea(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var z=aA(),Z=Jt(k["!ref"]),le=Array.isArray(k),Ce=[];Ge(z,0,s(1030)),Ge(z,6,u(Z));for(var he=Math.min(Z.e.r,8191),Ae=Z.s.r;Ae<=he;++Ae)for(var ce=zr(Ae),L=Z.s.c;L<=Z.e.c;++L){Ae===Z.s.r&&(Ce[L]=Ir(L));var je=Ce[L]+ce,Je=le?(k[Ae]||[])[L]:k[je];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?Ge(z,13,y(Ae,L,Je.v)):Ge(z,14,E(Ae,L,Je.v));else{var et=rs(Je);Ge(z,15,m(Ae,L,et.slice(0,239)))}}return Ge(z,1),z.end()}function A(k,K){var P=K||{};if(+P.codepage>=0&&ea(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var z=aA();Ge(z,0,l(k));for(var Z=0,le=0;Z<k.SheetNames.length;++Z)(k.Sheets[k.SheetNames[Z]]||{})["!ref"]&&Ge(z,27,ie(k.SheetNames[Z],le++));var Ce=0;for(Z=0;Z<k.SheetNames.length;++Z){var he=k.Sheets[k.SheetNames[Z]];if(!(!he||!he["!ref"])){for(var Ae=Jt(he["!ref"]),ce=Array.isArray(he),L=[],je=Math.min(Ae.e.r,8191),Je=Ae.s.r;Je<=je;++Je)for(var et=zr(Je),qe=Ae.s.c;qe<=Ae.e.c;++qe){Je===Ae.s.r&&(L[qe]=Ir(qe));var De=L[qe]+et,ct=ce?(he[Je]||[])[qe]:he[De];if(!(!ct||ct.t=="z"))if(ct.t=="n")Ge(z,23,te(Je,qe,Ce,ct.v));else{var Kt=rs(ct);Ge(z,22,U(Je,qe,Ce,Kt.slice(0,239)))}}++Ce}}return Ge(z,1),z.end()}function s(k){var K=_e(2);return K.write_shift(2,k),K}function l(k){var K=_e(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var P=0,z=0,Z=0,le=0;le<k.SheetNames.length;++le){var Ce=k.SheetNames[le],he=k.Sheets[Ce];if(!(!he||!he["!ref"])){++Z;var Ae=sA(he["!ref"]);P<Ae.e.r&&(P=Ae.e.r),z<Ae.e.c&&(z=Ae.e.c)}}return P>8191&&(P=8191),K.write_shift(2,P),K.write_shift(1,Z),K.write_shift(1,z),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(k,K,P){var z={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&P.qpro?(z.s.c=k.read_shift(1),k.l++,z.s.r=k.read_shift(2),z.e.c=k.read_shift(1),k.l++,z.e.r=k.read_shift(2),z):(z.s.c=k.read_shift(2),z.s.r=k.read_shift(2),K==12&&P.qpro&&(k.l+=2),z.e.c=k.read_shift(2),z.e.r=k.read_shift(2),K==12&&P.qpro&&(k.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function u(k){var K=_e(8);return K.write_shift(2,k.s.c),K.write_shift(2,k.s.r),K.write_shift(2,k.e.c),K.write_shift(2,k.e.r),K}function f(k,K,P){var z=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(z[0].c=k.read_shift(1),z[3]=k.read_shift(1),z[0].r=k.read_shift(2),k.l+=2):(z[2]=k.read_shift(1),z[0].c=k.read_shift(2),z[0].r=k.read_shift(2)),z}function d(k,K,P){var z=k.l+K,Z=f(k,K,P);if(Z[1].t="s",P.vers==20768){k.l++;var le=k.read_shift(1);return Z[1].v=k.read_shift(le,"utf8"),Z}return P.qpro&&k.l++,Z[1].v=k.read_shift(z-k.l,"cstr"),Z}function m(k,K,P){var z=_e(7+P.length);z.write_shift(1,255),z.write_shift(2,K),z.write_shift(2,k),z.write_shift(1,39);for(var Z=0;Z<z.length;++Z){var le=P.charCodeAt(Z);z.write_shift(1,le>=128?95:le)}return z.write_shift(1,0),z}function x(k,K,P){var z=f(k,K,P);return z[1].v=k.read_shift(2,"i"),z}function y(k,K,P){var z=_e(7);return z.write_shift(1,255),z.write_shift(2,K),z.write_shift(2,k),z.write_shift(2,P,"i"),z}function C(k,K,P){var z=f(k,K,P);return z[1].v=k.read_shift(8,"f"),z}function E(k,K,P){var z=_e(13);return z.write_shift(1,255),z.write_shift(2,K),z.write_shift(2,k),z.write_shift(8,P,"f"),z}function T(k,K,P){var z=k.l+K,Z=f(k,K,P);if(Z[1].v=k.read_shift(8,"f"),P.qpro)k.l=z;else{var le=k.read_shift(2);I(k.slice(k.l,k.l+le),Z),k.l+=le}return Z}function _(k,K,P){var z=K&32768;return K&=-32769,K=(z?k:0)+(K>=8192?K-16384:K),(z?"":"$")+(P?Ir(K):zr(K))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(k,K){Bn(k,0);for(var P=[],z=0,Z="",le="",Ce="",he="";k.l<k.length;){var Ae=k[k.l++];switch(Ae){case 0:P.push(k.read_shift(8,"f"));break;case 1:le=_(K[0].c,k.read_shift(2),!0),Z=_(K[0].r,k.read_shift(2),!1),P.push(le+Z);break;case 2:{var ce=_(K[0].c,k.read_shift(2),!0),L=_(K[0].r,k.read_shift(2),!1);le=_(K[0].c,k.read_shift(2),!0),Z=_(K[0].r,k.read_shift(2),!1),P.push(ce+L+":"+le+Z)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(k.read_shift(2));break;case 6:{for(var je="";Ae=k[k.l++];)je+=String.fromCharCode(Ae);P.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:he=P.pop(),Ce=P.pop(),P.push(["AND","OR"][Ae-20]+"("+Ce+","+he+")");break;default:if(Ae<32&&S[Ae])he=P.pop(),Ce=P.pop(),P.push(Ce+S[Ae]+he);else if(F[Ae]){if(z=F[Ae][1],z==69&&(z=k[k.l++]),z>P.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+P.join("|")+"|");return}var Je=P.slice(-z);P.length-=z,P.push(F[Ae][0]+"("+Je.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}P.length==1?K[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function M(k){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=k.read_shift(2),K[3]=k[k.l++],K[0].c=k[k.l++],K}function Q(k,K){var P=M(k);return P[1].t="s",P[1].v=k.read_shift(K-4,"cstr"),P}function U(k,K,P,z){var Z=_e(6+z.length);Z.write_shift(2,k),Z.write_shift(1,P),Z.write_shift(1,K),Z.write_shift(1,39);for(var le=0;le<z.length;++le){var Ce=z.charCodeAt(le);Z.write_shift(1,Ce>=128?95:Ce)}return Z.write_shift(1,0),Z}function G(k,K){var P=M(k);P[1].v=k.read_shift(2);var z=P[1].v>>1;if(P[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return P[1].v=z,P}function R(k,K){var P=M(k),z=k.read_shift(4),Z=k.read_shift(4),le=k.read_shift(2);if(le==65535)return z===0&&Z===3221225472?(P[1].t="e",P[1].v=15):z===0&&Z===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var Ce=le&32768;return le=(le&32767)-16446,P[1].v=(1-Ce*2)*(Z*Math.pow(2,le+32)+z*Math.pow(2,le)),P}function te(k,K,P,z){var Z=_e(14);if(Z.write_shift(2,k),Z.write_shift(1,P),Z.write_shift(1,K),z==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var le=0,Ce=0,he=0,Ae=0;return z<0&&(le=1,z=-z),Ce=Math.log2(z)|0,z/=Math.pow(2,Ce-31),Ae=z>>>0,(Ae&2147483648)==0&&(z/=2,++Ce,Ae=z>>>0),z-=Ae,Ae|=2147483648,Ae>>>=0,z*=Math.pow(2,32),he=z>>>0,Z.write_shift(4,he),Z.write_shift(4,Ae),Ce+=16383+(le?32768:0),Z.write_shift(2,Ce),Z}function ne(k,K){var P=R(k);return k.l+=K-14,P}function ee(k,K){var P=M(k),z=k.read_shift(4);return P[1].v=z>>6,P}function ae(k,K){var P=M(k),z=k.read_shift(8,"f");return P[1].v=z,P}function Se(k,K){var P=ae(k);return k.l+=K-10,P}function Te(k,K){return k[k.l+K-1]==0?k.read_shift(K,"cstr"):""}function q(k,K){var P=k[k.l++];P>K-1&&(P=K-1);for(var z="";z.length<P;)z+=String.fromCharCode(k[k.l++]);return z}function oe(k,K,P){if(!(!P.qpro||K<21)){var z=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var Z=k.read_shift(K-21,"cstr");return[z,Z]}}function Re(k,K){for(var P={},z=k.l+K;k.l<z;){var Z=k.read_shift(2);if(Z==14e3){for(P[Z]=[0,""],P[Z][0]=k.read_shift(2);k[k.l];)P[Z][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return P}function ie(k,K){var P=_e(5+k.length);P.write_shift(2,14e3),P.write_shift(2,K);for(var z=0;z<k.length;++z){var Z=k.charCodeAt(z);P[P.l++]=Z>127?95:Z}return P[P.l++]=0,P}var Me={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:C},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Q},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:Se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:A,to_workbook:t}})();function PV(e){var t={},r=e.match(On),n=0,A=!1;if(r)for(;n!=r.length;++n){var s=gt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=xx[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":A=!0;break;case"</ext>":A=!1;break;default:if(s[0].charCodeAt(1)!==47&&!A)throw new Error("Unrecognized rich format "+s[0])}}return t}var GV=(function(){var e=au("t"),t=au("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Xt(l[1])},u=s.match(t);return u&&(o.s=PV(u[1])),o}var n=/<(?:\w+:)?r>/g,A=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(A).map(r).filter(function(o){return o.v})}})(),VV=(function(){var t=/(\r\n|\n)/g;function r(A,s,l){var o=[];A.u&&o.push("text-decoration: underline;"),A.uval&&o.push("text-underline-style:"+A.uval+";"),A.sz&&o.push("font-size:"+A.sz+"pt;"),A.outline&&o.push("text-effect: outline;"),A.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),A.b&&(s.push("<b>"),l.push("</b>")),A.i&&(s.push("<i>"),l.push("</i>")),A.strike&&(s.push("<s>"),l.push("</s>"));var u=A.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),l.push("</"+u+">")),l.push("</span>"),A}function n(A){var s=[[],A.v,[]];return A.v?(A.s&&r(A.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),KV=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jV=/<(?:\w+:)?r>/,zV=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Gx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Xt(pr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pr(e),r&&(n.h=bx(n.t))):e.match(jV)&&(n.r=pr(e),n.t=Xt(pr((e.replace(zV,"").match(KV)||[]).join("").replace(On,""))),r&&(n.h=VV(GV(n.r)))),n):{t:""}}var XV=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,JV=/<(?:\w+:)?(?:si|sstItem)>/g,YV=/<\/(?:\w+:)?(?:si|sstItem)>/;function WV(e,t){var r=[],n="";if(!e)return r;var A=e.match(XV);if(A){n=A[2].replace(JV,"").split(YV);for(var s=0;s!=n.length;++s){var l=Gx(n[s].trim(),t);l!=null&&(r[r.length]=l)}A=gt(A[1]),r.Count=A.count,r.Unique=A.uniqueCount}return r}var qV=/^\s|\s$|[\t\n\r]/;function R4(e,t){if(!t.bookSST)return"";var r=[Xr];r[r.length]=Pe("sst",null,{xmlns:Xi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var A=e[n],s="<si>";A.r?s+=A.r:(s+="<t",A.t||(A.t=""),A.t.match(qV)&&(s+=' xml:space="preserve"'),s+=">"+ir(A.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function $V(e){return[e.read_shift(4),e.read_shift(4)]}function ZV(e,t){var r=[],n=!1;return is(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function eK(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tK=u9;function rK(e){var t=aA();Qe(t,159,eK(e));for(var r=0;r<e.length;++r)Qe(t,19,tK(e[r]));return Qe(t,160),t.end()}function D4(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function $a(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function nK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=$a(e,4),t.U=$a(e,4),t.W=$a(e,4),t}function AK(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},A=e.read_shift(4),s=[];A-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function aK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(AK(e));return t}function sK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function iK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=$a(e,4),t.U=$a(e,4),t.W=$a(e,4),t}function lK(e){var t=iK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function M4(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var A=!1;switch(n.AlgID){case 26126:case 26127:case 26128:A=n.Flags==36;break;case 26625:A=n.Flags==4;break;case 0:A=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!A)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function L4(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function oK(e){var t=$a(e);switch(t.Minor){case 2:return[t.Minor,cK(e)];case 3:return[t.Minor,uK()];case 4:return[t.Minor,fK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function cK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=M4(e,r),A=L4(e,e.length-e.l);return{t:"Std",h:n,v:A}}function uK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(On,function(s){var l=gt(s);switch(ya(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function dK(e,t){var r={},n=r.EncryptionVersionInfo=$a(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var A=e.read_shift(4);return t-=4,r.EncryptionHeader=M4(e,A),t-=A,r.EncryptionVerifier=L4(e,t),r}function hK(e){var t={},r=t.EncryptionVersionInfo=$a(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Vx(e){var t=0,r,n=D4(e),A=n.length+1,s,l,o,u,f;for(r=Ys(A),r[0]=n.length,s=1;s!=A;++s)r[s]=n[s-1];for(s=A-1;s>=0;--s)l=r[s],o=(t&16384)===0?0:1,u=t<<1&32767,f=o|u,t=f^l;return t^52811}var H4=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},A=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],u=104,f=l.length-1;f>=0;--f)for(var d=l[f],m=0;m!=7;++m)d&64&&(o^=r[u]),d*=2,--u;return o};return function(l){for(var o=D4(l),u=s(o),f=o.length,d=Ys(16),m=0;m!=16;++m)d[m]=0;var x,y,C;for((f&1)===1&&(x=u>>8,d[f]=A(e[0],x),--f,x=u&255,y=o[o.length-1],d[f]=A(y,x));f>0;)--f,x=u>>8,d[f]=A(o[f],x),--f,x=u&255,d[f]=A(o[f],x);for(f=15,C=15-o.length;C>0;)x=u>>8,d[f]=A(e[C],x),--f,--C,x=u&255,d[f]=A(o[f],x),--f,--C;return d}})(),gK=function(e,t,r,n,A){A||(A=t),n||(n=H4(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,A[s]=l,++r;return[A,r,n]},mK=function(e){var t=0,r=H4(e);return function(n){var A=gK("",n,t,r);return t=A[1],A[0]}};function pK(e,t,r,n){var A={key:en(e),verificationBytes:en(e)};return r.password&&(A.verifier=Vx(r.password)),n.valid=A.verificationBytes===A.verifier,n.valid&&(n.insitu=mK(r.password)),A}function xK(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=hK(e):n.Data=dK(e,t),n}function vK(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?xK(e,t-2,n):pK(e,r.biff>=8?t:t-2,r,n),n}var O4=(function(){function e(A,s){switch(s.type){case"base64":return t(wA(A),s);case"binary":return t(A,s);case"buffer":return t(kt&&Buffer.isBuffer(A)?A.toString("binary"):ei(A),s);case"array":return t(Hi(A),s)}throw new Error("Unrecognized type "+s.type)}function t(A,s){var l=s||{},o=l.dense?[]:{},u=A.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,m){Array.isArray(o)&&(o[m]=[]);for(var x=/\\\w+\b/g,y=0,C,E=-1;C=x.exec(d);){switch(C[0]){case"\\cell":var T=d.slice(y,x.lastIndex-C[0].length);if(T[0]==" "&&(T=T.slice(1)),++E,T.length){var _={v:T,t:"s"};Array.isArray(o)?o[m][E]=_:o[ht({r:m,c:E})]=_}break}y=x.lastIndex}E>f.e.c&&(f.e.c=E)}),o["!ref"]=St(f),o}function r(A,s){return ti(e(A,s),s)}function n(A){for(var s=["{\\rtf1\\ansi"],l=Jt(A["!ref"]),o,u=Array.isArray(A),f=l.s.r;f<=l.e.r;++f){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var m=ht({r:f,c:d});o=u?(A[f]||[])[d]:A[m],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(rs(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function wK(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ou(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function yK(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,A=Math.max(t,r,n),s=Math.min(t,r,n),l=A-s;if(l===0)return[0,0,t];var o=0,u=0,f=A+s;switch(u=l/(f>1?2-f:f),A){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,u,f/2]}function BK(e){var t=e[0],r=e[1],n=e[2],A=r*2*(n<.5?n:1-n),s=n-A/2,l=[s,s,s],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=A*o,l[0]+=A,l[1]+=u;break;case 1:u=A*(2-o),l[0]+=u,l[1]+=A;break;case 2:u=A*(o-2),l[1]+=A,l[2]+=u;break;case 3:u=A*(4-o),l[1]+=u,l[2]+=A;break;case 4:u=A*(o-4),l[2]+=A,l[0]+=u;break;case 5:u=A*(6-o),l[2]+=u,l[0]+=A;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function fd(e,t){if(t===0)return e;var r=yK(wK(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ou(BK(r))}var P4=6,CK=15,EK=1,Rn=P4;function cu(e){return Math.floor((e+Math.round(128/Rn)/256)*Rn)}function uu(e){return Math.floor((e-5)/Rn*100+.5)/100}function dd(e){return Math.round((e*Rn+5)/Rn*256)/256}function Nm(e){return dd(uu(cu(e)))}function Kx(e){var t=Math.abs(e-Nm(e)),r=Rn;if(t>.005)for(Rn=EK;Rn<CK;++Rn)Math.abs(e-Nm(e))<=t&&(t=Math.abs(e-Nm(e)),r=Rn);Rn=r}function Ws(e){e.width?(e.wpx=cu(e.width),e.wch=uu(e.wpx),e.MDW=Rn):e.wpx?(e.wch=uu(e.wpx),e.width=dd(e.wch),e.MDW=Rn):typeof e.wch=="number"&&(e.width=dd(e.wch),e.wpx=cu(e.width),e.MDW=Rn),e.customWidth&&delete e.customWidth}var TK=96,G4=TK;function fu(e){return e*96/G4}function co(e){return e*G4/96}var SK={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _K(e,t,r,n){t.Borders=[];var A={},s=!1;(e[0].match(On)||[]).forEach(function(l){var o=gt(l);switch(ya(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":A={},o.diagonalUp&&(A.diagonalUp=Tr(o.diagonalUp)),o.diagonalDown&&(A.diagonalDown=Tr(o.diagonalDown)),t.Borders.push(A);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function bK(e,t,r,n){t.Fills=[];var A={},s=!1;(e[0].match(On)||[]).forEach(function(l){var o=gt(l);switch(ya(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":A={},t.Fills.push(A);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(A),A={};break;case"<patternFill":case"<patternFill>":o.patternType&&(A.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":A.bgColor||(A.bgColor={}),o.indexed&&(A.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(A.bgColor.theme=parseInt(o.theme,10)),o.tint&&(A.bgColor.tint=parseFloat(o.tint)),o.rgb&&(A.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":A.fgColor||(A.fgColor={}),o.theme&&(A.fgColor.theme=parseInt(o.theme,10)),o.tint&&(A.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(A.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function FK(e,t,r,n){t.Fonts=[];var A={},s=!1;(e[0].match(On)||[]).forEach(function(l){var o=gt(l);switch(ya(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(A),A={};break;case"<name":o.val&&(A.name=pr(o.val));break;case"<name/>":case"</name>":break;case"<b":A.bold=o.val?Tr(o.val):1;break;case"<b/>":A.bold=1;break;case"<i":A.italic=o.val?Tr(o.val):1;break;case"<i/>":A.italic=1;break;case"<u":switch(o.val){case"none":A.underline=0;break;case"single":A.underline=1;break;case"double":A.underline=2;break;case"singleAccounting":A.underline=33;break;case"doubleAccounting":A.underline=34;break}break;case"<u/>":A.underline=1;break;case"<strike":A.strike=o.val?Tr(o.val):1;break;case"<strike/>":A.strike=1;break;case"<outline":A.outline=o.val?Tr(o.val):1;break;case"<outline/>":A.outline=1;break;case"<shadow":A.shadow=o.val?Tr(o.val):1;break;case"<shadow/>":A.shadow=1;break;case"<condense":A.condense=o.val?Tr(o.val):1;break;case"<condense/>":A.condense=1;break;case"<extend":A.extend=o.val?Tr(o.val):1;break;case"<extend/>":A.extend=1;break;case"<sz":o.val&&(A.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(A.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(A.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(A.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=xx[parseInt(o.val,10)];break;case"<color":if(A.color||(A.color={}),o.auto&&(A.color.auto=Tr(o.auto)),o.rgb)A.color.rgb=o.rgb.slice(-6);else if(o.indexed){A.color.index=parseInt(o.indexed,10);var u=Qi[A.color.index];A.color.index==81&&(u=Qi[1]),u||(u=Qi[1]),A.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(A.color.theme=parseInt(o.theme,10),o.tint&&(A.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(A.color.rgb=fd(r.themeElements.clrScheme[A.color.theme].rgb,A.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function UK(e,t,r){t.NumberFmt=[];for(var n=Hr(dt),A=0;A<n.length;++A)t.NumberFmt[n[A]]=dt[n[A]];var s=e[0].match(On);if(s)for(A=0;A<s.length;++A){var l=gt(s[A]);switch(ya(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Xt(pr(l.formatCode)),u=parseInt(l.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}qa(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function kK(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Pe("numFmt",null,{numFmtId:n,formatCode:ir(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var yf=["numFmtId","fillId","fontId","borderId","xfId"],Bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function NK(e,t,r){t.CellXf=[];var n,A=!1;(e[0].match(On)||[]).forEach(function(s){var l=gt(s),o=0;switch(ya(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<yf.length;++o)n[yf[o]]&&(n[yf[o]]=parseInt(n[yf[o]],10));for(o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=Tr(n[Bf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};l.vertical&&(u.vertical=l.vertical),l.horizontal&&(u.horizontal=l.horizontal),l.textRotation!=null&&(u.textRotation=l.textRotation),l.indent&&(u.indent=l.indent),l.wrapText&&(u.wrapText=Tr(l.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":A=!0;break;case"</AlternateContent>":A=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":A=!0;break;case"</ext>":A=!1;break;default:if(r&&r.WTF&&!A)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function IK(e){var t=[];return t[t.length]=Pe("cellXfs",null),e.forEach(function(r){t[t.length]=Pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var QK=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,A=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=o.match(t))&&UK(m,d,f),(m=o.match(A))&&FK(m,d,u,f),(m=o.match(n))&&bK(m,d,u,f),(m=o.match(s))&&_K(m,d,u,f),(m=o.match(r))&&NK(m,d,f),d}})();function V4(e,t){var r=[Xr,Pe("styleSheet",null,{xmlns:Xi[0],"xmlns:vt":an.vt})],n;return e.SSF&&(n=kK(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=IK(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function RK(e,t){var r=e.read_shift(2),n=Ln(e);return[r,n]}function DK(e,t,r){r||(r=_e(6+4*t.length)),r.write_shift(2,e),fn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function MK(e,t,r){var n={};n.sz=e.read_shift(2)/20;var A=x9(e);A.fItalic&&(n.italic=1),A.fCondense&&(n.condense=1),A.fExtend&&(n.extend=1),A.fShadow&&(n.shadow=1),A.fOutline&&(n.outline=1),A.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=p9(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ln(e),n}function LK(e,t){t||(t=_e(153)),t.write_shift(2,e.sz*20),v9(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),od(e.color,t);var n=0;return n=2,t.write_shift(1,n),fn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var HK=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Im,OK=Hn;function C2(e,t){t||(t=_e(84)),Im||(Im=Ld(HK));var r=Im[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(od({auto:1},t),od({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function PK(e,t){var r=e.l+t,n=e.read_shift(2),A=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:A}}function K4(e,t,r){r||(r=_e(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function yc(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var GK=Hn;function VK(e,t){return t||(t=_e(51)),t.write_shift(1,0),yc(null,t),yc(null,t),yc(null,t),yc(null,t),yc(null,t),t.length>t.l?t.slice(0,t.l):t}function KK(e,t){return t||(t=_e(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ld(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function jK(e,t,r){var n=_e(2052);return n.write_shift(4,e),ld(t,n),ld(r,n),n.length>n.l?n.slice(0,n.l):n}function zK(e,t,r){var n={};n.NumberFmt=[];for(var A in dt)n.NumberFmt[A]=dt[A];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return is(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],qa(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=fd(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(d),l=!0;break;case 38:s.pop(),l=!1;break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function XK(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var A=n[0];A<=n[1];++A)t[A]!=null&&++r}),r!=0&&(Qe(e,615,aa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var A=n[0];A<=n[1];++A)t[A]!=null&&Qe(e,44,DK(A,t[A]))}),Qe(e,616))}}function JK(e){var t=1;Qe(e,611,aa(t)),Qe(e,43,LK({sz:12,color:{theme:1},name:"Calibri",family:2})),Qe(e,612)}function YK(e){var t=2;Qe(e,603,aa(t)),Qe(e,45,C2({patternType:"none"})),Qe(e,45,C2({patternType:"gray125"})),Qe(e,604)}function WK(e){var t=1;Qe(e,613,aa(t)),Qe(e,46,VK()),Qe(e,614)}function qK(e){var t=1;Qe(e,626,aa(t)),Qe(e,47,K4({numFmtId:0},65535)),Qe(e,627)}function $K(e,t){Qe(e,617,aa(t.length)),t.forEach(function(r){Qe(e,47,K4(r,0))}),Qe(e,618)}function ZK(e){var t=1;Qe(e,619,aa(t)),Qe(e,48,KK({xfId:0,name:"Normal"})),Qe(e,620)}function ej(e){var t=0;Qe(e,505,aa(t)),Qe(e,506)}function tj(e){var t=0;Qe(e,508,jK(t,"TableStyleMedium9","PivotStyleMedium4")),Qe(e,509)}function rj(e,t){var r=aA();return Qe(r,278),XK(r,e.SSF),JK(r),YK(r),WK(r),qK(r),$K(r,t.cellXfs),ZK(r),ej(r),tj(r),Qe(r,279),r.end()}var nj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Aj(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(On)||[]).forEach(function(A){var s=gt(A);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[nj.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function aj(){}function sj(){}var ij=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function cj(e,t,r){t.themeElements={};var n;[["clrScheme",ij,Aj],["fontScheme",lj,aj],["fmtScheme",oj,sj]].forEach(function(A){if(!(n=e.match(A[1])))throw new Error(A[0]+" not found in themeElements");A[2](n,t,r)})}var uj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function j4(e,t){(!e||e.length===0)&&(e=jx());var r,n={};if(!(r=e.match(uj)))throw new Error("themeElements not found in theme");return cj(r[0],n,t),n.raw=e,n}function jx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Xr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fj(e,t,r){var n=e.l+t,A=e.read_shift(4);if(A!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=M_(s,{type:"array"})}catch{return}var o=xA(l,"theme/theme/theme1.xml",!0);if(o)return j4(o,r)}}function dj(e){return e.read_shift(4)}function hj(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=gj(e,4);break;case 2:t.xclrValue=E4(e);break;case 3:t.xclrValue=dj(e);break;case 4:e.l+=4;break}return e.l+=8,t}function gj(e,t){return Hn(e,t)}function mj(e,t){return Hn(e,t)}function pj(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=hj(e);break;case 6:n[1]=mj(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function xj(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var A=e.read_shift(2),s=[];A-- >0;)s.push(pj(e,r-e.l));return{ixfe:n,ext:s}}function vj(e,t){t.forEach(function(r){r[0]})}function wj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ln(e)}}function yj(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),fn(e.name,t),t.slice(0,t.l)}function Bj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Cj(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Ej(e,t){var r=_e(8+2*t.length);return r.write_shift(4,e),fn(t,r),r.slice(0,r.l)}function Tj(e){return e.l+=4,e.read_shift(4)!=0}function Sj(e,t){var r=_e(8);return r.write_shift(4,e),r.write_shift(4,1),r}function _j(e,t,r){var n={Types:[],Cell:[],Value:[]},A=r||{},s=[],l=!1,o=2;return is(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){o==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):o==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:s.push(d),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!f.T){if(!l||A.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function bj(){var e=aA();return Qe(e,332),Qe(e,334,aa(1)),Qe(e,335,yj({name:"XLDAPR",version:12e4,flags:3496657072})),Qe(e,336),Qe(e,339,Ej(1,"XLDAPR")),Qe(e,52),Qe(e,35,aa(514)),Qe(e,4096,aa(0)),Qe(e,4097,HA(1)),Qe(e,36),Qe(e,53),Qe(e,340),Qe(e,337,Sj(1)),Qe(e,51,Cj([[1,0]])),Qe(e,338),Qe(e,333),e.end()}function Fj(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var A=!1,s=2,l;return e.replace(On,function(o){var u=gt(o);switch(ya(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(l=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":A=!0;break;case"</ext>":A=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+u.i);break;default:if(!A&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function z4(){var e=[Xr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Uj(e){var t=[];if(!e)return t;var r=1;return(e.match(On)||[]).forEach(function(n){var A=gt(n);switch(A[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete A[0],A.i?r=A.i:A.i=r,t.push(A);break}}),t}function kj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ht(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Nj(e,t,r){var n=[];return is(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Ij(e,t,r,n){if(!e)return e;var A=n||{},s=!1;is(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||A.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},A)}function Qj(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Zl=1024;function X4(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),A=[Pe("xml",null,{"xmlns:v":gA.v,"xmlns:o":gA.o,"xmlns:x":gA.x,"xmlns:mv":gA.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zl<e*1e3;)Zl+=1e3;return t.forEach(function(s){var l=Qr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Pe("v:fill",u,o),d={on:"t",obscured:"t"};++Zl,A=A.concat(["<v:shape"+su({id:"_x0000_s"+Zl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Pe("v:shadow",null,d),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Cn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Cn("x:AutoFill","False"),Cn("x:Row",String(l.r)),Cn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),A.push("</xml>"),A.join("")}function E2(e,t,r,n){var A=Array.isArray(e),s;t.forEach(function(l){var o=Qr(l.ref);if(A?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},A?e[o.r][o.c]=s:e[l.ref]=s;var u=Jt(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=St(u);f!==e["!ref"]&&(e["!ref"]=f)}s.c||(s.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var m=s.c.length-1;m>=0;--m){if(!r&&s.c[m].T)return;r&&!s.c[m].T&&s.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(d.a==n[m].id){d.a=n[m].name||d.a;break}}s.c.push(d)})}function Rj(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],A=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);A&&A[1]&&A[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=gt(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Qr(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!m&&!!m[1]&&Gx(m[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),n.push(f)}}}}),n}function J4(e){var t=[Xr,Pe("comments",null,{xmlns:Xi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(A){var s=ir(A.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),A.T&&A.ID&&r.indexOf("tc="+A.ID)==-1&&(r.push("tc="+A.ID),t.push("<author>tc="+A.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var A=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?A=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(A=r.indexOf(ir(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+A+'"><text>'),s.length<=1)t.push(Cn("t",ir(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(Cn("t",ir(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Dj(e,t){var r=[],n=!1,A={},s=0;return e.replace(On,function(o,u){var f=gt(o);switch(ya(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":A={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":A.t!=null&&r.push(A);break;case"<text>":case"<text":s=u+o.length;break;case"</text>":A.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function Mj(e,t,r){var n=[Xr,Pe("ThreadedComments",null,{xmlns:an.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(A){var s="";(A[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var u={ref:A[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=u.id:u.parentId=s,l.ID=u.id,l.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Pe("threadedComment",Cn("text",l.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function Lj(e,t){var r=[],n=!1;return e.replace(On,function(s){var l=gt(s);switch(ya(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function Hj(e){var t=[Xr,Pe("personList",null,{xmlns:an.TCMNT,"xmlns:x":Xi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Oj(e){var t={};t.iauthor=e.read_shift(4);var r=qi(e);return t.rfx=r.s,t.ref=ht(r.s),e.l+=16,t}function Pj(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),Bo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Gj=Ln;function Vj(e){return fn(e.slice(0,54))}function Kj(e,t){var r=[],n=[],A={},s=!1;return is(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:A=o;break;case 637:A.t=o.t,A.h=o.h,A.r=o.r;break;case 636:if(A.author=n[A.iauthor],delete A.iauthor,t.sheetRows&&A.rfx&&t.sheetRows<=A.rfx.r)break;A.t||(A.t=""),delete A.rfx,r.push(A);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function jj(e){var t=aA(),r=[];return Qe(t,628),Qe(t,630),e.forEach(function(n){n[1].forEach(function(A){r.indexOf(A.a)>-1||(r.push(A.a.slice(0,54)),Qe(t,632,Vj(A.a)))})}),Qe(t,631),Qe(t,633),e.forEach(function(n){n[1].forEach(function(A){A.iauthor=r.indexOf(A.a);var s={s:Qr(n[0]),e:Qr(n[0])};Qe(t,635,Pj([s,A])),A.t&&A.t.length>0&&Qe(t,637,d9(A)),Qe(t,636),delete A.iauthor})}),Qe(t,634),Qe(t,629),t.end()}var zj="application/vnd.ms-office.vbaProject";function Xj(e){var t=lt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var A=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lt.utils.cfb_add(t,A,e.FileIndex[n].content)}}),lt.write(t)}function Jj(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var A=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");A.slice(-1)!=="/"&&lt.utils.cfb_add(e,A,t.FileIndex[n].content)}})}var Y4=["xlsb","xlsm","xlam","biff8","xla"];function Yj(){return{"!type":"dialog"}}function Wj(){return{"!type":"dialog"}}function qj(){return{"!type":"macro"}}function $j(){return{"!type":"macro"}}var ao=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,A,s,l){var o=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,A+(o?"":"$")+Ir(d)+(u?"":"$")+zr(f)}return function(A,s){return t=s,A.replace(e,r)}})(),zx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xx=(function(){return function(t,r){return t.replace(zx,function(n,A,s,l,o,u){var f=Ix(l)-(s?0:r.c),d=Nx(u)-(o?0:r.r),m=d==0?"":o?d+1:"["+d+"]",x=f==0?"":s?f+1:"["+f+"]";return A+"R"+m+"C"+x})}})();function W4(e,t){return e.replace(zx,function(r,n,A,s,l,o){return n+(A=="$"?A+s:Ir(Ix(s)+t.c))+(l=="$"?l+o:zr(Nx(o)+t.r))})}function Zj(e,t,r){var n=sA(t),A=n.s,s=Qr(r),l={r:s.r-A.r,c:s.c-A.c};return W4(e,l)}function ez(e){return e.length!=1}function T2(e){return e.replace(/_xlfn\./g,"")}function $r(e){e.l+=1}function qs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function q4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $4(e);r.biff==12&&(n=4)}var A=e.read_shift(n),s=e.read_shift(n),l=qs(e),o=qs(e);return{s:{r:A,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function $4(e){var t=qs(e),r=qs(e),n=e.read_shift(1),A=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:A,cRel:r[1],rRel:r[2]}}}function tz(e,t,r){if(r.biff<8)return $4(e);var n=e.read_shift(r.biff==12?4:2),A=e.read_shift(r.biff==12?4:2),s=qs(e),l=qs(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:A,c:l[0],cRel:l[1],rRel:l[2]}}}function Z4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return rz(e);var n=e.read_shift(r&&r.biff==12?4:2),A=qs(e);return{r:n,c:A[0],cRel:A[1],rRel:A[2]}}function rz(e){var t=qs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function nz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Az(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return az(e);var A=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;A>524287;)A-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:A,c:s,cRel:l,rRel:o}}function az(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,A=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),A==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:A,rRel:n}}function sz(e,t,r){var n=(e[e.l++]&96)>>5,A=q4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,A]}function iz(e,t,r){var n=(e[e.l++]&96)>>5,A=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=q4(e,s,r);return[n,A,l]}function lz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function oz(e,t,r){var n=(e[e.l++]&96)>>5,A=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,A]}function cz(e,t,r){var n=(e[e.l++]&96)>>5,A=tz(e,t-1,r);return[n,A]}function uz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function S2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function fz(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),A=[],s=0;s<=n;++s)A.push(e.read_shift(r&&r.biff==2?1:2));return A}function dz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function gz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function mz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function eb(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function pz(e){return e.read_shift(2),eb(e)}function xz(e){return e.read_shift(2),eb(e)}function vz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var A=Z4(e,0,r);return[n,A]}function wz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var A=Az(e,0,r);return[n,A]}function yz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var A=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Z4(e,0,r);return[n,A,s]}function Bz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var A=e.read_shift(r&&r.biff<=3?1:2);return[TX[A],nb[A],n]}function Cz(e,t,r){var n=e[e.l++],A=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Ez(e);return[A,(s[0]===0?nb:EX)[s[1]]]}function Ez(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Tz(e,t,r){e.l+=r&&r.biff==2?3:4}function Sz(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),A=e.read_shift(r&&r.biff==2?1:2);return[n,A]}function _z(e){return e.l++,ls[e.read_shift(1)]}function bz(e){return e.l++,e.read_shift(2)}function Fz(e){return e.l++,e.read_shift(1)!==0}function Uz(e){return e.l++,Dn(e)}function kz(e,t,r){return e.l++,Bu(e,t-1,r)}function Nz(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ls[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dn(e);break;case 2:r[1]=$i(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Iz(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),A=[],s=0;s!=n;++s)A.push((r.biff==12?qi:Pd)(e));return A}function Qz(e,t,r){var n=0,A=0;r.biff==12?(n=e.read_shift(4),A=e.read_shift(4)):(A=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--A==0&&(A=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=A;++o)l[s][o]=Nz(e,r.biff);return l}function Rz(e,t,r){var n=e.read_shift(1)>>>5&3,A=!r||r.biff>=8?4:2,s=e.read_shift(A);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Dz(e,t,r){if(r.biff==5)return Mz(e);var n=e.read_shift(1)>>>5&3,A=e.read_shift(2),s=e.read_shift(4);return[n,A,s]}function Mz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Lz(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var A=e.read_shift(r&&r.biff==2?1:2);return[n,A]}function Hz(e,t,r){var n=e.read_shift(1)>>>5&3,A=e.read_shift(r&&r.biff==2?1:2);return[n,A]}function Oz(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Pz(e,t,r){var n=(e[e.l++]&96)>>5,A=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,A]}var Gz=Hn,Vz=Hn,Kz=Hn;function Eu(e,t,r){return e.l+=2,[nz(e)]}function Jx(e){return e.l+=6,[]}var jz=Eu,zz=Jx,Xz=Jx,Jz=Eu;function tb(e){return e.l+=2,[en(e),e.read_shift(2)&1]}var Yz=Eu,Wz=tb,qz=Jx,$z=Eu,Zz=Eu,eX=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),A=e.read_shift(2),s=e.read_shift(2),l=eX[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:A,C:s}}function rX(e){return e.l+=2,[e.read_shift(4)]}function nX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function AX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function aX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function iX(e){return e.l+=4,[0,0]}var _2={1:{n:"PtgExp",f:Sz},2:{n:"PtgTbl",f:Kz},3:{n:"PtgAdd",f:$r},4:{n:"PtgSub",f:$r},5:{n:"PtgMul",f:$r},6:{n:"PtgDiv",f:$r},7:{n:"PtgPower",f:$r},8:{n:"PtgConcat",f:$r},9:{n:"PtgLt",f:$r},10:{n:"PtgLe",f:$r},11:{n:"PtgEq",f:$r},12:{n:"PtgGe",f:$r},13:{n:"PtgGt",f:$r},14:{n:"PtgNe",f:$r},15:{n:"PtgIsect",f:$r},16:{n:"PtgUnion",f:$r},17:{n:"PtgRange",f:$r},18:{n:"PtgUplus",f:$r},19:{n:"PtgUminus",f:$r},20:{n:"PtgPercent",f:$r},21:{n:"PtgParen",f:$r},22:{n:"PtgMissArg",f:$r},23:{n:"PtgStr",f:kz},26:{n:"PtgSheet",f:nX},27:{n:"PtgEndSheet",f:AX},28:{n:"PtgErr",f:_z},29:{n:"PtgBool",f:Fz},30:{n:"PtgInt",f:bz},31:{n:"PtgNum",f:Uz},32:{n:"PtgArray",f:uz},33:{n:"PtgFunc",f:Bz},34:{n:"PtgFuncVar",f:Cz},35:{n:"PtgName",f:Rz},36:{n:"PtgRef",f:vz},37:{n:"PtgArea",f:sz},38:{n:"PtgMemArea",f:Lz},39:{n:"PtgMemErr",f:Gz},40:{n:"PtgMemNoMem",f:Vz},41:{n:"PtgMemFunc",f:Hz},42:{n:"PtgRefErr",f:Oz},43:{n:"PtgAreaErr",f:lz},44:{n:"PtgRefN",f:wz},45:{n:"PtgAreaN",f:cz},46:{n:"PtgMemAreaN",f:aX},47:{n:"PtgMemNoMemN",f:sX},57:{n:"PtgNameX",f:Dz},58:{n:"PtgRef3d",f:yz},59:{n:"PtgArea3d",f:iz},60:{n:"PtgRefErr3d",f:Pz},61:{n:"PtgAreaErr3d",f:oz},255:{}},lX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oX={1:{n:"PtgElfLel",f:tb},2:{n:"PtgElfRw",f:$z},3:{n:"PtgElfCol",f:jz},6:{n:"PtgElfRwV",f:Zz},7:{n:"PtgElfColV",f:Jz},10:{n:"PtgElfRadical",f:Yz},11:{n:"PtgElfRadicalS",f:qz},13:{n:"PtgElfColS",f:zz},15:{n:"PtgElfColSV",f:Xz},16:{n:"PtgElfRadicalLel",f:Wz},25:{n:"PtgList",f:tX},29:{n:"PtgSxName",f:rX},255:{}},cX={0:{n:"PtgAttrNoop",f:iX},1:{n:"PtgAttrSemi",f:mz},2:{n:"PtgAttrIf",f:hz},4:{n:"PtgAttrChoose",f:fz},8:{n:"PtgAttrGoto",f:dz},16:{n:"PtgAttrSum",f:Tz},32:{n:"PtgAttrBaxcel",f:S2},33:{n:"PtgAttrBaxcel",f:S2},64:{n:"PtgAttrSpace",f:pz},65:{n:"PtgAttrSpaceSemi",f:xz},128:{n:"PtgAttrIfError",f:gz},255:{}};function Tu(e,t,r,n){if(n.biff<8)return Hn(e,t);for(var A=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=Qz(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=Iz(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=A-e.l,t!==0&&s.push(Hn(e,t)),s}function Su(e,t,r){for(var n=e.l+t,A,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],A=_2[s]||_2[lX[s]],(s===24||s===25)&&(A=(s===24?oX:cX)[e[e.l+1]]),!A||!A.f?Hn(e,t):l.push([A.n,A.f(e,t,r)]);return l}function uX(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],A=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:A.push('"'+l[1].replace(/"/g,'""')+'"');break;default:A.push(l[1])}else A.push("")}t.push(A.join(","))}return t.join(";")}var fX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function rb(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var A="";if(r.biff>8)switch(e[n[0]][0]){case 357:return A=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?A:A+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return A=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?A:A+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(A=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?A:A+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function b2(e,t,r){var n=rb(e,t,r);return n=="#REF"?n:dX(n,r)}function Qn(e,t,r,n,A){var s=A&&A.biff||8,l={s:{c:0,r:0}},o=[],u,f,d,m=0,x=0,y,C="";if(!e[0]||!e[0][0])return"";for(var E=-1,T="",_=0,F=e[0].length;_<F;++_){var S=e[0][_];switch(S[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),E>=0){switch(e[0][E][1][0]){case 0:T=Mr(" ",e[0][E][1][1]);break;case 1:T=Mr("\r",e[0][E][1][1]);break;default:if(T="",A.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}f=f+T,E=-1}o.push(f+fX[S[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Vc(S[1][1],l,A),o.push(Kc(d,s));break;case"PtgRefN":d=r?Vc(S[1][1],r,A):S[1][1],o.push(Kc(d,s));break;case"PtgRef3d":m=S[1][1],d=Vc(S[1][2],l,A),C=b2(n,m,A),o.push(C+"!"+Kc(d,s));break;case"PtgFunc":case"PtgFuncVar":var I=S[1][0],M=S[1][1];I||(I=0),I&=127;var Q=I==0?[]:o.slice(-I);o.length-=I,M==="User"&&(M=Q.shift()),o.push(M+"("+Q.join(",")+")");break;case"PtgBool":o.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(S[1]);break;case"PtgNum":o.push(String(S[1]));break;case"PtgStr":o.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(S[1]);break;case"PtgAreaN":y=n2(S[1][1],r?{s:r}:l,A),o.push(Fm(y,A));break;case"PtgArea":y=n2(S[1][1],l,A),o.push(Fm(y,A));break;case"PtgArea3d":m=S[1][1],y=S[1][2],C=b2(n,m,A),o.push(C+"!"+Fm(y,A));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var U=(n.names||[])[x-1]||(n[0]||[])[x],G=U?U.Name:"SH33TJSNAME"+String(x);G&&G.slice(0,6)=="_xlfn."&&!A.xlfn&&(G=G.slice(6)),o.push(G);break;case"PtgNameX":var R=S[1][1];x=S[1][2];var te;if(A.biff<=5)R<0&&(R=-R),n[R]&&(te=n[R][x]);else{var ne="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][x]&&n[R][x].itab>0&&(ne=n.SheetNames[n[R][x].itab-1]+"!"):ne=n.SheetNames[x-1]+"!"),n[R]&&n[R][x])ne+=n[R][x].Name;else if(n[0]&&n[0][x])ne+=n[0][x].Name;else{var ee=(rb(n,R,A)||"").split(";;");ee[x-1]?ne=ee[x-1]:ne+="SH33TJSERRX"}o.push(ne);break}te||(te={Name:"SH33TJSERRY"}),o.push(te.Name);break;case"PtgParen":var ae="(",Se=")";if(E>=0){switch(T="",e[0][E][1][0]){case 2:ae=Mr(" ",e[0][E][1][1])+ae;break;case 3:ae=Mr("\r",e[0][E][1][1])+ae;break;case 4:Se=Mr(" ",e[0][E][1][1])+Se;break;case 5:Se=Mr("\r",e[0][E][1][1])+Se;break;default:if(A.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}E=-1}o.push(ae+o.pop()+Se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:S[1][1],r:S[1][0]};var Te={c:r.c,r:r.r};if(n.sharedf[ht(d)]){var q=n.sharedf[ht(d)];o.push(Qn(q,l,Te,n,A))}else{var oe=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(Qn(f[1],l,Te,n,A)),oe=!0;break}oe||o.push(S[1])}break;case"PtgArray":o.push("{"+uX(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(A.biff!=3&&E>=0&&Re.indexOf(e[0][_][0])==-1){S=e[0][E];var ie=!0;switch(S[1][0]){case 4:ie=!1;case 0:T=Mr(" ",S[1][1]);break;case 5:ie=!1;case 1:T=Mr("\r",S[1][1]);break;default:if(T="",A.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}o.push((ie?T:"")+o.pop()+(ie?"":T)),E=-1}}if(o.length>1&&A.WTF)throw new Error("bad formula stack");return o[0]}function hX(e,t,r){var n=e.l+t,A=r.biff==2?1:2,s,l=e.read_shift(A);if(l==65535)return[[],Hn(e,t-2)];var o=Su(e,l,r);return t!==l+A&&(s=Tu(e,t-l-A,o,r)),e.l=n,[o,s]}function gX(e,t,r){var n=e.l+t,A=r.biff==2?1:2,s,l=e.read_shift(A);if(l==65535)return[[],Hn(e,t-2)];var o=Su(e,l,r);return t!==l+A&&(s=Tu(e,t-l-A,o,r)),e.l=n,[o,s]}function mX(e,t,r,n){var A=e.l+t,s=Su(e,n,r),l;return A!==e.l&&(l=Tu(e,A-e.l,s,r)),[s,l]}function pX(e,t,r){var n=e.l+t,A,s=e.read_shift(2),l=Su(e,s,r);return s==65535?[[],Hn(e,t-2)]:(t!==s+2&&(A=Tu(e,n-s-2,l,r)),[l,A])}function xX(e){var t;if(Xa(e,e.l+6)!==65535)return[Dn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function vX(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Oi(e);return Oi(0)}function Qm(e,t,r){var n=e.l+t,A=Ba(e);r.biff==2&&++e.l;var s=xX(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=gX(e,n-e.l,r);return{cell:A,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function wX(e,t,r,n,A){var s=Gi(t,r,A),l=vX(e.v),o=_e(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var f=_e(e.bf.length),d=0;d<e.bf.length;++d)f[d]=e.bf[d];var m=un([s,l,o,f]);return m}function Gd(e,t,r){var n=e.read_shift(4),A=Su(e,n,r),s=e.read_shift(4),l=s>0?Tu(e,s,A,r):null;return[A,l]}var yX=Gd,Vd=Gd,BX=Gd,CX=Gd,EX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},nb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TX={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function F2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function SX(e){var t="of:="+e.replace(zx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Rm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function _X(e){return e.replace(/\./,"!")}var zc={},so={},Xc=typeof Map<"u";function Yx(e,t,r){var n=0,A=e.length;if(r){if(Xc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Xc?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<A;++n)if(e[n].t===t)return e.Count++,n;return e[A]={t},e.Count++,e.Unique++,r&&(Xc?(r.has(t)||r.set(t,[]),r.get(t).push(A)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(A))),A}function Kd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Rn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=uu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=dd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Mi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ri(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],A=60,s=e.length;if(n==null&&r.ssf){for(;A<392;++A)if(r.ssf[A]==null){qa(t.z,A),r.ssf[A]=t.z,r.revssf[t.z]=n=A;break}}for(A=0;A!=s;++A)if(e[A].numFmtId===n)return A;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Ab(e,t,r,n,A,s){try{n.cellNF&&(e.z=dt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Sr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(dt[t]==null&&qa(E7[t]||"General",t),e.t==="e")e.w=e.w||ls[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v);else if(e.t==="d"){var l=sn(e.v);(l|0)===l?e.w=l.toString(10):e.w=Au(l)}else{if(e.v===void 0)return"";e.w=Li(e.v,so)}else e.t==="d"?e.w=zA(t,sn(e.v),so):e.w=zA(t,e.v,so)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fd(A.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=A.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fd(A.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=A.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function bX(e,t,r){if(e&&e["!ref"]){var n=Jt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function FX(e,t){var r=Jt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=St(r))}var UX=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,kX=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,NX=/<(?:\w:)?hyperlink [^>]*>/mg,IX=/"(\w*:\w*)"/,QX=/<(?:\w:)?col\b[^>]*[\/]?>/g,RX=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DX=/<(?:\w:)?pageMargins[^>]*\/>/g,ab=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,MX=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,LX=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function HX(e,t,r,n,A,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",m=e.match(kX);m?(f=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):f=d=e;var x=f.match(ab);x?Wx(x[0],o,A,r):(x=f.match(MX))&&PX(x[0],x[1]||"",o,A,r);var y=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var C=f.slice(y,y+50).match(IX);C&&FX(o,C[1])}var E=f.match(LX);E&&E[1]&&eJ(E[1],A);var T=[];if(t.cellStyles){var _=f.match(QX);_&&YX(T,_)}m&&nJ(m[1],o,t,u,s,l);var F=d.match(RX);F&&(o["!autofilter"]=qX(F[0]));var S=[],I=d.match(UX);if(I)for(y=0;y!=I.length;++y)S[y]=Jt(I[y].slice(I[y].indexOf('"')+1));var M=d.match(NX);M&&zX(o,M,n);var Q=d.match(DX);if(Q&&(o["!margins"]=XX(gt(Q[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=St(u)),t.sheetRows>0&&o["!ref"]){var U=Jt(o["!ref"]);t.sheetRows<=+U.e.r&&(U.e.r=t.sheetRows-1,U.e.r>u.e.r&&(U.e.r=u.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>u.e.c&&(U.e.c=u.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),o["!fullref"]=o["!ref"],o["!ref"]=St(U))}return T.length>0&&(o["!cols"]=T),S.length>0&&(o["!merges"]=S),o}function OX(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+St(e[r])+'"/>';return t+"</mergeCells>"}function Wx(e,t,r,n){var A=gt(e);r.Sheets[n]||(r.Sheets[n]={}),A.codeName&&(r.Sheets[n].CodeName=Xt(pr(A.codeName)))}function PX(e,t,r,n,A){Wx(e.slice(0,e.indexOf(">")),r,n,A)}function GX(e,t,r,n,A){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,l.codeName=pa(ir(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),o=(o||"")+Pe("outlinePr",null,f)}!s&&!o||(A[A.length]=Pe("sheetPr",o,l))}var VX=["objects","scenarios","selectLockedCells","selectUnlockedCells"],KX=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jX(e){var t={sheet:1};return VX.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),KX.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Vx(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,t)}function zX(e,t,r){for(var n=Array.isArray(e),A=0;A!=t.length;++A){var s=gt(pr(t[A]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Xt(s.location))):(s.Target="#"+Xt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Jt(s.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=ht({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function XX(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function JX(e){return Mi(e),Pe("pageMargins",null,e)}function YX(e,t){for(var r=!1,n=0;n!=t.length;++n){var A=gt(t[n],!0);A.hidden&&(A.hidden=Tr(A.hidden));var s=parseInt(A.min,10)-1,l=parseInt(A.max,10)-1;for(A.outlineLevel&&(A.level=+A.outlineLevel||0),delete A.min,delete A.max,A.width=+A.width,!r&&A.width&&(r=!0,Kx(A.width)),Ws(A);s<=l;)e[s++]=_r(A)}}function WX(e,t){for(var r=["<cols>"],n,A=0;A!=t.length;++A)(n=t[A])&&(r[r.length]=Pe("col",null,Kd(A,n)));return r[r.length]="</cols>",r.join("")}function qX(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function $X(e,t,r,n){var A=typeof e.ref=="string"?e.ref:St(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=sA(A);l.s.r==l.e.r&&(l.e.r=sA(t["!ref"]).e.r,A=St(l));for(var o=0;o<s.length;++o){var u=s[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+A;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+A}),Pe("autoFilter",null,{ref:A})}var ZX=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function eJ(e,t){t.Views||(t.Views=[{}]),(e.match(ZX)||[]).forEach(function(r,n){var A=gt(r);t.Views[n]||(t.Views[n]={}),+A.zoomScale&&(t.Views[n].zoom=+A.zoomScale),Tr(A.rightToLeft)&&(t.Views[n].RTL=!0)})}function tJ(e,t,r,n){var A={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(A.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,A),{})}function rJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var A="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":A=e.v?"1":"0";break;case"n":A=""+e.v;break;case"e":A=ls[e.v];break;case"d":n&&n.cellDates?A=Sr(e.v,-1).toISOString():(e=_r(e),e.t="n",A=""+(e.v=sn(Sr(e.v)))),typeof e.z>"u"&&(e.z=dt[14]);break;default:A=e.v;break}var o=Cn("v",ir(A)),u={r:t},f=ri(n.cellXfs,e,n);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Cn("v",""+Yx(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Pe("f",ir(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Pe("c",o,u)}var nJ=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,A=/ref=["']([^"']*)["']/,s=au("v"),l=au("f");return function(u,f,d,m,x,y){for(var C=0,E="",T=[],_=[],F=0,S=0,I=0,M="",Q,U,G=0,R=0,te,ne,ee=0,ae=0,Se=Array.isArray(y.CellXf),Te,q=[],oe=[],Re=Array.isArray(f),ie=[],Me={},X=!1,k=!!d.sheetStubs,K=u.split(t),P=0,z=K.length;P!=z;++P){E=K[P].trim();var Z=E.length;if(Z!==0){var le=0;e:for(C=0;C<Z;++C)switch(E[C]){case">":if(E[C-1]!="/"){++C;break e}if(d&&d.cellStyles){if(U=gt(E.slice(le,C),!0),G=U.r!=null?parseInt(U.r,10):G+1,R=-1,d.sheetRows&&d.sheetRows<G)continue;Me={},X=!1,U.ht&&(X=!0,Me.hpt=parseFloat(U.ht),Me.hpx=co(Me.hpt)),U.hidden=="1"&&(X=!0,Me.hidden=!0),U.outlineLevel!=null&&(X=!0,Me.level=+U.outlineLevel),X&&(ie[G-1]=Me)}break;case"<":le=C;break}if(le>=C)break;if(U=gt(E.slice(le,C),!0),G=U.r!=null?parseInt(U.r,10):G+1,R=-1,!(d.sheetRows&&d.sheetRows<G)){m.s.r>G-1&&(m.s.r=G-1),m.e.r<G-1&&(m.e.r=G-1),d&&d.cellStyles&&(Me={},X=!1,U.ht&&(X=!0,Me.hpt=parseFloat(U.ht),Me.hpx=co(Me.hpt)),U.hidden=="1"&&(X=!0,Me.hidden=!0),U.outlineLevel!=null&&(X=!0,Me.level=+U.outlineLevel),X&&(ie[G-1]=Me)),T=E.slice(C).split(e);for(var Ce=0;Ce!=T.length&&T[Ce].trim().charAt(0)=="<";++Ce);for(T=T.slice(Ce),C=0;C!=T.length;++C)if(E=T[C].trim(),E.length!==0){if(_=E.match(r),F=C,S=0,I=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,_!=null&&_.length===2){for(F=0,M=_[1],S=0;S!=M.length&&!((I=M.charCodeAt(S)-64)<1||I>26);++S)F=26*F+I;--F,R=F}else++R;for(S=0;S!=E.length&&E.charCodeAt(S)!==62;++S);if(++S,U=gt(E.slice(0,S),!0),U.r||(U.r=ht({r:G-1,c:R})),M=E.slice(S),Q={t:""},(_=M.match(s))!=null&&_[1]!==""&&(Q.v=Xt(_[1])),d.cellFormula){if((_=M.match(l))!=null&&_[1]!==""){if(Q.f=Xt(pr(_[1])).replace(/\r\n/g,`
`),d.xlfn||(Q.f=T2(Q.f)),_[0].indexOf('t="array"')>-1)Q.F=(M.match(A)||[])[1],Q.F.indexOf(":")>-1&&q.push([Jt(Q.F),Q.F]);else if(_[0].indexOf('t="shared"')>-1){ne=gt(_[0]);var he=Xt(pr(_[1]));d.xlfn||(he=T2(he)),oe[parseInt(ne.si,10)]=[ne,he,U.r]}}else(_=M.match(/<f[^>]*\/>/))&&(ne=gt(_[0]),oe[ne.si]&&(Q.f=Zj(oe[ne.si][1],oe[ne.si][2],U.r)));var Ae=Qr(U.r);for(S=0;S<q.length;++S)Ae.r>=q[S][0].s.r&&Ae.r<=q[S][0].e.r&&Ae.c>=q[S][0].s.c&&Ae.c<=q[S][0].e.c&&(Q.F=q[S][1])}if(U.t==null&&Q.v===void 0)if(Q.f||Q.F)Q.v=0,Q.t="n";else if(k)Q.t="z";else continue;else Q.t=U.t||"n";switch(m.s.c>R&&(m.s.c=R),m.e.c<R&&(m.e.c=R),Q.t){case"n":if(Q.v==""||Q.v==null){if(!k)continue;Q.t="z"}else Q.v=parseFloat(Q.v);break;case"s":if(typeof Q.v>"u"){if(!k)continue;Q.t="z"}else te=zc[parseInt(Q.v,10)],Q.v=te.t,Q.r=te.r,d.cellHTML&&(Q.h=te.h);break;case"str":Q.t="s",Q.v=Q.v!=null?pr(Q.v):"",d.cellHTML&&(Q.h=bx(Q.v));break;case"inlineStr":_=M.match(n),Q.t="s",_!=null&&(te=Gx(_[1]))?(Q.v=te.t,d.cellHTML&&(Q.h=te.h)):Q.v="";break;case"b":Q.v=Tr(Q.v);break;case"d":d.cellDates?Q.v=Sr(Q.v,1):(Q.v=sn(Sr(Q.v,1)),Q.t="n");break;case"e":(!d||d.cellText!==!1)&&(Q.w=Q.v),Q.v=i4[Q.v];break}if(ee=ae=0,Te=null,Se&&U.s!==void 0&&(Te=y.CellXf[U.s],Te!=null&&(Te.numFmtId!=null&&(ee=Te.numFmtId),d.cellStyles&&Te.fillId!=null&&(ae=Te.fillId))),Ab(Q,ee,ae,d,x,y),d.cellDates&&Se&&Q.t=="n"&&vo(dt[ee])&&(Q.t="d",Q.v=Od(Q.v)),U.cm&&d.xlmeta){var ce=(d.xlmeta.Cell||[])[+U.cm-1];ce&&ce.type=="XLDAPR"&&(Q.D=!0)}if(Re){var L=Qr(U.r);f[L.r]||(f[L.r]=[]),f[L.r][L.c]=Q}else f[U.r]=Q}}}}ie.length>0&&(f["!rows"]=ie)}})();function AJ(e,t,r,n){var A=[],s=[],l=Jt(e["!ref"]),o="",u,f="",d=[],m=0,x=0,y=e["!rows"],C=Array.isArray(e),E={r:f},T,_=-1;for(x=l.s.c;x<=l.e.c;++x)d[x]=Ir(x);for(m=l.s.r;m<=l.e.r;++m){for(s=[],f=zr(m),x=l.s.c;x<=l.e.c;++x){u=d[x]+f;var F=C?(e[m]||[])[x]:e[u];F!==void 0&&(o=rJ(F,u,e,t))!=null&&s.push(o)}(s.length>0||y&&y[m])&&(E={r:f},y&&y[m]&&(T=y[m],T.hidden&&(E.hidden=1),_=-1,T.hpx?_=fu(T.hpx):T.hpt&&(_=T.hpt),_>-1&&(E.ht=_,E.customHeight=1),T.level&&(E.outlineLevel=T.level)),A[A.length]=Pe("row",s.join(""),E))}if(y)for(;m<y.length;++m)y&&y[m]&&(E={r:m+1},T=y[m],T.hidden&&(E.hidden=1),_=-1,T.hpx?_=fu(T.hpx):T.hpt&&(_=T.hpt),_>-1&&(E.ht=_,E.customHeight=1),T.level&&(E.outlineLevel=T.level),A[A.length]=Pe("row","",E));return A.join("")}function sb(e,t,r,n){var A=[Xr,Pe("worksheet",null,{xmlns:Xi[0],"xmlns:r":an.r})],s=r.SheetNames[e],l=0,o="",u=r.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",d=Jt(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=St(d)}n||(n={}),u["!comments"]=[];var m=[];GX(u,r,e,t,A),A[A.length]=Pe("dimension",null,{ref:f}),A[A.length]=tJ(u,t,e,r),t.sheetFormat&&(A[A.length]=Pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(A[A.length]=WX(u,u["!cols"])),A[l=A.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=AJ(u,t),o.length>0&&(A[A.length]=o)),A.length>l+1&&(A[A.length]="</sheetData>",A[l]=A[l].replace("/>",">")),u["!protect"]&&(A[A.length]=jX(u["!protect"])),u["!autofilter"]!=null&&(A[A.length]=$X(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(A[A.length]=OX(u["!merges"]));var x=-1,y,C=-1;return u["!links"].length>0&&(A[A.length]="<hyperlinks>",u["!links"].forEach(function(E){E[1].Target&&(y={ref:E[0]},E[1].Target.charAt(0)!="#"&&(C=sr(n,-1,ir(E[1].Target).replace(/#.*$/,""),Qt.HLINK),y["r:id"]="rId"+C),(x=E[1].Target.indexOf("#"))>-1&&(y.location=ir(E[1].Target.slice(x+1))),E[1].Tooltip&&(y.tooltip=ir(E[1].Tooltip)),A[A.length]=Pe("hyperlink",null,y))}),A[A.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(A[A.length]=JX(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(A[A.length]=Cn("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),m.length>0&&(C=sr(n,-1,"../drawings/drawing"+(e+1)+".xml",Qt.DRAW),A[A.length]=Pe("drawing",null,{"r:id":"rId"+C}),u["!drawing"]=m),u["!comments"].length>0&&(C=sr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Qt.VML),A[A.length]=Pe("legacyDrawing",null,{"r:id":"rId"+C}),u["!legacy"]=C),A.length>1&&(A[A.length]="</worksheet>",A[1]=A[1].replace("/>",">")),A.join("")}function aJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var A=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=A/20),r}function sJ(e,t,r){var n=_e(145),A=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;A.hpx?s=fu(A.hpx)*20:A.hpt&&(s=A.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;A.level&&(l|=A.level),A.hidden&&(l|=16),(A.hpx||A.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,u=n.l;n.l+=4;for(var f={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,x=-1,y=d<<10;y<d+1<<10;++y){f.c=y;var C=Array.isArray(r)?(r[f.r]||[])[f.c]:r[ht(f)];C&&(m<0&&(m=y),x=y)}m<0||(++o,n.write_shift(4,m),n.write_shift(4,x))}var E=n.l;return n.l=u,n.write_shift(4,o),n.l=E,n.length>n.l?n.slice(0,n.l):n}function iJ(e,t,r,n){var A=sJ(n,r,t);(A.length>17||(t["!rows"]||[])[n])&&Qe(e,0,A)}var lJ=qi,oJ=Bo;function cJ(){}function uJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=h9(e),r}function fJ(e,t,r){r==null&&(r=_e(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var A=1;A<3;++A)r.write_shift(1,0);return od({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),r4(e,r),r.slice(0,r.l)}function dJ(e){var t=XA(e);return[t]}function hJ(e,t,r){return r==null&&(r=_e(8)),Ji(t,r)}function gJ(e){var t=Yi(e);return[t]}function mJ(e,t,r){return r==null&&(r=_e(4)),Wi(t,r)}function pJ(e){var t=XA(e),r=e.read_shift(1);return[t,r,"b"]}function xJ(e,t,r){return r==null&&(r=_e(9)),Ji(t,r),r.write_shift(1,e.v?1:0),r}function vJ(e){var t=Yi(e),r=e.read_shift(1);return[t,r,"b"]}function wJ(e,t,r){return r==null&&(r=_e(5)),Wi(t,r),r.write_shift(1,e.v?1:0),r}function yJ(e){var t=XA(e),r=e.read_shift(1);return[t,r,"e"]}function BJ(e,t,r){return r==null&&(r=_e(9)),Ji(t,r),r.write_shift(1,e.v),r}function CJ(e){var t=Yi(e),r=e.read_shift(1);return[t,r,"e"]}function EJ(e,t,r){return r==null&&(r=_e(8)),Wi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function TJ(e){var t=XA(e),r=e.read_shift(4);return[t,r,"s"]}function SJ(e,t,r){return r==null&&(r=_e(12)),Ji(t,r),r.write_shift(4,t.v),r}function _J(e){var t=Yi(e),r=e.read_shift(4);return[t,r,"s"]}function bJ(e,t,r){return r==null&&(r=_e(8)),Wi(t,r),r.write_shift(4,t.v),r}function FJ(e){var t=XA(e),r=Dn(e);return[t,r,"n"]}function UJ(e,t,r){return r==null&&(r=_e(16)),Ji(t,r),Oi(e.v,r),r}function ib(e){var t=Yi(e),r=Dn(e);return[t,r,"n"]}function kJ(e,t,r){return r==null&&(r=_e(12)),Wi(t,r),Oi(e.v,r),r}function NJ(e){var t=XA(e),r=Mx(e);return[t,r,"n"]}function IJ(e,t,r){return r==null&&(r=_e(12)),Ji(t,r),n4(e.v,r),r}function QJ(e){var t=Yi(e),r=Mx(e);return[t,r,"n"]}function RJ(e,t,r){return r==null&&(r=_e(8)),Wi(t,r),n4(e.v,r),r}function DJ(e){var t=XA(e),r=Qx(e);return[t,r,"is"]}function MJ(e){var t=XA(e),r=Ln(e);return[t,r,"str"]}function LJ(e,t,r){return r==null&&(r=_e(12+4*e.v.length)),Ji(t,r),fn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function HJ(e){var t=Yi(e),r=Ln(e);return[t,r,"str"]}function OJ(e,t,r){return r==null&&(r=_e(8+4*e.v.length)),Wi(t,r),fn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function PJ(e,t,r){var n=e.l+t,A=XA(e);A.r=r["!row"];var s=e.read_shift(1),l=[A,s,"b"];if(r.cellFormula){e.l+=2;var o=Vd(e,n-e.l,r);l[3]=Qn(o,null,A,r.supbooks,r)}else e.l=n;return l}function GJ(e,t,r){var n=e.l+t,A=XA(e);A.r=r["!row"];var s=e.read_shift(1),l=[A,s,"e"];if(r.cellFormula){e.l+=2;var o=Vd(e,n-e.l,r);l[3]=Qn(o,null,A,r.supbooks,r)}else e.l=n;return l}function VJ(e,t,r){var n=e.l+t,A=XA(e);A.r=r["!row"];var s=Dn(e),l=[A,s,"n"];if(r.cellFormula){e.l+=2;var o=Vd(e,n-e.l,r);l[3]=Qn(o,null,A,r.supbooks,r)}else e.l=n;return l}function KJ(e,t,r){var n=e.l+t,A=XA(e);A.r=r["!row"];var s=Ln(e),l=[A,s,"str"];if(r.cellFormula){e.l+=2;var o=Vd(e,n-e.l,r);l[3]=Qn(o,null,A,r.supbooks,r)}else e.l=n;return l}var jJ=qi,zJ=Bo;function XJ(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function JJ(e,t){var r=e.l+t,n=qi(e),A=Rx(e),s=Ln(e),l=Ln(e),o=Ln(e);e.l=r;var u={rfx:n,relId:A,loc:s,display:o};return l&&(u.Tooltip=l),u}function YJ(e,t){var r=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Bo({s:Qr(e[0]),e:Qr(e[0])},r),Dx("rId"+t,r);var n=e[1].Target.indexOf("#"),A=n==-1?"":e[1].Target.slice(n+1);return fn(A||"",r),fn(e[1].Tooltip||"",r),fn("",r),r.slice(0,r.l)}function WJ(){}function qJ(e,t,r){var n=e.l+t,A=A4(e),s=e.read_shift(1),l=[A];if(l[2]=s,r.cellFormula){var o=yX(e,n-e.l,r);l[1]=o}else e.l=n;return l}function $J(e,t,r){var n=e.l+t,A=qi(e),s=[A];if(r.cellFormula){var l=CX(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function ZJ(e,t,r){r==null&&(r=_e(18));var n=Kd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var A=0;return t.hidden&&(A|=1),typeof n.width=="number"&&(A|=2),t.level&&(A|=t.level<<8),r.write_shift(2,A),r}var lb=["left","right","top","bottom","header","footer"];function eY(e){var t={};return lb.forEach(function(r){t[r]=Dn(e)}),t}function tY(e,t){return t==null&&(t=_e(48)),Mi(e),lb.forEach(function(r){Oi(e[r],t)}),t}function rY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function nY(e,t,r){r==null&&(r=_e(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function AY(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),Bo(e,t),t}function aY(e,t){return t==null&&(t=_e(66)),t.write_shift(2,e.password?Vx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function sY(){}function iY(){}function lY(e,t,r,n,A,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,x=!1,y,C,E,T,_,F,S,I,M,Q=[];o.biff=12,o["!row"]=0;var U=0,G=!1,R=[],te={},ne=o.supbooks||A.supbooks||[[]];if(ne.sharedf=te,ne.arrayf=R,ne.SheetNames=A.SheetNames||A.Sheets.map(function(Re){return Re.name}),!o.supbooks&&(o.supbooks=ne,A.Names))for(var ee=0;ee<A.Names.length;++ee)ne[0][ee+1]=A.Names[ee];var ae=[],Se=[],Te=!1;du[16]={n:"BrtShortReal",f:ib};var q;if(is(e,function(ie,Me,X){if(!x)switch(X){case 148:f=ie;break;case 0:y=ie,o.sheetRows&&o.sheetRows<=y.r&&(x=!0),I=zr(T=y.r),o["!row"]=y.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=co(ie.hpt)),Se[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(C={t:ie[2]},ie[2]){case"n":C.v=ie[1];break;case"s":S=zc[ie[1]],C.v=S.t,C.r=S.r;break;case"b":C.v=!!ie[1];break;case"e":C.v=ie[1],o.cellText!==!1&&(C.w=ls[C.v]);break;case"str":C.t="s",C.v=ie[1];break;case"is":C.t="s",C.v=ie[1].t;break}if((E=l.CellXf[ie[0].iStyleRef])&&Ab(C,E.numFmtId,null,o,s,l),_=ie[0].c==-1?_+1:ie[0].c,o.dense?(u[T]||(u[T]=[]),u[T][_]=C):u[Ir(_)+I]=C,o.cellFormula){for(G=!1,U=0;U<R.length;++U){var k=R[U];y.r>=k[0].s.r&&y.r<=k[0].e.r&&_>=k[0].s.c&&_<=k[0].e.c&&(C.F=St(k[0]),G=!0)}!G&&ie.length>3&&(C.f=ie[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>_&&(d.s.c=_),d.e.r<y.r&&(d.e.r=y.r),d.e.c<_&&(d.e.c=_),o.cellDates&&E&&C.t=="n"&&vo(dt[E.numFmtId])){var K=ki(C.v);K&&(C.t="d",C.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}q&&(q.type=="XLDAPR"&&(C.D=!0),q=void 0);break;case 1:case 12:if(!o.sheetStubs||m)break;C={t:"z",v:void 0},_=ie[0].c==-1?_+1:ie[0].c,o.dense?(u[T]||(u[T]=[]),u[T][_]=C):u[Ir(_)+I]=C,d.s.r>y.r&&(d.s.r=y.r),d.s.c>_&&(d.s.c=_),d.e.r<y.r&&(d.e.r=y.r),d.e.c<_&&(d.e.c=_),q&&(q.type=="XLDAPR"&&(C.D=!0),q=void 0);break;case 176:Q.push(ie);break;case 49:q=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var P=n["!id"][ie.relId];for(P?(ie.Target=P.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=P):ie.relId==""&&(ie.Target="#"+ie.loc),T=ie.rfx.s.r;T<=ie.rfx.e.r;++T)for(_=ie.rfx.s.c;_<=ie.rfx.e.c;++_)o.dense?(u[T]||(u[T]=[]),u[T][_]||(u[T][_]={t:"z",v:void 0}),u[T][_].l=ie):(F=ht({c:_,r:T}),u[F]||(u[F]={t:"z",v:void 0}),u[F].l=ie);break;case 426:if(!o.cellFormula)break;R.push(ie),M=o.dense?u[T][_]:u[Ir(_)+I],M.f=Qn(ie[1],d,{r:y.r,c:_},ne,o),M.F=St(ie[0]);break;case 427:if(!o.cellFormula)break;te[ht(ie[0].s)]=ie[1],M=o.dense?u[T][_]:u[Ir(_)+I],M.f=Qn(ie[1],d,{r:y.r,c:_},ne,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)ae[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Te||(Te=!0,Kx(ie.w/256)),Ws(ae[ie.e+1]);break;case 161:u["!autofilter"]={ref:St(ie)};break;case 476:u["!margins"]=ie;break;case 147:A.Sheets[r]||(A.Sheets[r]={}),ie.name&&(A.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(u["!outline"]={above:ie.above,left:ie.left});break;case 137:A.Views||(A.Views=[{}]),A.Views[0]||(A.Views[0]={}),ie.RTL&&(A.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!Me.T){if(!m||o.WTF)throw new Error("Unexpected record 0x"+X.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=St(f||d)),o.sheetRows&&u["!ref"]){var oe=Jt(u["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>d.e.r&&(oe.e.r=d.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>d.e.c&&(oe.e.c=d.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),u["!fullref"]=u["!ref"],u["!ref"]=St(oe))}return Q.length>0&&(u["!merges"]=Q),ae.length>0&&(u["!cols"]=ae),Se.length>0&&(u["!rows"]=Se),u}function oY(e,t,r,n,A,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=_r(t),t.z=t.z||dt[14],t.v=sn(Sr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var u={r,c:n};switch(u.s=ri(A.cellXfs,t,A),t.l&&s["!links"].push([ht(u),t.l]),t.c&&s["!comments"].push([ht(u),t.c]),t.t){case"s":case"str":return A.bookSST?(o=Yx(A.Strings,t.v,A.revStrings),u.t="s",u.v=o,l?Qe(e,18,bJ(t,u)):Qe(e,7,SJ(t,u))):(u.t="str",l?Qe(e,17,OJ(t,u)):Qe(e,6,LJ(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Qe(e,13,RJ(t,u)):Qe(e,2,IJ(t,u)):l?Qe(e,16,kJ(t,u)):Qe(e,5,UJ(t,u)),!0;case"b":return u.t="b",l?Qe(e,15,wJ(t,u)):Qe(e,4,xJ(t,u)),!0;case"e":return u.t="e",l?Qe(e,14,EJ(t,u)):Qe(e,3,BJ(t,u)),!0}return l?Qe(e,12,mJ(t,u)):Qe(e,1,hJ(t,u)),!0}function cY(e,t,r,n){var A=Jt(t["!ref"]||"A1"),s,l="",o=[];Qe(e,145);var u=Array.isArray(t),f=A.e.r;t["!rows"]&&(f=Math.max(A.e.r,t["!rows"].length-1));for(var d=A.s.r;d<=f;++d){l=zr(d),iJ(e,t,A,d);var m=!1;if(d<=A.e.r)for(var x=A.s.c;x<=A.e.c;++x){d===A.s.r&&(o[x]=Ir(x)),s=o[x]+l;var y=u?(t[d]||[])[x]:t[s];if(!y){m=!1;continue}m=oY(e,y,d,x,n,t,m)}}Qe(e,146)}function uY(e,t){!t||!t["!merges"]||(Qe(e,177,XJ(t["!merges"].length)),t["!merges"].forEach(function(r){Qe(e,176,zJ(r))}),Qe(e,178))}function fY(e,t){!t||!t["!cols"]||(Qe(e,390),t["!cols"].forEach(function(r,n){r&&Qe(e,60,ZJ(n,r))}),Qe(e,391))}function dY(e,t){!t||!t["!ref"]||(Qe(e,648),Qe(e,649,AY(Jt(t["!ref"]))),Qe(e,650))}function hY(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var A=sr(r,-1,n[1].Target.replace(/#.*$/,""),Qt.HLINK);Qe(e,494,YJ(n,A))}}),delete t["!links"]}function gY(e,t,r,n){if(t["!comments"].length>0){var A=sr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Qt.VML);Qe(e,551,Dx("rId"+A)),t["!legacy"]=A}}function mY(e,t,r,n){if(t["!autofilter"]){var A=t["!autofilter"],s=typeof A.ref=="string"?A.ref:St(A.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=sA(s);o.s.r==o.e.r&&(o.e.r=sA(t["!ref"]).e.r,s=St(o));for(var u=0;u<l.length;++u){var f=l[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+s;break}}u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Qe(e,161,Bo(Jt(s))),Qe(e,162)}}function pY(e,t,r){Qe(e,133),Qe(e,137,nY(t,r)),Qe(e,138),Qe(e,134)}function xY(e,t){t["!protect"]&&Qe(e,535,aY(t["!protect"]))}function vY(e,t,r,n){var A=aA(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var u=Jt(l["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Qe(A,129),(r.vbaraw||l["!outline"])&&Qe(A,147,fJ(o,l["!outline"])),Qe(A,148,oJ(u)),pY(A,l,r.Workbook),fY(A,l),cY(A,l,e,t),xY(A,l),mY(A,l,r,e),uY(A,l),hY(A,l,n),l["!margins"]&&Qe(A,476,tY(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&dY(A,l),gY(A,l,e,n),Qe(A,130),A.end()}function wY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var A=Xt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,A,n]}function yY(e,t,r,n,A,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var x=wY(m);d.s.r=d.s.c=0,d.e.c=o,f=Ir(o),x[0].forEach(function(y,C){l[f+zr(C)]={t:"n",v:y,z:x[1]},u=C}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(l["!ref"]=St(d)),l}function BY(e,t,r,n,A){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(ab);return o&&Wx(o[0],s,A,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function CY(e,t){e.l+=10;var r=Ln(e);return{name:r}}function EY(e,t,r,n,A){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return is(e,function(u,f,d){switch(d){case 550:s["!rel"]=u;break;case 651:A.Sheets[r]||(A.Sheets[r]={}),u.name&&(A.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var qx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SY=[],_Y=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function U2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],A=0;A!=t.length;++A){var s=t[A];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Tr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function k2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Tr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ob(e){k2(e.WBProps,qx),k2(e.CalcPr,_Y),U2(e.WBView,TY),U2(e.Sheets,SY),so.date1904=Tr(e.WBProps.date1904)}function bY(e){return!e.Workbook||!e.Workbook.WBProps?"false":Tr(e.Workbook.WBProps.date1904)?"true":"false"}var FY="][*?/\\".split("");function cb(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return FY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function UY(e,t,r){e.forEach(function(n,A){cb(n);for(var s=0;s<A;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[A]&&t[A].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function kY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];UY(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)bX(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var NY=/<\w+:workbook/;function IY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,A="xmlns",s={},l=0;if(e.replace(On,function(u,f){var d=gt(u);switch(ya(d[0])){case"<?xml":break;case"<workbook":u.match(NY)&&(A="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[A];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qx.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Tr(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=pr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Xt(pr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=pr(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Tr(d.hidden||"0")&&(s.Hidden=!0),l=f+u.length;break;case"</definedName>":s.Ref=Xt(pr(e.slice(l,f))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Xi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ob(r),r}function ub(e){var t=[Xr];t[t.length]=Pe("workbook",null,{xmlns:Xi[0],"xmlns:r":an.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(qx.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Pe("workbookPr",null,n);var A=e.Workbook&&e.Workbook.Sheets||[],s=0;if(A&&A[0]&&A[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!A[s]||!A[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:ir(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),A[s])switch(A[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Pe("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(t[t.length]=Pe("definedName",ir(o.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function QY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Dp(e),r.name=Ln(e),r}function RY(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Dx(e.strRelID,t),fn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function DY(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var A=t>8?Ln(e):"";return A.length>0&&(r.CodeName=A),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function MY(e,t){t||(t=_e(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),r4(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function LY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function HY(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var A=e.read_shift(4),s=g9(e),l=BX(e,0,r),o=Rx(e);e.l=n;var u={Name:s,Ptg:l};return A<268435455&&(u.Sheet=A),o&&(u.Comment=o),u}function OY(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],A=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],du[16]={n:"BrtFRTArchID$",f:LY},is(e,function(u,f,d){switch(d){case 156:l.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Qn(u.Ptg,null,null,l,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,u]):l[0]=[d,u],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(u),l.XTI=l.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),A=!0;break;case 36:n.pop(),A=!1;break;case 37:n.push(d),A=!0;break;case 38:n.pop(),A=!1;break;case 16:break;default:if(!f.T){if(!A||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),ob(r),r.Names=s,r.supbooks=l,r}function PY(e,t){Qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,A={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Qe(e,156,RY(A))}Qe(e,144)}function GY(e,t){t||(t=_e(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return fn("SheetJS",t),fn(rd.version,t),fn(rd.version,t),fn("7262",t),t.length>t.l?t.slice(0,t.l):t}function VY(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function KY(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,A=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&A==-1?A=n:r[n].Hidden==1&&s==-1&&(s=n);s>A||(Qe(e,135),Qe(e,158,VY(A)),Qe(e,136))}}function jY(e,t){var r=aA();return Qe(r,131),Qe(r,128,GY()),Qe(r,153,MY(e.Workbook&&e.Workbook.WBProps||null)),KY(r,e),PY(r,e),Qe(r,132),r.end()}function zY(e,t,r){return t.slice(-4)===".bin"?OY(e,r):IY(e,r)}function XY(e,t,r,n,A,s,l,o){return t.slice(-4)===".bin"?lY(e,n,r,A,s,l,o):HX(e,n,r,A,s,l,o)}function JY(e,t,r,n,A,s,l,o){return t.slice(-4)===".bin"?EY(e,n,r,A,s):BY(e,n,r,A,s)}function YY(e,t,r,n,A,s,l,o){return t.slice(-4)===".bin"?qj():$j()}function WY(e,t,r,n,A,s,l,o){return t.slice(-4)===".bin"?Yj():Wj()}function qY(e,t,r,n){return t.slice(-4)===".bin"?zK(e,r,n):QK(e,r,n)}function $Y(e,t,r){return j4(e,r)}function ZY(e,t,r){return t.slice(-4)===".bin"?ZV(e,r):WV(e,r)}function eW(e,t,r){return t.slice(-4)===".bin"?Kj(e,r):Rj(e,r)}function tW(e,t,r){return t.slice(-4)===".bin"?Nj(e):Uj(e)}function rW(e,t,r,n){return r.slice(-4)===".bin"?Ij(e,t,r,n):void 0}function nW(e,t,r){return t.slice(-4)===".bin"?_j(e,t,r):Fj(e,t,r)}function AW(e,t,r){return(t.slice(-4)===".bin"?jY:ub)(e)}function aW(e,t,r,n,A){return(t.slice(-4)===".bin"?vY:sb)(e,r,n,A)}function sW(e,t,r){return(t.slice(-4)===".bin"?rj:V4)(e,r)}function iW(e,t,r){return(t.slice(-4)===".bin"?rK:R4)(e,r)}function lW(e,t,r){return(t.slice(-4)===".bin"?jj:J4)(e)}function oW(e){return(e.slice(-4)===".bin"?bj:z4)()}var fb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,db=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $A(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var A=e.match(fb),s,l,o,u;if(A)for(u=0;u!=A.length;++u)s=A[u].match(db),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function cW(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(fb),A,s,l,o;if(n)for(o=0;o!=n.length;++o)A=n[o].match(db),(s=A[1].indexOf(":"))===-1?r[A[1]]=A[2].slice(1,A[2].length-1):(A[1].slice(0,6)==="xmlns:"?l="xmlns"+A[1].slice(6):l=A[1].slice(s+1),r[l]=A[2].slice(1,A[2].length-1));return r}var Jc;function uW(e,t){var r=Jc[e]||Xt(e);return r==="General"?Li(t):zA(r,t)}function fW(e,t,r,n){var A=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":A=Tr(n);break;case"i2":case"int":A=parseInt(n,10);break;case"r4":case"float":A=parseFloat(n);break;case"date":case"dateTime.tz":A=Sr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Xt(t)]=A}function dW(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ls[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v):e.w=Li(e.v):e.w=uW(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Jc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&vo(n)){var A=ki(e.v);A&&(e.t="d",e.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}}catch(s){if(r.WTF)throw s}}}function hW(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=SK[n.Pattern]||n.Pattern)}e[t.ID]=t}function gW(e,t,r,n,A,s,l,o,u,f){var d="General",m=n.StyleID,x={};f=f||{};var y=[],C=0;for(m===void 0&&o&&(m=o.StyleID),m===void 0&&l&&(m=l.StyleID);s[m]!==void 0&&(s[m].nf&&(d=s[m].nf),s[m].Interior&&y.push(s[m].Interior),!!s[m].Parent);)m=s[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Tr(e);break;case"String":n.t="s",n.r=JE(Xt(e)),n.v=e.indexOf("<")>-1?Xt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Sr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Xt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=i4[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=JE(t||e));break}if(dW(n,d,f),f.cellFormula!==!1)if(n.Formula){var E=Xt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=ao(E,A),delete n.Formula,n.ArrayRange=="RC"?n.F=ao("RC:RC",A):n.ArrayRange&&(n.F=ao(n.ArrayRange,A),u.push([Jt(n.F),n.F]))}else for(C=0;C<u.length;++C)A.r>=u[C][0].s.r&&A.r<=u[C][0].e.r&&A.c>=u[C][0].s.c&&A.c<=u[C][0].e.c&&(n.F=u[C][1]);f.cellStyles&&(y.forEach(function(T){!x.patternType&&T.patternType&&(x.patternType=T.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function mW(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Dm(e,t){var r=t||{};wo();var n=Nc(Fx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pr(n));var A=n.slice(0,1024).toLowerCase(),s=!1;if(A=A.replace(/".*?"/g,""),(A.indexOf(">")&1023)>Math.min(A.indexOf(",")&1023,A.indexOf(";")&1023)){var l=_r(r);return l.type="string",oo.to_workbook(n,l)}if(A.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ct){A.indexOf("<"+ct)>=0&&(s=!0)}),s)return tq(n,r);Jc={"General Number":"General","General Date":dt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":dt[15],"Short Date":dt[14],"Long Time":dt[19],"Medium Time":dt[18],"Short Time":dt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:dt[2],Standard:dt[4],Percent:dt[10],Scientific:dt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},m=[],x=r.dense?[]:{},y="",C={},E={},T=$A('<Data ss:Type="String">'),_=0,F=0,S=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},Q={},U="",G=0,R=[],te={},ne={},ee=0,ae=[],Se=[],Te={},q=[],oe,Re=!1,ie=[],Me=[],X={},k=0,K=0,P={Sheets:[],WBProps:{date1904:!1}},z={};iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";o=iu.exec(n);)switch(o[3]=(Z=o[3]).toLowerCase()){case"data":if(Z=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?gW(n.slice(_,o.index),U,T,u[u.length-1][0]=="comment"?Te:C,{c:F,r:S},M,q[F],E,ie,r):(U="",T=$A(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Se.length>0&&(C.c=Se),(!r.sheetRows||r.sheetRows>S)&&C.v!==void 0&&(r.dense?(x[S]||(x[S]=[]),x[S][F]=C):x[Ir(F)+zr(S)]=C),C.HRef&&(C.l={Target:Xt(C.HRef)},C.HRefScreenTip&&(C.l.Tooltip=C.HRefScreenTip),delete C.HRef,delete C.HRefScreenTip),(C.MergeAcross||C.MergeDown)&&(k=F+(parseInt(C.MergeAcross,10)|0),K=S+(parseInt(C.MergeDown,10)|0),R.push({s:{c:F,r:S},e:{c:k,r:K}})),!r.sheetStubs)C.MergeAcross?F=k+1:++F;else if(C.MergeAcross||C.MergeDown){for(var le=F;le<=k;++le)for(var Ce=S;Ce<=K;++Ce)(le>F||Ce>S)&&(r.dense?(x[Ce]||(x[Ce]=[]),x[Ce][le]={t:"z"}):x[Ir(le)+zr(Ce)]={t:"z"});F=k+1}else++F;else C=cW(o[0]),C.Index&&(F=+C.Index-1),F<I.s.c&&(I.s.c=F),F>I.e.c&&(I.e.c=F),o[0].slice(-2)==="/>"&&++F,Se=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(S<I.s.r&&(I.s.r=S),S>I.e.r&&(I.e.r=S),o[0].slice(-2)==="/>"&&(E=$A(o[0]),E.Index&&(S=+E.Index-1)),F=0,++S):(E=$A(o[0]),E.Index&&(S=+E.Index-1),X={},(E.AutoFitHeight=="0"||E.Height)&&(X.hpx=parseInt(E.Height,10),X.hpt=fu(X.hpx),Me[S]=X),E.Hidden=="1"&&(X.hidden=!0,Me[S]=X));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));m.push(y),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(x["!ref"]=St(I),r.sheetRows&&r.sheetRows<=I.e.r&&(x["!fullref"]=x["!ref"],I.e.r=r.sheetRows-1,x["!ref"]=St(I))),R.length&&(x["!merges"]=R),q.length>0&&(x["!cols"]=q),Me.length>0&&(x["!rows"]=Me),d[y]=x}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=F=0,u.push([o[3],!1]),f=$A(o[0]),y=Xt(f.Name),x=r.dense?[]:{},R=[],ie=[],Me=[],z={name:y,Hidden:0},P.Sheets.push(z);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),q=[],Re=!1}break;case"style":o[1]==="/"?hW(M,Q,r):Q=$A(o[0]);break;case"numberformat":Q.nf=Xt($A(o[0]).Format||"General"),Jc[Q.nf]&&(Q.nf=Jc[Q.nf]);for(var he=0;he!=392&&dt[he]!=Q.nf;++he);if(he==392){for(he=57;he!=392;++he)if(dt[he]==null){qa(Q.nf,he);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(oe=$A(o[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!Re&&oe.wpx>10){Re=!0,Rn=P4;for(var Ae=0;Ae<q.length;++Ae)q[Ae]&&Ws(q[Ae])}Re&&Ws(oe),q[oe.Index-1||q.length]=oe;for(var ce=0;ce<+oe.Span;++ce)q[q.length]=_r(oe);break;case"namedrange":if(o[1]==="/")break;P.Names||(P.Names=[]);var L=gt(o[0]),je={Name:L.Name,Ref:ao(L.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(je.Sheet=P.Sheets.length-1),P.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?U+=n.slice(G,o.index):G=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;Q.Interior=$A(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?O9(te,Z,n.slice(ee,o.index)):ee=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));mW(Te),Se.push(Te)}else u.push([o[3],!1]),f=$A(o[0]),Te={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Je=$A(o[0]);x["!autofilter"]={ref:ao(Je.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return D2(n,r);var et=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(o[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(ee,o.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else ee=o.index+o[0].length;break;case"header":x["!margins"]||Mi(x["!margins"]={},"xlml"),isNaN(+gt(o[0]).Margin)||(x["!margins"].header=+gt(o[0]).Margin);break;case"footer":x["!margins"]||Mi(x["!margins"]={},"xlml"),isNaN(+gt(o[0]).Margin)||(x["!margins"].footer=+gt(o[0]).Margin);break;case"pagemargins":var qe=gt(o[0]);x["!margins"]||Mi(x["!margins"]={},"xlml"),isNaN(+qe.Top)||(x["!margins"].top=+qe.Top),isNaN(+qe.Left)||(x["!margins"].left=+qe.Left),isNaN(+qe.Right)||(x["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(x["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?fW(ne,Z,ae,n.slice(ee,o.index)):(ae=o,ee=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=d),De.SheetNames=m,De.Workbook=P,De.SSF=_r(dt),De.Props=te,De.Custprops=ne,De}function Vp(e,t){switch(Zx(t=t||{}),t.type||"base64"){case"base64":return Dm(wA(e),t);case"binary":case"buffer":case"file":return Dm(e,t);case"array":return Dm(ei(e),t)}}function pW(e,t){var r=[];return e.Props&&r.push(P9(e.Props,t)),e.Custprops&&r.push(G9(e.Props,e.Custprops)),r.join("")}function xW(){return""}function vW(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,A){var s=[];s.push(Pe("NumberFormat",null,{"ss:Format":ir(dt[n.numFmtId])}));var l={"ss:ID":"s"+(21+A)};r.push(Pe("Style",s.join(""),l))}),Pe("Styles",r.join(""))}function hb(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xx(e.Ref,{r:0,c:0})})}function wW(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var A=t[n];A.Sheet==null&&(A.Name.match(/^_xlfn\./)||r.push(hb(A)))}return Pe("Names",r.join(""))}function yW(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var A=n.Workbook.Names,s=[],l=0;l<A.length;++l){var o=A[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(hb(o)))}return s.join("")}function BW(e,t,r,n){if(!e)return"";var A=[];if(e["!margins"]&&(A.push("<PageSetup>"),e["!margins"].header&&A.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&A.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),A.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),A.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)A.push(Pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&A.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&A.push("<DisplayRightToLeft/>"),e["!protect"]&&(A.push(Cn("ProtectContents","True")),e["!protect"].objects&&A.push(Cn("ProtectObjects","True")),e["!protect"].scenarios&&A.push(Cn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?A.push(Cn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&A.push(Cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&A.push("<"+l[1]+"/>")})),A.length==0?"":Pe("WorksheetOptions",A.join(""),{xmlns:gA.x})}function CW(e){return e.map(function(t){var r=K7(t.t||""),n=Pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",n,{"ss:Author":t.a})}).join("")}function EW(e,t,r,n,A,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ir(Xx(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var u=Qr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==l.r?"":"["+(u.r-l.r)+"]")+"C"+(u.c==l.c?"":"["+(u.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ir(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ir(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],d=0;d!=f.length;++d)f[d].s.c!=l.c||f[d].s.r!=l.r||(f[d].e.c>f[d].s.c&&(o["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(o["ss:MergeDown"]=f[d].e.r-f[d].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",x=String(e.v);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=ls[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||dt[14]);break;case"s":m="String",x=V7(e.v||"");break}var y=ri(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=l.c+1;var C=e.v!=null?x:"",E=e.t=="z"?"":'<Data ss:Type="'+m+'">'+C+"</Data>";return(e.c||[]).length>0&&(E+=CW(e.c)),Pe("Cell",E,o)}function TW(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=co(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function SW(e,t,r,n){if(!e["!ref"])return"";var A=Jt(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(T,_){Ws(T);var F=!!T.width,S=Kd(_,T),I={"ss:Index":_+1};F&&(I["ss:Width"]=cu(S.width)),T.hidden&&(I["ss:Hidden"]="1"),o.push(Pe("Column",null,I))});for(var u=Array.isArray(e),f=A.s.r;f<=A.e.r;++f){for(var d=[TW(f,(e["!rows"]||[])[f])],m=A.s.c;m<=A.e.c;++m){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>m)&&!(s[l].s.r>f)&&!(s[l].e.c<m)&&!(s[l].e.r<f)){(s[l].s.c!=m||s[l].s.r!=f)&&(x=!0);break}if(!x){var y={r:f,c:m},C=ht(y),E=u?(e[f]||[])[m]:e[C];d.push(EW(E,C,e,t,r,n,y))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function _W(e,t,r){var n=[],A=r.SheetNames[e],s=r.Sheets[A],l=s?yW(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?SW(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(BW(s,t,e,r)),n.join("")}function bW(e,t){t||(t={}),e.SSF||(e.SSF=_r(dt)),e.SSF&&(wo(),Md(e.SSF),t.revssf=Hd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(pW(e,t)),r.push(xW()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Pe("Worksheet",_W(n,t,e),{"ss:Name":ir(e.SheetNames[n])}));return r[2]=vW(e,t),r[3]=wW(e),Xr+Pe("Workbook",r.join(""),{xmlns:gA.ss,"xmlns:o":gA.o,"xmlns:x":gA.x,"xmlns:ss":gA.ss,"xmlns:dt":gA.dt,"xmlns:html":gA.html})}function FW(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=w9(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=y9(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var UW=[60,1084,2066,2165,2175];function kW(e,t,r,n,A){var s=n,l=[],o=r.slice(r.l,r.l+s);if(A&&A.enc&&A.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:A.enc.insitu(o)}l.push(o),r.l+=s;for(var u=Xa(r,r.l),f=Kp[u],d=0;f!=null&&UW.indexOf(u)>-1;)s=Xa(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+s),l.push(o),r.l+=4+s,f=Kp[u=Xa(r,r.l)];var m=un(l);Bn(m,0);var x=0;m.lens=[];for(var y=0;y<l.length;++y)m.lens.push(x),x+=l[y].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,A)}function ha(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=dt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ls[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v):e.w=Li(e.v):e.w=zA(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&vo(dt[n]||String(n))){var A=ki(e.v);A&&(e.t="d",e.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}}}function Cf(e,t,r){return{v:e,ixfe:t,t:r}}function NW(e,t){var r={opts:{}},n={},A=t.dense?[]:{},s={},l={},o=null,u=[],f="",d={},m,x="",y,C,E,T,_={},F=[],S,I,M=[],Q=[],U={Sheets:[],WBProps:{date1904:!1},Views:[{}]},G={},R=function(nt){return nt<8?Qi[nt]:nt<64&&Q[nt-8]||Qi[nt]},te=function(nt,pt,Nt){var yt=pt.XF.data;if(!(!yt||!yt.patternType||!Nt||!Nt.cellStyles)){pt.s={},pt.s.patternType=yt.patternType;var rr;(rr=ou(R(yt.icvFore)))&&(pt.s.fgColor={rgb:rr}),(rr=ou(R(yt.icvBack)))&&(pt.s.bgColor={rgb:rr})}},ne=function(nt,pt,Nt){if(!(X>1)&&!(Nt.sheetRows&&nt.r>=Nt.sheetRows)){if(Nt.cellStyles&&pt.XF&&pt.XF.data&&te(nt,pt,Nt),delete pt.ixfe,delete pt.XF,m=nt,x=ht(nt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<l.s.r&&(l.s.r=nt.r),nt.c<l.s.c&&(l.s.c=nt.c),nt.r+1>l.e.r&&(l.e.r=nt.r+1),nt.c+1>l.e.c&&(l.e.c=nt.c+1),Nt.cellFormula&&pt.f){for(var yt=0;yt<F.length;++yt)if(!(F[yt][0].s.c>nt.c||F[yt][0].s.r>nt.r)&&!(F[yt][0].e.c<nt.c||F[yt][0].e.r<nt.r)){pt.F=St(F[yt][0]),(F[yt][0].s.c!=nt.c||F[yt][0].s.r!=nt.r)&&delete pt.f,pt.f&&(pt.f=""+Qn(F[yt][1],l,nt,ie,ee));break}}Nt.dense?(A[nt.r]||(A[nt.r]=[]),A[nt.r][nt.c]=pt):A[x]=pt}},ee={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ee.password=t.password);var ae,Se=[],Te=[],q=[],oe=[],Re=!1,ie=[];ie.SheetNames=ee.snames,ie.sharedf=ee.sharedf,ie.arrayf=ee.arrayf,ie.names=[],ie.XTI=[];var Me=0,X=0,k=0,K=[],P=[],z;ee.codepage=1200,ea(1200);for(var Z=!1;e.l<e.length-1;){var le=e.l,Ce=e.read_shift(2);if(Ce===0&&Me===10)break;var he=e.l===e.length?0:e.read_shift(2),Ae=Kp[Ce];if(Ae&&Ae.f){if(t.bookSheets&&Me===133&&Ce!==133)break;if(Me=Ce,Ae.r===2||Ae.r==12){var ce=e.read_shift(2);if(he-=2,!ee.enc&&ce!==Ce&&((ce&255)<<8|ce>>8)!==Ce)throw new Error("rt mismatch: "+ce+"!="+Ce);Ae.r==12&&(e.l+=10,he-=10)}var L={};if(Ce===10?L=Ae.f(e,he,ee):L=kW(Ce,Ae,e,he,ee),X==0&&[9,521,1033,2057].indexOf(Me)===-1)continue;switch(Ce){case 34:r.opts.Date1904=U.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=L;break;case 66:var je=Number(L);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}ea(ee.codepage=je),Z=!0;break;case 317:ee.rrtabid=L;break;case 25:ee.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:ee.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(A["!type"]="dialog"),L.fBelow||((A["!outline"]||(A["!outline"]={})).above=!0),L.fRight||((A["!outline"]||(A["!outline"]={})).left=!0);break;case 224:M.push(L);break;case 430:ie.push([L]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(L);break;case 24:case 536:z={Name:L.Name,Ref:Qn(L.rgce,l,null,ie,ee)},L.itab>0&&(z.Sheet=L.itab-1),ie.names.push(z),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(P[L.itab-1]={ref:St(L.rgce[0][0][1][2])});break;case 22:ee.ExternCount=L;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(L),ie.XTI=ie.XTI.concat(L);break;case 2196:if(ee.biff<8)break;z!=null&&(z.Comment=L[1]);break;case 18:A["!protect"]=L;break;case 19:L!==0&&ee.WTF&&console.error("Password verifier: "+L);break;case 133:s[L.pos]=L,ee.snames.push(L.name);break;case 10:{if(--X)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,A["!ref"]=St(l),t.sheetRows&&t.sheetRows<=l.e.r){var Je=l.e.r;l.e.r=t.sheetRows-1,A["!fullref"]=A["!ref"],A["!ref"]=St(l),l.e.r=Je}l.e.r++,l.e.c++}Se.length>0&&(A["!merges"]=Se),Te.length>0&&(A["!objects"]=Te),q.length>0&&(A["!cols"]=q),oe.length>0&&(A["!rows"]=oe),U.Sheets.push(G)}f===""?d=A:n[f]=A,A=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),ee.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(ee.biff=5,Z=!0,ea(ee.codepage=28591)),ee.biff==8&&L.BIFFVer==0&&L.dt==16&&(ee.biff=2),X++)break;if(A=t.dense?[]:{},ee.biff<8&&!Z&&(Z=!0,ea(ee.codepage=t.codepage||1252)),ee.biff<5||L.BIFFVer==0&&L.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:e.l-he,name:f};s[et.pos]=et,ee.snames.push(f)}else f=(s[le]||{name:""}).name;L.dt==32&&(A["!type"]="chart"),L.dt==64&&(A["!type"]="macro"),Se=[],Te=[],ee.arrayf=F=[],q=[],oe=[],Re=!1,G={Hidden:(s[le]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:A["!type"]=="chart"&&(t.dense?(A[L.r]||[])[L.c]:A[ht({c:L.c,r:L.r})])&&++L.c,S={ixfe:L.ixfe,XF:M[L.ixfe]||{},v:L.val,t:"n"},k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:L.c,r:L.r},S,t);break;case 5:case 517:S={ixfe:L.ixfe,XF:M[L.ixfe],v:L.val,t:L.t},k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:L.c,r:L.r},S,t);break;case 638:S={ixfe:L.ixfe,XF:M[L.ixfe],v:L.rknum,t:"n"},k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:L.c,r:L.r},S,t);break;case 189:for(var qe=L.c;qe<=L.C;++qe){var De=L.rkrec[qe-L.c][0];S={ixfe:De,XF:M[De],v:L.rkrec[qe-L.c][1],t:"n"},k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:qe,r:L.r},S,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){o=L;break}if(S=Cf(L.val,L.cell.ixfe,L.tt),S.XF=M[S.ixfe],t.cellFormula){var ct=L.formula;if(ct&&ct[0]&&ct[0][0]&&ct[0][0][0]=="PtgExp"){var Kt=ct[0][0][1][0],lr=ct[0][0][1][1],jt=ht({r:Kt,c:lr});_[jt]?S.f=""+Qn(L.formula,l,L.cell,ie,ee):S.F=((t.dense?(A[Kt]||[])[lr]:A[jt])||{}).F}else S.f=""+Qn(L.formula,l,L.cell,ie,ee)}k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne(L.cell,S,t),o=L}break;case 7:case 519:if(o)o.val=L,S=Cf(L,o.cell.ixfe,"s"),S.XF=M[S.ixfe],t.cellFormula&&(S.f=""+Qn(o.formula,l,o.cell,ie,ee)),k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne(o.cell,S,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(L);var Ct=ht(L[0].s);if(y=t.dense?(A[L[0].s.r]||[])[L[0].s.c]:A[Ct],t.cellFormula&&y){if(!o||!Ct||!y)break;y.f=""+Qn(L[1],l,L[0],ie,ee),y.F=St(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!o)break;_[ht(o.cell)]=L[0],y=t.dense?(A[o.cell.r]||[])[o.cell.c]:A[ht(o.cell)],(y||{}).f=""+Qn(L[0],l,m,ie,ee)}}break;case 253:S=Cf(u[L.isst].t,L.ixfe,"s"),u[L.isst].h&&(S.h=u[L.isst].h),S.XF=M[S.ixfe],k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:L.c,r:L.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:L.ixfe,XF:M[L.ixfe],t:"z"},k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:L.c,r:L.r},S,t));break;case 190:if(t.sheetStubs)for(var wr=L.c;wr<=L.C;++wr){var mt=L.ixfe[wr-L.c];S={ixfe:mt,XF:M[mt],t:"z"},k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:wr,r:L.r},S,t)}break;case 214:case 516:case 4:S=Cf(L.val,L.ixfe,"s"),S.XF=M[S.ixfe],k>0&&(S.z=K[S.ixfe>>8&63]),ha(S,t,r.opts.Date1904),ne({c:L.c,r:L.r},S,t);break;case 0:case 512:X===1&&(l=L);break;case 252:u=L;break;case 1054:if(ee.biff==4){K[k++]=L[1];for(var ue=0;ue<k+163&&dt[ue]!=L[1];++ue);ue>=163&&qa(L[1],k+163)}else qa(L[1],L[0]);break;case 30:{K[k++]=L;for(var Ve=0;Ve<k+163&&dt[Ve]!=L;++Ve);Ve>=163&&qa(L,k+163)}break;case 229:Se=Se.concat(L);break;case 93:Te[L.cmo[0]]=ee.lastobj=L;break;case 438:ee.lastobj.TxO=L;break;case 127:ee.lastobj.ImData=L;break;case 440:for(T=L[0].s.r;T<=L[0].e.r;++T)for(E=L[0].s.c;E<=L[0].e.c;++E)y=t.dense?(A[T]||[])[E]:A[ht({c:E,r:T})],y&&(y.l=L[1]);break;case 2048:for(T=L[0].s.r;T<=L[0].e.r;++T)for(E=L[0].s.c;E<=L[0].e.c;++E)y=t.dense?(A[T]||[])[E]:A[ht({c:E,r:T})],y&&y.l&&(y.l.Tooltip=L[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;y=t.dense?(A[L[0].r]||[])[L[0].c]:A[ht(L[0])];var Et=Te[L[2]];y||(t.dense?(A[L[0].r]||(A[L[0].r]=[]),y=A[L[0].r][L[0].c]={t:"z"}):y=A[ht(L[0])]={t:"z"},l.e.r=Math.max(l.e.r,L[0].r),l.s.r=Math.min(l.s.r,L[0].r),l.e.c=Math.max(l.e.c,L[0].c),l.s.c=Math.min(l.s.c,L[0].c)),y.c||(y.c=[]),C={a:L[1],t:Et.TxO.t},y.c.push(C)}break;case 2173:vj(M[L.ixfe],L.ext);break;case 125:{if(!ee.cellStyles)break;for(;L.e>=L.s;)q[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},Re||(Re=!0,Kx(L.w/256)),Ws(q[L.e+1])}break;case 520:{var vt={};L.level!=null&&(oe[L.r]=vt,vt.level=L.level),L.hidden&&(oe[L.r]=vt,vt.hidden=!0),L.hpt&&(oe[L.r]=vt,vt.hpt=L.hpt,vt.hpx=co(L.hpt))}break;case 38:case 39:case 40:case 41:A["!margins"]||Mi(A["!margins"]={}),A["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=L;break;case 161:A["!margins"]||Mi(A["!margins"]={}),A["!margins"].header=L.header,A["!margins"].footer=L.footer;break;case 574:L.RTL&&(U.Views[0].RTL=!0);break;case 146:Q=L;break;case 2198:ae=L;break;case 140:I=L;break;case 442:f?G.CodeName=L||G.name:U.WBProps.CodeName=L||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),e.l+=he}return r.SheetNames=Hr(s).sort(function(Ut,nt){return Number(Ut)-Number(nt)}).map(function(Ut){return s[Ut].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&P.forEach(function(Ut,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=Ut}),r.Strings=u,r.SSF=_r(dt),ee.enc&&(r.Encryption=ee.enc),ae&&(r.Themes=ae),r.Metadata={},I!==void 0&&(r.Metadata.Country=I),ie.names.length>0&&(U.Names=ie.names),r.Workbook=U,r}var Yc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function IW(e,t,r){var n=lt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var A=f2(n,Mp,Yc.DSI);for(var s in A)t[s]=A[s]}catch(f){if(r.WTF)throw f}var l=lt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=f2(l,Lp,Yc.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(d4(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function QW(e,t){var r=[],n=[],A=[],s=0,l,o=GE(Mp,"n"),u=GE(Lp,"n");if(e.Props)for(l=Hr(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(u,l[s])?n:A).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=Hr(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(u,l[s])?n:A).push([l[s],e.Custprops[l[s]]]);var f=[];for(s=0;s<A.length;++s)w4.indexOf(A[s][0])>-1||f4.indexOf(A[s][0])>-1||A[s][1]!=null&&f.push(A[s]);n.length&&lt.utils.cfb_add(t,"/SummaryInformation",d2(n,Yc.SI,u,Lp)),(r.length||f.length)&&lt.utils.cfb_add(t,"/DocumentSummaryInformation",d2(r,Yc.DSI,o,Mp,f.length?f:null,Yc.UDI))}function gb(e,t){t||(t={}),Zx(t),wx(),t.codepage&&vx(t.codepage);var r,n;if(e.FullPaths){if(lt.find(e,"/encryption"))throw new Error("File is password-protected");r=lt.find(e,"!CompObj"),n=lt.find(e,"/Workbook")||lt.find(e,"/Book")}else{switch(t.type){case"base64":e=pA(wA(e));break;case"binary":e=pA(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Bn(e,0),n={content:e}}var A,s;if(r&&FW(r),t.bookProps&&!t.bookSheets)A={};else{var l=kt?"buffer":"array";if(n&&n.content)A=NW(n.content,t);else if((s=lt.find(e,"PerfectOffice_MAIN"))&&s.content)A=Di.to_workbook(s.content,(t.type=l,t));else if((s=lt.find(e,"NativeContent_MAIN"))&&s.content)A=Di.to_workbook(s.content,(t.type=l,t));else throw(s=lt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&lt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(A.vbaraw=Xj(e))}var o={};return e.FullPaths&&IW(e,o,t),A.Props=A.Custprops=o,t.bookFiles&&(A.cfb=e),A}function RW(e,t){var r=t||{},n=lt.utils.cfb_new({root:"R"}),A="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":A="/Workbook",r.biff=8;break;case"biff5":A="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return lt.utils.cfb_add(n,A,mb(e,r)),r.biff==8&&(e.Props||e.Custprops)&&QW(e,n),r.biff==8&&e.vbaraw&&Jj(n,lt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var du={0:{f:aJ},1:{f:dJ},2:{f:NJ},3:{f:yJ},4:{f:pJ},5:{f:FJ},6:{f:MJ},7:{f:TJ},8:{f:KJ},9:{f:VJ},10:{f:PJ},11:{f:GJ},12:{f:gJ},13:{f:QJ},14:{f:CJ},15:{f:vJ},16:{f:ib},17:{f:HJ},18:{f:_J},19:{f:Qx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HY},40:{},42:{},43:{f:MK},44:{f:RK},45:{f:OK},46:{f:GK},47:{f:PK},48:{},49:{f:l9},50:{},51:{f:Bj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:k4},62:{f:DJ},63:{f:kj},64:{f:sY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uJ},148:{f:lJ,p:16},151:{f:WJ},152:{},153:{f:DY},154:{},155:{},156:{f:QY},157:{},158:{},159:{T:1,f:$V},160:{T:-1},161:{T:1,f:qi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:jJ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:wj},336:{T:-1},337:{f:Tj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:U4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qJ},427:{f:$J},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Gj},633:{T:1},634:{T:-1},635:{T:1,f:Oj},636:{T:-1},637:{f:f9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:iY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Kp={6:{f:Qm},10:{f:Rs},12:{f:en},13:{f:en},14:{f:Kr},15:{f:Kr},16:{f:Dn},17:{f:Kr},18:{f:Kr},19:{f:en},20:{f:v2},21:{f:v2},23:{f:U4},24:{f:y2},25:{f:Kr},26:{},27:{},28:{f:iV},29:{},34:{f:Kr},35:{f:w2},38:{f:Dn},39:{f:Dn},40:{f:Dn},41:{f:Dn},42:{f:Kr},43:{f:Kr},47:{f:vK},49:{f:QG},51:{f:en},60:{},61:{f:FG},64:{f:Kr},65:{f:IG},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:xG},93:{f:cV},94:{},95:{f:Kr},96:{},97:{},99:{f:Kr},125:{f:k4},128:{f:YG},129:{f:wG},130:{f:en},131:{f:Kr},132:{f:Kr},133:{f:yG},134:{},140:{f:xV},141:{f:en},144:{},146:{f:yV},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:bV},161:{f:EV},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:jG},190:{f:zG},193:{f:Rs},197:{},198:{},199:{},200:{},201:{},202:{f:Kr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:Kr},222:{},224:{f:JG},225:{f:pG},226:{f:Rs},227:{},229:{f:lV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CG},253:{f:DG},255:{f:TG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:y4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kr},353:{f:Rs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eV},431:{f:Kr},432:{},433:{},434:{},437:{},438:{f:dV},439:{f:Kr},440:{f:hV},441:{},442:{f:Cu},443:{},444:{f:en},445:{},446:{},448:{f:Rs},449:{f:bG,r:2},450:{f:Rs},512:{f:m2},513:{f:_V},515:{f:$G},516:{f:LG},517:{f:x2},519:{f:FV},520:{f:SG},523:{},545:{f:B2},549:{f:g2},566:{},574:{f:kG},638:{f:KG},659:{},1048:{},1054:{f:OG},1084:{},1212:{f:AV},2048:{f:mV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:wf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Rs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:BV,r:12},2173:{f:xj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nV,r:12},2197:{},2198:{f:fj,r:12},2199:{},2200:{},2201:{},2202:{f:aV,r:12},2203:{f:Rs},2204:{},2205:{},2206:{},2207:{},2211:{f:_G},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TV},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:wV},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:m2},1:{},2:{f:QV},3:{f:NV},4:{f:kV},5:{f:x2},7:{f:DV},8:{},9:{f:wf},11:{},22:{f:en},30:{f:GG},31:{},32:{},33:{f:B2},36:{},37:{f:g2},50:{f:MV},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:UV},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:LV},223:{},234:{},354:{},421:{},518:{f:Qm},521:{f:wf},536:{f:y2},547:{f:w2},561:{},579:{},1030:{f:Qm},1033:{f:wf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ge(e,t,r,n){var A=t;if(!isNaN(A)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,A),l.write_shift(2,s),s>0&&kx(r)&&e.push(r)}}function DW(e,t,r,n){var A=(r||[]).length||0;if(A<=8224)return Ge(e,t,r,A);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,u=0,f=0;f+(l[o]||8224)<=8224;)f+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f;u<A;){for(d=e.next(4),d.write_shift(2,60),f=0;f+(l[o]||8224)<=8224;)f+=l[o]||8224,o++;d.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f}}}function _u(e,t,r){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function MW(e,t,r,n){var A=_e(9);return _u(A,e,t),B4(r,n||"b",A),A}function LW(e,t,r){var n=_e(8+2*r.length);return _u(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function HW(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var A=t.t=="d"?sn(Sr(t.v)):t.v;A==(A|0)&&A>=0&&A<65536?Ge(e,2,RV(r,n,A)):Ge(e,3,IV(r,n,A));return;case"b":case"e":Ge(e,5,MW(r,n,t.v,t.t));return;case"s":case"str":Ge(e,4,LW(r,n,(t.v||"").slice(0,255)));return}Ge(e,1,_u(null,r,n))}function OW(e,t,r,n){var A=Array.isArray(t),s=Jt(t["!ref"]||"A1"),l,o="",u=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=St(s)}for(var f=s.s.r;f<=s.e.r;++f){o=zr(f);for(var d=s.s.c;d<=s.e.c;++d){f===s.s.r&&(u[d]=Ir(d)),l=u[d]+o;var m=A?(t[f]||[])[d]:t[l];m&&HW(e,m,f,d)}}}function PW(e,t){for(var r=t||{},n=aA(),A=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(A=s);if(A==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ge(n,r.biff==4?1033:r.biff==3?521:9,Px(e,16,r)),OW(n,e.Sheets[e.SheetNames[A]],A,r),Ge(n,10),n.end()}function GW(e,t,r){Ge(e,49,RG({sz:12,name:"Arial"},r))}function VW(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var A=n[0];A<=n[1];++A)t[A]!=null&&Ge(e,1054,PG(A,t[A],r))})}function KW(e,t){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ge(e,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_4(Jt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ge(e,2152,r)}function jW(e,t){for(var r=0;r<16;++r)Ge(e,224,p2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ge(e,224,p2(n,0,t))})}function zW(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ge(e,440,gV(n)),n[1].Tooltip&&Ge(e,2048,pV(n))}delete t["!links"]}function XW(e,t){if(t){var r=0;t.forEach(function(n,A){++r<=256&&n&&Ge(e,125,CV(Kd(A,n),A))})}}function JW(e,t,r,n,A){var s=16+ri(A.cellXfs,t,A);if(t.v==null&&!t.bf){Ge(e,513,Gi(r,n,s));return}if(t.bf)Ge(e,6,wX(t,r,n,A,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?sn(Sr(t.v)):t.v;Ge(e,515,ZG(r,n,l,s));break;case"b":case"e":Ge(e,517,qG(r,n,t.v,s,A,t.t));break;case"s":case"str":if(A.bookSST){var o=Yx(A.Strings,t.v,A.revStrings);Ge(e,253,MG(r,n,o,s))}else Ge(e,516,HG(r,n,(t.v||"").slice(0,255),s,A));break;default:Ge(e,513,Gi(r,n,s))}}function YW(e,t,r){var n=aA(),A=r.SheetNames[e],s=r.Sheets[A]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},u=Array.isArray(s),f=t.biff==8,d,m="",x=[],y=Jt(s["!ref"]||"A1"),C=f?65536:16384;if(y.e.c>255||y.e.r>=C){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,C-1)}Ge(n,2057,Px(r,16,t)),Ge(n,13,HA(1)),Ge(n,12,HA(100)),Ge(n,15,Xn(!0)),Ge(n,17,Xn(!1)),Ge(n,16,Oi(.001)),Ge(n,95,Xn(!0)),Ge(n,42,Xn(!1)),Ge(n,43,Xn(!1)),Ge(n,130,HA(1)),Ge(n,128,WG()),Ge(n,131,Xn(!1)),Ge(n,132,Xn(!1)),f&&XW(n,s["!cols"]),Ge(n,512,VG(y,t)),f&&(s["!links"]=[]);for(var E=y.s.r;E<=y.e.r;++E){m=zr(E);for(var T=y.s.c;T<=y.e.c;++T){E===y.s.r&&(x[T]=Ir(T)),d=x[T]+m;var _=u?(s[E]||[])[T]:s[d];_&&(JW(n,_,E,T,t),f&&_.l&&s["!links"].push([d,_.l]))}}var F=o.CodeName||o.name||A;return f&&Ge(n,574,NG((l.Views||[])[0])),f&&(s["!merges"]||[]).length&&Ge(n,229,oV(s["!merges"])),f&&zW(n,s),Ge(n,442,C4(F)),f&&KW(n,s),Ge(n,10),n.end()}function WW(e,t,r){var n=aA(),A=(e||{}).Workbook||{},s=A.Sheets||[],l=A.WBProps||{},o=r.biff==8,u=r.biff==5;if(Ge(n,2057,Px(e,5,r)),r.bookType=="xla"&&Ge(n,135),Ge(n,225,o?HA(1200):null),Ge(n,193,q9(2)),u&&Ge(n,191),u&&Ge(n,192),Ge(n,226),Ge(n,92,vG("SheetJS",r)),Ge(n,66,HA(o?1200:1252)),o&&Ge(n,353,HA(0)),o&&Ge(n,448),Ge(n,317,SV(e.SheetNames.length)),o&&e.vbaraw&&Ge(n,211),o&&e.vbaraw){var f=l.CodeName||"ThisWorkbook";Ge(n,442,C4(f))}Ge(n,156,HA(17)),Ge(n,25,Xn(!1)),Ge(n,18,Xn(!1)),Ge(n,19,HA(0)),o&&Ge(n,431,Xn(!1)),o&&Ge(n,444,HA(0)),Ge(n,61,UG()),Ge(n,64,Xn(!1)),Ge(n,141,HA(0)),Ge(n,34,Xn(bY(e)=="true")),Ge(n,14,Xn(!0)),o&&Ge(n,439,Xn(!1)),Ge(n,218,HA(0)),GW(n,e,r),VW(n,e.SSF,r),jW(n,r),o&&Ge(n,352,Xn(!1));var d=n.end(),m=aA();o&&Ge(m,140,vV()),o&&r.Strings&&DW(m,252,EG(r.Strings)),Ge(m,10);var x=m.end(),y=aA(),C=0,E=0;for(E=0;E<e.SheetNames.length;++E)C+=(o?12:11)+(o?2:1)*e.SheetNames[E].length;var T=d.length+C+x.length;for(E=0;E<e.SheetNames.length;++E){var _=s[E]||{};Ge(y,133,BG({pos:T,hs:_.Hidden||0,dt:0,name:e.SheetNames[E]},r)),T+=t[E].length}var F=y.end();if(C!=F.length)throw new Error("BS8 "+C+" != "+F.length);var S=[];return d.length&&S.push(d),F.length&&S.push(F),x.length&&S.push(x),un(S)}function qW(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=_r(dt)),e&&e.SSF&&(wo(),Md(e.SSF),r.revssf=Hd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ev(r),r.cellXfs=[],ri(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var A=0;A<e.SheetNames.length;++A)n[n.length]=YW(A,r,e);return n.unshift(WW(e,n,r)),un(n)}function mb(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var A=sA(n["!ref"]);A.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return qW(e,t);case 4:case 3:case 2:return PW(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function N2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var A=e.match(/<table/i);if(!A)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=A.index,o=s&&s.index||e.length,u=R7(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,m=0,x=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},C=[];for(l=0;l<u.length;++l){var E=u[l].trim(),T=E.slice(0,3).toLowerCase();if(T=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(T!="<td"&&T!="<th")){var _=E.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var F=_[o].trim();if(F.match(/<t[dh]/i)){for(var S=F,I=0;S.charAt(0)=="<"&&(I=S.indexOf(">"))>-1;)S=S.slice(I+1);for(var M=0;M<C.length;++M){var Q=C[M];Q.s.c==d&&Q.s.r<f&&f<=Q.e.r&&(d=Q.e.c+1,M=-1)}var U=gt(F.slice(0,F.indexOf(">")));x=U.colspan?+U.colspan:1,((m=+U.rowspan)>1||x>1)&&C.push({s:{r:f,c:d},e:{r:f+(m||1)-1,c:d+x-1}});var G=U.t||U["data-t"]||"";if(!S.length){d+=x;continue}if(S=O_(S),y.s.r>f&&(y.s.r=f),y.e.r<f&&(y.e.r=f),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!S.length){d+=x;continue}var R={t:"s",v:S};r.raw||!S.trim().length||G=="s"||(S==="TRUE"?R={t:"b",v:!0}:S==="FALSE"?R={t:"b",v:!1}:isNaN(Aa(S))?isNaN(lo(S).getDate())||(R={t:"d",v:Sr(S)},r.cellDates||(R={t:"n",v:sn(R.v)}),R.z=r.dateNF||dt[14]):R={t:"n",v:Aa(S)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=R):n[ht({r:f,c:d})]=R,d+=x}}}}return n["!ref"]=St(y),C.length&&(n["!merges"]=C),n}function $W(e,t,r,n){for(var A=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,u=0,f=0;f<A.length;++f)if(!(A[f].s.r>r||A[f].s.c>l)&&!(A[f].e.r<r||A[f].e.c<l)){if(A[f].s.r<r||A[f].s.c<l){o=-1;break}o=A[f].e.r-A[f].s.r+1,u=A[f].e.c-A[f].s.c+1;break}if(!(o<0)){var d=ht({r,c:l}),m=n.dense?(e[r]||[])[l]:e[d],x=m&&m.v!=null&&(m.h||bx(m.w||(rs(m),m.w)||""))||"",y={};o>1&&(y.rowspan=o),u>1&&(y.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(y["data-t"]=m&&m.t||"z",m.v!=null&&(y["data-v"]=m.v),m.z!=null&&(y["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),y.id=(n.id||"sjs")+"-"+d,s.push(Pe("td",x,y))}}var C="<tr>";return C+s.join("")+"</tr>"}var ZW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',eq="</body></html>";function tq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ti(N2(r[0],t),t);var n=nv();return r.forEach(function(A,s){Av(n,N2(A,t),"Sheet"+(s+1))}),n}function rq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pb(e,t){var r=t||{},n=r.header!=null?r.header:ZW,A=r.footer!=null?r.footer:eq,s=[n],l=sA(e["!ref"]);r.dense=Array.isArray(e),s.push(rq(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push($W(e,l,o,r));return s.push("</table>"+A),s.join("")}function xb(e,t,r){var n=r||{},A=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")A=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;A=l.r,s=l.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:A,c:s}};if(e["!ref"]){var d=sA(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),A==-1&&(f.e.r=A=d.e.r+1)}var m=[],x=0,y=e["!rows"]||(e["!rows"]=[]),C=0,E=0,T=0,_=0,F=0,S=0;for(e["!cols"]||(e["!cols"]=[]);C<o.length&&E<u;++C){var I=o[C];if(I2(I)){if(n.display)continue;y[E]={hidden:!0}}var M=I.children;for(T=_=0;T<M.length;++T){var Q=M[T];if(!(n.display&&I2(Q))){var U=Q.hasAttribute("data-v")?Q.getAttribute("data-v"):Q.hasAttribute("v")?Q.getAttribute("v"):O_(Q.innerHTML),G=Q.getAttribute("data-z")||Q.getAttribute("z");for(x=0;x<m.length;++x){var R=m[x];R.s.c==_+s&&R.s.r<E+A&&E+A<=R.e.r&&(_=R.e.c+1-s,x=-1)}S=+Q.getAttribute("colspan")||1,((F=+Q.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:E+A,c:_+s},e:{r:E+A+(F||1)-1,c:_+s+(S||1)-1}});var te={t:"s",v:U},ne=Q.getAttribute("data-t")||Q.getAttribute("t")||"";U!=null&&(U.length==0?te.t=ne||"z":n.raw||U.trim().length==0||ne=="s"||(U==="TRUE"?te={t:"b",v:!0}:U==="FALSE"?te={t:"b",v:!1}:isNaN(Aa(U))?isNaN(lo(U).getDate())||(te={t:"d",v:Sr(U)},n.cellDates||(te={t:"n",v:sn(te.v)}),te.z=n.dateNF||dt[14]):te={t:"n",v:Aa(U)})),te.z===void 0&&G!=null&&(te.z=G);var ee="",ae=Q.getElementsByTagName("A");if(ae&&ae.length)for(var Se=0;Se<ae.length&&!(ae[Se].hasAttribute("href")&&(ee=ae[Se].getAttribute("href"),ee.charAt(0)!="#"));++Se);ee&&ee.charAt(0)!="#"&&(te.l={Target:ee}),n.dense?(e[E+A]||(e[E+A]=[]),e[E+A][_+s]=te):e[ht({c:_+s,r:E+A})]=te,f.e.c<_+s&&(f.e.c=_+s),_+=S}}++E}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,E-1+A),e["!ref"]=St(f),E>=u&&(e["!fullref"]=St((f.e.r=o.length-C+E-1+A,f))),e}function vb(e,t){var r=t||{},n=r.dense?[]:{};return xb(n,e,t)}function nq(e,t){return ti(vb(e,t),t)}function I2(e){var t="",r=Aq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Aq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function aq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,A){return Array(parseInt(A,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Xt(t.replace(/<[^>]*>/g,""));return[r]}var Q2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function wb(e,t){var r=t||{},n=Fx(e),A=[],s,l,o={name:""},u="",f=0,d,m,x={},y=[],C=r.dense?[]:{},E,T,_={value:""},F="",S=0,I=[],M=-1,Q=-1,U={s:{r:1e6,c:1e7},e:{r:0,c:0}},G=0,R={},te=[],ne={},ee=0,ae=0,Se=[],Te=1,q=1,oe=[],Re={Names:[]},ie={},Me=["",""],X=[],k={},K="",P=0,z=!1,Z=!1,le=0;for(iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=iu.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(U.e.c>=U.s.c&&U.e.r>=U.s.r?C["!ref"]=St(U):C["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=U.e.r&&(C["!fullref"]=C["!ref"],U.e.r=r.sheetRows-1,C["!ref"]=St(U)),te.length&&(C["!merges"]=te),Se.length&&(C["!rows"]=Se),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),x[d.name]=C,Z=!1):E[0].charAt(E[0].length-2)!=="/"&&(d=gt(E[0],!1),M=Q=-1,U.s.r=U.s.c=1e7,U.e.r=U.e.c=0,C=r.dense?[]:{},te=[],Se=[],Z=!0);break;case"table-row-group":E[1]==="/"?--G:++G;break;case"table-row":case"":if(E[1]==="/"){M+=Te,Te=1;break}if(m=gt(E[0],!1),m.?M=m.-1:M==-1&&(M=0),Te=+m["number-rows-repeated"]||1,Te<10)for(le=0;le<Te;++le)G>0&&(Se[M+le]={level:G});Q=-1;break;case"covered-table-cell":E[1]!=="/"&&++Q,r.sheetStubs&&(r.dense?(C[M]||(C[M]=[]),C[M][Q]={t:"z"}):C[ht({r:M,c:Q})]={t:"z"}),F="",I=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++Q,_=gt(E[0],!1),q=parseInt(_["number-columns-repeated"]||"1",10),T={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(T.f=F2(Xt(_.formula))),(_.||_["value-type"])=="string"&&(T.t="s",T.v=Xt(_["string-value"]||""),r.dense?(C[M]||(C[M]=[]),C[M][Q]=T):C[ht({r:M,c:Q})]=T),Q+=q-1;else if(E[1]!=="/"){++Q,F="",S=0,I=[],q=1;var Ce=Te?M+Te-1:M;if(Q>U.e.c&&(U.e.c=Q),Q<U.s.c&&(U.s.c=Q),M<U.s.r&&(U.s.r=M),Ce>U.e.r&&(U.e.r=Ce),_=gt(E[0],!1),X=[],k={},T={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=Xt(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(ee=parseInt(_["number-matrix-rows-spanned"],10)||0,ae=parseInt(_["number-matrix-columns-spanned"],10)||0,ne={s:{r:M,c:Q},e:{r:M+ee-1,c:Q+ae-1}},T.F=St(ne),oe.push([ne,T.F])),_.formula)T.f=F2(_.formula);else for(le=0;le<oe.length;++le)M>=oe[le][0].s.r&&M<=oe[le][0].e.r&&Q>=oe[le][0].s.c&&Q<=oe[le][0].e.c&&(T.F=oe[le][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(ee=parseInt(_["number-rows-spanned"],10)||0,ae=parseInt(_["number-columns-spanned"],10)||0,ne={s:{r:M,c:Q},e:{r:M+ee-1,c:Q+ae-1}},te.push(ne)),_["number-columns-repeated"]&&(q=parseInt(_["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=Tr(_["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(_.value);break;case"percentage":T.t="n",T.v=parseFloat(_.value);break;case"currency":T.t="n",T.v=parseFloat(_.value);break;case"date":T.t="d",T.v=Sr(_["date-value"]),r.cellDates||(T.t="n",T.v=sn(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=N7(_["time-value"])/86400,r.cellDates&&(T.t="d",T.v=Od(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(_.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",_["string-value"]!=null&&(F=Xt(_["string-value"]),I=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(z=!1,T.t==="s"&&(T.v=F||"",I.length&&(T.R=I),z=S==0),ie.Target&&(T.l=ie),X.length>0&&(T.c=X,X=[]),F&&r.cellText!==!1&&(T.w=F),z&&(T.t="z",delete T.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var he=0;he<Te;++he){if(q=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(C[M+he]||(C[M+he]=[]),C[M+he][Q]=he==0?T:_r(T);--q>0;)C[M+he][Q+q]=_r(T);else for(C[ht({r:M+he,c:Q})]=T;--q>0;)C[ht({r:M+he,c:Q+q})]=_r(T);U.e.c<=Q&&(U.e.c=Q)}q=parseInt(_["number-columns-repeated"]||"1",10),Q+=q-1,q=0,T={},F="",I=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((s=A.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&A.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((s=A.pop())[0]!==E[3])throw"Bad state: "+s;k.t=F,I.length&&(k.R=I),k.a=K,X.push(k)}else E[0].charAt(E[0].length-2)!=="/"&&A.push([E[3],!1]);K="",P=0,F="",S=0,I=[];break;case"creator":E[1]==="/"?K=n.slice(P,E.index):P=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((s=A.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&A.push([E[3],!1]);F="",S=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(R[o.name]=u,(s=A.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&(u="",o=gt(E[0],!1),A.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(A[A.length-1][0]){case"time-style":case"date-style":l=gt(E[0],!1),u+=Q2[E[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(A[A.length-1][0]){case"time-style":case"date-style":l=gt(E[0],!1),u+=Q2[E[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(A[A.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,E.index);break}else f=E.index+E[0].length;break;case"named-range":l=gt(E[0],!1),Me=Rm(l["cell-range-address"]);var Ae={Name:l.name,Ref:Me[0]+"!"+Me[1]};Z&&(Ae.Sheet=y.length),Re.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(A[A.length-1][0])>-1)break;if(E[1]==="/"&&(!_||!_["string-value"])){var ce=aq(n.slice(S,E.index));F=(F.length>0?F+`
`:"")+ce[0]}else gt(E[0],!1),S=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{Me=Rm(gt(E[0])["target-range-address"]),x[Me[0]]["!autofilter"]={ref:Me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ie=gt(E[0],!1),!ie.href)break;ie.Target=Xt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Me=Rm(ie.Target.slice(1)),ie.Target="#"+Me[0]+"!"+Me[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var L={Sheets:x,SheetNames:y,Workbook:Re};return r.bookSheets&&delete L.Sheets,L}function R2(e,t){t=t||{},LA(e,"META-INF/manifest.xml")&&N9(Zr(e,"META-INF/manifest.xml"),t);var r=xA(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=wb(pr(r),t);return LA(e,"meta.xml")&&(n.Props=c4(Zr(e,"meta.xml"))),n}function D2(e,t){return wb(e,t)}var sq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Xr+t}})(),M2=(function(){var e=function(s){return ir(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var u=[];u.push('      <table:table table:name="'+ir(l.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,d=0,m=sA(s["!ref"]||"A1"),x=s["!merges"]||[],y=0,C=Array.isArray(s);if(s["!cols"])for(d=0;d<=m.e.c;++d)u.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var E="",T=s["!rows"]||[];for(f=0;f<m.s.r;++f)E=T[f]?' table:style-name="ro'+T[f].ods+'"':"",u.push("        <table:table-row"+E+`></table:table-row>
`);for(;f<=m.e.r;++f){for(E=T[f]?' table:style-name="ro'+T[f].ods+'"':"",u.push("        <table:table-row"+E+`>
`),d=0;d<m.s.c;++d)u.push(t);for(;d<=m.e.c;++d){var _=!1,F={},S="";for(y=0;y!=x.length;++y)if(!(x[y].s.c>d)&&!(x[y].s.r>f)&&!(x[y].e.c<d)&&!(x[y].e.r<f)){(x[y].s.c!=d||x[y].s.r!=f)&&(_=!0),F["table:number-columns-spanned"]=x[y].e.c-x[y].s.c+1,F["table:number-rows-spanned"]=x[y].e.r-x[y].s.r+1;break}if(_){u.push(r);continue}var I=ht({r:f,c:d}),M=C?(s[f]||[])[d]:s[I];if(M&&M.f&&(F["table:formula"]=ir(SX(M.f)),M.F&&M.F.slice(0,I.length)==I)){var Q=sA(M.F);F["table:number-matrix-columns-spanned"]=Q.e.c-Q.s.c+1,F["table:number-matrix-rows-spanned"]=Q.e.r-Q.s.r+1}if(!M){u.push(t);continue}switch(M.t){case"b":S=M.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=M.v?"true":"false";break;case"n":S=M.w||String(M.v||0),F["office:value-type"]="float",F["office:value"]=M.v||0;break;case"s":case"str":S=M.v==null?"":M.v,F["office:value-type"]="string";break;case"d":S=M.w||Sr(M.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=Sr(M.v).toISOString(),F["table:style-name"]="ce1";break;default:u.push(t);continue}var U=e(S);if(M.l&&M.l.Target){var G=M.l.Target;G=G.charAt(0)=="#"?"#"+_X(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),U=Pe("text:a",U,{"xlink:href":G.replace(/&/g,"&amp;")})}u.push("          "+Pe("table:table-cell",Pe("text:p",U,{}),F)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},A=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var m=f["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Ws(m),m.ods=o;var x=f["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++o}}});var u=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=u;var m=f["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var u=[Xr],f=su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=su({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+f+d+`>
`),u.push(o4().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),A(u,l),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var m=0;m!=l.SheetNames.length;++m)u.push(n(l.Sheets[l.SheetNames[m]],l,m));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function yb(e,t){if(t.bookType=="fods")return M2(e,t);var r=Tx(),n="",A=[],s=[];return n="mimetype",bt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",bt(r,n,M2(e,t)),A.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",bt(r,n,sq(e,t)),A.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",bt(r,n,Xr+o4()),A.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",bt(r,n,R9(s)),A.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",bt(r,n,I9(A)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Vi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function jp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):pr(ei(e))}function iq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):pA(pa(e))}function lq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function $s(e){var t=e.reduce(function(A,s){return A+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(A){r.set(A,n),n+=A.length}),r}function L2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function oq(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,A=t+13;A>=t;--A)n=n*256+e[A];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function cq(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,A=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;A>=1;++s,A/=256)e[t+s]=A&255;e[t+15]|=r>=0?0:128}function hu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ar(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Lr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function qt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],A=hu(e,r),s=A&7;A=Math.floor(A/8);var l=0,o;if(A==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=hu(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(A," at offset ").concat(n))}var f={data:o,type:s};t[A]==null?t[A]=[f]:t[A].push(f)}return t}function wn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(A){A.data&&(t.push(ar(n*8+A.type)),A.type==2&&t.push(ar(A.data.length)),t.push(A.data))})}),$s(t)}function $x(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function RA(e){for(var t,r=[],n=[0];n[0]<e.length;){var A=hu(e,n),s=qt(e.slice(n[0],n[0]+A));n[0]+=A;var l={id:Lr(s[1][0].data),messages:[]};s[2].forEach(function(o){var u=qt(o.data),f=Lr(u[3][0].data);l.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=s[3])!=null&&t[0]&&(l.merge=Lr(s[3][0].data)>>>0>0),r.push(l)}return r}function Gl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ar(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ar(+!!r.merge),type:0}]);var A=[];r.messages.forEach(function(l){A.push(l.data),l.meta[3]=[{type:0,data:ar(l.data.length)}],n[2].push({data:wn(l.meta),type:2})});var s=wn(n);t.push(ar(s.length)),t.push(s),A.forEach(function(l){return t.push(l)})}),$s(t)}function uq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=hu(t,r),A=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}A.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var u=0,f=0;if(s==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),A=[$s(A)],u==0)throw new Error("Invalid offset 0");if(u>A[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(A.push(A[0].slice(-u)),f-=u;f>=A[A.length-1].length;)A.push(A[A.length-1]),f-=A[A.length-1].length;A.push(A[0].slice(-u,-u+f))}}var d=$s(A);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function DA(e){for(var t=[],r=0;r<e.length;){var n=e[r++],A=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(uq(n,e.slice(r,r+A))),r+=A}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $s(t)}function Vl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),A=new Uint8Array(4);t.push(A);var s=ar(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,A[0]=0,A[1]=l&255,A[2]=l>>8&255,A[3]=l>>16&255,r+=n}return $s(t)}function fq(e,t,r,n){var A=Vi(e),s=A.getUint32(4,!0),l=(n>1?12:8)+L2(s&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);s&512&&(o=A.getUint32(l,!0),l+=4),l+=L2(s&(n>1?12288:4096))*4,s&16&&(u=A.getUint32(l,!0),l+=4),s&32&&(f=A.getFloat64(l,!0),l+=8),s&64&&(d.setTime(d.getTime()+A.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function dq(e,t,r){var n=Vi(e),A=n.getUint32(8,!0),s=12,l=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);A&1&&(u=oq(e,s),s+=16),A&2&&(f=n.getFloat64(s,!0),s+=8),A&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),A&8&&(o=n.getUint32(s,!0),s+=4),A&16&&(l=n.getUint32(s,!0),s+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[o]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(A&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(A&31," : ").concat(e.slice(0,4)))}return m}function Mm(e,t){var r=new Uint8Array(32),n=Vi(r),A=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,cq(r,A,e.v),s|=1,A+=16;break;case"b":r[1]=6,n.setFloat64(A,e.v?1:0,!0),s|=2,A+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(A,t.indexOf(e.v),!0),s|=8,A+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,A)}function Lm(e,t){var r=new Uint8Array(32),n=Vi(r),A=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(A,e.v,!0),s|=32,A+=8;break;case"b":r[2]=6,n.setFloat64(A,e.v?1:0,!0),s|=32,A+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(A,t.indexOf(e.v),!0),s|=16,A+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,A)}function hq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return fq(e,t,r,e[0]);case 5:return dq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Nn(e){var t=qt(e);return hu(t[1][0].data)}function H2(e,t){var r=qt(t.data),n=Lr(r[1][0].data),A=r[3],s=[];return(A||[]).forEach(function(l){var o=qt(l.data),u=Lr(o[1][0].data)>>>0;switch(n){case 1:s[u]=jp(o[3][0].data);break;case 8:{var f=e[Nn(o[9][0].data)][0],d=qt(f.data),m=e[Nn(d[1][0].data)][0],x=Lr(m.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var y=qt(m.data);s[u]=y[3].map(function(C){return jp(C.data)}).join("")}break}}),s}function gq(e,t){var r,n,A,s,l,o,u,f,d,m,x,y,C,E,T=qt(e),_=Lr(T[1][0].data)>>>0,F=Lr(T[2][0].data)>>>0,S=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&Lr(T[8][0].data)>0||!1,I,M;if((s=(A=T[7])==null?void 0:A[0])!=null&&s.data&&t!=0)I=(o=(l=T[7])==null?void 0:l[0])==null?void 0:o.data,M=(f=(u=T[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(d=T[4])==null?void 0:d[0])!=null&&m.data&&t!=1)I=(y=(x=T[4])==null?void 0:x[0])==null?void 0:y.data,M=(E=(C=T[3])==null?void 0:C[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var Q=S?4:1,U=Vi(I),G=[],R=0;R<I.length/2;++R){var te=U.getUint16(R*2,!0);te<65535&&G.push([R,te])}if(G.length!=F)throw"Expected ".concat(F," cells, found ").concat(G.length);var ne=[];for(R=0;R<G.length-1;++R)ne[G[R][0]]=M.subarray(G[R][1]*Q,G[R+1][1]*Q);return G.length>=1&&(ne[G[G.length-1][0]]=M.subarray(G[G.length-1][1]*Q)),{R:_,cells:ne}}function mq(e,t){var r,n=qt(t.data),A=(r=n==null?void 0:n[7])!=null&&r[0]?Lr(n[7][0].data)>>>0>0?1:0:-1,s=$x(n[5],function(l){return gq(l,A)});return{nrows:Lr(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(u,f){if(l[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));l[o.R][f]=u}),l},[])}}function pq(e,t,r){var n,A=qt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Lr(A[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(A[6][0].data));if(s.e.c=(Lr(A[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(A[7][0].data));r["!ref"]=St(s);var l=qt(A[4][0].data),o=H2(e,e[Nn(l[4][0].data)][0]),u=(n=l[17])!=null&&n[0]?H2(e,e[Nn(l[17][0].data)][0]):[],f=qt(l[3][0].data),d=0;f[1].forEach(function(m){var x=qt(m.data),y=e[Nn(x[2][0].data)][0],C=Lr(y.meta[1][0].data);if(C!=6002)throw new Error("6001 unexpected reference to ".concat(C));var E=mq(e,y);E.data.forEach(function(T,_){T.forEach(function(F,S){var I=ht({r:d+_,c:S}),M=hq(F,o,u);M&&(r[I]=M)})}),d+=E.nrows})}function xq(e,t){var r=qt(t.data),n={"!ref":"A1"},A=e[Nn(r[2][0].data)],s=Lr(A[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return pq(e,A[0],n),n}function vq(e,t){var r,n=qt(t.data),A={name:(r=n[1])!=null&&r[0]?jp(n[1][0].data):"",sheets:[]},s=$x(n[2],Nn);return s.forEach(function(l){e[l].forEach(function(o){var u=Lr(o.meta[1][0].data);u==6e3&&A.sheets.push(xq(e,o))})}),A}function wq(e,t){var r=nv(),n=qt(t.data),A=$x(n[1],Nn);if(A.forEach(function(s){e[s].forEach(function(l){var o=Lr(l.meta[1][0].data);if(o==2){var u=vq(e,l);u.sheets.forEach(function(f,d){Av(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hm(e){var t,r,n,A,s={},l=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=DA(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var d;try{d=RA(f)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){s[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var o=((A=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:A[0].data)&&Lr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(u){s[u].forEach(function(f){var d=Lr(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return wq(s,o)}function yq(e,t,r){var n,A,s,l;if(!((n=e[6])!=null&&n[0])||!((A=e[7])!=null&&A[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Lr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,f=Vi(e[7][0].data),d=0,m=[],x=Vi(e[4][0].data),y=0,C=[],E=0;E<t.length;++E){if(t[E]==null){f.setUint16(E*2,65535,!0),x.setUint16(E*2,65535);continue}f.setUint16(E*2,d,!0),x.setUint16(E*2,y,!0);var T,_;switch(typeof t[E]){case"string":T=Mm({t:"s",v:t[E]},r),_=Lm({t:"s",v:t[E]},r);break;case"number":T=Mm({t:"n",v:t[E]},r),_=Lm({t:"n",v:t[E]},r);break;case"boolean":T=Mm({t:"b",v:t[E]},r),_=Lm({t:"b",v:t[E]},r);break;default:throw new Error("Unsupported value "+t[E])}m.push(T),d+=T.length,C.push(_),y+=_.length,++u}for(e[2][0].data=ar(u);E<e[7][0].data.length/2;++E)f.setUint16(E*2,65535,!0),x.setUint16(E*2,65535,!0);return e[6][0].data=$s(m),e[3][0].data=$s(C),u}function Bq(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=sA(r["!ref"]);n.s.r=n.s.c=0;var A=!1;n.e.c>9&&(A=!0,n.e.c=9),n.e.r>49&&(A=!0,n.e.r=49),A&&console.error("The Numbers writer is currently limited to ".concat(St(n)));var s=hd(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(K){return K.forEach(function(P){typeof P=="string"&&l.push(P)})});var o={},u=[],f=lt.read(t.numbers,{type:"base64"});f.FileIndex.map(function(K,P){return[K,f.FullPaths[P]]}).forEach(function(K){var P=K[0],z=K[1];if(P.type==2&&P.name.match(/\.iwa/)){var Z=P.content,le=DA(Z),Ce=RA(le);Ce.forEach(function(he){u.push(he.id),o[he.id]={deps:[],location:z,type:Lr(he.messages[0].meta[1][0].data)}})}}),u.sort(function(K,P){return K-P});var d=u.filter(function(K){return K>1}).map(function(K){return[K,ar(K)]});f.FileIndex.map(function(K,P){return[K,f.FullPaths[P]]}).forEach(function(K){var P=K[0];if(K[1],!!P.name.match(/\.iwa/)){var z=RA(DA(P.content));z.forEach(function(Z){Z.messages.forEach(function(le){d.forEach(function(Ce){Z.messages.some(function(he){return Lr(he.meta[1][0].data)!=11006&&lq(he.data,Ce[1])})&&o[Ce[0]].deps.push(Z.id)})})})}});for(var m=lt.find(f,o[1].location),x=RA(DA(m.content)),y,C=0;C<x.length;++C){var E=x[C];E.id==1&&(y=E)}var T=Nn(qt(y.messages[0].data)[1][0].data);for(m=lt.find(f,o[T].location),x=RA(DA(m.content)),C=0;C<x.length;++C)E=x[C],E.id==T&&(y=E);for(T=Nn(qt(y.messages[0].data)[2][0].data),m=lt.find(f,o[T].location),x=RA(DA(m.content)),C=0;C<x.length;++C)E=x[C],E.id==T&&(y=E);for(T=Nn(qt(y.messages[0].data)[2][0].data),m=lt.find(f,o[T].location),x=RA(DA(m.content)),C=0;C<x.length;++C)E=x[C],E.id==T&&(y=E);var _=qt(y.messages[0].data);{_[6][0].data=ar(n.e.r+1),_[7][0].data=ar(n.e.c+1);var F=Nn(_[46][0].data),S=lt.find(f,o[F].location),I=RA(DA(S.content));{for(var M=0;M<I.length&&I[M].id!=F;++M);if(I[M].id!=F)throw"Bad ColumnRowUIDMapArchive";var Q=qt(I[M].messages[0].data);Q[1]=[],Q[2]=[],Q[3]=[];for(var U=0;U<=n.e.c;++U){var G=[];G[1]=G[2]=[{type:0,data:ar(U+420690)}],Q[1].push({type:2,data:wn(G)}),Q[2].push({type:0,data:ar(U)}),Q[3].push({type:0,data:ar(U)})}Q[4]=[],Q[5]=[],Q[6]=[];for(var R=0;R<=n.e.r;++R)G=[],G[1]=G[2]=[{type:0,data:ar(R+726270)}],Q[4].push({type:2,data:wn(G)}),Q[5].push({type:0,data:ar(R)}),Q[6].push({type:0,data:ar(R)});I[M].messages[0].data=wn(Q)}S.content=Vl(Gl(I)),S.size=S.content.length,delete _[46];var te=qt(_[4][0].data);{te[7][0].data=ar(n.e.r+1);var ne=qt(te[1][0].data),ee=Nn(ne[2][0].data);S=lt.find(f,o[ee].location),I=RA(DA(S.content));{if(I[0].id!=ee)throw"Bad HeaderStorageBucket";var ae=qt(I[0].messages[0].data);for(R=0;R<s.length;++R){var Se=qt(ae[2][0].data);Se[1][0].data=ar(R),Se[4][0].data=ar(s[R].length),ae[2][R]={type:ae[2][0].type,data:wn(Se)}}I[0].messages[0].data=wn(ae)}S.content=Vl(Gl(I)),S.size=S.content.length;var Te=Nn(te[2][0].data);S=lt.find(f,o[Te].location),I=RA(DA(S.content));{if(I[0].id!=Te)throw"Bad HeaderStorageBucket";for(ae=qt(I[0].messages[0].data),U=0;U<=n.e.c;++U)Se=qt(ae[2][0].data),Se[1][0].data=ar(U),Se[4][0].data=ar(n.e.r+1),ae[2][U]={type:ae[2][0].type,data:wn(Se)};I[0].messages[0].data=wn(ae)}S.content=Vl(Gl(I)),S.size=S.content.length;var q=Nn(te[4][0].data);(function(){for(var K=lt.find(f,o[q].location),P=RA(DA(K.content)),z,Z=0;Z<P.length;++Z){var le=P[Z];le.id==q&&(z=le)}var Ce=qt(z.messages[0].data);{Ce[3]=[];var he=[];l.forEach(function(L,je){he[1]=[{type:0,data:ar(je)}],he[2]=[{type:0,data:ar(1)}],he[3]=[{type:2,data:iq(L)}],Ce[3].push({type:2,data:wn(he)})})}z.messages[0].data=wn(Ce);var Ae=Gl(P),ce=Vl(Ae);K.content=ce,K.size=K.content.length})();var oe=qt(te[3][0].data);{var Re=oe[1][0];delete oe[2];var ie=qt(Re.data);{var Me=Nn(ie[2][0].data);(function(){for(var K=lt.find(f,o[Me].location),P=RA(DA(K.content)),z,Z=0;Z<P.length;++Z){var le=P[Z];le.id==Me&&(z=le)}var Ce=qt(z.messages[0].data);{delete Ce[6],delete oe[7];var he=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var Ae=0,ce=0;ce<=n.e.r;++ce){var L=qt(he);Ae+=yq(L,s[ce],l),L[1][0].data=ar(ce),Ce[5].push({data:wn(L),type:2})}Ce[1]=[{type:0,data:ar(n.e.c+1)}],Ce[2]=[{type:0,data:ar(n.e.r+1)}],Ce[3]=[{type:0,data:ar(Ae)}],Ce[4]=[{type:0,data:ar(n.e.r+1)}]}z.messages[0].data=wn(Ce);var je=Gl(P),Je=Vl(je);K.content=Je,K.size=K.content.length})()}Re.data=wn(ie)}te[3][0].data=wn(oe)}_[4][0].data=wn(te)}y.messages[0].data=wn(_);var X=Gl(x),k=Vl(X);return m.content=k,m.size=m.content.length,f}function Bb(e){return function(r){for(var n=0;n!=e.length;++n){var A=e[n];r[A[0]]===void 0&&(r[A[0]]=A[1]),A[2]==="n"&&(r[A[0]]=Number(r[A[0]]))}}}function Zx(e){Bb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ev(e){Bb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Cq(e){return Qt.WS.indexOf(e)>-1?"sheet":e==Qt.CS?"chart":e==Qt.DS?"dialog":e==Qt.MS?"macro":e&&e.length?e:"sheet"}function Eq(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Cq(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Tq(e,t,r,n,A,s,l,o,u,f,d,m){try{s[n]=jc(xA(e,r,!0),t);var x=Zr(e,t),y;switch(o){case"sheet":y=XY(x,t,A,u,s[n],f,d,m);break;case"chart":if(y=JY(x,t,A,u,s[n],f,d,m),!y||!y["!drawel"])break;var C=Qc(y["!drawel"].Target,t),E=lu(C),T=Qj(xA(e,C,!0),jc(xA(e,E,!0),C)),_=Qc(T,C),F=lu(_);y=yY(xA(e,_,!0),_,u,jc(xA(e,F,!0),_),f,y);break;case"macro":y=YY(x,t,A,u,s[n],f,d,m);break;case"dialog":y=WY(x,t,A,u,s[n],f,d,m);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=y;var S=[];s&&s[n]&&Hr(s[n]).forEach(function(I){var M="";if(s[n][I].Type==Qt.CMNT){M=Qc(s[n][I].Target,t);var Q=eW(Zr(e,M,!0),M,u);if(!Q||!Q.length)return;E2(y,Q,!1)}s[n][I].Type==Qt.TCMNT&&(M=Qc(s[n][I].Target,t),S=S.concat(Dj(Zr(e,M,!0),u)))}),S&&S.length&&E2(y,S,!0,u.people||[])}catch(I){if(u.WTF)throw I}}function NA(e){return e.charAt(0)=="/"?e.slice(1):e}function Sq(e,t){if(wo(),t=t||{},Zx(t),LA(e,"META-INF/manifest.xml")||LA(e,"objectdata.xml"))return R2(e,t);if(LA(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hm<"u"){if(e.FileIndex)return Hm(e);var r=lt.utils.cfb_new();return jE(e).forEach(function(Se){bt(r,Se,M7(e,Se))}),Hm(r)}throw new Error("Unsupported NUMBERS file")}if(!LA(e,"[Content_Types].xml"))throw LA(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):LA(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=jE(e),A=U9(xA(e,"[Content_Types].xml")),s=!1,l,o;if(A.workbooks.length===0&&(o="xl/workbook.xml",Zr(e,o,!0)&&A.workbooks.push(o)),A.workbooks.length===0){if(o="xl/workbook.bin",!Zr(e,o,!0))throw new Error("Could not find workbook");A.workbooks.push(o),s=!0}A.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(zc=[],A.sst)try{zc=ZY(Zr(e,NA(A.sst)),A.sst,t)}catch(Se){if(t.WTF)throw Se}t.cellStyles&&A.themes.length&&(u=$Y(xA(e,A.themes[0].replace(/^\//,""),!0)||"",A.themes[0],t)),A.style&&(f=qY(Zr(e,NA(A.style)),A.style,u,t))}A.links.map(function(Se){try{var Te=jc(xA(e,lu(NA(Se))),Se);return rW(Zr(e,NA(Se)),Te,Se,t)}catch{}});var d=zY(Zr(e,NA(A.workbooks[0])),A.workbooks[0],t),m={},x="";A.coreprops.length&&(x=Zr(e,NA(A.coreprops[0]),!0),x&&(m=c4(x)),A.extprops.length!==0&&(x=Zr(e,NA(A.extprops[0]),!0),x&&M9(x,m,t)));var y={};(!t.bookSheets||t.bookProps)&&A.custprops.length!==0&&(x=xA(e,NA(A.custprops[0]),!0),x&&(y=H9(x,t)));var C={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(Te){return Te.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),t.bookProps&&(C.Props=m,C.Custprops=y),t.bookSheets&&typeof l<"u"&&(C.SheetNames=l),t.bookSheets?C.SheetNames:t.bookProps))return C;l={};var E={};t.bookDeps&&A.calcchain&&(E=tW(Zr(e,NA(A.calcchain)),A.calcchain));var T=0,_={},F,S;{var I=d.Sheets;m.Worksheets=I.length,m.SheetNames=[];for(var M=0;M!=I.length;++M)m.SheetNames[M]=I[M].name}var Q=s?"bin":"xml",U=A.workbooks[0].lastIndexOf("/"),G=(A.workbooks[0].slice(0,U+1)+"_rels/"+A.workbooks[0].slice(U+1)+".rels").replace(/^\//,"");LA(e,G)||(G="xl/_rels/workbook."+Q+".rels");var R=jc(xA(e,G,!0),G.replace(/_rels.*/,"s5s"));(A.metadata||[]).length>=1&&(t.xlmeta=nW(Zr(e,NA(A.metadata[0])),A.metadata[0],t)),(A.people||[]).length>=1&&(t.people=Lj(Zr(e,NA(A.people[0])),t)),R&&(R=Eq(R,d.Sheets));var te=Zr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=m.Worksheets;++T){var ne="sheet";if(R&&R[T]?(F="xl/"+R[T][1].replace(/[\/]?xl\//,""),LA(e,F)||(F=R[T][1]),LA(e,F)||(F=G.replace(/_rels\/.*$/,"")+R[T][1]),ne=R[T][2]):(F="xl/worksheets/sheet"+(T+1-te)+"."+Q,F=F.replace(/sheet0\./,"sheet.")),S=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(T!=t.sheets)continue e;break;case"string":if(m.SheetNames[T].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ee=!1,ae=0;ae!=t.sheets.length;++ae)typeof t.sheets[ae]=="number"&&t.sheets[ae]==T&&(ee=1),typeof t.sheets[ae]=="string"&&t.sheets[ae].toLowerCase()==m.SheetNames[T].toLowerCase()&&(ee=1);if(!ee)continue e}}Tq(e,F,S,m.SheetNames[T],T,_,l,ne,t,d,u,f)}return C={Directory:A,Workbook:d,Props:m,Custprops:y,Deps:E,Sheets:l,SheetNames:m.SheetNames,Strings:zc,Styles:f,Themes:u,SSF:_r(dt)},t&&t.bookFiles&&(e.files?(C.keys=n,C.files=e.files):(C.keys=[],C.files={},e.FullPaths.forEach(function(Se,Te){Se=Se.replace(/^Root Entry[\/]/,""),C.keys.push(Se),C.files[Se]=e.FileIndex[Te]}))),t&&t.bookVBA&&(A.vba.length>0?C.vbaraw=Zr(e,NA(A.vba[0]),!0):A.defaults&&A.defaults.bin===zj&&(C.vbaraw=Zr(e,"xl/vbaProject.bin",!0))),C}function _q(e,t){var r=t||{},n="Workbook",A=lt.find(e,n);try{if(n="/!DataSpaces/Version",A=lt.find(e,n),!A||!A.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(nK(A.content),n="/!DataSpaces/DataSpaceMap",A=lt.find(e,n),!A||!A.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=aK(A.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",A=lt.find(e,n),!A||!A.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=sK(A.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",A=lt.find(e,n),!A||!A.content)throw new Error("ECMA-376 Encrypted file missing "+n);lK(A.content)}catch{}if(n="/EncryptionInfo",A=lt.find(e,n),!A||!A.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=oK(A.content);if(n="/EncryptedPackage",A=lt.find(e,n),!A||!A.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],A.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],A.content,r.password||"",r);throw new Error("File is password-protected")}function bq(e,t){return t.bookType=="ods"?yb(e,t):t.bookType=="numbers"?Bq(e,t):t.bookType=="xlsb"?Fq(e,t):Uq(e,t)}function Fq(e,t){Zl=1024,e&&!e.SSF&&(e.SSF=_r(dt)),e&&e.SSF&&(wo(),Md(e.SSF),t.revssf=Hd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Y4.indexOf(t.bookType)>-1,A=Hx();ev(t=t||{});var s=Tx(),l="",o=0;if(t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",bt(s,l,u4(e.Props,t)),A.coreprops.push(l),sr(t.rels,2,l,Qt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,bt(s,l,h4(e.Props)),A.extprops.push(l),sr(t.rels,3,l,Qt.EXT_PROPS),e.Custprops!==e.Props&&Hr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",bt(s,l,g4(e.Custprops)),A.custprops.push(l),sr(t.rels,4,l,Qt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,bt(s,l,aW(o-1,l,t,e,d)),A.sheets.push(l),sr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Qt.WS[0])}if(m){var y=m["!comments"],C=!1,E="";y&&y.length>0&&(E="xl/comments"+o+"."+r,bt(s,E,lW(y,E)),A.comments.push(E),sr(d,-1,"../comments"+o+"."+r,Qt.CMNT),C=!0),m["!legacy"]&&C&&bt(s,"xl/drawings/vmlDrawing"+o+".vml",X4(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&bt(s,lu(l),Ao(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,bt(s,l,iW(t.Strings,l,t)),A.strs.push(l),sr(t.wbrels,-1,"sharedStrings."+r,Qt.SST)),l="xl/workbook."+r,bt(s,l,AW(e,l)),A.workbooks.push(l),sr(t.rels,1,l,Qt.WB),l="xl/theme/theme1.xml",bt(s,l,jx(e.Themes,t)),A.themes.push(l),sr(t.wbrels,-1,"theme/theme1.xml",Qt.THEME),l="xl/styles."+r,bt(s,l,sW(e,l,t)),A.styles.push(l),sr(t.wbrels,-1,"styles."+r,Qt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",bt(s,l,e.vbaraw),A.vba.push(l),sr(t.wbrels,-1,"vbaProject.bin",Qt.VBA)),l="xl/metadata."+r,bt(s,l,oW(l)),A.metadata.push(l),sr(t.wbrels,-1,"metadata."+r,Qt.XLMETA),bt(s,"[Content_Types].xml",l4(A,t)),bt(s,"_rels/.rels",Ao(t.rels)),bt(s,"xl/_rels/workbook."+r+".rels",Ao(t.wbrels)),delete t.revssf,delete t.ssf,s}function Uq(e,t){Zl=1024,e&&!e.SSF&&(e.SSF=_r(dt)),e&&e.SSF&&(wo(),Md(e.SSF),t.revssf=Hd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Y4.indexOf(t.bookType)>-1,A=Hx();ev(t=t||{});var s=Tx(),l="",o=0;if(t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",bt(s,l,u4(e.Props,t)),A.coreprops.push(l),sr(t.rels,2,l,Qt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,bt(s,l,h4(e.Props)),A.extprops.push(l),sr(t.rels,3,l,Qt.EXT_PROPS),e.Custprops!==e.Props&&Hr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",bt(s,l,g4(e.Custprops)),A.custprops.push(l),sr(t.rels,4,l,Qt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},x=e.Sheets[e.SheetNames[o-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,bt(s,l,sb(o-1,t,e,m)),A.sheets.push(l),sr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Qt.WS[0])}if(x){var C=x["!comments"],E=!1,T="";if(C&&C.length>0){var _=!1;C.forEach(function(F){F[1].forEach(function(S){S.T==!0&&(_=!0)})}),_&&(T="xl/threadedComments/threadedComment"+o+"."+r,bt(s,T,Mj(C,d,t)),A.threadedcomments.push(T),sr(m,-1,"../threadedComments/threadedComment"+o+"."+r,Qt.TCMNT)),T="xl/comments"+o+"."+r,bt(s,T,J4(C)),A.comments.push(T),sr(m,-1,"../comments"+o+"."+r,Qt.CMNT),E=!0}x["!legacy"]&&E&&bt(s,"xl/drawings/vmlDrawing"+o+".vml",X4(o,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&bt(s,lu(l),Ao(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,bt(s,l,R4(t.Strings,t)),A.strs.push(l),sr(t.wbrels,-1,"sharedStrings."+r,Qt.SST)),l="xl/workbook."+r,bt(s,l,ub(e)),A.workbooks.push(l),sr(t.rels,1,l,Qt.WB),l="xl/theme/theme1.xml",bt(s,l,jx(e.Themes,t)),A.themes.push(l),sr(t.wbrels,-1,"theme/theme1.xml",Qt.THEME),l="xl/styles."+r,bt(s,l,V4(e,t)),A.styles.push(l),sr(t.wbrels,-1,"styles."+r,Qt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",bt(s,l,e.vbaraw),A.vba.push(l),sr(t.wbrels,-1,"vbaProject.bin",Qt.VBA)),l="xl/metadata."+r,bt(s,l,z4()),A.metadata.push(l),sr(t.wbrels,-1,"metadata."+r,Qt.XLMETA),d.length>1&&(l="xl/persons/person.xml",bt(s,l,Hj(d)),A.people.push(l),sr(t.wbrels,-1,"persons/person.xml",Qt.PEOPLE)),bt(s,"[Content_Types].xml",l4(A,t)),bt(s,"_rels/.rels",Ao(t.rels)),bt(s,"xl/_rels/workbook."+r+".rels",Ao(t.wbrels)),delete t.revssf,delete t.ssf,s}function tv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=wA(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function kq(e,t){return lt.find(e,"EncryptedPackage")?_q(e,t):gb(e,t)}function Nq(e,t){var r,n=e,A=t||{};return A.type||(A.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r=M_(n,A),Sq(r,A)}function Cb(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vp(e.slice(r),t);default:break e}return oo.to_workbook(e,t)}function Iq(e,t){var r="",n=tv(e,t);switch(t.type){case"base64":r=wA(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Hi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pr(r)),t.type="binary",Cb(r,t)}function Qq(e,t){var r=e;return t.type=="base64"&&(r=wA(r)),r=ru.utils.decode(1200,r.slice(2),"str"),t.type="binary",Cb(r,t)}function Rq(e){return e.match(/[^\x00-\x7F]/)?pa(e):e}function Om(e,t,r,n){return n?(r.type="string",oo.to_workbook(e,r)):oo.to_workbook(t,r)}function zp(e,t){wx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return zp(new Uint8Array(e),(r=_r(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,A=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),so={},r.dateNF&&(so.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=F7(e),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Rq(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=_r(r),r.type="array",zp(yx(n),r)}switch((A=tv(n,r))[0]){case 208:if(A[1]===207&&A[2]===17&&A[3]===224&&A[4]===161&&A[5]===177&&A[6]===26&&A[7]===225)return kq(lt.read(n,r),r);break;case 9:if(A[1]<=8)return gb(n,r);break;case 60:return Vp(n,r);case 73:if(A[1]===73&&A[2]===42&&A[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(A[1]===68)return OV(n,r);break;case 84:if(A[1]===65&&A[2]===66&&A[3]===76)return I4.to_workbook(n,r);break;case 80:return A[1]===75&&A[2]<9&&A[3]<9?Nq(n,r):Om(e,n,r,s);case 239:return A[3]===60?Vp(n,r):Om(e,n,r,s);case 255:if(A[1]===254)return Qq(n,r);if(A[1]===0&&A[2]===2&&A[3]===0)return Di.to_workbook(n,r);break;case 0:if(A[1]===0&&(A[2]>=2&&A[3]===0||A[2]===0&&(A[3]===8||A[3]===9)))return Di.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Gp.to_workbook(n,r);case 123:if(A[1]===92&&A[2]===114&&A[3]===116)return O4.to_workbook(n,r);break;case 10:case 13:case 32:return Iq(n,r);case 137:if(A[1]===80&&A[2]===78&&A[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return HV.indexOf(A[0])>-1&&A[2]<=12&&A[3]<=31?Gp.to_workbook(n,r):Om(e,n,r,s)}function Eb(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return wu(t.file,lt.write(e,{type:kt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return lt.write(e,t)}function Dq(e,t){var r=_r(t||{}),n=bq(e,r);return Mq(n,r)}function Mq(e,t){var r={},n=kt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var A=e.FullPaths?lt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof A=="string"){if(t.type=="binary"||t.type=="base64")return A;A=new Uint8Array(Dd(A))}return t.password&&typeof encrypt_agile<"u"?Eb(encrypt_agile(A,t.password),t):t.type==="file"?wu(t.file,A):t.type=="string"?pr(A):A}function Lq(e,t){var r=t||{},n=RW(e,r);return Eb(n,r)}function ma(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return nu(pa(n));case"binary":return pa(n);case"string":return e;case"file":return wu(t.file,n,"utf8");case"buffer":return kt?ss(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ma(n,{type:"binary"}).split("").map(function(A){return A.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Hq(e,t){switch(t.type){case"base64":return nu(e);case"binary":return e;case"string":return e;case"file":return wu(t.file,e,"binary");case"buffer":return kt?ss(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ef(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?nu(r):t.type=="string"?pr(r):r;case"file":return wu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Tb(e,t){wx(),kY(e);var r=_r(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Tb(e,r);return r.type="array",Dd(n)}var A=0;if(r.sheet&&(typeof r.sheet=="number"?A=r.sheet:A=e.SheetNames.indexOf(r.sheet),!e.SheetNames[A]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ma(bW(e,r),r);case"slk":case"sylk":return ma(N4.from_sheet(e.Sheets[e.SheetNames[A]],r),r);case"htm":case"html":return ma(pb(e.Sheets[e.SheetNames[A]],r),r);case"txt":return Hq(Sb(e.Sheets[e.SheetNames[A]],r),r);case"csv":return ma(rv(e.Sheets[e.SheetNames[A]],r),r,"\uFEFF");case"dif":return ma(I4.from_sheet(e.Sheets[e.SheetNames[A]],r),r);case"dbf":return Ef(Gp.from_sheet(e.Sheets[e.SheetNames[A]],r),r);case"prn":return ma(oo.from_sheet(e.Sheets[e.SheetNames[A]],r),r);case"rtf":return ma(O4.from_sheet(e.Sheets[e.SheetNames[A]],r),r);case"eth":return ma(Q4.from_sheet(e.Sheets[e.SheetNames[A]],r),r);case"fods":return ma(yb(e,r),r);case"wk1":return Ef(Di.sheet_to_wk1(e.Sheets[e.SheetNames[A]],r),r);case"wk3":return Ef(Di.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ef(mb(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Lq(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Dq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Oq(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Wc(e,t,r){var n={};return n.type="file",n.file=t,Oq(n),Tb(e,n)}function Pq(e,t,r,n,A,s,l,o){var u=zr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,x=A===1?[]:{};if(A!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||e[r])for(var y=t.s.c;y<=t.e.c;++y){var C=l?e[r][y]:e[n[y]+u];if(C===void 0||C.t===void 0){if(f===void 0)continue;s[y]!=null&&(x[s[y]]=f);continue}var E=C.v;switch(C.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+C.t)}if(s[y]!=null){if(E==null)if(C.t=="e"&&E===null)x[s[y]]=null;else if(f!==void 0)x[s[y]]=f;else if(d&&E===null)x[s[y]]=null;else continue;else x[s[y]]=d&&(C.t!=="n"||C.t==="n"&&o.rawNumbers!==!1)?E:rs(C,E,o);E!=null&&(m=!1)}}return{row:x,isempty:m}}function hd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,A=1,s=[],l=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=Jt(d);break;case"number":u=Jt(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(A=0);var m=zr(u.s.r),x=[],y=[],C=0,E=0,T=Array.isArray(e),_=u.s.r,F=0,S={};T&&!e[_]&&(e[_]=[]);var I=f.skipHidden&&e["!cols"]||[],M=f.skipHidden&&e["!rows"]||[];for(F=u.s.c;F<=u.e.c;++F)if(!(I[F]||{}).hidden)switch(x[F]=Ir(F),r=T?e[_][F]:e[x[F]+m],n){case 1:s[F]=F-u.s.c;break;case 2:s[F]=x[F];break;case 3:s[F]=f.header[F-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=rs(r,null,f),E=S[l]||0,!E)S[l]=1;else{do o=l+"_"+E++;while(S[o]);S[l]=E,S[o]=1}s[F]=o}for(_=u.s.r+A;_<=u.e.r;++_)if(!(M[_]||{}).hidden){var Q=Pq(e,u,_,x,n,s,T,f);(Q.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(y[C++]=Q.row)}return y.length=C,y}var O2=/"/g;function Gq(e,t,r,n,A,s,l,o){for(var u=!0,f=[],d="",m=zr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var y=o.dense?(e[r]||[])[x]:e[n[x]+m];if(y==null)d="";else if(y.v!=null){u=!1,d=""+(o.rawNumbers&&y.t=="n"?y.v:rs(y,null,o));for(var C=0,E=0;C!==d.length;++C)if((E=d.charCodeAt(C))===A||E===s||E===34||o.forceQuotes){d='"'+d.replace(O2,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(u=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(O2,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(l)}function rv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var A=Jt(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],C=A.s.c;C<=A.e.c;++C)(x[C]||{}).hidden||(m[C]=Ir(C));for(var E=0,T=A.s.r;T<=A.e.r;++T)(y[T]||{}).hidden||(d=Gq(e,A,T,m,l,u,s,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((E++?o:"")+d)));return delete n.dense,r.join("")}function Sb(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=rv(e,t);return r}function Vq(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var A=Jt(e["!ref"]),s="",l=[],o,u=[],f=Array.isArray(e);for(o=A.s.c;o<=A.e.c;++o)l[o]=Ir(o);for(var d=A.s.r;d<=A.e.r;++d)for(s=zr(d),o=A.s.c;o<=A.e.c;++o)if(t=l[o]+s,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function _b(e,t,r){var n=r||{},A=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var u=typeof n.origin=="string"?Qr(n.origin):n.origin;l=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+A}};if(s["!ref"]){var m=Jt(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(l=m.e.r+1,d.e.r=l+t.length-1+A)}else l==-1&&(l=0,d.e.r=t.length-1+A);var x=n.header||[],y=0;t.forEach(function(E,T){Hr(E).forEach(function(_){(y=x.indexOf(_))==-1&&(x[y=x.length]=_);var F=E[_],S="z",I="",M=ht({c:o+y,r:l+T+A});f=gu(s,M),F&&typeof F=="object"&&!(F instanceof Date)?s[M]=F:(typeof F=="number"?S="n":typeof F=="boolean"?S="b":typeof F=="string"?S="s":F instanceof Date?(S="d",n.cellDates||(S="n",F=sn(F)),I=n.dateNF||dt[14]):F===null&&n.nullError&&(S="e",F=0),f?(f.t=S,f.v=F,delete f.w,delete f.R,I&&(f.z=I)):s[M]=f={t:S,v:F},I&&(f.z=I))})}),d.e.c=Math.max(d.e.c,o+x.length-1);var C=zr(l);if(A)for(y=0;y<x.length;++y)s[Ir(y+o)+C]={t:"s",v:x[y]};return s["!ref"]=St(d),s}function Kq(e,t){return _b(null,e,t)}function gu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?gu(e,ht(t)):gu(e,ht({r:t,c:r||0}))}function jq(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function nv(){return{SheetNames:[],Sheets:{}}}function Av(e,t,r,n){var A=1;if(!r)for(;A<=65535&&e.SheetNames.indexOf(r="Sheet"+A)!=-1;++A,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);A=s&&+s[2]||0;var l=s&&s[1]||r;for(++A;A<=65535&&e.SheetNames.indexOf(r=l+A)!=-1;++A);}if(cb(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function zq(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=jq(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Xq(e,t){return e.z=t,e}function bb(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Jq(e,t,r){return bb(e,"#"+t,r)}function Yq(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Wq(e,t,r,n){for(var A=typeof t!="string"?t:Jt(t),s=typeof t=="string"?t:St(t),l=A.s.r;l<=A.e.r;++l)for(var o=A.s.c;o<=A.e.c;++o){var u=gu(e,l,o);u.t="n",u.F=s,delete u.v,l==A.s.r&&o==A.s.c&&(u.f=r,n&&(u.D=!0))}return e}var kn={encode_col:Ir,encode_row:zr,encode_cell:ht,encode_range:St,decode_col:Ix,decode_row:Nx,split_cell:i9,decode_cell:Qr,decode_range:sA,format_cell:rs,sheet_add_aoa:t4,sheet_add_json:_b,sheet_add_dom:xb,aoa_to_sheet:yo,json_to_sheet:Kq,table_to_sheet:vb,table_to_book:nq,sheet_to_csv:rv,sheet_to_txt:Sb,sheet_to_json:hd,sheet_to_html:pb,sheet_to_formulae:Vq,sheet_to_row_object_array:hd,sheet_get_cell:gu,book_new:nv,book_append_sheet:Av,book_set_sheet_visibility:zq,cell_set_number_format:Xq,cell_set_hyperlink:bb,cell_set_internal_link:Jq,cell_add_comment:Yq,sheet_set_array_formula:Wq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const P2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),G2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:g.jsx("path",{d:"M21.16,3.16a1.2,1.2,0,0,0-.81-.29H3.65A1.2,1.2,0,0,0,2.45,4.07V19.93a1.2,1.2,0,0,0,1.2,1.2h16.7a1.2,1.2,0,0,0,1.2-1.2V4.07a1.2,1.2,0,0,0-.39-.91ZM14.21,12.19,11.83,15a.34.34,0,0,1-.31.18.33.33,0,0,1-.3-.17l-2.4-2.82a.33.33,0,0,1,.24-.53h1.37a.33.33,0,0,1,.3.17l1,1.18,1-1.18a.33.33,0,0,1,.3-.17h1.37a.33.33,0,0,1,.24.53Z"})}),Tf=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),V2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),Pm=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),K2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),Gm=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),j2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),qq=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Sf=({title:e,value:t,icon:r,colorClass:n})=>g.jsxs("div",{className:`p-6 rounded-xl border shadow-sm flex items-center justify-between transition-transform hover:scale-[1.02] ${n}`,children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium opacity-80 uppercase tracking-wide",children:e}),g.jsx("p",{className:"text-3xl font-bold mt-2",children:t})]}),g.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:r})]}),$q=()=>{const{user:e}=zi(),[t,r]=W.useState([]),[n,A]=W.useState([]),[s,l]=W.useState(!0),[o,u]=W.useState([]),[f,d]=W.useState(!0),[m,x]=W.useState(null),[y,C]=W.useState([]),E=W.useRef({}),[T,_]=W.useState("overview"),[F,S]=W.useState(""),[I,M]=W.useState(null),Q=W.useRef({}),[U,G]=W.useState([]),[R,te]=W.useState([]),[ne,ee]=W.useState({mode:"closed"}),[ae,Se]=W.useState(!1),[Te,q]=W.useState({name:"",rows:"8",cols:"10"}),[oe,Re]=W.useState(""),[ie,Me]=W.useState({subject:"",studentCount:""}),[X,k]=W.useState(""),K=W.useCallback(async()=>{if(!e)return;l(!0);const[ue,Ve]=await Promise.all([lS(e.id),DL()]);r(ue),A(Ve),l(!1)},[e]),P=W.useCallback(async()=>{if(!e)return;d(!0);const ue=await OL(e.id);u(ue),d(!1)},[e]),z=W.useCallback(async()=>{if(!e)return;const ue=await zL(e.id);G(ue)},[e]),Z=W.useCallback(async()=>{if(!e)return;const ue=await YL(e.id);te(ue)},[e]),le=W.useCallback(async()=>{if(!e)return;const ue=await kL(e.id);C(ue)},[e]);W.useEffect(()=>{K(),P(),z(),Z(),le()},[K,P,z,Z,le]);const Ce=async ue=>{e&&(await ML(ue,e.id),K(),le())},he=async ue=>{await LL(ue),K(),le()},Ae=async(ue,Ve)=>{e&&window.confirm(`Are you sure you want to permanently delete the account for "${Ve}"? This action cannot be undone and will also delete all exams created by this teacher.`)&&(await HL(ue,e.id)?(await K(),await P(),await le()):alert("Failed to delete teacher. Ensure you have the correct permissions."))},ce=async ue=>{e&&window.confirm("Are you sure you want to permanently delete this exam? This action cannot be undone.")&&(await oS(ue,e.id,e.role)?((m==null?void 0:m.id)===ue&&x(null),await P(),await le()):alert("Failed to delete exam."))},L=async(ue,Ve)=>{const Et=E.current[ue];if(!Et||!m)return;const vt=Et.style.boxShadow;Et.style.boxShadow="none";const Ut=await Pc(Et,{scale:2,backgroundColor:"#ffffff"});Et.style.boxShadow=vt;const nt=Ut.toDataURL("image/png"),pt=document.createElement("a"),Nt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),yt=Ve.replace(/[^a-z0-9]/gi,"_").toLowerCase();pt.download=`${Nt}_${yt}_plan.png`,pt.href=nt,document.body.appendChild(pt),pt.click(),document.body.removeChild(pt)},je=ue=>{ue.seatingPlan&&(Q.current={},M(ue.id))},Je=ue=>{if(!ue.seatingPlan){alert("This exam does not have a seating plan to export.");return}const Ve=kn.book_new();ue.halls.forEach(vt=>{var Or,yr;const Ut=ue.seatingPlan[vt.id];if(!Ut)return;const nt=Ut.reduce((or,Tn)=>Math.max(or,Tn.length),0),pt=[""];for(let or=0;or<nt;or++)pt.push(`Col ${or+1}`);const Nt=[pt];for(let or=0;or<Ut.length;or++){const Tn=[`Row ${or+1}`];for(let Pn=0;Pn<nt;Pn++){const hn=(Or=Ut[or])==null?void 0:Or[Pn];Tn.push(((yr=hn==null?void 0:hn.student)==null?void 0:yr.id)||"")}Nt.push(Tn)}const yt=kn.aoa_to_sheet(Nt),rr=vt.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);kn.book_append_sheet(Ve,yt,rr)});const Et=ue.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Wc(Ve,`${Et}_seating_plan.xlsx`)},et=ue=>{var Or,yr;if(!m||!m.seatingPlan){alert("Seating plan not available for this hall.");return}const Ve=m.seatingPlan[ue.id];if(!Ve)return;const Et=kn.book_new(),vt=Ve.reduce((or,Tn)=>Math.max(or,Tn.length),0),Ut=[""];for(let or=0;or<vt;or++)Ut.push(`Col ${or+1}`);const nt=[Ut];for(let or=0;or<Ve.length;or++){const Tn=[`Row ${or+1}`];for(let Pn=0;Pn<vt;Pn++){const hn=(Or=Ve[or])==null?void 0:Or[Pn];Tn.push(((yr=hn==null?void 0:hn.student)==null?void 0:yr.id)||"")}nt.push(Tn)}const pt=kn.aoa_to_sheet(nt),Nt=ue.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);kn.book_append_sheet(Et,pt,Nt);const yt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),rr=ue.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Wc(Et,`${yt}_${rr}_plan.xlsx`)},qe=async ue=>{ne.mode==="create-template"&&ue.name&&e&&(await Rc({name:ue.name,layout:ue.layout},e.id),await z(),le()),ee({mode:"closed"})},De=async ue=>{if(ue.preventDefault(),!e)return;Re("");const{name:Ve,rows:Et,cols:vt}=Te,Ut=parseInt(Et,10),nt=parseInt(vt,10);if(!Ve.trim()){Re("Template name cannot be empty.");return}if(U.some(Nt=>Nt.name.toLowerCase()===Ve.trim().toLowerCase())){Re("A template with this name already exists.");return}if(isNaN(Ut)||Ut<=0||Ut>50||isNaN(nt)||nt<=0||nt>50){Re("Rows and columns must be numbers between 1 and 50.");return}const pt=[];for(let Nt=0;Nt<Ut;Nt++)for(let yt=0;yt<nt;yt++)pt.push({id:`seat-${Nt}-${yt}-${Date.now()}`,row:Nt,col:yt,type:"standard"});await Rc({name:Ve.trim(),layout:pt},e.id),await z(),le(),Se(!1),q({name:"",rows:"8",cols:"10"})},ct=async ue=>{e&&window.confirm("Are you sure you want to delete this hall template? This cannot be undone.")&&(await cS(ue,e.id,e.role)?await z():alert("Failed to delete template. You may not have permission."))},Kt=async ue=>{if(ue.preventDefault(),k(""),!e)return;const{subject:Ve,studentCount:Et}=ie,vt=parseInt(Et,10);if(!Ve.trim()){k("Subject/code cannot be empty.");return}if(isNaN(vt)||vt<=0){k("Student count must be a positive number.");return}if(R.some(Ut=>Ut.subject.toLowerCase()===Ve.trim().toLowerCase())){k("A template with this subject/code already exists.");return}await lp({subject:Ve.trim(),studentCount:vt},e.id),Me({subject:"",studentCount:""}),await Z(),le()},lr=async ue=>{e&&window.confirm("Are you sure you want to delete this student set template? This cannot be undone.")&&(await uS(ue,e.id,e.role)?await Z():alert("Failed to delete template. You may not have permission."))},jt=o.find(ue=>ue.id===I);W.useEffect(()=>{if(!jt||!jt.seatingPlan)return;const ue=setTimeout(async()=>{const Ve=Object.entries(Q.current).filter(([,vt])=>vt!==null);if(Ve.length!==jt.halls.length){M(null);return}const Et=Ve.map(async([vt,Ut])=>{const nt=jt.halls.find(yr=>yr.id===vt);if(!Ut||!nt)return;Ut.style.boxShadow="none";const pt=await Pc(Ut,{scale:2,backgroundColor:"#ffffff"});Ut.style.boxShadow="";const Nt=pt.toDataURL("image/png"),yt=document.createElement("a"),rr=jt.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),Or=nt.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();yt.download=`${rr}_${Or}_plan.png`,yt.href=Nt,document.body.appendChild(yt),yt.click(),document.body.removeChild(yt)});await Promise.all(Et),M(null)},100);return()=>clearTimeout(ue)},[I,jt]);const Ct=ue=>{var Ve;return e&&e.id===ue?`${e.name} (Admin)`:((Ve=[...t].find(Et=>Et.id===ue))==null?void 0:Ve.name)||"Unknown User"};if(m)return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"min-h-screen",children:[g.jsx(za,{}),g.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx(rt,{onClick:()=>x(null),variant:"secondary",children:" Back to Dashboard"}),g.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[m.seatingPlan&&g.jsxs(g.Fragment,{children:[g.jsx(rt,{onClick:()=>je(m),disabled:!!I,variant:"secondary",className:"flex items-center",children:I===m.id?"Downloading...":g.jsxs(g.Fragment,{children:[g.jsx(P2,{className:"mr-2 h-4 w-4"})," Download PNGs"]})}),g.jsxs(rt,{onClick:()=>Je(m),className:"flex items-center",children:[g.jsx(G2,{className:"mr-2 h-4 w-4"}),"Download Excel"]})]}),g.jsx(rt,{onClick:()=>ce(m.id),variant:"danger",children:"Delete Exam"})]})]}),g.jsx(zt,{className:"mb-6",children:g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-2xl font-bold text-violet-700 dark:text-violet-400",children:m.title}),g.jsxs("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:["Date: ",m.date]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-300",children:"Created by:"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:Ct(m.createdBy)})]})]})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[g.jsxs(zt,{children:[g.jsxs("h4",{className:"text-lg font-semibold mb-3 border-b pb-2 dark:border-slate-700",children:["Halls (",m.halls.length,")"]}),g.jsx("ul",{className:"space-y-2 text-sm",children:m.halls.map(ue=>g.jsxs("li",{className:"flex justify-between p-2 bg-slate-50 dark:bg-slate-700/50 rounded",children:[g.jsx("span",{children:ue.name}),g.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[ue.layout.filter(Ve=>Ve.type!=="faculty").length," seats"]})]},ue.id))})]}),g.jsxs(zt,{children:[g.jsxs("h4",{className:"text-lg font-semibold mb-3 border-b pb-2 dark:border-slate-700",children:["Student Sets (",m.studentSets.length,")"]}),g.jsx("ul",{className:"space-y-2 text-sm",children:m.studentSets.map(ue=>g.jsxs("li",{className:"flex justify-between p-2 bg-slate-50 dark:bg-slate-700/50 rounded",children:[g.jsx("span",{children:ue.subject}),g.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[ue.studentCount," students"]})]},ue.id))})]})]}),g.jsx("div",{className:"lg:col-span-2 space-y-8",children:m.seatingPlan?m.halls.map(ue=>g.jsxs(zt,{ref:Ve=>{Ve&&(E.current[ue.id]=Ve)},children:[g.jsx($c,{hall:ue,plan:m.seatingPlan,studentSets:m.studentSets}),g.jsxs("div",{className:"text-center mt-4 flex justify-center gap-2",children:[g.jsxs(rt,{onClick:()=>L(ue.id,ue.name),variant:"secondary",className:"flex items-center mx-auto !py-1 !px-3 text-sm",children:[g.jsx(P2,{className:"mr-2 h-4 w-4"})," Download PNG"]}),g.jsxs(rt,{onClick:()=>et(ue),variant:"secondary",className:"flex items-center mx-auto !py-1 !px-3 text-sm",children:[g.jsx(G2,{className:"mr-2 h-4 w-4"})," Download Excel"]})]})]},ue.id)):g.jsxs(zt,{children:[g.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Seating Arrangement"}),g.jsx("div",{className:"text-center text-slate-500 dark:text-slate-400 py-10",children:g.jsx("p",{children:"No seating plan has been generated for this exam yet."})})]})})]})]})]}),jt&&jt.id===m.id&&jt.seatingPlan&&g.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px",zIndex:-1},children:jt.halls.map(ue=>g.jsx("div",{ref:Ve=>{Ve&&(Q.current[ue.id]=Ve)},style:{width:"800px",padding:"1px"},children:g.jsx(zt,{children:g.jsx($c,{hall:ue,plan:jt.seatingPlan,studentSets:jt.studentSets})})},ue.id))})]});const wr=t.filter(ue=>ue.name.toLowerCase().includes(F.toLowerCase())||ue.email.toLowerCase().includes(F.toLowerCase())),mt=o.filter(ue=>ue.title.toLowerCase().includes(F.toLowerCase()));return g.jsxs("div",{className:"min-h-screen",children:[g.jsx(za,{}),ne.mode==="create-template"&&g.jsx(up,{isOpen:!0,onClose:()=>ee({mode:"closed"}),onSave:qe,initialLayout:[],isTemplateCreationMode:!0}),ae&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:()=>Se(!1),children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md",onClick:ue=>ue.stopPropagation(),children:[g.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Grid Hall Template"}),g.jsxs("form",{onSubmit:De,children:[g.jsxs("div",{className:"space-y-4",children:[g.jsx(It,{label:"Template Name",id:"grid-template-name",value:Te.name,onChange:ue=>q({...Te,name:ue.target.value}),required:!0,placeholder:"e.g., Small Classroom"}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsx(It,{label:"Rows",id:"grid-template-rows",type:"number",min:"1",max:"50",value:Te.rows,onChange:ue=>q({...Te,rows:ue.target.value}),required:!0}),g.jsx(It,{label:"Columns",id:"grid-template-cols",type:"number",min:"1",max:"50",value:Te.cols,onChange:ue=>q({...Te,cols:ue.target.value}),required:!0})]}),oe&&g.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:oe})]}),g.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[g.jsx(rt,{type:"button",variant:"secondary",onClick:()=>Se(!1),children:"Cancel"}),g.jsx(rt,{type:"submit",children:"Save Template"})]})]})]})}),g.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"mb-8",children:[g.jsx("h2",{className:"text-3xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Admin Dashboard"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Manage your institution's teachers, exams, and templates."})]}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[g.jsx(Sf,{title:"Active Exams",value:o.length,icon:g.jsx(Gm,{className:"h-6 w-6 text-violet-600 dark:text-violet-300"}),colorClass:"bg-violet-50 border-violet-100 text-violet-900 dark:bg-violet-900/20 dark:border-violet-900/50 dark:text-violet-100"}),g.jsx(Sf,{title:"Managed Teachers",value:t.length,icon:g.jsx(Pm,{className:"h-6 w-6 text-blue-600 dark:text-blue-300"}),colorClass:"bg-blue-50 border-blue-100 text-blue-900 dark:bg-blue-900/20 dark:border-blue-900/50 dark:text-blue-100"}),g.jsx(Sf,{title:"Templates",value:U.length+R.length,icon:g.jsx(K2,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-300"}),colorClass:"bg-emerald-50 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-900/50 dark:text-emerald-100"}),g.jsx(Sf,{title:"Pending Approvals",value:n.length,icon:g.jsx(V2,{className:"h-6 w-6 text-amber-600 dark:text-amber-300"}),colorClass:"bg-amber-50 border-amber-100 text-amber-900 dark:bg-amber-900/20 dark:border-amber-900/50 dark:text-amber-100"})]}),g.jsx("div",{className:"mb-6 border-b border-slate-200 dark:border-slate-700",children:g.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:["overview","teachers","exams","templates"].map(ue=>g.jsxs("button",{onClick:()=>{_(ue),S("")},className:`
                                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize transition-colors
                                    ${T===ue?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"}
                                `,children:[ue,ue==="teachers"&&n.length>0&&g.jsx("span",{className:"ml-2 bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200 py-0.5 px-2 rounded-full text-xs",children:n.length})]},ue))})}),g.jsxs("div",{className:"space-y-6",children:[T==="overview"&&g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsx("div",{className:"lg:col-span-2",children:g.jsxs(zt,{className:"h-full",children:[g.jsxs("h3",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:[g.jsx(qq,{className:"h-6 w-6 text-violet-500"})," Recent Activity"]}),g.jsx("div",{className:"max-h-[500px] overflow-y-auto pr-2 custom-scrollbar",children:y.length>0?g.jsx("div",{className:"relative border-l-2 border-slate-200 dark:border-slate-700 ml-3 space-y-6 py-2",children:y.map(ue=>g.jsxs("div",{className:"relative pl-6",children:[g.jsx("div",{className:`absolute -left-[9px] top-1 h-4 w-4 rounded-full border-4 border-white dark:border-slate-800 ${ue.role===xt.ADMIN?"bg-red-500":ue.role===xt.TEACHER?"bg-blue-500":"bg-green-500"}`}),g.jsxs("div",{children:[g.jsx("p",{className:"text-xs text-slate-400 mb-0.5 font-mono",children:new Date(ue.timestamp).toLocaleString()}),g.jsxs("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[g.jsx("span",{className:`${ue.role===xt.ADMIN?"text-red-600 dark:text-red-400":ue.role===xt.TEACHER?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400"} font-bold`,children:ue.actorName}),g.jsx("span",{className:"mx-1 text-slate-400",children:""}),ue.action.replace(/_/g," ")]}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:ue.details})]})]},ue.id))}):g.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 py-10 text-sm",children:"No activity logs found."})})]})}),g.jsx("div",{className:"lg:col-span-1",children:g.jsxs(zt,{className:"bg-gradient-to-br from-violet-50 to-white dark:from-slate-800 dark:to-slate-900 border-violet-100 dark:border-slate-700 h-full",children:[g.jsx("h3",{className:"text-lg font-bold mb-4 text-violet-900 dark:text-violet-100",children:"System Health"}),g.jsxs("ul",{className:"space-y-4",children:[g.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[g.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Total Exams"}),g.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-200",children:o.length})]}),g.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[g.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Generated Plans"}),g.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:o.filter(ue=>ue.seatingPlan).length})]}),g.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[g.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Pending Plans"}),g.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:o.filter(ue=>!ue.seatingPlan).length})]}),g.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[g.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Active Teachers"}),g.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:t.length})]})]})]})})]}),T==="teachers"&&g.jsxs("div",{className:"space-y-6",children:[n.length>0&&g.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-800 rounded-xl p-6 shadow-sm",children:[g.jsxs("h4",{className:"text-lg font-bold text-amber-800 dark:text-amber-200 mb-4 flex items-center gap-2",children:[g.jsx("div",{className:"p-1 bg-amber-200 dark:bg-amber-800 rounded-full",children:g.jsx(V2,{className:"h-4 w-4"})}),"Pending Approvals (",n.length,")"]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(ue=>g.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-amber-100 dark:border-slate-700 flex flex-col justify-between h-full",children:[g.jsxs("div",{className:"mb-3",children:[g.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200",children:ue.name}),g.jsx("p",{className:"text-sm text-slate-500 break-all",children:ue.email})]}),g.jsxs("div",{className:"flex gap-2 mt-auto",children:[g.jsx(rt,{variant:"primary",className:"flex-1 !py-1.5 !text-sm bg-emerald-600 hover:bg-emerald-700",onClick:()=>Ce(ue.id),children:"Approve"}),g.jsx(rt,{type:"button",variant:"danger",className:"!py-1.5 !px-3 !text-sm",onClick:Ve=>{Ve.stopPropagation(),Ae(ue.id,ue.name)},children:"Reject"})]})]},ue.id))})]}),g.jsxs(zt,{children:[g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[g.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[g.jsx(Pm,{className:"h-6 w-6 text-blue-500"})," Active Staff Directory"]}),g.jsxs("div",{className:"relative w-full sm:w-72",children:[g.jsx(It,{placeholder:"Search by name or email...",value:F,onChange:ue=>S(ue.target.value),containerClassName:"mb-0",className:"pl-10"}),g.jsx("div",{className:"absolute left-3 top-2.5 text-slate-400",children:g.jsx(j2,{className:"h-5 w-5"})})]})]}),s?g.jsx("p",{className:"text-center py-8",children:"Loading staff data..."}):g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[wr.map(ue=>g.jsxs("div",{className:"group relative p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl border border-transparent hover:border-violet-200 dark:hover:border-slate-600 transition-all shadow-sm hover:shadow-md",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[g.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center text-sm font-bold text-white flex-shrink-0 shadow-sm ${ue.permissionGranted?"bg-gradient-to-br from-blue-500 to-blue-600":"bg-red-400"}`,children:ue.name.charAt(0)}),g.jsxs("div",{className:"overflow-hidden",children:[g.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200 truncate",title:ue.name,children:ue.name}),g.jsx("p",{className:"text-xs text-slate-500 truncate",title:ue.email,children:ue.email})]})]}),g.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-200 dark:border-slate-700",children:[g.jsx("button",{onClick:()=>ue.permissionGranted?he(ue.id):Ce(ue.id),className:`px-3 py-1 text-xs rounded-md border transition-colors ${ue.permissionGranted?"border-amber-200 text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20":"border-emerald-200 text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20"}`,children:ue.permissionGranted?"Revoke Access":"Grant Access"}),g.jsx("button",{type:"button",onClick:Ve=>{Ve.stopPropagation(),Ae(ue.id,ue.name)},className:"p-1 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors",title:"Delete Account",children:g.jsx(Tf,{className:"h-4 w-4"})})]})]},ue.id)),wr.length===0&&g.jsx("p",{className:"col-span-full text-center py-12 text-slate-500 italic",children:"No teachers found matching your search."})]})]})]}),T==="exams"&&g.jsxs(zt,{children:[g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[g.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[g.jsx(Gm,{className:"h-6 w-6 text-violet-500"})," Exam Schedules"]}),g.jsxs("div",{className:"relative w-full sm:w-72",children:[g.jsx(It,{placeholder:"Search exams by title...",value:F,onChange:ue=>S(ue.target.value),containerClassName:"mb-0",className:"pl-10"}),g.jsx("div",{className:"absolute left-3 top-2.5 text-slate-400",children:g.jsx(j2,{className:"h-5 w-5"})})]})]}),f?g.jsx("p",{className:"text-center py-8",children:"Loading exams..."}):mt.length>0?g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:mt.map(ue=>g.jsxs("div",{className:"group relative flex flex-col justify-between p-5 bg-white border border-slate-200 hover:border-violet-300 hover:shadow-lg dark:bg-slate-800 dark:border-slate-700 dark:hover:border-violet-600 rounded-xl transition-all duration-200 cursor-pointer h-full",onClick:()=>x(ue),children:[g.jsxs("div",{className:"mb-4",children:[g.jsxs("div",{className:"flex justify-between items-start mb-2",children:[g.jsx("p",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 line-clamp-2",title:ue.title,children:ue.title}),g.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide flex-shrink-0 ${ue.seatingPlan?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-300"}`,children:ue.seatingPlan?"Generated":"Pending"})]}),g.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 space-y-1",children:[g.jsxs("p",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"opacity-70",children:""})," ",ue.date]}),g.jsxs("p",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"opacity-70",children:""})," ",Ct(ue.createdBy)]}),g.jsxs("p",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"opacity-70",children:""})," ",ue.halls.length," Halls"]})]})]}),g.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100 dark:border-slate-700 mt-auto",children:[g.jsx("div",{className:"text-xs text-slate-400 font-medium group-hover:text-violet-500 transition-colors",children:"View Details "}),g.jsx("button",{type:"button",className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",onClick:Ve=>{Ve.stopPropagation(),ce(ue.id)},title:"Delete Exam",children:g.jsx(Tf,{className:"h-5 w-5"})})]})]},ue.id))}):g.jsxs("div",{className:"text-center py-16 bg-slate-50 dark:bg-slate-800/50 rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-700",children:[g.jsx(Gm,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:"No exams found matching your criteria."})]})]}),T==="templates"&&g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[g.jsxs(zt,{className:"h-full",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[g.jsx(K2,{className:"h-5 w-5 text-emerald-500"})," Hall Layouts"]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx(rt,{variant:"secondary",className:"!py-1.5 !px-3 text-xs",onClick:()=>{Se(!0),Re(""),q({name:"",rows:"8",cols:"10"})},children:"+ New Grid"}),g.jsx(rt,{variant:"secondary",className:"!py-1.5 !px-3 text-xs",onClick:()=>ee({mode:"create-template"}),children:"+ Editor"})]})]}),g.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:[U.map(ue=>g.jsx("div",{className:"group relative p-4 bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-700 rounded-lg hover:shadow-md transition-all hover:border-emerald-300",children:g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200",children:ue.name}),g.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[ue.layout.length," seats defined"]}),g.jsxs("p",{className:"text-[10px] text-slate-400 mt-1",children:["Creator: ",Ct(ue.createdBy)]})]}),g.jsx("button",{type:"button",onClick:Ve=>{Ve.stopPropagation(),ct(ue.id)},className:"text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:"Delete Template",children:g.jsx(Tf,{className:"h-4 w-4"})})]})},ue.id)),U.length===0&&g.jsx("p",{className:"text-center text-sm text-slate-500 py-8 italic",children:"No hall templates created yet."})]})]}),g.jsxs(zt,{className:"h-full",children:[g.jsx("div",{className:"flex justify-between items-center mb-6",children:g.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[g.jsx(Pm,{className:"h-5 w-5 text-blue-500"})," Student Sets"]})}),g.jsxs("form",{onSubmit:Kt,className:"flex gap-2 mb-6 bg-slate-100 dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:[g.jsx("input",{className:"flex-grow px-3 py-1.5 text-sm rounded border border-slate-300 dark:bg-slate-700 dark:border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none",placeholder:"Subject (e.g. Math 101)",value:ie.subject,onChange:ue=>Me({...ie,subject:ue.target.value})}),g.jsx("input",{type:"number",className:"w-20 px-3 py-1.5 text-sm rounded border border-slate-300 dark:bg-slate-700 dark:border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none",placeholder:"#",value:ie.studentCount,onChange:ue=>Me({...ie,studentCount:ue.target.value})}),g.jsx(rt,{type:"submit",className:"!py-1.5 !px-3 text-sm whitespace-nowrap",children:"Add"})]}),X&&g.jsx("p",{className:"text-xs text-red-600 mb-3 -mt-4",children:X}),g.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:[R.map(ue=>g.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-700 rounded-lg hover:shadow-sm transition-all hover:border-blue-300",children:[g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-sm text-slate-800 dark:text-slate-200",children:ue.subject}),g.jsxs("p",{className:"text-xs text-slate-500",children:[ue.studentCount," students"]})]}),g.jsx("button",{type:"button",onClick:Ve=>{Ve.stopPropagation(),lr(ue.id)},className:"text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:"Delete Template",children:g.jsx(Tf,{className:"h-4 w-4"})})]},ue.id)),R.length===0&&g.jsx("p",{className:"text-center text-sm text-slate-500 py-8 italic",children:"No student set templates created yet."})]})]})]})]})]})]})},Zq=({label:e,id:t,containerClassName:r="",...n})=>g.jsxs("div",{className:r,children:[e&&g.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:e}),g.jsx("textarea",{id:t,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:placeholder-slate-400 dark:focus:ring-violet-400 dark:focus:border-violet-400",rows:4,...n})]}),e$=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),t$=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),r$=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),n$=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),A$=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),a$=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),s$=({isOpen:e,onClose:t,onSave:r,initialPlan:n,halls:A,studentSets:s,seatDimensions:l})=>{var z;const[o,u]=W.useState(n),[f,d]=W.useState(((z=A[0])==null?void 0:z.id)||""),[m,x]=W.useState(new Set),[y,C]=W.useState(null),[E,T]=W.useState(null),[_,F]=W.useState([]),[S,I]=W.useState([]),[M,Q]=W.useState(-1),[U,G]=W.useState(null);W.useEffect(()=>{var Z;if(e){const le={};Object.keys(n).forEach(he=>{le[he]=n[he].map(Ae=>Ae.map(ce=>({...ce})))}),u(le),d(((Z=A[0])==null?void 0:Z.id)||""),F([]),x(new Set),G(null);const Ce={plan:JSON.parse(JSON.stringify(le)),holdingStudents:[]};I([Ce]),Q(0)}},[e,n,A]);const R=(Z,le)=>{const Ce={plan:JSON.parse(JSON.stringify(Z)),holdingStudents:JSON.parse(JSON.stringify(le))},he=S.slice(0,M+1);he.push(Ce),he.length>50&&he.shift(),I(he),Q(he.length-1),u(Z),F(le)},te=W.useCallback(()=>{if(M>0){const Z=M-1,le=S[Z];u(JSON.parse(JSON.stringify(le.plan))),F(JSON.parse(JSON.stringify(le.holdingStudents))),Q(Z),x(new Set)}},[S,M]),ne=W.useCallback(()=>{if(M<S.length-1){const Z=M+1,le=S[Z];u(JSON.parse(JSON.stringify(le.plan))),F(JSON.parse(JSON.stringify(le.holdingStudents))),Q(Z),x(new Set)}},[S,M]);W.useEffect(()=>{const Z=le=>{e&&((le.metaKey||le.ctrlKey)&&le.key==="z"?(le.preventDefault(),le.shiftKey?ne():te()):(le.metaKey||le.ctrlKey)&&le.key==="y"&&(le.preventDefault(),ne()))};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[e,te,ne]);const ee=(Z,le,Ce)=>`${Z}-${le}-${Ce}`,ae=(Z,le,Ce,he,Ae)=>{if(Z.stopPropagation(),!Ae){Z.shiftKey||x(new Set);return}const ce=ee(le,Ce,he),L=new Set(Z.shiftKey?m:[]);L.has(ce)?L.delete(ce):L.add(ce),x(L)},Se=()=>{x(new Set)},Te=(Z,le,Ce,he,Ae)=>{const ce=ee(le,Ce,he);m.has(ce)||x(new Set([ce])),C({hallId:le,row:Ce,col:he,student:Ae}),T(null),Z.dataTransfer.effectAllowed="move",document.body.classList.add("cursor-grabbing")},q=(Z,le)=>{T(le),C(null),x(new Set),Z.dataTransfer.effectAllowed="move"},oe=()=>{document.body.classList.remove("cursor-grabbing")},Re=Z=>{Z.preventDefault(),Z.dataTransfer.dropEffect="move"},ie=(Z,le,Ce,he)=>{var Je;Z.preventDefault();const Ae=o[le];if(!Ae)return;const ce=(Je=Ae[Ce])==null?void 0:Je[he];if(!ce)return;const L={...o};let je=[..._];if(y){const et=Ce-y.row,qe=he-y.col,De=[],ct=[],Kt=(Ct,wr,mt)=>{var ue,Ve;return(Ve=(ue=L[Ct])==null?void 0:ue[wr])==null?void 0:Ve[mt]};for(const Ct of m){const[wr,mt,ue]=Ct.split("-"),Ve=parseInt(mt),Et=parseInt(ue),vt=Kt(wr,Ve,Et);if(vt&&vt.student){De.push({hallId:wr,row:Ve,col:Et,student:vt.student});const Ut=le,nt=Ve+et,pt=Et+qe,Nt=Kt(Ut,nt,pt);if(!Nt)return;ct.push({hallId:Ut,row:nt,col:pt,existingStudent:Nt.student})}}const lr=new Map;De.forEach((Ct,wr)=>{const mt=ct[wr];lr.set(ee(mt.hallId,mt.row,mt.col),Ct.student),mt.existingStudent?De.some(Ve=>Ve.hallId===mt.hallId&&Ve.row===mt.row&&Ve.col===mt.col)||lr.set(ee(Ct.hallId,Ct.row,Ct.col),mt.existingStudent):lr.has(ee(Ct.hallId,Ct.row,Ct.col))||lr.set(ee(Ct.hallId,Ct.row,Ct.col),void 0)}),lr.forEach((Ct,wr)=>{const[mt,ue,Ve]=wr.split("-"),Et=Kt(mt,parseInt(ue),parseInt(Ve));Et&&(Ct?Et.student=Ct:delete Et.student)});const jt=new Set;ct.forEach(Ct=>{jt.add(ee(Ct.hallId,Ct.row,Ct.col))}),x(jt),R(L,je)}else E&&(ce.student?(je=je.filter(et=>et.id!==E.id),je.push(ce.student),ce.student=E):(je=je.filter(et=>et.id!==E.id),ce.student=E),R(L,je));C(null),T(null)},Me=Z=>{if(Z.preventDefault(),y){const le={...o};let Ce=[..._];const he=[],Ae=new Set,ce=L=>(Ae.has(L)||(le[L]=le[L].map(je=>je.map(Je=>({...Je}))),Ae.add(L)),le[L]);if(m.size>0)m.forEach(L=>{var ct;const[je,Je,et]=L.split("-"),qe=ce(je),De=(ct=qe==null?void 0:qe[parseInt(Je)])==null?void 0:ct[parseInt(et)];De&&De.student&&(he.push(De.student),delete De.student)}),x(new Set);else{const je=ce(y.hallId)[y.row][y.col];je.student&&(he.push(je.student),delete je.student)}he.length>0&&(Ce=[...Ce,...he]),R(le,Ce)}C(null),T(null)},X=()=>{if(_.length>0){G(`Cannot save changes! There are ${_.length} students currently unseated in the holding area.`),setTimeout(()=>G(null),5e3);return}r(o),t()},k=Z=>{const le=s.findIndex(Ce=>Ce.id===Z);return le>=0?Os[le%Os.length]:"bg-gray-200"},K=()=>{if(!f)return;const Z=o[f],le=new Set;Z.forEach((Ce,he)=>{Ce.forEach((Ae,ce)=>{Ae&&Ae.student&&le.add(ee(f,he,ce))})}),x(le)};if(!e)return null;const P=l||{width:112,height:64,fontSize:12};return g.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex justify-center items-center z-50 p-4",onClick:t,children:g.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full h-full max-w-[95vw] max-h-[95vh] flex flex-col overflow-hidden relative",onClick:Z=>Z.stopPropagation(),children:[g.jsxs("header",{className:"bg-white dark:bg-slate-900 border-b dark:border-slate-800 flex flex-col sm:flex-row justify-between items-center px-6 py-3 gap-4 shadow-sm z-20",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:"p-2 bg-violet-100 dark:bg-violet-900/30 rounded-lg",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-violet-600 dark:text-violet-400",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Seating Editor"}),g.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 hidden sm:block",children:["Drag to move. ",g.jsx("kbd",{className:"bg-slate-200 dark:bg-slate-700 px-1 rounded font-mono",children:"Shift+Click"})," for multi-select."]})]})]}),g.jsx("div",{className:"flex overflow-x-auto max-w-lg p-1 bg-slate-100 dark:bg-slate-800 rounded-lg",children:A.map(Z=>g.jsx("button",{onClick:le=>{le.stopPropagation(),d(Z.id)},className:`px-4 py-2 text-sm font-semibold rounded-md transition-all whitespace-nowrap flex-1 ${f===Z.id?"bg-white dark:bg-slate-700 text-violet-600 dark:text-violet-400 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:Z.name},Z.id))}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("div",{className:"flex gap-1 mr-2 border-r dark:border-slate-700 pr-3",children:[g.jsx("button",{onClick:te,disabled:M<=0,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Undo (Ctrl+Z)",children:g.jsx(A$,{})}),g.jsx("button",{onClick:ne,disabled:M>=S.length-1,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Redo (Ctrl+Y)",children:g.jsx(a$,{})})]}),g.jsx(rt,{onClick:t,variant:"secondary",className:"!px-4",children:"Cancel"}),g.jsxs(rt,{onClick:X,className:"flex items-center !px-5 shadow-lg shadow-violet-500/20",children:[g.jsx(e$,{})," Save"]})]})]}),g.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[g.jsxs("aside",{className:"w-80 flex-shrink-0 flex flex-col bg-slate-50 dark:bg-slate-800/50 border-r dark:border-slate-800",children:[g.jsxs("div",{className:"p-4 flex-grow flex flex-col overflow-hidden",children:[g.jsx("div",{className:"flex justify-between items-center mb-2",children:g.jsxs("h3",{className:"font-bold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:["Holding Area",g.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${_.length>0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-slate-200 text-slate-600 dark:bg-slate-700 dark:text-slate-400"}`,children:_.length})]})}),g.jsxs("div",{className:`flex-grow border-2 border-dashed rounded-xl p-3 overflow-y-auto transition-all ${_.length>0?"border-amber-400 bg-amber-50 dark:bg-amber-900/10 dark:border-amber-500/50":"border-slate-300 dark:border-slate-700 bg-slate-100/50 dark:bg-slate-900/30"} hover:border-violet-400 dark:hover:border-violet-500`,onDragOver:Re,onDrop:Me,children:[g.jsx("div",{className:"grid grid-cols-2 gap-2",children:_.map(Z=>g.jsx("div",{draggable:!0,onDragStart:le=>q(le,Z),onDragEnd:oe,className:`
                                                p-2 rounded-lg text-xs text-center font-bold cursor-grab active:cursor-grabbing 
                                                shadow-sm border border-black/5 text-slate-900 hover:shadow-md transition-all 
                                                ${k(Z.setId)}
                                            `,children:Z.id},Z.id))}),_.length===0&&g.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 gap-2",children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),g.jsx("p",{className:"text-sm font-medium",children:"Drop Students Here"}),g.jsx("p",{className:"text-xs opacity-75 text-center px-4",children:"Drag students off the grid to unseat them temporarily."})]})]})]}),g.jsxs("div",{className:"p-4 border-t dark:border-slate-800 bg-white dark:bg-slate-900/50",children:[g.jsx("h4",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:"Student Sets"}),g.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:s.map((Z,le)=>g.jsxs("div",{className:"flex items-center text-xs group",children:[g.jsx("div",{className:`w-3 h-3 rounded-full mr-2 shadow-sm ${Os[le%Os.length]}`}),g.jsx("span",{className:"truncate font-medium text-slate-700 dark:text-slate-300",children:Z.subject}),g.jsx("span",{className:"ml-auto text-slate-400 text-[10px] bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:Z.studentCount})]},Z.id))})]})]}),g.jsxs("main",{className:"flex-grow flex flex-col bg-slate-100 dark:bg-[#0B1120] relative",style:{backgroundImage:"radial-gradient(#CBD5E1 1px, transparent 1px)",backgroundSize:"20px 20px"},onClick:Se,children:[g.jsxs("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-white dark:bg-slate-800 shadow-lg rounded-full px-4 py-2 flex items-center gap-3 z-10 border dark:border-slate-700",children:[g.jsxs("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mr-2",children:["Selection: ",m.size]}),g.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"}),g.jsx("button",{onClick:K,className:"text-xs font-medium hover:text-violet-600 dark:hover:text-violet-400 transition-colors",children:"Select All"}),g.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"}),g.jsx("button",{onClick:()=>x(new Set),className:"text-xs font-medium hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Clear"})]}),g.jsx("div",{className:"flex-grow overflow-auto p-12 flex justify-center items-start",children:f&&o[f]&&(()=>{const Z=o[f],le=Z.reduce((Ce,he)=>Math.max(Ce,he.length),0);return g.jsx("div",{className:"grid gap-4 p-8 bg-white dark:bg-slate-800 rounded-2xl shadow-xl border dark:border-slate-700",style:{gridTemplateColumns:`repeat(${le}, minmax(${P.width/16}rem, 1fr))`},onClick:Ce=>Ce.stopPropagation(),children:Z.map((Ce,he)=>Ce.map((Ae,ce)=>{var qe;if(!Ae)return g.jsx("div",{className:"rounded-lg opacity-50 bg-slate-50 dark:bg-slate-900/50",style:{width:`${P.width/16}rem`,height:`${P.height/16}rem`}},`${he}-${ce}`);const L=!!Ae.student,je=L?k(Ae.student.setId):"bg-slate-100 dark:bg-slate-700",Je=ee(f,he,ce),et=m.has(Je);return g.jsxs("div",{onDragOver:Re,onDrop:De=>ie(De,f,he,ce),draggable:L,onDragStart:De=>L&&Te(De,f,he,ce,Ae.student),onDragEnd:oe,onClick:De=>ae(De,f,he,ce,Ae.student),style:{height:`${P.height/16}rem`,fontSize:`${P.fontSize/16}rem`},className:`
                                                            w-full rounded-xl flex flex-col items-center justify-center font-bold
                                                            border transition-all duration-200 relative px-2
                                                            ${je}
                                                            ${L?"cursor-grab active:cursor-grabbing border-transparent text-slate-900 shadow-sm hover:shadow-md hover:-translate-y-0.5":"border-slate-200 dark:border-slate-600 border-dashed text-slate-300 dark:text-slate-600"}
                                                            ${Ae.type==="faculty"?"ring-2 ring-yellow-400":""}
                                                            ${Ae.type==="accessible"?"ring-2 ring-blue-400":""}
                                                            ${et?"ring-4 ring-indigo-500 z-10 shadow-xl scale-105":""}
                                                        `,title:`R${he+1} C${ce+1} ${Ae.student?`(${Ae.student.id})`:"Empty"}`,children:[et&&g.jsx("div",{className:"absolute -top-2 -right-2 bg-indigo-600 text-white rounded-full p-0.5 shadow-md",children:g.jsx(t$,{})}),L?g.jsx("span",{className:"font-bold break-all text-center",children:(qe=Ae.student)==null?void 0:qe.id}):g.jsxs("span",{className:"text-[10px] font-mono opacity-50",children:[he+1,"-",ce+1]})]},`${Ae.hallId}-${he}-${ce}`)}).concat(Array.from({length:le-Ce.length}).map((Ae,ce)=>g.jsx("div",{style:{width:`${P.width/16}rem`,height:`${P.height/16}rem`}},`pad-${he}-${ce}`))))})})()})]})]}),U&&g.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 z-50 animate-bounce-in",children:g.jsxs("div",{className:"bg-red-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-4 border border-red-500 max-w-md",children:[g.jsx(n$,{}),g.jsxs("div",{className:"flex-grow",children:[g.jsx("h4",{className:"font-bold",children:"Cannot Save Changes"}),g.jsx("p",{className:"text-sm text-red-100",children:U})]}),g.jsx("button",{onClick:()=>G(null),className:"text-red-200 hover:text-white",children:g.jsx(r$,{})})]})})]})})},_f=e=>{let t=0;e.forEach(s=>{s.students&&s.students.length>0&&s.students.forEach(l=>{l&&l.length>t&&(t=l.length)})});let r=80,n=60,A=12;return t>10&&t<=15?(r=100,n=70,A=11):t>15&&t<=20?(r=120,n=80,A=10):t>20&&(r=140,n=90,A=9),{width:r,height:n,fontSize:A}},i$=e=>{let t=0;return e.studentSets.forEach(r=>{r.students&&r.students.length>0&&r.students.forEach(n=>{n&&n.length>t&&(t=n.length)})}),t},bf=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),Ff=({className:e})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 20 20",fill:"currentColor",children:[g.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),g.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]}),Uf=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Bc=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 24 24",fill:"currentColor",children:g.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm1.8 18H14l-2-3.4-2 3.4H8.2l2.9-4.5L8.2 11H10l2 3.4 2-3.4h1.8l-2.9 4.5 2.9 4.5zM13 9V3.5L18.5 9H13z"})}),Ei=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Ti=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Si=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6V4m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM12 10v2m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM12 18v2m-6-16v2m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM6 14v6m6-16v6m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM18 6v10m0 2a2 2 0 100 4v0a2 2 0 100-4v0z"})}),Cc=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),Vm=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),l$=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),o$=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),IA=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),Ds=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13 0H11"})}),c$=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),z2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),X2=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),J2=e=>{if(e.length===0)return{isGrid:!1};let t=-1,r=-1;for(const l of e)l.row>t&&(t=l.row),l.col>r&&(r=l.col);const n=t+1,A=r+1;if(e.length!==n*A)return{isGrid:!1};const s=new Set(e.map(l=>`${l.row},${l.col}`));for(let l=0;l<n;l++)for(let o=0;o<A;o++)if(!s.has(`${l},${o}`))return{isGrid:!1};return{isGrid:!0,rows:n,cols:A}},u$=()=>{var cs,gn,si,CA;const{user:e}=zi(),[t,r]=W.useState([]),[n,A]=W.useState([]),[s,l]=W.useState([]),[o,u]=W.useState([]),[f,d]=W.useState(!0),[m,x]=W.useState(null),[y,C]=W.useState(""),[E,T]=W.useState(""),[_,F]=W.useState(!1),[S,I]=W.useState({mode:"closed",hallIndex:null}),[M,Q]=W.useState(!1),[U,G]=W.useState({name:"",rows:"8",cols:"10"}),[R,te]=W.useState(""),[ne,ee]=W.useState({open:!1,index:null}),ae=W.useRef({}),Se=W.useRef([]),[Te,q]=W.useState(null),[oe,Re]=W.useState(null),[ie,Me]=W.useState(!1),X=W.useRef({}),[k,K]=W.useState({subject:"",studentCount:""}),[P,z]=W.useState(""),[Z,le]=W.useState(null),[Ce,he]=W.useState(null),[Ae,ce]=W.useState([]),[L,je]=W.useState(null),[Je,et]=W.useState([]),[qe,De]=W.useState("ai"),[ct,Kt]=W.useState(!1),[lr,jt]=W.useState(!1),[Ct,wr]=W.useState({width:80,height:60,fontSize:12}),mt={id:"",title:"",date:"",halls:[],studentSets:[],aiSeatingRules:"",seatingType:"normal",editorMode:"ai",createdBy:(e==null?void 0:e.id)||"",adminId:(e==null?void 0:e.adminId)||""};W.useEffect(()=>{if(m&&m.studentSets.length>0){const{width:Y,height:de,fontSize:Ne}=_f(m.studentSets);wr({width:Y,height:de,fontSize:Ne})}},[m]);const ue=W.useCallback(async()=>{if(e){const Y=await GL(e.id);r(Y)}},[e]),Ve=W.useCallback(async()=>{if(e){const Y=await jL(e.id);A(Y)}},[e]),Et=W.useCallback(async()=>{if(e){const Y=await JL(e.id);l(Y)}},[e]),vt=W.useCallback(async()=>{if(e&&e.adminId){const Y=await lS(e.adminId);u(Y)}},[e]);W.useEffect(()=>{(async()=>{e!=null&&e.permissionGranted&&(d(!0),await Promise.all([ue(),Ve(),Et(),vt()])),d(!1)})()},[ue,Ve,Et,vt,e]);const Ut=Y=>{if(Y===(e==null?void 0:e.id))return"Me";const de=o.find(Ne=>Ne.id===Y);return de?de.name:"Unknown"},nt=(Y,de)=>{m&&x(Ne=>Ne?{...Ne,[Y]:de}:null)},pt=Y=>{m&&x(de=>de?{...de,editorMode:Y,seatingType:"normal"}:null)},Nt=Y=>{m&&x(de=>de?{...de,seatingType:Y}:null)},yt=(Y,de)=>{if(!m)return;const Ne=[...m.halls];Ne[Y]={...Ne[Y],name:de},x(Ie=>Ie?{...Ie,halls:Ne}:null)},rr=(Y,de)=>{if(!m)return;const Ne=[...m.halls];Ne[Y]={...Ne[Y],frontDirection:de},x(Ie=>Ie?{...Ie,halls:Ne}:null)},Or=()=>{if(!m)return;const Y=`Hall ${String.fromCharCode(65+m.halls.length)}`,de={id:`new-hall-${Date.now()}`,name:Y,layout:[],constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"};x(Ne=>Ne?{...Ne,halls:[...Ne.halls,de]}:null)},yr=(Y,de)=>{if(m)if(de==="normal"){const Ne=[];for(let ot=0;ot<8;ot++)for(let st=0;st<10;st++)Ne.push({id:`seat-${ot}-${st}-${Date.now()}`,row:ot,col:st,type:"standard"});const Xe=[...m.halls];Xe[Y]={...Xe[Y],layout:Ne},x(ot=>ot?{...ot,halls:Xe}:null)}else I({mode:"edit-hall",hallIndex:Y})},or=(Y,de,Ne)=>{if(!m)return;const Ie=J2(m.halls[Y].layout);let Be=Ie.isGrid?Ie.rows:8,Xe=Ie.isGrid?Ie.cols:10;const ot=parseInt(Ne,10);if(isNaN(ot)||ot<=0||ot>50)return;de==="rows"?Be=ot:Xe=ot;const st=[];for(let fr=0;fr<Be;fr++)for(let Rt=0;Rt<Xe;Rt++)st.push({id:`seat-${fr}-${Rt}-${Date.now()}`,row:fr,col:Rt,type:"standard"});const Gt=[...m.halls];Gt[Y]={...Gt[Y],layout:st},x(fr=>fr?{...fr,halls:Gt}:null)},Tn=Y=>{if(!m)return;let de=Y.name;m.halls.some(Ie=>Ie.name===de)&&(de=`${de} (Copy)`);const Ne={id:`hall-from-template-${Date.now()}`,name:de,layout:Y.layout.map(Ie=>({...Ie})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"};x(Ie=>Ie?{...Ie,halls:[...Ie.halls,Ne]}:null)},Pn=async Y=>{if(S.mode==="create-template"&&Y.name&&e)await Rc({name:Y.name,layout:Y.layout},e.id),await Ve();else if(S.mode==="edit-template"&&S.templateId&&Y.name&&e)await XL(S.templateId,{name:Y.name,layout:Y.layout},e.id),await Ve();else if(S.mode==="edit-hall"&&S.hallIndex!==null&&m){const de=S.hallIndex,Ne=[...m.halls];Ne[de]={...Ne[de],layout:Y.layout},x(Ie=>Ie?{...Ie,halls:Ne}:null)}I({mode:"closed",hallIndex:null})},hn=Y=>{m&&x(de=>de?{...de,halls:de.halls.filter((Ne,Ie)=>Ie!==Y)}:null)},Ca=(Y,de)=>{if(!m)return;const Ne=[...m.halls],Ie=Ne[Y];let Be={...Ie.constraints||{arrangement:"horizontal"},type:de};de==="advanced"&&!Be.allowedSetIds&&(Be.allowedSetIds=[]),Ne[Y]={...Ie,constraints:Be},x(Xe=>Xe?{...Xe,halls:Ne}:null)},Ea=(Y,de)=>{if(!m)return;const Ne=[...m.halls],Ie=Ne[Y];Ne[Y]={...Ie,constraints:{...Ie.constraints||{type:"no-limit"},arrangement:de}},x(Be=>Be?{...Be,halls:Ne}:null)},Wn=(Y,de,Ne)=>{var Xe;if(!m)return;const Ie=[...m.halls],Be=Ie[Y];if(((Xe=Be.constraints)==null?void 0:Xe.type)==="advanced"){const ot=Be.constraints.allowedSetIds||[],st=Ne?[...ot,de]:ot.filter(Gt=>Gt!==de);Ie[Y]={...Be,constraints:{...Be.constraints,allowedSetIds:st}},x(Gt=>Gt?{...Gt,halls:Ie}:null)}},Ta=(Y,de,Ne)=>{if(!m)return;const Ie=[...m.studentSets];Ie[Y]={...Ie[Y],[de]:Ne},x(Be=>Be?{...Be,studentSets:Ie}:null)},Sa=()=>{if(!m)return;const Y={id:`new-set-${Date.now()}`,subject:"",studentCount:"",isPlaceholder:!0};x(de=>de?{...de,studentSets:[...de.studentSets,Y]}:null)},Zi=(Y,de,Ne)=>{if(!m)return;const Ie=[...m.studentSets];if(de==="custom")Ie[Y]={...Ie[Y],subject:"",studentCount:"",isPlaceholder:!1};else if(de==="template"&&Ne){let Be=Ne.subject;m.studentSets.some((Xe,ot)=>ot!==Y&&Xe.subject===Be)&&(Be=`${Be} (Copy)`),Ie[Y]={...Ie[Y],subject:Be,studentCount:Ne.studentCount,isPlaceholder:!1}}x(Be=>Be?{...Be,studentSets:Ie}:null)},el=(Y,de)=>{if(!Y.target.files||Y.target.files.length===0)return;const Ne=Y.target.files[0],Ie=new FileReader;Ie.onload=Be=>{var Xe;if((Xe=Be.target)!=null&&Xe.result)try{const ot=zp(Be.target.result,{type:"binary"}),st=ot.SheetNames[0];if(!st){C("The Excel file doesn't contain any sheets.");return}const Gt=ot.Sheets[st],Rt=kn.sheet_to_json(Gt,{header:1,defval:"",blankrows:!1}).flat().map(ft=>String(ft).trim()).filter(ft=>ft!=="");if(Rt.length>0){const ft={id:`excel-set-${Date.now()}-${st}`,subject:st,studentCount:Rt.length,students:Rt,isPlaceholder:!1};x(_n=>{if(!_n)return null;const us=[..._n.studentSets];return us.splice(de,1,ft),{..._n,studentSets:us}}),C("");const{width:Lt,height:kr,fontSize:Nr}=_f([...currentSets,ft]);wr({width:Lt,height:kr,fontSize:Nr})}else C("No student register numbers found in the Excel sheet. The sheet appears to be empty.")}catch(ot){console.error("Error parsing Excel file:",ot),C("There was an error processing the Excel file. Please ensure it is a valid .xlsx or .xls file.")}finally{Y.target&&(Y.target.value="")}},Ie.onerror=Be=>{console.error("FileReader error:",Be),C("Failed to read the file."),Y.target&&(Y.target.value="")},Ie.readAsBinaryString(Ne)},ni=Y=>{if(!m)return;const de=[...m.studentSets],Ne=de[Y].id;de[Y]={id:Ne,subject:"",studentCount:"",isPlaceholder:!0},x(Ie=>Ie?{...Ie,studentSets:de}:null)},la=Y=>{m&&x(de=>de?{...de,studentSets:de.studentSets.filter((Ne,Ie)=>Ie!==Y)}:null)},Co=async Y=>{if(!e||!Y.name.trim()||Y.layout.length===0)return;const de=Y.name.trim();if(!n.some(Ne=>Ne.name.toLowerCase()===de.toLowerCase())){he(Y.id);try{await Rc({name:de,layout:Y.layout},e.id),await Ve(),ce(Ne=>[...Ne,Y.id]),setTimeout(()=>{ce(Ne=>Ne.filter(Ie=>Ie!==Y.id))},3e3)}catch(Ne){console.error("Failed to save hall template:",Ne)}finally{he(null)}}},tl=async Y=>{if(Y.preventDefault(),!e)return;te("");const{name:de,rows:Ne,cols:Ie}=U,Be=parseInt(Ne,10),Xe=parseInt(Ie,10);if(!de.trim()){te("Template name cannot be empty.");return}if(n.some(st=>st.name.toLowerCase()===de.trim().toLowerCase())){te("A template with this name already exists.");return}if(isNaN(Be)||Be<=0||Be>50||isNaN(Xe)||Xe<=0||Xe>50){te("Rows and columns must be numbers between 1 and 50.");return}const ot=[];for(let st=0;st<Be;st++)for(let Gt=0;Gt<Xe;Gt++)ot.push({id:`seat-${st}-${Gt}-${Date.now()}`,row:st,col:Gt,type:"standard"});await Rc({name:de.trim(),layout:ot},e.id),await Ve(),Q(!1),G({name:"",rows:"8",cols:"10"})},os=Y=>{I({mode:"edit-template",hallIndex:null,templateId:Y.id,templateName:Y.name})},rl=async Y=>{e&&window.confirm("Are you sure you want to delete this hall template? This cannot be undone.")&&(await cS(Y,e.id,e.role),await Ve())},Ai=async Y=>{if(Y.preventDefault(),z(""),!e)return;const{subject:de,studentCount:Ne}=k,Ie=parseInt(Ne,10);if(!de.trim()){z("Subject/code cannot be empty.");return}if(isNaN(Ie)||Ie<=0){z("Student count must be a positive number.");return}if(Z)await WL(Z,{subject:de.trim(),studentCount:Ie},e.id),le(null);else{if(s.some(Be=>Be.subject.toLowerCase()===de.trim().toLowerCase())){z("A template with this subject/code already exists.");return}await lp({subject:de.trim(),studentCount:Ie},e.id)}K({subject:"",studentCount:""}),await Et()},ai=Y=>{K({subject:Y.subject,studentCount:Y.studentCount.toString()}),le(Y.id)},N=()=>{K({subject:"",studentCount:""}),le(null)},j=async Y=>{if(!e)return;const de=Y.subject.trim(),Ne=parseInt(String(Y.studentCount),10);if(!(!de||isNaN(Ne)||Ne<=0)&&!s.some(Ie=>Ie.subject.toLowerCase()===de.toLowerCase())){je(Y.id);try{await lp({subject:de,studentCount:Ne},e.id),await Et(),et(Ie=>[...Ie,Y.id]),setTimeout(()=>{et(Ie=>Ie.filter(Be=>Be!==Y.id))},3e3)}catch(Ie){console.error("Failed to save student set template:",Ie)}finally{je(null)}}},H=async Y=>{e&&window.confirm("Are you sure you want to delete this student set template? This cannot be undone.")&&(await uS(Y,e.id,e.role),Z===Y&&N(),await Et())},O=()=>{if(!m)return null;if(!m.title.trim()||!m.date||m.halls.length===0||m.studentSets.length===0)return C("Please fill in all exam details, and add at least one hall and one student set."),null;if(m.halls.some(Y=>Y.layout.length===0))return C("One or more halls has an empty layout. Please design a layout for each hall."),null;if(m.studentSets.some(Y=>Y.isPlaceholder))return C("Please configure all student sets before saving or generating a plan."),null;try{const Y=m.studentSets.map(de=>{const Ne=parseInt(String(de.studentCount),10);if(isNaN(Ne)||Ne<=0)throw new Error(`Invalid student count for set "${de.subject}". Please enter a positive number.`);return{...de,id:de.id||`set-${Date.now()}`,studentCount:Ne}});return{...m,halls:m.halls.map(de=>({...de,id:de.id||`hall-${Date.now()}`})),studentSets:Y,id:m.id||void 0,createdBy:m.createdBy||(e==null?void 0:e.id)||"",adminId:m.adminId||(e==null?void 0:e.adminId)||""}}catch(Y){return C(Y.message),null}},V=async()=>{if(!m||!e)return;C(""),T("");const Y=O();if(Y){if(Y.id){const de=t.find(Ne=>Ne.id===Y.id);if(de){const Ne=JSON.stringify(Y.halls)!==JSON.stringify(de.halls),Ie=JSON.stringify(Y.studentSets)!==JSON.stringify(de.studentSets),Be=Y.aiSeatingRules!==de.aiSeatingRules,Xe=Y.seatingType!==de.seatingType,ot=Y.editorMode!==de.editorMode;(Ne||Ie||Be||Xe||ot)&&Y.seatingPlan&&(Y.seatingPlan=void 0)}}d(!0),Y.id?await am(Y):await VL({title:Y.title,date:Y.date,halls:Y.halls,studentSets:Y.studentSets,aiSeatingRules:Y.aiSeatingRules,seatingType:Y.seatingType,editorMode:Y.editorMode},e.id),await ue(),d(!1),x(null)}},J=async()=>{if(!m)return;C(""),T("");const Y=O();if(!Y)return;d(!0);let de;if(m.editorMode==="classic"||m.editorMode==="advanced"?de=await op({halls:Y.halls,studentSets:Y.studentSets,seatingType:Y.seatingType||"normal"}):de=await cp({halls:Y.halls,studentSets:Y.studentSets,rules:Y.aiSeatingRules||"",seatingType:Y.seatingType||"normal",editorMode:Y.editorMode}),de.plan){const Ne={...Y,id:Y.id||`exam${Date.now()}`,seatingPlan:de.plan};await am(Ne),await ue();const Ie={...m,id:Ne.id,seatingPlan:Ne.seatingPlan,halls:Ne.halls,studentSets:Ne.studentSets};x(Ie),de.message&&T(de.message)}else C(de.message||"Failed to generate seating plan. Please check your configuration and try again.");d(!1)},pe=async(Y,de)=>{const Ne=ae.current[Y];if(!Ne||!m)return;const Ie=Ne.style.boxShadow;Ne.style.boxShadow="none";const Be=Ct.width>100?1.5:2,Xe=await Pc(Ne,{scale:Be,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0});Ne.style.boxShadow=Ie;const ot=Xe.toDataURL("image/png"),st=document.createElement("a"),Gt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),fr=de.replace(/[^a-z0-9]/gi,"_").toLowerCase();st.download=`${Gt}_${fr}_plan.png`,st.href=ot,document.body.appendChild(st),st.click(),document.body.removeChild(st)},be=Y=>{var Rt,ft;if(!m||!m.seatingPlan){C("Seating plan not generated yet.");return}const de=m.seatingPlan[Y.id];if(!de)return;const Ne=kn.book_new(),Ie=de.reduce((Lt,kr)=>Math.max(Lt,kr.length),0),Be=[""];for(let Lt=0;Lt<Ie;Lt++)Be.push(`Col ${Lt+1}`);const Xe=[Be];for(let Lt=0;Lt<de.length;Lt++){const kr=[`Row ${Lt+1}`];for(let Nr=0;Nr<Ie;Nr++){const _n=(Rt=de[Lt])==null?void 0:Rt[Nr];kr.push(((ft=_n==null?void 0:_n.student)==null?void 0:ft.id)||"")}Xe.push(kr)}const ot=kn.aoa_to_sheet(Xe),st=Y.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);kn.book_append_sheet(Ne,ot,st);const Gt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),fr=Y.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Wc(Ne,`${Gt}_${fr}_plan.xlsx`)},xe=async()=>{if(!(!m||!m.seatingPlan)){Me(!0),C("");for(const Y of m.halls){const de=ae.current[Y.id];if(!de)continue;const Ne=de.style.boxShadow;de.style.boxShadow="none";try{const Ie=Ct.width>100?1.5:2,Xe=(await Pc(de,{scale:Ie,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0})).toDataURL("image/png"),ot=document.createElement("a"),st=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),Gt=Y.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();ot.download=`${st}_${Gt}_plan.png`,ot.href=Xe,document.body.appendChild(ot),ot.click(),document.body.removeChild(ot),await new Promise(fr=>setTimeout(fr,500))}catch(Ie){console.error("Error generating PNG for hall:",Y.name,Ie),C(`Could not generate PNG for ${Y.name}.`)}finally{de.style.boxShadow=Ne}}Me(!1)}},ve=()=>{if(!m||!m.seatingPlan){C("Seating plan not generated yet.");return}C("");const Y=kn.book_new();m.halls.forEach(Ne=>{var fr,Rt;const Ie=m.seatingPlan[Ne.id];if(!Ie)return;const Be=Ie.reduce((ft,Lt)=>Math.max(ft,Lt.length),0),Xe=[""];for(let ft=0;ft<Be;ft++)Xe.push(`Col ${ft+1}`);const ot=[Xe];for(let ft=0;ft<Ie.length;ft++){const Lt=[`Row ${ft+1}`];for(let kr=0;kr<Be;kr++){const Nr=(fr=Ie[ft])==null?void 0:fr[kr];Lt.push(((Rt=Nr==null?void 0:Nr.student)==null?void 0:Rt.id)||"")}ot.push(Lt)}const st=kn.aoa_to_sheet(ot),Gt=Ne.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);kn.book_append_sheet(Y,st,Gt)});const de=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Wc(Y,`${de}_full_seating_plan.xlsx`)},we=async Y=>{if(!m||!e)return;d(!0),await KL(m.id,Y,e.id)?(x(Ne=>Ne?{...Ne,seatingPlan:Y}:null),await ue()):C("Failed to save the updated seating plan."),d(!1)},Le=async Y=>{e&&window.confirm("Are you sure you want to permanently delete this exam? This action cannot be undone.")&&(d(!0),await oS(Y,e.id,e.role),(m==null?void 0:m.id)===Y&&x(null),await ue(),d(!1))},Oe=Y=>{x({...JSON.parse(JSON.stringify(Y)),aiSeatingRules:Y.aiSeatingRules||"",seatingType:Y.seatingType||"normal",editorMode:Y.editorMode||"ai"}),C(""),T("");const{width:de,height:Ne,fontSize:Ie}=_f(Y.studentSets);wr({width:de,height:Ne,fontSize:Ie})},ze=Y=>{x({...mt,createdBy:(e==null?void 0:e.id)||"",adminId:(e==null?void 0:e.adminId)||"",editorMode:Y,seatingType:"normal"}),C(""),T("")},He=()=>{x(null),C(""),T("")},Ke=async Y=>{q(Y.id);let de;if(Y.editorMode==="classic"||Y.editorMode==="advanced"?de=await op({halls:Y.halls,studentSets:Y.studentSets,seatingType:Y.seatingType||"normal"}):de=await cp({halls:Y.halls,studentSets:Y.studentSets,rules:Y.aiSeatingRules||"Arrange students fairly.",seatingType:Y.seatingType||"normal",editorMode:Y.editorMode}),de.plan){const Ne={...Y,seatingPlan:de.plan};await am(Ne),await ue(),de.message&&window.alert(de.message)}else window.alert(de.message||"Failed to generate seating plan. Not enough seats for all students.");q(null)},At=Y=>{X.current={},Re(Y.id)},cr=Y=>{if(!Y.seatingPlan){alert("This exam does not have a seating plan to export.");return}const de=kn.book_new();Y.halls.forEach(Ie=>{var Rt,ft;const Be=Y.seatingPlan[Ie.id];if(!Be)return;const Xe=Be.reduce((Lt,kr)=>Math.max(Lt,kr.length),0),ot=[""];for(let Lt=0;Lt<Xe;Lt++)ot.push(`Col ${Lt+1}`);const st=[ot];for(let Lt=0;Lt<Be.length;Lt++){const kr=[`Row ${Lt+1}`];for(let Nr=0;Nr<Xe;Nr++){const _n=(Rt=Be[Lt])==null?void 0:Rt[Nr];kr.push(((ft=_n==null?void 0:_n.student)==null?void 0:ft.id)||"")}st.push(kr)}const Gt=kn.aoa_to_sheet(st),fr=Ie.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);kn.book_append_sheet(de,Gt,fr)});const Ne=Y.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Wc(de,`${Ne}_seating_plan.xlsx`)},Ft=t.find(Y=>Y.id===oe);if(W.useEffect(()=>{if(!Ft||!Ft.seatingPlan)return;const Y=setTimeout(async()=>{const de=Object.entries(X.current).filter(([,Ie])=>Ie!==null);if(de.length!==Ft.halls.length){Re(null);return}const Ne=de.map(async([Ie,Be])=>{const Xe=Ft.halls.find(kr=>kr.id===Ie);if(!Be||!Xe)return;Be.style.boxShadow="none";const st=i$(Ft)>15?1.5:2,Gt=await Pc(Be,{scale:st,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0});Be.style.boxShadow="";const fr=Gt.toDataURL("image/png"),Rt=document.createElement("a"),ft=Ft.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),Lt=Xe.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Rt.download=`${ft}_${Lt}_plan.png`,Rt.href=fr,document.body.appendChild(Rt),Rt.click(),document.body.removeChild(Rt)});await Promise.all(Ne),Re(null)},100);return()=>clearTimeout(Y)},[oe,Ft]),!(e!=null&&e.permissionGranted))return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[g.jsx(za,{}),g.jsx("main",{className:"max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center",children:g.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-10 border border-gray-200 dark:border-gray-700",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-red-100 dark:bg-red-900/20 rounded-full mb-6",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),g.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Permission Required"}),g.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg leading-relaxed",children:"Your account does not have the necessary permissions to manage exams. Please contact the system administrator to request access."})]})})]});if(f&&!m)return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[g.jsx(za,{}),g.jsx("main",{className:"max-w-7xl mx-auto py-12 px-4 text-center",children:g.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[g.jsx("div",{className:"animate-spin rounded-full h-14 w-14 border-b-2 border-blue-600 dark:border-blue-400"}),g.jsx("span",{className:"text-lg text-gray-600 dark:text-gray-400 font-medium",children:"Loading exam data..."})]})})]});if(m){const Y=!m.id,de=Y?null:t.find(Be=>Be.id===m.id),Ne=de?JSON.stringify(m)!==JSON.stringify(de):!0,Ie=m.studentSets.filter(Be=>!Be.isPlaceholder).map(Be=>({...Be,studentCount:Number(Be.studentCount)||0}));return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[g.jsx(za,{}),g.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[_&&g.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-start pt-20 z-50 animate-fadeIn",children:g.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700",onClick:Be=>Be.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(IA,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Select Hall Template"})]}),g.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:n.length>0?n.map(Be=>g.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(IA,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:Be.name}),g.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Be.layout.length," seats"]})]})]}),g.jsx(rt,{variant:"primary",size:"sm",className:"!py-2 !px-4 text-sm",onClick:()=>{Tn(Be),F(!1)},children:"Add"})]},Be.id)):g.jsxs("div",{className:"text-center py-10",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:g.jsx(IA,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No hall templates available"}),g.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create templates to reuse hall layouts"})]})}),g.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:g.jsx(rt,{onClick:()=>F(!1),variant:"outline",className:"w-full",children:"Cancel"})})]})}),S.mode!=="closed"&&g.jsx(up,{isOpen:!0,onClose:()=>I({mode:"closed",hallIndex:null}),onSave:Pn,initialLayout:S.mode==="edit-hall"&&S.hallIndex!==null?(cs=m.halls[S.hallIndex])==null?void 0:cs.layout:S.mode==="edit-template"&&S.templateId?(gn=n.find(Be=>Be.id===S.templateId))==null?void 0:gn.layout:[],initialName:S.mode==="edit-template"?S.templateName:void 0,isTemplateCreationMode:S.mode==="create-template"||S.mode==="edit-template"}),ne.open&&g.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-start pt-20 z-50 animate-fadeIn",children:g.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700",onClick:Be=>Be.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:g.jsx(Ds,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Select Student Set Template"})]}),g.jsx("button",{onClick:()=>ee({open:!1,index:null}),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:s.length>0?s.map(Be=>g.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:g.jsx(Ds,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:Be.subject}),g.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Be.studentCount," students"]})]})]}),g.jsx(rt,{variant:"primary",size:"sm",className:"!py-2 !px-4 text-sm",onClick:()=>{ne.index!==null&&Zi(ne.index,"template",Be),ee({open:!1,index:null})},children:"Add"})]},Be.id)):g.jsxs("div",{className:"text-center py-10",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:g.jsx(Ds,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No student set templates available"}),g.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create templates to reuse student sets"})]})}),g.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:g.jsx(rt,{onClick:()=>ee({open:!1,index:null}),variant:"outline",className:"w-full",children:"Cancel"})})]})}),lr&&m.seatingPlan&&g.jsx(s$,{isOpen:!0,onClose:()=>jt(!1),onSave:we,initialPlan:m.seatingPlan,halls:m.halls,studentSets:Ie,seatDimensions:Ct}),g.jsxs("div",{className:"mb-10",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:Y?"Create New Exam":"Edit Exam Configuration"}),g.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:Y?"Configure your exam schedule and seating arrangements":"Update your existing exam setup"})]}),g.jsx(rt,{onClick:He,variant:"outline",className:"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500",children:" Back to Dashboard"})]}),g.jsxs("div",{className:"space-y-8",children:[g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(X2,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Exam Information"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Enter the basic details for your exam"})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Title"}),g.jsx(It,{id:"exam-title",placeholder:"e.g., Fall Semester Final Examinations",value:m.title,onChange:Be=>nt("title",Be.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Date"}),g.jsx(It,{id:"exam-date",type:"date",value:m.date,onChange:Be=>nt("date",Be.target.value)})]})]})]}),g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:g.jsx(Si,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Editor Mode Selection"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose how you want to arrange seating"})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[g.jsxs("div",{onClick:()=>pt("ai"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="ai"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[g.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="ai"?"bg-blue-100 dark:bg-blue-800/30 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:g.jsx(Ei,{className:"w-5 h-5"})}),g.jsxs("div",{children:[g.jsx("h4",{className:`font-semibold ${m.editorMode==="ai"?"text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:"AI Mode"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Natural language instructions"})]})]}),m.editorMode==="ai"&&g.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-blue-500 dark:bg-blue-400"})]}),g.jsxs("div",{onClick:()=>pt("ai-advanced"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="ai-advanced"?"border-purple-500 bg-purple-50 dark:bg-purple-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[g.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="ai-advanced"?"bg-purple-100 dark:bg-purple-800/30 text-purple-600 dark:text-purple-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:g.jsx(Cc,{className:"w-5 h-5"})}),g.jsxs("div",{children:[g.jsx("h4",{className:`font-semibold ${m.editorMode==="ai-advanced"?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"}`,children:"AI + Advanced"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"AI with hall constraints"})]})]}),m.editorMode==="ai-advanced"&&g.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-purple-500 dark:bg-purple-400"})]}),g.jsxs("div",{onClick:()=>pt("advanced"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="advanced"?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[g.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="advanced"?"bg-cyan-100 dark:bg-cyan-800/30 text-cyan-600 dark:text-cyan-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:g.jsx(Si,{className:"w-5 w-5"})}),g.jsxs("div",{children:[g.jsx("h4",{className:`font-semibold ${m.editorMode==="advanced"?"text-cyan-700 dark:text-cyan-300":"text-gray-700 dark:text-gray-300"}`,children:"Advanced Mode"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Manual control with algorithms"})]})]}),m.editorMode==="advanced"&&g.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-cyan-500 dark:bg-cyan-400"})]}),g.jsxs("div",{onClick:()=>pt("classic"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="classic"?"border-green-500 bg-green-50 dark:bg-green-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[g.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="classic"?"bg-green-100 dark:bg-green-800/30 text-green-600 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:g.jsx(Ti,{className:"w-5 h-5"})}),g.jsxs("div",{children:[g.jsx("h4",{className:`font-semibold ${m.editorMode==="classic"?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:"Classic Mode"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Simple round-robin distribution"})]})]}),m.editorMode==="classic"&&g.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-green-500 dark:bg-green-400"})]})]})]}),g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:g.jsx(z2,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Exam Halls"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure the physical layout and constraints for each examination hall"})]})]}),g.jsx("div",{className:"space-y-6",children:m.halls.map((Be,Xe)=>{var Lt,kr,Nr,_n,us,Eo;const ot=n.some(er=>er.name.toLowerCase()===Be.name.trim().toLowerCase()),st=Ce===Be.id,Gt=Ae.includes(Be.id),fr=!Be.name.trim(),Rt=J2(Be.layout),ft=Be.layout.length===0?"placeholder":Rt.isGrid?"normal":"advanced";return g.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex justify-between items-start mb-6",children:[g.jsxs("div",{className:"flex-grow",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:g.jsx(z2,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),g.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Hall Configuration"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hall Name"}),g.jsx(It,{id:`hall-name-${Xe}`,value:Be.name,onChange:er=>yt(Xe,er.target.value),placeholder:"e.g., Main Auditorium"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Front Direction"}),g.jsx("div",{className:"grid grid-cols-2 gap-2",children:["top","bottom","left","right"].map(er=>g.jsx("button",{type:"button",onClick:()=>rr(Xe,er),className:`px-3 py-2 text-sm font-medium rounded-md transition-all ${(Be.frontDirection||"top")===er?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:er.charAt(0).toUpperCase()+er.slice(1)},er))})]})]})]}),g.jsx("button",{type:"button",onClick:()=>hn(Xe),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors ml-4",children:g.jsx(bf,{})})]}),ft==="placeholder"&&g.jsxs("div",{className:"mb-6 p-6 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 text-center",children:[g.jsx("h5",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-300",children:"Define Hall Layout"}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4 text-sm",children:"Choose how you want to define the seating layout"}),g.jsxs("div",{className:"flex justify-center gap-4",children:[g.jsx(rt,{variant:"outline",onClick:()=>yr(Xe,"normal"),className:"!py-3 !px-6",children:"Grid Layout"}),g.jsx(rt,{variant:"outline",onClick:()=>yr(Xe,"advanced"),className:"!py-3 !px-6",children:"Advanced Editor"})]})]}),ft==="normal"&&Rt.isGrid&&g.jsxs("div",{className:"mb-6",children:[g.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rows"}),g.jsx(It,{type:"number",value:Rt.rows,min:"1",max:"50",onChange:er=>or(Xe,"rows",er.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Columns"}),g.jsx(It,{type:"number",value:Rt.cols,min:"1",max:"50",onChange:er=>or(Xe,"cols",er.target.value)})]})]}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:g.jsx(Ds,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),g.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",g.jsxs("span",{className:"font-semibold",children:[Be.layout.filter(er=>er.type!=="faculty").length," seats"]})]})]}),g.jsx(rt,{variant:"outline",onClick:()=>I({mode:"edit-hall",hallIndex:Xe}),size:"sm",children:"Switch to Advanced Editor"})]})]}),ft==="advanced"&&g.jsx("div",{className:"mb-6",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:g.jsx(Ds,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),g.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",g.jsxs("span",{className:"font-semibold",children:[Be.layout.filter(er=>er.type!=="faculty").length," seats"]})]})]}),g.jsx(rt,{variant:"outline",onClick:()=>I({mode:"edit-hall",hallIndex:Xe}),size:"sm",children:"Edit Advanced Layout"})]})}),["advanced","ai-advanced"].includes(m.editorMode||"ai")&&g.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-gray-700",children:[g.jsx("h5",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Hall Constraints"}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Student Placement"}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{type:"button",onClick:()=>Ca(Xe,"no-limit"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!((Lt=Be.constraints)!=null&&Lt.type)||((kr=Be.constraints)==null?void 0:kr.type)==="no-limit"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"No Restrictions"}),g.jsx("button",{type:"button",onClick:()=>Ca(Xe,"advanced"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${((Nr=Be.constraints)==null?void 0:Nr.type)==="advanced"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Restricted Sets"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Seating Direction"}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{type:"button",onClick:()=>Ea(Xe,"horizontal"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!((_n=Be.constraints)!=null&&_n.arrangement)||Be.constraints.arrangement==="horizontal"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Horizontal"}),g.jsx("button",{type:"button",onClick:()=>Ea(Xe,"vertical"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${((us=Be.constraints)==null?void 0:us.arrangement)==="vertical"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Vertical"})]})]}),((Eo=Be.constraints)==null?void 0:Eo.type)==="advanced"&&g.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Allowed Student Sets"}),m.studentSets.filter(er=>!er.isPlaceholder).length>0?g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.studentSets.filter(er=>!er.isPlaceholder).map(er=>{var bu,Fu;return g.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-white dark:hover:bg-gray-700 rounded-lg transition-colors border border-gray-200 dark:border-gray-700",children:[g.jsx("input",{type:"checkbox",checked:((Fu=(bu=Be.constraints)==null?void 0:bu.allowedSetIds)==null?void 0:Fu.includes(er.id))||!1,onChange:nl=>Wn(Xe,er.id,nl.target.checked),className:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 dark:text-blue-400 focus:ring-blue-500 bg-white dark:bg-gray-800"}),g.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:er.subject})]},er.id)})}):g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No student sets configured yet"})]})]})]}),g.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:Gt?g.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),g.jsx("span",{className:"text-sm font-medium",children:"Saved as Template"})]}):st?g.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[g.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),g.jsx("span",{className:"text-sm font-medium",children:"Saving..."})]}):ot?g.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[g.jsx(IA,{}),g.jsx("span",{className:"text-sm font-medium",children:"Template Exists"})]}):g.jsxs(rt,{variant:"outline",size:"sm",disabled:fr||Be.layout.length===0,onClick:()=>Co(Be),className:"flex items-center gap-2",children:[g.jsx(IA,{}),"Save as Template"]})})]},Be.id)})}),g.jsxs("div",{className:"flex flex-wrap gap-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[g.jsxs(rt,{onClick:Or,variant:"outline",className:"flex items-center gap-2",children:[g.jsx(Vm,{}),"Add Hall"]}),g.jsxs(rt,{onClick:()=>F(!0),variant:"outline",className:"flex items-center gap-2",children:[g.jsx(IA,{}),"Add from Template"]})]})]}),g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:g.jsx(Ds,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Student Sets"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Define groups of students participating in the exam"})]})]}),g.jsx("div",{className:"space-y-6",children:m.studentSets.map((Be,Xe)=>{if(Be.isPlaceholder)return g.jsxs("div",{className:"p-8 bg-gray-50 dark:bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 text-center",children:[g.jsx("h4",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-300",children:"Configure New Student Set"}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 text-sm",children:"Choose how you want to add student data"}),g.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mb-6",children:[g.jsx(rt,{variant:"outline",onClick:()=>Zi(Xe,"custom"),className:"!py-3 !px-6",children:"Create Custom Set"}),g.jsx(rt,{variant:"outline",onClick:()=>ee({open:!0,index:Xe}),className:"!py-3 !px-6",children:"Use Template"}),g.jsxs(rt,{variant:"outline",className:"!py-3 !px-6 flex items-center gap-2",onClick:()=>{var ft;return(ft=Se.current[Xe])==null?void 0:ft.click()},children:[g.jsx(Bc,{className:"h-4 w-4"}),"Upload Excel"]}),g.jsx("input",{type:"file",ref:ft=>{ft&&(Se.current[Xe]=ft)},hidden:!0,accept:".xlsx, .xls",onChange:ft=>el(ft,Xe)})]}),g.jsx("button",{type:"button",onClick:()=>la(Xe),className:"text-red-600 hover:text-red-800 text-sm font-medium hover:underline transition",children:"Remove This Set"})]},Be.id);const ot=s.some(ft=>ft.subject.toLowerCase()===Be.subject.trim().toLowerCase()),st=L===Be.id,Gt=Je.includes(Be.id),fr=!Be.subject.trim()||!(parseInt(String(Be.studentCount),10)>0),Rt=!!Be.students;return g.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subject / Set Code"}),g.jsx(It,{id:`set-subject-${Xe}`,value:Be.subject,onChange:ft=>Ta(Xe,"subject",ft.target.value),placeholder:"e.g., PHYS101"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Number of Students"}),g.jsx(It,{id:`set-count-${Xe}`,type:"number",min:"1",value:Be.studentCount,onChange:ft=>Ta(Xe,"studentCount",ft.target.value),readOnly:Rt})]}),g.jsx("div",{className:"flex items-end gap-2",children:g.jsxs("button",{type:"button",onClick:()=>ni(Xe),className:"w-full h-10 flex items-center justify-center bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors text-gray-700 dark:text-gray-300",title:"Change Set Type",children:[g.jsx(Ff,{className:"h-4 w-4 mr-2"}),"Edit Type"]})}),g.jsx("div",{className:"flex items-end",children:g.jsxs("button",{type:"button",onClick:()=>la(Xe),className:"w-full h-10 flex items-center justify-center bg-white dark:bg-gray-700 border border-red-300 dark:border-red-600 rounded-md hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-red-600 dark:text-red-400",children:[g.jsx(bf,{className:"h-4 w-4 mr-2"}),"Remove"]})})]}),Rt&&g.jsx("div",{className:"mb-4",children:g.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300 rounded-full text-xs font-medium",children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Populated from Excel file"]})}),g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("div",{children:Rt&&g.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[g.jsx("span",{className:"font-medium",children:"Note:"})," Count determined by uploaded Excel file"]})}),g.jsx("div",{children:Gt?g.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),g.jsx("span",{className:"text-sm font-medium",children:"Saved as Template"})]}):st?g.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[g.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),g.jsx("span",{className:"text-sm font-medium",children:"Saving..."})]}):ot?g.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[g.jsx(IA,{}),g.jsx("span",{className:"text-sm font-medium",children:"Template Exists"})]}):g.jsxs(rt,{variant:"outline",size:"sm",disabled:fr||Rt,onClick:()=>j(Be),className:"flex items-center gap-2",children:[g.jsx(IA,{}),"Save as Template"]})})]})]},Be.id)})}),g.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[g.jsxs(rt,{onClick:Sa,variant:"outline",className:"flex items-center gap-2",children:[g.jsx(Vm,{}),"Add Student Set"]}),g.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg border border-blue-200 dark:border-blue-800",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-800/20 rounded",children:g.jsx(Bc,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Excel Upload Guidelines"}),g.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[g.jsx("li",{children:" The first sheet name will be used as the set code"}),g.jsx("li",{children:" Format student ID columns as 'Text' to preserve formatting"}),g.jsx("li",{children:" All non-empty cells will be read as student register numbers"}),g.jsx("li",{children:" Supports .xlsx and .xls file formats"})]})]})]})})]})]}),["ai","ai-advanced"].includes(m.editorMode||"ai")&&g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:g.jsx(Ei,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"AI Seating Configuration"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Customize seating rules using natural language"})]})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Seating Strategy"}),g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"flex-1",children:g.jsxs("div",{onClick:()=>Nt("normal"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType!=="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType!=="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),g.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Normal Seating"})]}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Efficient seating with custom AI instructions"})]})}),g.jsx("div",{className:"flex-1",children:g.jsxs("div",{onClick:()=>Nt("fair"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType==="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType==="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),g.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fair Seating"})]}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatic alternation with extra spacing"})]})})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Custom Instructions"}),g.jsx(Zq,{id:"ai-rules",value:m.aiSeatingRules||"",onChange:Be=>nt("aiSeatingRules",Be.target.value),placeholder:`Enter specific seating rules. For example:
 Prioritize front rows for students with accessibility needs
 Separate students from the same department
 Ensure no two adjacent seats have the same subject code
 Place faculty supervisors at the back of each row`,rows:5,className:"w-full"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"AI will interpret your instructions to create the optimal seating arrangement."})]})]})]}),(m.editorMode==="classic"||m.editorMode==="advanced")&&g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg",children:g.jsx(Si,{className:"h-6 w-6 text-cyan-600 dark:text-cyan-400"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:m.editorMode==="advanced"?"Advanced Seating Configuration":"Classic Seating Configuration"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.editorMode==="advanced"?"Manual control with predictable algorithms":"Simple round-robin distribution"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-4",children:"Seating Strategy"}),g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"flex-1",children:g.jsxs("div",{onClick:()=>Nt("normal"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType!=="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType!=="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),g.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Normal Seating"})]}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.editorMode==="advanced"?"Alternates students and fills all remaining seats":"Simple round-robin distribution across all halls"})]})}),g.jsx("div",{className:"flex-1",children:g.jsxs("div",{onClick:()=>Nt("fair"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType==="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType==="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),g.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fair Seating"})]}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.editorMode==="advanced"?"Alternates students with empty seats between different sets":"Ensures spacing between students of different sets"})]})})]})]})]}),E&&g.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/10 rounded-lg border border-amber-200 dark:border-amber-800",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("div",{className:"p-1.5 bg-amber-100 dark:bg-amber-800/20 rounded",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h1m0 0h-1m1 0v4m0 0v4m0-8h1m-1 0h-1m1 0V8m0 0h-1m1 0V4m0 0h-1m1 0V0"})})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-300",children:"Note"}),g.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-400 mt-1",children:E})]})]})}),y&&g.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-800",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("div",{className:"p-1.5 bg-red-100 dark:bg-red-800/20 rounded",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"Validation Error"}),g.jsx("p",{className:"text-sm text-red-700 dark:text-red-400 mt-1",children:y})]})]})}),g.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6",children:g.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[g.jsx(rt,{onClick:V,variant:"outline",className:"flex-1 !py-4 text-base font-semibold",disabled:f||!Ne,children:f?g.jsxs("span",{className:"flex items-center justify-center gap-2",children:[g.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}),"Saving..."]}):Y?"Save Exam Draft":"Update Exam"}),g.jsx(rt,{onClick:J,variant:"primary",className:"flex-1 !py-4 text-base font-semibold",disabled:f,children:f?g.jsxs("span",{className:"flex items-center justify-center gap-2",children:[g.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Generating Plan..."]}):"Generate Seating Plan"})]})})]}),m.seatingPlan&&g.jsxs("div",{className:"mt-12 space-y-8",children:[g.jsx(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:g.jsxs("div",{className:"text-center py-8",children:[g.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[g.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(Uf,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),g.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Seating Plan Ready"})]}),g.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto",children:"Your seating arrangement has been generated successfully. Download individual hall plans or export the complete seating chart."}),g.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-8",children:[g.jsxs(rt,{onClick:xe,variant:"outline",className:"flex items-center justify-center gap-2 !py-3 !px-6",disabled:ie,children:[g.jsx(Uf,{className:"h-5 w-5"}),ie?"Downloading...":"Download All Halls (PNG)"]}),g.jsxs(rt,{onClick:ve,variant:"primary",className:"flex items-center justify-center gap-2 !py-3 !px-6",children:[g.jsx(Bc,{className:"h-5 w-5"}),"Export Full Plan (Excel)"]})]}),g.jsxs("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/10 rounded-xl border border-blue-200 dark:border-blue-800 max-w-lg mx-auto",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/20 rounded-lg",children:g.jsx(Ff,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Need manual adjustments?"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Edit individual student placements"})]})]}),g.jsx(rt,{onClick:()=>jt(!0),variant:"primary",className:"w-full !py-3",children:"Open Seating Editor"})]})]})}),g.jsx("div",{className:"space-y-8",children:m.halls.map(Be=>{const Xe={...Be,layout:Be.layout};return g.jsxs(zt,{ref:ot=>{ot&&(ae.current[Be.id]=ot)},className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 w-full",children:[g.jsx($c,{hall:Xe,plan:m.seatingPlan,studentSets:Ie,seatDimensions:Ct}),g.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-300",children:Be.name}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Seating Plan"})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs(rt,{onClick:()=>pe(Be.id,Be.name),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[g.jsx(Uf,{})," PNG"]}),g.jsxs(rt,{onClick:()=>be(Xe),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[g.jsx(Bc,{})," Excel"]})]})]})})]},Be.id)})})]})]})]})]})}const ur=t.filter(Y=>Y.editorMode==="ai"||!Y.editorMode),Sn=t.filter(Y=>Y.editorMode==="advanced"),JA=t.filter(Y=>Y.editorMode==="classic"),BA=t.filter(Y=>Y.editorMode==="ai-advanced"),Gn=Y=>g.jsx("div",{className:"space-y-4",children:Y.map(de=>{const Ne=Te===de.id,Ie=oe===de.id;return g.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow",children:[g.jsx("div",{className:"p-5",children:g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>Oe(de),children:[g.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[g.jsxs("div",{className:`p-2 rounded-lg ${de.editorMode==="ai"?"bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":de.editorMode==="ai-advanced"?"bg-purple-100 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400":de.editorMode==="advanced"?"bg-cyan-100 dark:bg-cyan-900/20 text-cyan-600 dark:text-cyan-400":"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400"}`,children:[de.editorMode==="ai"&&g.jsx(Ei,{className:"h-5 w-5"}),de.editorMode==="ai-advanced"&&g.jsx(Cc,{className:"h-5 w-5"}),de.editorMode==="advanced"&&g.jsx(Si,{className:"h-5 w-5"}),de.editorMode==="classic"&&g.jsx(Ti,{className:"h-5 w-5"})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 text-lg",children:de.title}),g.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(c$,{className:"h-4 w-4"}),de.date]}),g.jsx("span",{children:""}),g.jsxs("span",{children:["Created by: ",Ut(de.createdBy)]})]})]})]}),g.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[g.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${de.seatingPlan?"bg-green-100 text-green-800 dark:bg-green-500/20 dark:text-green-300":"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300"}`,children:de.seatingPlan?" Plan Generated":" Pending Plan"}),g.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[de.halls.length," Hall",de.halls.length!==1?"s":""]}),g.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[de.studentSets.length," Set",de.studentSets.length!==1?"s":""]})]})]}),g.jsx("button",{onClick:()=>Oe(de),className:"ml-4 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:g.jsx(l$,{})})]})}),g.jsx("div",{className:"px-5 py-4 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700 rounded-b-xl",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("div",{className:"flex items-center gap-2",children:de.seatingPlan?g.jsxs(g.Fragment,{children:[g.jsxs(rt,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:Be=>{Be.stopPropagation(),At(de)},disabled:Ie,children:[g.jsx(Uf,{className:"h-4 w-4"}),Ie?"...":"PNGs"]}),g.jsxs(rt,{variant:"primary",size:"sm",className:"flex items-center gap-2",onClick:Be=>{Be.stopPropagation(),cr(de)},children:[g.jsx(Bc,{className:"h-4 w-4"}),"Excel"]})]}):g.jsx(rt,{variant:"primary",size:"sm",className:"flex items-center gap-2",onClick:Be=>{Be.stopPropagation(),Ke(de)},disabled:Ne,children:Ne?g.jsxs("span",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Generating..."]}):g.jsxs(g.Fragment,{children:[g.jsx(Ei,{className:"h-4 w-4"}),"Generate Plan"]})})}),g.jsx(rt,{variant:"danger",size:"sm",onClick:Be=>{Be.stopPropagation(),Le(de.id)},children:"Delete"})]})})]},de.id)})});return g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[g.jsx(za,{}),g.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(S.mode==="create-template"||S.mode==="edit-template")&&g.jsx(up,{isOpen:!0,onClose:()=>I({mode:"closed",hallIndex:null}),onSave:Pn,initialLayout:S.mode==="edit-hall"&&S.hallIndex!==null?(si=m.halls[S.hallIndex])==null?void 0:si.layout:S.mode==="edit-template"&&S.templateId?(CA=n.find(Y=>Y.id===S.templateId))==null?void 0:CA.layout:[],initialName:S.mode==="edit-template"?S.templateName:void 0,isTemplateCreationMode:S.mode==="create-template"||S.mode==="edit-template"}),M&&g.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4 animate-fadeIn",onClick:()=>Q(!1),children:g.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700",onClick:Y=>Y.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(Ti,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),g.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Create Grid Hall Template"})]}),g.jsxs("form",{onSubmit:tl,children:[g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template Name"}),g.jsx(It,{id:"grid-template-name",value:U.name,onChange:Y=>G({...U,name:Y.target.value}),required:!0,placeholder:"e.g., Main Auditorium Layout"})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rows"}),g.jsx(It,{id:"grid-template-rows",type:"number",min:"1",max:"50",value:U.rows,onChange:Y=>G({...U,rows:Y.target.value}),required:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Columns"}),g.jsx(It,{id:"grid-template-cols",type:"number",min:"1",max:"50",value:U.cols,onChange:Y=>G({...U,cols:Y.target.value}),required:!0})]})]}),R&&g.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-800",children:g.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:R})})]}),g.jsxs("div",{className:"mt-8 flex justify-end gap-4",children:[g.jsx(rt,{type:"button",variant:"outline",onClick:()=>Q(!1),children:"Cancel"}),g.jsx(rt,{type:"submit",variant:"primary",children:"Save Template"})]})]})]})}),g.jsxs("div",{className:"mb-10",children:[g.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"Exam Seating Management"}),g.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create and manage exam schedules with intelligent seating arrangements"})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(Vm,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Create New Exam"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose an editor mode to begin creating your exam schedule"})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{onClick:()=>ze("ai"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-md transition-all cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[g.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg group-hover:scale-110 transition-transform",children:g.jsx(Ei,{className:"text-blue-600 dark:text-blue-400 w-6 h-6"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"AI-Powered Mode"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Flexible seating with natural language rules"})]})]}),g.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Natural language instructions"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Intelligent seating optimization"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Flexible rule-based arrangement"]})]})]}),g.jsxs("div",{onClick:()=>ze("ai-advanced"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-600 hover:shadow-md transition-all cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[g.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg group-hover:scale-110 transition-transform",children:g.jsx(Cc,{className:"text-purple-600 dark:text-purple-400 w-6 h-6"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"AI + Advanced"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"AI logic with strict hall constraints"})]})]}),g.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Combined AI and manual control"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Hall-specific set restrictions"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Advanced constraint management"]})]})]}),g.jsxs("div",{onClick:()=>ze("advanced"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-cyan-300 dark:hover:border-cyan-600 hover:shadow-md transition-all cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[g.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg group-hover:scale-110 transition-transform",children:g.jsx(Si,{className:"text-cyan-600 dark:text-cyan-400 w-6 h-6"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Advanced Mode"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manual control with predictable algorithms"})]})]}),g.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Granular hall control"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Deterministic seating"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Fast and predictable"]})]})]}),g.jsxs("div",{onClick:()=>ze("classic"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-600 hover:shadow-md transition-all cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[g.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg group-hover:scale-110 transition-transform",children:g.jsx(Ti,{className:"text-green-600 dark:text-green-400 w-6 h-6"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Classic Mode"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Simple round-robin distribution"})]})]}),g.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Simple and fast"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Automatic mixing"]}),g.jsxs("li",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Minimal configuration"]})]})]})]})]}),g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h1m0 0h-1m1 0v4m0 0v4m0-8h1m-1 0h-1m1 0V8m0 0h-1m1 0V4m0 0h-1m1 0V0"})})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Editor Mode Guide"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Understanding the different seating arrangement methods"})]})]}),g.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",onClick:()=>Kt(!ct),children:g.jsx(o$,{className:`h-6 w-6 transition-transform ${ct?"rotate-180":""}`})})]}),ct&&g.jsxs("div",{className:"space-y-8",children:[g.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Editor Mode Comparison"}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[g.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/20 rounded",children:g.jsx(Ei,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"AI-Powered Mode"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Best for complex scenarios requiring flexible, intelligent seating based on natural language instructions."}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:'Example: "Keep Physics students away from Math students and prioritize front rows for accessibility needs."'})]})]}),g.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[g.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-800/20 rounded",children:g.jsx(Cc,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"AI + Advanced Mode"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Combines AI intelligence with strict hall-level controls for power users needing precise placement."}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Restrict Hall A to Chemistry students only, then apply AI rules within that constraint."})]})]}),g.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[g.jsx("div",{className:"p-2 bg-cyan-100 dark:bg-cyan-800/20 rounded",children:g.jsx(Si,{className:"h-5 w-5 text-cyan-600 dark:text-cyan-400"})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Advanced Mode"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Manual control with predictable algorithms, perfect for standardized exam setups."}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Manually assign specific student sets to specific halls with defined seating directions."})]})]}),g.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[g.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-800/20 rounded",children:g.jsx(Ti,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Classic Mode"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Simple and fast round-robin distribution for straightforward exam scenarios."}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Automatically mix all student sets across all available halls in order."})]})]})]})]}),g.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[g.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Workflow Overview"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:g.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"1"})}),g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Setup"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter exam details, add halls, and configure student sets"})]}),g.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:g.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"2"})}),g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Configure"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Choose editor mode and apply seating rules or constraints"})]}),g.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:g.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"3"})}),g.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Generate & Export"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Generate seating plan and export as Excel or PNG files"})]})]})]})]})]}),g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:g.jsx(X2,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"My Exam Schedules"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage and monitor all your exam configurations"})]})]}),g.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:g.jsxs("nav",{className:"-mb-px flex flex-wrap gap-x-6","aria-label":"Tabs",children:[g.jsxs("button",{onClick:()=>De("ai"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${qe==="ai"?"border-blue-500 dark:border-blue-400 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["AI Exams (",ur.length,")"]}),g.jsxs("button",{onClick:()=>De("ai-advanced"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${qe==="ai-advanced"?"border-purple-500 dark:border-purple-400 text-purple-600 dark:text-purple-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["AI+Advanced (",BA.length,")"]}),g.jsxs("button",{onClick:()=>De("advanced"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${qe==="advanced"?"border-cyan-500 dark:border-cyan-400 text-cyan-600 dark:text-cyan-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Advanced (",Sn.length,")"]}),g.jsxs("button",{onClick:()=>De("classic"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${qe==="classic"?"border-green-500 dark:border-green-400 text-green-600 dark:text-green-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Classic (",JA.length,")"]})]})}),g.jsxs("div",{className:"mt-6",children:[qe==="ai"&&(ur.length>0?Gn(ur):g.jsxs("div",{className:"text-center py-12",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-4",children:g.jsx(Ei,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No AI exams created yet"}),g.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create your first AI-powered exam schedule"})]})),qe==="ai-advanced"&&(BA.length>0?Gn(BA):g.jsxs("div",{className:"text-center py-12",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-purple-100 dark:bg-purple-900/20 rounded-full mb-4",children:g.jsx(Cc,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"})}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No AI+Advanced exams created yet"}),g.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Combine AI with advanced constraints"})]})),qe==="advanced"&&(Sn.length>0?Gn(Sn):g.jsxs("div",{className:"text-center py-12",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-cyan-100 dark:bg-cyan-900/20 rounded-full mb-4",children:g.jsx(Si,{className:"h-8 w-8 text-cyan-600 dark:text-cyan-400"})}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No Advanced exams created yet"}),g.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create exams with manual control"})]})),qe==="classic"&&(JA.length>0?Gn(JA):g.jsxs("div",{className:"text-center py-12",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full mb-4",children:g.jsx(Ti,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No Classic exams created yet"}),g.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create simple round-robin exams"})]}))]})]})]}),g.jsx("div",{className:"space-y-8",children:g.jsxs(zt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[g.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:g.jsx(IA,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Template Library"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Reuse configurations across exams"})]})]}),g.jsxs("div",{className:"space-y-8",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Hall Layout Templates"}),g.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.length," templates"]})]}),g.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 mb-4 space-y-3",children:[g.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Create New Template"}),g.jsxs("div",{className:"flex gap-2 flex-wrap",children:[g.jsxs(rt,{onClick:()=>{Q(!0),te(""),G({name:"",rows:"8",cols:"10"})},variant:"outline",size:"sm",className:"flex items-center gap-2",children:[g.jsx(Ti,{className:"h-4 w-4"}),"Grid Template"]}),g.jsxs(rt,{onClick:()=>I({mode:"create-template",hallIndex:null}),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[g.jsx(IA,{className:"h-4 w-4"}),"Custom Layout"]})]})]}),g.jsx("div",{className:"space-y-3",children:n.length>0?n.map(Y=>g.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-900/20 rounded",children:g.jsx(IA,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:Y.name}),g.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Y.layout.length," seats"]})]})]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>os(Y),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:g.jsx(Ff,{className:"h-4 w-4"})}),g.jsx("button",{onClick:()=>rl(Y.id),className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:g.jsx(bf,{className:"h-4 w-4"})})]})]},Y.id)):g.jsxs("div",{className:"text-center py-6",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full mb-3",children:g.jsx(IA,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No hall templates"})]})})]}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Student Set Templates"}),g.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.length," templates"]})]}),g.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 mb-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:Z?"Edit Template":"Create New Template"}),Z&&g.jsx("button",{type:"button",onClick:N,className:"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 underline",children:"Cancel Edit"})]}),g.jsxs("form",{onSubmit:Ai,className:"space-y-3",children:[g.jsx(It,{placeholder:"Subject / Code",value:k.subject,onChange:Y=>K({...k,subject:Y.target.value}),size:"sm"}),g.jsx(It,{type:"number",min:"1",placeholder:"Student Count",value:k.studentCount,onChange:Y=>K({...k,studentCount:Y.target.value}),size:"sm"}),P&&g.jsx("div",{className:"p-2 bg-red-50 dark:bg-red-900/10 rounded border border-red-200 dark:border-red-800",children:g.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:P})}),g.jsx(rt,{type:"submit",variant:"primary",size:"sm",className:"w-full",children:Z?"Update Template":"Save Template"})]})]}),g.jsx("div",{className:"space-y-3",children:s.length>0?s.map(Y=>g.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-1.5 bg-green-100 dark:bg-green-900/20 rounded",children:g.jsx(Ds,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:Y.subject}),g.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Y.studentCount," students"]})]})]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>ai(Y),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:g.jsx(Ff,{className:"h-4 w-4"})}),g.jsx("button",{onClick:()=>H(Y.id),className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:g.jsx(bf,{className:"h-4 w-4"})})]})]},Y.id)):g.jsxs("div",{className:"text-center py-6",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full mb-3",children:g.jsx(Ds,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No student set templates"})]})})]})]})]})})]}),Ft&&Ft.seatingPlan&&g.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px",zIndex:-1},children:Ft.halls.map(Y=>g.jsx("div",{ref:de=>{de&&(X.current[Y.id]=de)},style:{width:"800px",padding:"1px"},children:g.jsx(zt,{children:g.jsx($c,{hall:Y,plan:Ft.seatingPlan,studentSets:Ft.studentSets,seatDimensions:_f(Ft.studentSets)})})},Y.id))})]})]})},f$=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),d$=({className:e})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"})]}),Kl=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),h$=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),g$=({className:e})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),m$=({exams:e,onSelectExam:t})=>{const[r,n]=W.useState(new Date),A=W.useMemo(()=>e.reduce((T,_)=>{const F=_.date;return T[F]||(T[F]=[]),T[F].push(_),T},{}),[e]),s=()=>{n(new Date(r.getFullYear(),r.getMonth()-1,1))},l=()=>{n(new Date(r.getFullYear(),r.getMonth()+1,1))},o=r.getFullYear(),u=r.getMonth(),f=r.toLocaleString("default",{month:"long"}),d=new Date(o,u,1).getDay(),m=new Date(o,u+1,0).getDate(),x=Array.from({length:m},(T,_)=>_+1),y=Array.from({length:d}),C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E=T=>{const _=new Date;return T===_.getDate()&&u===_.getMonth()&&o===_.getFullYear()};return g.jsxs(zt,{className:"border border-slate-200 dark:border-slate-700 shadow-lg",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:g.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),g.jsxs("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-200",children:[f," ",o]}),g.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:g.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),g.jsxs("div",{className:"grid grid-cols-7 gap-px bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden border dark:border-slate-700",children:[C.map(T=>g.jsx("div",{className:"py-2 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-800",children:T},T)),y.map((T,_)=>g.jsx("div",{className:"bg-white dark:bg-slate-800 h-24 sm:h-32"},`empty-${_}`)),x.map(T=>{const _=`${o}-${String(u+1).padStart(2,"0")}-${String(T).padStart(2,"0")}`,F=A[_]||[],S=E(T);return g.jsxs("div",{className:"bg-white dark:bg-slate-800 h-24 sm:h-32 p-1 sm:p-2 flex flex-col relative transition-colors hover:bg-slate-50 dark:hover:bg-slate-750",children:[g.jsx("span",{className:`w-7 h-7 flex items-center justify-center rounded-full text-sm font-medium mb-1 ${S?"bg-violet-600 text-white shadow-md":"text-slate-700 dark:text-slate-300"}`,children:T}),g.jsx("div",{className:"flex-grow space-y-1 overflow-y-auto custom-scrollbar",children:F.map(I=>g.jsx("button",{onClick:()=>t(I),className:"w-full text-left p-1.5 rounded text-[10px] sm:text-xs font-medium bg-violet-100 text-violet-700 dark:bg-violet-500/20 dark:text-violet-300 hover:bg-violet-200 dark:hover:bg-violet-500/30 truncate transition-colors border-l-2 border-violet-500",title:I.title,children:I.title},I.id))})]},T)})]})]})},p$=({exams:e,onSelectExam:t})=>g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(r=>{const n=new Date(r.date),A=n.toLocaleString("default",{month:"short"}).toUpperCase(),s=n.getDate();return g.jsxs("div",{className:"group bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-lg border border-slate-200 dark:border-slate-700 p-0 overflow-hidden transition-all duration-300 cursor-pointer flex flex-col h-full",onClick:()=>t(r),role:"button",tabIndex:0,onKeyPress:l=>(l.key==="Enter"||l.key===" ")&&t(r),children:[g.jsxs("div",{className:"p-5 flex items-start gap-4 flex-grow",children:[g.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-lg w-16 h-16 border border-slate-200 dark:border-slate-600",children:[g.jsx("span",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:A}),g.jsx("span",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:s})]}),g.jsxs("div",{className:"flex-grow min-w-0",children:[g.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-1 truncate group-hover:text-violet-600 dark:group-hover:text-violet-400 transition-colors",children:r.title}),g.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:[r.halls.length," Hall",r.halls.length!==1?"s":"","  ",r.studentSets.length," Subject",r.studentSets.length!==1?"s":""]})]})]}),g.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/30 px-5 py-3 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[g.jsx("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"View details"}),g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-violet-500 transform group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]},r.id)})}),x$=()=>{var Q,U;const{user:e}=zi(),[t,r]=W.useState([]),[n,A]=W.useState(null),[s,l]=W.useState(!0),[o,u]=W.useState("calendar"),f=W.useRef({}),[d,m]=W.useState(""),[x,y]=W.useState(""),[C,E]=W.useState(null),T=W.useCallback((G,R)=>{var te;if(!G.seatingPlan)return null;for(const ne in G.seatingPlan){const ee=G.seatingPlan[ne];for(const ae of ee)for(const Se of ae)if(((te=Se==null?void 0:Se.student)==null?void 0:te.id)===R)return Se}return null},[]),_=n&&(e!=null&&e.registerNumber)?T(n,e.registerNumber):null,F=W.useCallback(G=>{if(!G)return;const R=setTimeout(()=>{const te=f.current[G.hallId],ne=document.querySelector("header");if(te&&ne){const ee=ne.offsetHeight,Se=te.getBoundingClientRect().top+window.scrollY,Te=window.innerHeight-ee,q=Se-Te/2+te.offsetHeight/2-ee;window.scrollTo({top:q,behavior:"smooth"})}else te&&te.scrollIntoView({behavior:"smooth",block:"center"})},150);return()=>clearTimeout(R)},[]);W.useEffect(()=>{(async()=>{if(!(e!=null&&e.registerNumber)||!e.adminId){l(!1);return}try{l(!0);const R=await PL(e.registerNumber,e.adminId);r(R.sort((te,ne)=>new Date(te.date).getTime()-new Date(ne.date).getTime()))}catch(R){console.error("Error fetching exams:",R)}finally{l(!1)}})()},[e]),W.useEffect(()=>{n&&_?(E(_),m((e==null?void 0:e.registerNumber)||""),F(_)):(E(null),m("")),y("")},[n,_,e==null?void 0:e.registerNumber,F]);const S=G=>{if(G.preventDefault(),!n||!d.trim())return;const R=T(n,d.trim());R?(E(R),y(""),F(R)):(E(null),y(`Register Number "${d.trim()}" not found in this exam.`))},I=()=>{_&&(E(_),m((e==null?void 0:e.registerNumber)||""),y(""),F(_))};if(s)return g.jsxs("div",{className:"min-h-screen",children:[g.jsx(za,{}),g.jsxs("main",{className:"max-w-4xl mx-auto py-12 px-4 text-center",children:[g.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600 mx-auto mb-4"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Loading your exam schedules..."})]})]});if(n){const G=C?n.halls.find(R=>R.id===C.hallId):null;return g.jsxs("div",{className:"min-h-screen",children:[g.jsx(za,{}),g.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[g.jsx("div",{className:"mb-6",children:g.jsxs(rt,{onClick:()=>A(null),variant:"secondary",className:"!px-3 !py-1 text-sm flex items-center gap-2",children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to My Schedules"]})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[g.jsxs(zt,{className:"border-t-4 border-t-violet-500",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:n.title}),g.jsxs("p",{className:"text-slate-500 dark:text-slate-400 flex items-center gap-2",children:[g.jsx(Kl,{className:"h-5 w-5 text-violet-500"}),new Date(n.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),g.jsxs(zt,{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-800/50",children:[g.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-200",children:"Find a Seat"}),g.jsxs("form",{onSubmit:S,className:"flex gap-2 mb-4",children:[g.jsx(It,{containerClassName:"flex-grow",id:"search-register-number",placeholder:"Enter Reg. Number",value:d,onChange:R=>m(R.target.value),className:"!bg-white dark:!bg-slate-900"}),g.jsx(rt,{type:"submit",className:"!px-3",children:g.jsx(f$,{className:"h-5 w-5"})})]}),x&&g.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-2 rounded border border-red-100 dark:border-red-900/30 mb-4",children:x}),C&&G?g.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[g.jsxs("div",{className:"bg-violet-600 text-white p-3 flex justify-between items-center",children:[g.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Exam Ticket"}),g.jsx(g$,{className:"h-5 w-5 opacity-80"})]}),g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex justify-between items-end border-b border-dashed border-slate-200 dark:border-slate-700 pb-3",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Student ID"}),g.jsx("p",{className:"text-lg font-mono font-bold text-slate-800 dark:text-slate-100",children:(Q=C.student)==null?void 0:Q.id})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Subject"}),g.jsx("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:(U=C.student)==null?void 0:U.setId})]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-1",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Hall"}),g.jsx("p",{className:"text-base font-bold text-violet-600 dark:text-violet-400",children:(G==null?void 0:G.name)||"N/A"})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Seat Position"}),g.jsxs("p",{className:"text-base font-bold text-slate-800 dark:text-slate-200",children:["R",C.row+1," - C",C.col+1]})]})]})]})]}):!x&&g.jsx("div",{className:"text-center py-6 text-slate-400 dark:text-slate-500 text-sm italic",children:"Enter a register number above to locate a specific seat."})]})]}),g.jsx("div",{className:"lg:col-span-2 space-y-8",children:n.seatingPlan?n.halls.map(R=>g.jsx("div",{ref:te=>{te&&(f.current[R.id]=te)},children:g.jsxs(zt,{className:"relative overflow-hidden",children:[(C==null?void 0:C.hallId)===R.id&&g.jsx("div",{className:"absolute top-0 right-0 bg-violet-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg shadow-md z-10",children:"Your Hall"}),g.jsx($c,{hall:R,plan:n.seatingPlan,studentSets:n.studentSets,highlightSeat:(C==null?void 0:C.hallId)===R.id?{row:C.row,col:C.col}:void 0})]})},R.id)):g.jsx(zt,{children:g.jsxs("div",{className:"text-center py-16",children:[g.jsx("div",{className:"inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-800 mb-4",children:g.jsx(Kl,{className:"h-8 w-8 text-slate-400"})}),g.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-slate-100",children:"Seating Plan Unavailable"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 max-w-sm mx-auto",children:"The administrator hasn't generated or published the seating arrangement for this exam yet. Please check back later."})]})})})]}),_&&g.jsxs("button",{onClick:I,className:"fixed bottom-8 right-8 bg-violet-600 text-white p-4 rounded-full shadow-xl hover:bg-violet-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-violet-300 z-50 flex items-center gap-2 group","aria-label":"Find my seat",title:"Find my seat",children:[g.jsx(d$,{className:"h-6 w-6"}),g.jsx("span",{className:"max-w-0 overflow-hidden group-hover:max-w-xs transition-all duration-300 whitespace-nowrap font-medium text-sm",children:"My Seat"})]})]})]})}const M=t.length>0?t[0]:null;return g.jsxs("div",{className:"min-h-screen",children:[g.jsx(za,{}),g.jsxs("main",{className:"max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"mb-8",children:[g.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100",children:["Hello, ",g.jsx("span",{className:"text-violet-600 dark:text-violet-400",children:(e==null?void 0:e.name)||"Student"}),"!"]}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Here is your examination schedule."})]}),M&&g.jsxs("div",{className:"mb-10 p-6 bg-gradient-to-r from-violet-600 to-indigo-600 rounded-2xl shadow-lg text-white relative overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white opacity-10 rounded-full blur-2xl"}),g.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[g.jsxs("div",{children:[g.jsx("div",{className:"text-violet-200 text-sm font-semibold uppercase tracking-wider mb-1",children:"Next Up"}),g.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-1",children:M.title}),g.jsxs("p",{className:"text-violet-100 flex items-center gap-2",children:[g.jsx(Kl,{className:"h-5 w-5"}),new Date(M.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]}),g.jsx(rt,{onClick:()=>A(M),className:"bg-white text-violet-700 hover:bg-violet-50 border-none shadow-none font-bold px-6 py-3",children:"View Details & Seat"})]})]}),g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end mb-6 gap-4 border-b border-slate-200 dark:border-slate-700 pb-4",children:[g.jsxs("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[g.jsx(Kl,{className:"h-6 w-6 text-slate-400"})," All Exams"]}),t.length>0&&g.jsxs("div",{className:"flex bg-slate-200 dark:bg-slate-700 rounded-lg p-1",children:[g.jsxs("button",{onClick:()=>u("calendar"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-sm font-medium transition-all ${o==="calendar"?"bg-white dark:bg-slate-600 text-violet-600 dark:text-violet-300 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:[g.jsx(Kl,{className:"h-4 w-4"})," Calendar"]}),g.jsxs("button",{onClick:()=>u("list"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-sm font-medium transition-all ${o==="list"?"bg-white dark:bg-slate-600 text-violet-600 dark:text-violet-300 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:[g.jsx(h$,{className:"h-4 w-4"})," List"]})]})]}),t.length>0?g.jsx("div",{className:"animate-fade-in-up",children:o==="calendar"?g.jsx(m$,{exams:t,onSelectExam:A}):g.jsx(p$,{exams:t,onSelectExam:A})}):g.jsxs("div",{className:"text-center py-20 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-700",children:[g.jsx("div",{className:"inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-700 mb-4",children:g.jsx(Kl,{className:"h-10 w-10 text-slate-400"})}),g.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-slate-100",children:"No Exams Scheduled"}),g.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 max-w-md mx-auto",children:"You don't have any upcoming exams assigned to your register number yet. Relax!"})]})]})]})},Km=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,user:n}=zi(),A=ns();return r?!n||!t.includes(n.role)?g.jsx(zm,{to:"/login",replace:!0}):g.jsx(g.Fragment,{children:e}):g.jsx(zm,{to:"/login",state:{from:A},replace:!0})},v$=()=>{const{user:e}=zi();return g.jsxs(Ok,{children:[g.jsx(jl,{path:"/login",element:g.jsx(xH,{})}),g.jsx(jl,{path:"/admin",element:g.jsx(Km,{allowedRoles:[xt.ADMIN],children:g.jsx($q,{})})}),g.jsx(jl,{path:"/teacher",element:g.jsx(Km,{allowedRoles:[xt.TEACHER],children:g.jsx(u$,{})})}),g.jsx(jl,{path:"/student",element:g.jsx(Km,{allowedRoles:[xt.STUDENT],children:g.jsx(x$,{})})}),g.jsx(jl,{path:"/",element:g.jsx(zm,{to:e?`/${e.role.toLowerCase()}`:"/login"})})]})},w$=()=>g.jsx(AH,{children:g.jsx(nH,{children:g.jsx(cN,{children:g.jsx(v$,{})})})}),Fb=document.getElementById("root");if(!Fb)throw new Error("Could not find root element to mount to");const y$=VU.createRoot(Fb);y$.render(g.jsx(RU.StrictMode,{children:g.jsx(w$,{})}));
