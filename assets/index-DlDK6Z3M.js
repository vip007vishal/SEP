(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function eS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wg={exports:{}},fc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy;function LU(){if(Hy)return fc;Hy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var o in a)o!=="key"&&(s[o]=a[o])}else s=a;return a=s.ref,{$$typeof:e,type:n,key:l,ref:a!==void 0?a:null,props:s}}return fc.Fragment=t,fc.jsx=r,fc.jsxs=r,fc}var Oy;function HU(){return Oy||(Oy=1,Wg.exports=LU()),Wg.exports}var h=HU(),Yg={exports:{}},_t={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py;function OU(){if(Py)return _t;Py=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),x=Symbol.iterator;function y(J){return J===null||typeof J!="object"?null:(J=x&&J[x]||J["@@iterator"],typeof J=="function"?J:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,S={};function T(J,k,V){this.props=J,this.context=k,this.refs=S,this.updater=V||E}T.prototype.isReactComponent={},T.prototype.setState=function(J,k){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,k,"setState")},T.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function F(){}F.prototype=T.prototype;function _(J,k,V){this.props=J,this.context=k,this.refs=S,this.updater=V||E}var Q=_.prototype=new F;Q.constructor=_,C(Q,T.prototype),Q.isPureReactComponent=!0;var L=Array.isArray;function R(){}var U={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function D(J,k,V){var P=V.ref;return{$$typeof:e,type:J,key:k,ref:P!==void 0?P:null,props:V}}function ee(J,k){return D(J.type,k,J.props)}function re(J){return typeof J=="object"&&J!==null&&J.$$typeof===e}function Z(J){var k={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(V){return k[V]})}var ae=/\/+/g;function Te(J,k){return typeof J=="object"&&J!==null&&J.key!=null?Z(""+J.key):k.toString(36)}function Se(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(R,R):(J.status="pending",J.then(function(k){J.status==="pending"&&(J.status="fulfilled",J.value=k)},function(k){J.status==="pending"&&(J.status="rejected",J.reason=k)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function q(J,k,V,P,z){var le=typeof J;(le==="undefined"||le==="boolean")&&(J=null);var Be=!1;if(J===null)Be=!0;else switch(le){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(J.$$typeof){case e:case t:Be=!0;break;case d:return Be=J._init,q(Be(J._payload),k,V,P,z)}}if(Be)return z=z(J),Be=P===""?"."+Te(J,0):P,L(z)?(V="",Be!=null&&(V=Be.replace(ae,"$&/")+"/"),q(z,k,V,"",function(ne){return ne})):z!=null&&(re(z)&&(z=ee(z,V+(z.key==null||J&&J.key===z.key?"":(""+z.key).replace(ae,"$&/")+"/")+Be)),k.push(z)),1;Be=0;var de=P===""?".":P+":";if(L(J))for(var ce=0;ce<J.length;ce++)P=J[ce],le=de+Te(P,ce),Be+=q(P,k,V,le,z);else if(ce=y(J),typeof ce=="function")for(J=ce.call(J),ce=0;!(P=J.next()).done;)P=P.value,le=de+Te(P,ce++),Be+=q(P,k,V,le,z);else if(le==="object"){if(typeof J.then=="function")return q(Se(J),k,V,P,z);throw k=String(J),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.")}return Be}function Ae(J,k,V){if(J==null)return J;var P=[],z=0;return q(J,P,"","",function(le){return k.call(V,le,z++)}),P}function Re(J){if(J._status===-1){var k=J._result;k=k(),k.then(function(V){(J._status===0||J._status===-1)&&(J._status=1,J._result=V)},function(V){(J._status===0||J._status===-1)&&(J._status=2,J._result=V)}),J._status===-1&&(J._status=0,J._result=k)}if(J._status===1)return J._result.default;throw J._result}var ie=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var k=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(k))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},Me={map:Ae,forEach:function(J,k,V){Ae(J,function(){k.apply(this,arguments)},V)},count:function(J){var k=0;return Ae(J,function(){k++}),k},toArray:function(J){return Ae(J,function(k){return k})||[]},only:function(J){if(!re(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return _t.Activity=m,_t.Children=Me,_t.Component=T,_t.Fragment=r,_t.Profiler=a,_t.PureComponent=_,_t.StrictMode=n,_t.Suspense=u,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,_t.__COMPILER_RUNTIME={__proto__:null,c:function(J){return U.H.useMemoCache(J)}},_t.cache=function(J){return function(){return J.apply(null,arguments)}},_t.cacheSignal=function(){return null},_t.cloneElement=function(J,k,V){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var P=C({},J.props),z=J.key;if(k!=null)for(le in k.key!==void 0&&(z=""+k.key),k)!K.call(k,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&k.ref===void 0||(P[le]=k[le]);var le=arguments.length-2;if(le===1)P.children=V;else if(1<le){for(var Be=Array(le),de=0;de<le;de++)Be[de]=arguments[de+2];P.children=Be}return D(J.type,z,P)},_t.createContext=function(J){return J={$$typeof:l,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:s,_context:J},J},_t.createElement=function(J,k,V){var P,z={},le=null;if(k!=null)for(P in k.key!==void 0&&(le=""+k.key),k)K.call(k,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(z[P]=k[P]);var Be=arguments.length-2;if(Be===1)z.children=V;else if(1<Be){for(var de=Array(Be),ce=0;ce<Be;ce++)de[ce]=arguments[ce+2];z.children=de}if(J&&J.defaultProps)for(P in Be=J.defaultProps,Be)z[P]===void 0&&(z[P]=Be[P]);return D(J,le,z)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(J){return{$$typeof:o,render:J}},_t.isValidElement=re,_t.lazy=function(J){return{$$typeof:d,_payload:{_status:-1,_result:J},_init:Re}},_t.memo=function(J,k){return{$$typeof:f,type:J,compare:k===void 0?null:k}},_t.startTransition=function(J){var k=U.T,V={};U.T=V;try{var P=J(),z=U.S;z!==null&&z(V,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(R,ie)}catch(le){ie(le)}finally{k!==null&&V.types!==null&&(k.types=V.types),U.T=k}},_t.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},_t.use=function(J){return U.H.use(J)},_t.useActionState=function(J,k,V){return U.H.useActionState(J,k,V)},_t.useCallback=function(J,k){return U.H.useCallback(J,k)},_t.useContext=function(J){return U.H.useContext(J)},_t.useDebugValue=function(){},_t.useDeferredValue=function(J,k){return U.H.useDeferredValue(J,k)},_t.useEffect=function(J,k){return U.H.useEffect(J,k)},_t.useEffectEvent=function(J){return U.H.useEffectEvent(J)},_t.useId=function(){return U.H.useId()},_t.useImperativeHandle=function(J,k,V){return U.H.useImperativeHandle(J,k,V)},_t.useInsertionEffect=function(J,k){return U.H.useInsertionEffect(J,k)},_t.useLayoutEffect=function(J,k){return U.H.useLayoutEffect(J,k)},_t.useMemo=function(J,k){return U.H.useMemo(J,k)},_t.useOptimistic=function(J,k){return U.H.useOptimistic(J,k)},_t.useReducer=function(J,k,V){return U.H.useReducer(J,k,V)},_t.useRef=function(J){return U.H.useRef(J)},_t.useState=function(J){return U.H.useState(J)},_t.useSyncExternalStore=function(J,k,V){return U.H.useSyncExternalStore(J,k,V)},_t.useTransition=function(){return U.H.useTransition()},_t.version="19.2.3",_t}var Gy;function Wp(){return Gy||(Gy=1,Yg.exports=OU()),Yg.exports}var X=Wp();const PU=eS(X);var qg={exports:{}},dc={},$g={exports:{}},Zg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vy;function GU(){return Vy||(Vy=1,(function(e){function t(q,Ae){var Re=q.length;q.push(Ae);e:for(;0<Re;){var ie=Re-1>>>1,Me=q[ie];if(0<a(Me,Ae))q[ie]=Ae,q[Re]=Me,Re=ie;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var Ae=q[0],Re=q.pop();if(Re!==Ae){q[0]=Re;e:for(var ie=0,Me=q.length,J=Me>>>1;ie<J;){var k=2*(ie+1)-1,V=q[k],P=k+1,z=q[P];if(0>a(V,Re))P<Me&&0>a(z,V)?(q[ie]=z,q[P]=Re,ie=P):(q[ie]=V,q[k]=Re,ie=k);else if(P<Me&&0>a(z,Re))q[ie]=z,q[P]=Re,ie=P;else break e}}return Ae}function a(q,Ae){var Re=q.sortIndex-Ae.sortIndex;return Re!==0?Re:q.id-Ae.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],f=[],d=1,m=null,x=3,y=!1,E=!1,C=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function Q(q){for(var Ae=r(f);Ae!==null;){if(Ae.callback===null)n(f);else if(Ae.startTime<=q)n(f),Ae.sortIndex=Ae.expirationTime,t(u,Ae);else break;Ae=r(f)}}function L(q){if(C=!1,Q(q),!E)if(r(u)!==null)E=!0,R||(R=!0,Z());else{var Ae=r(f);Ae!==null&&Se(L,Ae.startTime-q)}}var R=!1,U=-1,K=5,D=-1;function ee(){return S?!0:!(e.unstable_now()-D<K)}function re(){if(S=!1,R){var q=e.unstable_now();D=q;var Ae=!0;try{e:{E=!1,C&&(C=!1,F(U),U=-1),y=!0;var Re=x;try{t:{for(Q(q),m=r(u);m!==null&&!(m.expirationTime>q&&ee());){var ie=m.callback;if(typeof ie=="function"){m.callback=null,x=m.priorityLevel;var Me=ie(m.expirationTime<=q);if(q=e.unstable_now(),typeof Me=="function"){m.callback=Me,Q(q),Ae=!0;break t}m===r(u)&&n(u),Q(q)}else n(u);m=r(u)}if(m!==null)Ae=!0;else{var J=r(f);J!==null&&Se(L,J.startTime-q),Ae=!1}}break e}finally{m=null,x=Re,y=!1}Ae=void 0}}finally{Ae?Z():R=!1}}}var Z;if(typeof _=="function")Z=function(){_(re)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,Te=ae.port2;ae.port1.onmessage=re,Z=function(){Te.postMessage(null)}}else Z=function(){T(re,0)};function Se(q,Ae){U=T(function(){q(e.unstable_now())},Ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(q){switch(x){case 1:case 2:case 3:var Ae=3;break;default:Ae=x}var Re=x;x=Ae;try{return q()}finally{x=Re}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(q,Ae){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Re=x;x=q;try{return Ae()}finally{x=Re}},e.unstable_scheduleCallback=function(q,Ae,Re){var ie=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?ie+Re:ie):Re=ie,q){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=Re+Me,q={id:d++,callback:Ae,priorityLevel:q,startTime:Re,expirationTime:Me,sortIndex:-1},Re>ie?(q.sortIndex=Re,t(f,q),r(u)===null&&q===r(f)&&(C?(F(U),U=-1):C=!0,Se(L,Re-ie))):(q.sortIndex=Me,t(u,q),E||y||(E=!0,R||(R=!0,Z()))),q},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(q){var Ae=x;return function(){var Re=x;x=Ae;try{return q.apply(this,arguments)}finally{x=Re}}}})(Zg)),Zg}var Ky;function VU(){return Ky||(Ky=1,$g.exports=GU()),$g.exports}var em={exports:{}},Nn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy;function KU(){if(jy)return Nn;jy=1;var e=Wp();function t(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(u,f,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:u,containerInfo:f,implementation:d}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Nn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Nn.createPortal=function(u,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(u,f,null,d)},Nn.flushSync=function(u){var f=l.T,d=n.p;try{if(l.T=null,n.p=2,u)return u()}finally{l.T=f,n.p=d,n.d.f()}},Nn.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(u,f))},Nn.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},Nn.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var d=f.as,m=o(d,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:x,fetchPriority:y}):d==="script"&&n.d.X(u,{crossOrigin:m,integrity:x,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Nn.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=o(f.as,f.crossOrigin);n.d.M(u,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(u)},Nn.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,m=o(d,f.crossOrigin);n.d.L(u,d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Nn.preloadModule=function(u,f){if(typeof u=="string")if(f){var d=o(f.as,f.crossOrigin);n.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(u)},Nn.requestFormReset=function(u){n.d.r(u)},Nn.unstable_batchedUpdates=function(u,f){return u(f)},Nn.useFormState=function(u,f,d){return l.H.useFormState(u,f,d)},Nn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Nn.version="19.2.3",Nn}var zy;function jU(){if(zy)return em.exports;zy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),em.exports=KU(),em.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xy;function zU(){if(Xy)return dc;Xy=1;var e=VU(),t=Wp(),r=jU();function n(A){var i="https://react.dev/errors/"+A;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+A+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(A){return!(!A||A.nodeType!==1&&A.nodeType!==9&&A.nodeType!==11)}function s(A){var i=A,c=A;if(A.alternate)for(;i.return;)i=i.return;else{A=i;do i=A,(i.flags&4098)!==0&&(c=i.return),A=i.return;while(A)}return i.tag===3?c:null}function l(A){if(A.tag===13){var i=A.memoizedState;if(i===null&&(A=A.alternate,A!==null&&(i=A.memoizedState)),i!==null)return i.dehydrated}return null}function o(A){if(A.tag===31){var i=A.memoizedState;if(i===null&&(A=A.alternate,A!==null&&(i=A.memoizedState)),i!==null)return i.dehydrated}return null}function u(A){if(s(A)!==A)throw Error(n(188))}function f(A){var i=A.alternate;if(!i){if(i=s(A),i===null)throw Error(n(188));return i!==A?null:A}for(var c=A,g=i;;){var w=c.return;if(w===null)break;var B=w.alternate;if(B===null){if(g=w.return,g!==null){c=g;continue}break}if(w.child===B.child){for(B=w.child;B;){if(B===c)return u(w),A;if(B===g)return u(w),i;B=B.sibling}throw Error(n(188))}if(c.return!==g.return)c=w,g=B;else{for(var b=!1,M=w.child;M;){if(M===c){b=!0,c=w,g=B;break}if(M===g){b=!0,g=w,c=B;break}M=M.sibling}if(!b){for(M=B.child;M;){if(M===c){b=!0,c=B,g=w;break}if(M===g){b=!0,g=B,c=w;break}M=M.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==g)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?A:i}function d(A){var i=A.tag;if(i===5||i===26||i===27||i===6)return A;for(A=A.child;A!==null;){if(i=d(A),i!==null)return i;A=A.sibling}return null}var m=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),_=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function Z(A){return A===null||typeof A!="object"?null:(A=re&&A[re]||A["@@iterator"],typeof A=="function"?A:null)}var ae=Symbol.for("react.client.reference");function Te(A){if(A==null)return null;if(typeof A=="function")return A.$$typeof===ae?null:A.displayName||A.name||null;if(typeof A=="string")return A;switch(A){case C:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case L:return"Suspense";case R:return"SuspenseList";case D:return"Activity"}if(typeof A=="object")switch(A.$$typeof){case E:return"Portal";case _:return A.displayName||"Context";case F:return(A._context.displayName||"Context")+".Consumer";case Q:var i=A.render;return A=A.displayName,A||(A=i.displayName||i.name||"",A=A!==""?"ForwardRef("+A+")":"ForwardRef"),A;case U:return i=A.displayName||null,i!==null?i:Te(A.type)||"Memo";case K:i=A._payload,A=A._init;try{return Te(A(i))}catch{}}return null}var Se=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},ie=[],Me=-1;function J(A){return{current:A}}function k(A){0>Me||(A.current=ie[Me],ie[Me]=null,Me--)}function V(A,i){Me++,ie[Me]=A.current,A.current=i}var P=J(null),z=J(null),le=J(null),Be=J(null);function de(A,i){switch(V(le,i),V(z,A),V(P,null),i.nodeType){case 9:case 11:A=(A=i.documentElement)&&(A=A.namespaceURI)?ly(A):0;break;default:if(A=i.tagName,i=i.namespaceURI)i=ly(i),A=oy(i,A);else switch(A){case"svg":A=1;break;case"math":A=2;break;default:A=0}}k(P),V(P,A)}function ce(){k(P),k(z),k(le)}function ne(A){A.memoizedState!==null&&V(Be,A);var i=P.current,c=oy(i,A.type);i!==c&&(V(z,A),V(P,c))}function Ce(A){z.current===A&&(k(P),k(z)),Be.current===A&&(k(Be),lc._currentValue=Re)}var N,Ie;function Pe(A){if(N===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);N=i&&i[1]||"",Ie=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+N+A+Ie}var Ye=!1;function et(A,i){if(!A||Ye)return"";Ye=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(i){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(Ee){var we=Ee}Reflect.construct(A,[],ke)}else{try{ke.call()}catch(Ee){we=Ee}A.call(ke.prototype)}}else{try{throw Error()}catch(Ee){we=Ee}(ke=A())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(Ee){if(Ee&&we&&typeof Ee.stack=="string")return[Ee.stack,we.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=g.DetermineComponentFrameRoot(),b=B[0],M=B[1];if(b&&M){var te=b.split(`
`),ge=M.split(`
`);for(w=g=0;g<te.length&&!te[g].includes("DetermineComponentFrameRoot");)g++;for(;w<ge.length&&!ge[w].includes("DetermineComponentFrameRoot");)w++;if(g===te.length||w===ge.length)for(g=te.length-1,w=ge.length-1;1<=g&&0<=w&&te[g]!==ge[w];)w--;for(;1<=g&&0<=w;g--,w--)if(te[g]!==ge[w]){if(g!==1||w!==1)do if(g--,w--,0>w||te[g]!==ge[w]){var Fe=`
`+te[g].replace(" at new "," at ");return A.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",A.displayName)),Fe}while(1<=g&&0<=w);break}}}finally{Ye=!1,Error.prepareStackTrace=c}return(c=A?A.displayName||A.name:"")?Pe(c):""}function He(A,i){switch(A.tag){case 26:case 27:case 5:return Pe(A.type);case 16:return Pe("Lazy");case 13:return A.child!==i&&i!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return et(A.type,!1);case 11:return et(A.type.render,!1);case 1:return et(A.type,!0);case 31:return Pe("Activity");default:return""}}function ft(A){try{var i="",c=null;do i+=He(A,c),c=A,A=A.return;while(A);return i}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Et=Object.prototype.hasOwnProperty,lr=e.unstable_scheduleCallback,Jt=e.unstable_cancelCallback,Er=e.unstable_shouldYield,Zr=e.unstable_requestPaint,dt=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,je=e.unstable_ImmediatePriority,bt=e.unstable_UserBlockingPriority,ht=e.unstable_NormalPriority,Tt=e.unstable_LowPriority,$e=e.unstable_IdlePriority,vt=e.log,Nt=e.unstable_setDisableYieldValue,Bt=null,qt=null;function jr(A){if(typeof vt=="function"&&Nt(A),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(Bt,A)}catch{}}var Sr=Math.clz32?Math.clz32:br,Ea=Math.log,Sa=Math.LN2;function br(A){return A>>>=0,A===0?32:31-(Ea(A)/Sa|0)|0}var gt=256,Mr=262144,Br=4194304;function Ar(A){var i=A&42;if(i!==0)return i;switch(A&-A){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return A&261888;case 262144:case 524288:case 1048576:case 2097152:return A&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return A&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return A}}function bA(A,i,c){var g=A.pendingLanes;if(g===0)return 0;var w=0,B=A.suspendedLanes,b=A.pingedLanes;A=A.warmLanes;var M=g&134217727;return M!==0?(g=M&~B,g!==0?w=Ar(g):(b&=M,b!==0?w=Ar(b):c||(c=M&~A,c!==0&&(w=Ar(c))))):(M=g&~B,M!==0?w=Ar(M):b!==0?w=Ar(b):c||(c=g&~A,c!==0&&(w=Ar(c)))),w===0?0:i!==0&&i!==w&&(i&B)===0&&(B=w&-w,c=i&-i,B>=c||B===32&&(c&4194048)!==0)?i:w}function FA(A,i){return(A.pendingLanes&~(A.suspendedLanes&~A.pingedLanes)&i)===0}function rl(A,i){switch(A){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nl(){var A=Br;return Br<<=1,(Br&62914560)===0&&(Br=4194304),A}function si(A){for(var i=[],c=0;31>c;c++)i.push(A);return i}function fA(A,i){A.pendingLanes|=i,i!==268435456&&(A.suspendedLanes=0,A.pingedLanes=0,A.warmLanes=0)}function Eo(A,i,c,g,w,B){var b=A.pendingLanes;A.pendingLanes=c,A.suspendedLanes=0,A.pingedLanes=0,A.warmLanes=0,A.expiredLanes&=c,A.entangledLanes&=c,A.errorRecoveryDisabledLanes&=c,A.shellSuspendCounter=0;var M=A.entanglements,te=A.expirationTimes,ge=A.hiddenUpdates;for(c=b&~c;0<c;){var Fe=31-Sr(c),ke=1<<Fe;M[Fe]=0,te[Fe]=-1;var we=ge[Fe];if(we!==null)for(ge[Fe]=null,Fe=0;Fe<we.length;Fe++){var Ee=we[Fe];Ee!==null&&(Ee.lane&=-536870913)}c&=~ke}g!==0&&al(A,g,0),B!==0&&w===0&&A.tag!==0&&(A.suspendedLanes|=B&~(b&~i))}function al(A,i,c){A.pendingLanes|=i,A.suspendedLanes&=~i;var g=31-Sr(i);A.entangledLanes|=i,A.entanglements[g]=A.entanglements[g]|1073741824|c&261930}function us(A,i){var c=A.entangledLanes|=i;for(A=A.entanglements;c;){var g=31-Sr(c),w=1<<g;w&i|A[g]&i&&(A[g]|=i),c&=~w}}function Al(A,i){var c=i&-i;return c=(c&42)!==0?1:ii(c),(c&(A.suspendedLanes|i))!==0?0:c}function ii(A){switch(A){case 2:A=1;break;case 8:A=4;break;case 32:A=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:A=128;break;case 268435456:A=134217728;break;default:A=0}return A}function li(A){return A&=-A,2<A?8<A?(A&134217727)!==0?32:268435456:8:2}function I(){var A=Ae.p;return A!==0?A:(A=window.event,A===void 0?32:Ny(A.type))}function j(A,i){var c=Ae.p;try{return Ae.p=A,i()}finally{Ae.p=c}}var H=Math.random().toString(36).slice(2),O="__reactFiber$"+H,G="__reactProps$"+H,W="__reactContainer$"+H,me="__reactEvents$"+H,be="__reactListeners$"+H,pe="__reactHandles$"+H,xe="__reactResources$"+H,ve="__reactMarker$"+H;function Le(A){delete A[O],delete A[G],delete A[me],delete A[be],delete A[pe]}function Ge(A){var i=A[O];if(i)return i;for(var c=A.parentNode;c;){if(i=c[W]||c[O]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(A=my(A);A!==null;){if(c=A[O])return c;A=my(A)}return i}A=c,c=A.parentNode}return null}function We(A){if(A=A[O]||A[W]){var i=A.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return A}return null}function Oe(A){var i=A.tag;if(i===5||i===26||i===27||i===6)return A.stateNode;throw Error(n(33))}function Je(A){var i=A[xe];return i||(i=A[xe]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function at(A){A[ve]=!0}var hr=new Set,Dt={};function gr(A,i){kn(A,i),kn(A+"Capture",i)}function kn(A,i){for(Dt[A]=i,A=0;A<i.length;A++)hr.add(i[A])}var $a=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ta={},jn={};function fs(A){return Et.call(jn,A)?!0:Et.call(Ta,A)?!1:$a.test(A)?jn[A]=!0:(Ta[A]=!0,!1)}function yn(A,i,c){if(fs(i))if(c===null)A.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":A.removeAttribute(i);return;case"boolean":var g=i.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){A.removeAttribute(i);return}}A.setAttribute(i,""+c)}}function oi(A,i,c){if(c===null)A.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":A.removeAttribute(i);return}A.setAttribute(i,""+c)}}function _a(A,i,c,g){if(g===null)A.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":A.removeAttribute(c);return}A.setAttributeNS(i,c,""+g)}}function Y(A){switch(typeof A){case"bigint":case"boolean":case"number":case"string":case"undefined":return A;case"object":return A;default:return""}}function fe(A){var i=A.type;return(A=A.nodeName)&&A.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ne(A,i,c){var g=Object.getOwnPropertyDescriptor(A.constructor.prototype,i);if(!A.hasOwnProperty(i)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,B=g.set;return Object.defineProperty(A,i,{configurable:!0,get:function(){return w.call(this)},set:function(b){c=""+b,B.call(this,b)}}),Object.defineProperty(A,i,{enumerable:g.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){A._valueTracker=null,delete A[i]}}}}function De(A){if(!A._valueTracker){var i=fe(A)?"checked":"value";A._valueTracker=Ne(A,i,""+A[i])}}function ye(A){if(!A)return!1;var i=A._valueTracker;if(!i)return!0;var c=i.getValue(),g="";return A&&(g=fe(A)?A.checked?"true":"false":A.value),A=g,A!==c?(i.setValue(A),!0):!1}function Ve(A){if(A=A||(typeof document<"u"?document:void 0),typeof A>"u")return null;try{return A.activeElement||A.body}catch{return A.body}}var it=/[\n"\\]/g;function lt(A){return A.replace(it,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function zt(A,i,c,g,w,B,b,M){A.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?A.type=b:A.removeAttribute("type"),i!=null?b==="number"?(i===0&&A.value===""||A.value!=i)&&(A.value=""+Y(i)):A.value!==""+Y(i)&&(A.value=""+Y(i)):b!=="submit"&&b!=="reset"||A.removeAttribute("value"),i!=null?Ht(A,b,Y(i)):c!=null?Ht(A,b,Y(c)):g!=null&&A.removeAttribute("value"),w==null&&B!=null&&(A.defaultChecked=!!B),w!=null&&(A.checked=w&&typeof w!="function"&&typeof w!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?A.name=""+Y(M):A.removeAttribute("name")}function mr(A,i,c,g,w,B,b,M){if(B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(A.type=B),i!=null||c!=null){if(!(B!=="submit"&&B!=="reset"||i!=null)){De(A);return}c=c!=null?""+Y(c):"",i=i!=null?""+Y(i):c,M||i===A.value||(A.value=i),A.defaultValue=i}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,A.checked=M?A.checked:!!g,A.defaultChecked=!!g,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(A.name=b),De(A)}function Ht(A,i,c){i==="number"&&Ve(A.ownerDocument)===A||A.defaultValue===""+c||(A.defaultValue=""+c)}function It(A,i,c,g){if(A=A.options,i){i={};for(var w=0;w<c.length;w++)i["$"+c[w]]=!0;for(c=0;c<A.length;c++)w=i.hasOwnProperty("$"+A[c].value),A[c].selected!==w&&(A[c].selected=w),w&&g&&(A[c].defaultSelected=!0)}else{for(c=""+Y(c),i=null,w=0;w<A.length;w++){if(A[w].value===c){A[w].selected=!0,g&&(A[w].defaultSelected=!0);return}i!==null||A[w].disabled||(i=A[w])}i!==null&&(i.selected=!0)}}function en(A,i,c){if(i!=null&&(i=""+Y(i),i!==A.value&&(A.value=i),c==null)){A.defaultValue!==i&&(A.defaultValue=i);return}A.defaultValue=c!=null?""+Y(c):""}function Tr(A,i,c,g){if(i==null){if(g!=null){if(c!=null)throw Error(n(92));if(Se(g)){if(1<g.length)throw Error(n(93));g=g[0]}c=g}c==null&&(c=""),i=c}c=Y(i),A.defaultValue=c,g=A.textContent,g===c&&g!==""&&g!==null&&(A.value=g),De(A)}function mt(A,i){if(i){var c=A.firstChild;if(c&&c===A.lastChild&&c.nodeType===3){c.nodeValue=i;return}}A.textContent=i}var ot=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sr(A,i,c){var g=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?g?A.setProperty(i,""):i==="float"?A.cssFloat="":A[i]="":g?A.setProperty(i,c):typeof c!="number"||c===0||ot.has(i)?i==="float"?A.cssFloat=c:A[i]=(""+c).trim():A[i]=c+"px"}function rr(A,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(A=A.style,c!=null){for(var g in c)!c.hasOwnProperty(g)||i!=null&&i.hasOwnProperty(g)||(g.indexOf("--")===0?A.setProperty(g,""):g==="float"?A.cssFloat="":A[g]="");for(var w in i)g=i[w],i.hasOwnProperty(w)&&c[w]!==g&&sr(A,w,g)}else for(var B in i)i.hasOwnProperty(B)&&sr(A,B,i[B])}function Ct(A){if(A.indexOf("-")===-1)return!1;switch(A){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Uu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function sl(A){return Uu.test(""+A)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":A}function UA(){}var zd=null;function Xd(A){return A=A.target||A.srcElement||window,A.correspondingUseElement&&(A=A.correspondingUseElement),A.nodeType===3?A.parentNode:A}var il=null,ll=null;function iv(A){var i=We(A);if(i&&(A=i.stateNode)){var c=A[G]||null;e:switch(A=i.stateNode,i.type){case"input":if(zt(A,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=A;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+lt(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var g=c[i];if(g!==A&&g.form===A.form){var w=g[G]||null;if(!w)throw Error(n(90));zt(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(i=0;i<c.length;i++)g=c[i],g.form===A.form&&ye(g)}break e;case"textarea":en(A,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&It(A,!!c.multiple,i,!1)}}}var Jd=!1;function lv(A,i,c){if(Jd)return A(i,c);Jd=!0;try{var g=A(i);return g}finally{if(Jd=!1,(il!==null||ll!==null)&&(p0(),il&&(i=il,A=ll,ll=il=null,iv(i),A)))for(i=0;i<A.length;i++)iv(A[i])}}function So(A,i){var c=A.stateNode;if(c===null)return null;var g=c[G]||null;if(g===null)return null;c=g[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(A=A.type,g=!(A==="button"||A==="input"||A==="select"||A==="textarea")),A=!g;break e;default:A=!1}if(A)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var kA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wd=!1;if(kA)try{var To={};Object.defineProperty(To,"passive",{get:function(){Wd=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{Wd=!1}var ds=null,Yd=null,ku=null;function ov(){if(ku)return ku;var A,i=Yd,c=i.length,g,w="value"in ds?ds.value:ds.textContent,B=w.length;for(A=0;A<c&&i[A]===w[A];A++);var b=c-A;for(g=1;g<=b&&i[c-g]===w[B-g];g++);return ku=w.slice(A,1<g?1-g:void 0)}function Nu(A){var i=A.keyCode;return"charCode"in A?(A=A.charCode,A===0&&i===13&&(A=13)):A=i,A===10&&(A=13),32<=A||A===13?A:0}function Iu(){return!0}function cv(){return!1}function Zn(A){function i(c,g,w,B,b){this._reactName=c,this._targetInst=w,this.type=g,this.nativeEvent=B,this.target=b,this.currentTarget=null;for(var M in A)A.hasOwnProperty(M)&&(c=A[M],this[M]=c?c(B):B[M]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?Iu:cv,this.isPropagationStopped=cv,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Iu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Iu)},persist:function(){},isPersistent:Iu}),i}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(A){return A.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qu=Zn(ci),_o=m({},ci,{view:0,detail:0}),D4=Zn(_o),qd,$d,bo,Ru=m({},_o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eh,button:0,buttons:0,relatedTarget:function(A){return A.relatedTarget===void 0?A.fromElement===A.srcElement?A.toElement:A.fromElement:A.relatedTarget},movementX:function(A){return"movementX"in A?A.movementX:(A!==bo&&(bo&&A.type==="mousemove"?(qd=A.screenX-bo.screenX,$d=A.screenY-bo.screenY):$d=qd=0,bo=A),qd)},movementY:function(A){return"movementY"in A?A.movementY:$d}}),uv=Zn(Ru),M4=m({},Ru,{dataTransfer:0}),L4=Zn(M4),H4=m({},_o,{relatedTarget:0}),Zd=Zn(H4),O4=m({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),P4=Zn(O4),G4=m({},ci,{clipboardData:function(A){return"clipboardData"in A?A.clipboardData:window.clipboardData}}),V4=Zn(G4),K4=m({},ci,{data:0}),fv=Zn(K4),j4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},X4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function J4(A){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(A):(A=X4[A])?!!i[A]:!1}function eh(){return J4}var W4=m({},_o,{key:function(A){if(A.key){var i=j4[A.key]||A.key;if(i!=="Unidentified")return i}return A.type==="keypress"?(A=Nu(A),A===13?"Enter":String.fromCharCode(A)):A.type==="keydown"||A.type==="keyup"?z4[A.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eh,charCode:function(A){return A.type==="keypress"?Nu(A):0},keyCode:function(A){return A.type==="keydown"||A.type==="keyup"?A.keyCode:0},which:function(A){return A.type==="keypress"?Nu(A):A.type==="keydown"||A.type==="keyup"?A.keyCode:0}}),Y4=Zn(W4),q4=m({},Ru,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dv=Zn(q4),$4=m({},_o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eh}),Z4=Zn($4),eF=m({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),tF=Zn(eF),rF=m({},Ru,{deltaX:function(A){return"deltaX"in A?A.deltaX:"wheelDeltaX"in A?-A.wheelDeltaX:0},deltaY:function(A){return"deltaY"in A?A.deltaY:"wheelDeltaY"in A?-A.wheelDeltaY:"wheelDelta"in A?-A.wheelDelta:0},deltaZ:0,deltaMode:0}),nF=Zn(rF),aF=m({},ci,{newState:0,oldState:0}),AF=Zn(aF),sF=[9,13,27,32],th=kA&&"CompositionEvent"in window,Fo=null;kA&&"documentMode"in document&&(Fo=document.documentMode);var iF=kA&&"TextEvent"in window&&!Fo,hv=kA&&(!th||Fo&&8<Fo&&11>=Fo),gv=" ",mv=!1;function pv(A,i){switch(A){case"keyup":return sF.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xv(A){return A=A.detail,typeof A=="object"&&"data"in A?A.data:null}var ol=!1;function lF(A,i){switch(A){case"compositionend":return xv(i);case"keypress":return i.which!==32?null:(mv=!0,gv);case"textInput":return A=i.data,A===gv&&mv?null:A;default:return null}}function oF(A,i){if(ol)return A==="compositionend"||!th&&pv(A,i)?(A=ov(),ku=Yd=ds=null,ol=!1,A):null;switch(A){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return hv&&i.locale!=="ko"?null:i.data;default:return null}}var cF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vv(A){var i=A&&A.nodeName&&A.nodeName.toLowerCase();return i==="input"?!!cF[A.type]:i==="textarea"}function wv(A,i,c,g){il?ll?ll.push(g):ll=[g]:il=g,i=E0(i,"onChange"),0<i.length&&(c=new Qu("onChange","change",null,c,g),A.push({event:c,listeners:i}))}var Uo=null,ko=null;function uF(A){ry(A,0)}function Du(A){var i=Oe(A);if(ye(i))return A}function yv(A,i){if(A==="change")return i}var Bv=!1;if(kA){var rh;if(kA){var nh="oninput"in document;if(!nh){var Cv=document.createElement("div");Cv.setAttribute("oninput","return;"),nh=typeof Cv.oninput=="function"}rh=nh}else rh=!1;Bv=rh&&(!document.documentMode||9<document.documentMode)}function Ev(){Uo&&(Uo.detachEvent("onpropertychange",Sv),ko=Uo=null)}function Sv(A){if(A.propertyName==="value"&&Du(ko)){var i=[];wv(i,ko,A,Xd(A)),lv(uF,i)}}function fF(A,i,c){A==="focusin"?(Ev(),Uo=i,ko=c,Uo.attachEvent("onpropertychange",Sv)):A==="focusout"&&Ev()}function dF(A){if(A==="selectionchange"||A==="keyup"||A==="keydown")return Du(ko)}function hF(A,i){if(A==="click")return Du(i)}function gF(A,i){if(A==="input"||A==="change")return Du(i)}function mF(A,i){return A===i&&(A!==0||1/A===1/i)||A!==A&&i!==i}var oa=typeof Object.is=="function"?Object.is:mF;function No(A,i){if(oa(A,i))return!0;if(typeof A!="object"||A===null||typeof i!="object"||i===null)return!1;var c=Object.keys(A),g=Object.keys(i);if(c.length!==g.length)return!1;for(g=0;g<c.length;g++){var w=c[g];if(!Et.call(i,w)||!oa(A[w],i[w]))return!1}return!0}function Tv(A){for(;A&&A.firstChild;)A=A.firstChild;return A}function _v(A,i){var c=Tv(A);A=0;for(var g;c;){if(c.nodeType===3){if(g=A+c.textContent.length,A<=i&&g>=i)return{node:c,offset:i-A};A=g}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Tv(c)}}function bv(A,i){return A&&i?A===i?!0:A&&A.nodeType===3?!1:i&&i.nodeType===3?bv(A,i.parentNode):"contains"in A?A.contains(i):A.compareDocumentPosition?!!(A.compareDocumentPosition(i)&16):!1:!1}function Fv(A){A=A!=null&&A.ownerDocument!=null&&A.ownerDocument.defaultView!=null?A.ownerDocument.defaultView:window;for(var i=Ve(A.document);i instanceof A.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)A=i.contentWindow;else break;i=Ve(A.document)}return i}function ah(A){var i=A&&A.nodeName&&A.nodeName.toLowerCase();return i&&(i==="input"&&(A.type==="text"||A.type==="search"||A.type==="tel"||A.type==="url"||A.type==="password")||i==="textarea"||A.contentEditable==="true")}var pF=kA&&"documentMode"in document&&11>=document.documentMode,cl=null,Ah=null,Io=null,sh=!1;function Uv(A,i,c){var g=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;sh||cl==null||cl!==Ve(g)||(g=cl,"selectionStart"in g&&ah(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Io&&No(Io,g)||(Io=g,g=E0(Ah,"onSelect"),0<g.length&&(i=new Qu("onSelect","select",null,i,c),A.push({event:i,listeners:g}),i.target=cl)))}function ui(A,i){var c={};return c[A.toLowerCase()]=i.toLowerCase(),c["Webkit"+A]="webkit"+i,c["Moz"+A]="moz"+i,c}var ul={animationend:ui("Animation","AnimationEnd"),animationiteration:ui("Animation","AnimationIteration"),animationstart:ui("Animation","AnimationStart"),transitionrun:ui("Transition","TransitionRun"),transitionstart:ui("Transition","TransitionStart"),transitioncancel:ui("Transition","TransitionCancel"),transitionend:ui("Transition","TransitionEnd")},ih={},kv={};kA&&(kv=document.createElement("div").style,"AnimationEvent"in window||(delete ul.animationend.animation,delete ul.animationiteration.animation,delete ul.animationstart.animation),"TransitionEvent"in window||delete ul.transitionend.transition);function fi(A){if(ih[A])return ih[A];if(!ul[A])return A;var i=ul[A],c;for(c in i)if(i.hasOwnProperty(c)&&c in kv)return ih[A]=i[c];return A}var Nv=fi("animationend"),Iv=fi("animationiteration"),Qv=fi("animationstart"),xF=fi("transitionrun"),vF=fi("transitionstart"),wF=fi("transitioncancel"),Rv=fi("transitionend"),Dv=new Map,lh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lh.push("scrollEnd");function Za(A,i){Dv.set(A,i),gr(i,[A])}var Mu=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},ba=[],fl=0,oh=0;function Lu(){for(var A=fl,i=oh=fl=0;i<A;){var c=ba[i];ba[i++]=null;var g=ba[i];ba[i++]=null;var w=ba[i];ba[i++]=null;var B=ba[i];if(ba[i++]=null,g!==null&&w!==null){var b=g.pending;b===null?w.next=w:(w.next=b.next,b.next=w),g.pending=w}B!==0&&Mv(c,w,B)}}function Hu(A,i,c,g){ba[fl++]=A,ba[fl++]=i,ba[fl++]=c,ba[fl++]=g,oh|=g,A.lanes|=g,A=A.alternate,A!==null&&(A.lanes|=g)}function ch(A,i,c,g){return Hu(A,i,c,g),Ou(A)}function di(A,i){return Hu(A,null,null,i),Ou(A)}function Mv(A,i,c){A.lanes|=c;var g=A.alternate;g!==null&&(g.lanes|=c);for(var w=!1,B=A.return;B!==null;)B.childLanes|=c,g=B.alternate,g!==null&&(g.childLanes|=c),B.tag===22&&(A=B.stateNode,A===null||A._visibility&1||(w=!0)),A=B,B=B.return;return A.tag===3?(B=A.stateNode,w&&i!==null&&(w=31-Sr(c),A=B.hiddenUpdates,g=A[w],g===null?A[w]=[i]:g.push(i),i.lane=c|536870912),B):null}function Ou(A){if(50<tc)throw tc=0,vg=null,Error(n(185));for(var i=A.return;i!==null;)A=i,i=A.return;return A.tag===3?A.stateNode:null}var dl={};function yF(A,i,c,g){this.tag=A,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ca(A,i,c,g){return new yF(A,i,c,g)}function uh(A){return A=A.prototype,!(!A||!A.isReactComponent)}function NA(A,i){var c=A.alternate;return c===null?(c=ca(A.tag,i,A.key,A.mode),c.elementType=A.elementType,c.type=A.type,c.stateNode=A.stateNode,c.alternate=A,A.alternate=c):(c.pendingProps=i,c.type=A.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=A.flags&65011712,c.childLanes=A.childLanes,c.lanes=A.lanes,c.child=A.child,c.memoizedProps=A.memoizedProps,c.memoizedState=A.memoizedState,c.updateQueue=A.updateQueue,i=A.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=A.sibling,c.index=A.index,c.ref=A.ref,c.refCleanup=A.refCleanup,c}function Lv(A,i){A.flags&=65011714;var c=A.alternate;return c===null?(A.childLanes=0,A.lanes=i,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=c.childLanes,A.lanes=c.lanes,A.child=c.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=c.memoizedProps,A.memoizedState=c.memoizedState,A.updateQueue=c.updateQueue,A.type=c.type,i=c.dependencies,A.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),A}function Pu(A,i,c,g,w,B){var b=0;if(g=A,typeof A=="function")uh(A)&&(b=1);else if(typeof A=="string")b=TU(A,c,P.current)?26:A==="html"||A==="head"||A==="body"?27:5;else e:switch(A){case D:return A=ca(31,c,i,w),A.elementType=D,A.lanes=B,A;case C:return hi(c.children,w,B,i);case S:b=8,w|=24;break;case T:return A=ca(12,c,i,w|2),A.elementType=T,A.lanes=B,A;case L:return A=ca(13,c,i,w),A.elementType=L,A.lanes=B,A;case R:return A=ca(19,c,i,w),A.elementType=R,A.lanes=B,A;default:if(typeof A=="object"&&A!==null)switch(A.$$typeof){case _:b=10;break e;case F:b=9;break e;case Q:b=11;break e;case U:b=14;break e;case K:b=16,g=null;break e}b=29,c=Error(n(130,A===null?"null":typeof A,"")),g=null}return i=ca(b,c,i,w),i.elementType=A,i.type=g,i.lanes=B,i}function hi(A,i,c,g){return A=ca(7,A,g,i),A.lanes=c,A}function fh(A,i,c){return A=ca(6,A,null,i),A.lanes=c,A}function Hv(A){var i=ca(18,null,null,0);return i.stateNode=A,i}function dh(A,i,c){return i=ca(4,A.children!==null?A.children:[],A.key,i),i.lanes=c,i.stateNode={containerInfo:A.containerInfo,pendingChildren:null,implementation:A.implementation},i}var Ov=new WeakMap;function Fa(A,i){if(typeof A=="object"&&A!==null){var c=Ov.get(A);return c!==void 0?c:(i={value:A,source:i,stack:ft(i)},Ov.set(A,i),i)}return{value:A,source:i,stack:ft(i)}}var hl=[],gl=0,Gu=null,Qo=0,Ua=[],ka=0,hs=null,dA=1,hA="";function IA(A,i){hl[gl++]=Qo,hl[gl++]=Gu,Gu=A,Qo=i}function Pv(A,i,c){Ua[ka++]=dA,Ua[ka++]=hA,Ua[ka++]=hs,hs=A;var g=dA;A=hA;var w=32-Sr(g)-1;g&=~(1<<w),c+=1;var B=32-Sr(i)+w;if(30<B){var b=w-w%5;B=(g&(1<<b)-1).toString(32),g>>=b,w-=b,dA=1<<32-Sr(i)+w|c<<w|g,hA=B+A}else dA=1<<B|c<<w|g,hA=A}function hh(A){A.return!==null&&(IA(A,1),Pv(A,1,0))}function gh(A){for(;A===Gu;)Gu=hl[--gl],hl[gl]=null,Qo=hl[--gl],hl[gl]=null;for(;A===hs;)hs=Ua[--ka],Ua[ka]=null,hA=Ua[--ka],Ua[ka]=null,dA=Ua[--ka],Ua[ka]=null}function Gv(A,i){Ua[ka++]=dA,Ua[ka++]=hA,Ua[ka++]=hs,dA=i.id,hA=i.overflow,hs=A}var Bn=null,Fr=null,Xt=!1,gs=null,Na=!1,mh=Error(n(519));function ms(A){var i=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ro(Fa(i,A)),mh}function Vv(A){var i=A.stateNode,c=A.type,g=A.memoizedProps;switch(i[O]=A,i[G]=g,c){case"dialog":Pt("cancel",i),Pt("close",i);break;case"iframe":case"object":case"embed":Pt("load",i);break;case"video":case"audio":for(c=0;c<nc.length;c++)Pt(nc[c],i);break;case"source":Pt("error",i);break;case"img":case"image":case"link":Pt("error",i),Pt("load",i);break;case"details":Pt("toggle",i);break;case"input":Pt("invalid",i),mr(i,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Pt("invalid",i);break;case"textarea":Pt("invalid",i),Tr(i,g.value,g.defaultValue,g.children)}c=g.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||g.suppressHydrationWarning===!0||sy(i.textContent,c)?(g.popover!=null&&(Pt("beforetoggle",i),Pt("toggle",i)),g.onScroll!=null&&Pt("scroll",i),g.onScrollEnd!=null&&Pt("scrollend",i),g.onClick!=null&&(i.onclick=UA),i=!0):i=!1,i||ms(A,!0)}function Kv(A){for(Bn=A.return;Bn;)switch(Bn.tag){case 5:case 31:case 13:Na=!1;return;case 27:case 3:Na=!0;return;default:Bn=Bn.return}}function ml(A){if(A!==Bn)return!1;if(!Xt)return Kv(A),Xt=!0,!1;var i=A.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=A.type,c=!(c!=="form"&&c!=="button")||Qg(A.type,A.memoizedProps)),c=!c),c&&Fr&&ms(A),Kv(A),i===13){if(A=A.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));Fr=gy(A)}else if(i===31){if(A=A.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));Fr=gy(A)}else i===27?(i=Fr,Us(A.type)?(A=Hg,Hg=null,Fr=A):Fr=i):Fr=Bn?Qa(A.stateNode.nextSibling):null;return!0}function gi(){Fr=Bn=null,Xt=!1}function ph(){var A=gs;return A!==null&&(na===null?na=A:na.push.apply(na,A),gs=null),A}function Ro(A){gs===null?gs=[A]:gs.push(A)}var xh=J(null),mi=null,QA=null;function ps(A,i,c){V(xh,i._currentValue),i._currentValue=c}function RA(A){A._currentValue=xh.current,k(xh)}function vh(A,i,c){for(;A!==null;){var g=A.alternate;if((A.childLanes&i)!==i?(A.childLanes|=i,g!==null&&(g.childLanes|=i)):g!==null&&(g.childLanes&i)!==i&&(g.childLanes|=i),A===c)break;A=A.return}}function wh(A,i,c,g){var w=A.child;for(w!==null&&(w.return=A);w!==null;){var B=w.dependencies;if(B!==null){var b=w.child;B=B.firstContext;e:for(;B!==null;){var M=B;B=w;for(var te=0;te<i.length;te++)if(M.context===i[te]){B.lanes|=c,M=B.alternate,M!==null&&(M.lanes|=c),vh(B.return,c,A),g||(b=null);break e}B=M.next}}else if(w.tag===18){if(b=w.return,b===null)throw Error(n(341));b.lanes|=c,B=b.alternate,B!==null&&(B.lanes|=c),vh(b,c,A),b=null}else b=w.child;if(b!==null)b.return=w;else for(b=w;b!==null;){if(b===A){b=null;break}if(w=b.sibling,w!==null){w.return=b.return,b=w;break}b=b.return}w=b}}function pl(A,i,c,g){A=null;for(var w=i,B=!1;w!==null;){if(!B){if((w.flags&524288)!==0)B=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var b=w.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var M=w.type;oa(w.pendingProps.value,b.value)||(A!==null?A.push(M):A=[M])}}else if(w===Be.current){if(b=w.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(A!==null?A.push(lc):A=[lc])}w=w.return}A!==null&&wh(i,A,c,g),i.flags|=262144}function Vu(A){for(A=A.firstContext;A!==null;){if(!oa(A.context._currentValue,A.memoizedValue))return!0;A=A.next}return!1}function pi(A){mi=A,QA=null,A=A.dependencies,A!==null&&(A.firstContext=null)}function Cn(A){return jv(mi,A)}function Ku(A,i){return mi===null&&pi(A),jv(A,i)}function jv(A,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},QA===null){if(A===null)throw Error(n(308));QA=i,A.dependencies={lanes:0,firstContext:i},A.flags|=524288}else QA=QA.next=i;return c}var BF=typeof AbortController<"u"?AbortController:function(){var A=[],i=this.signal={aborted:!1,addEventListener:function(c,g){A.push(g)}};this.abort=function(){i.aborted=!0,A.forEach(function(c){return c()})}},CF=e.unstable_scheduleCallback,EF=e.unstable_NormalPriority,tn={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yh(){return{controller:new BF,data:new Map,refCount:0}}function Do(A){A.refCount--,A.refCount===0&&CF(EF,function(){A.controller.abort()})}var Mo=null,Bh=0,xl=0,vl=null;function SF(A,i){if(Mo===null){var c=Mo=[];Bh=0,xl=Sg(),vl={status:"pending",value:void 0,then:function(g){c.push(g)}}}return Bh++,i.then(zv,zv),i}function zv(){if(--Bh===0&&Mo!==null){vl!==null&&(vl.status="fulfilled");var A=Mo;Mo=null,xl=0,vl=null;for(var i=0;i<A.length;i++)(0,A[i])()}}function TF(A,i){var c=[],g={status:"pending",value:null,reason:null,then:function(w){c.push(w)}};return A.then(function(){g.status="fulfilled",g.value=i;for(var w=0;w<c.length;w++)(0,c[w])(i)},function(w){for(g.status="rejected",g.reason=w,w=0;w<c.length;w++)(0,c[w])(void 0)}),g}var Xv=q.S;q.S=function(A,i){Uw=dt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&SF(A,i),Xv!==null&&Xv(A,i)};var xi=J(null);function Ch(){var A=xi.current;return A!==null?A:Cr.pooledCache}function ju(A,i){i===null?V(xi,xi.current):V(xi,i.pool)}function Jv(){var A=Ch();return A===null?null:{parent:tn._currentValue,pool:A}}var wl=Error(n(460)),Eh=Error(n(474)),zu=Error(n(542)),Xu={then:function(){}};function Wv(A){return A=A.status,A==="fulfilled"||A==="rejected"}function Yv(A,i,c){switch(c=A[c],c===void 0?A.push(i):c!==i&&(i.then(UA,UA),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw A=i.reason,$v(A),A;default:if(typeof i.status=="string")i.then(UA,UA);else{if(A=Cr,A!==null&&100<A.shellSuspendCounter)throw Error(n(482));A=i,A.status="pending",A.then(function(g){if(i.status==="pending"){var w=i;w.status="fulfilled",w.value=g}},function(g){if(i.status==="pending"){var w=i;w.status="rejected",w.reason=g}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw A=i.reason,$v(A),A}throw wi=i,wl}}function vi(A){try{var i=A._init;return i(A._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(wi=c,wl):c}}var wi=null;function qv(){if(wi===null)throw Error(n(459));var A=wi;return wi=null,A}function $v(A){if(A===wl||A===zu)throw Error(n(483))}var yl=null,Lo=0;function Ju(A){var i=Lo;return Lo+=1,yl===null&&(yl=[]),Yv(yl,A,i)}function Ho(A,i){i=i.props.ref,A.ref=i!==void 0?i:null}function Wu(A,i){throw i.$$typeof===x?Error(n(525)):(A=Object.prototype.toString.call(i),Error(n(31,A==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":A)))}function Zv(A){function i(ue,se){if(A){var he=ue.deletions;he===null?(ue.deletions=[se],ue.flags|=16):he.push(se)}}function c(ue,se){if(!A)return null;for(;se!==null;)i(ue,se),se=se.sibling;return null}function g(ue){for(var se=new Map;ue!==null;)ue.key!==null?se.set(ue.key,ue):se.set(ue.index,ue),ue=ue.sibling;return se}function w(ue,se){return ue=NA(ue,se),ue.index=0,ue.sibling=null,ue}function B(ue,se,he){return ue.index=he,A?(he=ue.alternate,he!==null?(he=he.index,he<se?(ue.flags|=67108866,se):he):(ue.flags|=67108866,se)):(ue.flags|=1048576,se)}function b(ue){return A&&ue.alternate===null&&(ue.flags|=67108866),ue}function M(ue,se,he,Ue){return se===null||se.tag!==6?(se=fh(he,ue.mode,Ue),se.return=ue,se):(se=w(se,he),se.return=ue,se)}function te(ue,se,he,Ue){var ct=he.type;return ct===C?Fe(ue,se,he.props.children,Ue,he.key):se!==null&&(se.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===K&&vi(ct)===se.type)?(se=w(se,he.props),Ho(se,he),se.return=ue,se):(se=Pu(he.type,he.key,he.props,null,ue.mode,Ue),Ho(se,he),se.return=ue,se)}function ge(ue,se,he,Ue){return se===null||se.tag!==4||se.stateNode.containerInfo!==he.containerInfo||se.stateNode.implementation!==he.implementation?(se=dh(he,ue.mode,Ue),se.return=ue,se):(se=w(se,he.children||[]),se.return=ue,se)}function Fe(ue,se,he,Ue,ct){return se===null||se.tag!==7?(se=hi(he,ue.mode,Ue,ct),se.return=ue,se):(se=w(se,he),se.return=ue,se)}function ke(ue,se,he){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=fh(""+se,ue.mode,he),se.return=ue,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case y:return he=Pu(se.type,se.key,se.props,null,ue.mode,he),Ho(he,se),he.return=ue,he;case E:return se=dh(se,ue.mode,he),se.return=ue,se;case K:return se=vi(se),ke(ue,se,he)}if(Se(se)||Z(se))return se=hi(se,ue.mode,he,null),se.return=ue,se;if(typeof se.then=="function")return ke(ue,Ju(se),he);if(se.$$typeof===_)return ke(ue,Ku(ue,se),he);Wu(ue,se)}return null}function we(ue,se,he,Ue){var ct=se!==null?se.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return ct!==null?null:M(ue,se,""+he,Ue);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case y:return he.key===ct?te(ue,se,he,Ue):null;case E:return he.key===ct?ge(ue,se,he,Ue):null;case K:return he=vi(he),we(ue,se,he,Ue)}if(Se(he)||Z(he))return ct!==null?null:Fe(ue,se,he,Ue,null);if(typeof he.then=="function")return we(ue,se,Ju(he),Ue);if(he.$$typeof===_)return we(ue,se,Ku(ue,he),Ue);Wu(ue,he)}return null}function Ee(ue,se,he,Ue,ct){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return ue=ue.get(he)||null,M(se,ue,""+Ue,ct);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case y:return ue=ue.get(Ue.key===null?he:Ue.key)||null,te(se,ue,Ue,ct);case E:return ue=ue.get(Ue.key===null?he:Ue.key)||null,ge(se,ue,Ue,ct);case K:return Ue=vi(Ue),Ee(ue,se,he,Ue,ct)}if(Se(Ue)||Z(Ue))return ue=ue.get(he)||null,Fe(se,ue,Ue,ct,null);if(typeof Ue.then=="function")return Ee(ue,se,he,Ju(Ue),ct);if(Ue.$$typeof===_)return Ee(ue,se,he,Ku(se,Ue),ct);Wu(se,Ue)}return null}function nt(ue,se,he,Ue){for(var ct=null,$t=null,st=se,Qt=se=0,Vt=null;st!==null&&Qt<he.length;Qt++){st.index>Qt?(Vt=st,st=null):Vt=st.sibling;var Zt=we(ue,st,he[Qt],Ue);if(Zt===null){st===null&&(st=Vt);break}A&&st&&Zt.alternate===null&&i(ue,st),se=B(Zt,se,Qt),$t===null?ct=Zt:$t.sibling=Zt,$t=Zt,st=Vt}if(Qt===he.length)return c(ue,st),Xt&&IA(ue,Qt),ct;if(st===null){for(;Qt<he.length;Qt++)st=ke(ue,he[Qt],Ue),st!==null&&(se=B(st,se,Qt),$t===null?ct=st:$t.sibling=st,$t=st);return Xt&&IA(ue,Qt),ct}for(st=g(st);Qt<he.length;Qt++)Vt=Ee(st,ue,Qt,he[Qt],Ue),Vt!==null&&(A&&Vt.alternate!==null&&st.delete(Vt.key===null?Qt:Vt.key),se=B(Vt,se,Qt),$t===null?ct=Vt:$t.sibling=Vt,$t=Vt);return A&&st.forEach(function(Rs){return i(ue,Rs)}),Xt&&IA(ue,Qt),ct}function pt(ue,se,he,Ue){if(he==null)throw Error(n(151));for(var ct=null,$t=null,st=se,Qt=se=0,Vt=null,Zt=he.next();st!==null&&!Zt.done;Qt++,Zt=he.next()){st.index>Qt?(Vt=st,st=null):Vt=st.sibling;var Rs=we(ue,st,Zt.value,Ue);if(Rs===null){st===null&&(st=Vt);break}A&&st&&Rs.alternate===null&&i(ue,st),se=B(Rs,se,Qt),$t===null?ct=Rs:$t.sibling=Rs,$t=Rs,st=Vt}if(Zt.done)return c(ue,st),Xt&&IA(ue,Qt),ct;if(st===null){for(;!Zt.done;Qt++,Zt=he.next())Zt=ke(ue,Zt.value,Ue),Zt!==null&&(se=B(Zt,se,Qt),$t===null?ct=Zt:$t.sibling=Zt,$t=Zt);return Xt&&IA(ue,Qt),ct}for(st=g(st);!Zt.done;Qt++,Zt=he.next())Zt=Ee(st,ue,Qt,Zt.value,Ue),Zt!==null&&(A&&Zt.alternate!==null&&st.delete(Zt.key===null?Qt:Zt.key),se=B(Zt,se,Qt),$t===null?ct=Zt:$t.sibling=Zt,$t=Zt);return A&&st.forEach(function(MU){return i(ue,MU)}),Xt&&IA(ue,Qt),ct}function vr(ue,se,he,Ue){if(typeof he=="object"&&he!==null&&he.type===C&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case y:e:{for(var ct=he.key;se!==null;){if(se.key===ct){if(ct=he.type,ct===C){if(se.tag===7){c(ue,se.sibling),Ue=w(se,he.props.children),Ue.return=ue,ue=Ue;break e}}else if(se.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===K&&vi(ct)===se.type){c(ue,se.sibling),Ue=w(se,he.props),Ho(Ue,he),Ue.return=ue,ue=Ue;break e}c(ue,se);break}else i(ue,se);se=se.sibling}he.type===C?(Ue=hi(he.props.children,ue.mode,Ue,he.key),Ue.return=ue,ue=Ue):(Ue=Pu(he.type,he.key,he.props,null,ue.mode,Ue),Ho(Ue,he),Ue.return=ue,ue=Ue)}return b(ue);case E:e:{for(ct=he.key;se!==null;){if(se.key===ct)if(se.tag===4&&se.stateNode.containerInfo===he.containerInfo&&se.stateNode.implementation===he.implementation){c(ue,se.sibling),Ue=w(se,he.children||[]),Ue.return=ue,ue=Ue;break e}else{c(ue,se);break}else i(ue,se);se=se.sibling}Ue=dh(he,ue.mode,Ue),Ue.return=ue,ue=Ue}return b(ue);case K:return he=vi(he),vr(ue,se,he,Ue)}if(Se(he))return nt(ue,se,he,Ue);if(Z(he)){if(ct=Z(he),typeof ct!="function")throw Error(n(150));return he=ct.call(he),pt(ue,se,he,Ue)}if(typeof he.then=="function")return vr(ue,se,Ju(he),Ue);if(he.$$typeof===_)return vr(ue,se,Ku(ue,he),Ue);Wu(ue,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,se!==null&&se.tag===6?(c(ue,se.sibling),Ue=w(se,he),Ue.return=ue,ue=Ue):(c(ue,se),Ue=fh(he,ue.mode,Ue),Ue.return=ue,ue=Ue),b(ue)):c(ue,se)}return function(ue,se,he,Ue){try{Lo=0;var ct=vr(ue,se,he,Ue);return yl=null,ct}catch(st){if(st===wl||st===zu)throw st;var $t=ca(29,st,null,ue.mode);return $t.lanes=Ue,$t.return=ue,$t}finally{}}}var yi=Zv(!0),e1=Zv(!1),xs=!1;function Sh(A){A.updateQueue={baseState:A.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Th(A,i){A=A.updateQueue,i.updateQueue===A&&(i.updateQueue={baseState:A.baseState,firstBaseUpdate:A.firstBaseUpdate,lastBaseUpdate:A.lastBaseUpdate,shared:A.shared,callbacks:null})}function vs(A){return{lane:A,tag:0,payload:null,callback:null,next:null}}function ws(A,i,c){var g=A.updateQueue;if(g===null)return null;if(g=g.shared,(nr&2)!==0){var w=g.pending;return w===null?i.next=i:(i.next=w.next,w.next=i),g.pending=i,i=Ou(A),Mv(A,null,c),i}return Hu(A,g,i,c),Ou(A)}function Oo(A,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var g=i.lanes;g&=A.pendingLanes,c|=g,i.lanes=c,us(A,c)}}function _h(A,i){var c=A.updateQueue,g=A.alternate;if(g!==null&&(g=g.updateQueue,c===g)){var w=null,B=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};B===null?w=B=b:B=B.next=b,c=c.next}while(c!==null);B===null?w=B=i:B=B.next=i}else w=B=i;c={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:B,shared:g.shared,callbacks:g.callbacks},A.updateQueue=c;return}A=c.lastBaseUpdate,A===null?c.firstBaseUpdate=i:A.next=i,c.lastBaseUpdate=i}var bh=!1;function Po(){if(bh){var A=vl;if(A!==null)throw A}}function Go(A,i,c,g){bh=!1;var w=A.updateQueue;xs=!1;var B=w.firstBaseUpdate,b=w.lastBaseUpdate,M=w.shared.pending;if(M!==null){w.shared.pending=null;var te=M,ge=te.next;te.next=null,b===null?B=ge:b.next=ge,b=te;var Fe=A.alternate;Fe!==null&&(Fe=Fe.updateQueue,M=Fe.lastBaseUpdate,M!==b&&(M===null?Fe.firstBaseUpdate=ge:M.next=ge,Fe.lastBaseUpdate=te))}if(B!==null){var ke=w.baseState;b=0,Fe=ge=te=null,M=B;do{var we=M.lane&-536870913,Ee=we!==M.lane;if(Ee?(Gt&we)===we:(g&we)===we){we!==0&&we===xl&&(bh=!0),Fe!==null&&(Fe=Fe.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var nt=A,pt=M;we=i;var vr=c;switch(pt.tag){case 1:if(nt=pt.payload,typeof nt=="function"){ke=nt.call(vr,ke,we);break e}ke=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=pt.payload,we=typeof nt=="function"?nt.call(vr,ke,we):nt,we==null)break e;ke=m({},ke,we);break e;case 2:xs=!0}}we=M.callback,we!==null&&(A.flags|=64,Ee&&(A.flags|=8192),Ee=w.callbacks,Ee===null?w.callbacks=[we]:Ee.push(we))}else Ee={lane:we,tag:M.tag,payload:M.payload,callback:M.callback,next:null},Fe===null?(ge=Fe=Ee,te=ke):Fe=Fe.next=Ee,b|=we;if(M=M.next,M===null){if(M=w.shared.pending,M===null)break;Ee=M,M=Ee.next,Ee.next=null,w.lastBaseUpdate=Ee,w.shared.pending=null}}while(!0);Fe===null&&(te=ke),w.baseState=te,w.firstBaseUpdate=ge,w.lastBaseUpdate=Fe,B===null&&(w.shared.lanes=0),Ss|=b,A.lanes=b,A.memoizedState=ke}}function t1(A,i){if(typeof A!="function")throw Error(n(191,A));A.call(i)}function r1(A,i){var c=A.callbacks;if(c!==null)for(A.callbacks=null,A=0;A<c.length;A++)t1(c[A],i)}var Bl=J(null),Yu=J(0);function n1(A,i){A=KA,V(Yu,A),V(Bl,i),KA=A|i.baseLanes}function Fh(){V(Yu,KA),V(Bl,Bl.current)}function Uh(){KA=Yu.current,k(Bl),k(Yu)}var ua=J(null),Ia=null;function ys(A){var i=A.alternate;V(zr,zr.current&1),V(ua,A),Ia===null&&(i===null||Bl.current!==null||i.memoizedState!==null)&&(Ia=A)}function kh(A){V(zr,zr.current),V(ua,A),Ia===null&&(Ia=A)}function a1(A){A.tag===22?(V(zr,zr.current),V(ua,A),Ia===null&&(Ia=A)):Bs()}function Bs(){V(zr,zr.current),V(ua,ua.current)}function fa(A){k(ua),Ia===A&&(Ia=null),k(zr)}var zr=J(0);function qu(A){for(var i=A;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Mg(c)||Lg(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===A)break;for(;i.sibling===null;){if(i.return===null||i.return===A)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var DA=0,Ft=null,pr=null,rn=null,$u=!1,Cl=!1,Bi=!1,Zu=0,Vo=0,El=null,_F=0;function Or(){throw Error(n(321))}function Nh(A,i){if(i===null)return!1;for(var c=0;c<i.length&&c<A.length;c++)if(!oa(A[c],i[c]))return!1;return!0}function Ih(A,i,c,g,w,B){return DA=B,Ft=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,q.H=A===null||A.memoizedState===null?P1:Jh,Bi=!1,B=c(g,w),Bi=!1,Cl&&(B=s1(i,c,g,w)),A1(A),B}function A1(A){q.H=zo;var i=pr!==null&&pr.next!==null;if(DA=0,rn=pr=Ft=null,$u=!1,Vo=0,El=null,i)throw Error(n(300));A===null||nn||(A=A.dependencies,A!==null&&Vu(A)&&(nn=!0))}function s1(A,i,c,g){Ft=A;var w=0;do{if(Cl&&(El=null),Vo=0,Cl=!1,25<=w)throw Error(n(301));if(w+=1,rn=pr=null,A.updateQueue!=null){var B=A.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}q.H=G1,B=i(c,g)}while(Cl);return B}function bF(){var A=q.H,i=A.useState()[0];return i=typeof i.then=="function"?Ko(i):i,A=A.useState()[0],(pr!==null?pr.memoizedState:null)!==A&&(Ft.flags|=1024),i}function Qh(){var A=Zu!==0;return Zu=0,A}function Rh(A,i,c){i.updateQueue=A.updateQueue,i.flags&=-2053,A.lanes&=~c}function Dh(A){if($u){for(A=A.memoizedState;A!==null;){var i=A.queue;i!==null&&(i.pending=null),A=A.next}$u=!1}DA=0,rn=pr=Ft=null,Cl=!1,Vo=Zu=0,El=null}function zn(){var A={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Ft.memoizedState=rn=A:rn=rn.next=A,rn}function Xr(){if(pr===null){var A=Ft.alternate;A=A!==null?A.memoizedState:null}else A=pr.next;var i=rn===null?Ft.memoizedState:rn.next;if(i!==null)rn=i,pr=A;else{if(A===null)throw Ft.alternate===null?Error(n(467)):Error(n(310));pr=A,A={memoizedState:pr.memoizedState,baseState:pr.baseState,baseQueue:pr.baseQueue,queue:pr.queue,next:null},rn===null?Ft.memoizedState=rn=A:rn=rn.next=A}return rn}function e0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ko(A){var i=Vo;return Vo+=1,El===null&&(El=[]),A=Yv(El,A,i),i=Ft,(rn===null?i.memoizedState:rn.next)===null&&(i=i.alternate,q.H=i===null||i.memoizedState===null?P1:Jh),A}function t0(A){if(A!==null&&typeof A=="object"){if(typeof A.then=="function")return Ko(A);if(A.$$typeof===_)return Cn(A)}throw Error(n(438,String(A)))}function Mh(A){var i=null,c=Ft.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var g=Ft.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(i={data:g.data.map(function(w){return w.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=e0(),Ft.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(A),g=0;g<A;g++)c[g]=ee;return i.index++,c}function MA(A,i){return typeof i=="function"?i(A):i}function r0(A){var i=Xr();return Lh(i,pr,A)}function Lh(A,i,c){var g=A.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=c;var w=A.baseQueue,B=g.pending;if(B!==null){if(w!==null){var b=w.next;w.next=B.next,B.next=b}i.baseQueue=w=B,g.pending=null}if(B=A.baseState,w===null)A.memoizedState=B;else{i=w.next;var M=b=null,te=null,ge=i,Fe=!1;do{var ke=ge.lane&-536870913;if(ke!==ge.lane?(Gt&ke)===ke:(DA&ke)===ke){var we=ge.revertLane;if(we===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),ke===xl&&(Fe=!0);else if((DA&we)===we){ge=ge.next,we===xl&&(Fe=!0);continue}else ke={lane:0,revertLane:ge.revertLane,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},te===null?(M=te=ke,b=B):te=te.next=ke,Ft.lanes|=we,Ss|=we;ke=ge.action,Bi&&c(B,ke),B=ge.hasEagerState?ge.eagerState:c(B,ke)}else we={lane:ke,revertLane:ge.revertLane,gesture:ge.gesture,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},te===null?(M=te=we,b=B):te=te.next=we,Ft.lanes|=ke,Ss|=ke;ge=ge.next}while(ge!==null&&ge!==i);if(te===null?b=B:te.next=M,!oa(B,A.memoizedState)&&(nn=!0,Fe&&(c=vl,c!==null)))throw c;A.memoizedState=B,A.baseState=b,A.baseQueue=te,g.lastRenderedState=B}return w===null&&(g.lanes=0),[A.memoizedState,g.dispatch]}function Hh(A){var i=Xr(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=A;var g=c.dispatch,w=c.pending,B=i.memoizedState;if(w!==null){c.pending=null;var b=w=w.next;do B=A(B,b.action),b=b.next;while(b!==w);oa(B,i.memoizedState)||(nn=!0),i.memoizedState=B,i.baseQueue===null&&(i.baseState=B),c.lastRenderedState=B}return[B,g]}function i1(A,i,c){var g=Ft,w=Xr(),B=Xt;if(B){if(c===void 0)throw Error(n(407));c=c()}else c=i();var b=!oa((pr||w).memoizedState,c);if(b&&(w.memoizedState=c,nn=!0),w=w.queue,Gh(c1.bind(null,g,w,A),[A]),w.getSnapshot!==i||b||rn!==null&&rn.memoizedState.tag&1){if(g.flags|=2048,Sl(9,{destroy:void 0},o1.bind(null,g,w,c,i),null),Cr===null)throw Error(n(349));B||(DA&127)!==0||l1(g,i,c)}return c}function l1(A,i,c){A.flags|=16384,A={getSnapshot:i,value:c},i=Ft.updateQueue,i===null?(i=e0(),Ft.updateQueue=i,i.stores=[A]):(c=i.stores,c===null?i.stores=[A]:c.push(A))}function o1(A,i,c,g){i.value=c,i.getSnapshot=g,u1(i)&&f1(A)}function c1(A,i,c){return c(function(){u1(i)&&f1(A)})}function u1(A){var i=A.getSnapshot;A=A.value;try{var c=i();return!oa(A,c)}catch{return!0}}function f1(A){var i=di(A,2);i!==null&&aa(i,A,2)}function Oh(A){var i=zn();if(typeof A=="function"){var c=A;if(A=c(),Bi){jr(!0);try{c()}finally{jr(!1)}}}return i.memoizedState=i.baseState=A,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:MA,lastRenderedState:A},i}function d1(A,i,c,g){return A.baseState=c,Lh(A,pr,typeof g=="function"?g:MA)}function FF(A,i,c,g,w){if(A0(A))throw Error(n(485));if(A=i.action,A!==null){var B={payload:w,action:A,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){B.listeners.push(b)}};q.T!==null?c(!0):B.isTransition=!1,g(B),c=i.pending,c===null?(B.next=i.pending=B,h1(i,B)):(B.next=c.next,i.pending=c.next=B)}}function h1(A,i){var c=i.action,g=i.payload,w=A.state;if(i.isTransition){var B=q.T,b={};q.T=b;try{var M=c(w,g),te=q.S;te!==null&&te(b,M),g1(A,i,M)}catch(ge){Ph(A,i,ge)}finally{B!==null&&b.types!==null&&(B.types=b.types),q.T=B}}else try{B=c(w,g),g1(A,i,B)}catch(ge){Ph(A,i,ge)}}function g1(A,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(g){m1(A,i,g)},function(g){return Ph(A,i,g)}):m1(A,i,c)}function m1(A,i,c){i.status="fulfilled",i.value=c,p1(i),A.state=c,i=A.pending,i!==null&&(c=i.next,c===i?A.pending=null:(c=c.next,i.next=c,h1(A,c)))}function Ph(A,i,c){var g=A.pending;if(A.pending=null,g!==null){g=g.next;do i.status="rejected",i.reason=c,p1(i),i=i.next;while(i!==g)}A.action=null}function p1(A){A=A.listeners;for(var i=0;i<A.length;i++)(0,A[i])()}function x1(A,i){return i}function v1(A,i){if(Xt){var c=Cr.formState;if(c!==null){e:{var g=Ft;if(Xt){if(Fr){t:{for(var w=Fr,B=Na;w.nodeType!==8;){if(!B){w=null;break t}if(w=Qa(w.nextSibling),w===null){w=null;break t}}B=w.data,w=B==="F!"||B==="F"?w:null}if(w){Fr=Qa(w.nextSibling),g=w.data==="F!";break e}}ms(g)}g=!1}g&&(i=c[0])}}return c=zn(),c.memoizedState=c.baseState=i,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x1,lastRenderedState:i},c.queue=g,c=L1.bind(null,Ft,g),g.dispatch=c,g=Oh(!1),B=Xh.bind(null,Ft,!1,g.queue),g=zn(),w={state:i,dispatch:null,action:A,pending:null},g.queue=w,c=FF.bind(null,Ft,w,B,c),w.dispatch=c,g.memoizedState=A,[i,c,!1]}function w1(A){var i=Xr();return y1(i,pr,A)}function y1(A,i,c){if(i=Lh(A,i,x1)[0],A=r0(MA)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var g=Ko(i)}catch(b){throw b===wl?zu:b}else g=i;i=Xr();var w=i.queue,B=w.dispatch;return c!==i.memoizedState&&(Ft.flags|=2048,Sl(9,{destroy:void 0},UF.bind(null,w,c),null)),[g,B,A]}function UF(A,i){A.action=i}function B1(A){var i=Xr(),c=pr;if(c!==null)return y1(i,c,A);Xr(),i=i.memoizedState,c=Xr();var g=c.queue.dispatch;return c.memoizedState=A,[i,g,!1]}function Sl(A,i,c,g){return A={tag:A,create:c,deps:g,inst:i,next:null},i=Ft.updateQueue,i===null&&(i=e0(),Ft.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=A.next=A:(g=c.next,c.next=A,A.next=g,i.lastEffect=A),A}function C1(){return Xr().memoizedState}function n0(A,i,c,g){var w=zn();Ft.flags|=A,w.memoizedState=Sl(1|i,{destroy:void 0},c,g===void 0?null:g)}function a0(A,i,c,g){var w=Xr();g=g===void 0?null:g;var B=w.memoizedState.inst;pr!==null&&g!==null&&Nh(g,pr.memoizedState.deps)?w.memoizedState=Sl(i,B,c,g):(Ft.flags|=A,w.memoizedState=Sl(1|i,B,c,g))}function E1(A,i){n0(8390656,8,A,i)}function Gh(A,i){a0(2048,8,A,i)}function kF(A){Ft.flags|=4;var i=Ft.updateQueue;if(i===null)i=e0(),Ft.updateQueue=i,i.events=[A];else{var c=i.events;c===null?i.events=[A]:c.push(A)}}function S1(A){var i=Xr().memoizedState;return kF({ref:i,nextImpl:A}),function(){if((nr&2)!==0)throw Error(n(440));return i.impl.apply(void 0,arguments)}}function T1(A,i){return a0(4,2,A,i)}function _1(A,i){return a0(4,4,A,i)}function b1(A,i){if(typeof i=="function"){A=A();var c=i(A);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return A=A(),i.current=A,function(){i.current=null}}function F1(A,i,c){c=c!=null?c.concat([A]):null,a0(4,4,b1.bind(null,i,A),c)}function Vh(){}function U1(A,i){var c=Xr();i=i===void 0?null:i;var g=c.memoizedState;return i!==null&&Nh(i,g[1])?g[0]:(c.memoizedState=[A,i],A)}function k1(A,i){var c=Xr();i=i===void 0?null:i;var g=c.memoizedState;if(i!==null&&Nh(i,g[1]))return g[0];if(g=A(),Bi){jr(!0);try{A()}finally{jr(!1)}}return c.memoizedState=[g,i],g}function Kh(A,i,c){return c===void 0||(DA&1073741824)!==0&&(Gt&261930)===0?A.memoizedState=i:(A.memoizedState=c,A=Nw(),Ft.lanes|=A,Ss|=A,c)}function N1(A,i,c,g){return oa(c,i)?c:Bl.current!==null?(A=Kh(A,c,g),oa(A,i)||(nn=!0),A):(DA&42)===0||(DA&1073741824)!==0&&(Gt&261930)===0?(nn=!0,A.memoizedState=c):(A=Nw(),Ft.lanes|=A,Ss|=A,i)}function I1(A,i,c,g,w){var B=Ae.p;Ae.p=B!==0&&8>B?B:8;var b=q.T,M={};q.T=M,Xh(A,!1,i,c);try{var te=w(),ge=q.S;if(ge!==null&&ge(M,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Fe=TF(te,g);jo(A,i,Fe,ga(A))}else jo(A,i,g,ga(A))}catch(ke){jo(A,i,{then:function(){},status:"rejected",reason:ke},ga())}finally{Ae.p=B,b!==null&&M.types!==null&&(b.types=M.types),q.T=b}}function NF(){}function jh(A,i,c,g){if(A.tag!==5)throw Error(n(476));var w=Q1(A).queue;I1(A,w,i,Re,c===null?NF:function(){return R1(A),c(g)})}function Q1(A){var i=A.memoizedState;if(i!==null)return i;i={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:MA,lastRenderedState:Re},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:MA,lastRenderedState:c},next:null},A.memoizedState=i,A=A.alternate,A!==null&&(A.memoizedState=i),i}function R1(A){var i=Q1(A);i.next===null&&(i=A.alternate.memoizedState),jo(A,i.next.queue,{},ga())}function zh(){return Cn(lc)}function D1(){return Xr().memoizedState}function M1(){return Xr().memoizedState}function IF(A){for(var i=A.return;i!==null;){switch(i.tag){case 24:case 3:var c=ga();A=vs(c);var g=ws(i,A,c);g!==null&&(aa(g,i,c),Oo(g,i,c)),i={cache:yh()},A.payload=i;return}i=i.return}}function QF(A,i,c){var g=ga();c={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},A0(A)?H1(i,c):(c=ch(A,i,c,g),c!==null&&(aa(c,A,g),O1(c,i,g)))}function L1(A,i,c){var g=ga();jo(A,i,c,g)}function jo(A,i,c,g){var w={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(A0(A))H1(i,w);else{var B=A.alternate;if(A.lanes===0&&(B===null||B.lanes===0)&&(B=i.lastRenderedReducer,B!==null))try{var b=i.lastRenderedState,M=B(b,c);if(w.hasEagerState=!0,w.eagerState=M,oa(M,b))return Hu(A,i,w,0),Cr===null&&Lu(),!1}catch{}finally{}if(c=ch(A,i,w,g),c!==null)return aa(c,A,g),O1(c,i,g),!0}return!1}function Xh(A,i,c,g){if(g={lane:2,revertLane:Sg(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},A0(A)){if(i)throw Error(n(479))}else i=ch(A,c,g,2),i!==null&&aa(i,A,2)}function A0(A){var i=A.alternate;return A===Ft||i!==null&&i===Ft}function H1(A,i){Cl=$u=!0;var c=A.pending;c===null?i.next=i:(i.next=c.next,c.next=i),A.pending=i}function O1(A,i,c){if((c&4194048)!==0){var g=i.lanes;g&=A.pendingLanes,c|=g,i.lanes=c,us(A,c)}}var zo={readContext:Cn,use:t0,useCallback:Or,useContext:Or,useEffect:Or,useImperativeHandle:Or,useLayoutEffect:Or,useInsertionEffect:Or,useMemo:Or,useReducer:Or,useRef:Or,useState:Or,useDebugValue:Or,useDeferredValue:Or,useTransition:Or,useSyncExternalStore:Or,useId:Or,useHostTransitionStatus:Or,useFormState:Or,useActionState:Or,useOptimistic:Or,useMemoCache:Or,useCacheRefresh:Or};zo.useEffectEvent=Or;var P1={readContext:Cn,use:t0,useCallback:function(A,i){return zn().memoizedState=[A,i===void 0?null:i],A},useContext:Cn,useEffect:E1,useImperativeHandle:function(A,i,c){c=c!=null?c.concat([A]):null,n0(4194308,4,b1.bind(null,i,A),c)},useLayoutEffect:function(A,i){return n0(4194308,4,A,i)},useInsertionEffect:function(A,i){n0(4,2,A,i)},useMemo:function(A,i){var c=zn();i=i===void 0?null:i;var g=A();if(Bi){jr(!0);try{A()}finally{jr(!1)}}return c.memoizedState=[g,i],g},useReducer:function(A,i,c){var g=zn();if(c!==void 0){var w=c(i);if(Bi){jr(!0);try{c(i)}finally{jr(!1)}}}else w=i;return g.memoizedState=g.baseState=w,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:w},g.queue=A,A=A.dispatch=QF.bind(null,Ft,A),[g.memoizedState,A]},useRef:function(A){var i=zn();return A={current:A},i.memoizedState=A},useState:function(A){A=Oh(A);var i=A.queue,c=L1.bind(null,Ft,i);return i.dispatch=c,[A.memoizedState,c]},useDebugValue:Vh,useDeferredValue:function(A,i){var c=zn();return Kh(c,A,i)},useTransition:function(){var A=Oh(!1);return A=I1.bind(null,Ft,A.queue,!0,!1),zn().memoizedState=A,[!1,A]},useSyncExternalStore:function(A,i,c){var g=Ft,w=zn();if(Xt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),Cr===null)throw Error(n(349));(Gt&127)!==0||l1(g,i,c)}w.memoizedState=c;var B={value:c,getSnapshot:i};return w.queue=B,E1(c1.bind(null,g,B,A),[A]),g.flags|=2048,Sl(9,{destroy:void 0},o1.bind(null,g,B,c,i),null),c},useId:function(){var A=zn(),i=Cr.identifierPrefix;if(Xt){var c=hA,g=dA;c=(g&~(1<<32-Sr(g)-1)).toString(32)+c,i="_"+i+"R_"+c,c=Zu++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=_F++,i="_"+i+"r_"+c.toString(32)+"_";return A.memoizedState=i},useHostTransitionStatus:zh,useFormState:v1,useActionState:v1,useOptimistic:function(A){var i=zn();i.memoizedState=i.baseState=A;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=Xh.bind(null,Ft,!0,c),c.dispatch=i,[A,i]},useMemoCache:Mh,useCacheRefresh:function(){return zn().memoizedState=IF.bind(null,Ft)},useEffectEvent:function(A){var i=zn(),c={impl:A};return i.memoizedState=c,function(){if((nr&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Jh={readContext:Cn,use:t0,useCallback:U1,useContext:Cn,useEffect:Gh,useImperativeHandle:F1,useInsertionEffect:T1,useLayoutEffect:_1,useMemo:k1,useReducer:r0,useRef:C1,useState:function(){return r0(MA)},useDebugValue:Vh,useDeferredValue:function(A,i){var c=Xr();return N1(c,pr.memoizedState,A,i)},useTransition:function(){var A=r0(MA)[0],i=Xr().memoizedState;return[typeof A=="boolean"?A:Ko(A),i]},useSyncExternalStore:i1,useId:D1,useHostTransitionStatus:zh,useFormState:w1,useActionState:w1,useOptimistic:function(A,i){var c=Xr();return d1(c,pr,A,i)},useMemoCache:Mh,useCacheRefresh:M1};Jh.useEffectEvent=S1;var G1={readContext:Cn,use:t0,useCallback:U1,useContext:Cn,useEffect:Gh,useImperativeHandle:F1,useInsertionEffect:T1,useLayoutEffect:_1,useMemo:k1,useReducer:Hh,useRef:C1,useState:function(){return Hh(MA)},useDebugValue:Vh,useDeferredValue:function(A,i){var c=Xr();return pr===null?Kh(c,A,i):N1(c,pr.memoizedState,A,i)},useTransition:function(){var A=Hh(MA)[0],i=Xr().memoizedState;return[typeof A=="boolean"?A:Ko(A),i]},useSyncExternalStore:i1,useId:D1,useHostTransitionStatus:zh,useFormState:B1,useActionState:B1,useOptimistic:function(A,i){var c=Xr();return pr!==null?d1(c,pr,A,i):(c.baseState=A,[A,c.queue.dispatch])},useMemoCache:Mh,useCacheRefresh:M1};G1.useEffectEvent=S1;function Wh(A,i,c,g){i=A.memoizedState,c=c(g,i),c=c==null?i:m({},i,c),A.memoizedState=c,A.lanes===0&&(A.updateQueue.baseState=c)}var Yh={enqueueSetState:function(A,i,c){A=A._reactInternals;var g=ga(),w=vs(g);w.payload=i,c!=null&&(w.callback=c),i=ws(A,w,g),i!==null&&(aa(i,A,g),Oo(i,A,g))},enqueueReplaceState:function(A,i,c){A=A._reactInternals;var g=ga(),w=vs(g);w.tag=1,w.payload=i,c!=null&&(w.callback=c),i=ws(A,w,g),i!==null&&(aa(i,A,g),Oo(i,A,g))},enqueueForceUpdate:function(A,i){A=A._reactInternals;var c=ga(),g=vs(c);g.tag=2,i!=null&&(g.callback=i),i=ws(A,g,c),i!==null&&(aa(i,A,c),Oo(i,A,c))}};function V1(A,i,c,g,w,B,b){return A=A.stateNode,typeof A.shouldComponentUpdate=="function"?A.shouldComponentUpdate(g,B,b):i.prototype&&i.prototype.isPureReactComponent?!No(c,g)||!No(w,B):!0}function K1(A,i,c,g){A=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,g),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,g),i.state!==A&&Yh.enqueueReplaceState(i,i.state,null)}function Ci(A,i){var c=i;if("ref"in i){c={};for(var g in i)g!=="ref"&&(c[g]=i[g])}if(A=A.defaultProps){c===i&&(c=m({},c));for(var w in A)c[w]===void 0&&(c[w]=A[w])}return c}function j1(A){Mu(A)}function z1(A){console.error(A)}function X1(A){Mu(A)}function s0(A,i){try{var c=A.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(g){setTimeout(function(){throw g})}}function J1(A,i,c){try{var g=A.onCaughtError;g(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function qh(A,i,c){return c=vs(c),c.tag=3,c.payload={element:null},c.callback=function(){s0(A,i)},c}function W1(A){return A=vs(A),A.tag=3,A}function Y1(A,i,c,g){var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var B=g.value;A.payload=function(){return w(B)},A.callback=function(){J1(i,c,g)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(A.callback=function(){J1(i,c,g),typeof w!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var M=g.stack;this.componentDidCatch(g.value,{componentStack:M!==null?M:""})})}function RF(A,i,c,g,w){if(c.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(i=c.alternate,i!==null&&pl(i,c,w,!0),c=ua.current,c!==null){switch(c.tag){case 31:case 13:return Ia===null?x0():c.alternate===null&&Pr===0&&(Pr=3),c.flags&=-257,c.flags|=65536,c.lanes=w,g===Xu?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([g]):i.add(g),Bg(A,g,w)),!1;case 22:return c.flags|=65536,g===Xu?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([g])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([g]):c.add(g)),Bg(A,g,w)),!1}throw Error(n(435,c.tag))}return Bg(A,g,w),x0(),!1}if(Xt)return i=ua.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=w,g!==mh&&(A=Error(n(422),{cause:g}),Ro(Fa(A,c)))):(g!==mh&&(i=Error(n(423),{cause:g}),Ro(Fa(i,c))),A=A.current.alternate,A.flags|=65536,w&=-w,A.lanes|=w,g=Fa(g,c),w=qh(A.stateNode,g,w),_h(A,w),Pr!==4&&(Pr=2)),!1;var B=Error(n(520),{cause:g});if(B=Fa(B,c),ec===null?ec=[B]:ec.push(B),Pr!==4&&(Pr=2),i===null)return!0;g=Fa(g,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,A=w&-w,c.lanes|=A,A=qh(c.stateNode,g,A),_h(c,A),!1;case 1:if(i=c.type,B=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Ts===null||!Ts.has(B))))return c.flags|=65536,w&=-w,c.lanes|=w,w=W1(w),Y1(w,A,c,g),_h(c,w),!1}c=c.return}while(c!==null);return!1}var $h=Error(n(461)),nn=!1;function En(A,i,c,g){i.child=A===null?e1(i,null,c,g):yi(i,A.child,c,g)}function q1(A,i,c,g,w){c=c.render;var B=i.ref;if("ref"in g){var b={};for(var M in g)M!=="ref"&&(b[M]=g[M])}else b=g;return pi(i),g=Ih(A,i,c,b,B,w),M=Qh(),A!==null&&!nn?(Rh(A,i,w),LA(A,i,w)):(Xt&&M&&hh(i),i.flags|=1,En(A,i,g,w),i.child)}function $1(A,i,c,g,w){if(A===null){var B=c.type;return typeof B=="function"&&!uh(B)&&B.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=B,Z1(A,i,B,g,w)):(A=Pu(c.type,null,g,i,i.mode,w),A.ref=i.ref,A.return=i,i.child=A)}if(B=A.child,!sg(A,w)){var b=B.memoizedProps;if(c=c.compare,c=c!==null?c:No,c(b,g)&&A.ref===i.ref)return LA(A,i,w)}return i.flags|=1,A=NA(B,g),A.ref=i.ref,A.return=i,i.child=A}function Z1(A,i,c,g,w){if(A!==null){var B=A.memoizedProps;if(No(B,g)&&A.ref===i.ref)if(nn=!1,i.pendingProps=g=B,sg(A,w))(A.flags&131072)!==0&&(nn=!0);else return i.lanes=A.lanes,LA(A,i,w)}return Zh(A,i,c,g,w)}function ew(A,i,c,g){var w=g.children,B=A!==null?A.memoizedState:null;if(A===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((i.flags&128)!==0){if(B=B!==null?B.baseLanes|c:c,A!==null){for(g=i.child=A.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;g=w&~B}else g=0,i.child=null;return tw(A,i,B,c,g)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},A!==null&&ju(i,B!==null?B.cachePool:null),B!==null?n1(i,B):Fh(),a1(i);else return g=i.lanes=536870912,tw(A,i,B!==null?B.baseLanes|c:c,c,g)}else B!==null?(ju(i,B.cachePool),n1(i,B),Bs(),i.memoizedState=null):(A!==null&&ju(i,null),Fh(),Bs());return En(A,i,w,c),i.child}function Xo(A,i){return A!==null&&A.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function tw(A,i,c,g,w){var B=Ch();return B=B===null?null:{parent:tn._currentValue,pool:B},i.memoizedState={baseLanes:c,cachePool:B},A!==null&&ju(i,null),Fh(),a1(i),A!==null&&pl(A,i,g,!0),i.childLanes=w,null}function i0(A,i){return i=o0({mode:i.mode,children:i.children},A.mode),i.ref=A.ref,A.child=i,i.return=A,i}function rw(A,i,c){return yi(i,A.child,null,c),A=i0(i,i.pendingProps),A.flags|=2,fa(i),i.memoizedState=null,A}function DF(A,i,c){var g=i.pendingProps,w=(i.flags&128)!==0;if(i.flags&=-129,A===null){if(Xt){if(g.mode==="hidden")return A=i0(i,g),i.lanes=536870912,Xo(null,A);if(kh(i),(A=Fr)?(A=hy(A,Na),A=A!==null&&A.data==="&"?A:null,A!==null&&(i.memoizedState={dehydrated:A,treeContext:hs!==null?{id:dA,overflow:hA}:null,retryLane:536870912,hydrationErrors:null},c=Hv(A),c.return=i,i.child=c,Bn=i,Fr=null)):A=null,A===null)throw ms(i);return i.lanes=536870912,null}return i0(i,g)}var B=A.memoizedState;if(B!==null){var b=B.dehydrated;if(kh(i),w)if(i.flags&256)i.flags&=-257,i=rw(A,i,c);else if(i.memoizedState!==null)i.child=A.child,i.flags|=128,i=null;else throw Error(n(558));else if(nn||pl(A,i,c,!1),w=(c&A.childLanes)!==0,nn||w){if(g=Cr,g!==null&&(b=Al(g,c),b!==0&&b!==B.retryLane))throw B.retryLane=b,di(A,b),aa(g,A,b),$h;x0(),i=rw(A,i,c)}else A=B.treeContext,Fr=Qa(b.nextSibling),Bn=i,Xt=!0,gs=null,Na=!1,A!==null&&Gv(i,A),i=i0(i,g),i.flags|=4096;return i}return A=NA(A.child,{mode:g.mode,children:g.children}),A.ref=i.ref,i.child=A,A.return=i,A}function l0(A,i){var c=i.ref;if(c===null)A!==null&&A.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(A===null||A.ref!==c)&&(i.flags|=4194816)}}function Zh(A,i,c,g,w){return pi(i),c=Ih(A,i,c,g,void 0,w),g=Qh(),A!==null&&!nn?(Rh(A,i,w),LA(A,i,w)):(Xt&&g&&hh(i),i.flags|=1,En(A,i,c,w),i.child)}function nw(A,i,c,g,w,B){return pi(i),i.updateQueue=null,c=s1(i,g,c,w),A1(A),g=Qh(),A!==null&&!nn?(Rh(A,i,B),LA(A,i,B)):(Xt&&g&&hh(i),i.flags|=1,En(A,i,c,B),i.child)}function aw(A,i,c,g,w){if(pi(i),i.stateNode===null){var B=dl,b=c.contextType;typeof b=="object"&&b!==null&&(B=Cn(b)),B=new c(g,B),i.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=Yh,i.stateNode=B,B._reactInternals=i,B=i.stateNode,B.props=g,B.state=i.memoizedState,B.refs={},Sh(i),b=c.contextType,B.context=typeof b=="object"&&b!==null?Cn(b):dl,B.state=i.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(Wh(i,c,b,g),B.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(b=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),b!==B.state&&Yh.enqueueReplaceState(B,B.state,null),Go(i,g,B,w),Po(),B.state=i.memoizedState),typeof B.componentDidMount=="function"&&(i.flags|=4194308),g=!0}else if(A===null){B=i.stateNode;var M=i.memoizedProps,te=Ci(c,M);B.props=te;var ge=B.context,Fe=c.contextType;b=dl,typeof Fe=="object"&&Fe!==null&&(b=Cn(Fe));var ke=c.getDerivedStateFromProps;Fe=typeof ke=="function"||typeof B.getSnapshotBeforeUpdate=="function",M=i.pendingProps!==M,Fe||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(M||ge!==b)&&K1(i,B,g,b),xs=!1;var we=i.memoizedState;B.state=we,Go(i,g,B,w),Po(),ge=i.memoizedState,M||we!==ge||xs?(typeof ke=="function"&&(Wh(i,c,ke,g),ge=i.memoizedState),(te=xs||V1(i,c,te,g,we,ge,b))?(Fe||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(i.flags|=4194308)):(typeof B.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=g,i.memoizedState=ge),B.props=g,B.state=ge,B.context=b,g=te):(typeof B.componentDidMount=="function"&&(i.flags|=4194308),g=!1)}else{B=i.stateNode,Th(A,i),b=i.memoizedProps,Fe=Ci(c,b),B.props=Fe,ke=i.pendingProps,we=B.context,ge=c.contextType,te=dl,typeof ge=="object"&&ge!==null&&(te=Cn(ge)),M=c.getDerivedStateFromProps,(ge=typeof M=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(b!==ke||we!==te)&&K1(i,B,g,te),xs=!1,we=i.memoizedState,B.state=we,Go(i,g,B,w),Po();var Ee=i.memoizedState;b!==ke||we!==Ee||xs||A!==null&&A.dependencies!==null&&Vu(A.dependencies)?(typeof M=="function"&&(Wh(i,c,M,g),Ee=i.memoizedState),(Fe=xs||V1(i,c,Fe,g,we,Ee,te)||A!==null&&A.dependencies!==null&&Vu(A.dependencies))?(ge||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(g,Ee,te),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(g,Ee,te)),typeof B.componentDidUpdate=="function"&&(i.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof B.componentDidUpdate!="function"||b===A.memoizedProps&&we===A.memoizedState||(i.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||b===A.memoizedProps&&we===A.memoizedState||(i.flags|=1024),i.memoizedProps=g,i.memoizedState=Ee),B.props=g,B.state=Ee,B.context=te,g=Fe):(typeof B.componentDidUpdate!="function"||b===A.memoizedProps&&we===A.memoizedState||(i.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||b===A.memoizedProps&&we===A.memoizedState||(i.flags|=1024),g=!1)}return B=g,l0(A,i),g=(i.flags&128)!==0,B||g?(B=i.stateNode,c=g&&typeof c.getDerivedStateFromError!="function"?null:B.render(),i.flags|=1,A!==null&&g?(i.child=yi(i,A.child,null,w),i.child=yi(i,null,c,w)):En(A,i,c,w),i.memoizedState=B.state,A=i.child):A=LA(A,i,w),A}function Aw(A,i,c,g){return gi(),i.flags|=256,En(A,i,c,g),i.child}var eg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tg(A){return{baseLanes:A,cachePool:Jv()}}function rg(A,i,c){return A=A!==null?A.childLanes&~c:0,i&&(A|=ha),A}function sw(A,i,c){var g=i.pendingProps,w=!1,B=(i.flags&128)!==0,b;if((b=B)||(b=A!==null&&A.memoizedState===null?!1:(zr.current&2)!==0),b&&(w=!0,i.flags&=-129),b=(i.flags&32)!==0,i.flags&=-33,A===null){if(Xt){if(w?ys(i):Bs(),(A=Fr)?(A=hy(A,Na),A=A!==null&&A.data!=="&"?A:null,A!==null&&(i.memoizedState={dehydrated:A,treeContext:hs!==null?{id:dA,overflow:hA}:null,retryLane:536870912,hydrationErrors:null},c=Hv(A),c.return=i,i.child=c,Bn=i,Fr=null)):A=null,A===null)throw ms(i);return Lg(A)?i.lanes=32:i.lanes=536870912,null}var M=g.children;return g=g.fallback,w?(Bs(),w=i.mode,M=o0({mode:"hidden",children:M},w),g=hi(g,w,c,null),M.return=i,g.return=i,M.sibling=g,i.child=M,g=i.child,g.memoizedState=tg(c),g.childLanes=rg(A,b,c),i.memoizedState=eg,Xo(null,g)):(ys(i),ng(i,M))}var te=A.memoizedState;if(te!==null&&(M=te.dehydrated,M!==null)){if(B)i.flags&256?(ys(i),i.flags&=-257,i=ag(A,i,c)):i.memoizedState!==null?(Bs(),i.child=A.child,i.flags|=128,i=null):(Bs(),M=g.fallback,w=i.mode,g=o0({mode:"visible",children:g.children},w),M=hi(M,w,c,null),M.flags|=2,g.return=i,M.return=i,g.sibling=M,i.child=g,yi(i,A.child,null,c),g=i.child,g.memoizedState=tg(c),g.childLanes=rg(A,b,c),i.memoizedState=eg,i=Xo(null,g));else if(ys(i),Lg(M)){if(b=M.nextSibling&&M.nextSibling.dataset,b)var ge=b.dgst;b=ge,g=Error(n(419)),g.stack="",g.digest=b,Ro({value:g,source:null,stack:null}),i=ag(A,i,c)}else if(nn||pl(A,i,c,!1),b=(c&A.childLanes)!==0,nn||b){if(b=Cr,b!==null&&(g=Al(b,c),g!==0&&g!==te.retryLane))throw te.retryLane=g,di(A,g),aa(b,A,g),$h;Mg(M)||x0(),i=ag(A,i,c)}else Mg(M)?(i.flags|=192,i.child=A.child,i=null):(A=te.treeContext,Fr=Qa(M.nextSibling),Bn=i,Xt=!0,gs=null,Na=!1,A!==null&&Gv(i,A),i=ng(i,g.children),i.flags|=4096);return i}return w?(Bs(),M=g.fallback,w=i.mode,te=A.child,ge=te.sibling,g=NA(te,{mode:"hidden",children:g.children}),g.subtreeFlags=te.subtreeFlags&65011712,ge!==null?M=NA(ge,M):(M=hi(M,w,c,null),M.flags|=2),M.return=i,g.return=i,g.sibling=M,i.child=g,Xo(null,g),g=i.child,M=A.child.memoizedState,M===null?M=tg(c):(w=M.cachePool,w!==null?(te=tn._currentValue,w=w.parent!==te?{parent:te,pool:te}:w):w=Jv(),M={baseLanes:M.baseLanes|c,cachePool:w}),g.memoizedState=M,g.childLanes=rg(A,b,c),i.memoizedState=eg,Xo(A.child,g)):(ys(i),c=A.child,A=c.sibling,c=NA(c,{mode:"visible",children:g.children}),c.return=i,c.sibling=null,A!==null&&(b=i.deletions,b===null?(i.deletions=[A],i.flags|=16):b.push(A)),i.child=c,i.memoizedState=null,c)}function ng(A,i){return i=o0({mode:"visible",children:i},A.mode),i.return=A,A.child=i}function o0(A,i){return A=ca(22,A,null,i),A.lanes=0,A}function ag(A,i,c){return yi(i,A.child,null,c),A=ng(i,i.pendingProps.children),A.flags|=2,i.memoizedState=null,A}function iw(A,i,c){A.lanes|=i;var g=A.alternate;g!==null&&(g.lanes|=i),vh(A.return,i,c)}function Ag(A,i,c,g,w,B){var b=A.memoizedState;b===null?A.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:g,tail:c,tailMode:w,treeForkCount:B}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=g,b.tail=c,b.tailMode=w,b.treeForkCount=B)}function lw(A,i,c){var g=i.pendingProps,w=g.revealOrder,B=g.tail;g=g.children;var b=zr.current,M=(b&2)!==0;if(M?(b=b&1|2,i.flags|=128):b&=1,V(zr,b),En(A,i,g,c),g=Xt?Qo:0,!M&&A!==null&&(A.flags&128)!==0)e:for(A=i.child;A!==null;){if(A.tag===13)A.memoizedState!==null&&iw(A,c,i);else if(A.tag===19)iw(A,c,i);else if(A.child!==null){A.child.return=A,A=A.child;continue}if(A===i)break e;for(;A.sibling===null;){if(A.return===null||A.return===i)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}switch(w){case"forwards":for(c=i.child,w=null;c!==null;)A=c.alternate,A!==null&&qu(A)===null&&(w=c),c=c.sibling;c=w,c===null?(w=i.child,i.child=null):(w=c.sibling,c.sibling=null),Ag(i,!1,w,c,B,g);break;case"backwards":case"unstable_legacy-backwards":for(c=null,w=i.child,i.child=null;w!==null;){if(A=w.alternate,A!==null&&qu(A)===null){i.child=w;break}A=w.sibling,w.sibling=c,c=w,w=A}Ag(i,!0,c,null,B,g);break;case"together":Ag(i,!1,null,null,void 0,g);break;default:i.memoizedState=null}return i.child}function LA(A,i,c){if(A!==null&&(i.dependencies=A.dependencies),Ss|=i.lanes,(c&i.childLanes)===0)if(A!==null){if(pl(A,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(A!==null&&i.child!==A.child)throw Error(n(153));if(i.child!==null){for(A=i.child,c=NA(A,A.pendingProps),i.child=c,c.return=i;A.sibling!==null;)A=A.sibling,c=c.sibling=NA(A,A.pendingProps),c.return=i;c.sibling=null}return i.child}function sg(A,i){return(A.lanes&i)!==0?!0:(A=A.dependencies,!!(A!==null&&Vu(A)))}function MF(A,i,c){switch(i.tag){case 3:de(i,i.stateNode.containerInfo),ps(i,tn,A.memoizedState.cache),gi();break;case 27:case 5:ne(i);break;case 4:de(i,i.stateNode.containerInfo);break;case 10:ps(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,kh(i),null;break;case 13:var g=i.memoizedState;if(g!==null)return g.dehydrated!==null?(ys(i),i.flags|=128,null):(c&i.child.childLanes)!==0?sw(A,i,c):(ys(i),A=LA(A,i,c),A!==null?A.sibling:null);ys(i);break;case 19:var w=(A.flags&128)!==0;if(g=(c&i.childLanes)!==0,g||(pl(A,i,c,!1),g=(c&i.childLanes)!==0),w){if(g)return lw(A,i,c);i.flags|=128}if(w=i.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),V(zr,zr.current),g)break;return null;case 22:return i.lanes=0,ew(A,i,c,i.pendingProps);case 24:ps(i,tn,A.memoizedState.cache)}return LA(A,i,c)}function ow(A,i,c){if(A!==null)if(A.memoizedProps!==i.pendingProps)nn=!0;else{if(!sg(A,c)&&(i.flags&128)===0)return nn=!1,MF(A,i,c);nn=(A.flags&131072)!==0}else nn=!1,Xt&&(i.flags&1048576)!==0&&Pv(i,Qo,i.index);switch(i.lanes=0,i.tag){case 16:e:{var g=i.pendingProps;if(A=vi(i.elementType),i.type=A,typeof A=="function")uh(A)?(g=Ci(A,g),i.tag=1,i=aw(null,i,A,g,c)):(i.tag=0,i=Zh(null,i,A,g,c));else{if(A!=null){var w=A.$$typeof;if(w===Q){i.tag=11,i=q1(null,i,A,g,c);break e}else if(w===U){i.tag=14,i=$1(null,i,A,g,c);break e}}throw i=Te(A)||A,Error(n(306,i,""))}}return i;case 0:return Zh(A,i,i.type,i.pendingProps,c);case 1:return g=i.type,w=Ci(g,i.pendingProps),aw(A,i,g,w,c);case 3:e:{if(de(i,i.stateNode.containerInfo),A===null)throw Error(n(387));g=i.pendingProps;var B=i.memoizedState;w=B.element,Th(A,i),Go(i,g,null,c);var b=i.memoizedState;if(g=b.cache,ps(i,tn,g),g!==B.cache&&wh(i,[tn],c,!0),Po(),g=b.element,B.isDehydrated)if(B={element:g,isDehydrated:!1,cache:b.cache},i.updateQueue.baseState=B,i.memoizedState=B,i.flags&256){i=Aw(A,i,g,c);break e}else if(g!==w){w=Fa(Error(n(424)),i),Ro(w),i=Aw(A,i,g,c);break e}else{switch(A=i.stateNode.containerInfo,A.nodeType){case 9:A=A.body;break;default:A=A.nodeName==="HTML"?A.ownerDocument.body:A}for(Fr=Qa(A.firstChild),Bn=i,Xt=!0,gs=null,Na=!0,c=e1(i,null,g,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(gi(),g===w){i=LA(A,i,c);break e}En(A,i,g,c)}i=i.child}return i;case 26:return l0(A,i),A===null?(c=wy(i.type,null,i.pendingProps,null))?i.memoizedState=c:Xt||(c=i.type,A=i.pendingProps,g=S0(le.current).createElement(c),g[O]=i,g[G]=A,Sn(g,c,A),at(g),i.stateNode=g):i.memoizedState=wy(i.type,A.memoizedProps,i.pendingProps,A.memoizedState),null;case 27:return ne(i),A===null&&Xt&&(g=i.stateNode=py(i.type,i.pendingProps,le.current),Bn=i,Na=!0,w=Fr,Us(i.type)?(Hg=w,Fr=Qa(g.firstChild)):Fr=w),En(A,i,i.pendingProps.children,c),l0(A,i),A===null&&(i.flags|=4194304),i.child;case 5:return A===null&&Xt&&((w=g=Fr)&&(g=dU(g,i.type,i.pendingProps,Na),g!==null?(i.stateNode=g,Bn=i,Fr=Qa(g.firstChild),Na=!1,w=!0):w=!1),w||ms(i)),ne(i),w=i.type,B=i.pendingProps,b=A!==null?A.memoizedProps:null,g=B.children,Qg(w,B)?g=null:b!==null&&Qg(w,b)&&(i.flags|=32),i.memoizedState!==null&&(w=Ih(A,i,bF,null,null,c),lc._currentValue=w),l0(A,i),En(A,i,g,c),i.child;case 6:return A===null&&Xt&&((A=c=Fr)&&(c=hU(c,i.pendingProps,Na),c!==null?(i.stateNode=c,Bn=i,Fr=null,A=!0):A=!1),A||ms(i)),null;case 13:return sw(A,i,c);case 4:return de(i,i.stateNode.containerInfo),g=i.pendingProps,A===null?i.child=yi(i,null,g,c):En(A,i,g,c),i.child;case 11:return q1(A,i,i.type,i.pendingProps,c);case 7:return En(A,i,i.pendingProps,c),i.child;case 8:return En(A,i,i.pendingProps.children,c),i.child;case 12:return En(A,i,i.pendingProps.children,c),i.child;case 10:return g=i.pendingProps,ps(i,i.type,g.value),En(A,i,g.children,c),i.child;case 9:return w=i.type._context,g=i.pendingProps.children,pi(i),w=Cn(w),g=g(w),i.flags|=1,En(A,i,g,c),i.child;case 14:return $1(A,i,i.type,i.pendingProps,c);case 15:return Z1(A,i,i.type,i.pendingProps,c);case 19:return lw(A,i,c);case 31:return DF(A,i,c);case 22:return ew(A,i,c,i.pendingProps);case 24:return pi(i),g=Cn(tn),A===null?(w=Ch(),w===null&&(w=Cr,B=yh(),w.pooledCache=B,B.refCount++,B!==null&&(w.pooledCacheLanes|=c),w=B),i.memoizedState={parent:g,cache:w},Sh(i),ps(i,tn,w)):((A.lanes&c)!==0&&(Th(A,i),Go(i,null,null,c),Po()),w=A.memoizedState,B=i.memoizedState,w.parent!==g?(w={parent:g,cache:g},i.memoizedState=w,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=w),ps(i,tn,g)):(g=B.cache,ps(i,tn,g),g!==w.cache&&wh(i,[tn],c,!0))),En(A,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function HA(A){A.flags|=4}function ig(A,i,c,g,w){if((i=(A.mode&32)!==0)&&(i=!1),i){if(A.flags|=16777216,(w&335544128)===w)if(A.stateNode.complete)A.flags|=8192;else if(Dw())A.flags|=8192;else throw wi=Xu,Eh}else A.flags&=-16777217}function cw(A,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)A.flags&=-16777217;else if(A.flags|=16777216,!Sy(i))if(Dw())A.flags|=8192;else throw wi=Xu,Eh}function c0(A,i){i!==null&&(A.flags|=4),A.flags&16384&&(i=A.tag!==22?nl():536870912,A.lanes|=i,Fl|=i)}function Jo(A,i){if(!Xt)switch(A.tailMode){case"hidden":i=A.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?A.tail=null:c.sibling=null;break;case"collapsed":c=A.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?i||A.tail===null?A.tail=null:A.tail.sibling=null:g.sibling=null}}function Ur(A){var i=A.alternate!==null&&A.alternate.child===A.child,c=0,g=0;if(i)for(var w=A.child;w!==null;)c|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=A,w=w.sibling;else for(w=A.child;w!==null;)c|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=A,w=w.sibling;return A.subtreeFlags|=g,A.childLanes=c,i}function LF(A,i,c){var g=i.pendingProps;switch(gh(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ur(i),null;case 1:return Ur(i),null;case 3:return c=i.stateNode,g=null,A!==null&&(g=A.memoizedState.cache),i.memoizedState.cache!==g&&(i.flags|=2048),RA(tn),ce(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(A===null||A.child===null)&&(ml(i)?HA(i):A===null||A.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,ph())),Ur(i),null;case 26:var w=i.type,B=i.memoizedState;return A===null?(HA(i),B!==null?(Ur(i),cw(i,B)):(Ur(i),ig(i,w,null,g,c))):B?B!==A.memoizedState?(HA(i),Ur(i),cw(i,B)):(Ur(i),i.flags&=-16777217):(A=A.memoizedProps,A!==g&&HA(i),Ur(i),ig(i,w,A,g,c)),null;case 27:if(Ce(i),c=le.current,w=i.type,A!==null&&i.stateNode!=null)A.memoizedProps!==g&&HA(i);else{if(!g){if(i.stateNode===null)throw Error(n(166));return Ur(i),null}A=P.current,ml(i)?Vv(i):(A=py(w,g,c),i.stateNode=A,HA(i))}return Ur(i),null;case 5:if(Ce(i),w=i.type,A!==null&&i.stateNode!=null)A.memoizedProps!==g&&HA(i);else{if(!g){if(i.stateNode===null)throw Error(n(166));return Ur(i),null}if(B=P.current,ml(i))Vv(i);else{var b=S0(le.current);switch(B){case 1:B=b.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:B=b.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":B=b.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":B=b.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":B=b.createElement("div"),B.innerHTML="<script><\/script>",B=B.removeChild(B.firstChild);break;case"select":B=typeof g.is=="string"?b.createElement("select",{is:g.is}):b.createElement("select"),g.multiple?B.multiple=!0:g.size&&(B.size=g.size);break;default:B=typeof g.is=="string"?b.createElement(w,{is:g.is}):b.createElement(w)}}B[O]=i,B[G]=g;e:for(b=i.child;b!==null;){if(b.tag===5||b.tag===6)B.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===i)break e;for(;b.sibling===null;){if(b.return===null||b.return===i)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}i.stateNode=B;e:switch(Sn(B,w,g),w){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&HA(i)}}return Ur(i),ig(i,i.type,A===null?null:A.memoizedProps,i.pendingProps,c),null;case 6:if(A&&i.stateNode!=null)A.memoizedProps!==g&&HA(i);else{if(typeof g!="string"&&i.stateNode===null)throw Error(n(166));if(A=le.current,ml(i)){if(A=i.stateNode,c=i.memoizedProps,g=null,w=Bn,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}A[O]=i,A=!!(A.nodeValue===c||g!==null&&g.suppressHydrationWarning===!0||sy(A.nodeValue,c)),A||ms(i,!0)}else A=S0(A).createTextNode(g),A[O]=i,i.stateNode=A}return Ur(i),null;case 31:if(c=i.memoizedState,A===null||A.memoizedState!==null){if(g=ml(i),c!==null){if(A===null){if(!g)throw Error(n(318));if(A=i.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(557));A[O]=i}else gi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ur(i),A=!1}else c=ph(),A!==null&&A.memoizedState!==null&&(A.memoizedState.hydrationErrors=c),A=!0;if(!A)return i.flags&256?(fa(i),i):(fa(i),null);if((i.flags&128)!==0)throw Error(n(558))}return Ur(i),null;case 13:if(g=i.memoizedState,A===null||A.memoizedState!==null&&A.memoizedState.dehydrated!==null){if(w=ml(i),g!==null&&g.dehydrated!==null){if(A===null){if(!w)throw Error(n(318));if(w=i.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[O]=i}else gi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ur(i),w=!1}else w=ph(),A!==null&&A.memoizedState!==null&&(A.memoizedState.hydrationErrors=w),w=!0;if(!w)return i.flags&256?(fa(i),i):(fa(i),null)}return fa(i),(i.flags&128)!==0?(i.lanes=c,i):(c=g!==null,A=A!==null&&A.memoizedState!==null,c&&(g=i.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool),B=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(B=g.memoizedState.cachePool.pool),B!==w&&(g.flags|=2048)),c!==A&&c&&(i.child.flags|=8192),c0(i,i.updateQueue),Ur(i),null);case 4:return ce(),A===null&&Fg(i.stateNode.containerInfo),Ur(i),null;case 10:return RA(i.type),Ur(i),null;case 19:if(k(zr),g=i.memoizedState,g===null)return Ur(i),null;if(w=(i.flags&128)!==0,B=g.rendering,B===null)if(w)Jo(g,!1);else{if(Pr!==0||A!==null&&(A.flags&128)!==0)for(A=i.child;A!==null;){if(B=qu(A),B!==null){for(i.flags|=128,Jo(g,!1),A=B.updateQueue,i.updateQueue=A,c0(i,A),i.subtreeFlags=0,A=c,c=i.child;c!==null;)Lv(c,A),c=c.sibling;return V(zr,zr.current&1|2),Xt&&IA(i,g.treeForkCount),i.child}A=A.sibling}g.tail!==null&&dt()>g0&&(i.flags|=128,w=!0,Jo(g,!1),i.lanes=4194304)}else{if(!w)if(A=qu(B),A!==null){if(i.flags|=128,w=!0,A=A.updateQueue,i.updateQueue=A,c0(i,A),Jo(g,!0),g.tail===null&&g.tailMode==="hidden"&&!B.alternate&&!Xt)return Ur(i),null}else 2*dt()-g.renderingStartTime>g0&&c!==536870912&&(i.flags|=128,w=!0,Jo(g,!1),i.lanes=4194304);g.isBackwards?(B.sibling=i.child,i.child=B):(A=g.last,A!==null?A.sibling=B:i.child=B,g.last=B)}return g.tail!==null?(A=g.tail,g.rendering=A,g.tail=A.sibling,g.renderingStartTime=dt(),A.sibling=null,c=zr.current,V(zr,w?c&1|2:c&1),Xt&&IA(i,g.treeForkCount),A):(Ur(i),null);case 22:case 23:return fa(i),Uh(),g=i.memoizedState!==null,A!==null?A.memoizedState!==null!==g&&(i.flags|=8192):g&&(i.flags|=8192),g?(c&536870912)!==0&&(i.flags&128)===0&&(Ur(i),i.subtreeFlags&6&&(i.flags|=8192)):Ur(i),c=i.updateQueue,c!==null&&c0(i,c.retryQueue),c=null,A!==null&&A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(c=A.memoizedState.cachePool.pool),g=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),g!==c&&(i.flags|=2048),A!==null&&k(xi),null;case 24:return c=null,A!==null&&(c=A.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),RA(tn),Ur(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function HF(A,i){switch(gh(i),i.tag){case 1:return A=i.flags,A&65536?(i.flags=A&-65537|128,i):null;case 3:return RA(tn),ce(),A=i.flags,(A&65536)!==0&&(A&128)===0?(i.flags=A&-65537|128,i):null;case 26:case 27:case 5:return Ce(i),null;case 31:if(i.memoizedState!==null){if(fa(i),i.alternate===null)throw Error(n(340));gi()}return A=i.flags,A&65536?(i.flags=A&-65537|128,i):null;case 13:if(fa(i),A=i.memoizedState,A!==null&&A.dehydrated!==null){if(i.alternate===null)throw Error(n(340));gi()}return A=i.flags,A&65536?(i.flags=A&-65537|128,i):null;case 19:return k(zr),null;case 4:return ce(),null;case 10:return RA(i.type),null;case 22:case 23:return fa(i),Uh(),A!==null&&k(xi),A=i.flags,A&65536?(i.flags=A&-65537|128,i):null;case 24:return RA(tn),null;case 25:return null;default:return null}}function uw(A,i){switch(gh(i),i.tag){case 3:RA(tn),ce();break;case 26:case 27:case 5:Ce(i);break;case 4:ce();break;case 31:i.memoizedState!==null&&fa(i);break;case 13:fa(i);break;case 19:k(zr);break;case 10:RA(i.type);break;case 22:case 23:fa(i),Uh(),A!==null&&k(xi);break;case 24:RA(tn)}}function Wo(A,i){try{var c=i.updateQueue,g=c!==null?c.lastEffect:null;if(g!==null){var w=g.next;c=w;do{if((c.tag&A)===A){g=void 0;var B=c.create,b=c.inst;g=B(),b.destroy=g}c=c.next}while(c!==w)}}catch(M){cr(i,i.return,M)}}function Cs(A,i,c){try{var g=i.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var B=w.next;g=B;do{if((g.tag&A)===A){var b=g.inst,M=b.destroy;if(M!==void 0){b.destroy=void 0,w=i;var te=c,ge=M;try{ge()}catch(Fe){cr(w,te,Fe)}}}g=g.next}while(g!==B)}}catch(Fe){cr(i,i.return,Fe)}}function fw(A){var i=A.updateQueue;if(i!==null){var c=A.stateNode;try{r1(i,c)}catch(g){cr(A,A.return,g)}}}function dw(A,i,c){c.props=Ci(A.type,A.memoizedProps),c.state=A.memoizedState;try{c.componentWillUnmount()}catch(g){cr(A,i,g)}}function Yo(A,i){try{var c=A.ref;if(c!==null){switch(A.tag){case 26:case 27:case 5:var g=A.stateNode;break;case 30:g=A.stateNode;break;default:g=A.stateNode}typeof c=="function"?A.refCleanup=c(g):c.current=g}}catch(w){cr(A,i,w)}}function gA(A,i){var c=A.ref,g=A.refCleanup;if(c!==null)if(typeof g=="function")try{g()}catch(w){cr(A,i,w)}finally{A.refCleanup=null,A=A.alternate,A!=null&&(A.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(w){cr(A,i,w)}else c.current=null}function hw(A){var i=A.type,c=A.memoizedProps,g=A.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&g.focus();break e;case"img":c.src?g.src=c.src:c.srcSet&&(g.srcset=c.srcSet)}}catch(w){cr(A,A.return,w)}}function lg(A,i,c){try{var g=A.stateNode;iU(g,A.type,c,i),g[G]=i}catch(w){cr(A,A.return,w)}}function gw(A){return A.tag===5||A.tag===3||A.tag===26||A.tag===27&&Us(A.type)||A.tag===4}function og(A){e:for(;;){for(;A.sibling===null;){if(A.return===null||gw(A.return))return null;A=A.return}for(A.sibling.return=A.return,A=A.sibling;A.tag!==5&&A.tag!==6&&A.tag!==18;){if(A.tag===27&&Us(A.type)||A.flags&2||A.child===null||A.tag===4)continue e;A.child.return=A,A=A.child}if(!(A.flags&2))return A.stateNode}}function cg(A,i,c){var g=A.tag;if(g===5||g===6)A=A.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(A,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(A),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=UA));else if(g!==4&&(g===27&&Us(A.type)&&(c=A.stateNode,i=null),A=A.child,A!==null))for(cg(A,i,c),A=A.sibling;A!==null;)cg(A,i,c),A=A.sibling}function u0(A,i,c){var g=A.tag;if(g===5||g===6)A=A.stateNode,i?c.insertBefore(A,i):c.appendChild(A);else if(g!==4&&(g===27&&Us(A.type)&&(c=A.stateNode),A=A.child,A!==null))for(u0(A,i,c),A=A.sibling;A!==null;)u0(A,i,c),A=A.sibling}function mw(A){var i=A.stateNode,c=A.memoizedProps;try{for(var g=A.type,w=i.attributes;w.length;)i.removeAttributeNode(w[0]);Sn(i,g,c),i[O]=A,i[G]=c}catch(B){cr(A,A.return,B)}}var OA=!1,an=!1,ug=!1,pw=typeof WeakSet=="function"?WeakSet:Set,gn=null;function OF(A,i){if(A=A.containerInfo,Ng=N0,A=Fv(A),ah(A)){if("selectionStart"in A)var c={start:A.selectionStart,end:A.selectionEnd};else e:{c=(c=A.ownerDocument)&&c.defaultView||window;var g=c.getSelection&&c.getSelection();if(g&&g.rangeCount!==0){c=g.anchorNode;var w=g.anchorOffset,B=g.focusNode;g=g.focusOffset;try{c.nodeType,B.nodeType}catch{c=null;break e}var b=0,M=-1,te=-1,ge=0,Fe=0,ke=A,we=null;t:for(;;){for(var Ee;ke!==c||w!==0&&ke.nodeType!==3||(M=b+w),ke!==B||g!==0&&ke.nodeType!==3||(te=b+g),ke.nodeType===3&&(b+=ke.nodeValue.length),(Ee=ke.firstChild)!==null;)we=ke,ke=Ee;for(;;){if(ke===A)break t;if(we===c&&++ge===w&&(M=b),we===B&&++Fe===g&&(te=b),(Ee=ke.nextSibling)!==null)break;ke=we,we=ke.parentNode}ke=Ee}c=M===-1||te===-1?null:{start:M,end:te}}else c=null}c=c||{start:0,end:0}}else c=null;for(Ig={focusedElem:A,selectionRange:c},N0=!1,gn=i;gn!==null;)if(i=gn,A=i.child,(i.subtreeFlags&1028)!==0&&A!==null)A.return=i,gn=A;else for(;gn!==null;){switch(i=gn,B=i.alternate,A=i.flags,i.tag){case 0:if((A&4)!==0&&(A=i.updateQueue,A=A!==null?A.events:null,A!==null))for(c=0;c<A.length;c++)w=A[c],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((A&1024)!==0&&B!==null){A=void 0,c=i,w=B.memoizedProps,B=B.memoizedState,g=c.stateNode;try{var nt=Ci(c.type,w);A=g.getSnapshotBeforeUpdate(nt,B),g.__reactInternalSnapshotBeforeUpdate=A}catch(pt){cr(c,c.return,pt)}}break;case 3:if((A&1024)!==0){if(A=i.stateNode.containerInfo,c=A.nodeType,c===9)Dg(A);else if(c===1)switch(A.nodeName){case"HEAD":case"HTML":case"BODY":Dg(A);break;default:A.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((A&1024)!==0)throw Error(n(163))}if(A=i.sibling,A!==null){A.return=i.return,gn=A;break}gn=i.return}}function xw(A,i,c){var g=c.flags;switch(c.tag){case 0:case 11:case 15:GA(A,c),g&4&&Wo(5,c);break;case 1:if(GA(A,c),g&4)if(A=c.stateNode,i===null)try{A.componentDidMount()}catch(b){cr(c,c.return,b)}else{var w=Ci(c.type,i.memoizedProps);i=i.memoizedState;try{A.componentDidUpdate(w,i,A.__reactInternalSnapshotBeforeUpdate)}catch(b){cr(c,c.return,b)}}g&64&&fw(c),g&512&&Yo(c,c.return);break;case 3:if(GA(A,c),g&64&&(A=c.updateQueue,A!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{r1(A,i)}catch(b){cr(c,c.return,b)}}break;case 27:i===null&&g&4&&mw(c);case 26:case 5:GA(A,c),i===null&&g&4&&hw(c),g&512&&Yo(c,c.return);break;case 12:GA(A,c);break;case 31:GA(A,c),g&4&&yw(A,c);break;case 13:GA(A,c),g&4&&Bw(A,c),g&64&&(A=c.memoizedState,A!==null&&(A=A.dehydrated,A!==null&&(c=WF.bind(null,c),gU(A,c))));break;case 22:if(g=c.memoizedState!==null||OA,!g){i=i!==null&&i.memoizedState!==null||an,w=OA;var B=an;OA=g,(an=i)&&!B?VA(A,c,(c.subtreeFlags&8772)!==0):GA(A,c),OA=w,an=B}break;case 30:break;default:GA(A,c)}}function vw(A){var i=A.alternate;i!==null&&(A.alternate=null,vw(i)),A.child=null,A.deletions=null,A.sibling=null,A.tag===5&&(i=A.stateNode,i!==null&&Le(i)),A.stateNode=null,A.return=null,A.dependencies=null,A.memoizedProps=null,A.memoizedState=null,A.pendingProps=null,A.stateNode=null,A.updateQueue=null}var Qr=null,ea=!1;function PA(A,i,c){for(c=c.child;c!==null;)ww(A,i,c),c=c.sibling}function ww(A,i,c){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Bt,c)}catch{}switch(c.tag){case 26:an||gA(c,i),PA(A,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:an||gA(c,i);var g=Qr,w=ea;Us(c.type)&&(Qr=c.stateNode,ea=!1),PA(A,i,c),Ac(c.stateNode),Qr=g,ea=w;break;case 5:an||gA(c,i);case 6:if(g=Qr,w=ea,Qr=null,PA(A,i,c),Qr=g,ea=w,Qr!==null)if(ea)try{(Qr.nodeType===9?Qr.body:Qr.nodeName==="HTML"?Qr.ownerDocument.body:Qr).removeChild(c.stateNode)}catch(B){cr(c,i,B)}else try{Qr.removeChild(c.stateNode)}catch(B){cr(c,i,B)}break;case 18:Qr!==null&&(ea?(A=Qr,fy(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,c.stateNode),Ml(A)):fy(Qr,c.stateNode));break;case 4:g=Qr,w=ea,Qr=c.stateNode.containerInfo,ea=!0,PA(A,i,c),Qr=g,ea=w;break;case 0:case 11:case 14:case 15:Cs(2,c,i),an||Cs(4,c,i),PA(A,i,c);break;case 1:an||(gA(c,i),g=c.stateNode,typeof g.componentWillUnmount=="function"&&dw(c,i,g)),PA(A,i,c);break;case 21:PA(A,i,c);break;case 22:an=(g=an)||c.memoizedState!==null,PA(A,i,c),an=g;break;default:PA(A,i,c)}}function yw(A,i){if(i.memoizedState===null&&(A=i.alternate,A!==null&&(A=A.memoizedState,A!==null))){A=A.dehydrated;try{Ml(A)}catch(c){cr(i,i.return,c)}}}function Bw(A,i){if(i.memoizedState===null&&(A=i.alternate,A!==null&&(A=A.memoizedState,A!==null&&(A=A.dehydrated,A!==null))))try{Ml(A)}catch(c){cr(i,i.return,c)}}function PF(A){switch(A.tag){case 31:case 13:case 19:var i=A.stateNode;return i===null&&(i=A.stateNode=new pw),i;case 22:return A=A.stateNode,i=A._retryCache,i===null&&(i=A._retryCache=new pw),i;default:throw Error(n(435,A.tag))}}function f0(A,i){var c=PF(A);i.forEach(function(g){if(!c.has(g)){c.add(g);var w=YF.bind(null,A,g);g.then(w,w)}})}function ta(A,i){var c=i.deletions;if(c!==null)for(var g=0;g<c.length;g++){var w=c[g],B=A,b=i,M=b;e:for(;M!==null;){switch(M.tag){case 27:if(Us(M.type)){Qr=M.stateNode,ea=!1;break e}break;case 5:Qr=M.stateNode,ea=!1;break e;case 3:case 4:Qr=M.stateNode.containerInfo,ea=!0;break e}M=M.return}if(Qr===null)throw Error(n(160));ww(B,b,w),Qr=null,ea=!1,B=w.alternate,B!==null&&(B.return=null),w.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Cw(i,A),i=i.sibling}var eA=null;function Cw(A,i){var c=A.alternate,g=A.flags;switch(A.tag){case 0:case 11:case 14:case 15:ta(i,A),ra(A),g&4&&(Cs(3,A,A.return),Wo(3,A),Cs(5,A,A.return));break;case 1:ta(i,A),ra(A),g&512&&(an||c===null||gA(c,c.return)),g&64&&OA&&(A=A.updateQueue,A!==null&&(g=A.callbacks,g!==null&&(c=A.shared.hiddenCallbacks,A.shared.hiddenCallbacks=c===null?g:c.concat(g))));break;case 26:var w=eA;if(ta(i,A),ra(A),g&512&&(an||c===null||gA(c,c.return)),g&4){var B=c!==null?c.memoizedState:null;if(g=A.memoizedState,c===null)if(g===null)if(A.stateNode===null){e:{g=A.type,c=A.memoizedProps,w=w.ownerDocument||w;t:switch(g){case"title":B=w.getElementsByTagName("title")[0],(!B||B[ve]||B[O]||B.namespaceURI==="http://www.w3.org/2000/svg"||B.hasAttribute("itemprop"))&&(B=w.createElement(g),w.head.insertBefore(B,w.querySelector("head > title"))),Sn(B,g,c),B[O]=A,at(B),g=B;break e;case"link":var b=Cy("link","href",w).get(g+(c.href||""));if(b){for(var M=0;M<b.length;M++)if(B=b[M],B.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&B.getAttribute("rel")===(c.rel==null?null:c.rel)&&B.getAttribute("title")===(c.title==null?null:c.title)&&B.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(M,1);break t}}B=w.createElement(g),Sn(B,g,c),w.head.appendChild(B);break;case"meta":if(b=Cy("meta","content",w).get(g+(c.content||""))){for(M=0;M<b.length;M++)if(B=b[M],B.getAttribute("content")===(c.content==null?null:""+c.content)&&B.getAttribute("name")===(c.name==null?null:c.name)&&B.getAttribute("property")===(c.property==null?null:c.property)&&B.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&B.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(M,1);break t}}B=w.createElement(g),Sn(B,g,c),w.head.appendChild(B);break;default:throw Error(n(468,g))}B[O]=A,at(B),g=B}A.stateNode=g}else Ey(w,A.type,A.stateNode);else A.stateNode=By(w,g,A.memoizedProps);else B!==g?(B===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):B.count--,g===null?Ey(w,A.type,A.stateNode):By(w,g,A.memoizedProps)):g===null&&A.stateNode!==null&&lg(A,A.memoizedProps,c.memoizedProps)}break;case 27:ta(i,A),ra(A),g&512&&(an||c===null||gA(c,c.return)),c!==null&&g&4&&lg(A,A.memoizedProps,c.memoizedProps);break;case 5:if(ta(i,A),ra(A),g&512&&(an||c===null||gA(c,c.return)),A.flags&32){w=A.stateNode;try{mt(w,"")}catch(nt){cr(A,A.return,nt)}}g&4&&A.stateNode!=null&&(w=A.memoizedProps,lg(A,w,c!==null?c.memoizedProps:w)),g&1024&&(ug=!0);break;case 6:if(ta(i,A),ra(A),g&4){if(A.stateNode===null)throw Error(n(162));g=A.memoizedProps,c=A.stateNode;try{c.nodeValue=g}catch(nt){cr(A,A.return,nt)}}break;case 3:if(b0=null,w=eA,eA=T0(i.containerInfo),ta(i,A),eA=w,ra(A),g&4&&c!==null&&c.memoizedState.isDehydrated)try{Ml(i.containerInfo)}catch(nt){cr(A,A.return,nt)}ug&&(ug=!1,Ew(A));break;case 4:g=eA,eA=T0(A.stateNode.containerInfo),ta(i,A),ra(A),eA=g;break;case 12:ta(i,A),ra(A);break;case 31:ta(i,A),ra(A),g&4&&(g=A.updateQueue,g!==null&&(A.updateQueue=null,f0(A,g)));break;case 13:ta(i,A),ra(A),A.child.flags&8192&&A.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(h0=dt()),g&4&&(g=A.updateQueue,g!==null&&(A.updateQueue=null,f0(A,g)));break;case 22:w=A.memoizedState!==null;var te=c!==null&&c.memoizedState!==null,ge=OA,Fe=an;if(OA=ge||w,an=Fe||te,ta(i,A),an=Fe,OA=ge,ra(A),g&8192)e:for(i=A.stateNode,i._visibility=w?i._visibility&-2:i._visibility|1,w&&(c===null||te||OA||an||Ei(A)),c=null,i=A;;){if(i.tag===5||i.tag===26){if(c===null){te=c=i;try{if(B=te.stateNode,w)b=B.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{M=te.stateNode;var ke=te.memoizedProps.style,we=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;M.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(nt){cr(te,te.return,nt)}}}else if(i.tag===6){if(c===null){te=i;try{te.stateNode.nodeValue=w?"":te.memoizedProps}catch(nt){cr(te,te.return,nt)}}}else if(i.tag===18){if(c===null){te=i;try{var Ee=te.stateNode;w?dy(Ee,!0):dy(te.stateNode,!1)}catch(nt){cr(te,te.return,nt)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===A)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===A)break e;for(;i.sibling===null;){if(i.return===null||i.return===A)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}g&4&&(g=A.updateQueue,g!==null&&(c=g.retryQueue,c!==null&&(g.retryQueue=null,f0(A,c))));break;case 19:ta(i,A),ra(A),g&4&&(g=A.updateQueue,g!==null&&(A.updateQueue=null,f0(A,g)));break;case 30:break;case 21:break;default:ta(i,A),ra(A)}}function ra(A){var i=A.flags;if(i&2){try{for(var c,g=A.return;g!==null;){if(gw(g)){c=g;break}g=g.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var w=c.stateNode,B=og(A);u0(A,B,w);break;case 5:var b=c.stateNode;c.flags&32&&(mt(b,""),c.flags&=-33);var M=og(A);u0(A,M,b);break;case 3:case 4:var te=c.stateNode.containerInfo,ge=og(A);cg(A,ge,te);break;default:throw Error(n(161))}}catch(Fe){cr(A,A.return,Fe)}A.flags&=-3}i&4096&&(A.flags&=-4097)}function Ew(A){if(A.subtreeFlags&1024)for(A=A.child;A!==null;){var i=A;Ew(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),A=A.sibling}}function GA(A,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)xw(A,i.alternate,i),i=i.sibling}function Ei(A){for(A=A.child;A!==null;){var i=A;switch(i.tag){case 0:case 11:case 14:case 15:Cs(4,i,i.return),Ei(i);break;case 1:gA(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&dw(i,i.return,c),Ei(i);break;case 27:Ac(i.stateNode);case 26:case 5:gA(i,i.return),Ei(i);break;case 22:i.memoizedState===null&&Ei(i);break;case 30:Ei(i);break;default:Ei(i)}A=A.sibling}}function VA(A,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var g=i.alternate,w=A,B=i,b=B.flags;switch(B.tag){case 0:case 11:case 15:VA(w,B,c),Wo(4,B);break;case 1:if(VA(w,B,c),g=B,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(ge){cr(g,g.return,ge)}if(g=B,w=g.updateQueue,w!==null){var M=g.stateNode;try{var te=w.shared.hiddenCallbacks;if(te!==null)for(w.shared.hiddenCallbacks=null,w=0;w<te.length;w++)t1(te[w],M)}catch(ge){cr(g,g.return,ge)}}c&&b&64&&fw(B),Yo(B,B.return);break;case 27:mw(B);case 26:case 5:VA(w,B,c),c&&g===null&&b&4&&hw(B),Yo(B,B.return);break;case 12:VA(w,B,c);break;case 31:VA(w,B,c),c&&b&4&&yw(w,B);break;case 13:VA(w,B,c),c&&b&4&&Bw(w,B);break;case 22:B.memoizedState===null&&VA(w,B,c),Yo(B,B.return);break;case 30:break;default:VA(w,B,c)}i=i.sibling}}function fg(A,i){var c=null;A!==null&&A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(c=A.memoizedState.cachePool.pool),A=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(A=i.memoizedState.cachePool.pool),A!==c&&(A!=null&&A.refCount++,c!=null&&Do(c))}function dg(A,i){A=null,i.alternate!==null&&(A=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==A&&(i.refCount++,A!=null&&Do(A))}function tA(A,i,c,g){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Sw(A,i,c,g),i=i.sibling}function Sw(A,i,c,g){var w=i.flags;switch(i.tag){case 0:case 11:case 15:tA(A,i,c,g),w&2048&&Wo(9,i);break;case 1:tA(A,i,c,g);break;case 3:tA(A,i,c,g),w&2048&&(A=null,i.alternate!==null&&(A=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==A&&(i.refCount++,A!=null&&Do(A)));break;case 12:if(w&2048){tA(A,i,c,g),A=i.stateNode;try{var B=i.memoizedProps,b=B.id,M=B.onPostCommit;typeof M=="function"&&M(b,i.alternate===null?"mount":"update",A.passiveEffectDuration,-0)}catch(te){cr(i,i.return,te)}}else tA(A,i,c,g);break;case 31:tA(A,i,c,g);break;case 13:tA(A,i,c,g);break;case 23:break;case 22:B=i.stateNode,b=i.alternate,i.memoizedState!==null?B._visibility&2?tA(A,i,c,g):qo(A,i):B._visibility&2?tA(A,i,c,g):(B._visibility|=2,Tl(A,i,c,g,(i.subtreeFlags&10256)!==0||!1)),w&2048&&fg(b,i);break;case 24:tA(A,i,c,g),w&2048&&dg(i.alternate,i);break;default:tA(A,i,c,g)}}function Tl(A,i,c,g,w){for(w=w&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var B=A,b=i,M=c,te=g,ge=b.flags;switch(b.tag){case 0:case 11:case 15:Tl(B,b,M,te,w),Wo(8,b);break;case 23:break;case 22:var Fe=b.stateNode;b.memoizedState!==null?Fe._visibility&2?Tl(B,b,M,te,w):qo(B,b):(Fe._visibility|=2,Tl(B,b,M,te,w)),w&&ge&2048&&fg(b.alternate,b);break;case 24:Tl(B,b,M,te,w),w&&ge&2048&&dg(b.alternate,b);break;default:Tl(B,b,M,te,w)}i=i.sibling}}function qo(A,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=A,g=i,w=g.flags;switch(g.tag){case 22:qo(c,g),w&2048&&fg(g.alternate,g);break;case 24:qo(c,g),w&2048&&dg(g.alternate,g);break;default:qo(c,g)}i=i.sibling}}var $o=8192;function _l(A,i,c){if(A.subtreeFlags&$o)for(A=A.child;A!==null;)Tw(A,i,c),A=A.sibling}function Tw(A,i,c){switch(A.tag){case 26:_l(A,i,c),A.flags&$o&&A.memoizedState!==null&&_U(c,eA,A.memoizedState,A.memoizedProps);break;case 5:_l(A,i,c);break;case 3:case 4:var g=eA;eA=T0(A.stateNode.containerInfo),_l(A,i,c),eA=g;break;case 22:A.memoizedState===null&&(g=A.alternate,g!==null&&g.memoizedState!==null?(g=$o,$o=16777216,_l(A,i,c),$o=g):_l(A,i,c));break;default:_l(A,i,c)}}function _w(A){var i=A.alternate;if(i!==null&&(A=i.child,A!==null)){i.child=null;do i=A.sibling,A.sibling=null,A=i;while(A!==null)}}function Zo(A){var i=A.deletions;if((A.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var g=i[c];gn=g,Fw(g,A)}_w(A)}if(A.subtreeFlags&10256)for(A=A.child;A!==null;)bw(A),A=A.sibling}function bw(A){switch(A.tag){case 0:case 11:case 15:Zo(A),A.flags&2048&&Cs(9,A,A.return);break;case 3:Zo(A);break;case 12:Zo(A);break;case 22:var i=A.stateNode;A.memoizedState!==null&&i._visibility&2&&(A.return===null||A.return.tag!==13)?(i._visibility&=-3,d0(A)):Zo(A);break;default:Zo(A)}}function d0(A){var i=A.deletions;if((A.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var g=i[c];gn=g,Fw(g,A)}_w(A)}for(A=A.child;A!==null;){switch(i=A,i.tag){case 0:case 11:case 15:Cs(8,i,i.return),d0(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,d0(i));break;default:d0(i)}A=A.sibling}}function Fw(A,i){for(;gn!==null;){var c=gn;switch(c.tag){case 0:case 11:case 15:Cs(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var g=c.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Do(c.memoizedState.cache)}if(g=c.child,g!==null)g.return=c,gn=g;else e:for(c=A;gn!==null;){g=gn;var w=g.sibling,B=g.return;if(vw(g),g===c){gn=null;break e}if(w!==null){w.return=B,gn=w;break e}gn=B}}}var GF={getCacheForType:function(A){var i=Cn(tn),c=i.data.get(A);return c===void 0&&(c=A(),i.data.set(A,c)),c},cacheSignal:function(){return Cn(tn).controller.signal}},VF=typeof WeakMap=="function"?WeakMap:Map,nr=0,Cr=null,Ot=null,Gt=0,or=0,da=null,Es=!1,bl=!1,hg=!1,KA=0,Pr=0,Ss=0,Si=0,gg=0,ha=0,Fl=0,ec=null,na=null,mg=!1,h0=0,Uw=0,g0=1/0,m0=null,Ts=null,un=0,_s=null,Ul=null,jA=0,pg=0,xg=null,kw=null,tc=0,vg=null;function ga(){return(nr&2)!==0&&Gt!==0?Gt&-Gt:q.T!==null?Sg():I()}function Nw(){if(ha===0)if((Gt&536870912)===0||Xt){var A=Mr;Mr<<=1,(Mr&3932160)===0&&(Mr=262144),ha=A}else ha=536870912;return A=ua.current,A!==null&&(A.flags|=32),ha}function aa(A,i,c){(A===Cr&&(or===2||or===9)||A.cancelPendingCommit!==null)&&(kl(A,0),bs(A,Gt,ha,!1)),fA(A,c),((nr&2)===0||A!==Cr)&&(A===Cr&&((nr&2)===0&&(Si|=c),Pr===4&&bs(A,Gt,ha,!1)),mA(A))}function Iw(A,i,c){if((nr&6)!==0)throw Error(n(327));var g=!c&&(i&127)===0&&(i&A.expiredLanes)===0||FA(A,i),w=g?zF(A,i):yg(A,i,!0),B=g;do{if(w===0){bl&&!g&&bs(A,i,0,!1);break}else{if(c=A.current.alternate,B&&!KF(c)){w=yg(A,i,!1),B=!1;continue}if(w===2){if(B=i,A.errorRecoveryDisabledLanes&B)var b=0;else b=A.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){i=b;e:{var M=A;w=ec;var te=M.current.memoizedState.isDehydrated;if(te&&(kl(M,b).flags|=256),b=yg(M,b,!1),b!==2){if(hg&&!te){M.errorRecoveryDisabledLanes|=B,Si|=B,w=4;break e}B=na,na=w,B!==null&&(na===null?na=B:na.push.apply(na,B))}w=b}if(B=!1,w!==2)continue}}if(w===1){kl(A,0),bs(A,i,0,!0);break}e:{switch(g=A,B=w,B){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:bs(g,i,ha,!Es);break e;case 2:na=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(w=h0+300-dt(),10<w)){if(bs(g,i,ha,!Es),bA(g,0,!0)!==0)break e;jA=i,g.timeoutHandle=cy(Qw.bind(null,g,c,na,m0,mg,i,ha,Si,Fl,Es,B,"Throttled",-0,0),w);break e}Qw(g,c,na,m0,mg,i,ha,Si,Fl,Es,B,null,-0,0)}}break}while(!0);mA(A)}function Qw(A,i,c,g,w,B,b,M,te,ge,Fe,ke,we,Ee){if(A.timeoutHandle=-1,ke=i.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:UA},Tw(i,B,ke);var nt=(B&62914560)===B?h0-dt():(B&4194048)===B?Uw-dt():0;if(nt=bU(ke,nt),nt!==null){jA=B,A.cancelPendingCommit=nt(Gw.bind(null,A,i,B,c,g,w,b,M,te,Fe,ke,null,we,Ee)),bs(A,B,b,!ge);return}}Gw(A,i,B,c,g,w,b,M,te)}function KF(A){for(var i=A;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var g=0;g<c.length;g++){var w=c[g],B=w.getSnapshot;w=w.value;try{if(!oa(B(),w))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===A)break;for(;i.sibling===null;){if(i.return===null||i.return===A)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function bs(A,i,c,g){i&=~gg,i&=~Si,A.suspendedLanes|=i,A.pingedLanes&=~i,g&&(A.warmLanes|=i),g=A.expirationTimes;for(var w=i;0<w;){var B=31-Sr(w),b=1<<B;g[B]=-1,w&=~b}c!==0&&al(A,c,i)}function p0(){return(nr&6)===0?(rc(0),!1):!0}function wg(){if(Ot!==null){if(or===0)var A=Ot.return;else A=Ot,QA=mi=null,Dh(A),yl=null,Lo=0,A=Ot;for(;A!==null;)uw(A.alternate,A),A=A.return;Ot=null}}function kl(A,i){var c=A.timeoutHandle;c!==-1&&(A.timeoutHandle=-1,cU(c)),c=A.cancelPendingCommit,c!==null&&(A.cancelPendingCommit=null,c()),jA=0,wg(),Cr=A,Ot=c=NA(A.current,null),Gt=i,or=0,da=null,Es=!1,bl=FA(A,i),hg=!1,Fl=ha=gg=Si=Ss=Pr=0,na=ec=null,mg=!1,(i&8)!==0&&(i|=i&32);var g=A.entangledLanes;if(g!==0)for(A=A.entanglements,g&=i;0<g;){var w=31-Sr(g),B=1<<w;i|=A[w],g&=~B}return KA=i,Lu(),c}function Rw(A,i){Ft=null,q.H=zo,i===wl||i===zu?(i=qv(),or=3):i===Eh?(i=qv(),or=4):or=i===$h?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,da=i,Ot===null&&(Pr=1,s0(A,Fa(i,A.current)))}function Dw(){var A=ua.current;return A===null?!0:(Gt&4194048)===Gt?Ia===null:(Gt&62914560)===Gt||(Gt&536870912)!==0?A===Ia:!1}function Mw(){var A=q.H;return q.H=zo,A===null?zo:A}function Lw(){var A=q.A;return q.A=GF,A}function x0(){Pr=4,Es||(Gt&4194048)!==Gt&&ua.current!==null||(bl=!0),(Ss&134217727)===0&&(Si&134217727)===0||Cr===null||bs(Cr,Gt,ha,!1)}function yg(A,i,c){var g=nr;nr|=2;var w=Mw(),B=Lw();(Cr!==A||Gt!==i)&&(m0=null,kl(A,i)),i=!1;var b=Pr;e:do try{if(or!==0&&Ot!==null){var M=Ot,te=da;switch(or){case 8:wg(),b=6;break e;case 3:case 2:case 9:case 6:ua.current===null&&(i=!0);var ge=or;if(or=0,da=null,Nl(A,M,te,ge),c&&bl){b=0;break e}break;default:ge=or,or=0,da=null,Nl(A,M,te,ge)}}jF(),b=Pr;break}catch(Fe){Rw(A,Fe)}while(!0);return i&&A.shellSuspendCounter++,QA=mi=null,nr=g,q.H=w,q.A=B,Ot===null&&(Cr=null,Gt=0,Lu()),b}function jF(){for(;Ot!==null;)Hw(Ot)}function zF(A,i){var c=nr;nr|=2;var g=Mw(),w=Lw();Cr!==A||Gt!==i?(m0=null,g0=dt()+500,kl(A,i)):bl=FA(A,i);e:do try{if(or!==0&&Ot!==null){i=Ot;var B=da;t:switch(or){case 1:or=0,da=null,Nl(A,i,B,1);break;case 2:case 9:if(Wv(B)){or=0,da=null,Ow(i);break}i=function(){or!==2&&or!==9||Cr!==A||(or=7),mA(A)},B.then(i,i);break e;case 3:or=7;break e;case 4:or=5;break e;case 7:Wv(B)?(or=0,da=null,Ow(i)):(or=0,da=null,Nl(A,i,B,7));break;case 5:var b=null;switch(Ot.tag){case 26:b=Ot.memoizedState;case 5:case 27:var M=Ot;if(b?Sy(b):M.stateNode.complete){or=0,da=null;var te=M.sibling;if(te!==null)Ot=te;else{var ge=M.return;ge!==null?(Ot=ge,v0(ge)):Ot=null}break t}}or=0,da=null,Nl(A,i,B,5);break;case 6:or=0,da=null,Nl(A,i,B,6);break;case 8:wg(),Pr=6;break e;default:throw Error(n(462))}}XF();break}catch(Fe){Rw(A,Fe)}while(!0);return QA=mi=null,q.H=g,q.A=w,nr=c,Ot!==null?0:(Cr=null,Gt=0,Lu(),Pr)}function XF(){for(;Ot!==null&&!Er();)Hw(Ot)}function Hw(A){var i=ow(A.alternate,A,KA);A.memoizedProps=A.pendingProps,i===null?v0(A):Ot=i}function Ow(A){var i=A,c=i.alternate;switch(i.tag){case 15:case 0:i=nw(c,i,i.pendingProps,i.type,void 0,Gt);break;case 11:i=nw(c,i,i.pendingProps,i.type.render,i.ref,Gt);break;case 5:Dh(i);default:uw(c,i),i=Ot=Lv(i,KA),i=ow(c,i,KA)}A.memoizedProps=A.pendingProps,i===null?v0(A):Ot=i}function Nl(A,i,c,g){QA=mi=null,Dh(i),yl=null,Lo=0;var w=i.return;try{if(RF(A,w,i,c,Gt)){Pr=1,s0(A,Fa(c,A.current)),Ot=null;return}}catch(B){if(w!==null)throw Ot=w,B;Pr=1,s0(A,Fa(c,A.current)),Ot=null;return}i.flags&32768?(Xt||g===1?A=!0:bl||(Gt&536870912)!==0?A=!1:(Es=A=!0,(g===2||g===9||g===3||g===6)&&(g=ua.current,g!==null&&g.tag===13&&(g.flags|=16384))),Pw(i,A)):v0(i)}function v0(A){var i=A;do{if((i.flags&32768)!==0){Pw(i,Es);return}A=i.return;var c=LF(i.alternate,i,KA);if(c!==null){Ot=c;return}if(i=i.sibling,i!==null){Ot=i;return}Ot=i=A}while(i!==null);Pr===0&&(Pr=5)}function Pw(A,i){do{var c=HF(A.alternate,A);if(c!==null){c.flags&=32767,Ot=c;return}if(c=A.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(A=A.sibling,A!==null)){Ot=A;return}Ot=A=c}while(A!==null);Pr=6,Ot=null}function Gw(A,i,c,g,w,B,b,M,te){A.cancelPendingCommit=null;do w0();while(un!==0);if((nr&6)!==0)throw Error(n(327));if(i!==null){if(i===A.current)throw Error(n(177));if(B=i.lanes|i.childLanes,B|=oh,Eo(A,c,B,b,M,te),A===Cr&&(Ot=Cr=null,Gt=0),Ul=i,_s=A,jA=c,pg=B,xg=w,kw=g,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(A.callbackNode=null,A.callbackPriority=0,qF(ht,function(){return Xw(),null})):(A.callbackNode=null,A.callbackPriority=0),g=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||g){g=q.T,q.T=null,w=Ae.p,Ae.p=2,b=nr,nr|=4;try{OF(A,i,c)}finally{nr=b,Ae.p=w,q.T=g}}un=1,Vw(),Kw(),jw()}}function Vw(){if(un===1){un=0;var A=_s,i=Ul,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=q.T,q.T=null;var g=Ae.p;Ae.p=2;var w=nr;nr|=4;try{Cw(i,A);var B=Ig,b=Fv(A.containerInfo),M=B.focusedElem,te=B.selectionRange;if(b!==M&&M&&M.ownerDocument&&bv(M.ownerDocument.documentElement,M)){if(te!==null&&ah(M)){var ge=te.start,Fe=te.end;if(Fe===void 0&&(Fe=ge),"selectionStart"in M)M.selectionStart=ge,M.selectionEnd=Math.min(Fe,M.value.length);else{var ke=M.ownerDocument||document,we=ke&&ke.defaultView||window;if(we.getSelection){var Ee=we.getSelection(),nt=M.textContent.length,pt=Math.min(te.start,nt),vr=te.end===void 0?pt:Math.min(te.end,nt);!Ee.extend&&pt>vr&&(b=vr,vr=pt,pt=b);var ue=_v(M,pt),se=_v(M,vr);if(ue&&se&&(Ee.rangeCount!==1||Ee.anchorNode!==ue.node||Ee.anchorOffset!==ue.offset||Ee.focusNode!==se.node||Ee.focusOffset!==se.offset)){var he=ke.createRange();he.setStart(ue.node,ue.offset),Ee.removeAllRanges(),pt>vr?(Ee.addRange(he),Ee.extend(se.node,se.offset)):(he.setEnd(se.node,se.offset),Ee.addRange(he))}}}}for(ke=[],Ee=M;Ee=Ee.parentNode;)Ee.nodeType===1&&ke.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<ke.length;M++){var Ue=ke[M];Ue.element.scrollLeft=Ue.left,Ue.element.scrollTop=Ue.top}}N0=!!Ng,Ig=Ng=null}finally{nr=w,Ae.p=g,q.T=c}}A.current=i,un=2}}function Kw(){if(un===2){un=0;var A=_s,i=Ul,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=q.T,q.T=null;var g=Ae.p;Ae.p=2;var w=nr;nr|=4;try{xw(A,i.alternate,i)}finally{nr=w,Ae.p=g,q.T=c}}un=3}}function jw(){if(un===4||un===3){un=0,Zr();var A=_s,i=Ul,c=jA,g=kw;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?un=5:(un=0,Ul=_s=null,zw(A,A.pendingLanes));var w=A.pendingLanes;if(w===0&&(Ts=null),li(c),i=i.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Bt,i,void 0,(i.current.flags&128)===128)}catch{}if(g!==null){i=q.T,w=Ae.p,Ae.p=2,q.T=null;try{for(var B=A.onRecoverableError,b=0;b<g.length;b++){var M=g[b];B(M.value,{componentStack:M.stack})}}finally{q.T=i,Ae.p=w}}(jA&3)!==0&&w0(),mA(A),w=A.pendingLanes,(c&261930)!==0&&(w&42)!==0?A===vg?tc++:(tc=0,vg=A):tc=0,rc(0)}}function zw(A,i){(A.pooledCacheLanes&=i)===0&&(i=A.pooledCache,i!=null&&(A.pooledCache=null,Do(i)))}function w0(){return Vw(),Kw(),jw(),Xw()}function Xw(){if(un!==5)return!1;var A=_s,i=pg;pg=0;var c=li(jA),g=q.T,w=Ae.p;try{Ae.p=32>c?32:c,q.T=null,c=xg,xg=null;var B=_s,b=jA;if(un=0,Ul=_s=null,jA=0,(nr&6)!==0)throw Error(n(331));var M=nr;if(nr|=4,bw(B.current),Sw(B,B.current,b,c),nr=M,rc(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Bt,B)}catch{}return!0}finally{Ae.p=w,q.T=g,zw(A,i)}}function Jw(A,i,c){i=Fa(c,i),i=qh(A.stateNode,i,2),A=ws(A,i,2),A!==null&&(fA(A,2),mA(A))}function cr(A,i,c){if(A.tag===3)Jw(A,A,c);else for(;i!==null;){if(i.tag===3){Jw(i,A,c);break}else if(i.tag===1){var g=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ts===null||!Ts.has(g))){A=Fa(c,A),c=W1(2),g=ws(i,c,2),g!==null&&(Y1(c,g,i,A),fA(g,2),mA(g));break}}i=i.return}}function Bg(A,i,c){var g=A.pingCache;if(g===null){g=A.pingCache=new VF;var w=new Set;g.set(i,w)}else w=g.get(i),w===void 0&&(w=new Set,g.set(i,w));w.has(c)||(hg=!0,w.add(c),A=JF.bind(null,A,i,c),i.then(A,A))}function JF(A,i,c){var g=A.pingCache;g!==null&&g.delete(i),A.pingedLanes|=A.suspendedLanes&c,A.warmLanes&=~c,Cr===A&&(Gt&c)===c&&(Pr===4||Pr===3&&(Gt&62914560)===Gt&&300>dt()-h0?(nr&2)===0&&kl(A,0):gg|=c,Fl===Gt&&(Fl=0)),mA(A)}function Ww(A,i){i===0&&(i=nl()),A=di(A,i),A!==null&&(fA(A,i),mA(A))}function WF(A){var i=A.memoizedState,c=0;i!==null&&(c=i.retryLane),Ww(A,c)}function YF(A,i){var c=0;switch(A.tag){case 31:case 13:var g=A.stateNode,w=A.memoizedState;w!==null&&(c=w.retryLane);break;case 19:g=A.stateNode;break;case 22:g=A.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(i),Ww(A,c)}function qF(A,i){return lr(A,i)}var y0=null,Il=null,Cg=!1,B0=!1,Eg=!1,Fs=0;function mA(A){A!==Il&&A.next===null&&(Il===null?y0=Il=A:Il=Il.next=A),B0=!0,Cg||(Cg=!0,ZF())}function rc(A,i){if(!Eg&&B0){Eg=!0;do for(var c=!1,g=y0;g!==null;){if(A!==0){var w=g.pendingLanes;if(w===0)var B=0;else{var b=g.suspendedLanes,M=g.pingedLanes;B=(1<<31-Sr(42|A)+1)-1,B&=w&~(b&~M),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(c=!0,Zw(g,B))}else B=Gt,B=bA(g,g===Cr?B:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(B&3)===0||FA(g,B)||(c=!0,Zw(g,B));g=g.next}while(c);Eg=!1}}function $F(){Yw()}function Yw(){B0=Cg=!1;var A=0;Fs!==0&&oU()&&(A=Fs);for(var i=dt(),c=null,g=y0;g!==null;){var w=g.next,B=qw(g,i);B===0?(g.next=null,c===null?y0=w:c.next=w,w===null&&(Il=c)):(c=g,(A!==0||(B&3)!==0)&&(B0=!0)),g=w}un!==0&&un!==5||rc(A),Fs!==0&&(Fs=0)}function qw(A,i){for(var c=A.suspendedLanes,g=A.pingedLanes,w=A.expirationTimes,B=A.pendingLanes&-62914561;0<B;){var b=31-Sr(B),M=1<<b,te=w[b];te===-1?((M&c)===0||(M&g)!==0)&&(w[b]=rl(M,i)):te<=i&&(A.expiredLanes|=M),B&=~M}if(i=Cr,c=Gt,c=bA(A,A===i?c:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),g=A.callbackNode,c===0||A===i&&(or===2||or===9)||A.cancelPendingCommit!==null)return g!==null&&g!==null&&Jt(g),A.callbackNode=null,A.callbackPriority=0;if((c&3)===0||FA(A,c)){if(i=c&-c,i===A.callbackPriority)return i;switch(g!==null&&Jt(g),li(c)){case 2:case 8:c=bt;break;case 32:c=ht;break;case 268435456:c=$e;break;default:c=ht}return g=$w.bind(null,A),c=lr(c,g),A.callbackPriority=i,A.callbackNode=c,i}return g!==null&&g!==null&&Jt(g),A.callbackPriority=2,A.callbackNode=null,2}function $w(A,i){if(un!==0&&un!==5)return A.callbackNode=null,A.callbackPriority=0,null;var c=A.callbackNode;if(w0()&&A.callbackNode!==c)return null;var g=Gt;return g=bA(A,A===Cr?g:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),g===0?null:(Iw(A,g,i),qw(A,dt()),A.callbackNode!=null&&A.callbackNode===c?$w.bind(null,A):null)}function Zw(A,i){if(w0())return null;Iw(A,i,!0)}function ZF(){uU(function(){(nr&6)!==0?lr(je,$F):Yw()})}function Sg(){if(Fs===0){var A=xl;A===0&&(A=gt,gt<<=1,(gt&261888)===0&&(gt=256)),Fs=A}return Fs}function ey(A){return A==null||typeof A=="symbol"||typeof A=="boolean"?null:typeof A=="function"?A:sl(""+A)}function ty(A,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,A.id&&c.setAttribute("form",A.id),i.parentNode.insertBefore(c,i),A=new FormData(A),c.parentNode.removeChild(c),A}function eU(A,i,c,g,w){if(i==="submit"&&c&&c.stateNode===w){var B=ey((w[G]||null).action),b=g.submitter;b&&(i=(i=b[G]||null)?ey(i.formAction):b.getAttribute("formAction"),i!==null&&(B=i,b=null));var M=new Qu("action","action",null,g,w);A.push({event:M,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Fs!==0){var te=b?ty(w,b):new FormData(w);jh(c,{pending:!0,data:te,method:w.method,action:B},null,te)}}else typeof B=="function"&&(M.preventDefault(),te=b?ty(w,b):new FormData(w),jh(c,{pending:!0,data:te,method:w.method,action:B},B,te))},currentTarget:w}]})}}for(var Tg=0;Tg<lh.length;Tg++){var _g=lh[Tg],tU=_g.toLowerCase(),rU=_g[0].toUpperCase()+_g.slice(1);Za(tU,"on"+rU)}Za(Nv,"onAnimationEnd"),Za(Iv,"onAnimationIteration"),Za(Qv,"onAnimationStart"),Za("dblclick","onDoubleClick"),Za("focusin","onFocus"),Za("focusout","onBlur"),Za(xF,"onTransitionRun"),Za(vF,"onTransitionStart"),Za(wF,"onTransitionCancel"),Za(Rv,"onTransitionEnd"),kn("onMouseEnter",["mouseout","mouseover"]),kn("onMouseLeave",["mouseout","mouseover"]),kn("onPointerEnter",["pointerout","pointerover"]),kn("onPointerLeave",["pointerout","pointerover"]),gr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gr("onBeforeInput",["compositionend","keypress","textInput","paste"]),gr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nU=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nc));function ry(A,i){i=(i&4)!==0;for(var c=0;c<A.length;c++){var g=A[c],w=g.event;g=g.listeners;e:{var B=void 0;if(i)for(var b=g.length-1;0<=b;b--){var M=g[b],te=M.instance,ge=M.currentTarget;if(M=M.listener,te!==B&&w.isPropagationStopped())break e;B=M,w.currentTarget=ge;try{B(w)}catch(Fe){Mu(Fe)}w.currentTarget=null,B=te}else for(b=0;b<g.length;b++){if(M=g[b],te=M.instance,ge=M.currentTarget,M=M.listener,te!==B&&w.isPropagationStopped())break e;B=M,w.currentTarget=ge;try{B(w)}catch(Fe){Mu(Fe)}w.currentTarget=null,B=te}}}}function Pt(A,i){var c=i[me];c===void 0&&(c=i[me]=new Set);var g=A+"__bubble";c.has(g)||(ny(i,A,2,!1),c.add(g))}function bg(A,i,c){var g=0;i&&(g|=4),ny(c,A,g,i)}var C0="_reactListening"+Math.random().toString(36).slice(2);function Fg(A){if(!A[C0]){A[C0]=!0,hr.forEach(function(c){c!=="selectionchange"&&(nU.has(c)||bg(c,!1,A),bg(c,!0,A))});var i=A.nodeType===9?A:A.ownerDocument;i===null||i[C0]||(i[C0]=!0,bg("selectionchange",!1,i))}}function ny(A,i,c,g){switch(Ny(i)){case 2:var w=kU;break;case 8:w=NU;break;default:w=Kg}c=w.bind(null,i,c,A),w=void 0,!Wd||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(w=!0),g?w!==void 0?A.addEventListener(i,c,{capture:!0,passive:w}):A.addEventListener(i,c,!0):w!==void 0?A.addEventListener(i,c,{passive:w}):A.addEventListener(i,c,!1)}function Ug(A,i,c,g,w){var B=g;if((i&1)===0&&(i&2)===0&&g!==null)e:for(;;){if(g===null)return;var b=g.tag;if(b===3||b===4){var M=g.stateNode.containerInfo;if(M===w)break;if(b===4)for(b=g.return;b!==null;){var te=b.tag;if((te===3||te===4)&&b.stateNode.containerInfo===w)return;b=b.return}for(;M!==null;){if(b=Ge(M),b===null)return;if(te=b.tag,te===5||te===6||te===26||te===27){g=B=b;continue e}M=M.parentNode}}g=g.return}lv(function(){var ge=B,Fe=Xd(c),ke=[];e:{var we=Dv.get(A);if(we!==void 0){var Ee=Qu,nt=A;switch(A){case"keypress":if(Nu(c)===0)break e;case"keydown":case"keyup":Ee=Y4;break;case"focusin":nt="focus",Ee=Zd;break;case"focusout":nt="blur",Ee=Zd;break;case"beforeblur":case"afterblur":Ee=Zd;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=uv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=L4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=Z4;break;case Nv:case Iv:case Qv:Ee=P4;break;case Rv:Ee=tF;break;case"scroll":case"scrollend":Ee=D4;break;case"wheel":Ee=nF;break;case"copy":case"cut":case"paste":Ee=V4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=dv;break;case"toggle":case"beforetoggle":Ee=AF}var pt=(i&4)!==0,vr=!pt&&(A==="scroll"||A==="scrollend"),ue=pt?we!==null?we+"Capture":null:we;pt=[];for(var se=ge,he;se!==null;){var Ue=se;if(he=Ue.stateNode,Ue=Ue.tag,Ue!==5&&Ue!==26&&Ue!==27||he===null||ue===null||(Ue=So(se,ue),Ue!=null&&pt.push(ac(se,Ue,he))),vr)break;se=se.return}0<pt.length&&(we=new Ee(we,nt,null,c,Fe),ke.push({event:we,listeners:pt}))}}if((i&7)===0){e:{if(we=A==="mouseover"||A==="pointerover",Ee=A==="mouseout"||A==="pointerout",we&&c!==zd&&(nt=c.relatedTarget||c.fromElement)&&(Ge(nt)||nt[W]))break e;if((Ee||we)&&(we=Fe.window===Fe?Fe:(we=Fe.ownerDocument)?we.defaultView||we.parentWindow:window,Ee?(nt=c.relatedTarget||c.toElement,Ee=ge,nt=nt?Ge(nt):null,nt!==null&&(vr=s(nt),pt=nt.tag,nt!==vr||pt!==5&&pt!==27&&pt!==6)&&(nt=null)):(Ee=null,nt=ge),Ee!==nt)){if(pt=uv,Ue="onMouseLeave",ue="onMouseEnter",se="mouse",(A==="pointerout"||A==="pointerover")&&(pt=dv,Ue="onPointerLeave",ue="onPointerEnter",se="pointer"),vr=Ee==null?we:Oe(Ee),he=nt==null?we:Oe(nt),we=new pt(Ue,se+"leave",Ee,c,Fe),we.target=vr,we.relatedTarget=he,Ue=null,Ge(Fe)===ge&&(pt=new pt(ue,se+"enter",nt,c,Fe),pt.target=he,pt.relatedTarget=vr,Ue=pt),vr=Ue,Ee&&nt)t:{for(pt=aU,ue=Ee,se=nt,he=0,Ue=ue;Ue;Ue=pt(Ue))he++;Ue=0;for(var ct=se;ct;ct=pt(ct))Ue++;for(;0<he-Ue;)ue=pt(ue),he--;for(;0<Ue-he;)se=pt(se),Ue--;for(;he--;){if(ue===se||se!==null&&ue===se.alternate){pt=ue;break t}ue=pt(ue),se=pt(se)}pt=null}else pt=null;Ee!==null&&ay(ke,we,Ee,pt,!1),nt!==null&&vr!==null&&ay(ke,vr,nt,pt,!0)}}e:{if(we=ge?Oe(ge):window,Ee=we.nodeName&&we.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&we.type==="file")var $t=yv;else if(vv(we))if(Bv)$t=gF;else{$t=dF;var st=fF}else Ee=we.nodeName,!Ee||Ee.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?ge&&Ct(ge.elementType)&&($t=yv):$t=hF;if($t&&($t=$t(A,ge))){wv(ke,$t,c,Fe);break e}st&&st(A,we,ge),A==="focusout"&&ge&&we.type==="number"&&ge.memoizedProps.value!=null&&Ht(we,"number",we.value)}switch(st=ge?Oe(ge):window,A){case"focusin":(vv(st)||st.contentEditable==="true")&&(cl=st,Ah=ge,Io=null);break;case"focusout":Io=Ah=cl=null;break;case"mousedown":sh=!0;break;case"contextmenu":case"mouseup":case"dragend":sh=!1,Uv(ke,c,Fe);break;case"selectionchange":if(pF)break;case"keydown":case"keyup":Uv(ke,c,Fe)}var Qt;if(th)e:{switch(A){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else ol?pv(A,c)&&(Vt="onCompositionEnd"):A==="keydown"&&c.keyCode===229&&(Vt="onCompositionStart");Vt&&(hv&&c.locale!=="ko"&&(ol||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&ol&&(Qt=ov()):(ds=Fe,Yd="value"in ds?ds.value:ds.textContent,ol=!0)),st=E0(ge,Vt),0<st.length&&(Vt=new fv(Vt,A,null,c,Fe),ke.push({event:Vt,listeners:st}),Qt?Vt.data=Qt:(Qt=xv(c),Qt!==null&&(Vt.data=Qt)))),(Qt=iF?lF(A,c):oF(A,c))&&(Vt=E0(ge,"onBeforeInput"),0<Vt.length&&(st=new fv("onBeforeInput","beforeinput",null,c,Fe),ke.push({event:st,listeners:Vt}),st.data=Qt)),eU(ke,A,ge,c,Fe)}ry(ke,i)})}function ac(A,i,c){return{instance:A,listener:i,currentTarget:c}}function E0(A,i){for(var c=i+"Capture",g=[];A!==null;){var w=A,B=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||B===null||(w=So(A,c),w!=null&&g.unshift(ac(A,w,B)),w=So(A,i),w!=null&&g.push(ac(A,w,B))),A.tag===3)return g;A=A.return}return[]}function aU(A){if(A===null)return null;do A=A.return;while(A&&A.tag!==5&&A.tag!==27);return A||null}function ay(A,i,c,g,w){for(var B=i._reactName,b=[];c!==null&&c!==g;){var M=c,te=M.alternate,ge=M.stateNode;if(M=M.tag,te!==null&&te===g)break;M!==5&&M!==26&&M!==27||ge===null||(te=ge,w?(ge=So(c,B),ge!=null&&b.unshift(ac(c,ge,te))):w||(ge=So(c,B),ge!=null&&b.push(ac(c,ge,te)))),c=c.return}b.length!==0&&A.push({event:i,listeners:b})}var AU=/\r\n?/g,sU=/\u0000|\uFFFD/g;function Ay(A){return(typeof A=="string"?A:""+A).replace(AU,`
`).replace(sU,"")}function sy(A,i){return i=Ay(i),Ay(A)===i}function xr(A,i,c,g,w,B){switch(c){case"children":typeof g=="string"?i==="body"||i==="textarea"&&g===""||mt(A,g):(typeof g=="number"||typeof g=="bigint")&&i!=="body"&&mt(A,""+g);break;case"className":oi(A,"class",g);break;case"tabIndex":oi(A,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":oi(A,c,g);break;case"style":rr(A,g,B);break;case"data":if(i!=="object"){oi(A,"data",g);break}case"src":case"href":if(g===""&&(i!=="a"||c!=="href")){A.removeAttribute(c);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){A.removeAttribute(c);break}g=sl(""+g),A.setAttribute(c,g);break;case"action":case"formAction":if(typeof g=="function"){A.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof B=="function"&&(c==="formAction"?(i!=="input"&&xr(A,i,"name",w.name,w,null),xr(A,i,"formEncType",w.formEncType,w,null),xr(A,i,"formMethod",w.formMethod,w,null),xr(A,i,"formTarget",w.formTarget,w,null)):(xr(A,i,"encType",w.encType,w,null),xr(A,i,"method",w.method,w,null),xr(A,i,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){A.removeAttribute(c);break}g=sl(""+g),A.setAttribute(c,g);break;case"onClick":g!=null&&(A.onclick=UA);break;case"onScroll":g!=null&&Pt("scroll",A);break;case"onScrollEnd":g!=null&&Pt("scrollend",A);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(c=g.__html,c!=null){if(w.children!=null)throw Error(n(60));A.innerHTML=c}}break;case"multiple":A.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":A.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){A.removeAttribute("xlink:href");break}c=sl(""+g),A.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?A.setAttribute(c,""+g):A.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?A.setAttribute(c,""):A.removeAttribute(c);break;case"capture":case"download":g===!0?A.setAttribute(c,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?A.setAttribute(c,g):A.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?A.setAttribute(c,g):A.removeAttribute(c);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?A.removeAttribute(c):A.setAttribute(c,g);break;case"popover":Pt("beforetoggle",A),Pt("toggle",A),yn(A,"popover",g);break;case"xlinkActuate":_a(A,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":_a(A,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":_a(A,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":_a(A,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":_a(A,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":_a(A,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":_a(A,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":_a(A,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":_a(A,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":yn(A,"is",g);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Fu.get(c)||c,yn(A,c,g))}}function kg(A,i,c,g,w,B){switch(c){case"style":rr(A,g,B);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(c=g.__html,c!=null){if(w.children!=null)throw Error(n(60));A.innerHTML=c}}break;case"children":typeof g=="string"?mt(A,g):(typeof g=="number"||typeof g=="bigint")&&mt(A,""+g);break;case"onScroll":g!=null&&Pt("scroll",A);break;case"onScrollEnd":g!=null&&Pt("scrollend",A);break;case"onClick":g!=null&&(A.onclick=UA);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(w=c.endsWith("Capture"),i=c.slice(2,w?c.length-7:void 0),B=A[G]||null,B=B!=null?B[c]:null,typeof B=="function"&&A.removeEventListener(i,B,w),typeof g=="function")){typeof B!="function"&&B!==null&&(c in A?A[c]=null:A.hasAttribute(c)&&A.removeAttribute(c)),A.addEventListener(i,g,w);break e}c in A?A[c]=g:g===!0?A.setAttribute(c,""):yn(A,c,g)}}}function Sn(A,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pt("error",A),Pt("load",A);var g=!1,w=!1,B;for(B in c)if(c.hasOwnProperty(B)){var b=c[B];if(b!=null)switch(B){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:xr(A,i,B,b,c,null)}}w&&xr(A,i,"srcSet",c.srcSet,c,null),g&&xr(A,i,"src",c.src,c,null);return;case"input":Pt("invalid",A);var M=B=b=w=null,te=null,ge=null;for(g in c)if(c.hasOwnProperty(g)){var Fe=c[g];if(Fe!=null)switch(g){case"name":w=Fe;break;case"type":b=Fe;break;case"checked":te=Fe;break;case"defaultChecked":ge=Fe;break;case"value":B=Fe;break;case"defaultValue":M=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(n(137,i));break;default:xr(A,i,g,Fe,c,null)}}mr(A,B,M,te,ge,b,w,!1);return;case"select":Pt("invalid",A),g=b=B=null;for(w in c)if(c.hasOwnProperty(w)&&(M=c[w],M!=null))switch(w){case"value":B=M;break;case"defaultValue":b=M;break;case"multiple":g=M;default:xr(A,i,w,M,c,null)}i=B,c=b,A.multiple=!!g,i!=null?It(A,!!g,i,!1):c!=null&&It(A,!!g,c,!0);return;case"textarea":Pt("invalid",A),B=w=g=null;for(b in c)if(c.hasOwnProperty(b)&&(M=c[b],M!=null))switch(b){case"value":g=M;break;case"defaultValue":w=M;break;case"children":B=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(n(91));break;default:xr(A,i,b,M,c,null)}Tr(A,g,w,B);return;case"option":for(te in c)if(c.hasOwnProperty(te)&&(g=c[te],g!=null))switch(te){case"selected":A.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:xr(A,i,te,g,c,null)}return;case"dialog":Pt("beforetoggle",A),Pt("toggle",A),Pt("cancel",A),Pt("close",A);break;case"iframe":case"object":Pt("load",A);break;case"video":case"audio":for(g=0;g<nc.length;g++)Pt(nc[g],A);break;case"image":Pt("error",A),Pt("load",A);break;case"details":Pt("toggle",A);break;case"embed":case"source":case"link":Pt("error",A),Pt("load",A);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ge in c)if(c.hasOwnProperty(ge)&&(g=c[ge],g!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:xr(A,i,ge,g,c,null)}return;default:if(Ct(i)){for(Fe in c)c.hasOwnProperty(Fe)&&(g=c[Fe],g!==void 0&&kg(A,i,Fe,g,c,void 0));return}}for(M in c)c.hasOwnProperty(M)&&(g=c[M],g!=null&&xr(A,i,M,g,c,null))}function iU(A,i,c,g){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,B=null,b=null,M=null,te=null,ge=null,Fe=null;for(Ee in c){var ke=c[Ee];if(c.hasOwnProperty(Ee)&&ke!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":te=ke;default:g.hasOwnProperty(Ee)||xr(A,i,Ee,null,g,ke)}}for(var we in g){var Ee=g[we];if(ke=c[we],g.hasOwnProperty(we)&&(Ee!=null||ke!=null))switch(we){case"type":B=Ee;break;case"name":w=Ee;break;case"checked":ge=Ee;break;case"defaultChecked":Fe=Ee;break;case"value":b=Ee;break;case"defaultValue":M=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,i));break;default:Ee!==ke&&xr(A,i,we,Ee,g,ke)}}zt(A,b,M,te,ge,Fe,B,w);return;case"select":Ee=b=M=we=null;for(B in c)if(te=c[B],c.hasOwnProperty(B)&&te!=null)switch(B){case"value":break;case"multiple":Ee=te;default:g.hasOwnProperty(B)||xr(A,i,B,null,g,te)}for(w in g)if(B=g[w],te=c[w],g.hasOwnProperty(w)&&(B!=null||te!=null))switch(w){case"value":we=B;break;case"defaultValue":M=B;break;case"multiple":b=B;default:B!==te&&xr(A,i,w,B,g,te)}i=M,c=b,g=Ee,we!=null?It(A,!!c,we,!1):!!g!=!!c&&(i!=null?It(A,!!c,i,!0):It(A,!!c,c?[]:"",!1));return;case"textarea":Ee=we=null;for(M in c)if(w=c[M],c.hasOwnProperty(M)&&w!=null&&!g.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:xr(A,i,M,null,g,w)}for(b in g)if(w=g[b],B=c[b],g.hasOwnProperty(b)&&(w!=null||B!=null))switch(b){case"value":we=w;break;case"defaultValue":Ee=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==B&&xr(A,i,b,w,g,B)}en(A,we,Ee);return;case"option":for(var nt in c)if(we=c[nt],c.hasOwnProperty(nt)&&we!=null&&!g.hasOwnProperty(nt))switch(nt){case"selected":A.selected=!1;break;default:xr(A,i,nt,null,g,we)}for(te in g)if(we=g[te],Ee=c[te],g.hasOwnProperty(te)&&we!==Ee&&(we!=null||Ee!=null))switch(te){case"selected":A.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:xr(A,i,te,we,g,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in c)we=c[pt],c.hasOwnProperty(pt)&&we!=null&&!g.hasOwnProperty(pt)&&xr(A,i,pt,null,g,we);for(ge in g)if(we=g[ge],Ee=c[ge],g.hasOwnProperty(ge)&&we!==Ee&&(we!=null||Ee!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,i));break;default:xr(A,i,ge,we,g,Ee)}return;default:if(Ct(i)){for(var vr in c)we=c[vr],c.hasOwnProperty(vr)&&we!==void 0&&!g.hasOwnProperty(vr)&&kg(A,i,vr,void 0,g,we);for(Fe in g)we=g[Fe],Ee=c[Fe],!g.hasOwnProperty(Fe)||we===Ee||we===void 0&&Ee===void 0||kg(A,i,Fe,we,g,Ee);return}}for(var ue in c)we=c[ue],c.hasOwnProperty(ue)&&we!=null&&!g.hasOwnProperty(ue)&&xr(A,i,ue,null,g,we);for(ke in g)we=g[ke],Ee=c[ke],!g.hasOwnProperty(ke)||we===Ee||we==null&&Ee==null||xr(A,i,ke,we,g,Ee)}function iy(A){switch(A){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function lU(){if(typeof performance.getEntriesByType=="function"){for(var A=0,i=0,c=performance.getEntriesByType("resource"),g=0;g<c.length;g++){var w=c[g],B=w.transferSize,b=w.initiatorType,M=w.duration;if(B&&M&&iy(b)){for(b=0,M=w.responseEnd,g+=1;g<c.length;g++){var te=c[g],ge=te.startTime;if(ge>M)break;var Fe=te.transferSize,ke=te.initiatorType;Fe&&iy(ke)&&(te=te.responseEnd,b+=Fe*(te<M?1:(M-ge)/(te-ge)))}if(--g,i+=8*(B+b)/(w.duration/1e3),A++,10<A)break}}if(0<A)return i/A/1e6}return navigator.connection&&(A=navigator.connection.downlink,typeof A=="number")?A:5}var Ng=null,Ig=null;function S0(A){return A.nodeType===9?A:A.ownerDocument}function ly(A){switch(A){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function oy(A,i){if(A===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return A===1&&i==="foreignObject"?0:A}function Qg(A,i){return A==="textarea"||A==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Rg=null;function oU(){var A=window.event;return A&&A.type==="popstate"?A===Rg?!1:(Rg=A,!0):(Rg=null,!1)}var cy=typeof setTimeout=="function"?setTimeout:void 0,cU=typeof clearTimeout=="function"?clearTimeout:void 0,uy=typeof Promise=="function"?Promise:void 0,uU=typeof queueMicrotask=="function"?queueMicrotask:typeof uy<"u"?function(A){return uy.resolve(null).then(A).catch(fU)}:cy;function fU(A){setTimeout(function(){throw A})}function Us(A){return A==="head"}function fy(A,i){var c=i,g=0;do{var w=c.nextSibling;if(A.removeChild(c),w&&w.nodeType===8)if(c=w.data,c==="/$"||c==="/&"){if(g===0){A.removeChild(w),Ml(i);return}g--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")g++;else if(c==="html")Ac(A.ownerDocument.documentElement);else if(c==="head"){c=A.ownerDocument.head,Ac(c);for(var B=c.firstChild;B;){var b=B.nextSibling,M=B.nodeName;B[ve]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&B.rel.toLowerCase()==="stylesheet"||c.removeChild(B),B=b}}else c==="body"&&Ac(A.ownerDocument.body);c=w}while(c);Ml(i)}function dy(A,i){var c=A;A=0;do{var g=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(A===0)break;A--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||A++;c=g}while(c)}function Dg(A){var i=A.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Dg(c),Le(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}A.removeChild(c)}}function dU(A,i,c,g){for(;A.nodeType===1;){var w=c;if(A.nodeName.toLowerCase()!==i.toLowerCase()){if(!g&&(A.nodeName!=="INPUT"||A.type!=="hidden"))break}else if(g){if(!A[ve])switch(i){case"meta":if(!A.hasAttribute("itemprop"))break;return A;case"link":if(B=A.getAttribute("rel"),B==="stylesheet"&&A.hasAttribute("data-precedence"))break;if(B!==w.rel||A.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||A.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||A.getAttribute("title")!==(w.title==null?null:w.title))break;return A;case"style":if(A.hasAttribute("data-precedence"))break;return A;case"script":if(B=A.getAttribute("src"),(B!==(w.src==null?null:w.src)||A.getAttribute("type")!==(w.type==null?null:w.type)||A.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&B&&A.hasAttribute("async")&&!A.hasAttribute("itemprop"))break;return A;default:return A}}else if(i==="input"&&A.type==="hidden"){var B=w.name==null?null:""+w.name;if(w.type==="hidden"&&A.getAttribute("name")===B)return A}else return A;if(A=Qa(A.nextSibling),A===null)break}return null}function hU(A,i,c){if(i==="")return null;for(;A.nodeType!==3;)if((A.nodeType!==1||A.nodeName!=="INPUT"||A.type!=="hidden")&&!c||(A=Qa(A.nextSibling),A===null))return null;return A}function hy(A,i){for(;A.nodeType!==8;)if((A.nodeType!==1||A.nodeName!=="INPUT"||A.type!=="hidden")&&!i||(A=Qa(A.nextSibling),A===null))return null;return A}function Mg(A){return A.data==="$?"||A.data==="$~"}function Lg(A){return A.data==="$!"||A.data==="$?"&&A.ownerDocument.readyState!=="loading"}function gU(A,i){var c=A.ownerDocument;if(A.data==="$~")A._reactRetry=i;else if(A.data!=="$?"||c.readyState!=="loading")i();else{var g=function(){i(),c.removeEventListener("DOMContentLoaded",g)};c.addEventListener("DOMContentLoaded",g),A._reactRetry=g}}function Qa(A){for(;A!=null;A=A.nextSibling){var i=A.nodeType;if(i===1||i===3)break;if(i===8){if(i=A.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return A}var Hg=null;function gy(A){A=A.nextSibling;for(var i=0;A;){if(A.nodeType===8){var c=A.data;if(c==="/$"||c==="/&"){if(i===0)return Qa(A.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}A=A.nextSibling}return null}function my(A){A=A.previousSibling;for(var i=0;A;){if(A.nodeType===8){var c=A.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return A;i--}else c!=="/$"&&c!=="/&"||i++}A=A.previousSibling}return null}function py(A,i,c){switch(i=S0(c),A){case"html":if(A=i.documentElement,!A)throw Error(n(452));return A;case"head":if(A=i.head,!A)throw Error(n(453));return A;case"body":if(A=i.body,!A)throw Error(n(454));return A;default:throw Error(n(451))}}function Ac(A){for(var i=A.attributes;i.length;)A.removeAttributeNode(i[0]);Le(A)}var Ra=new Map,xy=new Set;function T0(A){return typeof A.getRootNode=="function"?A.getRootNode():A.nodeType===9?A:A.ownerDocument}var zA=Ae.d;Ae.d={f:mU,r:pU,D:xU,C:vU,L:wU,m:yU,X:CU,S:BU,M:EU};function mU(){var A=zA.f(),i=p0();return A||i}function pU(A){var i=We(A);i!==null&&i.tag===5&&i.type==="form"?R1(i):zA.r(A)}var Ql=typeof document>"u"?null:document;function vy(A,i,c){var g=Ql;if(g&&typeof i=="string"&&i){var w=lt(i);w='link[rel="'+A+'"][href="'+w+'"]',typeof c=="string"&&(w+='[crossorigin="'+c+'"]'),xy.has(w)||(xy.add(w),A={rel:A,crossOrigin:c,href:i},g.querySelector(w)===null&&(i=g.createElement("link"),Sn(i,"link",A),at(i),g.head.appendChild(i)))}}function xU(A){zA.D(A),vy("dns-prefetch",A,null)}function vU(A,i){zA.C(A,i),vy("preconnect",A,i)}function wU(A,i,c){zA.L(A,i,c);var g=Ql;if(g&&A&&i){var w='link[rel="preload"][as="'+lt(i)+'"]';i==="image"&&c&&c.imageSrcSet?(w+='[imagesrcset="'+lt(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(w+='[imagesizes="'+lt(c.imageSizes)+'"]')):w+='[href="'+lt(A)+'"]';var B=w;switch(i){case"style":B=Rl(A);break;case"script":B=Dl(A)}Ra.has(B)||(A=m({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:A,as:i},c),Ra.set(B,A),g.querySelector(w)!==null||i==="style"&&g.querySelector(sc(B))||i==="script"&&g.querySelector(ic(B))||(i=g.createElement("link"),Sn(i,"link",A),at(i),g.head.appendChild(i)))}}function yU(A,i){zA.m(A,i);var c=Ql;if(c&&A){var g=i&&typeof i.as=="string"?i.as:"script",w='link[rel="modulepreload"][as="'+lt(g)+'"][href="'+lt(A)+'"]',B=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":B=Dl(A)}if(!Ra.has(B)&&(A=m({rel:"modulepreload",href:A},i),Ra.set(B,A),c.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ic(B)))return}g=c.createElement("link"),Sn(g,"link",A),at(g),c.head.appendChild(g)}}}function BU(A,i,c){zA.S(A,i,c);var g=Ql;if(g&&A){var w=Je(g).hoistableStyles,B=Rl(A);i=i||"default";var b=w.get(B);if(!b){var M={loading:0,preload:null};if(b=g.querySelector(sc(B)))M.loading=5;else{A=m({rel:"stylesheet",href:A,"data-precedence":i},c),(c=Ra.get(B))&&Og(A,c);var te=b=g.createElement("link");at(te),Sn(te,"link",A),te._p=new Promise(function(ge,Fe){te.onload=ge,te.onerror=Fe}),te.addEventListener("load",function(){M.loading|=1}),te.addEventListener("error",function(){M.loading|=2}),M.loading|=4,_0(b,i,g)}b={type:"stylesheet",instance:b,count:1,state:M},w.set(B,b)}}}function CU(A,i){zA.X(A,i);var c=Ql;if(c&&A){var g=Je(c).hoistableScripts,w=Dl(A),B=g.get(w);B||(B=c.querySelector(ic(w)),B||(A=m({src:A,async:!0},i),(i=Ra.get(w))&&Pg(A,i),B=c.createElement("script"),at(B),Sn(B,"link",A),c.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},g.set(w,B))}}function EU(A,i){zA.M(A,i);var c=Ql;if(c&&A){var g=Je(c).hoistableScripts,w=Dl(A),B=g.get(w);B||(B=c.querySelector(ic(w)),B||(A=m({src:A,async:!0,type:"module"},i),(i=Ra.get(w))&&Pg(A,i),B=c.createElement("script"),at(B),Sn(B,"link",A),c.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},g.set(w,B))}}function wy(A,i,c,g){var w=(w=le.current)?T0(w):null;if(!w)throw Error(n(446));switch(A){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Rl(c.href),c=Je(w).hoistableStyles,g=c.get(i),g||(g={type:"style",instance:null,count:0,state:null},c.set(i,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){A=Rl(c.href);var B=Je(w).hoistableStyles,b=B.get(A);if(b||(w=w.ownerDocument||w,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},B.set(A,b),(B=w.querySelector(sc(A)))&&!B._p&&(b.instance=B,b.state.loading=5),Ra.has(A)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ra.set(A,c),B||SU(w,A,c,b.state))),i&&g===null)throw Error(n(528,""));return b}if(i&&g!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Dl(c),c=Je(w).hoistableScripts,g=c.get(i),g||(g={type:"script",instance:null,count:0,state:null},c.set(i,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,A))}}function Rl(A){return'href="'+lt(A)+'"'}function sc(A){return'link[rel="stylesheet"]['+A+"]"}function yy(A){return m({},A,{"data-precedence":A.precedence,precedence:null})}function SU(A,i,c,g){A.querySelector('link[rel="preload"][as="style"]['+i+"]")?g.loading=1:(i=A.createElement("link"),g.preload=i,i.addEventListener("load",function(){return g.loading|=1}),i.addEventListener("error",function(){return g.loading|=2}),Sn(i,"link",c),at(i),A.head.appendChild(i))}function Dl(A){return'[src="'+lt(A)+'"]'}function ic(A){return"script[async]"+A}function By(A,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var g=A.querySelector('style[data-href~="'+lt(c.href)+'"]');if(g)return i.instance=g,at(g),g;var w=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return g=(A.ownerDocument||A).createElement("style"),at(g),Sn(g,"style",w),_0(g,c.precedence,A),i.instance=g;case"stylesheet":w=Rl(c.href);var B=A.querySelector(sc(w));if(B)return i.state.loading|=4,i.instance=B,at(B),B;g=yy(c),(w=Ra.get(w))&&Og(g,w),B=(A.ownerDocument||A).createElement("link"),at(B);var b=B;return b._p=new Promise(function(M,te){b.onload=M,b.onerror=te}),Sn(B,"link",g),i.state.loading|=4,_0(B,c.precedence,A),i.instance=B;case"script":return B=Dl(c.src),(w=A.querySelector(ic(B)))?(i.instance=w,at(w),w):(g=c,(w=Ra.get(B))&&(g=m({},c),Pg(g,w)),A=A.ownerDocument||A,w=A.createElement("script"),at(w),Sn(w,"link",g),A.head.appendChild(w),i.instance=w);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(g=i.instance,i.state.loading|=4,_0(g,c.precedence,A));return i.instance}function _0(A,i,c){for(var g=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,B=w,b=0;b<g.length;b++){var M=g[b];if(M.dataset.precedence===i)B=M;else if(B!==w)break}B?B.parentNode.insertBefore(A,B.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(A,i.firstChild))}function Og(A,i){A.crossOrigin==null&&(A.crossOrigin=i.crossOrigin),A.referrerPolicy==null&&(A.referrerPolicy=i.referrerPolicy),A.title==null&&(A.title=i.title)}function Pg(A,i){A.crossOrigin==null&&(A.crossOrigin=i.crossOrigin),A.referrerPolicy==null&&(A.referrerPolicy=i.referrerPolicy),A.integrity==null&&(A.integrity=i.integrity)}var b0=null;function Cy(A,i,c){if(b0===null){var g=new Map,w=b0=new Map;w.set(c,g)}else w=b0,g=w.get(c),g||(g=new Map,w.set(c,g));if(g.has(A))return g;for(g.set(A,null),c=c.getElementsByTagName(A),w=0;w<c.length;w++){var B=c[w];if(!(B[ve]||B[O]||A==="link"&&B.getAttribute("rel")==="stylesheet")&&B.namespaceURI!=="http://www.w3.org/2000/svg"){var b=B.getAttribute(i)||"";b=A+b;var M=g.get(b);M?M.push(B):g.set(b,[B])}}return g}function Ey(A,i,c){A=A.ownerDocument||A,A.head.insertBefore(c,i==="title"?A.querySelector("head > title"):null)}function TU(A,i,c){if(c===1||i.itemProp!=null)return!1;switch(A){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return A=i.disabled,typeof i.precedence=="string"&&A==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Sy(A){return!(A.type==="stylesheet"&&(A.state.loading&3)===0)}function _U(A,i,c,g){if(c.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=Rl(g.href),B=i.querySelector(sc(w));if(B){i=B._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(A.count++,A=F0.bind(A),i.then(A,A)),c.state.loading|=4,c.instance=B,at(B);return}B=i.ownerDocument||i,g=yy(g),(w=Ra.get(w))&&Og(g,w),B=B.createElement("link"),at(B);var b=B;b._p=new Promise(function(M,te){b.onload=M,b.onerror=te}),Sn(B,"link",g),c.instance=B}A.stylesheets===null&&(A.stylesheets=new Map),A.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(A.count++,c=F0.bind(A),i.addEventListener("load",c),i.addEventListener("error",c))}}var Gg=0;function bU(A,i){return A.stylesheets&&A.count===0&&k0(A,A.stylesheets),0<A.count||0<A.imgCount?function(c){var g=setTimeout(function(){if(A.stylesheets&&k0(A,A.stylesheets),A.unsuspend){var B=A.unsuspend;A.unsuspend=null,B()}},6e4+i);0<A.imgBytes&&Gg===0&&(Gg=62500*lU());var w=setTimeout(function(){if(A.waitingForImages=!1,A.count===0&&(A.stylesheets&&k0(A,A.stylesheets),A.unsuspend)){var B=A.unsuspend;A.unsuspend=null,B()}},(A.imgBytes>Gg?50:800)+i);return A.unsuspend=c,function(){A.unsuspend=null,clearTimeout(g),clearTimeout(w)}}:null}function F0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)k0(this,this.stylesheets);else if(this.unsuspend){var A=this.unsuspend;this.unsuspend=null,A()}}}var U0=null;function k0(A,i){A.stylesheets=null,A.unsuspend!==null&&(A.count++,U0=new Map,i.forEach(FU,A),U0=null,F0.call(A))}function FU(A,i){if(!(i.state.loading&4)){var c=U0.get(A);if(c)var g=c.get(null);else{c=new Map,U0.set(A,c);for(var w=A.querySelectorAll("link[data-precedence],style[data-precedence]"),B=0;B<w.length;B++){var b=w[B];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),g=b)}g&&c.set(null,g)}w=i.instance,b=w.getAttribute("data-precedence"),B=c.get(b)||g,B===g&&c.set(null,w),c.set(b,w),this.count++,g=F0.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),B?B.parentNode.insertBefore(w,B.nextSibling):(A=A.nodeType===9?A.head:A,A.insertBefore(w,A.firstChild)),i.state.loading|=4}}var lc={$$typeof:_,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function UU(A,i,c,g,w,B,b,M,te){this.tag=1,this.containerInfo=A,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=si(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=si(0),this.hiddenUpdates=si(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=B,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function Ty(A,i,c,g,w,B,b,M,te,ge,Fe,ke){return A=new UU(A,i,c,b,te,ge,Fe,ke,M),i=1,B===!0&&(i|=24),B=ca(3,null,null,i),A.current=B,B.stateNode=A,i=yh(),i.refCount++,A.pooledCache=i,i.refCount++,B.memoizedState={element:g,isDehydrated:c,cache:i},Sh(B),A}function _y(A){return A?(A=dl,A):dl}function by(A,i,c,g,w,B){w=_y(w),g.context===null?g.context=w:g.pendingContext=w,g=vs(i),g.payload={element:c},B=B===void 0?null:B,B!==null&&(g.callback=B),c=ws(A,g,i),c!==null&&(aa(c,A,i),Oo(c,A,i))}function Fy(A,i){if(A=A.memoizedState,A!==null&&A.dehydrated!==null){var c=A.retryLane;A.retryLane=c!==0&&c<i?c:i}}function Vg(A,i){Fy(A,i),(A=A.alternate)&&Fy(A,i)}function Uy(A){if(A.tag===13||A.tag===31){var i=di(A,67108864);i!==null&&aa(i,A,67108864),Vg(A,67108864)}}function ky(A){if(A.tag===13||A.tag===31){var i=ga();i=ii(i);var c=di(A,i);c!==null&&aa(c,A,i),Vg(A,i)}}var N0=!0;function kU(A,i,c,g){var w=q.T;q.T=null;var B=Ae.p;try{Ae.p=2,Kg(A,i,c,g)}finally{Ae.p=B,q.T=w}}function NU(A,i,c,g){var w=q.T;q.T=null;var B=Ae.p;try{Ae.p=8,Kg(A,i,c,g)}finally{Ae.p=B,q.T=w}}function Kg(A,i,c,g){if(N0){var w=jg(g);if(w===null)Ug(A,i,g,I0,c),Iy(A,g);else if(QU(w,A,i,c,g))g.stopPropagation();else if(Iy(A,g),i&4&&-1<IU.indexOf(A)){for(;w!==null;){var B=We(w);if(B!==null)switch(B.tag){case 3:if(B=B.stateNode,B.current.memoizedState.isDehydrated){var b=Ar(B.pendingLanes);if(b!==0){var M=B;for(M.pendingLanes|=2,M.entangledLanes|=2;b;){var te=1<<31-Sr(b);M.entanglements[1]|=te,b&=~te}mA(B),(nr&6)===0&&(g0=dt()+500,rc(0))}}break;case 31:case 13:M=di(B,2),M!==null&&aa(M,B,2),p0(),Vg(B,2)}if(B=jg(g),B===null&&Ug(A,i,g,I0,c),B===w)break;w=B}w!==null&&g.stopPropagation()}else Ug(A,i,g,null,c)}}function jg(A){return A=Xd(A),zg(A)}var I0=null;function zg(A){if(I0=null,A=Ge(A),A!==null){var i=s(A);if(i===null)A=null;else{var c=i.tag;if(c===13){if(A=l(i),A!==null)return A;A=null}else if(c===31){if(A=o(i),A!==null)return A;A=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;A=null}else i!==A&&(A=null)}}return I0=A,null}function Ny(A){switch(A){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case je:return 2;case bt:return 8;case ht:case Tt:return 32;case $e:return 268435456;default:return 32}default:return 32}}var Xg=!1,ks=null,Ns=null,Is=null,oc=new Map,cc=new Map,Qs=[],IU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Iy(A,i){switch(A){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":cc.delete(i.pointerId)}}function uc(A,i,c,g,w,B){return A===null||A.nativeEvent!==B?(A={blockedOn:i,domEventName:c,eventSystemFlags:g,nativeEvent:B,targetContainers:[w]},i!==null&&(i=We(i),i!==null&&Uy(i)),A):(A.eventSystemFlags|=g,i=A.targetContainers,w!==null&&i.indexOf(w)===-1&&i.push(w),A)}function QU(A,i,c,g,w){switch(i){case"focusin":return ks=uc(ks,A,i,c,g,w),!0;case"dragenter":return Ns=uc(Ns,A,i,c,g,w),!0;case"mouseover":return Is=uc(Is,A,i,c,g,w),!0;case"pointerover":var B=w.pointerId;return oc.set(B,uc(oc.get(B)||null,A,i,c,g,w)),!0;case"gotpointercapture":return B=w.pointerId,cc.set(B,uc(cc.get(B)||null,A,i,c,g,w)),!0}return!1}function Qy(A){var i=Ge(A.target);if(i!==null){var c=s(i);if(c!==null){if(i=c.tag,i===13){if(i=l(c),i!==null){A.blockedOn=i,j(A.priority,function(){ky(c)});return}}else if(i===31){if(i=o(c),i!==null){A.blockedOn=i,j(A.priority,function(){ky(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){A.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}A.blockedOn=null}function Q0(A){if(A.blockedOn!==null)return!1;for(var i=A.targetContainers;0<i.length;){var c=jg(A.nativeEvent);if(c===null){c=A.nativeEvent;var g=new c.constructor(c.type,c);zd=g,c.target.dispatchEvent(g),zd=null}else return i=We(c),i!==null&&Uy(i),A.blockedOn=c,!1;i.shift()}return!0}function Ry(A,i,c){Q0(A)&&c.delete(i)}function RU(){Xg=!1,ks!==null&&Q0(ks)&&(ks=null),Ns!==null&&Q0(Ns)&&(Ns=null),Is!==null&&Q0(Is)&&(Is=null),oc.forEach(Ry),cc.forEach(Ry)}function R0(A,i){A.blockedOn===i&&(A.blockedOn=null,Xg||(Xg=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,RU)))}var D0=null;function Dy(A){D0!==A&&(D0=A,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){D0===A&&(D0=null);for(var i=0;i<A.length;i+=3){var c=A[i],g=A[i+1],w=A[i+2];if(typeof g!="function"){if(zg(g||c)===null)continue;break}var B=We(c);B!==null&&(A.splice(i,3),i-=3,jh(B,{pending:!0,data:w,method:c.method,action:g},g,w))}}))}function Ml(A){function i(te){return R0(te,A)}ks!==null&&R0(ks,A),Ns!==null&&R0(Ns,A),Is!==null&&R0(Is,A),oc.forEach(i),cc.forEach(i);for(var c=0;c<Qs.length;c++){var g=Qs[c];g.blockedOn===A&&(g.blockedOn=null)}for(;0<Qs.length&&(c=Qs[0],c.blockedOn===null);)Qy(c),c.blockedOn===null&&Qs.shift();if(c=(A.ownerDocument||A).$$reactFormReplay,c!=null)for(g=0;g<c.length;g+=3){var w=c[g],B=c[g+1],b=w[G]||null;if(typeof B=="function")b||Dy(c);else if(b){var M=null;if(B&&B.hasAttribute("formAction")){if(w=B,b=B[G]||null)M=b.formAction;else if(zg(w)!==null)continue}else M=b.action;typeof M=="function"?c[g+1]=M:(c.splice(g,3),g-=3),Dy(c)}}}function My(){function A(B){B.canIntercept&&B.info==="react-transition"&&B.intercept({handler:function(){return new Promise(function(b){return w=b})},focusReset:"manual",scroll:"manual"})}function i(){w!==null&&(w(),w=null),g||setTimeout(c,20)}function c(){if(!g&&!navigation.transition){var B=navigation.currentEntry;B&&B.url!=null&&navigation.navigate(B.url,{state:B.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,w=null;return navigation.addEventListener("navigate",A),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){g=!0,navigation.removeEventListener("navigate",A),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),w!==null&&(w(),w=null)}}}function Jg(A){this._internalRoot=A}M0.prototype.render=Jg.prototype.render=function(A){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,g=ga();by(c,g,A,i,null,null)},M0.prototype.unmount=Jg.prototype.unmount=function(){var A=this._internalRoot;if(A!==null){this._internalRoot=null;var i=A.containerInfo;by(A.current,2,null,A,null,null),p0(),i[W]=null}};function M0(A){this._internalRoot=A}M0.prototype.unstable_scheduleHydration=function(A){if(A){var i=I();A={blockedOn:null,target:A,priority:i};for(var c=0;c<Qs.length&&i!==0&&i<Qs[c].priority;c++);Qs.splice(c,0,A),c===0&&Qy(A)}};var Ly=t.version;if(Ly!=="19.2.3")throw Error(n(527,Ly,"19.2.3"));Ae.findDOMNode=function(A){var i=A._reactInternals;if(i===void 0)throw typeof A.render=="function"?Error(n(188)):(A=Object.keys(A).join(","),Error(n(268,A)));return A=f(i),A=A!==null?d(A):null,A=A===null?null:A.stateNode,A};var DU={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var L0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!L0.isDisabled&&L0.supportsFiber)try{Bt=L0.inject(DU),qt=L0}catch{}}return dc.createRoot=function(A,i){if(!a(A))throw Error(n(299));var c=!1,g="",w=j1,B=z1,b=X1;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(g=i.identifierPrefix),i.onUncaughtError!==void 0&&(w=i.onUncaughtError),i.onCaughtError!==void 0&&(B=i.onCaughtError),i.onRecoverableError!==void 0&&(b=i.onRecoverableError)),i=Ty(A,1,!1,null,null,c,g,null,w,B,b,My),A[W]=i.current,Fg(A),new Jg(i)},dc.hydrateRoot=function(A,i,c){if(!a(A))throw Error(n(299));var g=!1,w="",B=j1,b=z1,M=X1,te=null;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onUncaughtError!==void 0&&(B=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(M=c.onRecoverableError),c.formState!==void 0&&(te=c.formState)),i=Ty(A,1,!0,i,c??null,g,w,te,B,b,M,My),i.context=_y(null),c=i.current,g=ga(),g=ii(g),w=vs(g),w.callback=null,ws(c,w,g),c=g,i.current.lanes=c,fA(i,c),mA(i),A[W]=i.current,Fg(A),new M0(i)},dc.version="19.2.3",dc}var Jy;function XU(){if(Jy)return qg.exports;Jy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),qg.exports=zU(),qg.exports}var JU=XU();const WU=eS(JU);/**
 * react-router v7.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Wy="popstate";function YU(e={}){function t(a,s){let{pathname:l="/",search:o="",hash:u=""}=Ji(a.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),zm("",{pathname:l,search:o,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(a,s){let l=a.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let u=a.location.href,f=u.indexOf("#");o=f===-1?u:u.slice(0,f)}return o+"#"+(typeof s=="string"?s:qc(s))}function n(a,s){ya(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return $U(t,r,n,e)}function Dr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ya(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function qU(){return Math.random().toString(36).substring(2,10)}function Yy(e,t){return{usr:e.state,key:e.key,idx:t}}function zm(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Ji(t):t,state:r,key:t&&t.key||n||qU()}}function qc({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ji(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function $U(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,l=a.history,o="POP",u=null,f=d();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function d(){return(l.state||{idx:null}).idx}function m(){o="POP";let S=d(),T=S==null?null:S-f;f=S,u&&u({action:o,location:C.location,delta:T})}function x(S,T){o="PUSH";let F=zm(C.location,S,T);r&&r(F,S),f=d()+1;let _=Yy(F,f),Q=C.createHref(F);try{l.pushState(_,"",Q)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(Q)}s&&u&&u({action:o,location:C.location,delta:1})}function y(S,T){o="REPLACE";let F=zm(C.location,S,T);r&&r(F,S),f=d();let _=Yy(F,f),Q=C.createHref(F);l.replaceState(_,"",Q),s&&u&&u({action:o,location:C.location,delta:0})}function E(S){return ZU(S)}let C={get action(){return o},get location(){return e(a,l)},listen(S){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(Wy,m),u=S,()=>{a.removeEventListener(Wy,m),u=null}},createHref(S){return t(a,S)},createURL:E,encodeLocation(S){let T=E(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:x,replace:y,go(S){return l.go(S)}};return C}function ZU(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Dr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:qc(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function tS(e,t,r="/"){return ek(e,t,r,!1)}function ek(e,t,r,n){let a=typeof t=="string"?Ji(t):t,s=ts(a.pathname||"/",r);if(s==null)return null;let l=rS(e);tk(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let f=fk(s);o=ck(l[u],f,n)}return o}function rS(e,t=[],r=[],n="",a=!1){let s=(l,o,u=a,f)=>{let d={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&u)return;Dr(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let m=YA([n,d.relativePath]),x=r.concat(d);l.children&&l.children.length>0&&(Dr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),rS(l.children,t,x,m,u)),!(l.path==null&&!l.index)&&t.push({path:m,score:lk(m,l.index),routesMeta:x})};return e.forEach((l,o)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))s(l,o);else for(let f of nS(l.path))s(l,o,!0,f)}),t}function nS(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let l=nS(n.join("/")),o=[];return o.push(...l.map(u=>u===""?s:[s,u].join("/"))),a&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function tk(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:ok(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var rk=/^:[\w-]+$/,nk=3,ak=2,Ak=1,sk=10,ik=-2,qy=e=>e==="*";function lk(e,t){let r=e.split("/"),n=r.length;return r.some(qy)&&(n+=ik),t&&(n+=ak),r.filter(a=>!qy(a)).reduce((a,s)=>a+(rk.test(s)?nk:s===""?Ak:sk),n)}function ok(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function ck(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],f=o===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",m=Pf({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},d),x=u.route;if(!m&&f&&r&&!n[n.length-1].route.index&&(m=Pf({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(a,m.params),l.push({params:a,pathname:YA([s,m.pathname]),pathnameBase:mk(YA([s,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(s=YA([s,m.pathnameBase]))}return l}function Pf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=uk(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],l=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:m},x)=>{if(d==="*"){let E=o[x]||"";l=s.slice(0,s.length-E.length).replace(/(.)\/+$/,"$1")}const y=o[x];return m&&!y?f[d]=void 0:f[d]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:l,pattern:e}}function uk(e,t=!1,r=!0){ya(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function fk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ya(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ts(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var aS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dk=e=>aS.test(e);function hk(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Ji(e):e,s;if(r)if(dk(r))s=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),ya(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${r}`)}r.startsWith("/")?s=$y(r.substring(1),"/"):s=$y(r,t)}else s=t;return{pathname:s,search:pk(n),hash:xk(a)}}function $y(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function tm(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Yp(e){let t=gk(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function qp(e,t,r,n=!1){let a;typeof e=="string"?a=Ji(e):(a={...e},Dr(!a.pathname||!a.pathname.includes("?"),tm("?","pathname","search",a)),Dr(!a.pathname||!a.pathname.includes("#"),tm("#","pathname","hash",a)),Dr(!a.search||!a.search.includes("#"),tm("#","search","hash",a)));let s=e===""||a.pathname==="",l=s?"/":a.pathname,o;if(l==null)o=r;else{let m=t.length-1;if(!n&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),m-=1;a.pathname=x.join("/")}o=m>=0?t[m]:"/"}let u=hk(a,o),f=l&&l!=="/"&&l.endsWith("/"),d=(s||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||d)&&(u.pathname+="/"),u}var YA=e=>e.join("/").replace(/\/\/+/g,"/"),mk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),pk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,xk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,vk=class{constructor(e,t,r,n=!1){this.status=e,this.statusText=t||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function wk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function yk(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var AS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function sS(e,t){let r=e;if(typeof r!="string"||!aS.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,a=!1;if(AS)try{let s=new URL(window.location.href),l=r.startsWith("//")?new URL(s.protocol+r):new URL(r),o=ts(l.pathname,t);l.origin===s.origin&&o!=null?r=o+l.search+l.hash:a=!0}catch{ya(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:a,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var iS=["POST","PUT","PATCH","DELETE"];new Set(iS);var Bk=["GET",...iS];new Set(Bk);var ho=X.createContext(null);ho.displayName="DataRouter";var pd=X.createContext(null);pd.displayName="DataRouterState";var Ck=X.createContext(!1),lS=X.createContext({isTransitioning:!1});lS.displayName="ViewTransition";var Ek=X.createContext(new Map);Ek.displayName="Fetchers";var Sk=X.createContext(null);Sk.displayName="Await";var Ca=X.createContext(null);Ca.displayName="Navigation";var pu=X.createContext(null);pu.displayName="Location";var CA=X.createContext({outlet:null,matches:[],isDataRoute:!1});CA.displayName="Route";var $p=X.createContext(null);$p.displayName="RouteError";var oS="REACT_ROUTER_ERROR",Tk="REDIRECT",_k="ROUTE_ERROR_RESPONSE";function bk(e){if(e.startsWith(`${oS}:${Tk}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Fk(e){if(e.startsWith(`${oS}:${_k}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new vk(t.status,t.statusText,t.data)}catch{}}function Uk(e,{relative:t}={}){Dr(go(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=X.useContext(Ca),{hash:a,pathname:s,search:l}=xu(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:YA([r,s])),n.createHref({pathname:o,search:l,hash:a})}function go(){return X.useContext(pu)!=null}function As(){return Dr(go(),"useLocation() may be used only in the context of a <Router> component."),X.useContext(pu).location}var cS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uS(e){X.useContext(Ca).static||X.useLayoutEffect(e)}function xd(){let{isDataRoute:e}=X.useContext(CA);return e?Vk():kk()}function kk(){Dr(go(),"useNavigate() may be used only in the context of a <Router> component.");let e=X.useContext(ho),{basename:t,navigator:r}=X.useContext(Ca),{matches:n}=X.useContext(CA),{pathname:a}=As(),s=JSON.stringify(Yp(n)),l=X.useRef(!1);return uS(()=>{l.current=!0}),X.useCallback((u,f={})=>{if(ya(l.current,cS),!l.current)return;if(typeof u=="number"){r.go(u);return}let d=qp(u,JSON.parse(s),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:YA([t,d.pathname])),(f.replace?r.replace:r.push)(d,f.state,f)},[t,r,s,a,e])}X.createContext(null);function xu(e,{relative:t}={}){let{matches:r}=X.useContext(CA),{pathname:n}=As(),a=JSON.stringify(Yp(r));return X.useMemo(()=>qp(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function Nk(e,t){return fS(e,t)}function fS(e,t,r,n,a){var F;Dr(go(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=X.useContext(Ca),{matches:l}=X.useContext(CA),o=l[l.length-1],u=o?o.params:{},f=o?o.pathname:"/",d=o?o.pathnameBase:"/",m=o&&o.route;{let _=m&&m.path||"";hS(f,!m||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let x=As(),y;if(t){let _=typeof t=="string"?Ji(t):t;Dr(d==="/"||((F=_.pathname)==null?void 0:F.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${_.pathname}" was given in the \`location\` prop.`),y=_}else y=x;let E=y.pathname||"/",C=E;if(d!=="/"){let _=d.replace(/^\//,"").split("/");C="/"+E.replace(/^\//,"").split("/").slice(_.length).join("/")}let S=tS(e,{pathname:C});ya(m||S!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),ya(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=Mk(S&&S.map(_=>Object.assign({},_,{params:Object.assign({},u,_.params),pathname:YA([d,s.encodeLocation?s.encodeLocation(_.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?d:YA([d,s.encodeLocation?s.encodeLocation(_.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathnameBase])})),l,r,n,a);return t&&T?X.createElement(pu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function Ik(){let e=Gk(),t=wk(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=X.createElement(X.Fragment,null,X.createElement("p",null," Hey developer "),X.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",X.createElement("code",{style:s},"ErrorBoundary")," or"," ",X.createElement("code",{style:s},"errorElement")," prop on your route.")),X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),r?X.createElement("pre",{style:a},r):null,l)}var Qk=X.createElement(Ik,null),dS=class extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=Fk(e.digest);r&&(e=r)}let t=e!==void 0?X.createElement(CA.Provider,{value:this.props.routeContext},X.createElement($p.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?X.createElement(Rk,{error:e},t):t}};dS.contextType=Ck;var rm=new WeakMap;function Rk({children:e,error:t}){let{basename:r}=X.useContext(Ca);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=bk(t.digest);if(n){let a=rm.get(t);if(a)throw a;let s=sS(n.location,r);if(AS&&!rm.get(t))if(s.isExternal||n.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:n.replace}));throw rm.set(t,l),l}return X.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return e}function Dk({routeContext:e,match:t,children:r}){let n=X.useContext(ho);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),X.createElement(CA.Provider,{value:e},r)}function Mk(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=r==null?void 0:r.errors;if(l!=null){let d=s.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);Dr(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),s=s.slice(0,Math.min(s.length,d+1))}let o=!1,u=-1;if(r)for(let d=0;d<s.length;d++){let m=s[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:x,errors:y}=r,E=m.route.loader&&!x.hasOwnProperty(m.route.id)&&(!y||y[m.route.id]===void 0);if(m.route.lazy||E){o=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}let f=r&&n?(d,m)=>{var x,y;n(d,{location:r.location,params:((y=(x=r.matches)==null?void 0:x[0])==null?void 0:y.params)??{},unstable_pattern:yk(r.matches),errorInfo:m})}:void 0;return s.reduceRight((d,m,x)=>{let y,E=!1,C=null,S=null;r&&(y=l&&m.route.id?l[m.route.id]:void 0,C=m.route.errorElement||Qk,o&&(u<0&&x===0?(hS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,S=null):u===x&&(E=!0,S=m.route.hydrateFallbackElement||null)));let T=t.concat(s.slice(0,x+1)),F=()=>{let _;return y?_=C:E?_=S:m.route.Component?_=X.createElement(m.route.Component,null):m.route.element?_=m.route.element:_=d,X.createElement(Dk,{match:m,routeContext:{outlet:d,matches:T,isDataRoute:r!=null},children:_})};return r&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?X.createElement(dS,{location:r.location,revalidation:r.revalidation,component:C,error:y,children:F(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:f}):F()},null)}function Zp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Lk(e){let t=X.useContext(ho);return Dr(t,Zp(e)),t}function Hk(e){let t=X.useContext(pd);return Dr(t,Zp(e)),t}function Ok(e){let t=X.useContext(CA);return Dr(t,Zp(e)),t}function ex(e){let t=Ok(e),r=t.matches[t.matches.length-1];return Dr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Pk(){return ex("useRouteId")}function Gk(){var n;let e=X.useContext($p),t=Hk("useRouteError"),r=ex("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Vk(){let{router:e}=Lk("useNavigate"),t=ex("useNavigate"),r=X.useRef(!1);return uS(()=>{r.current=!0}),X.useCallback(async(a,s={})=>{ya(r.current,cS),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var Zy={};function hS(e,t,r){!t&&!Zy[e]&&(Zy[e]=!0,ya(!1,r))}X.memo(Kk);function Kk({routes:e,future:t,state:r,onError:n}){return fS(e,void 0,r,n,t)}function Xm({to:e,replace:t,state:r,relative:n}){Dr(go(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=X.useContext(Ca);ya(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=X.useContext(CA),{pathname:l}=As(),o=xd(),u=qp(e,Yp(s),l,n==="path"),f=JSON.stringify(u);return X.useEffect(()=>{o(JSON.parse(f),{replace:t,state:r,relative:n})},[o,f,n,t,r]),null}function Ui(e){Dr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function jk({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1,unstable_useTransitions:l}){Dr(!go(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),u=X.useMemo(()=>({basename:o,navigator:a,static:s,unstable_useTransitions:l,future:{}}),[o,a,s,l]);typeof r=="string"&&(r=Ji(r));let{pathname:f="/",search:d="",hash:m="",state:x=null,key:y="default"}=r,E=X.useMemo(()=>{let C=ts(f,o);return C==null?null:{location:{pathname:C,search:d,hash:m,state:x,key:y},navigationType:n}},[o,f,d,m,x,y,n]);return ya(E!=null,`<Router basename="${o}"> is not able to match the URL "${f}${d}${m}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:X.createElement(Ca.Provider,{value:u},X.createElement(pu.Provider,{children:t,value:E}))}function zk({children:e,location:t}){return Nk(Jm(e),t)}function Jm(e,t=[]){let r=[];return X.Children.forEach(e,(n,a)=>{if(!X.isValidElement(n))return;let s=[...t,a];if(n.type===X.Fragment){r.push.apply(r,Jm(n.props.children,s));return}Dr(n.type===Ui,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Dr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Jm(n.props.children,s)),r.push(l)}),r}var If="get",Qf="application/x-www-form-urlencoded";function vd(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Xk(e){return vd(e)&&e.tagName.toLowerCase()==="button"}function Jk(e){return vd(e)&&e.tagName.toLowerCase()==="form"}function Wk(e){return vd(e)&&e.tagName.toLowerCase()==="input"}function Yk(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function qk(e,t){return e.button===0&&(!t||t==="_self")&&!Yk(e)}var H0=null;function $k(){if(H0===null)try{new FormData(document.createElement("form"),0),H0=!1}catch{H0=!0}return H0}var Zk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nm(e){return e!=null&&!Zk.has(e)?(ya(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qf}"`),null):e}function eN(e,t){let r,n,a,s,l;if(Jk(e)){let o=e.getAttribute("action");n=o?ts(o,t):null,r=e.getAttribute("method")||If,a=nm(e.getAttribute("enctype"))||Qf,s=new FormData(e)}else if(Xk(e)||Wk(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||o.getAttribute("action");if(n=u?ts(u,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||If,a=nm(e.getAttribute("formenctype"))||nm(o.getAttribute("enctype"))||Qf,s=new FormData(o,e),!$k()){let{name:f,type:d,value:m}=e;if(d==="image"){let x=f?`${f}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else f&&s.append(f,m)}}else{if(vd(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=If,n=null,a=Qf,l=e}return s&&a==="text/plain"&&(l=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function tx(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tN(e,t,r,n){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${n}`:a.pathname=`${a.pathname}.${n}`:a.pathname==="/"?a.pathname=`_root.${n}`:t&&ts(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}async function rN(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function nN(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function aN(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let l=await rN(s,r);return l.links?l.links():[]}return[]}));return lN(n.flat(1).filter(nN).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function eB(e,t,r,n,a,s){let l=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,o=(u,f)=>{var d;return r[f].pathname!==u.pathname||((d=r[f].route.path)==null?void 0:d.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return s==="assets"?t.filter((u,f)=>l(u,f)||o(u,f)):s==="data"?t.filter((u,f)=>{var m;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(l(u,f)||o(u,f))return!0;if(u.route.shouldRevalidate){let x=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function AN(e,t,{includeHydrateFallback:r}={}){return sN(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function sN(e){return[...new Set(e)]}function iN(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function lN(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(iN(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function gS(){let e=X.useContext(ho);return tx(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function oN(){let e=X.useContext(pd);return tx(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var rx=X.createContext(void 0);rx.displayName="FrameworkContext";function mS(){let e=X.useContext(rx);return tx(e,"You must render this element inside a <HydratedRouter> element"),e}function cN(e,t){let r=X.useContext(rx),[n,a]=X.useState(!1),[s,l]=X.useState(!1),{onFocus:o,onBlur:u,onMouseEnter:f,onMouseLeave:d,onTouchStart:m}=t,x=X.useRef(null);X.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let C=T=>{T.forEach(F=>{l(F.isIntersecting)})},S=new IntersectionObserver(C,{threshold:.5});return x.current&&S.observe(x.current),()=>{S.disconnect()}}},[e]),X.useEffect(()=>{if(n){let C=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(C)}}},[n]);let y=()=>{a(!0)},E=()=>{a(!1),l(!1)};return r?e!=="intent"?[s,x,{}]:[s,x,{onFocus:hc(o,y),onBlur:hc(u,E),onMouseEnter:hc(f,y),onMouseLeave:hc(d,E),onTouchStart:hc(m,y)}]:[!1,x,{}]}function hc(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function uN({page:e,...t}){let{router:r}=gS(),n=X.useMemo(()=>tS(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?X.createElement(dN,{page:e,matches:n,...t}):null}function fN(e){let{manifest:t,routeModules:r}=mS(),[n,a]=X.useState([]);return X.useEffect(()=>{let s=!1;return aN(e,t,r).then(l=>{s||a(l)}),()=>{s=!0}},[e,t,r]),n}function dN({page:e,matches:t,...r}){let n=As(),{future:a,manifest:s,routeModules:l}=mS(),{basename:o}=gS(),{loaderData:u,matches:f}=oN(),d=X.useMemo(()=>eB(e,t,f,s,n,"data"),[e,t,f,s,n]),m=X.useMemo(()=>eB(e,t,f,s,n,"assets"),[e,t,f,s,n]),x=X.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let C=new Set,S=!1;if(t.forEach(F=>{var Q;let _=s.routes[F.route.id];!_||!_.hasLoader||(!d.some(L=>L.route.id===F.route.id)&&F.route.id in u&&((Q=l[F.route.id])!=null&&Q.shouldRevalidate)||_.hasClientLoader?S=!0:C.add(F.route.id))}),C.size===0)return[];let T=tN(e,o,a.unstable_trailingSlashAwareDataRequests,"data");return S&&C.size>0&&T.searchParams.set("_routes",t.filter(F=>C.has(F.route.id)).map(F=>F.route.id).join(",")),[T.pathname+T.search]},[o,a.unstable_trailingSlashAwareDataRequests,u,n,s,d,t,e,l]),y=X.useMemo(()=>AN(m,s),[m,s]),E=fN(m);return X.createElement(X.Fragment,null,x.map(C=>X.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...r})),y.map(C=>X.createElement("link",{key:C,rel:"modulepreload",href:C,...r})),E.map(({key:C,link:S})=>X.createElement("link",{key:C,nonce:r.nonce,...S})))}function hN(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var gN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{gN&&(window.__reactRouterVersion="7.12.0")}catch{}function mN({basename:e,children:t,unstable_useTransitions:r,window:n}){let a=X.useRef();a.current==null&&(a.current=YU({window:n,v5Compat:!0}));let s=a.current,[l,o]=X.useState({action:s.action,location:s.location}),u=X.useCallback(f=>{r===!1?o(f):X.startTransition(()=>o(f))},[r]);return X.useLayoutEffect(()=>s.listen(u),[s,u]),X.createElement(jk,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:s,unstable_useTransitions:r})}var pS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xS=X.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:l,state:o,target:u,to:f,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:x,...y},E){let{basename:C,unstable_useTransitions:S}=X.useContext(Ca),T=typeof f=="string"&&pS.test(f),F=sS(f,C);f=F.to;let _=Uk(f,{relative:a}),[Q,L,R]=cN(n,y),U=wN(f,{replace:l,state:o,target:u,preventScrollReset:d,relative:a,viewTransition:m,unstable_defaultShouldRevalidate:x,unstable_useTransitions:S});function K(ee){t&&t(ee),ee.defaultPrevented||U(ee)}let D=X.createElement("a",{...y,...R,href:F.absoluteURL||_,onClick:F.isExternal||s?t:K,ref:hN(E,L),target:u,"data-discover":!T&&r==="render"?"true":void 0});return Q&&!T?X.createElement(X.Fragment,null,D,X.createElement(uN,{page:_})):D});xS.displayName="Link";var pN=X.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:l,viewTransition:o,children:u,...f},d){let m=xu(l,{relative:f.relative}),x=As(),y=X.useContext(pd),{navigator:E,basename:C}=X.useContext(Ca),S=y!=null&&SN(m)&&o===!0,T=E.encodeLocation?E.encodeLocation(m).pathname:m.pathname,F=x.pathname,_=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(F=F.toLowerCase(),_=_?_.toLowerCase():null,T=T.toLowerCase()),_&&C&&(_=ts(_,C)||_);const Q=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let L=F===T||!a&&F.startsWith(T)&&F.charAt(Q)==="/",R=_!=null&&(_===T||!a&&_.startsWith(T)&&_.charAt(T.length)==="/"),U={isActive:L,isPending:R,isTransitioning:S},K=L?t:void 0,D;typeof n=="function"?D=n(U):D=[n,L?"active":null,R?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let ee=typeof s=="function"?s(U):s;return X.createElement(xS,{...f,"aria-current":K,className:D,ref:d,style:ee,to:l,viewTransition:o},typeof u=="function"?u(U):u)});pN.displayName="NavLink";var xN=X.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:l=If,action:o,onSubmit:u,relative:f,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:x,...y},E)=>{let{unstable_useTransitions:C}=X.useContext(Ca),S=CN(),T=EN(o,{relative:f}),F=l.toLowerCase()==="get"?"get":"post",_=typeof o=="string"&&pS.test(o),Q=L=>{if(u&&u(L),L.defaultPrevented)return;L.preventDefault();let R=L.nativeEvent.submitter,U=(R==null?void 0:R.getAttribute("formmethod"))||l,K=()=>S(R||L.currentTarget,{fetcherKey:t,method:U,navigate:r,replace:a,state:s,relative:f,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:x});C&&r!==!1?X.startTransition(()=>K()):K()};return X.createElement("form",{ref:E,method:F,action:T,onSubmit:n?u:Q,...y,"data-discover":!_&&e==="render"?"true":void 0})});xN.displayName="Form";function vN(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vS(e){let t=X.useContext(ho);return Dr(t,vN(e)),t}function wN(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:l,unstable_defaultShouldRevalidate:o,unstable_useTransitions:u}={}){let f=xd(),d=As(),m=xu(e,{relative:s});return X.useCallback(x=>{if(qk(x,t)){x.preventDefault();let y=r!==void 0?r:qc(d)===qc(m),E=()=>f(e,{replace:y,state:n,preventScrollReset:a,relative:s,viewTransition:l,unstable_defaultShouldRevalidate:o});u?X.startTransition(()=>E()):E()}},[d,f,m,r,n,t,e,a,s,l,o,u])}var yN=0,BN=()=>`__${String(++yN)}__`;function CN(){let{router:e}=vS("useSubmit"),{basename:t}=X.useContext(Ca),r=Pk(),n=e.fetch,a=e.navigate;return X.useCallback(async(s,l={})=>{let{action:o,method:u,encType:f,formData:d,body:m}=eN(s,t);if(l.navigate===!1){let x=l.fetcherKey||BN();await n(x,r,l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:d,body:m,formMethod:l.method||u,formEncType:l.encType||f,flushSync:l.flushSync})}else await a(l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:d,body:m,formMethod:l.method||u,formEncType:l.encType||f,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[n,a,t,r])}function EN(e,{relative:t}={}){let{basename:r}=X.useContext(Ca),n=X.useContext(CA);Dr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...xu(e||".",{relative:t})},l=As();if(e==null){s.search=l.search;let o=new URLSearchParams(s.search),u=o.getAll("index");if(u.some(d=>d==="")){o.delete("index"),u.filter(m=>m).forEach(m=>o.append("index",m));let d=o.toString();s.search=d?`?${d}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:YA([r,s.pathname])),qc(s)}function SN(e,{relative:t}={}){let r=X.useContext(lS);Dr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=vS("useViewTransitionState"),a=xu(e,{relative:t});if(!r.isTransitioning)return!1;let s=ts(r.currentLocation.pathname,n)||r.currentLocation.pathname,l=ts(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Pf(a.pathname,l)!=null||Pf(a.pathname,s)!=null}var At=(e=>(e.SUPER_ADMIN="SUPER_ADMIN",e.ADMIN="ADMIN",e.TEACHER="TEACHER",e.STUDENT="STUDENT",e))(At||{}),TN={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let _N,bN;function FN(){return{geminiUrl:_N,vertexUrl:bN}}function UN(e,t,r,n){var a,s;if(!(e!=null&&e.baseUrl)){const l=FN();return t?(a=l.vertexUrl)!==null&&a!==void 0?a:r:(s=l.geminiUrl)!==null&&s!==void 0?s:n}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ss{}function qe(e,t){const r=/\{([^}]+)\}/g;return e.replace(r,(n,a)=>{if(Object.prototype.hasOwnProperty.call(t,a)){const s=t[a];return s!=null?String(s):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function v(e,t,r){for(let s=0;s<t.length-1;s++){const l=t[s];if(l.endsWith("[]")){const o=l.slice(0,-2);if(!(o in e))if(Array.isArray(r))e[o]=Array.from({length:r.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[o])){const u=e[o];if(Array.isArray(r))for(let f=0;f<u.length;f++){const d=u[f];v(d,t.slice(s+1),r[f])}else for(const f of u)v(f,t.slice(s+1),r)}return}else if(l.endsWith("[0]")){const o=l.slice(0,-3);o in e||(e[o]=[{}]);const u=e[o];v(u[0],t.slice(s+1),r);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const n=t[t.length-1],a=e[n];if(a!==void 0){if(!r||typeof r=="object"&&Object.keys(r).length===0||r===a)return;if(typeof a=="object"&&typeof r=="object"&&a!==null&&r!==null)Object.assign(a,r);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(e,r):e[n]=r}function p(e,t,r=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return r;const a=t[n];if(a.endsWith("[]")){const s=a.slice(0,-2);if(s in e){const l=e[s];return Array.isArray(l)?l.map(o=>p(o,t.slice(n+1),r)):r}else return r}else e=e[a]}return e}catch(n){if(n instanceof TypeError)return r;throw n}}function kN(e,t){for(const[r,n]of Object.entries(t)){const a=r.split("."),s=n.split("."),l=new Set;let o=-1;for(let u=0;u<a.length;u++)if(a[u]==="*"){o=u;break}if(o!==-1&&s.length>o)for(let u=o;u<s.length;u++){const f=s[u];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}Wm(e,a,s,0,l)}}function Wm(e,t,r,n,a){if(n>=t.length||typeof e!="object"||e===null)return;const s=t[n];if(s.endsWith("[]")){const l=s.slice(0,-2),o=e;if(l in o&&Array.isArray(o[l]))for(const u of o[l])Wm(u,t,r,n+1,a)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const l=e,o=Object.keys(l).filter(f=>!f.startsWith("_")&&!a.has(f)),u={};for(const f of o)u[f]=l[f];for(const[f,d]of Object.entries(u)){const m=[];for(const x of r.slice(n))x==="*"?m.push(f):m.push(x);v(l,m,d)}for(const f of o)delete l[f]}}else{const l=e;s in l&&Wm(l[s],t,r,n+1,a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nx(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NN(e){const t={},r=p(e,["operationName"]);r!=null&&v(t,["operationName"],r);const n=p(e,["resourceName"]);return n!=null&&v(t,["_url","resourceName"],n),t}function IN(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response","generateVideoResponse"]);return l!=null&&v(t,["response"],RN(l)),t}function QN(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],DN(l)),t}function RN(e){const t={},r=p(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>MN(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const a=p(e,["raiMediaFilteredReasons"]);return a!=null&&v(t,["raiMediaFilteredReasons"],a),t}function DN(e){const t={},r=p(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>LN(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const a=p(e,["raiMediaFilteredReasons"]);return a!=null&&v(t,["raiMediaFilteredReasons"],a),t}function MN(e){const t={},r=p(e,["video"]);return r!=null&&v(t,["video"],KN(r)),t}function LN(e){const t={},r=p(e,["_self"]);return r!=null&&v(t,["video"],jN(r)),t}function HN(e){const t={},r=p(e,["operationName"]);return r!=null&&v(t,["_url","operationName"],r),t}function ON(e){const t={},r=p(e,["operationName"]);return r!=null&&v(t,["_url","operationName"],r),t}function PN(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],GN(l)),t}function GN(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["parent"]);n!=null&&v(t,["parent"],n);const a=p(e,["documentName"]);return a!=null&&v(t,["documentName"],a),t}function wS(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],VN(l)),t}function VN(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["parent"]);n!=null&&v(t,["parent"],n);const a=p(e,["documentName"]);return a!=null&&v(t,["documentName"],a),t}function KN(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["uri"],r);const n=p(e,["encodedVideo"]);n!=null&&v(t,["videoBytes"],nx(n));const a=p(e,["encoding"]);return a!=null&&v(t,["mimeType"],a),t}function jN(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["uri"],r);const n=p(e,["bytesBase64Encoded"]);n!=null&&v(t,["videoBytes"],nx(n));const a=p(e,["mimeType"]);return a!=null&&v(t,["mimeType"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var tB;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(tB||(tB={}));var rB;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(rB||(rB={}));var nB;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(nB||(nB={}));var on;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(on||(on={}));var aB;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(aB||(aB={}));var AB;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(AB||(AB={}));var sB;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(sB||(sB={}));var iB;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(iB||(iB={}));var lB;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(lB||(lB={}));var oB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(oB||(oB={}));var cB;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(cB||(cB={}));var uB;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(uB||(uB={}));var fB;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(fB||(fB={}));var dB;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(dB||(dB={}));var hB;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(hB||(hB={}));var gB;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(gB||(gB={}));var mB;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(mB||(mB={}));var pB;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(pB||(pB={}));var xB;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(xB||(xB={}));var vB;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(vB||(vB={}));var wB;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(wB||(wB={}));var Gf;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Gf||(Gf={}));var yB;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(yB||(yB={}));var BB;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(BB||(BB={}));var CB;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(CB||(CB={}));var Ym;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ym||(Ym={}));var EB;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(EB||(EB={}));var SB;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(SB||(SB={}));var qm;(function(e){e.COLLECTION="COLLECTION"})(qm||(qm={}));var TB;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(TB||(TB={}));var _B;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(_B||(_B={}));var bB;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(bB||(bB={}));var FB;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(FB||(FB={}));var UB;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(UB||(UB={}));var kB;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(kB||(kB={}));var NB;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(NB||(NB={}));var IB;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(IB||(IB={}));var QB;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(QB||(QB={}));var RB;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(RB||(RB={}));var DB;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(DB||(DB={}));var MB;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(MB||(MB={}));var LB;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(LB||(LB={}));var HB;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(HB||(HB={}));var OB;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(OB||(OB={}));var PB;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(PB||(PB={}));var GB;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(GB||(GB={}));var VB;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(VB||(VB={}));var KB;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(KB||(KB={}));var jB;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(jB||(jB={}));var zB;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(zB||(zB={}));var XB;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(XB||(XB={}));var JB;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(JB||(JB={}));var WB;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(WB||(WB={}));var YB;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(YB||(YB={}));var qB;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(qB||(qB={}));var $B;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})($B||($B={}));var $l;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})($l||($l={}));class $m{constructor(t){const r={};for(const n of t.headers.entries())r[n[0]]=n[1];this.headers=r,this.responseInternal=t}json(){return this.responseInternal.json()}}class gc{get text(){var t,r,n,a,s,l,o,u;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",d=!1;const m=[];for(const x of(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)!==null&&u!==void 0?u:[]){for(const[y,E]of Object.entries(x))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(E!==null||E!==void 0)&&m.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;d=!0,f+=x.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?f:void 0}get data(){var t,r,n,a,s,l,o,u;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const d=[];for(const m of(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)!==null&&u!==void 0?u:[]){for(const[x,y]of Object.entries(m))x!=="inlineData"&&(y!==null||y!==void 0)&&d.push(x);m.inlineData&&typeof m.inlineData.data=="string"&&(f+=atob(m.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var t,r,n,a,s,l,o,u;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var t,r,n,a,s,l,o,u,f;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var t,r,n,a,s,l,o,u,f;if(((a=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(u=(o=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.output}}class ZB{}class eC{}class zN{}class XN{}class JN{}class WN{}class tC{}class rC{}class nC{}class YN{}class Vf{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new Vf;let a;const s=t;return r?a=QN(s):a=IN(s),Object.assign(n,a),n}}class aC{}class AC{}class sC{}class iC{}class qN{}class $N{}class ZN{}class ax{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new ax,s=PN(t);return Object.assign(n,s),n}}class eI{}class tI{}class rI{}class lC{}class nI{get text(){var t,r,n;let a="",s=!1;const l=[];for(const o of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[u,f]of Object.entries(o))u!=="text"&&u!=="thought"&&f!==null&&l.push(u);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;s=!0,a+=o.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?a:void 0}get data(){var t,r,n;let a="";const s=[];for(const l of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[o,u]of Object.entries(l))o!=="inlineData"&&u!==null&&s.push(o);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class aI{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Ax{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new Ax,s=wS(t);return Object.assign(n,s),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tr(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const r=t.split("/",2);return`publishers/${r[0]}/models/${r[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function yS(e,t){const r=tr(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function BS(e){return Array.isArray(e)?e.map(t=>Kf(t)):[Kf(e)]}function Kf(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function CS(e){const t=Kf(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function ES(e){const t=Kf(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function oC(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function SS(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>oC(t)):[oC(e)]}function Zm(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function cC(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function uC(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Pn(e){if(e==null)throw new Error("ContentUnion is required");return Zm(e)?e:{role:"user",parts:SS(e)}}function sx(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(r=>{const n=Pn(r);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(e.isVertexAI()){const r=Pn(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]}return Array.isArray(t)?t.map(r=>Pn(r)):[Pn(t)]}function Xa(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(cC(e)||uC(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Pn(e)]}const t=[],r=[],n=Zm(e[0]);for(const a of e){const s=Zm(a);if(s!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(a);else{if(cC(a)||uC(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return n||t.push({role:"user",parts:SS(r)}),t}function AI(e,t){e.includes("null")&&(t.nullable=!0);const r=e.filter(n=>n!=="null");if(r.length===1)t.type=Object.values(on).includes(r[0].toUpperCase())?r[0].toUpperCase():on.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of r)t.anyOf.push({type:Object.values(on).includes(n.toUpperCase())?n.toUpperCase():on.TYPE_UNSPECIFIED})}}function ro(e){const t={},r=["items"],n=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&AI(e.type,t);for(const[l,o]of Object.entries(e))if(o!=null)if(l=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;t.type=Object.values(on).includes(o.toUpperCase())?o.toUpperCase():on.TYPE_UNSPECIFIED}else if(r.includes(l))t[l]=ro(o);else if(n.includes(l)){const u=[];for(const f of o){if(f.type=="null"){t.nullable=!0;continue}u.push(ro(f))}t[l]=u}else if(a.includes(l)){const u={};for(const[f,d]of Object.entries(o))u[f]=ro(d);t[l]=u}else{if(l==="additionalProperties")continue;t[l]=o}return t}function ix(e){return ro(e)}function lx(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function ox(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function mo(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=ro(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=ro(t.response));return e}function po(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function sI(e,t,r,n=1){const a=!t.startsWith(`${r}/`)&&t.split("/").length===n;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${r}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`:t:a?`${r}/${t}`:t}function is(e,t){if(typeof t!="string")throw new Error("name must be a string");return sI(e,t,"cachedContents")}function TS(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function ei(e){return nx(e)}function iI(e){return e!=null&&typeof e=="object"&&"name"in e}function lI(e){return e!=null&&typeof e=="object"&&"video"in e}function oI(e){return e!=null&&typeof e=="object"&&"uri"in e}function _S(e){var t;let r;if(iI(e)&&(r=e.name),!(oI(e)&&(r=e.uri,r===void 0))&&!(lI(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function bS(e,t){let r;return e.isVertexAI()?r=t?"publishers/google/models":"models":r=t?"models":"tunedModels",r}function FS(e){for(const t of["models","tunedModels","publisherModels"])if(cI(e,t))return e[t];return[]}function cI(e,t){return e!==null&&typeof e=="object"&&t in e}function uI(e,t={}){const r=e,n={name:r.name,description:r.description,parametersJsonSchema:r.inputSchema};return r.outputSchema&&(n.responseJsonSchema=r.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}function fI(e,t={}){const r=[],n=new Set;for(const a of e){const s=a.name;if(n.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);n.add(s);const l=uI(a,t);l.functionDeclarations&&r.push(...l.functionDeclarations)}return{functionDeclarations:r}}function US(e,t){let r;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))r={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;const n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,a=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(a>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||a!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function dI(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function kS(e){if(typeof e!="object"||e===null)return{};const t=e,r=t.inlinedResponses;if(typeof r!="object"||r===null)return e;const a=r.inlinedResponses;if(!Array.isArray(a)||a.length===0)return e;let s=!1;for(const l of a){if(typeof l!="object"||l===null)continue;const u=l.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function xo(e,t){const r=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(r))return r.split("/").pop();throw new Error(`Invalid batch job name: ${r}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(r))return r.split("/").pop();if(/^\d+$/.test(r))return r;throw new Error(`Invalid batch job name: ${r}.`)}function NS(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hI(e){const t={},r=p(e,["responsesFile"]);r!=null&&v(t,["fileName"],r);const n=p(e,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>JI(l))),v(t,["inlinedResponses"],s)}const a=p(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["inlinedEmbedContentResponses"],s)}return t}function gI(e){const t={},r=p(e,["predictionsFormat"]);r!=null&&v(t,["format"],r);const n=p(e,["gcsDestination","outputUriPrefix"]);n!=null&&v(t,["gcsUri"],n);const a=p(e,["bigqueryDestination","outputUri"]);return a!=null&&v(t,["bigqueryUri"],a),t}function mI(e){const t={},r=p(e,["format"]);r!=null&&v(t,["predictionsFormat"],r);const n=p(e,["gcsUri"]);n!=null&&v(t,["gcsDestination","outputUriPrefix"],n);const a=p(e,["bigqueryUri"]);if(a!=null&&v(t,["bigqueryDestination","outputUri"],a),p(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function Rf(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata","displayName"]);n!=null&&v(t,["displayName"],n);const a=p(e,["metadata","state"]);a!=null&&v(t,["state"],NS(a));const s=p(e,["metadata","createTime"]);s!=null&&v(t,["createTime"],s);const l=p(e,["metadata","endTime"]);l!=null&&v(t,["endTime"],l);const o=p(e,["metadata","updateTime"]);o!=null&&v(t,["updateTime"],o);const u=p(e,["metadata","model"]);u!=null&&v(t,["model"],u);const f=p(e,["metadata","output"]);return f!=null&&v(t,["dest"],hI(kS(f))),t}function ep(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["displayName"]);n!=null&&v(t,["displayName"],n);const a=p(e,["state"]);a!=null&&v(t,["state"],NS(a));const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["createTime"]);l!=null&&v(t,["createTime"],l);const o=p(e,["startTime"]);o!=null&&v(t,["startTime"],o);const u=p(e,["endTime"]);u!=null&&v(t,["endTime"],u);const f=p(e,["updateTime"]);f!=null&&v(t,["updateTime"],f);const d=p(e,["model"]);d!=null&&v(t,["model"],d);const m=p(e,["inputConfig"]);m!=null&&v(t,["src"],pI(m));const x=p(e,["outputConfig"]);x!=null&&v(t,["dest"],gI(kS(x)));const y=p(e,["completionStats"]);return y!=null&&v(t,["completionStats"],y),t}function pI(e){const t={},r=p(e,["instancesFormat"]);r!=null&&v(t,["format"],r);const n=p(e,["gcsSource","uris"]);n!=null&&v(t,["gcsUri"],n);const a=p(e,["bigquerySource","inputUri"]);return a!=null&&v(t,["bigqueryUri"],a),t}function xI(e,t){const r={};if(p(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=p(t,["fileName"]);n!=null&&v(r,["fileName"],n);const a=p(t,["inlinedRequests"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>XI(e,l))),v(r,["requests","requests"],s)}return r}function vI(e){const t={},r=p(e,["format"]);r!=null&&v(t,["instancesFormat"],r);const n=p(e,["gcsUri"]);n!=null&&v(t,["gcsSource","uris"],n);const a=p(e,["bigqueryUri"]);if(a!=null&&v(t,["bigquerySource","inputUri"],a),p(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function wI(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function yI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],xo(e,n)),r}function BI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],xo(e,n)),r}function CI(e){const t={},r=p(e,["content"]);r!=null&&v(t,["content"],r);const n=p(e,["citationMetadata"]);n!=null&&v(t,["citationMetadata"],EI(n));const a=p(e,["tokenCount"]);a!=null&&v(t,["tokenCount"],a);const s=p(e,["finishReason"]);s!=null&&v(t,["finishReason"],s);const l=p(e,["avgLogprobs"]);l!=null&&v(t,["avgLogprobs"],l);const o=p(e,["groundingMetadata"]);o!=null&&v(t,["groundingMetadata"],o);const u=p(e,["index"]);u!=null&&v(t,["index"],u);const f=p(e,["logprobsResult"]);f!=null&&v(t,["logprobsResult"],f);const d=p(e,["safetyRatings"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(y=>y)),v(t,["safetyRatings"],x)}const m=p(e,["urlContextMetadata"]);return m!=null&&v(t,["urlContextMetadata"],m),t}function EI(e){const t={},r=p(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>a)),v(t,["citations"],n)}return t}function IS(e){const t={},r=p(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>t3(s))),v(t,["parts"],a)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function SI(e,t){const r={},n=p(e,["displayName"]);if(t!==void 0&&n!=null&&v(t,["batch","displayName"],n),p(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return r}function TI(e,t){const r={},n=p(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const a=p(e,["dest"]);return t!==void 0&&a!=null&&v(t,["outputConfig"],mI(dI(a))),r}function fC(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["src"]);a!=null&&v(r,["batch","inputConfig"],xI(e,US(e,a)));const s=p(t,["config"]);return s!=null&&SI(s,r),r}function _I(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["model"],tr(e,n));const a=p(t,["src"]);a!=null&&v(r,["inputConfig"],vI(US(e,a)));const s=p(t,["config"]);return s!=null&&TI(s,r),r}function bI(e,t){const r={},n=p(e,["displayName"]);return t!==void 0&&n!=null&&v(t,["batch","displayName"],n),r}function FI(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["src"]);a!=null&&v(r,["batch","inputConfig"],DI(e,a));const s=p(t,["config"]);return s!=null&&bI(s,r),r}function UI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],xo(e,n)),r}function kI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],xo(e,n)),r}function NI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);return s!=null&&v(t,["error"],s),t}function II(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);return s!=null&&v(t,["error"],s),t}function QI(e,t){const r={},n=p(t,["contents"]);if(n!=null){let s=sx(e,n);Array.isArray(s)&&(s=s.map(l=>l)),v(r,["requests[]","request","content"],s)}const a=p(t,["config"]);return a!=null&&(v(r,["_self"],RI(a,r)),kN(r,{"requests[].*":"requests[].request.*"})),r}function RI(e,t){const r={},n=p(e,["taskType"]);t!==void 0&&n!=null&&v(t,["requests[]","taskType"],n);const a=p(e,["title"]);t!==void 0&&a!=null&&v(t,["requests[]","title"],a);const s=p(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&v(t,["requests[]","outputDimensionality"],s),p(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function DI(e,t){const r={},n=p(t,["fileName"]);n!=null&&v(r,["file_name"],n);const a=p(t,["inlinedRequests"]);return a!=null&&v(r,["requests"],QI(e,a)),r}function MI(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function LI(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const a=p(e,["name"]);if(a!=null&&v(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function HI(e){const t={},r=p(e,["allowedFunctionNames"]);r!=null&&v(t,["allowedFunctionNames"],r);const n=p(e,["mode"]);if(n!=null&&v(t,["mode"],n),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function OI(e,t,r){const n={},a=p(t,["systemInstruction"]);r!==void 0&&a!=null&&v(r,["systemInstruction"],IS(Pn(a)));const s=p(t,["temperature"]);s!=null&&v(n,["temperature"],s);const l=p(t,["topP"]);l!=null&&v(n,["topP"],l);const o=p(t,["topK"]);o!=null&&v(n,["topK"],o);const u=p(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=p(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=p(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const m=p(t,["responseLogprobs"]);m!=null&&v(n,["responseLogprobs"],m);const x=p(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=p(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const E=p(t,["frequencyPenalty"]);E!=null&&v(n,["frequencyPenalty"],E);const C=p(t,["seed"]);C!=null&&v(n,["seed"],C);const S=p(t,["responseMimeType"]);S!=null&&v(n,["responseMimeType"],S);const T=p(t,["responseSchema"]);T!=null&&v(n,["responseSchema"],ix(T));const F=p(t,["responseJsonSchema"]);if(F!=null&&v(n,["responseJsonSchema"],F),p(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=p(t,["safetySettings"]);if(r!==void 0&&_!=null){let ae=_;Array.isArray(ae)&&(ae=ae.map(Te=>r3(Te))),v(r,["safetySettings"],ae)}const Q=p(t,["tools"]);if(r!==void 0&&Q!=null){let ae=po(Q);Array.isArray(ae)&&(ae=ae.map(Te=>a3(mo(Te)))),v(r,["tools"],ae)}const L=p(t,["toolConfig"]);if(r!==void 0&&L!=null&&v(r,["toolConfig"],n3(L)),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=p(t,["cachedContent"]);r!==void 0&&R!=null&&v(r,["cachedContent"],is(e,R));const U=p(t,["responseModalities"]);U!=null&&v(n,["responseModalities"],U);const K=p(t,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const D=p(t,["speechConfig"]);if(D!=null&&v(n,["speechConfig"],lx(D)),p(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ee=p(t,["thinkingConfig"]);ee!=null&&v(n,["thinkingConfig"],ee);const re=p(t,["imageConfig"]);re!=null&&v(n,["imageConfig"],zI(re));const Z=p(t,["enableEnhancedCivicAnswers"]);if(Z!=null&&v(n,["enableEnhancedCivicAnswers"],Z),p(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function PI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>CI(f))),v(t,["candidates"],u)}const a=p(e,["modelVersion"]);a!=null&&v(t,["modelVersion"],a);const s=p(e,["promptFeedback"]);s!=null&&v(t,["promptFeedback"],s);const l=p(e,["responseId"]);l!=null&&v(t,["responseId"],l);const o=p(e,["usageMetadata"]);return o!=null&&v(t,["usageMetadata"],o),t}function GI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],xo(e,n)),r}function VI(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],xo(e,n)),r}function KI(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function jI(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function zI(e){const t={},r=p(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=p(e,["imageSize"]);if(n!=null&&v(t,["imageSize"],n),p(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function XI(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["request","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let o=Xa(a);Array.isArray(o)&&(o=o.map(u=>IS(u))),v(r,["request","contents"],o)}const s=p(t,["metadata"]);s!=null&&v(r,["metadata"],s);const l=p(t,["config"]);return l!=null&&v(r,["request","generationConfig"],OI(e,l,p(r,["request"],{}))),r}function JI(e){const t={},r=p(e,["response"]);r!=null&&v(t,["response"],PI(r));const n=p(e,["error"]);return n!=null&&v(t,["error"],n),t}function WI(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);if(t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),p(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return r}function YI(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);t!==void 0&&a!=null&&v(t,["_query","pageToken"],a);const s=p(e,["filter"]);return t!==void 0&&s!=null&&v(t,["_query","filter"],s),r}function qI(e){const t={},r=p(e,["config"]);return r!=null&&WI(r,t),t}function $I(e){const t={},r=p(e,["config"]);return r!=null&&YI(r,t),t}function ZI(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["operations"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>Rf(l))),v(t,["batchJobs"],s)}return t}function e3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["batchPredictionJobs"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>ep(l))),v(t,["batchJobs"],s)}return t}function t3(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=p(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],MI(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],LI(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],wI(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function r3(e){const t={},r=p(e,["category"]);if(r!=null&&v(t,["category"],r),p(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=p(e,["threshold"]);return n!=null&&v(t,["threshold"],n),t}function n3(e){const t={},r=p(e,["retrievalConfig"]);r!=null&&v(t,["retrievalConfig"],r);const n=p(e,["functionCallingConfig"]);return n!=null&&v(t,["functionCallingConfig"],HI(n)),t}function a3(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=p(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=p(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=p(e,["codeExecution"]);if(a!=null&&v(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=p(e,["functionDeclarations"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}const l=p(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],KI(l));const o=p(e,["googleSearch"]);o!=null&&v(t,["googleSearch"],jI(o));const u=p(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var rs;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(rs||(rs={}));class Wi{constructor(t,r,n,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=r,this.init(t,n,a)}init(t,r,n){var a,s;this.nameInternal=t,this.pageInternal=r[this.nameInternal]||[],this.sdkHttpResponseInternal=r==null?void 0:r.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=r.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class A3 extends ss{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new Wi(rs.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.create=async r=>(this.apiClient.isVertexAI()&&(r.config=this.formatDestination(r.src,r.config)),this.createInternal(r)),this.createEmbeddings=async r=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(r)}}createInlinedGenerateContentRequest(t){const r=fC(this.apiClient,t),n=r._url,a=qe("{model}:batchGenerateContent",n),o=r.batch.inputConfig.requests,u=o.requests,f=[];for(const d of u){const m=Object.assign({},d);if(m.systemInstruction){const x=m.systemInstruction;delete m.systemInstruction;const y=m.request;y.systemInstruction=x,m.request=y}f.push(m)}return o.requests=f,delete r.config,delete r._url,delete r._query,{path:a,body:r}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,r){const n=r?Object.assign({},r):{},a=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${a}`),n.dest===void 0){const s=this.getGcsUri(t),l=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?n.dest=`${s.slice(0,-6)}/dest`:n.dest=`${s}_dest_${a}`;else if(l)n.dest=`${l}_dest_${a}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=_I(this.apiClient,t);return o=qe("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>ep(d))}else{const f=fC(this.apiClient,t);return o=qe("{model}:batchGenerateContent",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>Rf(d))}}async createEmbeddingsInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=FI(this.apiClient,t);return s=qe("{model}:asyncBatchEmbedContent",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>Rf(u))}}async get(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=VI(this.apiClient,t);return o=qe("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>ep(d))}else{const f=GI(this.apiClient,t);return o=qe("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>Rf(d))}}async cancel(t){var r,n,a,s;let l="",o={};if(this.apiClient.isVertexAI()){const u=BI(this.apiClient,t);l=qe("batchPredictionJobs/{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const u=yI(this.apiClient,t);l=qe("batches/{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=$I(t);return o=qe("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=e3(d),x=new lC;return Object.assign(x,m),x})}else{const f=qI(t);return o=qe("batches",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=ZI(d),x=new lC;return Object.assign(x,m),x})}}async delete(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=kI(this.apiClient,t);return o=qe("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>II(d))}else{const f=UI(this.apiClient,t);return o=qe("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>NI(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function s3(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function dC(e){const t={},r=p(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>F3(s))),v(t,["parts"],a)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function i3(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=p(e,["expireTime"]);t!==void 0&&a!=null&&v(t,["expireTime"],a);const s=p(e,["displayName"]);t!==void 0&&s!=null&&v(t,["displayName"],s);const l=p(e,["contents"]);if(t!==void 0&&l!=null){let d=Xa(l);Array.isArray(d)&&(d=d.map(m=>dC(m))),v(t,["contents"],d)}const o=p(e,["systemInstruction"]);t!==void 0&&o!=null&&v(t,["systemInstruction"],dC(Pn(o)));const u=p(e,["tools"]);if(t!==void 0&&u!=null){let d=u;Array.isArray(d)&&(d=d.map(m=>k3(m))),v(t,["tools"],d)}const f=p(e,["toolConfig"]);if(t!==void 0&&f!=null&&v(t,["toolConfig"],U3(f)),p(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function l3(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=p(e,["expireTime"]);t!==void 0&&a!=null&&v(t,["expireTime"],a);const s=p(e,["displayName"]);t!==void 0&&s!=null&&v(t,["displayName"],s);const l=p(e,["contents"]);if(t!==void 0&&l!=null){let m=Xa(l);Array.isArray(m)&&(m=m.map(x=>x)),v(t,["contents"],m)}const o=p(e,["systemInstruction"]);t!==void 0&&o!=null&&v(t,["systemInstruction"],Pn(o));const u=p(e,["tools"]);if(t!==void 0&&u!=null){let m=u;Array.isArray(m)&&(m=m.map(x=>N3(x))),v(t,["tools"],m)}const f=p(e,["toolConfig"]);t!==void 0&&f!=null&&v(t,["toolConfig"],f);const d=p(e,["kmsKeyName"]);return t!==void 0&&d!=null&&v(t,["encryption_spec","kmsKeyName"],d),r}function o3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["model"],yS(e,n));const a=p(t,["config"]);return a!=null&&i3(a,r),r}function c3(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["model"],yS(e,n));const a=p(t,["config"]);return a!=null&&l3(a,r),r}function u3(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],is(e,n)),r}function f3(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],is(e,n)),r}function d3(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function h3(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function g3(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function m3(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const a=p(e,["name"]);if(a!=null&&v(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function p3(e){const t={},r=p(e,["allowedFunctionNames"]);r!=null&&v(t,["allowedFunctionNames"],r);const n=p(e,["mode"]);if(n!=null&&v(t,["mode"],n),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function x3(e){const t={},r=p(e,["description"]);r!=null&&v(t,["description"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const a=p(e,["parameters"]);a!=null&&v(t,["parameters"],a);const s=p(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const l=p(e,["response"]);l!=null&&v(t,["response"],l);const o=p(e,["responseJsonSchema"]);if(o!=null&&v(t,["responseJsonSchema"],o),p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function v3(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],is(e,n)),r}function w3(e,t){const r={},n=p(t,["name"]);return n!=null&&v(r,["_url","name"],is(e,n)),r}function y3(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function B3(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function C3(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function E3(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function S3(e){const t={},r=p(e,["config"]);return r!=null&&C3(r,t),t}function T3(e){const t={},r=p(e,["config"]);return r!=null&&E3(r,t),t}function _3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["cachedContents"],s)}return t}function b3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["cachedContents"],s)}return t}function F3(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=p(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],g3(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],m3(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],s3(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function U3(e){const t={},r=p(e,["retrievalConfig"]);r!=null&&v(t,["retrievalConfig"],r);const n=p(e,["functionCallingConfig"]);return n!=null&&v(t,["functionCallingConfig"],p3(n)),t}function k3(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=p(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=p(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=p(e,["codeExecution"]);if(a!=null&&v(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=p(e,["functionDeclarations"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}const l=p(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],y3(l));const o=p(e,["googleSearch"]);o!=null&&v(t,["googleSearch"],B3(o));const u=p(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}function N3(e){const t={},r=p(e,["retrieval"]);r!=null&&v(t,["retrieval"],r);const n=p(e,["computerUse"]);if(n!=null&&v(t,["computerUse"],n),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=p(e,["codeExecution"]);a!=null&&v(t,["codeExecution"],a);const s=p(e,["enterpriseWebSearch"]);s!=null&&v(t,["enterpriseWebSearch"],s);const l=p(e,["functionDeclarations"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(x=>x3(x))),v(t,["functionDeclarations"],m)}const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],o);const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],u);const f=p(e,["googleSearchRetrieval"]);f!=null&&v(t,["googleSearchRetrieval"],f);const d=p(e,["urlContext"]);return d!=null&&v(t,["urlContext"],d),t}function I3(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=p(e,["expireTime"]);return t!==void 0&&a!=null&&v(t,["expireTime"],a),r}function Q3(e,t){const r={},n=p(e,["ttl"]);t!==void 0&&n!=null&&v(t,["ttl"],n);const a=p(e,["expireTime"]);return t!==void 0&&a!=null&&v(t,["expireTime"],a),r}function R3(e,t){const r={},n=p(t,["name"]);n!=null&&v(r,["_url","name"],is(e,n));const a=p(t,["config"]);return a!=null&&I3(a,r),r}function D3(e,t){const r={},n=p(t,["name"]);n!=null&&v(r,["_url","name"],is(e,n));const a=p(t,["config"]);return a!=null&&Q3(a,r),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M3 extends ss{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new Wi(rs.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(r),r)}async create(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=c3(this.apiClient,t);return o=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>d)}else{const f=o3(this.apiClient,t);return o=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>d)}}async get(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=w3(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>d)}else{const f=v3(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>d)}}async delete(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=f3(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=h3(d),x=new sC;return Object.assign(x,m),x})}else{const f=u3(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=d3(d),x=new sC;return Object.assign(x,m),x})}}async update(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=D3(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>d)}else{const f=R3(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>d)}}async listInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=T3(t);return o=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=b3(d),x=new iC;return Object.assign(x,m),x})}else{const f=S3(t);return o=qe("cachedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=_3(d),x=new iC;return Object.assign(x,m),x})}}}function jf(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function hC(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function St(e){return this instanceof St?(this.v=e,this):new St(e)}function sA(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(y){return function(E){return Promise.resolve(E).then(y,m)}}function o(y,E){n[y]&&(a[y]=function(C){return new Promise(function(S,T){s.push([y,C,S,T])>1||u(y,C)})},E&&(a[y]=E(a[y])))}function u(y,E){try{f(n[y](E))}catch(C){x(s[0][3],C)}}function f(y){y.value instanceof St?Promise.resolve(y.value.v).then(d,m):x(s[0][2],y)}function d(y){u("next",y)}function m(y){u("throw",y)}function x(y,E){y(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function iA(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof hC=="function"?hC(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(l){return new Promise(function(o,u){l=e[s](l),a(o,u,l.done,l.value)})}}function a(s,l,o,u){Promise.resolve(u).then(function(f){s({value:f,done:o})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L3(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const r=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return r===void 0?!1:QS(r)}function QS(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function H3(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function gC(e){if(e===void 0||e.length===0)return[];const t=[],r=e.length;let n=0;for(;n<r;)if(e[n].role==="user")t.push(e[n]),n++;else{const a=[];let s=!0;for(;n<r&&e[n].role==="model";)a.push(e[n]),s&&!QS(e[n])&&(s=!1),n++;s?t.push(...a):t.pop()}return t}class O3{constructor(t,r){this.modelsModule=t,this.apiClient=r}create(t){return new P3(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class P3{constructor(t,r,n,a={},s=[]){this.apiClient=t,this.modelsModule=r,this.model=n,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),H3(s)}async sendMessage(t){var r;await this.sendPromise;const n=Pn(t.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});return this.sendPromise=(async()=>{var s,l,o;const u=await a,f=(l=(s=u.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,d=u.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let x=[];d!=null&&(x=(o=d.slice(m))!==null&&o!==void 0?o:[]);const y=f?[f]:[];this.recordHistory(n,y,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(t){var r;await this.sendPromise;const n=Pn(t.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,n)}getHistory(t=!1){const r=t?gC(this.history):this.history;return structuredClone(r)}processStreamResponse(t,r){return sA(this,arguments,function*(){var a,s,l,o,u,f;const d=[];try{for(var m=!0,x=iA(t),y;y=yield St(x.next()),a=y.done,!a;m=!0){o=y.value,m=!1;const E=o;if(L3(E)){const C=(f=(u=E.candidates)===null||u===void 0?void 0:u[0])===null||f===void 0?void 0:f.content;C!==void 0&&d.push(C)}yield yield St(E)}}catch(E){s={error:E}}finally{try{!m&&!a&&(l=x.return)&&(yield St(l.call(x)))}finally{if(s)throw s.error}}this.recordHistory(r,d)})}recordHistory(t,r,n){let a=[];r.length>0&&r.every(s=>s.role!==void 0)?a=r:a.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...gC(n)):this.history.push(t),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $c extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,$c.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G3(e){const t={},r=p(e,["file"]);return r!=null&&v(t,["file"],r),t}function V3(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function K3(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","file"],_S(r)),t}function j3(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function z3(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","file"],_S(r)),t}function X3(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function J3(e){const t={},r=p(e,["config"]);return r!=null&&X3(r,t),t}function W3(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["files"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Y3 extends ss{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new Wi(rs.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(r),r)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(r=>r)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=J3(t);return s=qe("files",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=W3(u),d=new eI;return Object.assign(d,f),d})}}async createInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=G3(t);return s=qe("upload/v1beta/files",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=V3(u),d=new tI;return Object.assign(d,f),d})}}async get(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=z3(t);return s=qe("files/{file}",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=K3(t);return s=qe("files/{file}",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=j3(u),d=new rI;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Df(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function q3(e){const t={},r=p(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>dQ(s))),v(t,["parts"],a)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function $3(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function Z3(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const a=p(e,["name"]);if(a!=null&&v(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function eQ(e){const t={},r=p(e,["description"]);r!=null&&v(t,["description"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const a=p(e,["parameters"]);a!=null&&v(t,["parameters"],a);const s=p(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const l=p(e,["response"]);l!=null&&v(t,["response"],l);const o=p(e,["responseJsonSchema"]);if(o!=null&&v(t,["responseJsonSchema"],o),p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function tQ(e){const t={},r=p(e,["modelSelectionConfig"]);r!=null&&v(t,["modelConfig"],r);const n=p(e,["responseJsonSchema"]);n!=null&&v(t,["responseJsonSchema"],n);const a=p(e,["audioTimestamp"]);a!=null&&v(t,["audioTimestamp"],a);const s=p(e,["candidateCount"]);s!=null&&v(t,["candidateCount"],s);const l=p(e,["enableAffectiveDialog"]);l!=null&&v(t,["enableAffectiveDialog"],l);const o=p(e,["frequencyPenalty"]);o!=null&&v(t,["frequencyPenalty"],o);const u=p(e,["logprobs"]);u!=null&&v(t,["logprobs"],u);const f=p(e,["maxOutputTokens"]);f!=null&&v(t,["maxOutputTokens"],f);const d=p(e,["mediaResolution"]);d!=null&&v(t,["mediaResolution"],d);const m=p(e,["presencePenalty"]);m!=null&&v(t,["presencePenalty"],m);const x=p(e,["responseLogprobs"]);x!=null&&v(t,["responseLogprobs"],x);const y=p(e,["responseMimeType"]);y!=null&&v(t,["responseMimeType"],y);const E=p(e,["responseModalities"]);E!=null&&v(t,["responseModalities"],E);const C=p(e,["responseSchema"]);C!=null&&v(t,["responseSchema"],C);const S=p(e,["routingConfig"]);S!=null&&v(t,["routingConfig"],S);const T=p(e,["seed"]);T!=null&&v(t,["seed"],T);const F=p(e,["speechConfig"]);F!=null&&v(t,["speechConfig"],F);const _=p(e,["stopSequences"]);_!=null&&v(t,["stopSequences"],_);const Q=p(e,["temperature"]);Q!=null&&v(t,["temperature"],Q);const L=p(e,["thinkingConfig"]);L!=null&&v(t,["thinkingConfig"],L);const R=p(e,["topK"]);R!=null&&v(t,["topK"],R);const U=p(e,["topP"]);if(U!=null&&v(t,["topP"],U),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function rQ(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function nQ(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function aQ(e,t){const r={},n=p(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],n);const a=p(e,["responseModalities"]);t!==void 0&&a!=null&&v(t,["setup","generationConfig","responseModalities"],a);const s=p(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const l=p(e,["topP"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topP"],l);const o=p(e,["topK"]);t!==void 0&&o!=null&&v(t,["setup","generationConfig","topK"],o);const u=p(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=p(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const m=p(e,["speechConfig"]);t!==void 0&&m!=null&&v(t,["setup","generationConfig","speechConfig"],ox(m));const x=p(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=p(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const E=p(e,["systemInstruction"]);t!==void 0&&E!=null&&v(t,["setup","systemInstruction"],q3(Pn(E)));const C=p(e,["tools"]);if(t!==void 0&&C!=null){let R=po(C);Array.isArray(R)&&(R=R.map(U=>gQ(mo(U)))),v(t,["setup","tools"],R)}const S=p(e,["sessionResumption"]);t!==void 0&&S!=null&&v(t,["setup","sessionResumption"],hQ(S));const T=p(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&v(t,["setup","inputAudioTranscription"],T);const F=p(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const _=p(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&v(t,["setup","realtimeInputConfig"],_);const Q=p(e,["contextWindowCompression"]);t!==void 0&&Q!=null&&v(t,["setup","contextWindowCompression"],Q);const L=p(e,["proactivity"]);if(t!==void 0&&L!=null&&v(t,["setup","proactivity"],L),p(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return r}function AQ(e,t){const r={},n=p(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],tQ(n));const a=p(e,["responseModalities"]);t!==void 0&&a!=null&&v(t,["setup","generationConfig","responseModalities"],a);const s=p(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const l=p(e,["topP"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topP"],l);const o=p(e,["topK"]);t!==void 0&&o!=null&&v(t,["setup","generationConfig","topK"],o);const u=p(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=p(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const m=p(e,["speechConfig"]);t!==void 0&&m!=null&&v(t,["setup","generationConfig","speechConfig"],ox(m));const x=p(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=p(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const E=p(e,["systemInstruction"]);t!==void 0&&E!=null&&v(t,["setup","systemInstruction"],Pn(E));const C=p(e,["tools"]);if(t!==void 0&&C!=null){let U=po(C);Array.isArray(U)&&(U=U.map(K=>mQ(mo(K)))),v(t,["setup","tools"],U)}const S=p(e,["sessionResumption"]);t!==void 0&&S!=null&&v(t,["setup","sessionResumption"],S);const T=p(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&v(t,["setup","inputAudioTranscription"],T);const F=p(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const _=p(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&v(t,["setup","realtimeInputConfig"],_);const Q=p(e,["contextWindowCompression"]);t!==void 0&&Q!=null&&v(t,["setup","contextWindowCompression"],Q);const L=p(e,["proactivity"]);t!==void 0&&L!=null&&v(t,["setup","proactivity"],L);const R=p(e,["explicitVadSignal"]);return t!==void 0&&R!=null&&v(t,["setup","explicitVadSignal"],R),r}function sQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["setup","model"],tr(e,n));const a=p(t,["config"]);return a!=null&&v(r,["config"],aQ(a,r)),r}function iQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["setup","model"],tr(e,n));const a=p(t,["config"]);return a!=null&&v(r,["config"],AQ(a,r)),r}function lQ(e){const t={},r=p(e,["musicGenerationConfig"]);return r!=null&&v(t,["musicGenerationConfig"],r),t}function oQ(e){const t={},r=p(e,["weightedPrompts"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>a)),v(t,["weightedPrompts"],n)}return t}function cQ(e){const t={},r=p(e,["media"]);if(r!=null){let f=BS(r);Array.isArray(f)&&(f=f.map(d=>Df(d))),v(t,["mediaChunks"],f)}const n=p(e,["audio"]);n!=null&&v(t,["audio"],Df(ES(n)));const a=p(e,["audioStreamEnd"]);a!=null&&v(t,["audioStreamEnd"],a);const s=p(e,["video"]);s!=null&&v(t,["video"],Df(CS(s)));const l=p(e,["text"]);l!=null&&v(t,["text"],l);const o=p(e,["activityStart"]);o!=null&&v(t,["activityStart"],o);const u=p(e,["activityEnd"]);return u!=null&&v(t,["activityEnd"],u),t}function uQ(e){const t={},r=p(e,["media"]);if(r!=null){let f=BS(r);Array.isArray(f)&&(f=f.map(d=>d)),v(t,["mediaChunks"],f)}const n=p(e,["audio"]);n!=null&&v(t,["audio"],ES(n));const a=p(e,["audioStreamEnd"]);a!=null&&v(t,["audioStreamEnd"],a);const s=p(e,["video"]);s!=null&&v(t,["video"],CS(s));const l=p(e,["text"]);l!=null&&v(t,["text"],l);const o=p(e,["activityStart"]);o!=null&&v(t,["activityStart"],o);const u=p(e,["activityEnd"]);return u!=null&&v(t,["activityEnd"],u),t}function fQ(e){const t={},r=p(e,["setupComplete"]);r!=null&&v(t,["setupComplete"],r);const n=p(e,["serverContent"]);n!=null&&v(t,["serverContent"],n);const a=p(e,["toolCall"]);a!=null&&v(t,["toolCall"],a);const s=p(e,["toolCallCancellation"]);s!=null&&v(t,["toolCallCancellation"],s);const l=p(e,["usageMetadata"]);l!=null&&v(t,["usageMetadata"],pQ(l));const o=p(e,["goAway"]);o!=null&&v(t,["goAway"],o);const u=p(e,["sessionResumptionUpdate"]);u!=null&&v(t,["sessionResumptionUpdate"],u);const f=p(e,["voiceActivityDetectionSignal"]);f!=null&&v(t,["voiceActivityDetectionSignal"],f);const d=p(e,["voiceActivity"]);return d!=null&&v(t,["voiceActivity"],xQ(d)),t}function dQ(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=p(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],$3(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],Z3(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],Df(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function hQ(e){const t={},r=p(e,["handle"]);if(r!=null&&v(t,["handle"],r),p(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function gQ(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=p(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=p(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=p(e,["codeExecution"]);if(a!=null&&v(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=p(e,["functionDeclarations"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}const l=p(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],rQ(l));const o=p(e,["googleSearch"]);o!=null&&v(t,["googleSearch"],nQ(o));const u=p(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}function mQ(e){const t={},r=p(e,["retrieval"]);r!=null&&v(t,["retrieval"],r);const n=p(e,["computerUse"]);if(n!=null&&v(t,["computerUse"],n),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=p(e,["codeExecution"]);a!=null&&v(t,["codeExecution"],a);const s=p(e,["enterpriseWebSearch"]);s!=null&&v(t,["enterpriseWebSearch"],s);const l=p(e,["functionDeclarations"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(x=>eQ(x))),v(t,["functionDeclarations"],m)}const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],o);const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],u);const f=p(e,["googleSearchRetrieval"]);f!=null&&v(t,["googleSearchRetrieval"],f);const d=p(e,["urlContext"]);return d!=null&&v(t,["urlContext"],d),t}function pQ(e){const t={},r=p(e,["promptTokenCount"]);r!=null&&v(t,["promptTokenCount"],r);const n=p(e,["cachedContentTokenCount"]);n!=null&&v(t,["cachedContentTokenCount"],n);const a=p(e,["candidatesTokenCount"]);a!=null&&v(t,["responseTokenCount"],a);const s=p(e,["toolUsePromptTokenCount"]);s!=null&&v(t,["toolUsePromptTokenCount"],s);const l=p(e,["thoughtsTokenCount"]);l!=null&&v(t,["thoughtsTokenCount"],l);const o=p(e,["totalTokenCount"]);o!=null&&v(t,["totalTokenCount"],o);const u=p(e,["promptTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(E=>E)),v(t,["promptTokensDetails"],y)}const f=p(e,["cacheTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(E=>E)),v(t,["cacheTokensDetails"],y)}const d=p(e,["candidatesTokensDetails"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(E=>E)),v(t,["responseTokensDetails"],y)}const m=p(e,["toolUsePromptTokensDetails"]);if(m!=null){let y=m;Array.isArray(y)&&(y=y.map(E=>E)),v(t,["toolUsePromptTokensDetails"],y)}const x=p(e,["trafficType"]);return x!=null&&v(t,["trafficType"],x),t}function xQ(e){const t={},r=p(e,["type"]);return r!=null&&v(t,["voiceActivityType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vQ(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function wQ(e){const t={},r=p(e,["content"]);r!=null&&v(t,["content"],r);const n=p(e,["citationMetadata"]);n!=null&&v(t,["citationMetadata"],yQ(n));const a=p(e,["tokenCount"]);a!=null&&v(t,["tokenCount"],a);const s=p(e,["finishReason"]);s!=null&&v(t,["finishReason"],s);const l=p(e,["avgLogprobs"]);l!=null&&v(t,["avgLogprobs"],l);const o=p(e,["groundingMetadata"]);o!=null&&v(t,["groundingMetadata"],o);const u=p(e,["index"]);u!=null&&v(t,["index"],u);const f=p(e,["logprobsResult"]);f!=null&&v(t,["logprobsResult"],f);const d=p(e,["safetyRatings"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(y=>y)),v(t,["safetyRatings"],x)}const m=p(e,["urlContextMetadata"]);return m!=null&&v(t,["urlContextMetadata"],m),t}function yQ(e){const t={},r=p(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>a)),v(t,["citations"],n)}return t}function BQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let s=Xa(a);Array.isArray(s)&&(s=s.map(l=>l)),v(r,["contents"],s)}return r}function CQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["tokensInfo"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>s)),v(t,["tokensInfo"],a)}return t}function EQ(e){const t={},r=p(e,["values"]);r!=null&&v(t,["values"],r);const n=p(e,["statistics"]);return n!=null&&v(t,["statistics"],SQ(n)),t}function SQ(e){const t={},r=p(e,["truncated"]);r!=null&&v(t,["truncated"],r);const n=p(e,["token_count"]);return n!=null&&v(t,["tokenCount"],n),t}function wd(e){const t={},r=p(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>QR(s))),v(t,["parts"],a)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function TQ(e){const t={},r=p(e,["controlType"]);r!=null&&v(t,["controlType"],r);const n=p(e,["enableControlImageComputation"]);return n!=null&&v(t,["computeControl"],n),t}function _Q(e){const t={};if(p(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function bQ(e,t){const r={},n=p(e,["systemInstruction"]);t!==void 0&&n!=null&&v(t,["systemInstruction"],Pn(n));const a=p(e,["tools"]);if(t!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>LS(o))),v(t,["tools"],l)}const s=p(e,["generationConfig"]);return t!==void 0&&s!=null&&v(t,["generationConfig"],vR(s)),r}function FQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let l=Xa(a);Array.isArray(l)&&(l=l.map(o=>wd(o))),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&_Q(s),r}function UQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let l=Xa(a);Array.isArray(l)&&(l=l.map(o=>o)),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&bQ(s,r),r}function kQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["totalTokens"]);n!=null&&v(t,["totalTokens"],n);const a=p(e,["cachedContentTokenCount"]);return a!=null&&v(t,["cachedContentTokenCount"],a),t}function NQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["totalTokens"]);return n!=null&&v(t,["totalTokens"],n),t}function IQ(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],tr(e,n)),r}function QQ(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],tr(e,n)),r}function RQ(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function DQ(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}function MQ(e,t){const r={},n=p(e,["outputGcsUri"]);t!==void 0&&n!=null&&v(t,["parameters","storageUri"],n);const a=p(e,["negativePrompt"]);t!==void 0&&a!=null&&v(t,["parameters","negativePrompt"],a);const s=p(e,["numberOfImages"]);t!==void 0&&s!=null&&v(t,["parameters","sampleCount"],s);const l=p(e,["aspectRatio"]);t!==void 0&&l!=null&&v(t,["parameters","aspectRatio"],l);const o=p(e,["guidanceScale"]);t!==void 0&&o!=null&&v(t,["parameters","guidanceScale"],o);const u=p(e,["seed"]);t!==void 0&&u!=null&&v(t,["parameters","seed"],u);const f=p(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&v(t,["parameters","safetySetting"],f);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&v(t,["parameters","personGeneration"],d);const m=p(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&v(t,["parameters","includeSafetyAttributes"],m);const x=p(e,["includeRaiReason"]);t!==void 0&&x!=null&&v(t,["parameters","includeRaiReason"],x);const y=p(e,["language"]);t!==void 0&&y!=null&&v(t,["parameters","language"],y);const E=p(e,["outputMimeType"]);t!==void 0&&E!=null&&v(t,["parameters","outputOptions","mimeType"],E);const C=p(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&v(t,["parameters","outputOptions","compressionQuality"],C);const S=p(e,["addWatermark"]);t!==void 0&&S!=null&&v(t,["parameters","addWatermark"],S);const T=p(e,["labels"]);t!==void 0&&T!=null&&v(t,["labels"],T);const F=p(e,["editMode"]);t!==void 0&&F!=null&&v(t,["parameters","editMode"],F);const _=p(e,["baseSteps"]);return t!==void 0&&_!=null&&v(t,["parameters","editConfig","baseSteps"],_),r}function LQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["prompt"]);a!=null&&v(r,["instances[0]","prompt"],a);const s=p(t,["referenceImages"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>OR(u))),v(r,["instances[0]","referenceImages"],o)}const l=p(t,["config"]);return l!=null&&MQ(l,r),r}function HQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>yd(s))),v(t,["generatedImages"],a)}return t}function OQ(e,t){const r={},n=p(e,["taskType"]);t!==void 0&&n!=null&&v(t,["requests[]","taskType"],n);const a=p(e,["title"]);t!==void 0&&a!=null&&v(t,["requests[]","title"],a);const s=p(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&v(t,["requests[]","outputDimensionality"],s),p(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function PQ(e,t){const r={},n=p(e,["taskType"]);t!==void 0&&n!=null&&v(t,["instances[]","task_type"],n);const a=p(e,["title"]);t!==void 0&&a!=null&&v(t,["instances[]","title"],a);const s=p(e,["outputDimensionality"]);t!==void 0&&s!=null&&v(t,["parameters","outputDimensionality"],s);const l=p(e,["mimeType"]);t!==void 0&&l!=null&&v(t,["instances[]","mimeType"],l);const o=p(e,["autoTruncate"]);return t!==void 0&&o!=null&&v(t,["parameters","autoTruncate"],o),r}function GQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let o=sx(e,a);Array.isArray(o)&&(o=o.map(u=>u)),v(r,["requests[]","content"],o)}const s=p(t,["config"]);s!=null&&OQ(s,r);const l=p(t,["model"]);return l!==void 0&&v(r,["requests[]","model"],tr(e,l)),r}function VQ(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let l=sx(e,a);Array.isArray(l)&&(l=l.map(o=>o)),v(r,["instances[]","content"],l)}const s=p(t,["config"]);return s!=null&&PQ(s,r),r}function KQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["embeddings"],s)}const a=p(e,["metadata"]);return a!=null&&v(t,["metadata"],a),t}function jQ(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>EQ(l))),v(t,["embeddings"],s)}const a=p(e,["metadata"]);return a!=null&&v(t,["metadata"],a),t}function zQ(e){const t={},r=p(e,["endpoint"]);r!=null&&v(t,["name"],r);const n=p(e,["deployedModelId"]);return n!=null&&v(t,["deployedModelId"],n),t}function XQ(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function JQ(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const a=p(e,["name"]);if(a!=null&&v(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function WQ(e){const t={},r=p(e,["allowedFunctionNames"]);r!=null&&v(t,["allowedFunctionNames"],r);const n=p(e,["mode"]);if(n!=null&&v(t,["mode"],n),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function YQ(e){const t={},r=p(e,["description"]);r!=null&&v(t,["description"],r);const n=p(e,["name"]);n!=null&&v(t,["name"],n);const a=p(e,["parameters"]);a!=null&&v(t,["parameters"],a);const s=p(e,["parametersJsonSchema"]);s!=null&&v(t,["parametersJsonSchema"],s);const l=p(e,["response"]);l!=null&&v(t,["response"],l);const o=p(e,["responseJsonSchema"]);if(o!=null&&v(t,["responseJsonSchema"],o),p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function qQ(e,t,r){const n={},a=p(t,["systemInstruction"]);r!==void 0&&a!=null&&v(r,["systemInstruction"],wd(Pn(a)));const s=p(t,["temperature"]);s!=null&&v(n,["temperature"],s);const l=p(t,["topP"]);l!=null&&v(n,["topP"],l);const o=p(t,["topK"]);o!=null&&v(n,["topK"],o);const u=p(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=p(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=p(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const m=p(t,["responseLogprobs"]);m!=null&&v(n,["responseLogprobs"],m);const x=p(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=p(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const E=p(t,["frequencyPenalty"]);E!=null&&v(n,["frequencyPenalty"],E);const C=p(t,["seed"]);C!=null&&v(n,["seed"],C);const S=p(t,["responseMimeType"]);S!=null&&v(n,["responseMimeType"],S);const T=p(t,["responseSchema"]);T!=null&&v(n,["responseSchema"],ix(T));const F=p(t,["responseJsonSchema"]);if(F!=null&&v(n,["responseJsonSchema"],F),p(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=p(t,["safetySettings"]);if(r!==void 0&&_!=null){let ae=_;Array.isArray(ae)&&(ae=ae.map(Te=>PR(Te))),v(r,["safetySettings"],ae)}const Q=p(t,["tools"]);if(r!==void 0&&Q!=null){let ae=po(Q);Array.isArray(ae)&&(ae=ae.map(Te=>JR(mo(Te)))),v(r,["tools"],ae)}const L=p(t,["toolConfig"]);if(r!==void 0&&L!=null&&v(r,["toolConfig"],XR(L)),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=p(t,["cachedContent"]);r!==void 0&&R!=null&&v(r,["cachedContent"],is(e,R));const U=p(t,["responseModalities"]);U!=null&&v(n,["responseModalities"],U);const K=p(t,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const D=p(t,["speechConfig"]);if(D!=null&&v(n,["speechConfig"],lx(D)),p(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ee=p(t,["thinkingConfig"]);ee!=null&&v(n,["thinkingConfig"],ee);const re=p(t,["imageConfig"]);re!=null&&v(n,["imageConfig"],ER(re));const Z=p(t,["enableEnhancedCivicAnswers"]);if(Z!=null&&v(n,["enableEnhancedCivicAnswers"],Z),p(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function $Q(e,t,r){const n={},a=p(t,["systemInstruction"]);r!==void 0&&a!=null&&v(r,["systemInstruction"],Pn(a));const s=p(t,["temperature"]);s!=null&&v(n,["temperature"],s);const l=p(t,["topP"]);l!=null&&v(n,["topP"],l);const o=p(t,["topK"]);o!=null&&v(n,["topK"],o);const u=p(t,["candidateCount"]);u!=null&&v(n,["candidateCount"],u);const f=p(t,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const d=p(t,["stopSequences"]);d!=null&&v(n,["stopSequences"],d);const m=p(t,["responseLogprobs"]);m!=null&&v(n,["responseLogprobs"],m);const x=p(t,["logprobs"]);x!=null&&v(n,["logprobs"],x);const y=p(t,["presencePenalty"]);y!=null&&v(n,["presencePenalty"],y);const E=p(t,["frequencyPenalty"]);E!=null&&v(n,["frequencyPenalty"],E);const C=p(t,["seed"]);C!=null&&v(n,["seed"],C);const S=p(t,["responseMimeType"]);S!=null&&v(n,["responseMimeType"],S);const T=p(t,["responseSchema"]);T!=null&&v(n,["responseSchema"],ix(T));const F=p(t,["responseJsonSchema"]);F!=null&&v(n,["responseJsonSchema"],F);const _=p(t,["routingConfig"]);_!=null&&v(n,["routingConfig"],_);const Q=p(t,["modelSelectionConfig"]);Q!=null&&v(n,["modelConfig"],Q);const L=p(t,["safetySettings"]);if(r!==void 0&&L!=null){let Ae=L;Array.isArray(Ae)&&(Ae=Ae.map(Re=>Re)),v(r,["safetySettings"],Ae)}const R=p(t,["tools"]);if(r!==void 0&&R!=null){let Ae=po(R);Array.isArray(Ae)&&(Ae=Ae.map(Re=>LS(mo(Re)))),v(r,["tools"],Ae)}const U=p(t,["toolConfig"]);r!==void 0&&U!=null&&v(r,["toolConfig"],U);const K=p(t,["labels"]);r!==void 0&&K!=null&&v(r,["labels"],K);const D=p(t,["cachedContent"]);r!==void 0&&D!=null&&v(r,["cachedContent"],is(e,D));const ee=p(t,["responseModalities"]);ee!=null&&v(n,["responseModalities"],ee);const re=p(t,["mediaResolution"]);re!=null&&v(n,["mediaResolution"],re);const Z=p(t,["speechConfig"]);Z!=null&&v(n,["speechConfig"],lx(Z));const ae=p(t,["audioTimestamp"]);ae!=null&&v(n,["audioTimestamp"],ae);const Te=p(t,["thinkingConfig"]);Te!=null&&v(n,["thinkingConfig"],Te);const Se=p(t,["imageConfig"]);if(Se!=null&&v(n,["imageConfig"],SR(Se)),p(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const q=p(t,["modelArmorConfig"]);return r!==void 0&&q!=null&&v(r,["modelArmorConfig"],q),n}function mC(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let l=Xa(a);Array.isArray(l)&&(l=l.map(o=>wd(o))),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&v(r,["generationConfig"],qQ(e,s,r)),r}function pC(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["contents"]);if(a!=null){let l=Xa(a);Array.isArray(l)&&(l=l.map(o=>o)),v(r,["contents"],l)}const s=p(t,["config"]);return s!=null&&v(r,["generationConfig"],$Q(e,s,r)),r}function xC(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>wQ(f))),v(t,["candidates"],u)}const a=p(e,["modelVersion"]);a!=null&&v(t,["modelVersion"],a);const s=p(e,["promptFeedback"]);s!=null&&v(t,["promptFeedback"],s);const l=p(e,["responseId"]);l!=null&&v(t,["responseId"],l);const o=p(e,["usageMetadata"]);return o!=null&&v(t,["usageMetadata"],o),t}function vC(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>d)),v(t,["candidates"],f)}const a=p(e,["createTime"]);a!=null&&v(t,["createTime"],a);const s=p(e,["modelVersion"]);s!=null&&v(t,["modelVersion"],s);const l=p(e,["promptFeedback"]);l!=null&&v(t,["promptFeedback"],l);const o=p(e,["responseId"]);o!=null&&v(t,["responseId"],o);const u=p(e,["usageMetadata"]);return u!=null&&v(t,["usageMetadata"],u),t}function ZQ(e,t){const r={};if(p(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=p(e,["numberOfImages"]);t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n);const a=p(e,["aspectRatio"]);t!==void 0&&a!=null&&v(t,["parameters","aspectRatio"],a);const s=p(e,["guidanceScale"]);if(t!==void 0&&s!=null&&v(t,["parameters","guidanceScale"],s),p(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=p(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&v(t,["parameters","safetySetting"],l);const o=p(e,["personGeneration"]);t!==void 0&&o!=null&&v(t,["parameters","personGeneration"],o);const u=p(e,["includeSafetyAttributes"]);t!==void 0&&u!=null&&v(t,["parameters","includeSafetyAttributes"],u);const f=p(e,["includeRaiReason"]);t!==void 0&&f!=null&&v(t,["parameters","includeRaiReason"],f);const d=p(e,["language"]);t!==void 0&&d!=null&&v(t,["parameters","language"],d);const m=p(e,["outputMimeType"]);t!==void 0&&m!=null&&v(t,["parameters","outputOptions","mimeType"],m);const x=p(e,["outputCompressionQuality"]);if(t!==void 0&&x!=null&&v(t,["parameters","outputOptions","compressionQuality"],x),p(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const y=p(e,["imageSize"]);if(t!==void 0&&y!=null&&v(t,["parameters","sampleImageSize"],y),p(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function eR(e,t){const r={},n=p(e,["outputGcsUri"]);t!==void 0&&n!=null&&v(t,["parameters","storageUri"],n);const a=p(e,["negativePrompt"]);t!==void 0&&a!=null&&v(t,["parameters","negativePrompt"],a);const s=p(e,["numberOfImages"]);t!==void 0&&s!=null&&v(t,["parameters","sampleCount"],s);const l=p(e,["aspectRatio"]);t!==void 0&&l!=null&&v(t,["parameters","aspectRatio"],l);const o=p(e,["guidanceScale"]);t!==void 0&&o!=null&&v(t,["parameters","guidanceScale"],o);const u=p(e,["seed"]);t!==void 0&&u!=null&&v(t,["parameters","seed"],u);const f=p(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&v(t,["parameters","safetySetting"],f);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&v(t,["parameters","personGeneration"],d);const m=p(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&v(t,["parameters","includeSafetyAttributes"],m);const x=p(e,["includeRaiReason"]);t!==void 0&&x!=null&&v(t,["parameters","includeRaiReason"],x);const y=p(e,["language"]);t!==void 0&&y!=null&&v(t,["parameters","language"],y);const E=p(e,["outputMimeType"]);t!==void 0&&E!=null&&v(t,["parameters","outputOptions","mimeType"],E);const C=p(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&v(t,["parameters","outputOptions","compressionQuality"],C);const S=p(e,["addWatermark"]);t!==void 0&&S!=null&&v(t,["parameters","addWatermark"],S);const T=p(e,["labels"]);t!==void 0&&T!=null&&v(t,["labels"],T);const F=p(e,["imageSize"]);t!==void 0&&F!=null&&v(t,["parameters","sampleImageSize"],F);const _=p(e,["enhancePrompt"]);return t!==void 0&&_!=null&&v(t,["parameters","enhancePrompt"],_),r}function tR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["prompt"]);a!=null&&v(r,["instances[0]","prompt"],a);const s=p(t,["config"]);return s!=null&&ZQ(s,r),r}function rR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["prompt"]);a!=null&&v(r,["instances[0]","prompt"],a);const s=p(t,["config"]);return s!=null&&eR(s,r),r}function nR(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>gR(l))),v(t,["generatedImages"],s)}const a=p(e,["positivePromptSafetyAttributes"]);return a!=null&&v(t,["positivePromptSafetyAttributes"],DS(a)),t}function aR(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>yd(l))),v(t,["generatedImages"],s)}const a=p(e,["positivePromptSafetyAttributes"]);return a!=null&&v(t,["positivePromptSafetyAttributes"],MS(a)),t}function AR(e,t){const r={},n=p(e,["numberOfVideos"]);if(t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n),p(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=p(e,["durationSeconds"]);if(t!==void 0&&a!=null&&v(t,["parameters","durationSeconds"],a),p(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=p(e,["aspectRatio"]);t!==void 0&&s!=null&&v(t,["parameters","aspectRatio"],s);const l=p(e,["resolution"]);t!==void 0&&l!=null&&v(t,["parameters","resolution"],l);const o=p(e,["personGeneration"]);if(t!==void 0&&o!=null&&v(t,["parameters","personGeneration"],o),p(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=p(e,["negativePrompt"]);t!==void 0&&u!=null&&v(t,["parameters","negativePrompt"],u);const f=p(e,["enhancePrompt"]);if(t!==void 0&&f!=null&&v(t,["parameters","enhancePrompt"],f),p(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=p(e,["lastFrame"]);t!==void 0&&d!=null&&v(t,["instances[0]","lastFrame"],Bd(d));const m=p(e,["referenceImages"]);if(t!==void 0&&m!=null){let x=m;Array.isArray(x)&&(x=x.map(y=>iD(y))),v(t,["instances[0]","referenceImages"],x)}if(p(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function sR(e,t){const r={},n=p(e,["numberOfVideos"]);t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n);const a=p(e,["outputGcsUri"]);t!==void 0&&a!=null&&v(t,["parameters","storageUri"],a);const s=p(e,["fps"]);t!==void 0&&s!=null&&v(t,["parameters","fps"],s);const l=p(e,["durationSeconds"]);t!==void 0&&l!=null&&v(t,["parameters","durationSeconds"],l);const o=p(e,["seed"]);t!==void 0&&o!=null&&v(t,["parameters","seed"],o);const u=p(e,["aspectRatio"]);t!==void 0&&u!=null&&v(t,["parameters","aspectRatio"],u);const f=p(e,["resolution"]);t!==void 0&&f!=null&&v(t,["parameters","resolution"],f);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&v(t,["parameters","personGeneration"],d);const m=p(e,["pubsubTopic"]);t!==void 0&&m!=null&&v(t,["parameters","pubsubTopic"],m);const x=p(e,["negativePrompt"]);t!==void 0&&x!=null&&v(t,["parameters","negativePrompt"],x);const y=p(e,["enhancePrompt"]);t!==void 0&&y!=null&&v(t,["parameters","enhancePrompt"],y);const E=p(e,["generateAudio"]);t!==void 0&&E!=null&&v(t,["parameters","generateAudio"],E);const C=p(e,["lastFrame"]);t!==void 0&&C!=null&&v(t,["instances[0]","lastFrame"],cA(C));const S=p(e,["referenceImages"]);if(t!==void 0&&S!=null){let _=S;Array.isArray(_)&&(_=_.map(Q=>lD(Q))),v(t,["instances[0]","referenceImages"],_)}const T=p(e,["mask"]);t!==void 0&&T!=null&&v(t,["instances[0]","mask"],sD(T));const F=p(e,["compressionQuality"]);return t!==void 0&&F!=null&&v(t,["parameters","compressionQuality"],F),r}function iR(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response","generateVideoResponse"]);return l!=null&&v(t,["response"],uR(l)),t}function lR(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],fR(l)),t}function oR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["prompt"]);a!=null&&v(r,["instances[0]","prompt"],a);const s=p(t,["image"]);s!=null&&v(r,["instances[0]","image"],Bd(s));const l=p(t,["video"]);l!=null&&v(r,["instances[0]","video"],HS(l));const o=p(t,["source"]);o!=null&&dR(o,r);const u=p(t,["config"]);return u!=null&&AR(u,r),r}function cR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["prompt"]);a!=null&&v(r,["instances[0]","prompt"],a);const s=p(t,["image"]);s!=null&&v(r,["instances[0]","image"],cA(s));const l=p(t,["video"]);l!=null&&v(r,["instances[0]","video"],OS(l));const o=p(t,["source"]);o!=null&&hR(o,r);const u=p(t,["config"]);return u!=null&&sR(u,r),r}function uR(e){const t={},r=p(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>pR(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const a=p(e,["raiMediaFilteredReasons"]);return a!=null&&v(t,["raiMediaFilteredReasons"],a),t}function fR(e){const t={},r=p(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>xR(l))),v(t,["generatedVideos"],s)}const n=p(e,["raiMediaFilteredCount"]);n!=null&&v(t,["raiMediaFilteredCount"],n);const a=p(e,["raiMediaFilteredReasons"]);return a!=null&&v(t,["raiMediaFilteredReasons"],a),t}function dR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const a=p(e,["image"]);t!==void 0&&a!=null&&v(t,["instances[0]","image"],Bd(a));const s=p(e,["video"]);return t!==void 0&&s!=null&&v(t,["instances[0]","video"],HS(s)),r}function hR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const a=p(e,["image"]);t!==void 0&&a!=null&&v(t,["instances[0]","image"],cA(a));const s=p(e,["video"]);return t!==void 0&&s!=null&&v(t,["instances[0]","video"],OS(s)),r}function gR(e){const t={},r=p(e,["_self"]);r!=null&&v(t,["image"],TR(r));const n=p(e,["raiFilteredReason"]);n!=null&&v(t,["raiFilteredReason"],n);const a=p(e,["_self"]);return a!=null&&v(t,["safetyAttributes"],DS(a)),t}function yd(e){const t={},r=p(e,["_self"]);r!=null&&v(t,["image"],RS(r));const n=p(e,["raiFilteredReason"]);n!=null&&v(t,["raiFilteredReason"],n);const a=p(e,["_self"]);a!=null&&v(t,["safetyAttributes"],MS(a));const s=p(e,["prompt"]);return s!=null&&v(t,["enhancedPrompt"],s),t}function mR(e){const t={},r=p(e,["_self"]);r!=null&&v(t,["mask"],RS(r));const n=p(e,["labels"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>s)),v(t,["labels"],a)}return t}function pR(e){const t={},r=p(e,["video"]);return r!=null&&v(t,["video"],aD(r)),t}function xR(e){const t={},r=p(e,["_self"]);return r!=null&&v(t,["video"],AD(r)),t}function vR(e){const t={},r=p(e,["modelSelectionConfig"]);r!=null&&v(t,["modelConfig"],r);const n=p(e,["responseJsonSchema"]);n!=null&&v(t,["responseJsonSchema"],n);const a=p(e,["audioTimestamp"]);a!=null&&v(t,["audioTimestamp"],a);const s=p(e,["candidateCount"]);s!=null&&v(t,["candidateCount"],s);const l=p(e,["enableAffectiveDialog"]);l!=null&&v(t,["enableAffectiveDialog"],l);const o=p(e,["frequencyPenalty"]);o!=null&&v(t,["frequencyPenalty"],o);const u=p(e,["logprobs"]);u!=null&&v(t,["logprobs"],u);const f=p(e,["maxOutputTokens"]);f!=null&&v(t,["maxOutputTokens"],f);const d=p(e,["mediaResolution"]);d!=null&&v(t,["mediaResolution"],d);const m=p(e,["presencePenalty"]);m!=null&&v(t,["presencePenalty"],m);const x=p(e,["responseLogprobs"]);x!=null&&v(t,["responseLogprobs"],x);const y=p(e,["responseMimeType"]);y!=null&&v(t,["responseMimeType"],y);const E=p(e,["responseModalities"]);E!=null&&v(t,["responseModalities"],E);const C=p(e,["responseSchema"]);C!=null&&v(t,["responseSchema"],C);const S=p(e,["routingConfig"]);S!=null&&v(t,["routingConfig"],S);const T=p(e,["seed"]);T!=null&&v(t,["seed"],T);const F=p(e,["speechConfig"]);F!=null&&v(t,["speechConfig"],F);const _=p(e,["stopSequences"]);_!=null&&v(t,["stopSequences"],_);const Q=p(e,["temperature"]);Q!=null&&v(t,["temperature"],Q);const L=p(e,["thinkingConfig"]);L!=null&&v(t,["thinkingConfig"],L);const R=p(e,["topK"]);R!=null&&v(t,["topK"],R);const U=p(e,["topP"]);if(U!=null&&v(t,["topP"],U),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function wR(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],tr(e,n)),r}function yR(e,t){const r={},n=p(t,["model"]);return n!=null&&v(r,["_url","name"],tr(e,n)),r}function BR(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function CR(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function ER(e){const t={},r=p(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=p(e,["imageSize"]);if(n!=null&&v(t,["imageSize"],n),p(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function SR(e){const t={},r=p(e,["aspectRatio"]);r!=null&&v(t,["aspectRatio"],r);const n=p(e,["imageSize"]);n!=null&&v(t,["imageSize"],n);const a=p(e,["personGeneration"]);a!=null&&v(t,["personGeneration"],a);const s=p(e,["outputMimeType"]);s!=null&&v(t,["imageOutputOptions","mimeType"],s);const l=p(e,["outputCompressionQuality"]);return l!=null&&v(t,["imageOutputOptions","compressionQuality"],l),t}function TR(e){const t={},r=p(e,["bytesBase64Encoded"]);r!=null&&v(t,["imageBytes"],ei(r));const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function RS(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["gcsUri"],r);const n=p(e,["bytesBase64Encoded"]);n!=null&&v(t,["imageBytes"],ei(n));const a=p(e,["mimeType"]);return a!=null&&v(t,["mimeType"],a),t}function Bd(e){const t={};if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=p(e,["imageBytes"]);r!=null&&v(t,["bytesBase64Encoded"],ei(r));const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function cA(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["gcsUri"],r);const n=p(e,["imageBytes"]);n!=null&&v(t,["bytesBase64Encoded"],ei(n));const a=p(e,["mimeType"]);return a!=null&&v(t,["mimeType"],a),t}function _R(e,t,r){const n={},a=p(t,["pageSize"]);r!==void 0&&a!=null&&v(r,["_query","pageSize"],a);const s=p(t,["pageToken"]);r!==void 0&&s!=null&&v(r,["_query","pageToken"],s);const l=p(t,["filter"]);r!==void 0&&l!=null&&v(r,["_query","filter"],l);const o=p(t,["queryBase"]);return r!==void 0&&o!=null&&v(r,["_url","models_url"],bS(e,o)),n}function bR(e,t,r){const n={},a=p(t,["pageSize"]);r!==void 0&&a!=null&&v(r,["_query","pageSize"],a);const s=p(t,["pageToken"]);r!==void 0&&s!=null&&v(r,["_query","pageToken"],s);const l=p(t,["filter"]);r!==void 0&&l!=null&&v(r,["_query","filter"],l);const o=p(t,["queryBase"]);return r!==void 0&&o!=null&&v(r,["_url","models_url"],bS(e,o)),n}function FR(e,t){const r={},n=p(t,["config"]);return n!=null&&_R(e,n,r),r}function UR(e,t){const r={},n=p(t,["config"]);return n!=null&&bR(e,n,r),r}function kR(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["_self"]);if(a!=null){let s=FS(a);Array.isArray(s)&&(s=s.map(l=>tp(l))),v(t,["models"],s)}return t}function NR(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["_self"]);if(a!=null){let s=FS(a);Array.isArray(s)&&(s=s.map(l=>rp(l))),v(t,["models"],s)}return t}function IR(e){const t={},r=p(e,["maskMode"]);r!=null&&v(t,["maskMode"],r);const n=p(e,["segmentationClasses"]);n!=null&&v(t,["maskClasses"],n);const a=p(e,["maskDilation"]);return a!=null&&v(t,["dilation"],a),t}function tp(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["displayName"]);n!=null&&v(t,["displayName"],n);const a=p(e,["description"]);a!=null&&v(t,["description"],a);const s=p(e,["version"]);s!=null&&v(t,["version"],s);const l=p(e,["_self"]);l!=null&&v(t,["tunedModelInfo"],WR(l));const o=p(e,["inputTokenLimit"]);o!=null&&v(t,["inputTokenLimit"],o);const u=p(e,["outputTokenLimit"]);u!=null&&v(t,["outputTokenLimit"],u);const f=p(e,["supportedGenerationMethods"]);f!=null&&v(t,["supportedActions"],f);const d=p(e,["temperature"]);d!=null&&v(t,["temperature"],d);const m=p(e,["maxTemperature"]);m!=null&&v(t,["maxTemperature"],m);const x=p(e,["topP"]);x!=null&&v(t,["topP"],x);const y=p(e,["topK"]);y!=null&&v(t,["topK"],y);const E=p(e,["thinking"]);return E!=null&&v(t,["thinking"],E),t}function rp(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["displayName"]);n!=null&&v(t,["displayName"],n);const a=p(e,["description"]);a!=null&&v(t,["description"],a);const s=p(e,["versionId"]);s!=null&&v(t,["version"],s);const l=p(e,["deployedModels"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(x=>zQ(x))),v(t,["endpoints"],m)}const o=p(e,["labels"]);o!=null&&v(t,["labels"],o);const u=p(e,["_self"]);u!=null&&v(t,["tunedModelInfo"],YR(u));const f=p(e,["defaultCheckpointId"]);f!=null&&v(t,["defaultCheckpointId"],f);const d=p(e,["checkpoints"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(x=>x)),v(t,["checkpoints"],m)}return t}function QR(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=p(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],XQ(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],JQ(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],vQ(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function RR(e){const t={},r=p(e,["productImage"]);return r!=null&&v(t,["image"],cA(r)),t}function DR(e,t){const r={},n=p(e,["numberOfImages"]);t!==void 0&&n!=null&&v(t,["parameters","sampleCount"],n);const a=p(e,["baseSteps"]);t!==void 0&&a!=null&&v(t,["parameters","baseSteps"],a);const s=p(e,["outputGcsUri"]);t!==void 0&&s!=null&&v(t,["parameters","storageUri"],s);const l=p(e,["seed"]);t!==void 0&&l!=null&&v(t,["parameters","seed"],l);const o=p(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&v(t,["parameters","safetySetting"],o);const u=p(e,["personGeneration"]);t!==void 0&&u!=null&&v(t,["parameters","personGeneration"],u);const f=p(e,["addWatermark"]);t!==void 0&&f!=null&&v(t,["parameters","addWatermark"],f);const d=p(e,["outputMimeType"]);t!==void 0&&d!=null&&v(t,["parameters","outputOptions","mimeType"],d);const m=p(e,["outputCompressionQuality"]);t!==void 0&&m!=null&&v(t,["parameters","outputOptions","compressionQuality"],m);const x=p(e,["enhancePrompt"]);t!==void 0&&x!=null&&v(t,["parameters","enhancePrompt"],x);const y=p(e,["labels"]);return t!==void 0&&y!=null&&v(t,["labels"],y),r}function MR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["source"]);a!=null&&HR(a,r);const s=p(t,["config"]);return s!=null&&DR(s,r),r}function LR(e){const t={},r=p(e,["predictions"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>yd(a))),v(t,["generatedImages"],n)}return t}function HR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const a=p(e,["personImage"]);t!==void 0&&a!=null&&v(t,["instances[0]","personImage","image"],cA(a));const s=p(e,["productImages"]);if(t!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>RR(o))),v(t,["instances[0]","productImages"],l)}return r}function OR(e){const t={},r=p(e,["referenceImage"]);r!=null&&v(t,["referenceImage"],cA(r));const n=p(e,["referenceId"]);n!=null&&v(t,["referenceId"],n);const a=p(e,["referenceType"]);a!=null&&v(t,["referenceType"],a);const s=p(e,["maskImageConfig"]);s!=null&&v(t,["maskImageConfig"],IR(s));const l=p(e,["controlImageConfig"]);l!=null&&v(t,["controlImageConfig"],TQ(l));const o=p(e,["styleImageConfig"]);o!=null&&v(t,["styleImageConfig"],o);const u=p(e,["subjectImageConfig"]);return u!=null&&v(t,["subjectImageConfig"],u),t}function DS(e){const t={},r=p(e,["safetyAttributes","categories"]);r!=null&&v(t,["categories"],r);const n=p(e,["safetyAttributes","scores"]);n!=null&&v(t,["scores"],n);const a=p(e,["contentType"]);return a!=null&&v(t,["contentType"],a),t}function MS(e){const t={},r=p(e,["safetyAttributes","categories"]);r!=null&&v(t,["categories"],r);const n=p(e,["safetyAttributes","scores"]);n!=null&&v(t,["scores"],n);const a=p(e,["contentType"]);return a!=null&&v(t,["contentType"],a),t}function PR(e){const t={},r=p(e,["category"]);if(r!=null&&v(t,["category"],r),p(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=p(e,["threshold"]);return n!=null&&v(t,["threshold"],n),t}function GR(e){const t={},r=p(e,["image"]);return r!=null&&v(t,["image"],cA(r)),t}function VR(e,t){const r={},n=p(e,["mode"]);t!==void 0&&n!=null&&v(t,["parameters","mode"],n);const a=p(e,["maxPredictions"]);t!==void 0&&a!=null&&v(t,["parameters","maxPredictions"],a);const s=p(e,["confidenceThreshold"]);t!==void 0&&s!=null&&v(t,["parameters","confidenceThreshold"],s);const l=p(e,["maskDilation"]);t!==void 0&&l!=null&&v(t,["parameters","maskDilation"],l);const o=p(e,["binaryColorThreshold"]);t!==void 0&&o!=null&&v(t,["parameters","binaryColorThreshold"],o);const u=p(e,["labels"]);return t!==void 0&&u!=null&&v(t,["labels"],u),r}function KR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["source"]);a!=null&&zR(a,r);const s=p(t,["config"]);return s!=null&&VR(s,r),r}function jR(e){const t={},r=p(e,["predictions"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(a=>mR(a))),v(t,["generatedMasks"],n)}return t}function zR(e,t){const r={},n=p(e,["prompt"]);t!==void 0&&n!=null&&v(t,["instances[0]","prompt"],n);const a=p(e,["image"]);t!==void 0&&a!=null&&v(t,["instances[0]","image"],cA(a));const s=p(e,["scribbleImage"]);return t!==void 0&&s!=null&&v(t,["instances[0]","scribble"],GR(s)),r}function XR(e){const t={},r=p(e,["retrievalConfig"]);r!=null&&v(t,["retrievalConfig"],r);const n=p(e,["functionCallingConfig"]);return n!=null&&v(t,["functionCallingConfig"],WQ(n)),t}function JR(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=p(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=p(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=p(e,["codeExecution"]);if(a!=null&&v(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=p(e,["functionDeclarations"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}const l=p(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],BR(l));const o=p(e,["googleSearch"]);o!=null&&v(t,["googleSearch"],CR(o));const u=p(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}function LS(e){const t={},r=p(e,["retrieval"]);r!=null&&v(t,["retrieval"],r);const n=p(e,["computerUse"]);if(n!=null&&v(t,["computerUse"],n),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=p(e,["codeExecution"]);a!=null&&v(t,["codeExecution"],a);const s=p(e,["enterpriseWebSearch"]);s!=null&&v(t,["enterpriseWebSearch"],s);const l=p(e,["functionDeclarations"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(x=>YQ(x))),v(t,["functionDeclarations"],m)}const o=p(e,["googleMaps"]);o!=null&&v(t,["googleMaps"],o);const u=p(e,["googleSearch"]);u!=null&&v(t,["googleSearch"],u);const f=p(e,["googleSearchRetrieval"]);f!=null&&v(t,["googleSearchRetrieval"],f);const d=p(e,["urlContext"]);return d!=null&&v(t,["urlContext"],d),t}function WR(e){const t={},r=p(e,["baseModel"]);r!=null&&v(t,["baseModel"],r);const n=p(e,["createTime"]);n!=null&&v(t,["createTime"],n);const a=p(e,["updateTime"]);return a!=null&&v(t,["updateTime"],a),t}function YR(e){const t={},r=p(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&v(t,["baseModel"],r);const n=p(e,["createTime"]);n!=null&&v(t,["createTime"],n);const a=p(e,["updateTime"]);return a!=null&&v(t,["updateTime"],a),t}function qR(e,t){const r={},n=p(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const a=p(e,["description"]);t!==void 0&&a!=null&&v(t,["description"],a);const s=p(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&v(t,["defaultCheckpointId"],s),r}function $R(e,t){const r={},n=p(e,["displayName"]);t!==void 0&&n!=null&&v(t,["displayName"],n);const a=p(e,["description"]);t!==void 0&&a!=null&&v(t,["description"],a);const s=p(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&v(t,["defaultCheckpointId"],s),r}function ZR(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","name"],tr(e,n));const a=p(t,["config"]);return a!=null&&qR(a,r),r}function eD(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["config"]);return a!=null&&$R(a,r),r}function tD(e,t){const r={},n=p(e,["outputGcsUri"]);t!==void 0&&n!=null&&v(t,["parameters","storageUri"],n);const a=p(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&v(t,["parameters","safetySetting"],a);const s=p(e,["personGeneration"]);t!==void 0&&s!=null&&v(t,["parameters","personGeneration"],s);const l=p(e,["includeRaiReason"]);t!==void 0&&l!=null&&v(t,["parameters","includeRaiReason"],l);const o=p(e,["outputMimeType"]);t!==void 0&&o!=null&&v(t,["parameters","outputOptions","mimeType"],o);const u=p(e,["outputCompressionQuality"]);t!==void 0&&u!=null&&v(t,["parameters","outputOptions","compressionQuality"],u);const f=p(e,["enhanceInputImage"]);t!==void 0&&f!=null&&v(t,["parameters","upscaleConfig","enhanceInputImage"],f);const d=p(e,["imagePreservationFactor"]);t!==void 0&&d!=null&&v(t,["parameters","upscaleConfig","imagePreservationFactor"],d);const m=p(e,["labels"]);t!==void 0&&m!=null&&v(t,["labels"],m);const x=p(e,["numberOfImages"]);t!==void 0&&x!=null&&v(t,["parameters","sampleCount"],x);const y=p(e,["mode"]);return t!==void 0&&y!=null&&v(t,["parameters","mode"],y),r}function rD(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["_url","model"],tr(e,n));const a=p(t,["image"]);a!=null&&v(r,["instances[0]","image"],cA(a));const s=p(t,["upscaleFactor"]);s!=null&&v(r,["parameters","upscaleConfig","upscaleFactor"],s);const l=p(t,["config"]);return l!=null&&tD(l,r),r}function nD(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>yd(s))),v(t,["generatedImages"],a)}return t}function aD(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["uri"],r);const n=p(e,["encodedVideo"]);n!=null&&v(t,["videoBytes"],ei(n));const a=p(e,["encoding"]);return a!=null&&v(t,["mimeType"],a),t}function AD(e){const t={},r=p(e,["gcsUri"]);r!=null&&v(t,["uri"],r);const n=p(e,["bytesBase64Encoded"]);n!=null&&v(t,["videoBytes"],ei(n));const a=p(e,["mimeType"]);return a!=null&&v(t,["mimeType"],a),t}function sD(e){const t={},r=p(e,["image"]);r!=null&&v(t,["_self"],cA(r));const n=p(e,["maskMode"]);return n!=null&&v(t,["maskMode"],n),t}function iD(e){const t={},r=p(e,["image"]);r!=null&&v(t,["image"],Bd(r));const n=p(e,["referenceType"]);return n!=null&&v(t,["referenceType"],n),t}function lD(e){const t={},r=p(e,["image"]);r!=null&&v(t,["image"],cA(r));const n=p(e,["referenceType"]);return n!=null&&v(t,["referenceType"],n),t}function HS(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["uri"],r);const n=p(e,["videoBytes"]);n!=null&&v(t,["encodedVideo"],ei(n));const a=p(e,["mimeType"]);return a!=null&&v(t,["encoding"],a),t}function OS(e){const t={},r=p(e,["uri"]);r!=null&&v(t,["gcsUri"],r);const n=p(e,["videoBytes"]);n!=null&&v(t,["bytesBase64Encoded"],ei(n));const a=p(e,["mimeType"]);return a!=null&&v(t,["mimeType"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oD(e,t){const r={},n=p(e,["displayName"]);return t!==void 0&&n!=null&&v(t,["displayName"],n),r}function cD(e){const t={},r=p(e,["config"]);return r!=null&&oD(r,t),t}function uD(e,t){const r={},n=p(e,["force"]);return t!==void 0&&n!=null&&v(t,["_query","force"],n),r}function fD(e){const t={},r=p(e,["name"]);r!=null&&v(t,["_url","name"],r);const n=p(e,["config"]);return n!=null&&uD(n,t),t}function dD(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","name"],r),t}function hD(e,t){const r={},n=p(e,["customMetadata"]);if(t!==void 0&&n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["customMetadata"],s)}const a=p(e,["chunkingConfig"]);return t!==void 0&&a!=null&&v(t,["chunkingConfig"],a),r}function gD(e){const t={},r=p(e,["name"]);r!=null&&v(t,["name"],r);const n=p(e,["metadata"]);n!=null&&v(t,["metadata"],n);const a=p(e,["done"]);a!=null&&v(t,["done"],a);const s=p(e,["error"]);s!=null&&v(t,["error"],s);const l=p(e,["response"]);return l!=null&&v(t,["response"],pD(l)),t}function mD(e){const t={},r=p(e,["fileSearchStoreName"]);r!=null&&v(t,["_url","file_search_store_name"],r);const n=p(e,["fileName"]);n!=null&&v(t,["fileName"],n);const a=p(e,["config"]);return a!=null&&hD(a,t),t}function pD(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["parent"]);n!=null&&v(t,["parent"],n);const a=p(e,["documentName"]);return a!=null&&v(t,["documentName"],a),t}function xD(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function vD(e){const t={},r=p(e,["config"]);return r!=null&&xD(r,t),t}function wD(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["fileSearchStores"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["fileSearchStores"],s)}return t}function PS(e,t){const r={},n=p(e,["mimeType"]);t!==void 0&&n!=null&&v(t,["mimeType"],n);const a=p(e,["displayName"]);t!==void 0&&a!=null&&v(t,["displayName"],a);const s=p(e,["customMetadata"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>u)),v(t,["customMetadata"],o)}const l=p(e,["chunkingConfig"]);return t!==void 0&&l!=null&&v(t,["chunkingConfig"],l),r}function yD(e){const t={},r=p(e,["fileSearchStoreName"]);r!=null&&v(t,["_url","file_search_store_name"],r);const n=p(e,["config"]);return n!=null&&PS(n,t),t}function BD(e){const t={},r=p(e,["sdkHttpResponse"]);return r!=null&&v(t,["sdkHttpResponse"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CD="Content-Type",ED="X-Server-Timeout",SD="User-Agent",np="x-goog-api-client",TD="1.38.0",_D=`google-genai-sdk/${TD}`,bD="v1beta1",FD="v1beta";class UD{constructor(t){var r,n,a;this.clientOptions=Object.assign({},t),this.customBaseUrl=(r=t.httpOptions)===null||r===void 0?void 0:r.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const s={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const o=t.project&&t.location||!!t.apiKey;this.customBaseUrl&&!o?(s.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?s.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(s.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:bD}else{if(!this.clientOptions.apiKey)throw new $c({message:"API key must be set when using the Gemini API.",status:403});s.apiVersion=(a=this.clientOptions.apiVersion)!==null&&a!==void 0?a:FD,s.baseUrl="https://generativelanguage.googleapis.com/"}s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),r=new URL(t);return r.protocol=r.protocol=="http:"?"ws":"wss",r.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,r,n){const a=[this.getRequestUrlInternal(r)];return n&&a.push(this.getBaseResourcePath()),t!==""&&a.push(t),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(t,r){return!(r.baseUrl&&r.baseUrlResourceScope===qm.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t,r),a=this.constructUrl(t.path,r,n);if(t.queryParams)for(const[l,o]of Object.entries(t.queryParams))a.searchParams.append(l,String(o));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,r,a.toString(),t.abortSignal),this.unaryApiCall(a,s,t.httpMethod)}patchHttpOptions(t,r){const n=JSON.parse(JSON.stringify(t));for(const[a,s]of Object.entries(r))typeof s=="object"?n[a]=Object.assign(Object.assign({},n[a]),s):s!==void 0&&(n[a]=s);return n}async requestStream(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t,r),a=this.constructUrl(t.path,r,n);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,r,a.toString(),t.abortSignal),this.streamApiCall(a,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,r,n,a){if(r&&r.timeout||a){const s=new AbortController,l=s.signal;if(r.timeout&&(r==null?void 0:r.timeout)>0){const o=setTimeout(()=>s.abort(),r.timeout);o&&typeof o.unref=="function"&&o.unref()}a&&a.addEventListener("abort",()=>{s.abort()}),t.signal=l}return r&&r.extraBody!==null&&kD(t,r.extraBody),t.headers=await this.getHeadersInternal(r,n),t}async unaryApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async a=>(await wC(a),new $m(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async a=>(await wC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(t){return sA(this,arguments,function*(){var n;const a=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";const o="data:",u=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:d}=yield St(a.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=s.decode(d,{stream:!0});try{const E=JSON.parse(m);if("error"in E){const C=JSON.parse(JSON.stringify(E.error)),S=C.status,T=C.code,F=`got status: ${S}. ${JSON.stringify(E)}`;if(T>=400&&T<600)throw new $c({message:F,status:T})}}catch(E){if(E.name==="ApiError")throw E}l+=m;let x=-1,y=0;for(;;){x=-1,y=0;for(const S of u){const T=l.indexOf(S);T!==-1&&(x===-1||T<x)&&(x=T,y=S.length)}if(x===-1)break;const E=l.substring(0,x);l=l.substring(x+y);const C=E.trim();if(C.startsWith(o)){const S=C.substring(o.length).trim();try{const T=new Response(S,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield St(new $m(T))}catch(T){throw new Error(`exception parsing stream chunk ${S}. ${T}`)}}}}}finally{a.releaseLock()}})}async apiCall(t,r){return fetch(t,r).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},r=_D+" "+this.clientOptions.userAgentExtra;return t[SD]=r,t[np]=r,t[CD]="application/json",t}async getHeadersInternal(t,r){const n=new Headers;if(t&&t.headers){for(const[a,s]of Object.entries(t.headers))n.append(a,s);t.timeout&&t.timeout>0&&n.append(ED,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,r),n}getFileName(t){var r;let n="";return typeof t=="string"&&(n=t.replace(/[/\\]+$/,""),n=(r=n.split(/[/\\]/).pop())!==null&&r!==void 0?r:""),n}async uploadFile(t,r){var n;const a={};r!=null&&(a.mimeType=r.mimeType,a.name=r.name,a.displayName=r.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,l=await s.stat(t);a.sizeBytes=String(l.size);const o=(n=r==null?void 0:r.mimeType)!==null&&n!==void 0?n:l.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=o;const u={file:a},f=this.getFileName(t),d=qe("upload/v1beta/files",u._url),m=await this.fetchUploadUrl(d,a.sizeBytes,a.mimeType,f,u,r==null?void 0:r.httpOptions);return s.upload(t,m,this)}async uploadFileToFileSearchStore(t,r,n){var a;const s=this.clientOptions.uploader,l=await s.stat(r),o=String(l.size),u=(a=n==null?void 0:n.mimeType)!==null&&a!==void 0?a:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${t}:uploadToFileSearchStore`,d=this.getFileName(r),m={};n!=null&&PS(n,m);const x=await this.fetchUploadUrl(f,o,u,d,m,n==null?void 0:n.httpOptions);return s.uploadToFileSearchStore(r,x,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,r,n,a,s,l){var o;let u={};l?u=l:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r}`,"X-Goog-Upload-Header-Content-Type":`${n}`},a?{"X-Goog-Upload-File-Name":a}:{})};const f=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:u});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(o=f==null?void 0:f.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function wC(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const r=e.status;let n;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?n=await e.json():n={error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(n);throw r>=400&&r<600?new $c({message:a,status:r}):new Error(a)}}function kD(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let r={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))r=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(s,l){const o=Object.assign({},s);for(const u in l)if(Object.prototype.hasOwnProperty.call(l,u)){const f=l[u],d=o[u];f&&typeof f=="object"&&!Array.isArray(f)&&d&&typeof d=="object"&&!Array.isArray(d)?o[u]=n(d,f):(d&&f&&typeof d!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof d}, New type: ${typeof f}. Overwriting.`),o[u]=f)}return o}const a=n(r,t);e.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ND="mcp_used/unknown";let ID=!1;function GS(e){for(const t of e)if(QD(t)||typeof t=="object"&&"inputSchema"in t)return!0;return ID}function VS(e){var t;const r=(t=e[np])!==null&&t!==void 0?t:"";e[np]=(r+` ${ND}`).trimStart()}function QD(e){return e!==null&&typeof e=="object"&&e instanceof cx}function RD(e){return sA(this,arguments,function*(r,n=100){let a,s=0;for(;s<n;){const l=yield St(r.listTools({cursor:a}));for(const o of l.tools)yield yield St(o),s++;if(!l.nextCursor)break;a=l.nextCursor}})}class cx{constructor(t=[],r){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=r}static create(t,r){return new cx(t,r)}async initialize(){var t,r,n,a;if(this.mcpTools.length>0)return;const s={},l=[];for(const d of this.mcpClients)try{for(var o=!0,u=(r=void 0,iA(RD(d))),f;f=await u.next(),t=f.done,!t;o=!0){a=f.value,o=!1;const m=a;l.push(m);const x=m.name;if(s[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);s[x]=d}}catch(m){r={error:m}}finally{try{!o&&!t&&(n=u.return)&&await n.call(u)}finally{if(r)throw r.error}}this.mcpTools=l,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),fI(this.mcpTools,this.config)}async callTool(t){await this.initialize();const r=[];for(const n of t)if(n.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const l=await a.callTool({name:n.name,arguments:n.args},void 0,s);r.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function DD(e,t,r){const n=new aI;let a;r.data instanceof Blob?a=JSON.parse(await r.data.text()):a=JSON.parse(r.data),Object.assign(n,a),t(n)}class MD{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n}async connect(t){var r,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=OD(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),u=`${a}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${o}`;let f=()=>{};const d=new Promise(_=>{f=_}),m=t.callbacks,x=function(){f({})},y=this.apiClient,E={onopen:x,onmessage:_=>{DD(y,m.onmessage,_)},onerror:(r=m==null?void 0:m.onerror)!==null&&r!==void 0?r:function(_){},onclose:(n=m==null?void 0:m.onclose)!==null&&n!==void 0?n:function(_){}},C=this.webSocketFactory.create(u,HD(l),E);C.connect(),await d;const F={setup:{model:tr(this.apiClient,t.model)}};return C.send(JSON.stringify(F)),new LD(C,this.apiClient)}}class LD{constructor(t,r){this.conn=t,this.apiClient=r}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const r=oQ(t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const r=lQ(t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const r={playbackControl:t};this.conn.send(JSON.stringify(r))}play(){this.sendPlaybackControl($l.PLAY)}pause(){this.sendPlaybackControl($l.PAUSE)}stop(){this.sendPlaybackControl($l.STOP)}resetContext(){this.sendPlaybackControl($l.RESET_CONTEXT)}close(){this.conn.close()}}function HD(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function OD(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PD="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function GD(e,t,r){const n=new nI;let a;r.data instanceof Blob?a=await r.data.text():r.data instanceof ArrayBuffer?a=new TextDecoder().decode(r.data):a=r.data;const s=JSON.parse(a);if(e.isVertexAI()){const l=fQ(s);Object.assign(n,l)}else Object.assign(n,s);t(n)}class VD{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n,this.music=new MD(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var r,n,a,s,l,o;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let d;const m=this.apiClient.getHeaders();t.config&&t.config.tools&&GS(t.config.tools)&&VS(m);const x=XD(m);if(this.apiClient.isVertexAI()){const D=this.apiClient.getProject(),ee=this.apiClient.getLocation(),re=this.apiClient.getApiKey(),Z=!!D&&!!ee||!!re;this.apiClient.getCustomBaseUrl()&&!Z?d=u:(d=`${u}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x,d))}else{const D=this.apiClient.getApiKey();let ee="BidiGenerateContent",re="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),ee="BidiGenerateContentConstrained",re="access_token"),d=`${u}/ws/google.ai.generativelanguage.${f}.GenerativeService.${ee}?${re}=${D}`}let y=()=>{};const E=new Promise(D=>{y=D}),C=t.callbacks,S=function(){var D;(D=C==null?void 0:C.onopen)===null||D===void 0||D.call(C),y({})},T=this.apiClient,F={onopen:S,onmessage:D=>{GD(T,C.onmessage,D)},onerror:(r=C==null?void 0:C.onerror)!==null&&r!==void 0?r:function(D){},onclose:(n=C==null?void 0:C.onclose)!==null&&n!==void 0?n:function(D){}},_=this.webSocketFactory.create(d,zD(x),F);_.connect(),await E;let Q=tr(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&Q.startsWith("publishers/")){const D=this.apiClient.getProject(),ee=this.apiClient.getLocation();D&&ee&&(Q=`projects/${D}/locations/${ee}/`+Q)}let L={};this.apiClient.isVertexAI()&&((a=t.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Gf.AUDIO]}:t.config.responseModalities=[Gf.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R=(o=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&o!==void 0?o:[],U=[];for(const D of R)if(this.isCallableTool(D)){const ee=D;U.push(await ee.tool())}else U.push(D);U.length>0&&(t.config.tools=U);const K={model:Q,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?L=iQ(this.apiClient,K):L=sQ(this.apiClient,K),delete L.config,_.send(JSON.stringify(L)),new jD(_,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const KD={turnComplete:!0};class jD{constructor(t,r){this.conn=t,this.apiClient=r}tLiveClientContent(t,r){if(r.turns!==null&&r.turns!==void 0){let n=[];try{n=Xa(r.turns),t.isVertexAI()||(n=n.map(a=>wd(a)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof r.turns}'`)}return{clientContent:{turns:n,turnComplete:r.turnComplete}}}return{clientContent:{turnComplete:r.turnComplete}}}tLiveClienttToolResponse(t,r){let n=[];if(r.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(r.functionResponses)?n=r.functionResponses:n=[r.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(PD)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},KD),t);const r=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendRealtimeInput(t){let r={};this.apiClient.isVertexAI()?r={realtimeInput:uQ(t)}:r={realtimeInput:cQ(t)},this.conn.send(JSON.stringify(r))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const r=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(r))}close(){this.conn.close()}}function zD(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function XD(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yC=10;function BC(e){var t,r,n;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let a=!1;for(const l of(r=e==null?void 0:e.tools)!==null&&r!==void 0?r:[])if(no(l)){a=!0;break}if(!a)return!0;const s=(n=e==null?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function no(e){return"callTool"in e&&typeof e.callTool=="function"}function JD(e){var t,r,n;return(n=(r=(t=e.config)===null||t===void 0?void 0:t.tools)===null||r===void 0?void 0:r.some(a=>no(a)))!==null&&n!==void 0?n:!1}function CC(e){var t;const r=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((n,a)=>{if(no(n))return;const s=n;s.functionDeclarations&&s.functionDeclarations.length>0&&r.push(a)}),r}function EC(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WD extends ss{constructor(t){super(),this.apiClient=t,this.generateContent=async r=>{var n,a,s,l,o;const u=await this.processParamsMaybeAddMcpUsage(r);if(this.maybeMoveToResponseJsonSchem(r),!JD(r)||BC(r.config))return await this.generateContentInternal(u);const f=CC(r);if(f.length>0){const C=f.map(S=>`tools[${S}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${C}.`)}let d,m;const x=Xa(u.contents),y=(s=(a=(n=u.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&s!==void 0?s:yC;let E=0;for(;E<y&&(d=await this.generateContentInternal(u),!(!d.functionCalls||d.functionCalls.length===0));){const C=d.candidates[0].content,S=[];for(const T of(o=(l=r.config)===null||l===void 0?void 0:l.tools)!==null&&o!==void 0?o:[])if(no(T)){const _=await T.callTool(d.functionCalls);S.push(..._)}E++,m={role:"user",parts:S},u.contents=Xa(u.contents),u.contents.push(C),u.contents.push(m),EC(u.config)&&(x.push(C),x.push(m))}return EC(u.config)&&(d.automaticFunctionCallingHistory=x),d},this.generateContentStream=async r=>{var n,a,s,l,o;if(this.maybeMoveToResponseJsonSchem(r),BC(r.config)){const m=await this.processParamsMaybeAddMcpUsage(r);return await this.generateContentStreamInternal(m)}const u=CC(r);if(u.length>0){const m=u.map(x=>`tools[${x}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(s=(a=(n=r==null?void 0:r.config)===null||n===void 0?void 0:n.toolConfig)===null||a===void 0?void 0:a.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,d=(o=(l=r==null?void 0:r.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||o===void 0?void 0:o.disable;if(f&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(r)},this.generateImages=async r=>await this.generateImagesInternal(r).then(n=>{var a;let s;const l=[];if(n!=null&&n.generatedImages)for(const u of n.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((a=u==null?void 0:u.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?s=u==null?void 0:u.safetyAttributes:l.push(u);let o;return s?o={generatedImages:l,positivePromptSafetyAttributes:s,sdkHttpResponse:n.sdkHttpResponse}:o={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},o}),this.list=async r=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),r==null?void 0:r.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Wi(rs.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(l),l)},this.editImage=async r=>{const n={model:r.model,prompt:r.prompt,referenceImages:[],config:r.config};return r.referenceImages&&r.referenceImages&&(n.referenceImages=r.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async r=>{let n={numberOfImages:1,mode:"upscale"};r.config&&(n=Object.assign(Object.assign({},n),r.config));const a={model:r.model,image:r.image,upscaleFactor:r.upscaleFactor,config:n};return await this.upscaleImageInternal(a)},this.generateVideos=async r=>{var n,a,s,l,o,u;if((r.prompt||r.image||r.video)&&r.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=r.video)===null||n===void 0)&&n.uri&&(!((a=r.video)===null||a===void 0)&&a.videoBytes)?r.video={uri:r.video.uri,mimeType:r.video.mimeType}:!((l=(s=r.source)===null||s===void 0?void 0:s.video)===null||l===void 0)&&l.uri&&(!((u=(o=r.source)===null||o===void 0?void 0:o.video)===null||u===void 0)&&u.videoBytes)&&(r.source.video={uri:r.source.video.uri,mimeType:r.source.video.mimeType})),await this.generateVideosInternal(r)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var r,n,a;const s=(r=t.config)===null||r===void 0?void 0:r.tools;if(!s)return t;const l=await Promise.all(s.map(async u=>no(u)?await u.tool():u)),o={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:l})};if(o.config.tools=l,t.config&&t.config.tools&&GS(t.config.tools)){const u=(a=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},u);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),VS(f),o.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:f})}return o}async initAfcToolsMap(t){var r,n,a;const s=new Map;for(const l of(n=(r=t.config)===null||r===void 0?void 0:r.tools)!==null&&n!==void 0?n:[])if(no(l)){const o=l,u=await o.tool();for(const f of(a=u.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(s.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);s.set(f.name,o)}}return s}async processAfcStream(t){var r,n,a;const s=(a=(n=(r=t.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&a!==void 0?a:yC;let l=!1,o=0;const u=await this.initAfcToolsMap(t);return(function(f,d,m){return sA(this,arguments,function*(){for(var x,y,E,C,S,T;o<s;){l&&(o++,l=!1);const L=yield St(f.processParamsMaybeAddMcpUsage(m)),R=yield St(f.generateContentStreamInternal(L)),U=[],K=[];try{for(var F=!0,_=(y=void 0,iA(R)),Q;Q=yield St(_.next()),x=Q.done,!x;F=!0){C=Q.value,F=!1;const D=C;if(yield yield St(D),D.candidates&&(!((S=D.candidates[0])===null||S===void 0)&&S.content)){K.push(D.candidates[0].content);for(const ee of(T=D.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(o<s&&ee.functionCall){if(!ee.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(ee.functionCall.name)){const re=yield St(d.get(ee.functionCall.name).callTool([ee.functionCall]));U.push(...re)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${ee.functionCall.name}`)}}}}catch(D){y={error:D}}finally{try{!F&&!x&&(E=_.return)&&(yield St(E.call(_)))}finally{if(y)throw y.error}}if(U.length>0){l=!0;const D=new gc;D.candidates=[{content:{role:"user",parts:U}}],yield yield St(D);const ee=[];ee.push(...K),ee.push({role:"user",parts:U});const re=Xa(m.contents).concat(ee);m.contents=re}else break}})})(this,u,t)}async generateContentInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=pC(this.apiClient,t);return o=qe("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=vC(d),x=new gc;return Object.assign(x,m),x})}else{const f=mC(this.apiClient,t);return o=qe("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=xC(d),x=new gc;return Object.assign(x,m),x})}}async generateContentStreamInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=pC(this.apiClient,t);return o=qe("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(m){return sA(this,arguments,function*(){var x,y,E,C;try{for(var S=!0,T=iA(m),F;F=yield St(T.next()),x=F.done,!x;S=!0){C=F.value,S=!1;const _=C,Q=vC(yield St(_.json()));Q.sdkHttpResponse={headers:_.headers};const L=new gc;Object.assign(L,Q),yield yield St(L)}}catch(_){y={error:_}}finally{try{!S&&!x&&(E=T.return)&&(yield St(E.call(T)))}finally{if(y)throw y.error}}})})}else{const f=mC(this.apiClient,t);return o=qe("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(m){return sA(this,arguments,function*(){var x,y,E,C;try{for(var S=!0,T=iA(m),F;F=yield St(T.next()),x=F.done,!x;S=!0){C=F.value,S=!1;const _=C,Q=xC(yield St(_.json()));Q.sdkHttpResponse={headers:_.headers};const L=new gc;Object.assign(L,Q),yield yield St(L)}}catch(_){y={error:_}}finally{try{!S&&!x&&(E=T.return)&&(yield St(E.call(T)))}finally{if(y)throw y.error}}})})}}async embedContent(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=VQ(this.apiClient,t);return o=qe("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=jQ(d),x=new ZB;return Object.assign(x,m),x})}else{const f=GQ(this.apiClient,t);return o=qe("{model}:batchEmbedContents",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=KQ(d),x=new ZB;return Object.assign(x,m),x})}}async generateImagesInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=rR(this.apiClient,t);return o=qe("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=aR(d),x=new eC;return Object.assign(x,m),x})}else{const f=tR(this.apiClient,t);return o=qe("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=nR(d),x=new eC;return Object.assign(x,m),x})}}async editImageInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=LQ(this.apiClient,t);return s=qe("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=HQ(u),d=new zN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=rD(this.apiClient,t);return s=qe("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=nD(u),d=new XN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=MR(this.apiClient,t);return s=qe("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=LR(u),d=new JN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=KR(this.apiClient,t);return s=qe("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=jR(u),d=new WN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=yR(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>rp(d))}else{const f=wR(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>tp(d))}}async listInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=UR(this.apiClient,t);return o=qe("{models_url}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=NR(d),x=new tC;return Object.assign(x,m),x})}else{const f=FR(this.apiClient,t);return o=qe("{models_url}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=kR(d),x=new tC;return Object.assign(x,m),x})}}async update(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=eD(this.apiClient,t);return o=qe("{model}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>rp(d))}else{const f=ZR(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>tp(d))}}async delete(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=QQ(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=DQ(d),x=new rC;return Object.assign(x,m),x})}else{const f=IQ(this.apiClient,t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=RQ(d),x=new rC;return Object.assign(x,m),x})}}async countTokens(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=UQ(this.apiClient,t);return o=qe("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=NQ(d),x=new nC;return Object.assign(x,m),x})}else{const f=FQ(this.apiClient,t);return o=qe("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=kQ(d),x=new nC;return Object.assign(x,m),x})}}async computeTokens(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=BQ(this.apiClient,t);return s=qe("{model}:computeTokens",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>{const f=CQ(u),d=new YN;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=cR(this.apiClient,t);return o=qe("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l.then(d=>{const m=lR(d),x=new Vf;return Object.assign(x,m),x})}else{const f=oR(this.apiClient,t);return o=qe("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l.then(d=>{const m=iR(d),x=new Vf;return Object.assign(x,m),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YD extends ss{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:a,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:a,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=ON(t);return o=qe("{operationName}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),l}else{const f=HN(t);return o=qe("{operationName}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),l}}async fetchPredictVideosOperationInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=NN(t);return s=qe("{resourceName}:fetchPredictOperation",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qD(e){const t={},r=p(e,["data"]);if(r!=null&&v(t,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function $D(e){const t={},r=p(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>iM(s))),v(t,["parts"],a)}const n=p(e,["role"]);return n!=null&&v(t,["role"],n),t}function ZD(e,t,r){const n={},a=p(t,["expireTime"]);r!==void 0&&a!=null&&v(r,["expireTime"],a);const s=p(t,["newSessionExpireTime"]);r!==void 0&&s!=null&&v(r,["newSessionExpireTime"],s);const l=p(t,["uses"]);r!==void 0&&l!=null&&v(r,["uses"],l);const o=p(t,["liveConnectConstraints"]);r!==void 0&&o!=null&&v(r,["bidiGenerateContentSetup"],sM(e,o));const u=p(t,["lockAdditionalFields"]);return r!==void 0&&u!=null&&v(r,["fieldMask"],u),n}function eM(e,t){const r={},n=p(t,["config"]);return n!=null&&v(r,["config"],ZD(e,n,r)),r}function tM(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&v(t,["fileUri"],r);const n=p(e,["mimeType"]);return n!=null&&v(t,["mimeType"],n),t}function rM(e){const t={},r=p(e,["id"]);r!=null&&v(t,["id"],r);const n=p(e,["args"]);n!=null&&v(t,["args"],n);const a=p(e,["name"]);if(a!=null&&v(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function nM(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&v(t,["enableWidget"],r),t}function aM(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&v(t,["timeRangeFilter"],r),t}function AM(e,t){const r={},n=p(e,["generationConfig"]);t!==void 0&&n!=null&&v(t,["setup","generationConfig"],n);const a=p(e,["responseModalities"]);t!==void 0&&a!=null&&v(t,["setup","generationConfig","responseModalities"],a);const s=p(e,["temperature"]);t!==void 0&&s!=null&&v(t,["setup","generationConfig","temperature"],s);const l=p(e,["topP"]);t!==void 0&&l!=null&&v(t,["setup","generationConfig","topP"],l);const o=p(e,["topK"]);t!==void 0&&o!=null&&v(t,["setup","generationConfig","topK"],o);const u=p(e,["maxOutputTokens"]);t!==void 0&&u!=null&&v(t,["setup","generationConfig","maxOutputTokens"],u);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&v(t,["setup","generationConfig","mediaResolution"],f);const d=p(e,["seed"]);t!==void 0&&d!=null&&v(t,["setup","generationConfig","seed"],d);const m=p(e,["speechConfig"]);t!==void 0&&m!=null&&v(t,["setup","generationConfig","speechConfig"],ox(m));const x=p(e,["thinkingConfig"]);t!==void 0&&x!=null&&v(t,["setup","generationConfig","thinkingConfig"],x);const y=p(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&v(t,["setup","generationConfig","enableAffectiveDialog"],y);const E=p(e,["systemInstruction"]);t!==void 0&&E!=null&&v(t,["setup","systemInstruction"],$D(Pn(E)));const C=p(e,["tools"]);if(t!==void 0&&C!=null){let R=po(C);Array.isArray(R)&&(R=R.map(U=>oM(mo(U)))),v(t,["setup","tools"],R)}const S=p(e,["sessionResumption"]);t!==void 0&&S!=null&&v(t,["setup","sessionResumption"],lM(S));const T=p(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&v(t,["setup","inputAudioTranscription"],T);const F=p(e,["outputAudioTranscription"]);t!==void 0&&F!=null&&v(t,["setup","outputAudioTranscription"],F);const _=p(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&v(t,["setup","realtimeInputConfig"],_);const Q=p(e,["contextWindowCompression"]);t!==void 0&&Q!=null&&v(t,["setup","contextWindowCompression"],Q);const L=p(e,["proactivity"]);if(t!==void 0&&L!=null&&v(t,["setup","proactivity"],L),p(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return r}function sM(e,t){const r={},n=p(t,["model"]);n!=null&&v(r,["setup","model"],tr(e,n));const a=p(t,["config"]);return a!=null&&v(r,["config"],AM(a,r)),r}function iM(e){const t={},r=p(e,["mediaResolution"]);r!=null&&v(t,["mediaResolution"],r);const n=p(e,["codeExecutionResult"]);n!=null&&v(t,["codeExecutionResult"],n);const a=p(e,["executableCode"]);a!=null&&v(t,["executableCode"],a);const s=p(e,["fileData"]);s!=null&&v(t,["fileData"],tM(s));const l=p(e,["functionCall"]);l!=null&&v(t,["functionCall"],rM(l));const o=p(e,["functionResponse"]);o!=null&&v(t,["functionResponse"],o);const u=p(e,["inlineData"]);u!=null&&v(t,["inlineData"],qD(u));const f=p(e,["text"]);f!=null&&v(t,["text"],f);const d=p(e,["thought"]);d!=null&&v(t,["thought"],d);const m=p(e,["thoughtSignature"]);m!=null&&v(t,["thoughtSignature"],m);const x=p(e,["videoMetadata"]);return x!=null&&v(t,["videoMetadata"],x),t}function lM(e){const t={},r=p(e,["handle"]);if(r!=null&&v(t,["handle"],r),p(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function oM(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=p(e,["computerUse"]);r!=null&&v(t,["computerUse"],r);const n=p(e,["fileSearch"]);n!=null&&v(t,["fileSearch"],n);const a=p(e,["codeExecution"]);if(a!=null&&v(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=p(e,["functionDeclarations"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(m=>m)),v(t,["functionDeclarations"],d)}const l=p(e,["googleMaps"]);l!=null&&v(t,["googleMaps"],nM(l));const o=p(e,["googleSearch"]);o!=null&&v(t,["googleSearch"],aM(o));const u=p(e,["googleSearchRetrieval"]);u!=null&&v(t,["googleSearchRetrieval"],u);const f=p(e,["urlContext"]);return f!=null&&v(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cM(e){const t=[];for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=e[r];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const a=Object.keys(n).map(s=>`${r}.${s}`);t.push(...a)}else t.push(r)}return t.join(",")}function uM(e,t){let r=null;const n=e.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const s=n.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,r=s):delete e.bidiGenerateContentSetup}else n!==void 0&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(r){const s=cM(r);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];a.length>0&&(o=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const u=[];s&&u.push(s),o.length>0&&u.push(...o),u.length>0?e.fieldMask=u.join(","):delete e.fieldMask}else delete e.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class fM extends ss{constructor(t){super(),this.apiClient=t}async create(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=eM(this.apiClient,t);s=qe("auth_tokens",o._url),l=o._query,delete o.config,delete o._url,delete o._query;const u=uM(o,t.config);return a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dM(e,t){const r={},n=p(e,["force"]);return t!==void 0&&n!=null&&v(t,["_query","force"],n),r}function hM(e){const t={},r=p(e,["name"]);r!=null&&v(t,["_url","name"],r);const n=p(e,["config"]);return n!=null&&dM(n,t),t}function gM(e){const t={},r=p(e,["name"]);return r!=null&&v(t,["_url","name"],r),t}function mM(e,t){const r={},n=p(e,["pageSize"]);t!==void 0&&n!=null&&v(t,["_query","pageSize"],n);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&v(t,["_query","pageToken"],a),r}function pM(e){const t={},r=p(e,["parent"]);r!=null&&v(t,["_url","parent"],r);const n=p(e,["config"]);return n!=null&&mM(n,t),t}function xM(e){const t={},r=p(e,["sdkHttpResponse"]);r!=null&&v(t,["sdkHttpResponse"],r);const n=p(e,["nextPageToken"]);n!=null&&v(t,["nextPageToken"],n);const a=p(e,["documents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>l)),v(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vM extends ss{constructor(t){super(),this.apiClient=t,this.list=async r=>new Wi(rs.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:r.parent,config:n.config}),await this.listInternal(r),r)}async get(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=gM(t);return s=qe("{name}",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n;let a="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=hM(t);a=qe("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=pM(t);return s=qe("{parent}/documents",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=xM(u),d=new qN;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wM extends ss{constructor(t,r=new vM(t)){super(),this.apiClient=t,this.documents=r,this.list=async(n={})=>new Wi(rs.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(n),n)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=cD(t);return s=qe("fileSearchStores",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async get(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=dD(t);return s=qe("{name}",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n;let a="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=fD(t);a=qe("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=vD(t);return s=qe("fileSearchStores",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=wD(u),d=new $N;return Object.assign(d,f),d})}}async uploadToFileSearchStoreInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=yD(t);return s=qe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=BD(u),d=new ZN;return Object.assign(d,f),d})}}async importFile(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=mD(t);return s=qe("{file_search_store_name}:importFile",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const f=gD(u),d=new ax;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let KS=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return KS=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),r=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^r()&15>>+n/4).toString(16))};const yM=()=>KS();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ap(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Ap=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wa extends Error{}class $n extends Wa{constructor(t,r,n,a){super(`${$n.makeMessage(t,r,n)}`),this.status=t,this.headers=a,this.error=r}static makeMessage(t,r,n){const a=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,r,n,a){if(!t||!a)return new Cd({message:n,cause:Ap(r)});const s=r;return t===400?new zS(t,s,n,a):t===401?new XS(t,s,n,a):t===403?new JS(t,s,n,a):t===404?new WS(t,s,n,a):t===409?new YS(t,s,n,a):t===422?new qS(t,s,n,a):t===429?new $S(t,s,n,a):t>=500?new ZS(t,s,n,a):new $n(t,s,n,a)}}class sp extends $n{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Cd extends $n{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class jS extends Cd{constructor({message:t}={}){super({message:t??"Request timed out."})}}class zS extends $n{}class XS extends $n{}class JS extends $n{}class WS extends $n{}class YS extends $n{}class qS extends $n{}class $S extends $n{}class ZS extends $n{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BM=/^[a-z][a-z0-9+.-]*:/i,CM=e=>BM.test(e);let ip=e=>(ip=Array.isArray,ip(e));const EM=ip;let SM=EM;const SC=SM;function TM(e){if(!e)return!0;for(const t in e)return!1;return!0}function _M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const bM=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Wa(`${e} must be an integer`);if(t<0)throw new Wa(`${e} must be a positive integer`);return t},FM=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UM=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kM(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const NM=()=>{var e,t,r,n,a;const s=kM();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jl,"X-Stainless-OS":_C(Deno.build.os),"X-Stainless-Arch":TC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jl,"X-Stainless-OS":_C((r=globalThis.process.platform)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Arch":TC((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(a=globalThis.process.version)!==null&&a!==void 0?a:"unknown"};const l=IM();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Jl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function IM(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const n=r.exec(navigator.userAgent);if(n){const a=n[1]||0,s=n[2]||0,l=n[3]||0;return{browser:t,version:`${a}.${s}.${l}`}}}return null}const TC=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",_C=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let O0;const QM=()=>O0??(O0=NM());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RM(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function eT(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function DM(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return eT({start(){},async pull(r){const{done:n,value:a}=await t.next();n?r.close():r.enqueue(a)},async cancel(){var r;await((r=t.return)===null||r===void 0?void 0:r.call(t))}})}function tT(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function MM(e){var t,r;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((r=(t=e[Symbol.asyncIterator]()).return)===null||r===void 0?void 0:r.call(t));return}const n=e.getReader(),a=n.cancel();n.releaseLock(),await a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LM=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rT=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,r=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(r?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function am(e,t,r){return rT(),new File(e,t??"unknown_file",r)}function HM(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const OM=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nT=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",PM=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&nT(e),GM=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function VM(e,t,r){if(rT(),e=await e,PM(e))return e instanceof File?e:am([await e.arrayBuffer()],e.name);if(GM(e)){const a=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),am(await lp(a),t,r)}const n=await lp(e);if(t||(t=HM(e)),!(r!=null&&r.type)){const a=n.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof a=="string"&&(r=Object.assign(Object.assign({},r),{type:a}))}return am(n,t,r)}async function lp(e){var t,r,n,a,s;let l=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)l.push(e);else if(nT(e))l.push(e instanceof Blob?e:await e.arrayBuffer());else if(OM(e))try{for(var o=!0,u=iA(e),f;f=await u.next(),t=f.done,!t;o=!0){a=f.value,o=!1;const d=a;l.push(...await lp(d))}}catch(d){r={error:d}}finally{try{!o&&!t&&(n=u.return)&&await n.call(u)}finally{if(r)throw r.error}}else{const d=(s=e==null?void 0:e.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof e}${d?`; constructor: ${d}`:""}${KM(e)}`)}return l}function KM(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(r=>`"${r}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aT{constructor(t){this._client=t}}aT._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AT(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const bC=Object.freeze(Object.create(null)),jM=(e=AT)=>(function(r,...n){if(r.length===1)return r[0];let a=!1;const s=[],l=r.reduce((d,m,x)=>{var y,E,C;/[?#]/.test(m)&&(a=!0);const S=n[x];let T=(a?encodeURIComponent:e)(""+S);return x!==n.length&&(S==null||typeof S=="object"&&S.toString===((C=Object.getPrototypeOf((E=Object.getPrototypeOf((y=S.hasOwnProperty)!==null&&y!==void 0?y:bC))!==null&&E!==void 0?E:bC))===null||C===void 0?void 0:C.toString))&&(T=S+"",s.push({start:d.length+m.length,length:T.length,error:`Value of type ${Object.prototype.toString.call(S).slice(8,-1)} is not a valid path parameter`})),d+m+(x===n.length?"":T)},""),o=l.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=u.exec(o))!==null;)s.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(s.sort((d,m)=>d.start-m.start),s.length>0){let d=0;const m=s.reduce((x,y)=>{const E=" ".repeat(y.start-d),C="^".repeat(y.length);return d=y.start+y.length,x+E+C},"");throw new Wa(`Path parameters result in path with invalid segments:
${s.map(x=>x.error).join(`
`)}
${l}
${m}`)}return l}),P0=jM(AT);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sT extends aT{create(t,r){var n;const{api_version:a=this._client.apiVersion}=t,s=jf(t,["api_version"]);if("model"in s&&"agent_config"in s)throw new Wa("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new Wa("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(P0`/${a}/interactions`,Object.assign(Object.assign({body:s},r),{stream:(n=t.stream)!==null&&n!==void 0?n:!1}))}delete(t,r={},n){const{api_version:a=this._client.apiVersion}=r??{};return this._client.delete(P0`/${a}/interactions/${t}`,n)}cancel(t,r={},n){const{api_version:a=this._client.apiVersion}=r??{};return this._client.post(P0`/${a}/interactions/${t}/cancel`,n)}get(t,r={},n){var a;const s=r??{},{api_version:l=this._client.apiVersion}=s,o=jf(s,["api_version"]);return this._client.get(P0`/${l}/interactions/${t}`,Object.assign(Object.assign({query:o},n),{stream:(a=r==null?void 0:r.stream)!==null&&a!==void 0?a:!1}))}}sT._key=Object.freeze(["interactions"]);class iT extends sT{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zM(e){let t=0;for(const a of e)t+=a.length;const r=new Uint8Array(t);let n=0;for(const a of e)r.set(a,n),n+=a.length;return r}let G0;function ux(e){let t;return(G0??(t=new globalThis.TextEncoder,G0=t.encode.bind(t)))(e)}let V0;function FC(e){let t;return(V0??(t=new globalThis.TextDecoder,V0=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ed{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?ux(t):t;this.buffer=zM([this.buffer,r]);const n=[];let a;for(;(a=XM(this.buffer,this.carriageReturnIndex))!=null;){if(a.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=a.index;continue}if(this.carriageReturnIndex!=null&&(a.index!==this.carriageReturnIndex+1||a.carriage)){n.push(FC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?a.preceding-1:a.preceding,l=FC(this.buffer.subarray(0,s));n.push(l),this.buffer=this.buffer.subarray(a.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}Ed.NEWLINE_CHARS=new Set([`
`,"\r"]);Ed.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function XM(e,t){for(let a=t??0;a<e.length;a++){if(e[a]===10)return{preceding:a,index:a+1,carriage:!1};if(e[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function JM(e){for(let n=0;n<e.length-1;n++){if(e[n]===10&&e[n+1]===10||e[n]===13&&e[n+1]===13)return n+2;if(e[n]===13&&e[n+1]===10&&n+3<e.length&&e[n+2]===13&&e[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zf={off:0,error:200,warn:300,info:400,debug:500},UC=(e,t,r)=>{if(e){if(_M(zf,e))return e;Xn(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(zf))}`)}};function Ec(){}function K0(e,t,r){return!t||zf[e]>zf[r]?Ec:t[e].bind(t)}const WM={error:Ec,warn:Ec,info:Ec,debug:Ec};let kC=new WeakMap;function Xn(e){var t;const r=e.logger,n=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!r)return WM;const a=kC.get(r);if(a&&a[0]===n)return a[1];const s={error:K0("error",r,n),warn:K0("warn",r,n),info:K0("info",r,n),debug:K0("debug",r,n)};return kC.set(r,[n,s]),s}const ki=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,r])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":r]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zl{constructor(t,r,n){this.iterator=t,this.controller=r,this.client=n}static fromSSEResponse(t,r,n){let a=!1;const s=n?Xn(n):console;function l(){return sA(this,arguments,function*(){var u,f,d,m;if(a)throw new Wa("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let x=!1;try{try{for(var y=!0,E=iA(YM(t,r)),C;C=yield St(E.next()),u=C.done,!u;y=!0){m=C.value,y=!1;const S=m;if(!x)if(S.data.startsWith("[DONE]")){x=!0;continue}else try{yield yield St(JSON.parse(S.data))}catch(T){throw s.error("Could not parse message into JSON:",S.data),s.error("From chunk:",S.raw),T}}}catch(S){f={error:S}}finally{try{!y&&!u&&(d=E.return)&&(yield St(d.call(E)))}finally{if(f)throw f.error}}x=!0}catch(S){if(ap(S))return yield St(void 0);throw S}finally{x||r.abort()}})}return new Zl(l,r,n)}static fromReadableStream(t,r,n){let a=!1;function s(){return sA(this,arguments,function*(){var u,f,d,m;const x=new Ed,y=tT(t);try{for(var E=!0,C=iA(y),S;S=yield St(C.next()),u=S.done,!u;E=!0){m=S.value,E=!1;const T=m;for(const F of x.decode(T))yield yield St(F)}}catch(T){f={error:T}}finally{try{!E&&!u&&(d=C.return)&&(yield St(d.call(C)))}finally{if(f)throw f.error}}for(const T of x.flush())yield yield St(T)})}function l(){return sA(this,arguments,function*(){var u,f,d,m;if(a)throw new Wa("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let x=!1;try{try{for(var y=!0,E=iA(s()),C;C=yield St(E.next()),u=C.done,!u;y=!0){m=C.value,y=!1;const S=m;x||S&&(yield yield St(JSON.parse(S)))}}catch(S){f={error:S}}finally{try{!y&&!u&&(d=E.return)&&(yield St(d.call(E)))}finally{if(f)throw f.error}}x=!0}catch(S){if(ap(S))return yield St(void 0);throw S}finally{x||r.abort()}})}return new Zl(l,r,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],n=this.iterator(),a=s=>({next:()=>{if(s.length===0){const l=n.next();t.push(l),r.push(l)}return s.shift()}});return[new Zl(()=>a(t),this.controller,this.client),new Zl(()=>a(r),this.controller,this.client)]}toReadableStream(){const t=this;let r;return eT({async start(){r=t[Symbol.asyncIterator]()},async pull(n){try{const{value:a,done:s}=await r.next();if(s)return n.close();const l=ux(JSON.stringify(a)+`
`);n.enqueue(l)}catch(a){n.error(a)}},async cancel(){var n;await((n=r.return)===null||n===void 0?void 0:n.call(r))}})}}function YM(e,t){return sA(this,arguments,function*(){var n,a,s,l;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Wa("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Wa("Attempted to iterate over a response with no body");const o=new $M,u=new Ed,f=tT(e.body);try{for(var d=!0,m=iA(qM(f)),x;x=yield St(m.next()),n=x.done,!n;d=!0){l=x.value,d=!1;const y=l;for(const E of u.decode(y)){const C=o.decode(E);C&&(yield yield St(C))}}}catch(y){a={error:y}}finally{try{!d&&!n&&(s=m.return)&&(yield St(s.call(m)))}finally{if(a)throw a.error}}for(const y of u.flush()){const E=o.decode(y);E&&(yield yield St(E))}})}function qM(e){return sA(this,arguments,function*(){var r,n,a,s;let l=new Uint8Array;try{for(var o=!0,u=iA(e),f;f=yield St(u.next()),r=f.done,!r;o=!0){s=f.value,o=!1;const d=s;if(d==null)continue;const m=d instanceof ArrayBuffer?new Uint8Array(d):typeof d=="string"?ux(d):d;let x=new Uint8Array(l.length+m.length);x.set(l),x.set(m,l.length),l=x;let y;for(;(y=JM(l))!==-1;)yield yield St(l.slice(0,y)),l=l.slice(y)}}catch(d){n={error:d}}finally{try{!o&&!r&&(a=u.return)&&(yield St(a.call(u)))}finally{if(n)throw n.error}}l.length>0&&(yield yield St(l))})}class $M{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,n,a]=ZM(t,":");return a.startsWith(" ")&&(a=a.substring(1)),r==="event"?this.event=a:r==="data"&&this.data.push(a),null}}function ZM(e,t){const r=e.indexOf(t);return r!==-1?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function eL(e,t){const{response:r,requestLogID:n,retryOfRequestLogID:a,startTime:s}=t,l=await(async()=>{var o;if(t.options.stream)return Xn(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(r,t.controller,e):Zl.fromSSEResponse(r,t.controller,e);if(r.status===204)return null;if(t.options.__binaryResponse)return r;const u=r.headers.get("content-type"),f=(o=u==null?void 0:u.split(";")[0])===null||o===void 0?void 0:o.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await r.json():await r.text()})();return Xn(e).debug(`[${n}] response parsed`,ki({retryOfRequestLogID:a,url:r.url,status:r.status,body:l,durationMs:Date.now()-s})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fx extends Promise{constructor(t,r,n=eL){super(a=>{a(null)}),this.responsePromise=r,this.parseResponse=n,this.client=t}_thenUnwrap(t){return new fx(this.client,this.responsePromise,async(r,n)=>t(await this.parseResponse(r,n),n))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lT=Symbol("brand.privateNullableHeaders");function*tL(e){if(!e)return;if(lT in e){const{values:n,nulls:a}=e;yield*n.entries();for(const s of a)yield[s,null];return}let t=!1,r;e instanceof Headers?r=e.entries():SC(e)?r=e:(t=!0,r=Object.entries(e??{}));for(let n of r){const a=n[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const s=SC(n[1])?n[1]:[n[1]];let l=!1;for(const o of s)o!==void 0&&(t&&!l&&(l=!0,yield[a,null]),yield[a,o])}}const mc=e=>{const t=new Headers,r=new Set;for(const n of e){const a=new Set;for(const[s,l]of tL(n)){const o=s.toLowerCase();a.has(o)||(t.delete(s),a.add(o)),l===null?(t.delete(s),r.add(o)):(t.append(s,l),r.delete(o))}}return{[lT]:!0,values:t,nulls:r}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Am=e=>{var t,r,n,a,s,l;if(typeof globalThis.process<"u")return(n=(r=(t=TN)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(s=(a=globalThis.Deno.env)===null||a===void 0?void 0:a.get)===null||s===void 0?void 0:s.call(a,e))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var oT;class Sd{constructor(t){var r,n,a,s,l,o,u,{baseURL:f=Am("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:d=(r=Am("GEMINI_API_KEY"))!==null&&r!==void 0?r:null,apiVersion:m="v1beta"}=t,x=jf(t,["baseURL","apiKey","apiVersion"]);const y=Object.assign(Object.assign({apiKey:d,apiVersion:m},x),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=y.baseURL,this.timeout=(n=y.timeout)!==null&&n!==void 0?n:Sd.DEFAULT_TIMEOUT,this.logger=(a=y.logger)!==null&&a!==void 0?a:console;const E="warn";this.logLevel=E,this.logLevel=(l=(s=UC(y.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:UC(Am("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:E,this.fetchOptions=y.fetchOptions,this.maxRetries=(o=y.maxRetries)!==null&&o!==void 0?o:2,this.fetch=(u=y.fetch)!==null&&u!==void 0?u:RM(),this.encoder=LM,this._options=y,this.apiKey=d,this.apiVersion=m,this.clientAdapter=y.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:r}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!r.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const r=mc([t.headers]);if(!(r.values.has("authorization")||r.values.has("x-goog-api-key"))){if(this.apiKey)return mc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return mc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new Wa(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Jl}`}defaultIdempotencyKey(){return`stainless-node-retry-${yM()}`}makeStatusError(t,r,n,a){return $n.generate(t,r,n,a)}buildURL(t,r,n){const a=!this.baseURLOverridden()&&n||this.baseURL,s=CM(t)?new URL(t):new URL(a+(a.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),l=this.defaultQuery();return TM(l)||(r=Object.assign(Object.assign({},l),r)),typeof r=="object"&&r&&!Array.isArray(r)&&(s.search=this.stringifyQuery(r)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const r=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${r}`}}async prepareRequest(t,{url:r,options:n}){}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,n){return this.request(Promise.resolve(n).then(a=>Object.assign({method:t,path:r},a)))}request(t,r=null){return new fx(this,this.makeRequest(t,r,void 0))}async makeRequest(t,r,n){var a,s,l;const o=await t,u=(a=o.maxRetries)!==null&&a!==void 0?a:this.maxRetries;r==null&&(r=u),await this.prepareOptions(o);const{req:f,url:d,timeout:m}=await this.buildRequest(o,{retryCount:u-r});await this.prepareRequest(f,{url:d,options:o});const x="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),y=n===void 0?"":`, retryOf: ${n}`,E=Date.now();if(Xn(this).debug(`[${x}] sending request`,ki({retryOfRequestLogID:n,method:o.method,url:d,options:o,headers:f.headers})),!((s=o.signal)===null||s===void 0)&&s.aborted)throw new sp;const C=new AbortController,S=await this.fetchWithTimeout(d,f,m,C).catch(Ap),T=Date.now();if(S instanceof globalThis.Error){const _=`retrying, ${r} attempts remaining`;if(!((l=o.signal)===null||l===void 0)&&l.aborted)throw new sp;const Q=ap(S)||/timed? ?out/i.test(String(S)+("cause"in S?String(S.cause):""));if(r)return Xn(this).info(`[${x}] connection ${Q?"timed out":"failed"} - ${_}`),Xn(this).debug(`[${x}] connection ${Q?"timed out":"failed"} (${_})`,ki({retryOfRequestLogID:n,url:d,durationMs:T-E,message:S.message})),this.retryRequest(o,r,n??x);throw Xn(this).info(`[${x}] connection ${Q?"timed out":"failed"} - error; no more retries left`),Xn(this).debug(`[${x}] connection ${Q?"timed out":"failed"} (error; no more retries left)`,ki({retryOfRequestLogID:n,url:d,durationMs:T-E,message:S.message})),Q?new jS:new Cd({cause:S})}const F=`[${x}${y}] ${f.method} ${d} ${S.ok?"succeeded":"failed"} with status ${S.status} in ${T-E}ms`;if(!S.ok){const _=await this.shouldRetry(S);if(r&&_){const D=`retrying, ${r} attempts remaining`;return await MM(S.body),Xn(this).info(`${F} - ${D}`),Xn(this).debug(`[${x}] response error (${D})`,ki({retryOfRequestLogID:n,url:S.url,status:S.status,headers:S.headers,durationMs:T-E})),this.retryRequest(o,r,n??x,S.headers)}const Q=_?"error; no more retries left":"error; not retryable";Xn(this).info(`${F} - ${Q}`);const L=await S.text().catch(D=>Ap(D).message),R=FM(L),U=R?void 0:L;throw Xn(this).debug(`[${x}] response error (${Q})`,ki({retryOfRequestLogID:n,url:S.url,status:S.status,headers:S.headers,message:U,durationMs:Date.now()-E})),this.makeStatusError(S.status,R,U,S.headers)}return Xn(this).info(F),Xn(this).debug(`[${x}] response start`,ki({retryOfRequestLogID:n,url:S.url,status:S.status,headers:S.headers,durationMs:T-E})),{response:S,options:o,controller:C,requestLogID:x,retryOfRequestLogID:n,startTime:E}}async fetchWithTimeout(t,r,n,a){const s=r||{},{signal:l,method:o}=s,u=jf(s,["signal","method"]);l&&l.addEventListener("abort",()=>a.abort());const f=setTimeout(()=>a.abort(),n),d=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,m=Object.assign(Object.assign(Object.assign({signal:a.signal},d?{duplex:"half"}:{}),{method:"GET"}),u);o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,t,m)}finally{clearTimeout(f)}}async shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,n,a){var s;let l;const o=a==null?void 0:a.get("retry-after-ms");if(o){const f=parseFloat(o);Number.isNaN(f)||(l=f)}const u=a==null?void 0:a.get("retry-after");if(u&&!l){const f=parseFloat(u);Number.isNaN(f)?l=Date.parse(u)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(r,f)}return await UM(l),this.makeRequest(t,r-1,n)}calculateDefaultRetryTimeoutMillis(t,r){const s=r-t,l=Math.min(.5*Math.pow(2,s),8),o=1-Math.random()*.25;return l*o*1e3}async buildRequest(t,{retryCount:r=0}={}){var n,a,s;const l=Object.assign({},t),{method:o,path:u,query:f,defaultBaseURL:d}=l,m=this.buildURL(u,f,d);"timeout"in l&&bM("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:x,body:y}=this.buildBody({options:l}),E=await this.buildHeaders({options:t,method:o,bodyHeaders:x,retryCount:r});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:E},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&y instanceof globalThis.ReadableStream&&{duplex:"half"}),y&&{body:y}),(a=this.fetchOptions)!==null&&a!==void 0?a:{}),(s=l.fetchOptions)!==null&&s!==void 0?s:{}),url:m,timeout:l.timeout}}async buildHeaders({options:t,method:r,bodyHeaders:n,retryCount:a}){let s={};this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);const l=await this.authHeaders(t);let o=mc([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),QM()),this._options.defaultHeaders,n,t.headers,l]);return this.validateHeaders(o),o.values}buildBody({options:{body:t,headers:r}}){if(!t)return{bodyHeaders:void 0,body:void 0};const n=mc([r]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&n.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:DM(t)}:this.encoder({body:t,headers:n})}}Sd.DEFAULT_TIMEOUT=6e4;class wn extends Sd{constructor(){super(...arguments),this.interactions=new iT(this)}}oT=wn;wn.GeminiNextGenAPIClient=oT;wn.GeminiNextGenAPIClientError=Wa;wn.APIError=$n;wn.APIConnectionError=Cd;wn.APIConnectionTimeoutError=jS;wn.APIUserAbortError=sp;wn.NotFoundError=WS;wn.ConflictError=YS;wn.RateLimitError=$S;wn.BadRequestError=zS;wn.AuthenticationError=XS;wn.InternalServerError=ZS;wn.PermissionDeniedError=JS;wn.UnprocessableEntityError=qS;wn.toFile=VM;wn.Interactions=iT;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rL(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function nL(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function aL(e,t){const r={},n=p(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function AL(e,t){const r={},n=p(e,["sdkHttpResponse"]);return n!=null&&v(r,["sdkHttpResponse"],n),r}function sL(e,t,r){const n={};if(p(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=p(e,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&v(t,["displayName"],a),p(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=p(e,["epochCount"]);t!==void 0&&s!=null&&v(t,["tuningTask","hyperparameters","epochCount"],s);const l=p(e,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),p(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=p(e,["batchSize"]);t!==void 0&&o!=null&&v(t,["tuningTask","hyperparameters","batchSize"],o);const u=p(e,["learningRate"]);if(t!==void 0&&u!=null&&v(t,["tuningTask","hyperparameters","learningRate"],u),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function iL(e,t,r){const n={};let a=p(r,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const y=p(e,["validationDataset"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec"],NC(y))}else if(a==="PREFERENCE_TUNING"){const y=p(e,["validationDataset"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec"],NC(y))}const s=p(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&v(t,["tunedModelDisplayName"],s);const l=p(e,["description"]);t!==void 0&&l!=null&&v(t,["description"],l);let o=p(r,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const y=p(e,["epochCount"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","hyperParameters","epochCount"],y)}else if(o==="PREFERENCE_TUNING"){const y=p(e,["epochCount"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],y)}let u=p(r,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const y=p(e,["learningRateMultiplier"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],y)}else if(u==="PREFERENCE_TUNING"){const y=p(e,["learningRateMultiplier"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],y)}let f=p(r,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const y=p(e,["exportLastCheckpointOnly"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","exportLastCheckpointOnly"],y)}else if(f==="PREFERENCE_TUNING"){const y=p(e,["exportLastCheckpointOnly"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],y)}let d=p(r,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const y=p(e,["adapterSize"]);t!==void 0&&y!=null&&v(t,["supervisedTuningSpec","hyperParameters","adapterSize"],y)}else if(d==="PREFERENCE_TUNING"){const y=p(e,["adapterSize"]);t!==void 0&&y!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],y)}if(p(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=p(e,["labels"]);t!==void 0&&m!=null&&v(t,["labels"],m);const x=p(e,["beta"]);return t!==void 0&&x!=null&&v(t,["preferenceOptimizationSpec","hyperParameters","beta"],x),n}function lL(e,t){const r={},n=p(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const a=p(e,["preTunedModel"]);a!=null&&v(r,["preTunedModel"],a);const s=p(e,["trainingDataset"]);s!=null&&vL(s);const l=p(e,["config"]);return l!=null&&sL(l,r),r}function oL(e,t){const r={},n=p(e,["baseModel"]);n!=null&&v(r,["baseModel"],n);const a=p(e,["preTunedModel"]);a!=null&&v(r,["preTunedModel"],a);const s=p(e,["trainingDataset"]);s!=null&&wL(s,r,t);const l=p(e,["config"]);return l!=null&&iL(l,r,t),r}function cL(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function uL(e,t){const r={},n=p(e,["name"]);return n!=null&&v(r,["_url","name"],n),r}function fL(e,t,r){const n={},a=p(e,["pageSize"]);t!==void 0&&a!=null&&v(t,["_query","pageSize"],a);const s=p(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const l=p(e,["filter"]);return t!==void 0&&l!=null&&v(t,["_query","filter"],l),n}function dL(e,t,r){const n={},a=p(e,["pageSize"]);t!==void 0&&a!=null&&v(t,["_query","pageSize"],a);const s=p(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const l=p(e,["filter"]);return t!==void 0&&l!=null&&v(t,["_query","filter"],l),n}function hL(e,t){const r={},n=p(e,["config"]);return n!=null&&fL(n,r),r}function gL(e,t){const r={},n=p(e,["config"]);return n!=null&&dL(n,r),r}function mL(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=p(e,["nextPageToken"]);a!=null&&v(r,["nextPageToken"],a);const s=p(e,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>cT(o))),v(r,["tuningJobs"],l)}return r}function pL(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=p(e,["nextPageToken"]);a!=null&&v(r,["nextPageToken"],a);const s=p(e,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>op(o))),v(r,["tuningJobs"],l)}return r}function xL(e,t){const r={},n=p(e,["name"]);n!=null&&v(r,["model"],n);const a=p(e,["name"]);return a!=null&&v(r,["endpoint"],a),r}function vL(e,t){const r={};if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=p(e,["examples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>s)),v(r,["examples","examples"],a)}return r}function wL(e,t,r){const n={};let a=p(r,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&v(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&v(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let s=p(r,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&v(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&v(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(p(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function cT(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=p(e,["name"]);a!=null&&v(r,["name"],a);const s=p(e,["state"]);s!=null&&v(r,["state"],TS(s));const l=p(e,["createTime"]);l!=null&&v(r,["createTime"],l);const o=p(e,["tuningTask","startTime"]);o!=null&&v(r,["startTime"],o);const u=p(e,["tuningTask","completeTime"]);u!=null&&v(r,["endTime"],u);const f=p(e,["updateTime"]);f!=null&&v(r,["updateTime"],f);const d=p(e,["description"]);d!=null&&v(r,["description"],d);const m=p(e,["baseModel"]);m!=null&&v(r,["baseModel"],m);const x=p(e,["_self"]);return x!=null&&v(r,["tunedModel"],xL(x)),r}function op(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=p(e,["name"]);a!=null&&v(r,["name"],a);const s=p(e,["state"]);s!=null&&v(r,["state"],TS(s));const l=p(e,["createTime"]);l!=null&&v(r,["createTime"],l);const o=p(e,["startTime"]);o!=null&&v(r,["startTime"],o);const u=p(e,["endTime"]);u!=null&&v(r,["endTime"],u);const f=p(e,["updateTime"]);f!=null&&v(r,["updateTime"],f);const d=p(e,["error"]);d!=null&&v(r,["error"],d);const m=p(e,["description"]);m!=null&&v(r,["description"],m);const x=p(e,["baseModel"]);x!=null&&v(r,["baseModel"],x);const y=p(e,["tunedModel"]);y!=null&&v(r,["tunedModel"],y);const E=p(e,["preTunedModel"]);E!=null&&v(r,["preTunedModel"],E);const C=p(e,["supervisedTuningSpec"]);C!=null&&v(r,["supervisedTuningSpec"],C);const S=p(e,["preferenceOptimizationSpec"]);S!=null&&v(r,["preferenceOptimizationSpec"],S);const T=p(e,["tuningDataStats"]);T!=null&&v(r,["tuningDataStats"],T);const F=p(e,["encryptionSpec"]);F!=null&&v(r,["encryptionSpec"],F);const _=p(e,["partnerModelTuningSpec"]);_!=null&&v(r,["partnerModelTuningSpec"],_);const Q=p(e,["customBaseModel"]);Q!=null&&v(r,["customBaseModel"],Q);const L=p(e,["experiment"]);L!=null&&v(r,["experiment"],L);const R=p(e,["labels"]);R!=null&&v(r,["labels"],R);const U=p(e,["outputUri"]);U!=null&&v(r,["outputUri"],U);const K=p(e,["pipelineJob"]);K!=null&&v(r,["pipelineJob"],K);const D=p(e,["serviceAccount"]);D!=null&&v(r,["serviceAccount"],D);const ee=p(e,["tunedModelDisplayName"]);ee!=null&&v(r,["tunedModelDisplayName"],ee);const re=p(e,["veoTuningSpec"]);return re!=null&&v(r,["veoTuningSpec"],re),r}function yL(e,t){const r={},n=p(e,["sdkHttpResponse"]);n!=null&&v(r,["sdkHttpResponse"],n);const a=p(e,["name"]);a!=null&&v(r,["name"],a);const s=p(e,["metadata"]);s!=null&&v(r,["metadata"],s);const l=p(e,["done"]);l!=null&&v(r,["done"],l);const o=p(e,["error"]);return o!=null&&v(r,["error"],o),r}function NC(e,t){const r={},n=p(e,["gcsUri"]);n!=null&&v(r,["validationDatasetUri"],n);const a=p(e,["vertexDatasetResource"]);return a!=null&&v(r,["validationDatasetUri"],a),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BL extends ss{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new Wi(rs.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.get=async r=>await this.getInternal(r),this.tune=async r=>{var n;if(this.apiClient.isVertexAI())if(r.baseModel.startsWith("projects/")){const a={tunedModelName:r.baseModel};!((n=r.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(a.checkpointId=r.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},r),{preTunedModel:a});return s.baseModel=void 0,await this.tuneInternal(s)}else{const a=Object.assign({},r);return await this.tuneInternal(a)}else{const a=Object.assign({},r),s=await this.tuneMldevInternal(a);let l="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?l=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(l=s.name.split("/operations/")[0]),{name:l,state:Ym.JOB_STATE_QUEUED}}}}async getInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=uL(t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>op(d))}else{const f=cL(t);return o=qe("{name}",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>cT(d))}}async listInternal(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=gL(t);return o=qe("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=pL(d),x=new aC;return Object.assign(x,m),x})}else{const f=hL(t);return o=qe("tunedModels",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=mL(d),x=new aC;return Object.assign(x,m),x})}}async cancel(t){var r,n,a,s;let l,o="",u={};if(this.apiClient.isVertexAI()){const f=nL(t);return o=qe("{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=AL(d),x=new AC;return Object.assign(x,m),x})}else{const f=rL(t);return o=qe("{name}:cancel",f._url),u=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const x=m;return x.sdkHttpResponse={headers:d.headers},x})),l.then(d=>{const m=aL(d),x=new AC;return Object.assign(x,m),x})}}async tuneInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI()){const o=oL(t,t);return s=qe("tuningJobs",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>op(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var r,n;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=lL(t);return s=qe("tunedModels",o._url),l=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),a.then(u=>yL(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CL{async download(t,r){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const EL=1024*1024*8,SL=3,TL=1e3,_L=2,Xf="x-goog-upload-status";async function bL(e,t,r){var n;const a=await uT(e,t,r),s=await(a==null?void 0:a.json());if(((n=a==null?void 0:a.headers)===null||n===void 0?void 0:n[Xf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function FL(e,t,r){var n;const a=await uT(e,t,r),s=await(a==null?void 0:a.json());if(((n=a==null?void 0:a.headers)===null||n===void 0?void 0:n[Xf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=wS(s),o=new Ax;return Object.assign(o,l),o}async function uT(e,t,r){var n,a;let s=0,l=0,o=new $m(new Response),u="upload";for(s=e.size;l<s;){const f=Math.min(EL,s-l),d=e.slice(l,l+f);l+f>=s&&(u+=", finalize");let m=0,x=TL;for(;m<SL&&(o=await r.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((n=o==null?void 0:o.headers)===null||n===void 0)&&n[Xf]));)m++,await kL(x),x=x*_L;if(l+=f,((a=o==null?void 0:o.headers)===null||a===void 0?void 0:a[Xf])!=="active")break;if(s<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return o}async function UL(e){return{size:e.size,type:e.type}}function kL(e){return new Promise(t=>setTimeout(t,e))}class NL{async upload(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await bL(t,r,n)}async uploadToFileSearchStore(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await FL(t,r,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await UL(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IL{create(t,r,n){return new QL(t,r,n)}}class QL{constructor(t,r,n){this.url=t,this.headers=r,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IC="x-goog-api-key";class RL{constructor(t){this.apiKey=t}async addAuthHeaders(t,r){if(t.get(IC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(IC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DL="gl-node/";class fT{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const r=new wn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=r.interactions,this._interactions}constructor(t){var r;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(r=t.vertexai)!==null&&r!==void 0?r:!1,this.apiKey=t.apiKey;const n=UN(t.httpOptions,t.vertexai,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const a=new RL(this.apiKey);this.apiClient=new UD({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:DL+"web",uploader:new NL,downloader:new CL}),this.models=new WD(this.apiClient),this.live=new VD(this.apiClient,a,new IL),this.batches=new A3(this.apiClient),this.chats=new O3(this.models,this.apiClient),this.caches=new M3(this.apiClient),this.files=new Y3(this.apiClient),this.operations=new YD(this.apiClient),this.authTokens=new fM(this.apiClient),this.tunings=new BL(this.apiClient),this.fileSearchStores=new wM(this.apiClient)}}const ML={users:[{id:"super01",name:"System Super Admin",email:"super@exam.com",role:At.SUPER_ADMIN,password:"password123"},{id:"admin01",name:"Admin User",email:"admin@exam.com",role:At.ADMIN,password:"password123",institutionName:"Global Tech University",permissionGranted:!0},{id:"admin02",name:"Second Admin",email:"admin2@exam.com",role:At.ADMIN,password:"password123",institutionName:"Innovate Institute",permissionGranted:!0},{id:"admin_pending",name:"Pending Admin",email:"pending@exam.com",role:At.ADMIN,password:"password123",institutionName:"New Horizon School",permissionGranted:!1},{id:"teacher01",name:"Dr. Evelyn Reed",email:"teacher1@exam.com",role:At.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"},{id:"teacher02",name:"Mr. Samuel Chen",email:"teacher2@exam.com",role:At.TEACHER,permissionGranted:!1,password:"password123"},{id:"teacher03",name:"Ms. Anya Sharma",email:"teacher3@exam.com",role:At.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"},{id:"teacher04",name:"Ms. Nitya",email:"teacher4@exam.com",role:At.TEACHER,permissionGranted:!0,password:"password123",adminId:"admin01"}],exams:[{id:"exam01",title:"Mid-Term Examinations",date:"2024-09-15",halls:[{id:"hallA",name:"Hall A",layout:Array.from({length:64},(e,t)=>({id:`s${t}`,row:Math.floor(t/8),col:t%8,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"},{id:"hallB",name:"Hall B",layout:Array.from({length:42},(e,t)=>({id:`s${t}`,row:Math.floor(t/7),col:t%7,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"}],studentSets:[{id:"set101",subject:"101",studentCount:50},{id:"set102",subject:"102",studentCount:45}],seatingPlan:void 0,seatingType:"normal",editorMode:"ai",createdBy:"teacher01",adminId:"admin01"},{id:"exam02",title:"Finals - Advanced Mode",date:"2024-12-10",halls:[{id:"hallC",name:"Hall C",layout:Array.from({length:50},(e,t)=>({id:`s${t}`,row:Math.floor(t/10),col:t%10,type:"standard"})),constraints:{type:"advanced",allowedSetIds:["set201"],arrangement:"vertical"},frontDirection:"left"}],studentSets:[{id:"set201",subject:"201",studentCount:30},{id:"set202",subject:"202",studentCount:20}],seatingPlan:void 0,seatingType:"normal",editorMode:"advanced",createdBy:"teacher03",adminId:"admin01"},{id:"exam03",title:"Pop Quiz - Classic Mode",date:"2024-10-25",halls:[{id:"hallD",name:"Hall D",layout:Array.from({length:30},(e,t)=>({id:`s${t}`,row:Math.floor(t/5),col:t%5,type:"standard"})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"bottom"}],studentSets:[{id:"set301",subject:"301",studentCount:25}],seatingPlan:void 0,seatingType:"fair",editorMode:"classic",createdBy:"teacher01",adminId:"admin01"}],hallTemplates:[{id:"template01",name:"Main Auditorium",layout:Array.from({length:100},(e,t)=>({id:`s${t}`,row:Math.floor(t/10),col:t%10,type:"standard"})),createdBy:"teacher01",adminId:"admin01"},{id:"template02",name:"Computer Lab 1",layout:Array.from({length:40},(e,t)=>({id:`s${t}`,row:Math.floor(t/8),col:t%8,type:"standard"})),createdBy:"teacher01",adminId:"admin01"}],studentSetTemplates:[{id:"settemplate01",subject:"Physics 101",studentCount:50,createdBy:"teacher01",adminId:"admin01"},{id:"settemplate02",subject:"Chemistry Lab",studentCount:24,createdBy:"teacher01",adminId:"admin01"},{id:"settemplate03",subject:"Calculus III",studentCount:45,createdBy:"teacher03",adminId:"admin01"}],auditLogs:[{id:"log1",adminId:"admin01",actorName:"Dr. Evelyn Reed",role:At.TEACHER,action:"CREATED_EXAM",details:'Created exam "Mid-Term Examinations"',timestamp:new Date(Date.now()-864e5*2).toISOString()},{id:"log2",adminId:"admin01",actorName:"Student 101001",role:At.STUDENT,action:"STUDENT_LOGIN",details:"Accessed dashboard",timestamp:new Date(Date.now()-36e5).toISOString()}]};let Xe=JSON.parse(JSON.stringify(ML));const ar=200,ti=(e,t,r,n,a)=>{const s={id:`log${Date.now()}${Math.random().toString(36).substr(2,5)}`,adminId:e,actorName:t,role:r,action:n,details:a,timestamp:new Date().toISOString()};Xe.auditLogs.unshift(s)},dT=async e=>(await new Promise(t=>setTimeout(t,ar)),e?Promise.resolve(Xe.auditLogs.filter(t=>t.adminId===e).sort((t,r)=>new Date(r.timestamp).getTime()-new Date(t.timestamp).getTime())):Promise.resolve(Xe.auditLogs)),LL=async()=>(await new Promise(e=>setTimeout(e,ar)),Promise.resolve(Xe.users.filter(e=>e.role===At.ADMIN))),HL=async e=>{await new Promise(r=>setTimeout(r,ar));let t;return Xe.users=Xe.users.map(r=>r.id===e&&r.role===At.ADMIN?(t={...r,permissionGranted:!0},t):r),t&&ti("SYSTEM","Super Admin",At.SUPER_ADMIN,"GRANT_ADMIN_ACCESS",`Approved institution admin: ${t.institutionName}`),Promise.resolve(t)},OL=async e=>{await new Promise(r=>setTimeout(r,ar));const t=Xe.users.find(r=>r.id===e&&r.role===At.ADMIN);return t?(Xe.users=Xe.users.filter(r=>r.id!==e&&r.adminId!==e),Xe.exams=Xe.exams.filter(r=>r.adminId!==e),Xe.hallTemplates=Xe.hallTemplates.filter(r=>r.adminId!==e),Xe.studentSetTemplates=Xe.studentSetTemplates.filter(r=>r.adminId!==e),Xe.auditLogs=Xe.auditLogs.filter(r=>r.adminId!==e),ti("SYSTEM","Super Admin",At.SUPER_ADMIN,"DELETE_INSTITUTION",`Wiped institution and all data for: ${t.institutionName}`),!0):!1},PL=async()=>{await new Promise(t=>setTimeout(t,ar));const e=Xe.users.filter(t=>t.role===At.ADMIN&&t.institutionName&&t.permissionGranted).map(t=>({id:t.id,name:t.institutionName})).sort((t,r)=>t.name.localeCompare(r.name));return Promise.resolve(e)},GL=async e=>(await new Promise(t=>setTimeout(t,ar)),Promise.resolve(Xe.users.find(t=>t.email.toLowerCase()===e.toLowerCase()))),Td=async e=>(await new Promise(t=>setTimeout(t,ar)),Promise.resolve(Xe.users.find(t=>t.id===e))),VL=async(e,t,r,n)=>{if(await new Promise(s=>setTimeout(s,ar)),Xe.users.some(s=>s.email.toLowerCase()===t.toLowerCase()))return Promise.resolve(null);const a={id:`admin${Date.now()}`,name:e,email:t,role:At.ADMIN,password:r,institutionName:n,permissionGranted:!1};return Xe.users=[...Xe.users,a],Promise.resolve(a)},KL=async(e,t,r,n)=>{if(await new Promise(l=>setTimeout(l,ar)),Xe.users.some(l=>l.email.toLowerCase()===t.toLowerCase()))return Promise.resolve(null);const a=Xe.users.find(l=>{var o;return l.role===At.ADMIN&&(l.id===n||((o=l.institutionName)==null?void 0:o.toLowerCase())===n.toLowerCase())});if(!a)return Promise.resolve(null);const s={id:`teacher${Date.now()}`,name:e,email:t,role:At.TEACHER,permissionGranted:!1,password:r,adminId:a.id};return Xe.users=[...Xe.users,s],Promise.resolve(s)},hT=async e=>(await new Promise(t=>setTimeout(t,ar)),Promise.resolve(Xe.users.filter(t=>t.role==="TEACHER"&&t.adminId===e))),jL=async()=>(await new Promise(e=>setTimeout(e,ar)),Promise.resolve(Xe.users.filter(e=>e.role==="TEACHER"&&!e.permissionGranted))),zL=async(e,t)=>{await new Promise(n=>setTimeout(n,ar));let r;return Xe.users=Xe.users.map(n=>n.id===e&&n.role==="TEACHER"?(r={...n,permissionGranted:!0,adminId:t},r):n),r&&ti(t,"Admin",At.ADMIN,"GRANTED_PERMISSION",`Approved teacher account: ${r.name}`),Promise.resolve(r)},XL=async e=>{await new Promise(r=>setTimeout(r,ar));let t;return Xe.users=Xe.users.map(r=>r.id===e&&r.role==="TEACHER"?(t={...r,permissionGranted:!1},t):r),t&&t.adminId&&ti(t.adminId,"Admin",At.ADMIN,"REVOKED_PERMISSION",`Revoked permission for: ${t.name}`),Promise.resolve(t)},JL=async(e,t)=>{await new Promise(n=>setTimeout(n,ar));const r=Xe.users.length;return Xe.users=Xe.users.filter(n=>n.id!==e),Xe.users.length===r?Promise.resolve(!1):(Xe.exams=Xe.exams.filter(n=>n.createdBy!==e),Xe.hallTemplates=Xe.hallTemplates.filter(n=>n.createdBy!==e),Xe.studentSetTemplates=Xe.studentSetTemplates.filter(n=>n.createdBy!==e),ti(t,"Admin",At.ADMIN,"DELETED_TEACHER","Deleted teacher account."),Promise.resolve(!0))},WL=async e=>(await new Promise(t=>setTimeout(t,ar)),Promise.resolve([...Xe.exams].filter(t=>t.adminId===e).sort((t,r)=>r.id.localeCompare(t.id)))),YL=async(e,t)=>{await new Promise(n=>setTimeout(n,ar));for(const n of Xe.exams)if(!n.seatingPlan&&n.adminId===t){let a;n.editorMode==="classic"||n.editorMode==="advanced"?a=await up({halls:n.halls,studentSets:n.studentSets,seatingType:n.seatingType}):a=await fp({halls:n.halls,studentSets:n.studentSets,rules:n.aiSeatingRules,seatingType:n.seatingType,editorMode:n.editorMode}),a.plan&&(n.seatingPlan=a.plan)}const r=Xe.exams.filter(n=>n.adminId!==t||!n.seatingPlan?!1:Object.values(n.seatingPlan).some(a=>a.some(s=>s.some(l=>{var o;return((o=l==null?void 0:l.student)==null?void 0:o.id)===e}))));return Promise.resolve(r.sort((n,a)=>a.id.localeCompare(n.id)))},qL=async e=>{await new Promise(r=>setTimeout(r,ar));const t=Xe.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(Xe.exams.filter(r=>r.adminId===t.adminId).sort((r,n)=>n.id.localeCompare(r.id)))},$L=async(e,t)=>{await new Promise(a=>setTimeout(a,ar));const r=await Td(t);if(!r||!r.adminId)throw new Error("Teacher not assigned.");const n={...e,id:`exam${Date.now()}`,createdBy:t,adminId:r.adminId,halls:e.halls.map((a,s)=>({...a,id:`hall${Date.now()}${s}`})),studentSets:e.studentSets.map((a,s)=>({...a,id:`set${Date.now()}${s}`})),seatingPlan:void 0};return Xe.exams=[...Xe.exams,n],ti(r.adminId,r.name,At.TEACHER,"CREATED_EXAM",`Created new exam: "${n.title}"`),Promise.resolve(n)},sm=async e=>{await new Promise(r=>setTimeout(r,ar));const t=Xe.users.find(r=>r.id===e.createdBy);return Xe.exams=Xe.exams.map(r=>r.id===e.id?e:r),t&&t.adminId&&ti(t.adminId,t.name,At.TEACHER,"UPDATED_EXAM",`Updated exam: "${e.title}"`),Promise.resolve(e)},ZL=async(e,t,r)=>{await new Promise(a=>setTimeout(a,ar));const n=Xe.exams.findIndex(a=>a.id===e);return n===-1?Promise.resolve(!1):(Xe.exams[n].seatingPlan=t,Promise.resolve(!0))},gT=async(e,t,r)=>{await new Promise(s=>setTimeout(s,ar));const n=Xe.exams.find(s=>s.id===e);if(!n)return Promise.resolve(!1);if(r===At.ADMIN&&n.adminId===t||r===At.TEACHER){const s=Xe.exams.length;if(Xe.exams=Xe.exams.filter(l=>l.id!==e),Xe.exams.length<s)return ti(n.adminId,r===At.ADMIN?"Admin":"Teacher",r,"DELETED_EXAM",`Deleted exam: "${n.title}"`),Promise.resolve(!0)}return Promise.resolve(!1)},eH=async e=>{await new Promise(r=>setTimeout(r,ar));const t=Xe.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(Xe.hallTemplates.filter(r=>r.adminId===t.adminId))},tH=async e=>(await new Promise(t=>setTimeout(t,ar)),Promise.resolve(Xe.hallTemplates.filter(t=>t.adminId===e))),Rc=async(e,t)=>{await new Promise(s=>setTimeout(s,ar));const r=await Td(t);if(!r)throw new Error("Creator not found.");const n=r.role===At.ADMIN?r.id:r.adminId,a={...e,id:`template${Date.now()}`,createdBy:t,adminId:n};return Xe.hallTemplates=[...Xe.hallTemplates,a],Promise.resolve(a)},rH=async(e,t,r)=>{await new Promise(s=>setTimeout(s,ar));const n=Xe.hallTemplates.findIndex(s=>s.id===e);if(n===-1)return Promise.resolve(null);const a={...Xe.hallTemplates[n],...t};return Xe.hallTemplates[n]=a,Promise.resolve(a)},mT=async(e,t,r)=>{await new Promise(a=>setTimeout(a,ar));const n=Xe.hallTemplates.length;return Xe.hallTemplates=Xe.hallTemplates.filter(a=>a.id!==e),Promise.resolve(Xe.hallTemplates.length<n)},nH=async e=>{await new Promise(r=>setTimeout(r,ar));const t=Xe.users.find(r=>r.id===e);return!t||!t.adminId?Promise.resolve([]):Promise.resolve(Xe.studentSetTemplates.filter(r=>r.adminId===t.adminId))},aH=async e=>(await new Promise(t=>setTimeout(t,ar)),Promise.resolve(Xe.studentSetTemplates.filter(t=>t.adminId===e))),cp=async(e,t)=>{await new Promise(s=>setTimeout(s,ar));const r=await Td(t);if(!r)throw new Error("Creator not found.");const n=r.role===At.ADMIN?r.id:r.adminId,a={...e,id:`settemplate${Date.now()}`,createdBy:t,adminId:n};return Xe.studentSetTemplates=[...Xe.studentSetTemplates,a],Promise.resolve(a)},AH=async(e,t,r)=>{await new Promise(s=>setTimeout(s,ar));const n=Xe.studentSetTemplates.findIndex(s=>s.id===e);if(n===-1)return Promise.resolve(null);const a={...Xe.studentSetTemplates[n],...t};return Xe.studentSetTemplates[n]=a,Promise.resolve(a)},pT=async(e,t,r)=>{await new Promise(a=>setTimeout(a,ar));const n=Xe.studentSetTemplates.length;return Xe.studentSetTemplates=Xe.studentSetTemplates.filter(a=>a.id!==e),Promise.resolve(Xe.studentSetTemplates.length<n)},xT=e=>{const t=[];return e.forEach(r=>{if(r.students&&r.students.length>0)r.students.forEach((n,a)=>t.push({id:n,setId:r.id,setNumber:a+1}));else{const n=/^\d+$/.test(r.subject)?r.subject:"999",a=Math.max(2,r.studentCount.toString().length);for(let s=0;s<r.studentCount;s++){const l=(s+1).toString().padStart(a,"0");t.push({id:`${n}${l}`,setId:r.id,setNumber:s+1})}}}),t},up=async e=>{var f;const{halls:t,studentSets:r,seatingType:n="normal"}=e,a=xT(r),s=new Map,l={};if(r.forEach(d=>{l[d.id]=a.filter(m=>m.setId===d.id)}),n==="fair"){let d=0,m=0;for(const x of t){const y=x.layout.filter(C=>C.type!=="faculty").sort((C,S)=>{var F;return(((F=x.constraints)==null?void 0:F.arrangement)||"horizontal")==="vertical"?C.col!==S.col?C.col-S.col:C.row-S.row:C.row!==S.row?C.row-S.row:C.col-S.col}),E=((f=x.constraints)==null?void 0:f.type)==="advanced"?x.constraints.allowedSetIds:Object.keys(l);for(const C of y){const S=E.filter(T=>l[T].length>0);if(S.length===0)break;if(S.length===1){if(d>0){d--;continue}const T=S[0];if(l[T]&&l[T].length>0){const F=l[T].shift();s.set(`${x.id}-${C.row}-${C.col}`,F),d=1}else break}else{let T,F=0;for(;!T&&F<S.length;){const _=S[m%S.length];l[_].length>0&&(T=l[_].shift()),m++,F++}if(T)s.set(`${x.id}-${C.row}-${C.col}`,T);else break}}}}else{let d=0;for(const m of t){const x=m.layout.filter(E=>E.type!=="faculty").sort((E,C)=>{var T;return(((T=m.constraints)==null?void 0:T.arrangement)||"horizontal")==="vertical"?E.col!==C.col?E.col-C.col:E.row-C.row:E.row!==C.row?E.row-C.row:E.col-C.col}),y=()=>{var S;const E=Object.keys(l).filter(T=>l[T].length>0),C=((S=m.constraints)==null?void 0:S.type)==="advanced"?m.constraints.allowedSetIds:null;return C?E.filter(T=>C.includes(T)):E};for(const E of x){const C=y();if(C.length===0)break;let S,T=0;for(;!S&&T<C.length;){const F=C[d%C.length];l[F].length>0&&(S=l[F].shift()),d++,T++}if(S)s.set(`${m.id}-${E.row}-${E.col}`,S);else break}}}const o=Object.values(l).flat();if(o.length>0)return n==="fair"?{plan:null,message:"not enough seats for fair seating"}:{plan:null,message:`Failed to assign all students. ${o.length} students remain unplaced.`};const u={};return t.forEach(d=>{const m=Math.max(-1,...d.layout.map(E=>E.row)),x=Math.max(-1,...d.layout.map(E=>E.col)),y=Array.from({length:m+1},()=>Array(x+1).fill(null));d.layout.forEach(E=>{const C=s.get(`${d.id}-${E.row}-${E.col}`);y[E.row][E.col]={...E,hallId:d.id,...C&&{student:C}}}),u[d.id]=y}),{plan:u,message:"Classic seating plan generated successfully!"}},fp=async e=>{const{halls:t,studentSets:r,rules:n,seatingType:a,editorMode:s}=e,l=xT(r),o=t.flatMap(x=>x.layout.filter(y=>y.type!=="faculty"));if(a!=="fair"&&l.length>o.length)return{plan:null,message:`Not enough seats. Required: ${l.length}, Available: ${o.length}.`};const u={halls:t.map(x=>({id:x.id,name:x.name,seats:x.layout.map(y=>({row:y.row,col:y.col,type:y.type})),constraints:x.constraints})),studentSets:r.map(x=>({id:x.id,subject:x.subject,students:l.filter(y=>y.setId===x.id).map(y=>y.id)}))};let f=a==="fair"?"**CRITICAL: FAIR SEATING MODE**...":"**CRITICAL: NORMAL SEATING MODE**...",d=s==="ai-advanced"?"**STRICT HARD CONSTRAINTS**...":"";const m=`Assistant task: Assign every student to unique seat... [JSON Data: ${JSON.stringify(u)}] ... [Rules: ${f} ${d}] ... [Custom: ${n}]`;try{const y=await new fT({apiKey:"PLACEHOLDER_API_KEY"}).models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:m}]}],config:{responseMimeType:"application/json",responseSchema:{type:on.OBJECT,properties:{assignments:{type:on.ARRAY,items:{type:on.OBJECT,properties:{studentId:{type:on.STRING},hallId:{type:on.STRING},row:{type:on.INTEGER},col:{type:on.INTEGER}},required:["studentId","hallId","row","col"]}}},required:["assignments"]}}}),C=JSON.parse(y.text).assignments;if(C.length!==l.length)return{plan:null,message:`AI Error: Expected ${l.length}, got ${C.length}.`};const S=new Map;C.forEach(F=>{const _=l.find(Q=>Q.id===F.studentId);_&&S.set(`${F.hallId}-${F.row}-${F.col}`,_)});const T={};return t.forEach(F=>{const _=Math.max(-1,...F.layout.map(R=>R.row)),Q=Math.max(-1,...F.layout.map(R=>R.col)),L=Array.from({length:_+1},()=>Array(Q+1).fill(null));F.layout.forEach(R=>{const U=S.get(`${F.id}-${R.row}-${R.col}`);L[R.row][R.col]={...R,hallId:F.id,...U&&{student:U}}}),T[F.id]=L}),{plan:T,message:"AI-powered seating plan generated successfully!"}}catch(x){return{plan:null,message:`AI Communication Error: ${x.message}`}}},sH=async(e,t)=>{const r=new fT({apiKey:"PLACEHOLDER_API_KEY"}),n="Expert image analysis...";try{const a=await r.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:t,data:e}},{text:n}]},config:{responseMimeType:"application/json",responseSchema:{type:on.OBJECT,properties:{rows:{type:on.INTEGER},cols:{type:on.INTEGER},matrix:{type:on.ARRAY,items:{type:on.STRING}}},required:["rows","cols","matrix"]}}}),l=JSON.parse(a.text).matrix;if(!l||l.length===0)return null;const o=l.length,u=Math.max(...l.map(d=>d.length)),f=[];for(let d=0;d<o;d++){const m=l[d];for(let x=0;x<m.length;x++)m[x]==="1"&&f.push({id:`seat-${d}-${x}-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,row:d,col:x,type:"standard"})}return{layout:f,rows:o,cols:u}}catch{return null}},iH=async(e,t)=>{const r=await GL(e);return r&&r.password===t?r.role===At.SUPER_ADMIN?r:((r.role===At.ADMIN||r.role===At.TEACHER)&&!r.permissionGranted&&console.warn(`${r.role} ${r.name} login attempt failed: Permission not granted.`),Promise.resolve(r)):Promise.resolve(null)},lH=(e,t,r,n)=>VL(e,t,r,n),oH=(e,t,r,n)=>KL(e,t,r,n),cH=(e,t)=>{if(/^\d+$/.test(e)&&e.length>0){const r={id:e,name:`Student ${e}`,email:"",role:At.STUDENT,registerNumber:e,adminId:t};return Promise.resolve(r)}return Promise.resolve(null)},uH=()=>(console.log("User logged out."),Promise.resolve()),vT=X.createContext(void 0),fH=({children:e})=>{const[t,r]=X.useState(()=>{const f=localStorage.getItem("user");return f?JSON.parse(f):null}),n=async(f,d)=>{const m=await iH(f,d);return m&&(r(m),localStorage.setItem("user",JSON.stringify(m))),m},a=async(f,d,m,x)=>await oH(f,d,m,x),s=async(f,d,m,x)=>await lH(f,d,m,x),l=async(f,d)=>{const m=await cH(f,d);return m&&(r(m),localStorage.setItem("user",JSON.stringify(m))),m},o=()=>{uH(),r(null),localStorage.removeItem("user")},u=!!t;return h.jsx(vT.Provider,{value:{user:t,isAuthenticated:u,login:n,logout:o,loginStudent:l,registerTeacher:a,registerAdmin:s},children:e})},ri=()=>{const e=X.useContext(vT);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},wT=X.createContext(void 0),dH=({children:e})=>{const[t,r]=X.useState(()=>{const a=localStorage.getItem("theme");return a||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});X.useEffect(()=>{const a=window.document.documentElement;a.classList.remove("dark","black","lavender","lightblue","limegreen","lightred","lightyellow","lightpink","lightindigo"),t==="dark"?a.classList.add("dark"):t==="black"?a.classList.add("dark","black"):t==="lavender"?a.classList.add("lavender"):t==="lightblue"?a.classList.add("lightblue"):t==="limegreen"?a.classList.add("limegreen"):t==="lightred"?a.classList.add("lightred"):t==="lightyellow"?a.classList.add("lightyellow"):t==="lightpink"?a.classList.add("lightpink"):t==="lightindigo"&&a.classList.add("lightindigo"),localStorage.setItem("theme",t)},[t]);const n=()=>{r(a=>a==="light"?"dark":a==="dark"?"black":a==="black"?"lavender":a==="lavender"?"lightblue":a==="lightblue"?"limegreen":a==="limegreen"?"lightred":a==="lightred"?"lightyellow":a==="lightyellow"?"lightpink":a==="lightpink"?"lightindigo":"light")};return h.jsx(wT.Provider,{value:{theme:t,toggleTheme:n},children:e})},hH=()=>{const e=X.useContext(wT);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},jt=X.forwardRef(({children:e,className:t="",...r},n)=>h.jsx("div",{ref:n,className:`bg-white dark:bg-slate-800 rounded-xl shadow-md dark:shadow-none dark:border dark:border-slate-700 overflow-hidden p-6 sm:p-8 ${t}`,...r,children:e}));jt.displayName="Card";const gH=({className:e})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),mH=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),Ut=({label:e,id:t,containerClassName:r="",type:n="text",inputSize:a="md",...s})=>{const[l,o]=X.useState(!1),u=n==="password",f=()=>{o(!l)},d=u?l?"text":"password":n,m={sm:"px-2 py-1 text-sm",md:"px-3 py-2",lg:"px-4 py-3 text-lg"};return h.jsxs("div",{className:r,children:[e&&h.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:e}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{id:t,type:d,className:`w-full ${m[a]} border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:placeholder-slate-400 dark:focus:ring-violet-400 dark:focus:border-violet-400 ${u?"pr-10":""}`,...s}),u&&h.jsx("button",{type:"button",onClick:f,className:"absolute inset-y-0 right-0 px-3 flex items-center text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors focus:outline-none",tabIndex:-1,children:l?h.jsx(mH,{className:"h-5 w-5"}):h.jsx(gH,{className:"h-5 w-5"})})]})]})},tt=({children:e,variant:t="primary",size:r="md",className:n="",type:a="button",...s})=>{const l="font-bold rounded-lg transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:scale-100 flex items-center justify-center",o={sm:"py-1 px-3 text-sm",md:"py-2 px-4",lg:"py-3 px-6 text-lg"},u={primary:"bg-violet-600 text-white hover:bg-violet-700 shadow-md",secondary:"bg-slate-200 text-slate-800 hover:bg-slate-300 dark:bg-slate-700 dark:text-slate-200 dark:hover:bg-slate-600",danger:"bg-red-500 text-white hover:bg-red-600 shadow-md",outline:"border-2 border-slate-300 text-slate-600 hover:bg-slate-50 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-800"};return h.jsx("button",{type:a,className:`${l} ${o[r]} ${u[t]} ${n}`,...s,children:e})},yT=({className:e="h-8 w-8",...t})=>h.jsx("img",{src:"https://img.icons8.com/plasticine/100/graduation-cap.png",alt:"Smart Exam Planner Logo",className:`object-contain ${e}`,...t}),pH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),xH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),vH=()=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"}),h.jsx("path",{d:"M12 3a9 9 0 000 18V3z",fill:"currentColor"})]}),wH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),yH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),BH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 21.75H18.75m-13.5 0v-8.25h13.5v8.25m-13.5 0H3.375c-.621 0-1.125-.504-1.125-1.125V9.375c0-.621.504-1.125 1.125-1.125h1.5c.621 0 1.125.504 1.125 1.125v11.25m0-11.25h10.5m0 0v-1.125c0-.621-.504-1.125-1.125-1.125h-7.5c-.621 0-1.125.504-1.125 1.125V9.375m10.5 0h1.875c.621 0 1.125-.504 1.125-1.125V6.375c0-.621-.504-1.125-1.125-1.125h-1.5c-.621 0-1.125.504-1.125 1.125V9.375"})}),CH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),EH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),SH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),TH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),BT=()=>{const{theme:e,toggleTheme:t}=hH();return h.jsxs("button",{onClick:t,className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500 dark:focus:ring-offset-slate-800 transition-colors","aria-label":"Toggle theme",children:[e==="light"&&h.jsx(xH,{}),e==="dark"&&h.jsx(vH,{}),e==="black"&&h.jsx(wH,{}),e==="lavender"&&h.jsx(yH,{}),e==="lightblue"&&h.jsx(BH,{}),e==="limegreen"&&h.jsx(CH,{}),e==="lightred"&&h.jsx(SH,{}),e==="lightyellow"&&h.jsx(EH,{}),e==="lightpink"&&h.jsx(TH,{}),e==="lightindigo"&&h.jsx(pH,{})]})},_H=()=>{const[e,t]=X.useState(""),[r,n]=X.useState(""),[a,s]=X.useState(""),[l,o]=X.useState("admin"),[u,f]=X.useState("login"),[d,m]=X.useState(""),[x,y]=X.useState(""),[E,C]=X.useState(""),[S,T]=X.useState(""),[F,_]=X.useState(""),[Q,L]=X.useState([]),[R,U]=X.useState(""),[K,D]=X.useState(""),[ee,re]=X.useState(1),[Z,ae]=X.useState(""),[Te,Se]=X.useState(""),[q,Ae]=X.useState(!1),{login:Re,loginStudent:ie,registerTeacher:Me,registerAdmin:J}=ri(),k=xd();X.useEffect(()=>{(async()=>{try{const Ie=await PL();L(Ie)}catch(Ie){console.error("Failed to fetch institutions:",Ie)}})()},[]);const V=async N=>{N.preventDefault(),Ae(!0),ae(""),Se(""),setTimeout(()=>{Ae(!1),re(2)},500)},P=async N=>{if(N.preventDefault(),Ae(!0),ae(""),Se(""),K!=="123456"){ae("Invalid OTP. Please use 123456 for this demo."),Ae(!1);return}const Ie=await Re(e,r);if(Ae(!1),Ie){if(Ie.role===At.SUPER_ADMIN){k("/super-admin");return}l==="admin"?Ie.role===At.ADMIN?Ie.permissionGranted?k("/admin"):(ae("Account Pending: A Super Admin must approve your institutional registration."),re(1)):(ae("This account does not have admin privileges."),re(1)):l==="teacher"&&(Ie.role===At.TEACHER?Ie.permissionGranted?k("/teacher"):(ae("Account Pending: Your institutional administrator must grant you permission."),re(1)):(ae("This account is not a teacher account."),re(1)))}else ae("Invalid credentials. Please try again."),re(1)},z=async N=>{if(N.preventDefault(),Ae(!0),ae(""),Se(""),!d||!e||!x||!S){ae("Please fill in all fields."),Ae(!1);return}if(x!==E){ae("Passwords do not match."),Ae(!1);return}if(x.length<6){ae("Password must be at least 6 characters long."),Ae(!1);return}const Ie=await J(d,e,x,S);Ae(!1),Ie?(Se("Registration request sent! A Super Admin will review and approve your institution shortly."),f("login"),m(""),t(""),y(""),C(""),T("")):ae("An account with this email already exists.")},le=async N=>{if(N.preventDefault(),Ae(!0),ae(""),Se(""),!d||!e||!x||!F){ae("Please fill in all fields."),Ae(!1);return}if(x!==E){ae("Passwords do not match."),Ae(!1);return}if(x.length<6){ae("Password must be at least 6 characters long."),Ae(!1);return}const Ie=await Me(d,e,x,F);Ae(!1),Ie?(Se("Account created. Your institution admin must grant permission before you can log in."),f("login"),m(""),t(""),y(""),C(""),_("")):ae("Registration failed. Please check your details.")},Be=async N=>{if(N.preventDefault(),Ae(!0),ae(""),!R){ae("Please select your institution."),Ae(!1);return}const Ie=await ie(a,R);Ae(!1),Ie?k("/student"):ae("Please enter a valid, numeric Register Number.")},de=N=>{o(N),ae(""),Se(""),re(1),t(""),n(""),D(""),s(""),f("login"),m(""),y(""),C(""),T(""),_(""),U("")},ce=()=>h.jsx(h.Fragment,{children:ee===1?h.jsxs("form",{onSubmit:V,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6 text-rose-600 dark:text-rose-400",children:"System Oversight"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Master Email",id:"email",type:"email",value:e,onChange:N=>t(N.target.value),required:!0,placeholder:"super@exam.com"}),h.jsx(Ut,{label:"Master Password",id:"password",type:"password",value:r,onChange:N=>n(N.target.value),required:!0,placeholder:"Enter master password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6 bg-rose-600 hover:bg-rose-700",disabled:q,children:q?"Accessing...":"Verify Identity"})]}):h.jsxs("form",{onSubmit:P,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-2",children:"Master Verification"}),h.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:"Enter secure 6-digit bypass code."}),h.jsx("div",{className:"space-y-4",children:h.jsx(Ut,{label:"Security Code",id:"otp",type:"text",value:K,onChange:N=>D(N.target.value),required:!0,placeholder:"123456"})}),h.jsx(tt,{type:"submit",className:"w-full mt-6 bg-rose-600 hover:bg-rose-700",disabled:q,children:q?"Authenticating...":"Enter Command Center"}),h.jsx(tt,{variant:"secondary",onClick:()=>{re(1),ae("")},className:"w-full mt-2",children:"Back"})]})}),ne=()=>u==="register"?h.jsxs("form",{onSubmit:z,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Institution Registration"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Full Name",id:"registerName",type:"text",value:d,onChange:N=>m(N.target.value),required:!0,placeholder:"e.g., Jane Doe"}),h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:N=>t(N.target.value),required:!0,placeholder:"e.g., admin@exam.com"}),h.jsx(Ut,{label:"Institution / Organization Name",id:"registerInstitution",type:"text",value:S,onChange:N=>T(N.target.value),required:!0,placeholder:"e.g., Global Tech University"}),h.jsx(Ut,{label:"Password",id:"registerPassword",type:"password",value:x,onChange:N=>y(N.target.value),required:!0,placeholder:"Minimum 6 characters"}),h.jsx(Ut,{label:"Confirm Password",id:"confirmPassword",type:"password",value:E,onChange:N=>C(N.target.value),required:!0,placeholder:"Re-enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Sending Request...":"Register Institution"}),h.jsx(tt,{variant:"secondary",onClick:()=>{f("login"),ae(""),Se("")},className:"w-full mt-2",children:"Back to Login"})]}):h.jsx(h.Fragment,{children:ee===1?h.jsxs("form",{onSubmit:V,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Staff Login"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:N=>t(N.target.value),required:!0,placeholder:"e.g., admin@exam.com"}),h.jsx(Ut,{label:"Password",id:"password",type:"password",value:r,onChange:N=>n(N.target.value),required:!0,placeholder:"Enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Loading...":"Continue"}),h.jsxs("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400 mt-4",children:["New institution?"," ",h.jsx("button",{type:"button",onClick:()=>{f("register"),ae("")},className:"font-bold text-violet-600 hover:text-violet-500 dark:text-violet-400 dark:hover:text-violet-300 focus:outline-none",children:"Register here"})]})]}):h.jsxs("form",{onSubmit:P,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-2",children:"Verification"}),h.jsxs("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:['An OTP has been "sent" to your email. ',h.jsx("br",{}),"(Hint: use ",h.jsx("strong",{children:"123456"}),")"]}),h.jsx("div",{className:"space-y-4",children:h.jsx(Ut,{label:"One-Time Password",id:"otp",type:"text",value:K,onChange:N=>D(N.target.value),required:!0,placeholder:"Enter 6-digit code"})}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Verifying...":"Verify & Login"}),h.jsx(tt,{variant:"secondary",onClick:()=>{re(1),ae("")},className:"w-full mt-2",children:"Back"})]})}),Ce=()=>u==="register"?h.jsxs("form",{onSubmit:le,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Teacher Registration"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Full Name",id:"teacherName",type:"text",value:d,onChange:N=>m(N.target.value),required:!0,placeholder:"e.g., Dr. Evelyn Reed"}),h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:N=>t(N.target.value),required:!0,placeholder:"e.g., teacher@exam.com"}),h.jsx(Ut,{label:"Admin ID or Institution Name",id:"adminIdentifier",type:"text",value:F,onChange:N=>_(N.target.value),required:!0,placeholder:"Enter institution name"}),h.jsx(Ut,{label:"Password",id:"teacherPassword",type:"password",value:x,onChange:N=>y(N.target.value),required:!0,placeholder:"Minimum 6 characters"}),h.jsx(Ut,{label:"Confirm Password",id:"confirmPassword",type:"password",value:E,onChange:N=>C(N.target.value),required:!0,placeholder:"Re-enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Creating...":"Create Account"}),h.jsx(tt,{variant:"secondary",onClick:()=>{f("login"),ae(""),Se("")},className:"w-full mt-2",children:"Back to Login"})]}):h.jsx(h.Fragment,{children:ee===1?h.jsxs("form",{onSubmit:V,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Teacher Login"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Email Address",id:"email",type:"email",value:e,onChange:N=>t(N.target.value),required:!0,placeholder:"e.g., teacher1@exam.com"}),h.jsx(Ut,{label:"Password",id:"password",type:"password",value:r,onChange:N=>n(N.target.value),required:!0,placeholder:"Enter your password"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Loading...":"Continue"}),h.jsxs("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400 mt-4",children:["Don't have an account?"," ",h.jsx("button",{type:"button",onClick:()=>{f("register"),ae("")},className:"font-bold text-violet-600 hover:text-violet-500 dark:text-violet-400 dark:hover:text-violet-300 focus:outline-none",children:"Create one"})]})]}):h.jsxs("form",{onSubmit:P,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-2",children:"Verification"}),h.jsxs("p",{className:"text-center text-slate-500 dark:text-slate-400 mb-6",children:['An OTP has been "sent" to your email. ',h.jsx("br",{}),"(Hint: use ",h.jsx("strong",{children:"123456"}),")"]}),h.jsx("div",{className:"space-y-4",children:h.jsx(Ut,{label:"One-Time Password",id:"otp",type:"text",value:K,onChange:N=>D(N.target.value),required:!0,placeholder:"Enter 6-digit code"})}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q,children:q?"Verifying...":"Verify & Login"}),h.jsx(tt,{variant:"secondary",onClick:()=>{re(1),ae("")},className:"w-full mt-2",children:"Back"})]})});return h.jsxs("div",{className:"min-h-screen flex flex-col justify-center items-center p-4 relative bg-slate-50 dark:bg-slate-900",children:[h.jsx("div",{className:"absolute top-4 right-4",children:h.jsx(BT,{})}),h.jsxs("div",{className:"text-center mb-8 flex flex-col items-center gap-4",children:[h.jsx(yT,{className:"h-16 w-16"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-black text-violet-700 dark:text-violet-400",children:"Smart Exam Planner"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 font-medium",children:"Global Examination Logistics Platform"})]})]}),h.jsxs(jt,{className:"w-full max-w-md shadow-2xl overflow-visible",children:[h.jsxs("div",{className:"flex flex-wrap justify-center border-b border-slate-200 dark:border-slate-700 mb-6",children:[h.jsx("button",{onClick:()=>de("admin"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${l==="admin"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 hover:text-slate-700"}`,children:"Admin"}),h.jsx("button",{onClick:()=>de("teacher"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${l==="teacher"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 hover:text-slate-700"}`,children:"Teacher"}),h.jsx("button",{onClick:()=>de("student"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${l==="student"?"text-violet-600 dark:text-violet-400 border-b-2 border-violet-600 dark:border-violet-400":"text-slate-500 hover:text-slate-700"}`,children:"Student"}),h.jsx("button",{onClick:()=>de("super"),className:`px-3 py-2 text-xs font-black uppercase tracking-widest transition-all ${l==="super"?"text-rose-600 dark:text-rose-400 border-b-2 border-rose-600 dark:border-rose-400":"text-slate-400 hover:text-rose-500"}`,children:"Super"})]}),Te&&h.jsx("p",{className:"text-green-600 bg-green-50 dark:text-green-400 dark:bg-green-500/10 p-3 rounded-xl text-sm mb-4 text-center font-medium border border-green-100 dark:border-green-900/30",children:Te}),Z&&h.jsx("p",{className:"text-red-600 bg-red-100 dark:text-red-300 dark:bg-red-500/20 p-3 rounded-xl text-sm mb-4 text-center font-medium border border-red-100 dark:border-red-900/30",children:Z}),l==="super"&&ce(),l==="admin"&&ne(),l==="teacher"&&Ce(),l==="student"&&h.jsxs("form",{onSubmit:Be,children:[h.jsx("h2",{className:"text-2xl font-black text-center mb-6",children:"Student Login"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"institution-select",className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Institution"}),h.jsxs("select",{id:"institution-select",value:R,onChange:N=>U(N.target.value),required:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 font-medium",children:[h.jsx("option",{value:"",disabled:!0,children:"Select your institution"}),Q.map(N=>h.jsx("option",{value:N.id,children:N.name},N.id))]})]}),h.jsx(Ut,{label:"Register Number",id:"registerNumber",type:"text",value:a,onChange:N=>s(N.target.value),required:!0,placeholder:"e.g., 101001"})]}),h.jsx(tt,{type:"submit",className:"w-full mt-6",disabled:q||!R,children:q?"Logging In...":"Login"})]})]}),l==="super"&&h.jsxs("div",{className:"mt-8 p-4 bg-rose-50 dark:bg-rose-900/10 border border-rose-100 dark:border-rose-900/30 rounded-xl max-w-sm text-center",children:[h.jsx("p",{className:"text-xs font-bold text-rose-700 dark:text-rose-300 uppercase tracking-widest mb-1",children:"Restricted Access"}),h.jsx("p",{className:"text-[10px] text-rose-600/70 dark:text-rose-400/70",children:"This area is reserved for the primary system owner only. Unauthorized access attempts are logged."})]})]})},bH=({user:e,isOpen:t,onClose:r})=>{const[n,a]=X.useState(""),[s,l]=X.useState(!1);if(X.useEffect(()=>{t&&(l(!0),e.role===At.ADMIN?(a(e.institutionName||"N/A"),l(!1)):e.role===At.TEACHER&&e.adminId?Td(e.adminId).then(u=>{a(u?u.institutionName||"N/A":"Institution not found"),l(!1)}):(a("N/A"),l(!1)))},[e,t]),!t)return null;const o=u=>{switch(u){case At.ADMIN:return"Admin";case At.TEACHER:return"Teacher";case At.STUDENT:return"Student";default:return""}};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:r,children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md",onClick:u=>u.stopPropagation(),children:[h.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-slate-800 dark:text-slate-200",children:"User Profile"}),h.jsx(jt,{children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Username"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:e.name})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Email ID"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300 break-all",children:e.email})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Institution / Organization"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:s?"Loading...":n})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Role"}),h.jsx("p",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:o(e.role)})]})]})}),h.jsx("div",{className:"mt-6 text-right",children:h.jsx(tt,{onClick:r,variant:"secondary",children:"Close"})})]})})},FH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),UH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),yA=()=>{const{user:e,logout:t}=ri(),r=xd(),[n,a]=X.useState(!1),s=()=>{t(),r("/login")},l=o=>{switch(o){case At.SUPER_ADMIN:return"Super Admin";case At.ADMIN:return"Admin";case At.TEACHER:return"Teacher";case At.STUDENT:return"Student";default:return""}};return h.jsxs(h.Fragment,{children:[h.jsx("header",{className:"sticky top-0 z-50 w-full bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm shadow-md dark:shadow-none dark:border-b dark:border-slate-700",children:h.jsxs("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(yT,{className:"h-9 w-9"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-violet-700 dark:text-violet-400",children:"Smart Exam Planner"}),e&&h.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Welcome, ",e.name," (",l(e.role),")"]})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[e&&h.jsxs(h.Fragment,{children:[(e.role===At.SUPER_ADMIN||e.role===At.ADMIN||e.role===At.TEACHER)&&h.jsxs("button",{onClick:()=>a(!0),className:"hidden sm:flex items-center text-slate-600 hover:text-violet-700 dark:text-slate-300 dark:hover:text-violet-400 transition","aria-label":"View Profile",children:[h.jsx(UH,{}),h.jsx("span",{className:"hidden lg:inline",children:"Profile"})]}),h.jsxs("button",{onClick:s,className:"flex items-center text-slate-600 hover:text-violet-700 dark:text-slate-300 dark:hover:text-violet-400 transition","aria-label":"Logout",children:[h.jsx(FH,{}),h.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}),h.jsx(BT,{})]})]})}),e&&(e.role===At.SUPER_ADMIN||e.role===At.ADMIN||e.role===At.TEACHER)&&h.jsx(bH,{user:e,isOpen:n,onClose:()=>a(!1)})]})},QC=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),RC=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),DC=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),kH=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),im=({title:e,value:t,icon:r,colorClass:n})=>h.jsxs("div",{className:`p-6 rounded-xl border shadow-sm flex items-center justify-between transition-all hover:scale-[1.02] ${n}`,children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold opacity-80 uppercase tracking-widest",children:e}),h.jsx("p",{className:"text-3xl font-black mt-2",children:t})]}),h.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:r})]}),NH=()=>{const{user:e}=ri(),[t,r]=X.useState([]),[n,a]=X.useState([]),[s,l]=X.useState(!0),[o,u]=X.useState(""),[f,d]=X.useState("institutes"),m=X.useCallback(async()=>{l(!0);const[S,T]=await Promise.all([LL(),dT("")]);r(S),a(T),l(!1)},[]);X.useEffect(()=>{m()},[m]);const x=async S=>{window.confirm("Grant administrator access to this institution?")&&(await HL(S),await m())},y=async(S,T)=>{const F=`CRITICAL WARNING: You are about to permanently delete "${T}". 
This will wipe all associated data:
- Admin account
- All Teacher accounts
- All Student sessions
- All Exam schedules
- All Hall layouts
- All Audit logs
THIS ACTION CANNOT BE UNDONE. Type 'DELETE' to proceed.`;window.prompt(F)==="DELETE"&&(await OL(S)?await m():alert("Failed to delete institution."))},E=t.filter(S=>{var T;return((T=S.institutionName)==null?void 0:T.toLowerCase().includes(o.toLowerCase()))||S.name.toLowerCase().includes(o.toLowerCase())||S.email.toLowerCase().includes(o.toLowerCase())}),C=t.filter(S=>!S.permissionGranted);return h.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-black text-slate-800 dark:text-slate-100",children:"Command Center"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Global management of institutional infrastructures."})]})}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[h.jsx(im,{title:"Institutions",value:t.length,icon:h.jsx(RC,{className:"h-6 w-6 text-violet-600 dark:text-violet-300"}),colorClass:"bg-violet-50 border-violet-100 text-violet-900 dark:bg-violet-900/20 dark:border-violet-900/50 dark:text-violet-100"}),h.jsx(im,{title:"Pending Requests",value:C.length,icon:h.jsx(DC,{className:"h-6 w-6 text-amber-600 dark:text-amber-300"}),colorClass:"bg-amber-50 border-amber-100 text-amber-900 dark:bg-amber-900/20 dark:border-amber-900/50 dark:text-amber-100"}),h.jsx(im,{title:"System Uptime",value:"99.9%",icon:h.jsx(kH,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-300"}),colorClass:"bg-emerald-50 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-900/50 dark:text-emerald-100"})]}),h.jsx("div",{className:"mb-6 border-b border-slate-200 dark:border-slate-700",children:h.jsxs("nav",{className:"-mb-px flex space-x-8",children:[h.jsx("button",{onClick:()=>d("institutes"),className:`py-4 px-1 border-b-2 font-bold text-sm transition-colors ${f==="institutes"?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:"Institute Directory"}),h.jsx("button",{onClick:()=>d("audit"),className:`py-4 px-1 border-b-2 font-bold text-sm transition-colors ${f==="audit"?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:"Global Audit Logs"})]})}),f==="institutes"&&h.jsxs("div",{className:"space-y-8",children:[C.length>0&&h.jsxs("div",{className:"bg-amber-100/50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-800 rounded-2xl p-6",children:[h.jsxs("h3",{className:"text-lg font-black text-amber-800 dark:text-amber-200 mb-4 flex items-center gap-2",children:[h.jsx(DC,{className:"h-5 w-5"})," Urgent: Pending Approvals"]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(S=>h.jsxs(jt,{className:"!p-5 border-amber-200 shadow-sm",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("p",{className:"font-black text-slate-800 dark:text-slate-100 text-lg",children:S.institutionName}),h.jsxs("p",{className:"text-sm font-medium text-slate-500 mt-1",children:["Admin: ",S.name]}),h.jsx("p",{className:"text-xs text-slate-400 font-mono mt-1 truncate",children:S.email})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(tt,{size:"sm",className:"flex-1 !bg-emerald-600 !hover:bg-emerald-700",onClick:()=>x(S.id),children:"Approve Access"}),h.jsx("button",{onClick:()=>y(S.id,S.institutionName),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",title:"Reject & Delete",children:h.jsx(QC,{})})]})]},S.id))})]}),h.jsxs(jt,{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[h.jsx("h3",{className:"text-xl font-black text-slate-800 dark:text-slate-100",children:"Managed Institutions"}),h.jsx("div",{className:"relative w-full sm:w-72",children:h.jsx(Ut,{placeholder:"Search by name, email, or institute...",value:o,onChange:S=>u(S.target.value),containerClassName:"mb-0"})})]}),s?h.jsx("p",{className:"text-center py-12 text-slate-500",children:"Loading infrastructure data..."}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.length>0?E.map(S=>h.jsxs("div",{className:"bg-white dark:bg-slate-800/50 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 flex flex-col hover:border-violet-300 dark:hover:border-violet-900 transition-colors",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsx("div",{className:"p-3 bg-slate-100 dark:bg-slate-700 rounded-xl",children:h.jsx(RC,{className:"h-6 w-6 text-slate-600 dark:text-slate-300"})}),h.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-widest ${S.permissionGranted?"bg-green-100 text-green-700 dark:bg-green-900/30":"bg-amber-100 text-amber-700 dark:bg-amber-900/30"}`,children:S.permissionGranted?"Active":"Pending"})]}),h.jsxs("div",{className:"flex-grow",children:[h.jsx("h4",{className:"text-lg font-black text-slate-800 dark:text-slate-100 mb-1",children:S.institutionName}),h.jsx("p",{className:"text-sm font-bold text-slate-500",children:S.name}),h.jsx("p",{className:"text-xs text-slate-400 mt-3 font-mono",children:S.email})]}),h.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[S.permissionGranted?h.jsxs("div",{className:"text-[10px] font-bold text-slate-400 flex items-center gap-1 uppercase tracking-widest",children:[h.jsx(IH,{className:"h-3 w-3 text-emerald-500"})," Authorized"]}):h.jsx(tt,{size:"sm",onClick:()=>x(S.id),children:"Approve"}),h.jsxs("button",{onClick:()=>y(S.id,S.institutionName),className:"flex items-center gap-2 text-xs font-black text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 px-3 py-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[h.jsx(QC,{className:"h-4 w-4"})," Wipe Data"]})]})]},S.id)):h.jsx("p",{className:"col-span-full text-center py-12 text-slate-500 italic",children:"No institutions found."})})]})]}),f==="audit"&&h.jsxs(jt,{children:[h.jsx("h3",{className:"text-xl font-black mb-6 text-slate-800 dark:text-slate-100",children:"Global Activity Monitor"}),h.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:n.map(S=>h.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-slate-800/30 border border-slate-100 dark:border-slate-700 flex flex-col sm:flex-row gap-4",children:[h.jsx("div",{className:"flex-shrink-0 flex items-center",children:h.jsx("div",{className:`h-12 w-12 rounded-xl flex items-center justify-center font-black text-white shadow-sm ${S.role===At.SUPER_ADMIN?"bg-rose-500":S.role===At.ADMIN?"bg-sky-500":"bg-indigo-500"}`,children:S.actorName.charAt(0)})}),h.jsxs("div",{className:"flex-grow",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsxs("p",{className:"font-black text-slate-800 dark:text-slate-100",children:[S.actorName," ",h.jsxs("span",{className:"text-xs font-bold text-slate-400 ml-1",children:["(",S.role,")"]})]}),h.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-0.5",children:new Date(S.timestamp).toLocaleString()})]}),h.jsx("span",{className:"text-[10px] font-black px-2 py-1 bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg uppercase tracking-widest",children:S.action.replace(/_/g," ")})]}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-2 font-medium",children:S.details})]})]},S.id))})]})]})]})},IH=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),Ps=["bg-sky-200","bg-emerald-200","bg-amber-200","bg-violet-200","bg-rose-200","bg-cyan-200","bg-lime-200","bg-orange-200","bg-purple-200","bg-pink-200"],QH=e=>{switch(e){case"accessible":return{icon:h.jsx("span",{title:"Accessible Seating",children:""}),baseBg:"bg-blue-200 dark:bg-blue-600"};case"faculty":return{icon:h.jsx("span",{title:"Faculty/Invigilator Seat",children:""}),baseBg:"bg-yellow-200 dark:bg-yellow-600"};case"standard":default:return{icon:null,baseBg:"bg-slate-200 dark:bg-slate-600"}}},Zc=({hall:e,plan:t,studentSets:r,highlightSeat:n})=>{const a=t[e.id];if(!a)return h.jsxs("p",{children:["Seating plan for ",e.name," not available."]});const s=r.reduce((x,y,E)=>(x[y.id]=Ps[E%Ps.length],x),{}),l=a.reduce((x,y)=>Math.max(x,y.length),0),o=e.frontDirection||"top",u={top:"flex-col",bottom:"flex-col-reverse",left:"flex-row",right:"flex-row-reverse"},f=o==="left"||o==="right"?"w-10 flex-shrink-0 flex items-center justify-center py-4":"w-full py-2",d={top:"mb-4",bottom:"mt-4",left:"mr-4",right:"ml-4"},m=o==="left"||o==="right";return h.jsxs("div",{className:"w-full",children:[h.jsx("h3",{className:"text-xl font-bold mb-6 text-center text-slate-700 dark:text-slate-300",children:e.name}),h.jsxs("div",{className:`flex ${u[o]} items-stretch justify-center w-full`,children:[h.jsx("div",{className:`bg-slate-200 dark:bg-slate-700 rounded-md text-sm font-bold text-slate-600 dark:text-slate-300 shadow-inner flex items-center justify-center ${f} ${d[o]}`,children:h.jsx("span",{style:{writingMode:m?"vertical-rl":"horizontal-tb",transform:m?"rotate(180deg)":"none"},children:"FRONT OF HALL"})}),h.jsx("div",{className:"overflow-x-auto bg-slate-100 dark:bg-slate-800 p-6 rounded-xl flex-grow border border-slate-200 dark:border-slate-700",children:h.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${l}, minmax(5.5rem, 1fr))`},children:a.map((x,y)=>x.map((E,C)=>{if(!E)return h.jsx("div",{className:"h-12 sm:h-14"},`empty-${y}-${C}`);const S=QH(E.type),T=E.student?s[E.student.setId]:S.baseBg,_=n&&E.row===n.row&&E.col===n.col?"ring-4 ring-offset-2 ring-violet-500 dark:ring-violet-400 z-10":"border border-slate-300 dark:border-slate-500 shadow-sm";let Q=S.icon;return E.student&&(Q=E.student.id),h.jsx("div",{title:E.student?`Seat: R${E.row+1}C${E.col+1} - Student ID: ${E.student.id}`:`${E.type} Seat: R${E.row+1}C${E.col+1}`,className:`w-full h-12 sm:h-14 rounded-lg flex items-center justify-center text-center text-sm font-bold text-slate-800 dark:text-slate-900 transition-all break-all px-2 py-1 ${T} ${_}`,children:Q},`${E.id}-${y}-${C}`)}).concat(Array.from({length:l-x.length}).map((E,C)=>h.jsx("div",{className:"h-12 sm:h-14"},`pad-${y}-${x.length+C}`))))})})]}),h.jsx("div",{className:"mt-6 flex flex-wrap gap-4 justify-center",children:r.map((x,y)=>h.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 px-3 py-1.5 rounded-full border border-slate-200 dark:border-slate-700 shadow-sm",children:[h.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${Ps[y%Ps.length]}`}),h.jsxs("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:["Set: ",x.subject]})]},x.id))})]})},MC=[{type:"standard",label:"Standard",style:"bg-slate-300 dark:bg-slate-600",icon:null},{type:"accessible",label:"Accessible",style:"bg-blue-300 dark:bg-blue-600",icon:h.jsx("span",{title:"Accessible Seating",children:""})},{type:"faculty",label:"Faculty",style:"bg-yellow-300 dark:bg-yellow-600",icon:h.jsx("span",{title:"Faculty/Invigilator Seat",children:""})}],RH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),DH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M6.672 1.911a1 1 0 10-1.932.524l1.822 6.723L1.94 11.23a1 1 0 00.72 1.916h3.417l2.128 6.384a1 1 0 001.902-.619l-1.077-3.23 3.616 1.808a1 1 0 001.378-.868l1.37-7.533a1 1 0 00-1.37-1.171l-7.353 3.16.822-6.166z",clipRule:"evenodd"})}),MH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),LH=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),dp=({isOpen:e,onClose:t,onSave:r,initialLayout:n,initialName:a,isTemplateCreationMode:s})=>{const[l,o]=X.useState(n||[]),[u,f]=X.useState(10),[d,m]=X.useState(10),[x,y]=X.useState(null),[E,C]=X.useState(""),[S,T]=X.useState(""),[F,_]=X.useState(!1),[Q,L]=X.useState(new Set),[R,U]=X.useState(!1),[K,D]=X.useState([]),[ee,re]=X.useState(-1),Z=X.useRef(null);X.useEffect(()=>{let ne=[],Ce=10,N=10;if(n&&n.length>0){ne=n;const Pe=Math.max(9,...n.map(et=>et.row)),Ye=Math.max(9,...n.map(et=>et.col));Ce=Pe+1,N=Ye+1}o(ne),f(Ce),m(N),C(a||""),T(""),L(new Set),D([{seats:ne,rows:Ce,cols:N}]),re(0)},[n,a,e]);const ae=X.useCallback((ne,Ce,N)=>{D(Ie=>[...Ie.slice(0,ee+1),{seats:ne,rows:Ce,cols:N}]),re(Ie=>Ie+1),o(ne),f(Ce),m(N)},[ee]),Te=X.useCallback(()=>{if(ee>0){const ne=ee-1,Ce=K[ne];o(Ce.seats),f(Ce.rows),m(Ce.cols),re(ne),L(new Set)}},[K,ee]),Se=X.useCallback(()=>{if(ee<K.length-1){const ne=ee+1,Ce=K[ne];o(Ce.seats),f(Ce.rows),m(Ce.cols),re(ne),L(new Set)}},[K,ee]);X.useEffect(()=>{const ne=Ce=>{e&&((Ce.metaKey||Ce.ctrlKey)&&Ce.key==="z"?(Ce.preventDefault(),Ce.shiftKey?Se():Te()):(Ce.metaKey||Ce.ctrlKey)&&Ce.key==="y"&&(Ce.preventDefault(),Se()))};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[e,Te,Se]);const q=(ne,Ce)=>{ne.stopPropagation();const N=new Set(Q);ne.shiftKey||R?(N.has(Ce)?N.delete(Ce):N.add(Ce),L(N)):Q.has(Ce)?L(new Set([Ce])):L(new Set([Ce]))},Ae=()=>{L(new Set)},Re=(ne,Ce,N)=>{if(ne.preventDefault(),x){if("type"in x){if(l.some(Ye=>Ye.row===Ce&&Ye.col===N))return;const Ie={id:`seat-${Date.now()}-${Math.random()}`,row:Ce,col:N,type:x.type},Pe=[...l,Ie];ae(Pe,u,d),L(new Set([Ie.id]))}else if("id"in x){const Ie=l.find(ft=>ft.id===x.id);if(!Ie)return;const Pe=Ce-Ie.row,Ye=N-Ie.col;if(l.filter(ft=>Q.has(ft.id)).every(ft=>{const Et=ft.row+Pe,lr=ft.col+Ye;return!(Et<0||Et>=u||lr<0||lr>=d||l.find(Er=>Er.row===Et&&Er.col===lr&&!Q.has(Er.id)))})){const ft=l.map(Et=>Q.has(Et.id)?{...Et,row:Et.row+Pe,col:Et.col+Ye}:Et);ae(ft,u,d)}}}y(null),ne.currentTarget.classList.remove("bg-violet-200","dark:bg-violet-700/50")},ie=(ne,Ce)=>{y({type:Ce}),ne.dataTransfer.effectAllowed="copy",L(new Set)},Me=(ne,Ce)=>{Q.has(Ce.id)||L(new Set([Ce.id])),y({id:Ce.id}),ne.dataTransfer.effectAllowed="move"},J=ne=>{ne.preventDefault(),ne.currentTarget.classList.add("bg-violet-200","dark:bg-violet-700/50")},k=ne=>{ne.currentTarget.classList.remove("bg-violet-200","dark:bg-violet-700/50")},V=ne=>{if(ne.preventDefault(),x&&"id"in x){const Ce=l.filter(N=>!Q.has(N.id));ae(Ce,u,d),L(new Set)}y(null),ne.currentTarget.classList.remove("bg-red-500/50")},P=()=>{L(new Set(l.map(ne=>ne.id)))},z=()=>{L(new Set)},le=()=>{if(s){if(!E.trim()){T("Template name is required.");return}r({layout:l,name:E})}else r({layout:l})},Be=(ne,Ce)=>{const N=Math.max(1,Math.min(50,Ce));let Ie=l;ne==="rows"?(Ie=l.filter(Pe=>Pe.row<N),ae(Ie,N,d)):(Ie=l.filter(Pe=>Pe.col<N),ae(Ie,u,N))},de=async ne=>{if(ne.target.files&&ne.target.files[0]){_(!0);const Ce=ne.target.files[0],N=new FileReader;N.onloadend=async()=>{try{const Ie=N.result.split(",")[1],Pe=Ce.type,Ye=await sH(Ie,Pe);Ye?ae(Ye.layout,Ye.rows,Ye.cols):alert("Could not analyze image. Please try again with a clearer image of the seating arrangement.")}catch(Ie){console.error(Ie),alert("An error occurred during image processing.")}finally{_(!1),Z.current&&(Z.current.value="")}},N.readAsDataURL(Ce)}};if(!e)return null;const ce=new Map(l.map(ne=>[`${ne.row}-${ne.col}`,ne]));return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",onClick:t,children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full h-full max-w-7xl max-h-[95vh] flex flex-col",onClick:ne=>ne.stopPropagation(),children:[h.jsxs("header",{className:"p-4 border-b dark:border-slate-700 flex justify-between items-center",children:[h.jsx("h2",{className:"text-xl font-bold",children:s?"Create Hall Template":"Hall Layout Editor"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"flex gap-1 mr-4 border-r dark:border-slate-700 pr-4",children:[h.jsx("button",{onClick:Te,disabled:ee<=0,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Undo (Ctrl+Z)",children:h.jsx(MH,{})}),h.jsx("button",{onClick:Se,disabled:ee>=K.length-1,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Redo (Ctrl+Y)",children:h.jsx(LH,{})})]}),h.jsx(tt,{onClick:t,variant:"secondary",children:"Close"})]})]}),h.jsxs("div",{className:"flex-grow flex overflow-hidden relative",children:[F&&h.jsxs("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-900/80 z-50 flex flex-col items-center justify-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600 mb-4"}),h.jsx("p",{className:"text-violet-700 dark:text-violet-400 font-semibold",children:"AI is analyzing your image to generate the layout..."})]}),h.jsxs("aside",{className:"w-64 p-4 border-r dark:border-slate-700 flex flex-col gap-4 bg-slate-50 dark:bg-slate-800/50 overflow-y-auto",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"font-semibold mb-2",children:"Tools"}),h.jsx("input",{type:"file",ref:Z,onChange:de,accept:"image/*",className:"hidden"}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("button",{onClick:()=>{var ne;return(ne=Z.current)==null?void 0:ne.click()},className:"w-full flex items-center justify-center gap-2 p-2 bg-violet-100 text-violet-700 dark:bg-violet-500/20 dark:text-violet-300 hover:bg-violet-200 dark:hover:bg-violet-500/30 rounded-md transition-colors text-sm font-medium",disabled:F,children:[h.jsx(RH,{})," Import from Image"]}),h.jsxs("button",{onClick:()=>U(!R),className:`w-full flex items-center justify-center gap-2 p-2 rounded-md transition-colors text-sm font-medium ${R?"bg-violet-600 text-white":"bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-600"}`,children:[h.jsx(DH,{})," ",R?"Multi-Select On":"Multi-Select Off"]})]})]}),h.jsxs("div",{className:"mb-2",children:[h.jsx("h3",{className:"font-semibold",children:"Selection"}),h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:[Q.size," seat",Q.size!==1?"s":""," selected"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:P,className:"flex-1 text-xs bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 px-2 py-1 rounded",children:"Select All"}),h.jsx("button",{onClick:z,className:"flex-1 text-xs bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 px-2 py-1 rounded",children:"Clear"})]})]}),h.jsx("h3",{className:"font-semibold",children:"Seat Palette"}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Drag a seat type onto the grid."}),MC.map(({type:ne,label:Ce,style:N,icon:Ie})=>h.jsxs("div",{draggable:!0,onDragStart:Pe=>ie(Pe,ne),className:`p-2 rounded-md cursor-grab flex items-center gap-2 ${N}`,children:[h.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center font-bold text-slate-800 dark:text-slate-900 border border-slate-400 dark:border-slate-500",children:Ie}),h.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-slate-200",children:Ce})]},ne)),h.jsx("div",{className:"mt-auto pt-4 border-t dark:border-slate-700",children:h.jsxs("div",{onDragOver:ne=>{ne.preventDefault(),ne.currentTarget.classList.add("bg-red-500/50")},onDragLeave:ne=>ne.currentTarget.classList.remove("bg-red-500/50"),onDrop:V,className:"border-2 border-dashed border-red-500 rounded-lg p-4 text-center text-red-500 transition-colors",children:[h.jsx("p",{className:"font-bold",children:"Trash"}),h.jsx("p",{className:"text-xs",children:"Drag seat(s) here to remove."})]})})]}),h.jsxs("main",{className:"flex-grow flex flex-col p-4 overflow-auto bg-white dark:bg-slate-900",onClick:Ae,children:[s&&h.jsxs("div",{className:"mb-4",children:[h.jsx(Ut,{label:"Template Name",id:"template-name",value:E,onChange:ne=>{C(ne.target.value),T("")},placeholder:"e.g., Main Auditorium",required:!0,onClick:ne=>ne.stopPropagation()}),S&&h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:S})]}),h.jsxs("div",{className:"flex items-center gap-4 mb-4",onClick:ne=>ne.stopPropagation(),children:[h.jsx(Ut,{label:"Rows",type:"number",value:u,onChange:ne=>Be("rows",parseInt(ne.target.value)||0),containerClassName:"w-24"}),h.jsx(Ut,{label:"Columns",type:"number",value:d,onChange:ne=>Be("cols",parseInt(ne.target.value)||0),containerClassName:"w-24"}),h.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Total Seats: ",h.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:l.length})]}),h.jsxs("div",{className:"ml-auto text-xs text-slate-400",children:["Tip: Hold ",h.jsx("b",{children:"Shift"})," to select multiple seats. Use ",h.jsx("b",{children:"Ctrl+Z"})," to Undo."]})]}),h.jsx("div",{className:"flex-grow overflow-auto p-2 bg-slate-100 dark:bg-slate-800/50 rounded-md border dark:border-slate-700",children:h.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${d}, 2.5rem)`,gridTemplateRows:`repeat(${u}, 2.5rem)`},children:Array.from({length:u*d}).map((ne,Ce)=>{const N=Math.floor(Ce/d),Ie=Ce%d,Pe=ce.get(`${N}-${Ie}`);if(Pe){const Ye=Pe,et=MC.find(ft=>ft.type===Ye.type),He=Q.has(Ye.id);return h.jsxs("div",{draggable:!0,onDragStart:ft=>Me(ft,Ye),onClick:ft=>q(ft,Ye.id),className:`
                                                    w-10 h-10 rounded cursor-move flex items-center justify-center 
                                                    font-bold text-slate-800 dark:text-slate-900 border 
                                                    ${et.style}
                                                    ${He?"ring-4 ring-offset-2 ring-violet-500 dark:ring-violet-400 z-10":"border-slate-400 dark:border-slate-500 hover:brightness-110"}
                                                `,title:`${et.label} Seat (R${N+1}, C${Ie+1})`,children:[He&&h.jsx("div",{className:"absolute top-0 right-0 -mt-1 -mr-1 w-3 h-3 bg-violet-600 rounded-full border border-white"}),et.icon]},Ye.id)}return h.jsx("div",{onDrop:Ye=>Re(Ye,N,Ie),onDragOver:J,onDragLeave:k,className:"w-10 h-10 bg-slate-200 dark:bg-slate-700/30 rounded-sm transition-colors"},`cell-${N}-${Ie}`)})})})]})]}),h.jsx("footer",{className:"p-4 border-t dark:border-slate-700 text-right",children:h.jsxs(tt,{onClick:le,children:["Save ",s?"Template":"Layout"]})})]})})};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hp=function(e,t){return hp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},hp(e,t)};function uA(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");hp(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var gp=function(){return gp=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},gp.apply(this,arguments)};function Jn(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(d){try{f(n.next(d))}catch(m){l(m)}}function u(d){try{f(n.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(o,u)}f((n=n.apply(e,[])).next())})}function Qn(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(f){return function(d){return u([f,d])}}function u(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=f[0]&2?a.return:f[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,f[1])).done)return s;switch(a=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,a=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],a=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function j0(e,t,r){if(arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||t)}var ns=(function(){function e(t,r,n,a){this.left=t,this.top=r,this.width=n,this.height=a}return e.prototype.add=function(t,r,n,a){return new e(this.left+t,this.top+r,this.width+n,this.height+a)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e})(),_d=function(e,t){return ns.fromClientRect(e,t.getBoundingClientRect())},HH=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),a=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new ns(0,0,n,a)},bd=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((a&1023)<<10)+(s&1023)+65536):(t.push(a),r--)}else t.push(a)}return t},Yr=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var l=e[a];l<=65535?n.push(l):(l-=65536,n.push((l>>10)+55296,l%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},LC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",OH=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var z0=0;z0<LC.length;z0++)OH[LC.charCodeAt(z0)]=z0;var HC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Sc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var X0=0;X0<HC.length;X0++)Sc[HC.charCodeAt(X0)]=X0;var PH=function(e){var t=e.length*.75,r=e.length,n,a=0,s,l,o,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<r;n+=4)s=Sc[e.charCodeAt(n)],l=Sc[e.charCodeAt(n+1)],o=Sc[e.charCodeAt(n+2)],u=Sc[e.charCodeAt(n+3)],d[a++]=s<<2|l>>4,d[a++]=(l&15)<<4|o>>2,d[a++]=(o&3)<<6|u&63;return f},GH=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},VH=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Di=5,dx=11,lm=2,KH=dx-Di,CT=65536>>Di,jH=1<<Di,om=jH-1,zH=1024>>Di,XH=CT+zH,JH=XH,WH=32,YH=JH+WH,qH=65536>>dx,$H=1<<KH,ZH=$H-1,OC=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},e6=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},t6=function(e,t){var r=PH(e),n=Array.isArray(r)?VH(r):new Uint32Array(r),a=Array.isArray(r)?GH(r):new Uint16Array(r),s=24,l=OC(a,s/2,n[4]/2),o=n[5]===2?OC(a,(s+n[4])/2):e6(n,Math.ceil((s+n[4])/4));return new r6(n[0],n[1],n[2],n[3],l,o)},r6=(function(){function e(t,r,n,a,s,l){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=l}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Di],r=(r<<lm)+(t&om),this.data[r];if(t<=65535)return r=this.index[CT+(t-55296>>Di)],r=(r<<lm)+(t&om),this.data[r];if(t<this.highStart)return r=YH-qH+(t>>dx),r=this.index[r],r+=t>>Di&ZH,r=this.index[r],r=(r<<lm)+(t&om),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),PC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n6=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var J0=0;J0<PC.length;J0++)n6[PC.charCodeAt(J0)]=J0;var a6="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",GC=50,A6=1,ET=2,ST=3,s6=4,i6=5,VC=7,TT=8,KC=9,Gs=10,mp=11,jC=12,pp=13,l6=14,Tc=15,xp=16,W0=17,pc=18,o6=19,zC=20,vp=21,xc=22,cm=23,Ll=24,ma=25,_c=26,bc=27,Hl=28,c6=29,Ni=30,u6=31,Y0=32,q0=33,wp=34,yp=35,Bp=36,eu=37,Cp=38,Mf=39,Lf=40,um=41,_T=42,f6=43,d6=[9001,65288],bT="!",Kt="",$0="",Ep=t6(a6),XA=[Ni,Bp],Sp=[A6,ET,ST,i6],FT=[Gs,TT],XC=[bc,_c],h6=Sp.concat(FT),JC=[Cp,Mf,Lf,wp,yp],g6=[Tc,pp],m6=function(e,t){t===void 0&&(t="strict");var r=[],n=[],a=[];return e.forEach(function(s,l){var o=Ep.get(s);if(o>GC?(a.push(!0),o-=GC):a.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(l),r.push(xp);if(o===s6||o===mp){if(l===0)return n.push(l),r.push(Ni);var u=r[l-1];return h6.indexOf(u)===-1?(n.push(n[l-1]),r.push(u)):(n.push(l),r.push(Ni))}if(n.push(l),o===u6)return r.push(t==="strict"?vp:eu);if(o===_T||o===c6)return r.push(Ni);if(o===f6)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(eu):r.push(Ni);r.push(o)}),[n,r,a]},fm=function(e,t,r,n){var a=n[r];if(Array.isArray(e)?e.indexOf(a)!==-1:e===a)for(var s=r;s<=n.length;){s++;var l=n[s];if(l===t)return!0;if(l!==Gs)break}if(a===Gs)for(var s=r;s>0;){s--;var o=n[s];if(Array.isArray(e)?e.indexOf(o)!==-1:e===o)for(var u=r;u<=n.length;){u++;var l=n[u];if(l===t)return!0;if(l!==Gs)break}if(o!==Gs)break}return!1},WC=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===Gs)r--;else return n}return 0},p6=function(e,t,r,n,a){if(r[n]===0)return Kt;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return Kt;var l=s-1,o=s+1,u=t[s],f=l>=0?t[l]:0,d=t[o];if(u===ET&&d===ST)return Kt;if(Sp.indexOf(u)!==-1)return bT;if(Sp.indexOf(d)!==-1||FT.indexOf(d)!==-1)return Kt;if(WC(s,t)===TT)return $0;if(Ep.get(e[s])===mp||(u===Y0||u===q0)&&Ep.get(e[o])===mp||u===VC||d===VC||u===KC||[Gs,pp,Tc].indexOf(u)===-1&&d===KC||[W0,pc,o6,Ll,Hl].indexOf(d)!==-1||WC(s,t)===xc||fm(cm,xc,s,t)||fm([W0,pc],vp,s,t)||fm(jC,jC,s,t))return Kt;if(u===Gs)return $0;if(u===cm||d===cm)return Kt;if(d===xp||u===xp)return $0;if([pp,Tc,vp].indexOf(d)!==-1||u===l6||f===Bp&&g6.indexOf(u)!==-1||u===Hl&&d===Bp||d===zC||XA.indexOf(d)!==-1&&u===ma||XA.indexOf(u)!==-1&&d===ma||u===bc&&[eu,Y0,q0].indexOf(d)!==-1||[eu,Y0,q0].indexOf(u)!==-1&&d===_c||XA.indexOf(u)!==-1&&XC.indexOf(d)!==-1||XC.indexOf(u)!==-1&&XA.indexOf(d)!==-1||[bc,_c].indexOf(u)!==-1&&(d===ma||[xc,Tc].indexOf(d)!==-1&&t[o+1]===ma)||[xc,Tc].indexOf(u)!==-1&&d===ma||u===ma&&[ma,Hl,Ll].indexOf(d)!==-1)return Kt;if([ma,Hl,Ll,W0,pc].indexOf(d)!==-1)for(var m=s;m>=0;){var x=t[m];if(x===ma)return Kt;if([Hl,Ll].indexOf(x)!==-1)m--;else break}if([bc,_c].indexOf(d)!==-1)for(var m=[W0,pc].indexOf(u)!==-1?l:s;m>=0;){var x=t[m];if(x===ma)return Kt;if([Hl,Ll].indexOf(x)!==-1)m--;else break}if(Cp===u&&[Cp,Mf,wp,yp].indexOf(d)!==-1||[Mf,wp].indexOf(u)!==-1&&[Mf,Lf].indexOf(d)!==-1||[Lf,yp].indexOf(u)!==-1&&d===Lf||JC.indexOf(u)!==-1&&[zC,_c].indexOf(d)!==-1||JC.indexOf(d)!==-1&&u===bc||XA.indexOf(u)!==-1&&XA.indexOf(d)!==-1||u===Ll&&XA.indexOf(d)!==-1||XA.concat(ma).indexOf(u)!==-1&&d===xc&&d6.indexOf(e[o])===-1||XA.concat(ma).indexOf(d)!==-1&&u===pc)return Kt;if(u===um&&d===um){for(var y=r[s],E=1;y>0&&(y--,t[y]===um);)E++;if(E%2!==0)return Kt}return u===Y0&&d===q0?Kt:$0},x6=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=m6(e,t.lineBreak),n=r[0],a=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(a=a.map(function(o){return[ma,Ni,_T].indexOf(o)!==-1?eu:o}));var l=t.wordBreak==="keep-all"?s.map(function(o,u){return o&&e[u]>=19968&&e[u]<=40959}):void 0;return[n,a,l]},v6=(function(){function e(t,r,n,a){this.codePoints=t,this.required=r===bT,this.start=n,this.end=a}return e.prototype.slice=function(){return Yr.apply(void 0,this.codePoints.slice(this.start,this.end))},e})(),w6=function(e,t){var r=bd(e),n=x6(r,t),a=n[0],s=n[1],l=n[2],o=r.length,u=0,f=0;return{next:function(){if(f>=o)return{done:!0,value:null};for(var d=Kt;f<o&&(d=p6(r,s,a,++f,l))===Kt;);if(d!==Kt||f===o){var m=new v6(r,d,u,f);return u=f,{value:m,done:!1}}return{done:!0,value:null}}}},y6=1,B6=2,vu=4,YC=8,Jf=10,qC=47,Dc=92,C6=9,E6=32,Z0=34,vc=61,S6=35,T6=36,_6=37,ef=39,tf=40,wc=41,b6=95,sa=45,F6=33,U6=60,k6=62,N6=64,I6=91,Q6=93,R6=61,D6=123,rf=63,M6=125,$C=124,L6=126,H6=128,ZC=65533,dm=42,Qi=43,O6=44,P6=58,G6=59,tu=46,V6=0,K6=8,j6=11,z6=14,X6=31,J6=127,pA=-1,UT=48,kT=97,NT=101,W6=102,Y6=117,q6=122,IT=65,QT=69,RT=70,$6=85,Z6=90,Mn=function(e){return e>=UT&&e<=57},e8=function(e){return e>=55296&&e<=57343},Ol=function(e){return Mn(e)||e>=IT&&e<=RT||e>=kT&&e<=W6},t8=function(e){return e>=kT&&e<=q6},r8=function(e){return e>=IT&&e<=Z6},n8=function(e){return t8(e)||r8(e)},a8=function(e){return e>=H6},nf=function(e){return e===Jf||e===C6||e===E6},Wf=function(e){return n8(e)||a8(e)||e===b6},eE=function(e){return Wf(e)||Mn(e)||e===sa},A8=function(e){return e>=V6&&e<=K6||e===j6||e>=z6&&e<=X6||e===J6},Os=function(e,t){return e!==Dc?!1:t!==Jf},af=function(e,t,r){return e===sa?Wf(t)||Os(t,r):Wf(e)?!0:!!(e===Dc&&Os(e,t))},hm=function(e,t,r){return e===Qi||e===sa?Mn(t)?!0:t===tu&&Mn(r):Mn(e===tu?t:e)},s8=function(e){var t=0,r=1;(e[t]===Qi||e[t]===sa)&&(e[t]===sa&&(r=-1),t++);for(var n=[];Mn(e[t]);)n.push(e[t++]);var a=n.length?parseInt(Yr.apply(void 0,n),10):0;e[t]===tu&&t++;for(var s=[];Mn(e[t]);)s.push(e[t++]);var l=s.length,o=l?parseInt(Yr.apply(void 0,s),10):0;(e[t]===QT||e[t]===NT)&&t++;var u=1;(e[t]===Qi||e[t]===sa)&&(e[t]===sa&&(u=-1),t++);for(var f=[];Mn(e[t]);)f.push(e[t++]);var d=f.length?parseInt(Yr.apply(void 0,f),10):0;return r*(a+o*Math.pow(10,-l))*Math.pow(10,u*d)},i8={type:2},l8={type:3},o8={type:4},c8={type:13},u8={type:8},f8={type:21},d8={type:9},h8={type:10},g8={type:11},m8={type:12},p8={type:14},Af={type:23},x8={type:1},v8={type:25},w8={type:24},y8={type:26},B8={type:27},C8={type:28},E8={type:29},S8={type:31},Tp={type:32},DT=(function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(bd(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Tp;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Z0:return this.consumeStringToken(Z0);case S6:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(eE(r)||Os(n,a)){var s=af(r,n,a)?B6:y6,l=this.consumeName();return{type:5,value:l,flags:s}}break;case T6:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),c8;break;case ef:return this.consumeStringToken(ef);case tf:return i8;case wc:return l8;case dm:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),p8;break;case Qi:if(hm(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case O6:return o8;case sa:var o=t,u=this.peekCodePoint(0),f=this.peekCodePoint(1);if(hm(o,u,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(af(o,u,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(u===sa&&f===k6)return this.consumeCodePoint(),this.consumeCodePoint(),w8;break;case tu:if(hm(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case qC:if(this.peekCodePoint(0)===dm)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===dm&&(d=this.consumeCodePoint(),d===qC))return this.consumeToken();if(d===pA)return this.consumeToken()}break;case P6:return y8;case G6:return B8;case U6:if(this.peekCodePoint(0)===F6&&this.peekCodePoint(1)===sa&&this.peekCodePoint(2)===sa)return this.consumeCodePoint(),this.consumeCodePoint(),v8;break;case N6:var m=this.peekCodePoint(0),x=this.peekCodePoint(1),y=this.peekCodePoint(2);if(af(m,x,y)){var l=this.consumeName();return{type:7,value:l}}break;case I6:return C8;case Dc:if(Os(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case Q6:return E8;case R6:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),u8;break;case D6:return g8;case M6:return m8;case Y6:case $6:var E=this.peekCodePoint(0),C=this.peekCodePoint(1);return E===Qi&&(Ol(C)||C===rf)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case $C:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),d8;if(this.peekCodePoint(0)===$C)return this.consumeCodePoint(),f8;break;case L6:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),h8;break;case pA:return Tp}return nf(t)?(this.consumeWhiteSpace(),S8):Mn(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Wf(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Yr(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Ol(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===rf&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(Yr.apply(void 0,t.map(function(u){return u===rf?UT:u})),16),s=parseInt(Yr.apply(void 0,t.map(function(u){return u===rf?RT:u})),16);return{type:30,start:a,end:s}}var l=parseInt(Yr.apply(void 0,t),16);if(this.peekCodePoint(0)===sa&&Ol(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var o=[];Ol(r)&&o.length<6;)o.push(r),r=this.consumeCodePoint();var s=parseInt(Yr.apply(void 0,o),16);return{type:30,start:l,end:s}}else return{type:30,start:l,end:l}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===tf?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===tf?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===pA)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===ef||r===Z0){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===pA||this.peekCodePoint(0)===wc)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Af)}for(;;){var a=this.consumeCodePoint();if(a===pA||a===wc)return{type:22,value:Yr.apply(void 0,t)};if(nf(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===pA||this.peekCodePoint(0)===wc?(this.consumeCodePoint(),{type:22,value:Yr.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Af);if(a===Z0||a===ef||a===tf||A8(a))return this.consumeBadUrlRemnants(),Af;if(a===Dc)if(Os(a,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Af;else t.push(a)}},e.prototype.consumeWhiteSpace=function(){for(;nf(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===wc||t===pA)return;Os(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var a=Math.min(r,t);n+=Yr.apply(void 0,this._value.splice(0,a)),t-=a}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var a=this._value[n];if(a===pA||a===void 0||a===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===Jf)return this._value.splice(0,n),x8;if(a===Dc){var s=this._value[n+1];s!==pA&&s!==void 0&&(s===Jf?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):Os(a,s)&&(r+=this.consumeStringSlice(n),r+=Yr(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=vu,n=this.peekCodePoint(0);for((n===Qi||n===sa)&&t.push(this.consumeCodePoint());Mn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===tu&&Mn(a))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=YC;Mn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===QT||n===NT)&&((a===Qi||a===sa)&&Mn(s)||Mn(a)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=YC;Mn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[s8(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),l=this.peekCodePoint(2);if(af(a,s,l)){var o=this.consumeName();return{type:15,number:r,flags:n,unit:o}}return a===_6?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Ol(t)){for(var r=Yr(t);Ol(this.peekCodePoint(0))&&r.length<6;)r+=Yr(this.consumeCodePoint());nf(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||e8(n)||n>1114111?ZC:n}return t===pA?ZC:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(eE(r))t+=Yr(r);else if(Os(r,this.peekCodePoint(0)))t+=Yr(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e})(),MT=(function(){function e(t){this._tokens=t}return e.create=function(t){var r=new DT;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||_8(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Tp:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e})(),wu=function(e){return e.type===15},vo=function(e){return e.type===17},wr=function(e){return e.type===20},T8=function(e){return e.type===0},_p=function(e,t){return wr(e)&&e.value===t},LT=function(e){return e.type!==31},oo=function(e){return e.type!==31&&e.type!==4},EA=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},_8=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Ws=function(e){return e.type===17||e.type===15},cn=function(e){return e.type===16||Ws(e)},HT=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Un={type:17,number:0,flags:vu},hx={type:16,number:50,flags:vu},Vs={type:16,number:100,flags:vu},Fc=function(e,t,r){var n=e[0],a=e[1];return[_r(n,t),_r(typeof a<"u"?a:n,r)]},_r=function(e,t){if(e.type===16)return e.number/100*t;if(wu(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},OT="deg",PT="grad",GT="rad",VT="turn",Fd={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case OT:return Math.PI*t.number/180;case PT:return Math.PI/200*t.number;case GT:return t.number;case VT:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},KT=function(e){return e.type===15&&(e.unit===OT||e.unit===PT||e.unit===GT||e.unit===VT)},jT=function(e){var t=e.filter(wr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Un,Un];case"to top":case"bottom":return ja(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Un,Vs];case"to right":case"left":return ja(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Vs,Vs];case"to bottom":case"top":return ja(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Vs,Un];case"to left":case"right":return ja(270)}return 0},ja=function(e){return Math.PI*e/180},Xs={name:"color",parse:function(e,t){if(t.type===18){var r=b8[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),a=t.value.substring(1,2),s=t.value.substring(2,3);return Ks(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),a=t.value.substring(1,2),s=t.value.substring(2,3),l=t.value.substring(3,4);return Ks(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(l+l,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),a=t.value.substring(2,4),s=t.value.substring(4,6);return Ks(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),a=t.value.substring(2,4),s=t.value.substring(4,6),l=t.value.substring(6,8);return Ks(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(l,16)/255)}}if(t.type===20){var o=qA[t.value.toUpperCase()];if(typeof o<"u")return o}return qA.TRANSPARENT}},Js=function(e){return(255&e)===0},mn=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,a=255&e>>24;return t<255?"rgba("+a+","+n+","+r+","+t/255+")":"rgb("+a+","+n+","+r+")"},Ks=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},tE=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},rE=function(e,t){var r=t.filter(oo);if(r.length===3){var n=r.map(tE),a=n[0],s=n[1],l=n[2];return Ks(a,s,l,1)}if(r.length===4){var o=r.map(tE),a=o[0],s=o[1],l=o[2],u=o[3];return Ks(a,s,l,u)}return 0};function gm(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var nE=function(e,t){var r=t.filter(oo),n=r[0],a=r[1],s=r[2],l=r[3],o=(n.type===17?ja(n.number):Fd.parse(e,n))/(Math.PI*2),u=cn(a)?a.number/100:0,f=cn(s)?s.number/100:0,d=typeof l<"u"&&cn(l)?_r(l,1):1;if(u===0)return Ks(f*255,f*255,f*255,1);var m=f<=.5?f*(u+1):f+u-f*u,x=f*2-m,y=gm(x,m,o+1/3),E=gm(x,m,o),C=gm(x,m,o-1/3);return Ks(y*255,E*255,C*255,d)},b8={hsl:nE,hsla:nE,rgb:rE,rgba:rE},Mc=function(e,t){return Xs.parse(e,MT.create(t).parseComponentValue())},qA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},F8={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(wr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},U8={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ud=function(e,t){var r=Xs.parse(e,t[0]),n=t[1];return n&&cn(n)?{color:r,stop:n}:{color:r,stop:null}},aE=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=Un),n.stop===null&&(n.stop=Vs);for(var a=[],s=0,l=0;l<e.length;l++){var o=e[l].stop;if(o!==null){var u=_r(o,t);u>s?a.push(u):a.push(s),s=u}else a.push(null)}for(var f=null,l=0;l<a.length;l++){var d=a[l];if(d===null)f===null&&(f=l);else if(f!==null){for(var m=l-f,x=a[f-1],y=(d-x)/(m+1),E=1;E<=m;E++)a[f+E-1]=y*E;f=null}}return e.map(function(C,S){var T=C.color;return{color:T,stop:Math.max(Math.min(1,a[S]/t),0)}})},k8=function(e,t,r){var n=t/2,a=r/2,s=_r(e[0],t)-n,l=a-_r(e[1],r);return(Math.atan2(l,s)+Math.PI*2)%(Math.PI*2)},N8=function(e,t,r){var n=typeof e=="number"?e:k8(e,t,r),a=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),s=t/2,l=r/2,o=a/2,u=Math.sin(n-Math.PI/2)*o,f=Math.cos(n-Math.PI/2)*o;return[a,s-f,s+f,l-u,l+u]},nA=function(e,t){return Math.sqrt(e*e+t*t)},AE=function(e,t,r,n,a){var s=[[0,0],[0,t],[e,0],[e,t]];return s.reduce(function(l,o){var u=o[0],f=o[1],d=nA(r-u,n-f);return(a?d<l.optimumDistance:d>l.optimumDistance)?{optimumCorner:o,optimumDistance:d}:l},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},I8=function(e,t,r,n,a){var s=0,l=0;switch(e.size){case 0:e.shape===0?s=l=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-a)):e.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),l=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(e.shape===0)s=l=Math.min(nA(t,r),nA(t,r-a),nA(t-n,r),nA(t-n,r-a));else if(e.shape===1){var o=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(t),Math.abs(t-n)),u=AE(n,a,t,r,!0),f=u[0],d=u[1];s=nA(f-t,(d-r)/o),l=o*s}break;case 1:e.shape===0?s=l=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-a)):e.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),l=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(e.shape===0)s=l=Math.max(nA(t,r),nA(t,r-a),nA(t-n,r),nA(t-n,r-a));else if(e.shape===1){var o=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(t),Math.abs(t-n)),m=AE(n,a,t,r,!1),f=m[0],d=m[1];s=nA(f-t,(d-r)/o),l=o*s}break}return Array.isArray(e.size)&&(s=_r(e.size[0],n),l=e.size.length===2?_r(e.size[1],a):s),[s,l]},Q8=function(e,t){var r=ja(180),n=[];return EA(t).forEach(function(a,s){if(s===0){var l=a[0];if(l.type===20&&l.value==="to"){r=jT(a);return}else if(KT(l)){r=Fd.parse(e,l);return}}var o=Ud(e,a);n.push(o)}),{angle:r,stops:n,type:1}},sf=function(e,t){var r=ja(180),n=[];return EA(t).forEach(function(a,s){if(s===0){var l=a[0];if(l.type===20&&["top","left","right","bottom"].indexOf(l.value)!==-1){r=jT(a);return}else if(KT(l)){r=(Fd.parse(e,l)+ja(270))%ja(360);return}}var o=Ud(e,a);n.push(o)}),{angle:r,stops:n,type:1}},R8=function(e,t){var r=ja(180),n=[],a=1,s=0,l=3,o=[];return EA(t).forEach(function(u,f){var d=u[0];if(f===0){if(wr(d)&&d.value==="linear"){a=1;return}else if(wr(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var m=Xs.parse(e,d.values[0]);n.push({stop:Un,color:m})}else if(d.name==="to"){var m=Xs.parse(e,d.values[0]);n.push({stop:Vs,color:m})}else if(d.name==="color-stop"){var x=d.values.filter(oo);if(x.length===2){var m=Xs.parse(e,x[1]),y=x[0];vo(y)&&n.push({stop:{type:16,number:y.number*100,flags:y.flags},color:m})}}}}),a===1?{angle:(r+ja(180))%ja(360),stops:n,type:a}:{size:l,shape:s,stops:n,position:o,type:a}},zT="closest-side",XT="farthest-side",JT="closest-corner",WT="farthest-corner",YT="circle",qT="ellipse",$T="cover",ZT="contain",D8=function(e,t){var r=0,n=3,a=[],s=[];return EA(t).forEach(function(l,o){var u=!0;if(o===0){var f=!1;u=l.reduce(function(m,x){if(f)if(wr(x))switch(x.value){case"center":return s.push(hx),m;case"top":case"left":return s.push(Un),m;case"right":case"bottom":return s.push(Vs),m}else(cn(x)||Ws(x))&&s.push(x);else if(wr(x))switch(x.value){case YT:return r=0,!1;case qT:return r=1,!1;case"at":return f=!0,!1;case zT:return n=0,!1;case $T:case XT:return n=1,!1;case ZT:case JT:return n=2,!1;case WT:return n=3,!1}else if(Ws(x)||cn(x))return Array.isArray(n)||(n=[]),n.push(x),!1;return m},u)}if(u){var d=Ud(e,l);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},lf=function(e,t){var r=0,n=3,a=[],s=[];return EA(t).forEach(function(l,o){var u=!0;if(o===0?u=l.reduce(function(d,m){if(wr(m))switch(m.value){case"center":return s.push(hx),!1;case"top":case"left":return s.push(Un),!1;case"right":case"bottom":return s.push(Vs),!1}else if(cn(m)||Ws(m))return s.push(m),!1;return d},u):o===1&&(u=l.reduce(function(d,m){if(wr(m))switch(m.value){case YT:return r=0,!1;case qT:return r=1,!1;case ZT:case zT:return n=0,!1;case XT:return n=1,!1;case JT:return n=2,!1;case $T:case WT:return n=3,!1}else if(Ws(m)||cn(m))return Array.isArray(n)||(n=[]),n.push(m),!1;return d},u)),u){var f=Ud(e,l);a.push(f)}}),{size:n,shape:r,stops:a,position:s,type:2}},M8=function(e){return e.type===1},L8=function(e){return e.type===2},gx={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=e_[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function H8(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!e_[e.name])}var e_={"linear-gradient":Q8,"-moz-linear-gradient":sf,"-ms-linear-gradient":sf,"-o-linear-gradient":sf,"-webkit-linear-gradient":sf,"radial-gradient":D8,"-moz-radial-gradient":lf,"-ms-radial-gradient":lf,"-o-radial-gradient":lf,"-webkit-radial-gradient":lf,"-webkit-gradient":R8},O8={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return oo(n)&&H8(n)}).map(function(n){return gx.parse(e,n)})}},P8={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(wr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},G8={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return EA(t).map(function(r){return r.filter(cn)}).map(HT)}},V8={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return EA(t).map(function(r){return r.filter(wr).map(function(n){return n.value}).join(" ")}).map(K8)}},K8=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},ao;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(ao||(ao={}));var j8={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return EA(t).map(function(r){return r.filter(z8)})}},z8=function(e){return wr(e)||cn(e)},kd=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},X8=kd("top"),J8=kd("right"),W8=kd("bottom"),Y8=kd("left"),Nd=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return HT(r.filter(cn))}}},q8=Nd("top-left"),$8=Nd("top-right"),Z8=Nd("bottom-right"),e5=Nd("bottom-left"),Id=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},t5=Id("top"),r5=Id("right"),n5=Id("bottom"),a5=Id("left"),Qd=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return wu(r)?r.number:0}}},A5=Qd("top"),s5=Qd("right"),i5=Qd("bottom"),l5=Qd("left"),o5={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},c5={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},u5={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(wr).reduce(function(r,n){return r|f5(n.value)},0)}},f5=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},d5={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},h5={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},Yf;(function(e){e.NORMAL="normal",e.STRICT="strict"})(Yf||(Yf={}));var g5={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return Yf.STRICT;case"normal":default:return Yf.NORMAL}}},m5={name:"line-height",initialValue:"normal",prefix:!1,type:4},sE=function(e,t){return wr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:cn(e)?_r(e,t):t},p5={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:gx.parse(e,t)}},x5={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},bp={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Rd=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},v5=Rd("top"),w5=Rd("right"),y5=Rd("bottom"),B5=Rd("left"),C5={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(wr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},E5={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Dd=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},S5=Dd("top"),T5=Dd("right"),_5=Dd("bottom"),b5=Dd("left"),F5={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},U5={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},k5={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&_p(t[0],"none")?[]:EA(t).map(function(r){for(var n={color:qA.TRANSPARENT,offsetX:Un,offsetY:Un,blur:Un},a=0,s=0;s<r.length;s++){var l=r[s];Ws(l)?(a===0?n.offsetX=l:a===1?n.offsetY=l:n.blur=l,a++):n.color=Xs.parse(e,l)}return n})}},N5={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},I5={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=D5[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},Q5=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},R5=function(e){var t=e.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=t[0],n=t[1];t[2],t[3];var a=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var l=t[12],o=t[13];return t[14],t[15],t.length===16?[r,n,a,s,l,o]:null},D5={matrix:Q5,matrix3d:R5},iE={type:16,number:50,flags:vu},M5=[iE,iE],L5={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(cn);return r.length!==2?M5:[r[0],r[1]]}},H5={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Lc;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(Lc||(Lc={}));var O5={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return Lc.BREAK_ALL;case"keep-all":return Lc.KEEP_ALL;case"normal":default:return Lc.NORMAL}}},P5={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(vo(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},t_={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},G5={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return vo(t)?t.number:1}},V5={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},K5={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(wr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},j5={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},z5={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},X5={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(vo(t))return t.number;if(wr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},J5={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(wr).map(function(r){return r.value})}},W5={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},fn=function(e,t){return(e&t)!==0},Y5={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},q5={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=t.filter(LT),s=0;s<a.length;s++){var l=a[s],o=a[s+1];if(l.type===20){var u=o&&vo(o)?o.number:1;n.push({counter:l.value,increment:u})}}return n}},$5={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(LT),a=0;a<n.length;a++){var s=n[a],l=n[a+1];if(wr(s)&&s.value!=="none"){var o=l&&vo(l)?l.number:0;r.push({counter:s.value,reset:o})}}return r}},Z5={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(wu).map(function(r){return t_.parse(e,r)})}},eO={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],a=t.filter(T8);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var l=a[s].value,o=a[s+1].value;n.push({open:l,close:o})}return n}},lE=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},tO={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&_p(t[0],"none")?[]:EA(t).map(function(r){for(var n={color:255,offsetX:Un,offsetY:Un,blur:Un,spread:Un,inset:!1},a=0,s=0;s<r.length;s++){var l=r[s];_p(l,"inset")?n.inset=!0:Ws(l)?(a===0?n.offsetX=l:a===1?n.offsetY=l:a===2?n.blur=l:n.spread=l,a++):n.color=Xs.parse(e,l)}return n})}},rO={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(wr).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},nO={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},aO={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return wu(t)?t.number:0}},AO=(function(){function e(t,r){var n,a;this.animationDuration=rt(t,Z5,r.animationDuration),this.backgroundClip=rt(t,F8,r.backgroundClip),this.backgroundColor=rt(t,U8,r.backgroundColor),this.backgroundImage=rt(t,O8,r.backgroundImage),this.backgroundOrigin=rt(t,P8,r.backgroundOrigin),this.backgroundPosition=rt(t,G8,r.backgroundPosition),this.backgroundRepeat=rt(t,V8,r.backgroundRepeat),this.backgroundSize=rt(t,j8,r.backgroundSize),this.borderTopColor=rt(t,X8,r.borderTopColor),this.borderRightColor=rt(t,J8,r.borderRightColor),this.borderBottomColor=rt(t,W8,r.borderBottomColor),this.borderLeftColor=rt(t,Y8,r.borderLeftColor),this.borderTopLeftRadius=rt(t,q8,r.borderTopLeftRadius),this.borderTopRightRadius=rt(t,$8,r.borderTopRightRadius),this.borderBottomRightRadius=rt(t,Z8,r.borderBottomRightRadius),this.borderBottomLeftRadius=rt(t,e5,r.borderBottomLeftRadius),this.borderTopStyle=rt(t,t5,r.borderTopStyle),this.borderRightStyle=rt(t,r5,r.borderRightStyle),this.borderBottomStyle=rt(t,n5,r.borderBottomStyle),this.borderLeftStyle=rt(t,a5,r.borderLeftStyle),this.borderTopWidth=rt(t,A5,r.borderTopWidth),this.borderRightWidth=rt(t,s5,r.borderRightWidth),this.borderBottomWidth=rt(t,i5,r.borderBottomWidth),this.borderLeftWidth=rt(t,l5,r.borderLeftWidth),this.boxShadow=rt(t,tO,r.boxShadow),this.color=rt(t,o5,r.color),this.direction=rt(t,c5,r.direction),this.display=rt(t,u5,r.display),this.float=rt(t,d5,r.cssFloat),this.fontFamily=rt(t,j5,r.fontFamily),this.fontSize=rt(t,z5,r.fontSize),this.fontStyle=rt(t,W5,r.fontStyle),this.fontVariant=rt(t,J5,r.fontVariant),this.fontWeight=rt(t,X5,r.fontWeight),this.letterSpacing=rt(t,h5,r.letterSpacing),this.lineBreak=rt(t,g5,r.lineBreak),this.lineHeight=rt(t,m5,r.lineHeight),this.listStyleImage=rt(t,p5,r.listStyleImage),this.listStylePosition=rt(t,x5,r.listStylePosition),this.listStyleType=rt(t,bp,r.listStyleType),this.marginTop=rt(t,v5,r.marginTop),this.marginRight=rt(t,w5,r.marginRight),this.marginBottom=rt(t,y5,r.marginBottom),this.marginLeft=rt(t,B5,r.marginLeft),this.opacity=rt(t,G5,r.opacity);var s=rt(t,C5,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=rt(t,E5,r.overflowWrap),this.paddingTop=rt(t,S5,r.paddingTop),this.paddingRight=rt(t,T5,r.paddingRight),this.paddingBottom=rt(t,_5,r.paddingBottom),this.paddingLeft=rt(t,b5,r.paddingLeft),this.paintOrder=rt(t,rO,r.paintOrder),this.position=rt(t,U5,r.position),this.textAlign=rt(t,F5,r.textAlign),this.textDecorationColor=rt(t,V5,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=rt(t,K5,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=rt(t,k5,r.textShadow),this.textTransform=rt(t,N5,r.textTransform),this.transform=rt(t,I5,r.transform),this.transformOrigin=rt(t,L5,r.transformOrigin),this.visibility=rt(t,H5,r.visibility),this.webkitTextStrokeColor=rt(t,nO,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=rt(t,aO,r.webkitTextStrokeWidth),this.wordBreak=rt(t,O5,r.wordBreak),this.zIndex=rt(t,P5,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Js(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return fn(this.display,4)||fn(this.display,33554432)||fn(this.display,268435456)||fn(this.display,536870912)||fn(this.display,67108864)||fn(this.display,134217728)},e})(),sO=(function(){function e(t,r){this.content=rt(t,Y5,r.content),this.quotes=rt(t,eO,r.quotes)}return e})(),oE=(function(){function e(t,r){this.counterIncrement=rt(t,q5,r.counterIncrement),this.counterReset=rt(t,$5,r.counterReset)}return e})(),rt=function(e,t,r){var n=new DT,a=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(a);var s=new MT(n.read());switch(t.type){case 2:var l=s.parseComponentValue();return t.parse(e,wr(l)?l.value:t.initialValue);case 0:return t.parse(e,s.parseComponentValue());case 1:return t.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return Fd.parse(e,s.parseComponentValue());case"color":return Xs.parse(e,s.parseComponentValue());case"image":return gx.parse(e,s.parseComponentValue());case"length":var o=s.parseComponentValue();return Ws(o)?o:Un;case"length-percentage":var u=s.parseComponentValue();return cn(u)?u:Un;case"time":return t_.parse(e,s.parseComponentValue())}break}},iO="data-html2canvas-debug",lO=function(e){var t=e.getAttribute(iO);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Fp=function(e,t){var r=lO(e);return r===1||t===r},SA=(function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Fp(r,3))debugger;this.styles=new AO(t,window.getComputedStyle(r,null)),Np(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=_d(this.context,r),Fp(r,4)&&(this.flags|=16)}return e})(),oO="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",cE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Uc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var of=0;of<cE.length;of++)Uc[cE.charCodeAt(of)]=of;var cO=function(e){var t=e.length*.75,r=e.length,n,a=0,s,l,o,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(f)?f:new Uint8Array(f);for(n=0;n<r;n+=4)s=Uc[e.charCodeAt(n)],l=Uc[e.charCodeAt(n+1)],o=Uc[e.charCodeAt(n+2)],u=Uc[e.charCodeAt(n+3)],d[a++]=s<<2|l>>4,d[a++]=(l&15)<<4|o>>2,d[a++]=(o&3)<<6|u&63;return f},uO=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},fO=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Mi=5,mx=11,mm=2,dO=mx-Mi,r_=65536>>Mi,hO=1<<Mi,pm=hO-1,gO=1024>>Mi,mO=r_+gO,pO=mO,xO=32,vO=pO+xO,wO=65536>>mx,yO=1<<dO,BO=yO-1,uE=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},CO=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},EO=function(e,t){var r=cO(e),n=Array.isArray(r)?fO(r):new Uint32Array(r),a=Array.isArray(r)?uO(r):new Uint16Array(r),s=24,l=uE(a,s/2,n[4]/2),o=n[5]===2?uE(a,(s+n[4])/2):CO(n,Math.ceil((s+n[4])/4));return new SO(n[0],n[1],n[2],n[3],l,o)},SO=(function(){function e(t,r,n,a,s,l){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=l}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Mi],r=(r<<mm)+(t&pm),this.data[r];if(t<=65535)return r=this.index[r_+(t-55296>>Mi)],r=(r<<mm)+(t&pm),this.data[r];if(t<this.highStart)return r=vO-wO+(t>>mx),r=this.index[r],r+=t>>Mi&BO,r=this.index[r],r=(r<<mm)+(t&pm),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),fE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",TO=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cf=0;cf<fE.length;cf++)TO[fE.charCodeAt(cf)]=cf;var _O=1,xm=2,vm=3,dE=4,hE=5,bO=7,gE=8,wm=9,ym=10,mE=11,pE=12,xE=13,vE=14,Bm=15,FO=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((a&1023)<<10)+(s&1023)+65536):(t.push(a),r--)}else t.push(a)}return t},UO=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var l=e[a];l<=65535?n.push(l):(l-=65536,n.push((l>>10)+55296,l%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},kO=EO(oO),Pa="",Cm="",NO=function(e){return kO.get(e)},IO=function(e,t,r){var n=r-2,a=t[n],s=t[r-1],l=t[r];if(s===xm&&l===vm)return Pa;if(s===xm||s===vm||s===dE||l===xm||l===vm||l===dE)return Cm;if(s===gE&&[gE,wm,mE,pE].indexOf(l)!==-1||(s===mE||s===wm)&&(l===wm||l===ym)||(s===pE||s===ym)&&l===ym||l===xE||l===hE||l===bO||s===_O)return Pa;if(s===xE&&l===vE){for(;a===hE;)a=t[--n];if(a===vE)return Pa}if(s===Bm&&l===Bm){for(var o=0;a===Bm;)o++,a=t[--n];if(o%2===0)return Pa}return Cm},QO=function(e){var t=FO(e),r=t.length,n=0,a=0,s=t.map(NO);return{next:function(){if(n>=r)return{done:!0,value:null};for(var l=Pa;n<r&&(l=IO(t,s,++n))===Pa;);if(l!==Pa||n===r){var o=UO.apply(null,t.slice(a,n));return a=n,{value:o,done:!1}}return{done:!0,value:null}}}},RO=function(e){for(var t=QO(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},DO=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(e.body.removeChild(n),s===t)return!0}}return!1},MO=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,a=bd(n.data).map(function(u){return Yr(u)}),s=0,l={},o=a.every(function(u,f){r.setStart(n,s),r.setEnd(n,s+u.length);var d=r.getBoundingClientRect();s+=u.length;var m=d.x>l.x||d.y>l.y;return l=d,f===0?!0:m});return e.body.removeChild(t),o},LO=function(){return typeof new Image().crossOrigin<"u"},HO=function(){return typeof new XMLHttpRequest().responseType=="string"},OO=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},wE=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},PO=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=t.toDataURL();a.src=s;var l=Up(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),yE(l).then(function(o){n.drawImage(o,0,0);var u=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var f=e.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=r+"px",wE(u)?yE(Up(r,r,0,0,f)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),wE(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Up=function(e,t,r,n,a){var s="http://www.w3.org/2000/svg",l=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return l.setAttributeNS(null,"width",e.toString()),l.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",r.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),l.appendChild(o),o.appendChild(a),l},yE=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},_n={get SUPPORT_RANGE_BOUNDS(){var e=DO(document);return Object.defineProperty(_n,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=_n.SUPPORT_RANGE_BOUNDS&&MO(document);return Object.defineProperty(_n,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=OO(document);return Object.defineProperty(_n,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?PO(document):Promise.resolve(!1);return Object.defineProperty(_n,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=LO();return Object.defineProperty(_n,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=HO();return Object.defineProperty(_n,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(_n,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(_n,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Hc=(function(){function e(t,r){this.text=t,this.bounds=r}return e})(),GO=function(e,t,r,n){var a=jO(t,r),s=[],l=0;return a.forEach(function(o){if(r.textDecorationLine.length||o.trim().length>0)if(_n.SUPPORT_RANGE_BOUNDS){var u=BE(n,l,o.length).getClientRects();if(u.length>1){var f=px(o),d=0;f.forEach(function(x){s.push(new Hc(x,ns.fromDOMRectList(e,BE(n,d+l,x.length).getClientRects()))),d+=x.length})}else s.push(new Hc(o,ns.fromDOMRectList(e,u)))}else{var m=n.splitText(o.length);s.push(new Hc(o,VO(e,n))),n=m}else _n.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));l+=o.length}),s},VO=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var a=t.parentNode;if(a){a.replaceChild(n,t);var s=_d(e,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return ns.EMPTY},BE=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(e,t),a.setEnd(e,t+r),a},px=function(e){if(_n.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return RO(e)},KO=function(e,t){if(_n.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return XO(e,t)},jO=function(e,t){return t.letterSpacing!==0?px(e):KO(e,t)},zO=[32,160,4961,65792,65793,4153,4241],XO=function(e,t){for(var r=w6(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],a,s=function(){if(a.value){var l=a.value.slice(),o=bd(l),u="";o.forEach(function(f){zO.indexOf(f)===-1?u+=Yr(f):(u.length&&n.push(u),n.push(Yr(f)),u="")}),u.length&&n.push(u)}};!(a=r.next()).done;)s();return n},JO=(function(){function e(t,r,n){this.text=WO(r.data,n.textTransform),this.textBounds=GO(t,this.text,n,r)}return e})(),WO=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(YO,qO);case 2:return e.toUpperCase();default:return e}},YO=/(^|\s|:|-|\(|\))([a-z])/g,qO=function(e,t,r){return e.length>0?t+r.toUpperCase():e},n_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return t})(SA),a_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return t})(SA),A_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this,s=new XMLSerializer,l=_d(r,n);return n.setAttribute("width",l.width+"px"),n.setAttribute("height",l.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return t})(SA),s_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.value=n.value,a}return t})(SA),kp=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return t})(SA),$O=[{type:15,flags:0,unit:"px",number:3}],ZO=[{type:16,flags:0,number:50}],eP=function(e){return e.width>e.height?new ns(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new ns(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},tP=function(e){var t=e.type===rP?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},qf="checkbox",$f="radio",rP="password",CE=707406591,xx=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=tP(n),(a.type===qf||a.type===$f)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=eP(a.bounds)),a.type){case qf:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=$O;break;case $f:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=ZO;break}return a}return t})(SA),i_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return t})(SA),l_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.value=n.value,a}return t})(SA),o_=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=u_(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?Mc(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):qA.TRANSPARENT,l=n.contentWindow.document.body?Mc(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):qA.TRANSPARENT;a.backgroundColor=Js(s)?Js(l)?a.styles.backgroundColor:l:s}}catch{}return a}return t})(SA),nP=["OL","UL","MENU"],Hf=function(e,t,r,n){for(var a=t.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,f_(a)&&a.data.trim().length>0)r.textNodes.push(new JO(e,a,r.styles));else if(eo(a))if(m_(a)&&a.assignedNodes)a.assignedNodes().forEach(function(o){return Hf(e,o,r,n)});else{var l=c_(e,a);l.styles.isVisible()&&(aP(a,l,n)?l.flags|=4:AP(l.styles)&&(l.flags|=2),nP.indexOf(a.tagName)!==-1&&(l.flags|=8),r.elements.push(l),a.slot,a.shadowRoot?Hf(e,a.shadowRoot,l,n):!Zf(a)&&!d_(a)&&!ed(a)&&Hf(e,a,l,n))}},c_=function(e,t){return Ip(t)?new n_(e,t):h_(t)?new a_(e,t):d_(t)?new A_(e,t):sP(t)?new s_(e,t):iP(t)?new kp(e,t):lP(t)?new xx(e,t):ed(t)?new i_(e,t):Zf(t)?new l_(e,t):g_(t)?new o_(e,t):new SA(e,t)},u_=function(e,t){var r=c_(e,t);return r.flags|=4,Hf(e,t,r,r),r},aP=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||vx(e)&&r.styles.isTransparent()},AP=function(e){return e.isPositioned()||e.isFloating()},f_=function(e){return e.nodeType===Node.TEXT_NODE},eo=function(e){return e.nodeType===Node.ELEMENT_NODE},Np=function(e){return eo(e)&&typeof e.style<"u"&&!Of(e)},Of=function(e){return typeof e.className=="object"},sP=function(e){return e.tagName==="LI"},iP=function(e){return e.tagName==="OL"},lP=function(e){return e.tagName==="INPUT"},oP=function(e){return e.tagName==="HTML"},d_=function(e){return e.tagName==="svg"},vx=function(e){return e.tagName==="BODY"},h_=function(e){return e.tagName==="CANVAS"},EE=function(e){return e.tagName==="VIDEO"},Ip=function(e){return e.tagName==="IMG"},g_=function(e){return e.tagName==="IFRAME"},SE=function(e){return e.tagName==="STYLE"},cP=function(e){return e.tagName==="SCRIPT"},Zf=function(e){return e.tagName==="TEXTAREA"},ed=function(e){return e.tagName==="SELECT"},m_=function(e){return e.tagName==="SLOT"},TE=function(e){return e.tagName.indexOf("-")>0},uP=(function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,a=t.counterReset,s=!0;n!==null&&n.forEach(function(o){var u=r.counters[o.counter];u&&o.increment!==0&&(s=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=o.increment)});var l=[];return s&&a.forEach(function(o){var u=r.counters[o.counter];l.push(o.counter),u||(u=r.counters[o.counter]=[]),u.push(o.reset)}),l},e})(),_E={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},bE={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},fP={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},dP={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Pl=function(e,t,r,n,a,s){return e<t||e>r?ru(e,a,s.length>0):n.integers.reduce(function(l,o,u){for(;e>=o;)e-=o,l+=n.values[u];return l},"")+s},p_=function(e,t,r,n){var a="";do r||e--,a=n(e)+a,e/=t;while(e*t>=t);return a},Jr=function(e,t,r,n,a){var s=r-t+1;return(e<0?"-":"")+(p_(Math.abs(e),s,n,function(l){return Yr(Math.floor(l%s)+t)})+a)},Ti=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return p_(Math.abs(e),n,!1,function(a){return t[Math.floor(a%n)]})+r},Wl=1,Ls=2,Hs=4,kc=8,JA=function(e,t,r,n,a,s){if(e<-9999||e>9999)return ru(e,4,a.length>0);var l=Math.abs(e),o=a;if(l===0)return t[0]+o;for(var u=0;l>0&&u<=4;u++){var f=l%10;f===0&&fn(s,Wl)&&o!==""?o=t[f]+o:f>1||f===1&&u===0||f===1&&u===1&&fn(s,Ls)||f===1&&u===1&&fn(s,Hs)&&e>100||f===1&&u>1&&fn(s,kc)?o=t[f]+(u>0?r[u-1]:"")+o:f===1&&u>0&&(o=r[u-1]+o),l=Math.floor(l/10)}return(e<0?n:"")+o},FE="",UE="",kE="",Em="",ru=function(e,t,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",l=r?" ":"";switch(t){case 0:return""+l;case 1:return""+l;case 2:return""+l;case 5:var o=Jr(e,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return Ti(e,"",a);case 6:return Pl(e,1,3999,_E,3,n).toLowerCase();case 7:return Pl(e,1,3999,_E,3,n);case 8:return Jr(e,945,969,!1,n);case 9:return Jr(e,97,122,!1,n);case 10:return Jr(e,65,90,!1,n);case 11:return Jr(e,1632,1641,!0,n);case 12:case 49:return Pl(e,1,9999,bE,3,n);case 35:return Pl(e,1,9999,bE,3,n).toLowerCase();case 13:return Jr(e,2534,2543,!0,n);case 14:case 30:return Jr(e,6112,6121,!0,n);case 15:return Ti(e,"",a);case 16:return Ti(e,"",a);case 17:case 48:return JA(e,"",FE,"",a,Ls|Hs|kc);case 47:return JA(e,"",UE,"",a,Wl|Ls|Hs|kc);case 42:return JA(e,"",FE,"",a,Ls|Hs|kc);case 41:return JA(e,"",UE,"",a,Wl|Ls|Hs|kc);case 26:return JA(e,"","",kE,a,0);case 25:return JA(e,"","",kE,a,Wl|Ls|Hs);case 31:return JA(e,"","",Em,s,Wl|Ls|Hs);case 33:return JA(e,"","",Em,s,0);case 32:return JA(e,"","",Em,s,Wl|Ls|Hs);case 18:return Jr(e,2406,2415,!0,n);case 20:return Pl(e,1,19999,dP,3,n);case 21:return Jr(e,2790,2799,!0,n);case 22:return Jr(e,2662,2671,!0,n);case 22:return Pl(e,1,10999,fP,3,n);case 23:return Ti(e,"");case 24:return Ti(e,"");case 27:return Jr(e,3302,3311,!0,n);case 28:return Ti(e,"",a);case 29:return Ti(e,"",a);case 34:return Jr(e,3792,3801,!0,n);case 37:return Jr(e,6160,6169,!0,n);case 38:return Jr(e,4160,4169,!0,n);case 39:return Jr(e,2918,2927,!0,n);case 40:return Jr(e,1776,1785,!0,n);case 43:return Jr(e,3046,3055,!0,n);case 44:return Jr(e,3174,3183,!0,n);case 45:return Jr(e,3664,3673,!0,n);case 46:return Jr(e,3872,3881,!0,n);case 3:default:return Jr(e,48,57,!0,n)}},x_="data-html2canvas-ignore",NE=(function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new uP,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,a=hP(t,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,l=t.defaultView.pageYOffset,o=a.contentWindow,u=o.document,f=pP(a).then(function(){return Jn(n,void 0,void 0,function(){var d,m;return Qn(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(yP),o&&(o.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==r.top||o.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-r.left,o.scrollY-r.top,0,0))),d=this.options.onclone,m=this.clonedReferenceElement,typeof m>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,mP(u)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(u,m)}).then(function(){return a})]:[2,a]}})})});return u.open(),u.write(vP(document.doctype)+"<html></html>"),wP(this.referenceElement.ownerDocument,s,l),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),f},e.prototype.createElementClone=function(t){if(Fp(t,2))debugger;if(h_(t))return this.createCanvasClone(t);if(EE(t))return this.createVideoClone(t);if(SE(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return Ip(r)&&(Ip(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),TE(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return Sm(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,l){return l&&typeof l.cssText=="string"?s+l.cssText:s},""),a=t.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var a=t.cloneNode(!1);try{a.width=t.width,a.height=t.height;var s=t.getContext("2d"),l=a.getContext("2d");if(l)if(!this.options.allowTaint&&s)l.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var o=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(o){var u=o.getContextAttributes();(u==null?void 0:u.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}l.drawImage(t,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return a},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var a=t.ownerDocument.createElement("canvas");return a.width=t.offsetWidth,a.height=t.offsetHeight,a},e.prototype.appendChildNode=function(t,r,n){(!eo(r)||!cP(r)&&!r.hasAttribute(x_)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!eo(r)||!SE(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var a=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(eo(s)&&m_(s)&&typeof s.assignedNodes=="function"){var l=s.assignedNodes();l.length&&l.forEach(function(o){return a.appendChildNode(r,o,n)})}else this.appendChildNode(r,s,n)},e.prototype.cloneNode=function(t,r){if(f_(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&eo(t)&&(Np(t)||Of(t))){var a=this.createElementClone(t);a.style.transitionProperty="none";var s=n.getComputedStyle(t),l=n.getComputedStyle(t,":before"),o=n.getComputedStyle(t,":after");this.referenceElement===t&&Np(a)&&(this.clonedReferenceElement=a),vx(a)&&EP(a);var u=this.counters.parse(new oE(this.context,s)),f=this.resolvePseudoContent(t,a,l,Oc.BEFORE);TE(t)&&(r=!0),EE(t)||this.cloneChildNodes(t,a,r),f&&a.insertBefore(f,a.firstChild);var d=this.resolvePseudoContent(t,a,o,Oc.AFTER);return d&&a.appendChild(d),this.counters.pop(u),(s&&(this.options.copyStyles||Of(t))&&!g_(t)||r)&&Sm(s,a),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([a,t.scrollLeft,t.scrollTop]),(Zf(t)||ed(t))&&(Zf(a)||ed(a))&&(a.value=t.value),a}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,a){var s=this;if(n){var l=n.content,o=r.ownerDocument;if(!(!o||!l||l==="none"||l==="-moz-alt-content"||n.display==="none")){this.counters.parse(new oE(this.context,n));var u=new sO(this.context,n),f=o.createElement("html2canvaspseudoelement");Sm(n,f),u.content.forEach(function(m){if(m.type===0)f.appendChild(o.createTextNode(m.value));else if(m.type===22){var x=o.createElement("img");x.src=m.value,x.style.opacity="1",f.appendChild(x)}else if(m.type===18){if(m.name==="attr"){var y=m.values.filter(wr);y.length&&f.appendChild(o.createTextNode(t.getAttribute(y[0].value)||""))}else if(m.name==="counter"){var E=m.values.filter(oo),C=E[0],S=E[1];if(C&&wr(C)){var T=s.counters.getCounterValue(C.value),F=S&&wr(S)?bp.parse(s.context,S.value):3;f.appendChild(o.createTextNode(ru(T,F,!1)))}}else if(m.name==="counters"){var _=m.values.filter(oo),C=_[0],Q=_[1],S=_[2];if(C&&wr(C)){var L=s.counters.getCounterValues(C.value),R=S&&wr(S)?bp.parse(s.context,S.value):3,U=Q&&Q.type===0?Q.value:"",K=L.map(function(re){return ru(re,R,!1)}).join(U);f.appendChild(o.createTextNode(K))}}}else if(m.type===20)switch(m.value){case"open-quote":f.appendChild(o.createTextNode(lE(u.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(o.createTextNode(lE(u.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(o.createTextNode(m.value))}}),f.className=Qp+" "+Rp;var d=a===Oc.BEFORE?" "+Qp:" "+Rp;return Of(r)?r.className.baseValue+=d:r.className+=d,f}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e})(),Oc;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(Oc||(Oc={}));var hP=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(x_,"true"),e.body.appendChild(r),r},gP=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},mP=function(e){return Promise.all([].slice.call(e.images,0).map(gP))},pP=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),t(e))},50)}})},xP=["all","d","content"],Sm=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);xP.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},vP=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},wP=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},yP=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},BP=":before",CP=":after",Qp="___html2canvas___pseudoelement_before",Rp="___html2canvas___pseudoelement_after",IE=`{
    content: "" !important;
    display: none !important;
}`,EP=function(e){SP(e,"."+Qp+BP+IE+`
         .`+Rp+CP+IE)},SP=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},v_=(function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e})(),TP=(function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(_m(t)||UP(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return Jn(this,void 0,void 0,function(){var r,n,a,s,l=this;return Qn(this,function(o){switch(o.label){case 0:return r=v_.isSameOrigin(t),n=!Tm(t)&&this._options.useCORS===!0&&_n.SUPPORT_CORS_IMAGES&&!r,a=!Tm(t)&&!r&&!_m(t)&&typeof this._options.proxy=="string"&&_n.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!Tm(t)&&!_m(t)&&!a&&!n?[2]:(s=t,a?[4,this.proxy(s)]:[3,2]);case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(u,f){var d=new Image;d.onload=function(){return u(d)},d.onerror=f,(kP(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return u(d)},500),l._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+l._options.imageTimeout+"ms) loading image")},l._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=t.substring(0,256);return new Promise(function(s,l){var o=_n.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(o==="text")s(u.response);else{var m=new FileReader;m.addEventListener("load",function(){return s(m.result)},!1),m.addEventListener("error",function(x){return l(x)},!1),m.readAsDataURL(u.response)}else l("Failed to proxy resource "+a+" with status code "+u.status)},u.onerror=l;var f=n.indexOf("?")>-1?"&":"?";if(u.open("GET",""+n+f+"url="+encodeURIComponent(t)+"&responseType="+o),o!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=o),r._options.imageTimeout){var d=r._options.imageTimeout;u.timeout=d,u.ontimeout=function(){return l("Timed out ("+d+"ms) proxying "+a)}}u.send()})},e})(),_P=/^data:image\/svg\+xml/i,bP=/^data:image\/.*;base64,/i,FP=/^data:image\/.*/i,UP=function(e){return _n.SUPPORT_SVG_DRAWING||!NP(e)},Tm=function(e){return FP.test(e)},kP=function(e){return bP.test(e)},_m=function(e){return e.substr(0,4)==="blob"},NP=function(e){return e.substr(-3).toLowerCase()==="svg"||_P.test(e)},Ze=(function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e})(),Gl=function(e,t,r){return new Ze(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},uf=(function(){function e(t,r,n,a){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=a}return e.prototype.subdivide=function(t,r){var n=Gl(this.start,this.startControl,t),a=Gl(this.startControl,this.endControl,t),s=Gl(this.endControl,this.end,t),l=Gl(n,a,t),o=Gl(a,s,t),u=Gl(l,o,t);return r?new e(this.start,n,l,u):new e(u,o,s,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),Ka=function(e){return e.type===1},IP=(function(){function e(t){var r=t.styles,n=t.bounds,a=Fc(r.borderTopLeftRadius,n.width,n.height),s=a[0],l=a[1],o=Fc(r.borderTopRightRadius,n.width,n.height),u=o[0],f=o[1],d=Fc(r.borderBottomRightRadius,n.width,n.height),m=d[0],x=d[1],y=Fc(r.borderBottomLeftRadius,n.width,n.height),E=y[0],C=y[1],S=[];S.push((s+u)/n.width),S.push((E+m)/n.width),S.push((l+C)/n.height),S.push((f+x)/n.height);var T=Math.max.apply(Math,S);T>1&&(s/=T,l/=T,u/=T,f/=T,m/=T,x/=T,E/=T,C/=T);var F=n.width-u,_=n.height-x,Q=n.width-m,L=n.height-C,R=r.borderTopWidth,U=r.borderRightWidth,K=r.borderBottomWidth,D=r.borderLeftWidth,ee=_r(r.paddingTop,t.bounds.width),re=_r(r.paddingRight,t.bounds.width),Z=_r(r.paddingBottom,t.bounds.width),ae=_r(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||l>0?Rr(n.left+D/3,n.top+R/3,s-D/3,l-R/3,ir.TOP_LEFT):new Ze(n.left+D/3,n.top+R/3),this.topRightBorderDoubleOuterBox=s>0||l>0?Rr(n.left+F,n.top+R/3,u-U/3,f-R/3,ir.TOP_RIGHT):new Ze(n.left+n.width-U/3,n.top+R/3),this.bottomRightBorderDoubleOuterBox=m>0||x>0?Rr(n.left+Q,n.top+_,m-U/3,x-K/3,ir.BOTTOM_RIGHT):new Ze(n.left+n.width-U/3,n.top+n.height-K/3),this.bottomLeftBorderDoubleOuterBox=E>0||C>0?Rr(n.left+D/3,n.top+L,E-D/3,C-K/3,ir.BOTTOM_LEFT):new Ze(n.left+D/3,n.top+n.height-K/3),this.topLeftBorderDoubleInnerBox=s>0||l>0?Rr(n.left+D*2/3,n.top+R*2/3,s-D*2/3,l-R*2/3,ir.TOP_LEFT):new Ze(n.left+D*2/3,n.top+R*2/3),this.topRightBorderDoubleInnerBox=s>0||l>0?Rr(n.left+F,n.top+R*2/3,u-U*2/3,f-R*2/3,ir.TOP_RIGHT):new Ze(n.left+n.width-U*2/3,n.top+R*2/3),this.bottomRightBorderDoubleInnerBox=m>0||x>0?Rr(n.left+Q,n.top+_,m-U*2/3,x-K*2/3,ir.BOTTOM_RIGHT):new Ze(n.left+n.width-U*2/3,n.top+n.height-K*2/3),this.bottomLeftBorderDoubleInnerBox=E>0||C>0?Rr(n.left+D*2/3,n.top+L,E-D*2/3,C-K*2/3,ir.BOTTOM_LEFT):new Ze(n.left+D*2/3,n.top+n.height-K*2/3),this.topLeftBorderStroke=s>0||l>0?Rr(n.left+D/2,n.top+R/2,s-D/2,l-R/2,ir.TOP_LEFT):new Ze(n.left+D/2,n.top+R/2),this.topRightBorderStroke=s>0||l>0?Rr(n.left+F,n.top+R/2,u-U/2,f-R/2,ir.TOP_RIGHT):new Ze(n.left+n.width-U/2,n.top+R/2),this.bottomRightBorderStroke=m>0||x>0?Rr(n.left+Q,n.top+_,m-U/2,x-K/2,ir.BOTTOM_RIGHT):new Ze(n.left+n.width-U/2,n.top+n.height-K/2),this.bottomLeftBorderStroke=E>0||C>0?Rr(n.left+D/2,n.top+L,E-D/2,C-K/2,ir.BOTTOM_LEFT):new Ze(n.left+D/2,n.top+n.height-K/2),this.topLeftBorderBox=s>0||l>0?Rr(n.left,n.top,s,l,ir.TOP_LEFT):new Ze(n.left,n.top),this.topRightBorderBox=u>0||f>0?Rr(n.left+F,n.top,u,f,ir.TOP_RIGHT):new Ze(n.left+n.width,n.top),this.bottomRightBorderBox=m>0||x>0?Rr(n.left+Q,n.top+_,m,x,ir.BOTTOM_RIGHT):new Ze(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=E>0||C>0?Rr(n.left,n.top+L,E,C,ir.BOTTOM_LEFT):new Ze(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||l>0?Rr(n.left+D,n.top+R,Math.max(0,s-D),Math.max(0,l-R),ir.TOP_LEFT):new Ze(n.left+D,n.top+R),this.topRightPaddingBox=u>0||f>0?Rr(n.left+Math.min(F,n.width-U),n.top+R,F>n.width+U?0:Math.max(0,u-U),Math.max(0,f-R),ir.TOP_RIGHT):new Ze(n.left+n.width-U,n.top+R),this.bottomRightPaddingBox=m>0||x>0?Rr(n.left+Math.min(Q,n.width-D),n.top+Math.min(_,n.height-K),Math.max(0,m-U),Math.max(0,x-K),ir.BOTTOM_RIGHT):new Ze(n.left+n.width-U,n.top+n.height-K),this.bottomLeftPaddingBox=E>0||C>0?Rr(n.left+D,n.top+Math.min(L,n.height-K),Math.max(0,E-D),Math.max(0,C-K),ir.BOTTOM_LEFT):new Ze(n.left+D,n.top+n.height-K),this.topLeftContentBox=s>0||l>0?Rr(n.left+D+ae,n.top+R+ee,Math.max(0,s-(D+ae)),Math.max(0,l-(R+ee)),ir.TOP_LEFT):new Ze(n.left+D+ae,n.top+R+ee),this.topRightContentBox=u>0||f>0?Rr(n.left+Math.min(F,n.width+D+ae),n.top+R+ee,F>n.width+D+ae?0:u-D+ae,f-(R+ee),ir.TOP_RIGHT):new Ze(n.left+n.width-(U+re),n.top+R+ee),this.bottomRightContentBox=m>0||x>0?Rr(n.left+Math.min(Q,n.width-(D+ae)),n.top+Math.min(_,n.height+R+ee),Math.max(0,m-(U+re)),x-(K+Z),ir.BOTTOM_RIGHT):new Ze(n.left+n.width-(U+re),n.top+n.height-(K+Z)),this.bottomLeftContentBox=E>0||C>0?Rr(n.left+D+ae,n.top+L,Math.max(0,E-(D+ae)),C-(K+Z),ir.BOTTOM_LEFT):new Ze(n.left+D+ae,n.top+n.height-(K+Z))}return e})(),ir;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(ir||(ir={}));var Rr=function(e,t,r,n,a){var s=4*((Math.sqrt(2)-1)/3),l=r*s,o=n*s,u=e+r,f=t+n;switch(a){case ir.TOP_LEFT:return new uf(new Ze(e,f),new Ze(e,f-o),new Ze(u-l,t),new Ze(u,t));case ir.TOP_RIGHT:return new uf(new Ze(e,t),new Ze(e+l,t),new Ze(u,f-o),new Ze(u,f));case ir.BOTTOM_RIGHT:return new uf(new Ze(u,t),new Ze(u,t+o),new Ze(e+l,f),new Ze(e,f));case ir.BOTTOM_LEFT:default:return new uf(new Ze(u,f),new Ze(u-l,f),new Ze(e,t+o),new Ze(e,t))}},td=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},QP=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},rd=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},RP=(function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e})(),ff=(function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e})(),DP=(function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e})(),MP=function(e){return e.type===0},w_=function(e){return e.type===1},LP=function(e){return e.type===2},QE=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},HP=function(e,t,r,n,a){return e.map(function(s,l){switch(l){case 0:return s.add(t,r);case 1:return s.add(t+n,r);case 2:return s.add(t+n,r+a);case 3:return s.add(t,r+a)}return s})},y_=(function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),B_=(function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new IP(this.container),this.container.styles.opacity<1&&this.effects.push(new DP(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new RP(n,a,s))}if(this.container.styles.overflowX!==0){var l=td(this.curves),o=rd(this.curves);QE(l,o)?this.effects.push(new ff(l,6)):(this.effects.push(new ff(l,2)),this.effects.push(new ff(o,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(u){return!w_(u)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var l=td(n.curves),o=rd(n.curves);QE(l,o)||a.unshift(new ff(o,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(u){return fn(u.target,t)})},e})(),Dp=function(e,t,r,n){e.container.elements.forEach(function(a){var s=fn(a.flags,4),l=fn(a.flags,2),o=new B_(a,e);fn(a.styles.display,2048)&&n.push(o);var u=fn(a.flags,8)?[]:n;if(s||l){var f=s||a.styles.isPositioned()?r:t,d=new y_(o);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var m=a.styles.zIndex.order;if(m<0){var x=0;f.negativeZIndex.some(function(E,C){return m>E.element.container.styles.zIndex.order?(x=C,!1):x>0}),f.negativeZIndex.splice(x,0,d)}else if(m>0){var y=0;f.positiveZIndex.some(function(E,C){return m>=E.element.container.styles.zIndex.order?(y=C+1,!1):y>0}),f.positiveZIndex.splice(y,0,d)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?f.nonPositionedFloats.push(d):f.nonPositionedInlineLevel.push(d);Dp(o,d,s?d:r,u)}else a.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),Dp(o,t,r,u);fn(a.flags,8)&&C_(a,u)})},C_=function(e,t){for(var r=e instanceof kp?e.start:1,n=e instanceof kp?e.reversed:!1,a=0;a<t.length;a++){var s=t[a];s.container instanceof s_&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=ru(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},OP=function(e){var t=new B_(e,null),r=new y_(t),n=[];return Dp(t,r,r,n),C_(t.container,n),r},RE=function(e,t){switch(t){case 0:return za(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return za(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return za(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return za(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},PP=function(e,t){switch(t){case 0:return za(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return za(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return za(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return za(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},GP=function(e,t){switch(t){case 0:return za(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return za(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return za(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return za(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},VP=function(e,t){switch(t){case 0:return df(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return df(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return df(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return df(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},df=function(e,t){var r=[];return Ka(e)?r.push(e.subdivide(.5,!1)):r.push(e),Ka(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},za=function(e,t,r,n){var a=[];return Ka(e)?a.push(e.subdivide(.5,!1)):a.push(e),Ka(r)?a.push(r.subdivide(.5,!0)):a.push(r),Ka(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),Ka(t)?a.push(t.subdivide(.5,!1).reverse()):a.push(t),a},E_=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},nd=function(e){var t=e.styles,r=e.bounds,n=_r(t.paddingLeft,r.width),a=_r(t.paddingRight,r.width),s=_r(t.paddingTop,r.width),l=_r(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+a),-(t.borderTopWidth+t.borderBottomWidth+s+l))},KP=function(e,t){return e===0?t.bounds:e===2?nd(t):E_(t)},jP=function(e,t){return e===0?t.bounds:e===2?nd(t):E_(t)},bm=function(e,t,r){var n=KP(Yl(e.styles.backgroundOrigin,t),e),a=jP(Yl(e.styles.backgroundClip,t),e),s=zP(Yl(e.styles.backgroundSize,t),r,n),l=s[0],o=s[1],u=Fc(Yl(e.styles.backgroundPosition,t),n.width-l,n.height-o),f=XP(Yl(e.styles.backgroundRepeat,t),u,s,n,a),d=Math.round(n.left+u[0]),m=Math.round(n.top+u[1]);return[f,d,m,l,o]},Vl=function(e){return wr(e)&&e.value===ao.AUTO},hf=function(e){return typeof e=="number"},zP=function(e,t,r){var n=t[0],a=t[1],s=t[2],l=e[0],o=e[1];if(!l)return[0,0];if(cn(l)&&o&&cn(o))return[_r(l,r.width),_r(o,r.height)];var u=hf(s);if(wr(l)&&(l.value===ao.CONTAIN||l.value===ao.COVER)){if(hf(s)){var f=r.width/r.height;return f<s!=(l.value===ao.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=hf(n),m=hf(a),x=d||m;if(Vl(l)&&(!o||Vl(o))){if(d&&m)return[n,a];if(!u&&!x)return[r.width,r.height];if(x&&u){var y=d?n:a*s,E=m?a:n/s;return[y,E]}var C=d?n:r.width,S=m?a:r.height;return[C,S]}if(u){var T=0,F=0;return cn(l)?T=_r(l,r.width):cn(o)&&(F=_r(o,r.height)),Vl(l)?T=F*s:(!o||Vl(o))&&(F=T/s),[T,F]}var _=null,Q=null;if(cn(l)?_=_r(l,r.width):o&&cn(o)&&(Q=_r(o,r.height)),_!==null&&(!o||Vl(o))&&(Q=d&&m?_/n*a:r.height),Q!==null&&Vl(l)&&(_=d&&m?Q/a*n:r.width),_!==null&&Q!==null)return[_,Q];throw new Error("Unable to calculate background-size for element")},Yl=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},XP=function(e,t,r,n,a){var s=t[0],l=t[1],o=r[0],u=r[1];switch(e){case 2:return[new Ze(Math.round(n.left),Math.round(n.top+l)),new Ze(Math.round(n.left+n.width),Math.round(n.top+l)),new Ze(Math.round(n.left+n.width),Math.round(u+n.top+l)),new Ze(Math.round(n.left),Math.round(u+n.top+l))];case 3:return[new Ze(Math.round(n.left+s),Math.round(n.top)),new Ze(Math.round(n.left+s+o),Math.round(n.top)),new Ze(Math.round(n.left+s+o),Math.round(n.height+n.top)),new Ze(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new Ze(Math.round(n.left+s),Math.round(n.top+l)),new Ze(Math.round(n.left+s+o),Math.round(n.top+l)),new Ze(Math.round(n.left+s+o),Math.round(n.top+l+u)),new Ze(Math.round(n.left+s),Math.round(n.top+l+u))];default:return[new Ze(Math.round(a.left),Math.round(a.top)),new Ze(Math.round(a.left+a.width),Math.round(a.top)),new Ze(Math.round(a.left+a.width),Math.round(a.height+a.top)),new Ze(Math.round(a.left),Math.round(a.height+a.top))]}},JP="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",DE="Hidden Text",WP=(function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),l=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",l.appendChild(n),a.src=JP,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(DE)),n.appendChild(s),n.appendChild(a);var o=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(DE)),n.style.lineHeight="normal",a.style.verticalAlign="super";var u=a.offsetTop-n.offsetTop+2;return l.removeChild(n),{baseline:o,middle:u}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e})(),S_=(function(){function e(t,r){this.context=t,this.options=r}return e})(),YP=1e4,qP=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new WP(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},t.prototype.applyEffect=function(r){this.ctx.save(),LP(r)&&(this.ctx.globalAlpha=r.opacity),MP(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),w_(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return Jn(this,void 0,void 0,function(){var n;return Qn(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return Jn(this,void 0,void 0,function(){return Qn(this,function(n){switch(n.label){case 0:if(fn(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var l=px(r.text);l.reduce(function(o,u){return s.ctx.fillText(u,o,r.bounds.top+a),o+s.ctx.measureText(u).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(l){return l==="normal"||l==="small-caps"}).join(""),a=r7(r.fontFamily).join(", "),s=wu(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},t.prototype.renderTextNode=function(r,n){return Jn(this,void 0,void 0,function(){var a,s,l,o,u,f,d,m,x=this;return Qn(this,function(y){return a=this.createFontStyle(n),s=a[0],l=a[1],o=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(l,o),f=u.baseline,d=u.middle,m=n.paintOrder,r.textBounds.forEach(function(E){m.forEach(function(C){switch(C){case 0:x.ctx.fillStyle=mn(n.color),x.renderTextWithLetterSpacing(E,n.letterSpacing,f);var S=n.textShadow;S.length&&E.text.trim().length&&(S.slice(0).reverse().forEach(function(T){x.ctx.shadowColor=mn(T.color),x.ctx.shadowOffsetX=T.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=T.offsetY.number*x.options.scale,x.ctx.shadowBlur=T.blur.number,x.renderTextWithLetterSpacing(E,n.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),n.textDecorationLine.length&&(x.ctx.fillStyle=mn(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(T){switch(T){case 1:x.ctx.fillRect(E.bounds.left,Math.round(E.bounds.top+f),E.bounds.width,1);break;case 2:x.ctx.fillRect(E.bounds.left,Math.round(E.bounds.top),E.bounds.width,1);break;case 3:x.ctx.fillRect(E.bounds.left,Math.ceil(E.bounds.top+d),E.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&E.text.trim().length&&(x.ctx.strokeStyle=mn(n.webkitTextStrokeColor),x.ctx.lineWidth=n.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(E.text,E.bounds.left,E.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=nd(r),l=rd(n);this.path(l),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return Jn(this,void 0,void 0,function(){var n,a,s,l,o,u,F,F,f,d,m,x,Q,y,E,L,C,S,T,F,_,Q,L;return Qn(this,function(R){switch(R.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,l=0,o=n.textNodes,R.label=1;case 1:return l<o.length?(u=o[l],[4,this.renderTextNode(u,s)]):[3,4];case 2:R.sent(),R.label=3;case 3:return l++,[3,1];case 4:if(!(n instanceof n_))return[3,8];R.label=5;case 5:return R.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return F=R.sent(),this.renderReplacedElement(n,a,F),[3,8];case 7:return R.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof a_&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof A_))return[3,12];R.label=9;case 9:return R.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return F=R.sent(),this.renderReplacedElement(n,a,F),[3,12];case 11:return R.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof o_&&n.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,f.render(n.tree)]):[3,14];case 13:d=R.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),R.label=14;case 14:if(n instanceof xx&&(m=Math.min(n.bounds.width,n.bounds.height),n.type===qf?n.checked&&(this.ctx.save(),this.path([new Ze(n.bounds.left+m*.39363,n.bounds.top+m*.79),new Ze(n.bounds.left+m*.16,n.bounds.top+m*.5549),new Ze(n.bounds.left+m*.27347,n.bounds.top+m*.44071),new Ze(n.bounds.left+m*.39694,n.bounds.top+m*.5649),new Ze(n.bounds.left+m*.72983,n.bounds.top+m*.23),new Ze(n.bounds.left+m*.84,n.bounds.top+m*.34085),new Ze(n.bounds.left+m*.39363,n.bounds.top+m*.79)]),this.ctx.fillStyle=mn(CE),this.ctx.fill(),this.ctx.restore()):n.type===$f&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+m/2,n.bounds.top+m/2,m/4,0,Math.PI*2,!0),this.ctx.fillStyle=mn(CE),this.ctx.fill(),this.ctx.restore())),$P(n)&&n.value.length){switch(x=this.createFontStyle(s),Q=x[0],y=x[1],E=this.fontMetrics.getMetrics(Q,y).baseline,this.ctx.font=Q,this.ctx.fillStyle=mn(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=e7(n.styles.textAlign),L=nd(n),C=0,n.styles.textAlign){case 1:C+=L.width/2;break;case 2:C+=L.width;break}S=L.add(C,0,0,-L.height/2+1),this.ctx.save(),this.path([new Ze(L.left,L.top),new Ze(L.left+L.width,L.top),new Ze(L.left+L.width,L.top+L.height),new Ze(L.left,L.top+L.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Hc(n.value,S),s.letterSpacing,E),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!fn(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(T=n.styles.listStyleImage,T.type!==0)return[3,18];F=void 0,_=T.url,R.label=15;case 15:return R.trys.push([15,17,,18]),[4,this.context.cache.match(_)];case 16:return F=R.sent(),this.ctx.drawImage(F,n.bounds.left-(F.width+10),n.bounds.top),[3,18];case 17:return R.sent(),this.context.logger.error("Error loading list-style-image "+_),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(Q=this.createFontStyle(s)[0],this.ctx.font=Q,this.ctx.fillStyle=mn(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",L=new ns(n.bounds.left,n.bounds.top+_r(n.styles.paddingTop,n.bounds.width),n.bounds.width,sE(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Hc(r.listValue,L),s.letterSpacing,sE(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),R.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return Jn(this,void 0,void 0,function(){var n,a,T,s,l,T,o,u,T,f,d,T,m,x,T,y,E,T,C,S,T;return Qn(this,function(F){switch(F.label){case 0:if(fn(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:F.sent(),n=0,a=r.negativeZIndex,F.label=2;case 2:return n<a.length?(T=a[n],[4,this.renderStack(T)]):[3,5];case 3:F.sent(),F.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:F.sent(),s=0,l=r.nonInlineLevel,F.label=7;case 7:return s<l.length?(T=l[s],[4,this.renderNode(T)]):[3,10];case 8:F.sent(),F.label=9;case 9:return s++,[3,7];case 10:o=0,u=r.nonPositionedFloats,F.label=11;case 11:return o<u.length?(T=u[o],[4,this.renderStack(T)]):[3,14];case 12:F.sent(),F.label=13;case 13:return o++,[3,11];case 14:f=0,d=r.nonPositionedInlineLevel,F.label=15;case 15:return f<d.length?(T=d[f],[4,this.renderStack(T)]):[3,18];case 16:F.sent(),F.label=17;case 17:return f++,[3,15];case 18:m=0,x=r.inlineLevel,F.label=19;case 19:return m<x.length?(T=x[m],[4,this.renderNode(T)]):[3,22];case 20:F.sent(),F.label=21;case 21:return m++,[3,19];case 22:y=0,E=r.zeroOrAutoZIndexOrTransformedOrOpacity,F.label=23;case 23:return y<E.length?(T=E[y],[4,this.renderStack(T)]):[3,26];case 24:F.sent(),F.label=25;case 25:return y++,[3,23];case 26:C=0,S=r.positiveZIndex,F.label=27;case 27:return C<S.length?(T=S[C],[4,this.renderStack(T)]):[3,30];case 28:F.sent(),F.label=29;case 29:return C++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var l=Ka(a)?a.start:a;s===0?n.ctx.moveTo(l.x,l.y):n.ctx.lineTo(l.x,l.y),Ka(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},t.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},t.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var l=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,o=l.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,a);var u=o.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,n,a),o},t.prototype.renderBackgroundImage=function(r){return Jn(this,void 0,void 0,function(){var n,a,s,l,o,u;return Qn(this,function(f){switch(f.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var m,x,y,ee,q,Ae,ae,Te,K,E,ee,q,Ae,ae,Te,C,S,T,F,_,Q,L,R,U,K,D,ee,re,Z,ae,Te,Se,q,Ae,Re,ie,Me,J,k,V,P,z;return Qn(this,function(le){switch(le.label){case 0:if(d.type!==0)return[3,5];m=void 0,x=d.url,le.label=1;case 1:return le.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return m=le.sent(),[3,4];case 3:return le.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return m&&(y=bm(r,n,[m.width,m.height,m.width/m.height]),ee=y[0],q=y[1],Ae=y[2],ae=y[3],Te=y[4],K=s.ctx.createPattern(s.resizeImage(m,ae,Te),"repeat"),s.renderRepeat(ee,K,q,Ae)),[3,6];case 5:M8(d)?(E=bm(r,n,[null,null,null]),ee=E[0],q=E[1],Ae=E[2],ae=E[3],Te=E[4],C=N8(d.angle,ae,Te),S=C[0],T=C[1],F=C[2],_=C[3],Q=C[4],L=document.createElement("canvas"),L.width=ae,L.height=Te,R=L.getContext("2d"),U=R.createLinearGradient(T,_,F,Q),aE(d.stops,S).forEach(function(Be){return U.addColorStop(Be.stop,mn(Be.color))}),R.fillStyle=U,R.fillRect(0,0,ae,Te),ae>0&&Te>0&&(K=s.ctx.createPattern(L,"repeat"),s.renderRepeat(ee,K,q,Ae))):L8(d)&&(D=bm(r,n,[null,null,null]),ee=D[0],re=D[1],Z=D[2],ae=D[3],Te=D[4],Se=d.position.length===0?[hx]:d.position,q=_r(Se[0],ae),Ae=_r(Se[Se.length-1],Te),Re=I8(d,q,Ae,ae,Te),ie=Re[0],Me=Re[1],ie>0&&Me>0&&(J=s.ctx.createRadialGradient(re+q,Z+Ae,0,re+q,Z+Ae,ie),aE(d.stops,ie*2).forEach(function(Be){return J.addColorStop(Be.stop,mn(Be.color))}),s.path(ee),s.ctx.fillStyle=J,ie!==Me?(k=r.bounds.left+.5*r.bounds.width,V=r.bounds.top+.5*r.bounds.height,P=Me/ie,z=1/P,s.ctx.save(),s.ctx.translate(k,V),s.ctx.transform(1,0,0,P,0,0),s.ctx.translate(-k,-V),s.ctx.fillRect(re,z*(Z-V)+V,ae,Te*z),s.ctx.restore()):s.ctx.fill())),le.label=6;case 6:return n--,[2]}})},s=this,l=0,o=r.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return l<o.length?(u=o[l],[5,a(u)]):[3,4];case 2:f.sent(),f.label=3;case 3:return l++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,a){return Jn(this,void 0,void 0,function(){return Qn(this,function(s){return this.path(RE(a,n)),this.ctx.fillStyle=mn(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,a,s){return Jn(this,void 0,void 0,function(){var l,o;return Qn(this,function(u){switch(u.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return u.sent(),[2];case 2:return l=PP(s,a),this.path(l),this.ctx.fillStyle=mn(r),this.ctx.fill(),o=GP(s,a),this.path(o),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return Jn(this,void 0,void 0,function(){var n,a,s,l,o,u,f,d,m=this;return Qn(this,function(x){switch(x.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!Js(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],l=ZP(Yl(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(l),this.ctx.clip(),Js(n.backgroundColor)||(this.ctx.fillStyle=mn(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(y){m.ctx.save();var E=td(r.curves),C=y.inset?0:YP,S=HP(E,-C+(y.inset?1:-1)*y.spread.number,(y.inset?1:-1)*y.spread.number,y.spread.number*(y.inset?-2:2),y.spread.number*(y.inset?-2:2));y.inset?(m.path(E),m.ctx.clip(),m.mask(S)):(m.mask(E),m.ctx.clip(),m.path(S)),m.ctx.shadowOffsetX=y.offsetX.number+C,m.ctx.shadowOffsetY=y.offsetY.number,m.ctx.shadowColor=mn(y.color),m.ctx.shadowBlur=y.blur.number,m.ctx.fillStyle=y.inset?mn(y.color):"rgba(0,0,0,1)",m.ctx.fill(),m.ctx.restore()}),x.label=2;case 2:o=0,u=0,f=s,x.label=3;case 3:return u<f.length?(d=f[u],d.style!==0&&!Js(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,o,r.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,o,r.curves,3)];case 6:return x.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,o,r.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,o,r.curves)];case 10:x.sent(),x.label=11;case 11:o++,x.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,a,s,l){return Jn(this,void 0,void 0,function(){var o,u,f,d,m,x,y,E,C,S,T,F,_,Q,L,R,L,R;return Qn(this,function(U){return this.ctx.save(),o=VP(s,a),u=RE(s,a),l===2&&(this.path(u),this.ctx.clip()),Ka(u[0])?(f=u[0].start.x,d=u[0].start.y):(f=u[0].x,d=u[0].y),Ka(u[1])?(m=u[1].end.x,x=u[1].end.y):(m=u[1].x,x=u[1].y),a===0||a===2?y=Math.abs(f-m):y=Math.abs(d-x),this.ctx.beginPath(),l===3?this.formatPath(o):this.formatPath(u.slice(0,2)),E=n<3?n*3:n*2,C=n<3?n*2:n,l===3&&(E=n,C=n),S=!0,y<=E*2?S=!1:y<=E*2+C?(T=y/(2*E+C),E*=T,C*=T):(F=Math.floor((y+C)/(E+C)),_=(y-F*E)/(F-1),Q=(y-(F+1)*E)/F,C=Q<=0||Math.abs(C-_)<Math.abs(C-Q)?_:Q),S&&(l===3?this.ctx.setLineDash([0,E+C]):this.ctx.setLineDash([E,C])),l===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=mn(r),this.ctx.stroke(),this.ctx.setLineDash([]),l===2&&(Ka(u[0])&&(L=u[3],R=u[0],this.ctx.beginPath(),this.formatPath([new Ze(L.end.x,L.end.y),new Ze(R.start.x,R.start.y)]),this.ctx.stroke()),Ka(u[1])&&(L=u[1],R=u[2],this.ctx.beginPath(),this.formatPath([new Ze(L.end.x,L.end.y),new Ze(R.start.x,R.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return Jn(this,void 0,void 0,function(){var n;return Qn(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=mn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=OP(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},t})(S_),$P=function(e){return e instanceof l_||e instanceof i_?!0:e instanceof xx&&e.type!==$f&&e.type!==qf},ZP=function(e,t){switch(e){case 0:return td(t);case 2:return QP(t);case 1:default:return rd(t)}},e7=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},t7=["-apple-system","system-ui"],r7=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return t7.indexOf(t)===-1}):e},n7=(function(e){uA(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return t.prototype.render=function(r){return Jn(this,void 0,void 0,function(){var n,a;return Qn(this,function(s){switch(s.label){case 0:return n=Up(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,a7(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=mn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t})(S_),a7=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},A7=(function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,j0([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,j0([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,j0([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,j0([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e})(),s7=(function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new A7({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new TP(this,t)}return e.instanceCount=1,e})(),Pc=function(e,t){return t===void 0&&(t={}),i7(e,t)};typeof window<"u"&&v_.setContext(window);var i7=function(e,t){return Jn(void 0,void 0,void 0,function(){var r,n,a,s,l,o,u,f,d,m,x,y,E,C,S,T,F,_,Q,L,U,R,U,K,D,ee,re,Z,ae,Te,Se,q,Ae,Re,ie,Me,J,k,V,P;return Qn(this,function(z){switch(z.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(K=t.allowTaint)!==null&&K!==void 0?K:!1,imageTimeout:(D=t.imageTimeout)!==null&&D!==void 0?D:15e3,proxy:t.proxy,useCORS:(ee=t.useCORS)!==null&&ee!==void 0?ee:!1},s=gp({logging:(re=t.logging)!==null&&re!==void 0?re:!0,cache:t.cache},a),l={windowWidth:(Z=t.windowWidth)!==null&&Z!==void 0?Z:n.innerWidth,windowHeight:(ae=t.windowHeight)!==null&&ae!==void 0?ae:n.innerHeight,scrollX:(Te=t.scrollX)!==null&&Te!==void 0?Te:n.pageXOffset,scrollY:(Se=t.scrollY)!==null&&Se!==void 0?Se:n.pageYOffset},o=new ns(l.scrollX,l.scrollY,l.windowWidth,l.windowHeight),u=new s7(s,o),f=(q=t.foreignObjectRendering)!==null&&q!==void 0?q:!1,d={allowTaint:(Ae=t.allowTaint)!==null&&Ae!==void 0?Ae:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},u.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),m=new NE(u,e,d),x=m.clonedReferenceElement,x?[4,m.toIFrame(r,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return y=z.sent(),E=vx(x)||oP(x)?HH(x.ownerDocument):_d(u,x),C=E.width,S=E.height,T=E.left,F=E.top,_=l7(u,x,t.backgroundColor),Q={canvas:t.canvas,backgroundColor:_,scale:(ie=(Re=t.scale)!==null&&Re!==void 0?Re:n.devicePixelRatio)!==null&&ie!==void 0?ie:1,x:((Me=t.x)!==null&&Me!==void 0?Me:0)+T,y:((J=t.y)!==null&&J!==void 0?J:0)+F,width:(k=t.width)!==null&&k!==void 0?k:Math.ceil(C),height:(V=t.height)!==null&&V!==void 0?V:Math.ceil(S)},f?(u.logger.debug("Document cloned, using foreign object rendering"),U=new n7(u,Q),[4,U.render(x)]):[3,3];case 2:return L=z.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+T+","+F+" with size "+C+"x"+S+" using computed rendering"),u.logger.debug("Starting DOM parsing"),R=u_(u,x),_===R.styles.backgroundColor&&(R.styles.backgroundColor=qA.TRANSPARENT),u.logger.debug("Starting renderer for element at "+Q.x+","+Q.y+" with size "+Q.width+"x"+Q.height),U=new qP(u,Q),[4,U.render(R)];case 4:L=z.sent(),z.label=5;case 5:return(!((P=t.removeContainer)!==null&&P!==void 0)||P)&&(NE.destroy(y)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,L]}})})},l7=function(e,t,r){var n=t.ownerDocument,a=n.documentElement?Mc(e,getComputedStyle(n.documentElement).backgroundColor):qA.TRANSPARENT,s=n.body?Mc(e,getComputedStyle(n.body).backgroundColor):qA.TRANSPARENT,l=typeof r=="string"?Mc(e,r):r===null?qA.TRANSPARENT:4294967295;return t===n.documentElement?Js(a)?Js(s)?l:s:a:l};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ad={};ad.version="0.18.5";var T_=1252,o7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yx=function(e){o7.indexOf(e)!=-1&&(T_=wx[0]=e)};function c7(){yx(1252)}var aA=function(e){yx(e)};function Bx(){aA(1200),c7()}function ME(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function u7(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function __(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Nc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?u7(e.slice(2)):t==254&&r==255?__(e.slice(2)):t==65279?e.slice(1):e},gf=function(t){return String.fromCharCode(t)},LE=function(t){return String.fromCharCode(t)},nu,js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function au(e){for(var t="",r=0,n=0,a=0,s=0,l=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),s=r>>2,n=e.charCodeAt(f++),l=(r&3)<<4|n>>4,a=e.charCodeAt(f++),o=(n&15)<<2|a>>6,u=a&63,isNaN(n)?o=u=64:isNaN(a)&&(u=64),t+=js.charAt(s)+js.charAt(l)+js.charAt(o)+js.charAt(u);return t}function Ba(e){var t="",r=0,n=0,a=0,s=0,l=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)s=js.indexOf(e.charAt(f++)),l=js.indexOf(e.charAt(f++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=js.indexOf(e.charAt(f++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=js.indexOf(e.charAt(f++)),a=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var Mt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ls=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ys(e){return Mt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function HE(e){return Mt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var va=function(t){return Mt?ls(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Md(e){if(typeof ArrayBuffer>"u")return va(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ni(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function f7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Cx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Cx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var xn=Mt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ls(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function d7(e){for(var t=[],r=0,n=e.length+250,a=Ys(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|o>>6&15|(l&3)<<4,a[r++]=128|o&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ys(65535),n=65530)}return t.push(a.slice(0,r)),xn(t)}var qn=/\u0000/g,Ic=/[\u0001-\u0006]/g;function Ao(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function AA(e,t){var r=""+e;return r.length>=t?r:Gr("0",t-r.length)+r}function Ex(e,t){var r=""+e;return r.length>=t?r:Gr(" ",t-r.length)+r}function Ad(e,t){var r=""+e;return r.length>=t?r:r+Gr(" ",t-r.length)}function h7(e,t){var r=""+Math.round(e);return r.length>=t?r:Gr("0",t-r.length)+r}function g7(e,t){var r=""+e;return r.length>=t?r:Gr("0",t-r.length)+r}var OE=Math.pow(2,32);function Kl(e,t){if(e>OE||e<-OE)return h7(e,t);var r=Math.round(e);return g7(r,t)}function sd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var PE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Fm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function m7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},GE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},p7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function id(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,l=1,o=0,u=1,f=0,d=0,m=Math.floor(a);f<t&&(m=Math.floor(a),o=m*l+s,d=m*f+u,!(a-m<5e-8));)a=1/(a-m),s=l,l=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=s):(d=f,o=l)),!r)return[0,n*o,d];var x=Math.floor(n*o/d);return[x,n*o-x*d,d]}function Ri(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),l=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=C7(u,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var b_=new Date(1899,11,31,0,0,0),x7=b_.getTime(),v7=new Date(1900,2,1,0,0,0);function F_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=v7&&(r+=1440*60*1e3),(r-(x7+(e.getTimezoneOffset()-b_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Sx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function w7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function y7(e){var t=e<0?12:11,r=Sx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function B7(e){var t=Sx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Au(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=y7(e):t===10?r=e.toFixed(10).substr(0,12):r=B7(e),Sx(w7(r.toUpperCase()))}function Gi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Au(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ya(14,F_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function C7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function E7(e,t,r,n){var a="",s=0,l=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return Fm[r.m-1][1];case 5:return Fm[r.m-1][0];default:return Fm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return PE[r.q][0];default:return PE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?AA(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(a=AA(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?AA(u,f):"";return d}function zs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var U_=/%/g;function S7(e,t,r){var n=t.replace(U_,""),a=t.length-n.length;return $A(e,n,r*Math.pow(10,2*a))+Gr("%",a)}function T7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $A(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function k_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+k_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var N_=/# (\?+)( ?)\/( ?)(\d+)/;function _7(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),l=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?Gr(" ",e[1].length+1+e[4].length):Ex(l,e[1].length)+e[2]+"/"+e[3]+AA(o,e[4].length))}function b7(e,t,r){return r+(t===0?"":""+t)+Gr(" ",e[1].length+2+e[4].length)}var I_=/^#*0*\.([0#]+)/,Q_=/\).*[0#]/,R_=/\(###\) ###\\?-####/;function Wn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function VE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function KE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function F7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function U7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function La(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Q_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?La("n",n,r):"("+La("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return T7(e,t,r);if(t.indexOf("%")!==-1)return S7(e,t,r);if(t.indexOf("E")!==-1)return k_(t,r);if(t.charCodeAt(0)===36)return"$"+La(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Kl(u,t.length);if(t.match(/^[#?]+$/))return a=Kl(r,0),a==="0"&&(a=""),a.length>t.length?a:Wn(t.substr(0,t.length-a.length))+a;if(s=t.match(N_))return _7(s,u,f);if(t.match(/^#+0+$/))return f+Kl(u,t.length-t.indexOf("0"));if(s=t.match(I_))return a=VE(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Wn(s[1])).replace(/\.$/,"."+Wn(s[1])).replace(/\.(\d*)$/,function(E,C){return"."+C+Gr("0",Wn(s[1]).length-C.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+VE(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+zs(Kl(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+La(e,t,-r):zs(""+(Math.floor(r)+F7(r,s[1].length)))+"."+AA(KE(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return La(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ao(La(e,t.replace(/[\\-]/g,""),r)),l=0,Ao(Ao(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(t.match(R_))return a=La(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=id(u,Math.pow(10,l)-1,!1),a=""+f,d=$A("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Ad(o[2],l),d.length<s[4].length&&(d=Wn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=id(u,Math.pow(10,l)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ex(o[1],l)+s[2]+"/"+s[3]+Ad(o[2],l):Gr(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Kl(r,0),t.length<=a.length?a:Wn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=t.indexOf(".")-l,x=t.length-a.length-m;return Wn(t.substr(0,m)+a+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=KE(r,s[1].length),r<0?"-"+La(e,t,-r):zs(U7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?AA(0,3-E.length):"")+E})+"."+AA(l,s[1].length);switch(t){case"###,##0.00":return La(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=zs(Kl(u,0));return y!=="0"?f+y:"";case"###,###.00":return La(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return La(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function k7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $A(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function N7(e,t,r){var n=t.replace(U_,""),a=t.length-n.length;return $A(e,n,r*Math.pow(10,2*a))+Gr("%",a)}function D_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+D_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function vA(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Q_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vA("n",n,r):"("+vA("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return k7(e,t,r);if(t.indexOf("%")!==-1)return N7(e,t,r);if(t.indexOf("E")!==-1)return D_(t,r);if(t.charCodeAt(0)===36)return"$"+vA(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+AA(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Wn(t.substr(0,t.length-a.length))+a;if(s=t.match(N_))return b7(s,u,f);if(t.match(/^#+0+$/))return f+AA(u,t.length-t.indexOf("0"));if(s=t.match(I_))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Wn(s[1])).replace(/\.$/,"."+Wn(s[1])),a=a.replace(/\.(\d*)$/,function(E,C){return"."+C+Gr("0",Wn(s[1]).length-C.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+zs(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vA(e,t,-r):zs(""+r)+"."+Gr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return vA(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ao(vA(e,t.replace(/[\\-]/g,""),r)),l=0,Ao(Ao(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(t.match(R_))return a=vA(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=id(u,Math.pow(10,l)-1,!1),a=""+f,d=$A("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Ad(o[2],l),d.length<s[4].length&&(d=Wn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=id(u,Math.pow(10,l)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ex(o[1],l)+s[2]+"/"+s[3]+Ad(o[2],l):Gr(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Wn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=t.indexOf(".")-l,x=t.length-a.length-m;return Wn(t.substr(0,m)+a+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+vA(e,t,-r):zs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?AA(0,3-E.length):"")+E})+"."+AA(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=zs(""+u);return y!=="0"?f+y:"";default:if(t.match(/\.[0#?]*$/))return vA(e,t.slice(0,t.lastIndexOf(".")),r)+Wn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $A(e,t,r){return(r|0)===r?vA(e,t,r):La(e,t,r)}function I7(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var M_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function wo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":sd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(M_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Q7(e,t,r,n){for(var a=[],s="",l=0,o="",u="t",f,d,m,x="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!sd(e,l))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(m=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(m);a[a.length]={t:"t",v:s},++l;break;case"\\":var y=e.charAt(++l),E=y==="("||y===")"?y:"t";a[a.length]={t:E,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(f==null&&(f=Ri(t,r,e.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},u=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Ri(t,r),f==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=x),a[a.length]={t:o,v:s},u=o;break;case"A":case"a":case"":var C={t:o,v:o};if(f==null&&(f=Ri(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(C.v=f.H>=12?"P":"A"),C.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(C.v=f.H>=12?"PM":"AM"),C.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="/"?(f!=null&&(C.v=f.H>=12?"":""),C.t="T",l+=5,x="h"):(C.t="t",++l),f==null&&C.t==="T")return"";a[a.length]=C,u=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(M_)){if(f==null&&(f=Ri(t,r),f==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",wo(e)||(a[a.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;a[a.length]={t:o,v:s},u=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++l;break}var S=0,T=0,F;for(l=a.length-1,u="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=x,u="h",S<1&&(S=1);break;case"s":(F=a[l].v.match(/\.0+$/))&&(T=Math.max(T,F[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":u=a[l].t;break;case"m":u==="s"&&(a[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[l].v.match(/[Hh]/)&&(S=1),S<2&&a[l].v.match(/[Mm]/)&&(S=2),S<3&&a[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var _="",Q;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=E7(a[l].t.charCodeAt(0),a[l].v,f,T),a[l].t="t";break;case"n":case"?":for(Q=l+1;a[Q]!=null&&((o=a[Q].t)==="?"||o==="D"||(o===" "||o==="t")&&a[Q+1]!=null&&(a[Q+1].t==="?"||a[Q+1].t==="t"&&a[Q+1].v==="/")||a[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[Q].v==="/"||a[Q].v===" "&&a[Q+1]!=null&&a[Q+1].t=="?"));)a[l].v+=a[Q].v,a[Q]={v:"",t:";"},++Q;_+=a[l].v,l=Q-1;break;case"G":a[l].t="t",a[l].v=Gi(t,r);break}var L="",R,U;if(_.length>0){_.charCodeAt(0)==40?(R=t<0&&_.charCodeAt(0)===45?-t:t,U=$A("n",_,R)):(R=t<0&&n>1?-t:t,U=$A("n",_,R),R<0&&a[0]&&a[0].t=="t"&&(U=U.substr(1),a[0].v="-"+a[0].v)),Q=U.length-1;var K=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){K=l;break}var D=a.length;if(K===a.length&&U.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(Q>=a[l].v.length-1?(Q-=a[l].v.length,a[l].v=U.substr(Q+1,a[l].v.length)):Q<0?a[l].v="":(a[l].v=U.substr(0,Q+1),Q=-1),a[l].t="t",D=l);Q>=0&&D<a.length&&(a[D].v=U.substr(0,Q+1)+a[D].v)}else if(K!==a.length&&U.indexOf("E")===-1){for(Q=U.indexOf(".")-1,l=K;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(d=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")-1:a[l].v.length-1,L=a[l].v.substr(d+1);d>=0;--d)Q>=0&&(a[l].v.charAt(d)==="0"||a[l].v.charAt(d)==="#")&&(L=U.charAt(Q--)+L);a[l].v=L,a[l].t="t",D=l}for(Q>=0&&D<a.length&&(a[D].v=U.substr(0,Q+1)+a[D].v),Q=U.indexOf(".")+1,l=K;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==K)){for(d=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")+1:0,L=a[l].v.substr(0,d);d<a[l].v.length;++d)Q<U.length&&(L+=U.charAt(Q++));a[l].v=L,a[l].t="t",D=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(R=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=$A(a[l].t,a[l].v,R),a[l].t="t");var ee="";for(l=0;l!==a.length;++l)a[l]!=null&&(ee+=a[l].v);return ee}var jE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function R7(e,t){var r=I7(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(jE),o=r[1].match(jE);return zE(t,l)?[n,r[0]]:zE(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function Ya(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[e],n==null&&(n=r.table&&r.table[GE[e]]||xt[GE[e]]),n==null&&(n=p7[e]||"General");break}if(sd(n,0))return Gi(t,r);t instanceof Date&&(t=F_(t,r.date1904));var a=R7(n,t);if(sd(a[1]))return Gi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Q7(a[1],t,r,a[0])}function ZA(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xt[r]==null){t<0&&(t=r);continue}if(xt[r]==e){t=r;break}}t<0&&(t=391)}return xt[t]=e,t}function Ld(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ZA(e[t],t)}function yo(){xt=m7()}var D7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},L_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function M7(e){var t=typeof e=="number"?xt[e]:e;return t=t.replace(L_,"(\\d+)"),new RegExp("^"+t+"$")}function L7(e,t,r){var n=-1,a=-1,s=-1,l=-1,o=-1,u=-1;(t.match(L_)||[]).forEach(function(m,x){var y=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":l=y;break;case"s":u=y;break;case"m":l>=0?o=y:a=y;break}}),u>=0&&o==-1&&a>=0&&(o=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return l==-1&&o==-1&&u==-1?f:n==-1&&a==-1&&s==-1?d:f+"T"+d}var H7=(function(){var e={};e.version="1.2.0";function t(){for(var U=0,K=new Array(256),D=0;D!=256;++D)U=D,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,K[D]=U;return typeof Int32Array<"u"?new Int32Array(K):K}var r=t();function n(U){var K=0,D=0,ee=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)re[ee]=U[ee];for(ee=0;ee!=256;++ee)for(D=U[ee],K=256+ee;K<4096;K+=256)D=re[K]=D>>>8^U[D&255];var Z=[];for(ee=1;ee!=16;++ee)Z[ee-1]=typeof Int32Array<"u"?re.subarray(ee*256,ee*256+256):re.slice(ee*256,ee*256+256);return Z}var a=n(r),s=a[0],l=a[1],o=a[2],u=a[3],f=a[4],d=a[5],m=a[6],x=a[7],y=a[8],E=a[9],C=a[10],S=a[11],T=a[12],F=a[13],_=a[14];function Q(U,K){for(var D=K^-1,ee=0,re=U.length;ee<re;)D=D>>>8^r[(D^U.charCodeAt(ee++))&255];return~D}function L(U,K){for(var D=K^-1,ee=U.length-15,re=0;re<ee;)D=_[U[re++]^D&255]^F[U[re++]^D>>8&255]^T[U[re++]^D>>16&255]^S[U[re++]^D>>>24]^C[U[re++]]^E[U[re++]]^y[U[re++]]^x[U[re++]]^m[U[re++]]^d[U[re++]]^f[U[re++]]^u[U[re++]]^o[U[re++]]^l[U[re++]]^s[U[re++]]^r[U[re++]];for(ee+=15;re<ee;)D=D>>>8^r[(D^U[re++])&255];return~D}function R(U,K){for(var D=K^-1,ee=0,re=U.length,Z=0,ae=0;ee<re;)Z=U.charCodeAt(ee++),Z<128?D=D>>>8^r[(D^Z)&255]:Z<2048?(D=D>>>8^r[(D^(192|Z>>6&31))&255],D=D>>>8^r[(D^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,ae=U.charCodeAt(ee++)&1023,D=D>>>8^r[(D^(240|Z>>8&7))&255],D=D>>>8^r[(D^(128|Z>>2&63))&255],D=D>>>8^r[(D^(128|ae>>6&15|(Z&3)<<4))&255],D=D>>>8^r[(D^(128|ae&63))&255]):(D=D>>>8^r[(D^(224|Z>>12&15))&255],D=D>>>8^r[(D^(128|Z>>6&63))&255],D=D>>>8^r[(D^(128|Z&63))&255]);return~D}return e.table=r,e.bstr=Q,e.buf=L,e.str=R,e})(),ut=(function(){var t={};t.version="1.2.1";function r(I,j){for(var H=I.split("/"),O=j.split("/"),G=0,W=0,me=Math.min(H.length,O.length);G<me;++G){if(W=H[G].length-O[G].length)return W;if(H[G]!=O[G])return H[G]<O[G]?-1:1}return H.length-O.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var j=I.lastIndexOf("/");return j===-1?I:I.slice(0,j+1)}function a(I){if(I.charAt(I.length-1)=="/")return a(I.slice(0,-1));var j=I.lastIndexOf("/");return j===-1?I:I.slice(j+1)}function s(I,j){typeof j=="string"&&(j=new Date(j));var H=j.getHours();H=H<<6|j.getMinutes(),H=H<<5|j.getSeconds()>>>1,I.write_shift(2,H);var O=j.getFullYear()-1980;O=O<<4|j.getMonth()+1,O=O<<5|j.getDate(),I.write_shift(2,O)}function l(I){var j=I.read_shift(2)&65535,H=I.read_shift(2)&65535,O=new Date,G=H&31;H>>>=5;var W=H&15;H>>>=4,O.setMilliseconds(0),O.setFullYear(H+1980),O.setMonth(W-1),O.setDate(G);var me=j&31;j>>>=5;var be=j&63;return j>>>=6,O.setHours(j),O.setMinutes(be),O.setSeconds(me<<1),O}function o(I){bn(I,0);for(var j={},H=0;I.l<=I.length-4;){var O=I.read_shift(2),G=I.read_shift(2),W=I.l+G,me={};switch(O){case 21589:H=I.read_shift(1),H&1&&(me.mtime=I.read_shift(4)),G>5&&(H&2&&(me.atime=I.read_shift(4)),H&4&&(me.ctime=I.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}I.l=W,j[O]=me}return j}var u;function f(){return u||(u={})}function d(I,j){if(I[0]==80&&I[1]==75)return gt(I,j);if((I[0]|32)==109&&(I[1]|32)==105)return fA(I,j);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var H=3,O=512,G=0,W=0,me=0,be=0,pe=0,xe=[],ve=I.slice(0,512);bn(ve,0);var Le=m(ve);switch(H=Le[0],H){case 3:O=512;break;case 4:O=4096;break;case 0:if(Le[1]==0)return gt(I,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}O!==512&&(ve=I.slice(0,O),bn(ve,28));var Ge=I.slice(0,O);x(ve,H);var We=ve.read_shift(4,"i");if(H===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);ve.l+=4,me=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),be=ve.read_shift(4,"i"),G=ve.read_shift(4,"i"),pe=ve.read_shift(4,"i"),W=ve.read_shift(4,"i");for(var Oe=-1,Je=0;Je<109&&(Oe=ve.read_shift(4,"i"),!(Oe<0));++Je)xe[Je]=Oe;var at=y(I,O);S(pe,W,at,O,xe);var hr=F(at,me,xe,O);hr[me].name="!Directory",G>0&&be!==ae&&(hr[be].name="!MiniFAT"),hr[xe[0]].name="!FAT",hr.fat_addrs=xe,hr.ssz=O;var Dt={},gr=[],kn=[],$a=[];_(me,hr,at,gr,G,Dt,kn,be),E(kn,$a,gr),gr.shift();var Ta={FileIndex:kn,FullPaths:$a};return j&&j.raw&&(Ta.raw={header:Ge,sectors:at}),Ta}function m(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Te,"Header Signature: "),I.l+=16;var j=I.read_shift(2,"u");return[I.read_shift(2,"u"),j]}function x(I,j){var H=9;switch(I.l+=2,H=I.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function y(I,j){for(var H=Math.ceil(I.length/j)-1,O=[],G=1;G<H;++G)O[G-1]=I.slice(G*j,(G+1)*j);return O[H-1]=I.slice(H*j),O}function E(I,j,H){for(var O=0,G=0,W=0,me=0,be=0,pe=H.length,xe=[],ve=[];O<pe;++O)xe[O]=ve[O]=O,j[O]=H[O];for(;be<ve.length;++be)O=ve[be],G=I[O].L,W=I[O].R,me=I[O].C,xe[O]===O&&(G!==-1&&xe[G]!==G&&(xe[O]=xe[G]),W!==-1&&xe[W]!==W&&(xe[O]=xe[W])),me!==-1&&(xe[me]=O),G!==-1&&O!=xe[O]&&(xe[G]=xe[O],ve.lastIndexOf(G)<be&&ve.push(G)),W!==-1&&O!=xe[O]&&(xe[W]=xe[O],ve.lastIndexOf(W)<be&&ve.push(W));for(O=1;O<pe;++O)xe[O]===O&&(W!==-1&&xe[W]!==W?xe[O]=xe[W]:G!==-1&&xe[G]!==G&&(xe[O]=xe[G]));for(O=1;O<pe;++O)if(I[O].type!==0){if(be=O,be!=xe[be])do be=xe[be],j[O]=j[be]+"/"+j[O];while(be!==0&&xe[be]!==-1&&be!=xe[be]);xe[O]=-1}for(j[0]+="/",O=1;O<pe;++O)I[O].type!==2&&(j[O]+="/")}function C(I,j,H){for(var O=I.start,G=I.size,W=[],me=O;H&&G>0&&me>=0;)W.push(j.slice(me*Z,me*Z+Z)),G-=Z,me=Ii(H,me*4);return W.length===0?_e(0):xn(W).slice(0,I.size)}function S(I,j,H,O,G){var W=ae;if(I===ae){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var me=H[I],be=(O>>>2)-1;if(!me)return;for(var pe=0;pe<be&&(W=Ii(me,pe*4))!==ae;++pe)G.push(W);S(Ii(me,O-4),j-1,H,O,G)}}function T(I,j,H,O,G){var W=[],me=[];G||(G=[]);var be=O-1,pe=0,xe=0;for(pe=j;pe>=0;){G[pe]=!0,W[W.length]=pe,me.push(I[pe]);var ve=H[Math.floor(pe*4/O)];if(xe=pe*4&be,O<4+xe)throw new Error("FAT boundary crossed: "+pe+" 4 "+O);if(!I[ve])break;pe=Ii(I[ve],xe)}return{nodes:W,data:a2([me])}}function F(I,j,H,O){var G=I.length,W=[],me=[],be=[],pe=[],xe=O-1,ve=0,Le=0,Ge=0,We=0;for(ve=0;ve<G;++ve)if(be=[],Ge=ve+j,Ge>=G&&(Ge-=G),!me[Ge]){pe=[];var Oe=[];for(Le=Ge;Le>=0;){Oe[Le]=!0,me[Le]=!0,be[be.length]=Le,pe.push(I[Le]);var Je=H[Math.floor(Le*4/O)];if(We=Le*4&xe,O<4+We)throw new Error("FAT boundary crossed: "+Le+" 4 "+O);if(!I[Je]||(Le=Ii(I[Je],We),Oe[Le]))break}W[Ge]={nodes:be,data:a2([pe])}}return W}function _(I,j,H,O,G,W,me,be){for(var pe=0,xe=O.length?2:0,ve=j[I].data,Le=0,Ge=0,We;Le<ve.length;Le+=128){var Oe=ve.slice(Le,Le+128);bn(Oe,64),Ge=Oe.read_shift(2),We=Nx(Oe,0,Ge-xe),O.push(We);var Je={name:We,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},at=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);at!==0&&(Je.ct=Q(Oe,Oe.l-8));var hr=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);hr!==0&&(Je.mt=Q(Oe,Oe.l-8)),Je.start=Oe.read_shift(4,"i"),Je.size=Oe.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=ae,Je.name=""),Je.type===5?(pe=Je.start,G>0&&pe!==ae&&(j[pe].name="!StreamData")):Je.size>=4096?(Je.storage="fat",j[Je.start]===void 0&&(j[Je.start]=T(H,Je.start,j.fat_addrs,j.ssz)),j[Je.start].name=Je.name,Je.content=j[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:pe!==ae&&Je.start!==ae&&j[pe]&&(Je.content=C(Je,j[pe].data,(j[be]||{}).data))),Je.content&&bn(Je.content,0),W[We]=Je,me.push(Je)}}function Q(I,j){return new Date((xa(I,j+4)/1e7*Math.pow(2,32)+xa(I,j)/1e7-11644473600)*1e3)}function L(I,j){return f(),d(u.readFileSync(I),j)}function R(I,j){var H=j&&j.type;switch(H||Mt&&Buffer.isBuffer(I)&&(H="buffer"),H||"base64"){case"file":return L(I,j);case"base64":return d(va(Ba(I)),j);case"binary":return d(va(I),j)}return d(I,j)}function U(I,j){var H=j||{},O=H.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=O+"/",I.FileIndex[0]={name:O,type:5}),H.CLSID&&(I.FileIndex[0].clsid=H.CLSID),K(I)}function K(I){var j="Sh33tJ5";if(!ut.find(I,"/"+j)){var H=_e(4);H[0]=55,H[1]=H[3]=50,H[2]=54,I.FileIndex.push({name:j,type:2,content:H,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+j),D(I)}}function D(I,j){U(I);for(var H=!1,O=!1,G=I.FullPaths.length-1;G>=0;--G){var W=I.FileIndex[G];switch(W.type){case 0:O?H=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(W.R*W.L*W.C)&&(H=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!j)){var me=new Date(1987,1,19),be=0,pe=Object.create?Object.create(null):{},xe=[];for(G=0;G<I.FullPaths.length;++G)pe[I.FullPaths[G]]=!0,I.FileIndex[G].type!==0&&xe.push([I.FullPaths[G],I.FileIndex[G]]);for(G=0;G<xe.length;++G){var ve=n(xe[G][0]);O=pe[ve],O||(xe.push([ve,{name:a(ve).replace("/",""),type:1,clsid:q,ct:me,mt:me,content:null}]),pe[ve]=!0)}for(xe.sort(function(We,Oe){return r(We[0],Oe[0])}),I.FullPaths=[],I.FileIndex=[],G=0;G<xe.length;++G)I.FullPaths[G]=xe[G][0],I.FileIndex[G]=xe[G][1];for(G=0;G<xe.length;++G){var Le=I.FileIndex[G],Ge=I.FullPaths[G];if(Le.name=a(Ge).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||q,G===0)Le.C=xe.length>1?1:-1,Le.size=0,Le.type=5;else if(Ge.slice(-1)=="/"){for(be=G+1;be<xe.length&&n(I.FullPaths[be])!=Ge;++be);for(Le.C=be>=xe.length?-1:be,be=G+1;be<xe.length&&n(I.FullPaths[be])!=n(Ge);++be);Le.R=be>=xe.length?-1:be,Le.type=1}else n(I.FullPaths[G+1]||"")==n(Ge)&&(Le.R=G+1),Le.type=2}}}function ee(I,j){var H=j||{};if(H.fileType=="mad")return Eo(I,H);switch(D(I),H.fileType){case"zip":return Br(I,H)}var O=(function(We){for(var Oe=0,Je=0,at=0;at<We.FileIndex.length;++at){var hr=We.FileIndex[at];if(hr.content){var Dt=hr.content.length;Dt>0&&(Dt<4096?Oe+=Dt+63>>6:Je+=Dt+511>>9)}}for(var gr=We.FullPaths.length+3>>2,kn=Oe+7>>3,$a=Oe+127>>7,Ta=kn+Je+gr+$a,jn=Ta+127>>7,fs=jn<=109?0:Math.ceil((jn-109)/127);Ta+jn+fs+127>>7>jn;)fs=++jn<=109?0:Math.ceil((jn-109)/127);var yn=[1,fs,jn,$a,gr,Je,Oe,0];return We.FileIndex[0].size=Oe<<6,yn[7]=(We.FileIndex[0].start=yn[0]+yn[1]+yn[2]+yn[3]+yn[4]+yn[5])+(yn[6]+7>>3),yn})(I),G=_e(O[7]<<9),W=0,me=0;{for(W=0;W<8;++W)G.write_shift(1,Se[W]);for(W=0;W<8;++W)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),W=0;W<3;++W)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,O[2]),G.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:ae),G.write_shift(4,O[3]),G.write_shift(-4,O[1]?O[0]-1:ae),G.write_shift(4,O[1]),W=0;W<109;++W)G.write_shift(-4,W<O[2]?O[1]+W:-1)}if(O[1])for(me=0;me<O[1];++me){for(;W<236+me*127;++W)G.write_shift(-4,W<O[2]?O[1]+W:-1);G.write_shift(-4,me===O[1]-1?ae:me+1)}var be=function(We){for(me+=We;W<me-1;++W)G.write_shift(-4,W+1);We&&(++W,G.write_shift(-4,ae))};for(me=W=0,me+=O[1];W<me;++W)G.write_shift(-4,Ae.DIFSECT);for(me+=O[2];W<me;++W)G.write_shift(-4,Ae.FATSECT);be(O[3]),be(O[4]);for(var pe=0,xe=0,ve=I.FileIndex[0];pe<I.FileIndex.length;++pe)ve=I.FileIndex[pe],ve.content&&(xe=ve.content.length,!(xe<4096)&&(ve.start=me,be(xe+511>>9)));for(be(O[6]+7>>3);G.l&511;)G.write_shift(-4,Ae.ENDOFCHAIN);for(me=W=0,pe=0;pe<I.FileIndex.length;++pe)ve=I.FileIndex[pe],ve.content&&(xe=ve.content.length,!(!xe||xe>=4096)&&(ve.start=me,be(xe+63>>6)));for(;G.l&511;)G.write_shift(-4,Ae.ENDOFCHAIN);for(W=0;W<O[4]<<2;++W){var Le=I.FullPaths[W];if(!Le||Le.length===0){for(pe=0;pe<17;++pe)G.write_shift(4,0);for(pe=0;pe<3;++pe)G.write_shift(4,-1);for(pe=0;pe<12;++pe)G.write_shift(4,0);continue}ve=I.FileIndex[W],W===0&&(ve.start=ve.size?ve.start-1:ae);var Ge=W===0&&H.root||ve.name;if(xe=2*(Ge.length+1),G.write_shift(64,Ge,"utf16le"),G.write_shift(2,xe),G.write_shift(1,ve.type),G.write_shift(1,ve.color),G.write_shift(-4,ve.L),G.write_shift(-4,ve.R),G.write_shift(-4,ve.C),ve.clsid)G.write_shift(16,ve.clsid,"hex");else for(pe=0;pe<4;++pe)G.write_shift(4,0);G.write_shift(4,ve.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ve.start),G.write_shift(4,ve.size),G.write_shift(4,0)}for(W=1;W<I.FileIndex.length;++W)if(ve=I.FileIndex[W],ve.size>=4096)if(G.l=ve.start+1<<9,Mt&&Buffer.isBuffer(ve.content))ve.content.copy(G,G.l,0,ve.size),G.l+=ve.size+511&-512;else{for(pe=0;pe<ve.size;++pe)G.write_shift(1,ve.content[pe]);for(;pe&511;++pe)G.write_shift(1,0)}for(W=1;W<I.FileIndex.length;++W)if(ve=I.FileIndex[W],ve.size>0&&ve.size<4096)if(Mt&&Buffer.isBuffer(ve.content))ve.content.copy(G,G.l,0,ve.size),G.l+=ve.size+63&-64;else{for(pe=0;pe<ve.size;++pe)G.write_shift(1,ve.content[pe]);for(;pe&63;++pe)G.write_shift(1,0)}if(Mt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function re(I,j){var H=I.FullPaths.map(function(pe){return pe.toUpperCase()}),O=H.map(function(pe){var xe=pe.split("/");return xe[xe.length-(pe.slice(-1)=="/"?2:1)]}),G=!1;j.charCodeAt(0)===47?(G=!0,j=H[0].slice(0,-1)+j):G=j.indexOf("/")!==-1;var W=j.toUpperCase(),me=G===!0?H.indexOf(W):O.indexOf(W);if(me!==-1)return I.FileIndex[me];var be=!W.match(Ic);for(W=W.replace(qn,""),be&&(W=W.replace(Ic,"!")),me=0;me<H.length;++me)if((be?H[me].replace(Ic,"!"):H[me]).replace(qn,"")==W||(be?O[me].replace(Ic,"!"):O[me]).replace(qn,"")==W)return I.FileIndex[me];return null}var Z=64,ae=-2,Te="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(I,j,H){f();var O=ee(I,H);u.writeFileSync(j,O)}function ie(I){for(var j=new Array(I.length),H=0;H<I.length;++H)j[H]=String.fromCharCode(I[H]);return j.join("")}function Me(I,j){var H=ee(I,j);switch(j&&j.type||"buffer"){case"file":return f(),u.writeFileSync(j.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return au(typeof H=="string"?H:ie(H));case"buffer":if(Mt)return Buffer.isBuffer(H)?H:ls(H);case"array":return typeof H=="string"?va(H):H}return H}var J;function k(I){try{var j=I.InflateRaw,H=new j;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)J=I;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function V(I,j){if(!J)return Sa(I,j);var H=J.InflateRaw,O=new H,G=O._processChunk(I.slice(I.l),O._finishFlushFlag);return I.l+=O.bytesRead,G}function P(I){return J?J.deflateRawSync(I):$e(I)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(I){var j=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(j>>16|j>>8|j)&255}for(var ce=typeof Uint8Array<"u",ne=ce?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)ne[Ce]=de(Ce);function N(I,j){var H=ne[I&255];return j<=8?H>>>8-j:(H=H<<8|ne[I>>8&255],j<=16?H>>>16-j:(H=H<<8|ne[I>>16&255],H>>>24-j))}function Ie(I,j){var H=j&7,O=j>>>3;return(I[O]|(H<=6?0:I[O+1]<<8))>>>H&3}function Pe(I,j){var H=j&7,O=j>>>3;return(I[O]|(H<=5?0:I[O+1]<<8))>>>H&7}function Ye(I,j){var H=j&7,O=j>>>3;return(I[O]|(H<=4?0:I[O+1]<<8))>>>H&15}function et(I,j){var H=j&7,O=j>>>3;return(I[O]|(H<=3?0:I[O+1]<<8))>>>H&31}function He(I,j){var H=j&7,O=j>>>3;return(I[O]|(H<=1?0:I[O+1]<<8))>>>H&127}function ft(I,j,H){var O=j&7,G=j>>>3,W=(1<<H)-1,me=I[G]>>>O;return H<8-O||(me|=I[G+1]<<8-O,H<16-O)||(me|=I[G+2]<<16-O,H<24-O)||(me|=I[G+3]<<24-O),me&W}function Et(I,j,H){var O=j&7,G=j>>>3;return O<=5?I[G]|=(H&7)<<O:(I[G]|=H<<O&255,I[G+1]=(H&7)>>8-O),j+3}function lr(I,j,H){var O=j&7,G=j>>>3;return H=(H&1)<<O,I[G]|=H,j+1}function Jt(I,j,H){var O=j&7,G=j>>>3;return H<<=O,I[G]|=H&255,H>>>=8,I[G+1]=H,j+8}function Er(I,j,H){var O=j&7,G=j>>>3;return H<<=O,I[G]|=H&255,H>>>=8,I[G+1]=H&255,I[G+2]=H>>>8,j+16}function Zr(I,j){var H=I.length,O=2*H>j?2*H:j+5,G=0;if(H>=j)return I;if(Mt){var W=HE(O);if(I.copy)I.copy(W);else for(;G<I.length;++G)W[G]=I[G];return W}else if(ce){var me=new Uint8Array(O);if(me.set)me.set(I);else for(;G<H;++G)me[G]=I[G];return me}return I.length=O,I}function dt(I){for(var j=new Array(I),H=0;H<I;++H)j[H]=0;return j}function oe(I,j,H){var O=1,G=0,W=0,me=0,be=0,pe=I.length,xe=ce?new Uint16Array(32):dt(32);for(W=0;W<32;++W)xe[W]=0;for(W=pe;W<H;++W)I[W]=0;pe=I.length;var ve=ce?new Uint16Array(pe):dt(pe);for(W=0;W<pe;++W)xe[G=I[W]]++,O<G&&(O=G),ve[W]=0;for(xe[0]=0,W=1;W<=O;++W)xe[W+16]=be=be+xe[W-1]<<1;for(W=0;W<pe;++W)be=I[W],be!=0&&(ve[W]=xe[be+16]++);var Le=0;for(W=0;W<pe;++W)if(Le=I[W],Le!=0)for(be=N(ve[W],O)>>O-Le,me=(1<<O+4-Le)-1;me>=0;--me)j[be|me<<Le]=Le&15|W<<4;return O}var je=ce?new Uint16Array(512):dt(512),bt=ce?new Uint16Array(32):dt(32);if(!ce){for(var ht=0;ht<512;++ht)je[ht]=0;for(ht=0;ht<32;++ht)bt[ht]=0}(function(){for(var I=[],j=0;j<32;j++)I.push(5);oe(I,bt,32);var H=[];for(j=0;j<=143;j++)H.push(8);for(;j<=255;j++)H.push(9);for(;j<=279;j++)H.push(7);for(;j<=287;j++)H.push(8);oe(H,je,288)})();var Tt=(function(){for(var j=ce?new Uint8Array(32768):[],H=0,O=0;H<Be.length-1;++H)for(;O<Be[H+1];++O)j[O]=H;for(;O<32768;++O)j[O]=29;var G=ce?new Uint8Array(259):[];for(H=0,O=0;H<le.length-1;++H)for(;O<le[H+1];++O)G[O]=H;function W(be,pe){for(var xe=0;xe<be.length;){var ve=Math.min(65535,be.length-xe),Le=xe+ve==be.length;for(pe.write_shift(1,+Le),pe.write_shift(2,ve),pe.write_shift(2,~ve&65535);ve-- >0;)pe[pe.l++]=be[xe++]}return pe.l}function me(be,pe){for(var xe=0,ve=0,Le=ce?new Uint16Array(32768):[];ve<be.length;){var Ge=Math.min(65535,be.length-ve);if(Ge<10){for(xe=Et(pe,xe,+(ve+Ge==be.length)),xe&7&&(xe+=8-(xe&7)),pe.l=xe/8|0,pe.write_shift(2,Ge),pe.write_shift(2,~Ge&65535);Ge-- >0;)pe[pe.l++]=be[ve++];xe=pe.l*8;continue}xe=Et(pe,xe,+(ve+Ge==be.length)+2);for(var We=0;Ge-- >0;){var Oe=be[ve];We=(We<<5^Oe)&32767;var Je=-1,at=0;if((Je=Le[We])&&(Je|=ve&-32768,Je>ve&&(Je-=32768),Je<ve))for(;be[Je+at]==be[ve+at]&&at<250;)++at;if(at>2){Oe=G[at],Oe<=22?xe=Jt(pe,xe,ne[Oe+1]>>1)-1:(Jt(pe,xe,3),xe+=5,Jt(pe,xe,ne[Oe-23]>>5),xe+=3);var hr=Oe<8?0:Oe-4>>2;hr>0&&(Er(pe,xe,at-le[Oe]),xe+=hr),Oe=j[ve-Je],xe=Jt(pe,xe,ne[Oe]>>3),xe-=3;var Dt=Oe<4?0:Oe-2>>1;Dt>0&&(Er(pe,xe,ve-Je-Be[Oe]),xe+=Dt);for(var gr=0;gr<at;++gr)Le[We]=ve&32767,We=(We<<5^be[ve])&32767,++ve;Ge-=at-1}else Oe<=143?Oe=Oe+48:xe=lr(pe,xe,1),xe=Jt(pe,xe,ne[Oe]),Le[We]=ve&32767,++ve}xe=Jt(pe,xe,0)-1}return pe.l=(xe+7)/8|0,pe.l}return function(pe,xe){return pe.length<8?W(pe,xe):me(pe,xe)}})();function $e(I){var j=_e(50+Math.floor(I.length*1.1)),H=Tt(I,j);return j.slice(0,H)}var vt=ce?new Uint16Array(32768):dt(32768),Nt=ce?new Uint16Array(32768):dt(32768),Bt=ce?new Uint16Array(128):dt(128),qt=1,jr=1;function Sr(I,j){var H=et(I,j)+257;j+=5;var O=et(I,j)+1;j+=5;var G=Ye(I,j)+4;j+=4;for(var W=0,me=ce?new Uint8Array(19):dt(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,xe=ce?new Uint8Array(8):dt(8),ve=ce?new Uint8Array(8):dt(8),Le=me.length,Ge=0;Ge<G;++Ge)me[z[Ge]]=W=Pe(I,j),pe<W&&(pe=W),xe[W]++,j+=3;var We=0;for(xe[0]=0,Ge=1;Ge<=pe;++Ge)ve[Ge]=We=We+xe[Ge-1]<<1;for(Ge=0;Ge<Le;++Ge)(We=me[Ge])!=0&&(be[Ge]=ve[We]++);var Oe=0;for(Ge=0;Ge<Le;++Ge)if(Oe=me[Ge],Oe!=0){We=ne[be[Ge]]>>8-Oe;for(var Je=(1<<7-Oe)-1;Je>=0;--Je)Bt[We|Je<<Oe]=Oe&7|Ge<<3}var at=[];for(pe=1;at.length<H+O;)switch(We=Bt[He(I,j)],j+=We&7,We>>>=3){case 16:for(W=3+Ie(I,j),j+=2,We=at[at.length-1];W-- >0;)at.push(We);break;case 17:for(W=3+Pe(I,j),j+=3;W-- >0;)at.push(0);break;case 18:for(W=11+He(I,j),j+=7;W-- >0;)at.push(0);break;default:at.push(We),pe<We&&(pe=We);break}var hr=at.slice(0,H),Dt=at.slice(H);for(Ge=H;Ge<286;++Ge)hr[Ge]=0;for(Ge=O;Ge<30;++Ge)Dt[Ge]=0;return qt=oe(hr,vt,286),jr=oe(Dt,Nt,30),j}function Ea(I,j){if(I[0]==3&&!(I[1]&3))return[Ys(j),2];for(var H=0,O=0,G=HE(j||1<<18),W=0,me=G.length>>>0,be=0,pe=0;(O&1)==0;){if(O=Pe(I,H),H+=3,O>>>1)O>>1==1?(be=9,pe=5):(H=Sr(I,H),be=qt,pe=jr);else{H&7&&(H+=8-(H&7));var xe=I[H>>>3]|I[(H>>>3)+1]<<8;if(H+=32,xe>0)for(!j&&me<W+xe&&(G=Zr(G,W+xe),me=G.length);xe-- >0;)G[W++]=I[H>>>3],H+=8;continue}for(;;){!j&&me<W+32767&&(G=Zr(G,W+32767),me=G.length);var ve=ft(I,H,be),Le=O>>>1==1?je[ve]:vt[ve];if(H+=Le&15,Le>>>=4,(Le>>>8&255)===0)G[W++]=Le;else{if(Le==256)break;Le-=257;var Ge=Le<8?0:Le-4>>2;Ge>5&&(Ge=0);var We=W+le[Le];Ge>0&&(We+=ft(I,H,Ge),H+=Ge),ve=ft(I,H,pe),Le=O>>>1==1?bt[ve]:Nt[ve],H+=Le&15,Le>>>=4;var Oe=Le<4?0:Le-2>>1,Je=Be[Le];for(Oe>0&&(Je+=ft(I,H,Oe),H+=Oe),!j&&me<We&&(G=Zr(G,We+100),me=G.length);W<We;)G[W]=G[W-Je],++W}}}return j?[G,H+7>>>3]:[G.slice(0,W),H+7>>>3]}function Sa(I,j){var H=I.slice(I.l||0),O=Ea(H,j);return I.l+=O[1],O[0]}function br(I,j){if(I)typeof console<"u"&&console.error(j);else throw new Error(j)}function gt(I,j){var H=I;bn(H,0);var O=[],G=[],W={FileIndex:O,FullPaths:G};U(W,{root:j.root});for(var me=H.length-4;(H[me]!=80||H[me+1]!=75||H[me+2]!=5||H[me+3]!=6)&&me>=0;)--me;H.l=me+4,H.l+=4;var be=H.read_shift(2);H.l+=6;var pe=H.read_shift(4);for(H.l=pe,me=0;me<be;++me){H.l+=20;var xe=H.read_shift(4),ve=H.read_shift(4),Le=H.read_shift(2),Ge=H.read_shift(2),We=H.read_shift(2);H.l+=8;var Oe=H.read_shift(4),Je=o(H.slice(H.l+Le,H.l+Le+Ge));H.l+=Le+Ge+We;var at=H.l;H.l=Oe+4,Mr(H,xe,ve,W,Je),H.l=at}return W}function Mr(I,j,H,O,G){I.l+=2;var W=I.read_shift(2),me=I.read_shift(2),be=l(I);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var pe=I.read_shift(4),xe=I.read_shift(4),ve=I.read_shift(4),Le=I.read_shift(2),Ge=I.read_shift(2),We="",Oe=0;Oe<Le;++Oe)We+=String.fromCharCode(I[I.l++]);if(Ge){var Je=o(I.slice(I.l,I.l+Ge));(Je[21589]||{}).mt&&(be=Je[21589].mt),((G||{})[21589]||{}).mt&&(be=G[21589].mt)}I.l+=Ge;var at=I.slice(I.l,I.l+xe);switch(me){case 8:at=V(I,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var hr=!1;W&8&&(pe=I.read_shift(4),pe==134695760&&(pe=I.read_shift(4),hr=!0),xe=I.read_shift(4),ve=I.read_shift(4)),xe!=j&&br(hr,"Bad compressed size: "+j+" != "+xe),ve!=H&&br(hr,"Bad uncompressed size: "+H+" != "+ve),us(O,We,at,{unsafe:!0,mt:be})}function Br(I,j){var H=j||{},O=[],G=[],W=_e(1),me=H.compression?8:0,be=0,pe=0,xe=0,ve=0,Le=0,Ge=I.FullPaths[0],We=Ge,Oe=I.FileIndex[0],Je=[],at=0;for(pe=1;pe<I.FullPaths.length;++pe)if(We=I.FullPaths[pe].slice(Ge.length),Oe=I.FileIndex[pe],!(!Oe.size||!Oe.content||We=="Sh33tJ5")){var hr=ve,Dt=_e(We.length);for(xe=0;xe<We.length;++xe)Dt.write_shift(1,We.charCodeAt(xe)&127);Dt=Dt.slice(0,Dt.l),Je[Le]=H7.buf(Oe.content,0);var gr=Oe.content;me==8&&(gr=P(gr)),W=_e(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,be),W.write_shift(2,me),Oe.mt?s(W,Oe.mt):W.write_shift(4,0),W.write_shift(-4,Je[Le]),W.write_shift(4,gr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,Dt.length),W.write_shift(2,0),ve+=W.length,O.push(W),ve+=Dt.length,O.push(Dt),ve+=gr.length,O.push(gr),W=_e(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,be),W.write_shift(2,me),W.write_shift(4,0),W.write_shift(-4,Je[Le]),W.write_shift(4,gr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,Dt.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,hr),at+=W.l,G.push(W),at+=Dt.length,G.push(Dt),++Le}return W=_e(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Le),W.write_shift(2,Le),W.write_shift(4,at),W.write_shift(4,ve),W.write_shift(2,0),xn([xn(O),xn(G),W])}var Ar={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bA(I,j){if(I.ctype)return I.ctype;var H=I.name||"",O=H.match(/\.([^\.]+)$/);return O&&Ar[O[1]]||j&&(O=(H=j).match(/[\.\\]([^\.\\])+$/),O&&Ar[O[1]])?Ar[O[1]]:"application/octet-stream"}function FA(I){for(var j=au(I),H=[],O=0;O<j.length;O+=76)H.push(j.slice(O,O+76));return H.join(`\r
`)+`\r
`}function rl(I){var j=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ve=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],O=j.split(`\r
`),G=0;G<O.length;++G){var W=O[G];if(W.length==0){H.push("");continue}for(var me=0;me<W.length;){var be=76,pe=W.slice(me,me+be);pe.charAt(be-1)=="="?be--:pe.charAt(be-2)=="="?be-=2:pe.charAt(be-3)=="="&&(be-=3),pe=W.slice(me,me+be),me+=be,me<W.length&&(pe+="="),H.push(pe)}}return H.join(`\r
`)}function nl(I){for(var j=[],H=0;H<I.length;++H){for(var O=I[H];H<=I.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+I[++H];j.push(O)}for(var G=0;G<j.length;++G)j[G]=j[G].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return va(j.join(`\r
`))}function si(I,j,H){for(var O="",G="",W="",me,be=0;be<10;++be){var pe=j[be];if(!pe||pe.match(/^\s*$/))break;var xe=pe.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":O=xe[2].trim();break;case"content-type":W=xe[2].trim();break;case"content-transfer-encoding":G=xe[2].trim();break}}switch(++be,G.toLowerCase()){case"base64":me=va(Ba(j.slice(be).join("")));break;case"quoted-printable":me=nl(j.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ve=us(I,O.slice(H.length),me,{unsafe:!0});W&&(ve.ctype=W)}function fA(I,j){if(ie(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=j&&j.root||"",O=(Mt&&Buffer.isBuffer(I)?I.toString("binary"):ie(I)).split(`\r
`),G=0,W="";for(G=0;G<O.length;++G)if(W=O[G],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),H||(H=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),W.slice(0,H.length)!=H););var me=(O[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var be="--"+(me[1]||""),pe=[],xe=[],ve={FileIndex:pe,FullPaths:xe};U(ve);var Le,Ge=0;for(G=0;G<O.length;++G){var We=O[G];We!==be&&We!==be+"--"||(Ge++&&si(ve,O.slice(Le,G),H),Le=G)}return ve}function Eo(I,j){var H=j||{},O=H.boundary||"SheetJS";O="------="+O;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],W=I.FullPaths[0],me=W,be=I.FileIndex[0],pe=1;pe<I.FullPaths.length;++pe)if(me=I.FullPaths[pe].slice(W.length),be=I.FileIndex[pe],!(!be.size||!be.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var xe=be.content,ve=Mt&&Buffer.isBuffer(xe)?xe.toString("binary"):ie(xe),Le=0,Ge=Math.min(1024,ve.length),We=0,Oe=0;Oe<=Ge;++Oe)(We=ve.charCodeAt(Oe))>=32&&We<128&&++Le;var Je=Le>=Ge*4/5;G.push(O),G.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+me),G.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),G.push("Content-Type: "+bA(be,me)),G.push(""),G.push(Je?rl(ve):FA(ve))}return G.push(O+`--\r
`),G.join(`\r
`)}function al(I){var j={};return U(j,I),j}function us(I,j,H,O){var G=O&&O.unsafe;G||U(I);var W=!G&&ut.find(I,j);if(!W){var me=I.FullPaths[0];j.slice(0,me.length)==me?me=j:(me.slice(-1)!="/"&&(me+="/"),me=(me+j).replace("//","/")),W={name:a(j),type:2},I.FileIndex.push(W),I.FullPaths.push(me),G||ut.utils.cfb_gc(I)}return W.content=H,W.size=H?H.length:0,O&&(O.CLSID&&(W.clsid=O.CLSID),O.mt&&(W.mt=O.mt),O.ct&&(W.ct=O.ct)),W}function Al(I,j){U(I);var H=ut.find(I,j);if(H){for(var O=0;O<I.FileIndex.length;++O)if(I.FileIndex[O]==H)return I.FileIndex.splice(O,1),I.FullPaths.splice(O,1),!0}return!1}function ii(I,j,H){U(I);var O=ut.find(I,j);if(O){for(var G=0;G<I.FileIndex.length;++G)if(I.FileIndex[G]==O)return I.FileIndex[G].name=a(H),I.FullPaths[G]=H,!0}return!1}function li(I){D(I,!0)}return t.find=re,t.read=R,t.parse=d,t.write=Me,t.writeFile=Re,t.utils={cfb_new:al,cfb_add:us,cfb_del:Al,cfb_mov:ii,cfb_gc:li,ReadShift:Gc,CheckField:sb,prep_blob:bn,bconcat:xn,use_zlib:k,_deflateRaw:$e,_inflateRaw:Sa,consts:Ae},t})();function O7(e){return typeof e=="string"?Md(e):Array.isArray(e)?f7(e):e}function yu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Md(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?BA(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([O7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ni(t)),o.write(t),o.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function P7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Kr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function XE(e,t){for(var r=[],n=Kr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Hd(e){for(var t=[],r=Kr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Od(e){for(var t=[],r=Kr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function G7(e){for(var t=[],r=Kr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ld=new Date(1899,11,30,0,0,0);function hn(e,t){var r=e.getTime(),n=ld.getTime()+(e.getTimezoneOffset()-ld.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var H_=new Date,V7=ld.getTime()+(H_.getTimezoneOffset()-ld.getTimezoneOffset())*6e4,JE=H_.getTimezoneOffset();function Pd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+V7),t.getTimezoneOffset()!==JE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-JE)*6e4),t}function K7(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var WE=new Date("2017-02-19T19:06:09.000Z"),O_=isNaN(WE.getFullYear())?new Date("2/19/17"):WE,j7=O_.getFullYear()==2017;function Nr(e,t){var r=new Date(e);if(j7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(O_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Vi(e,t){if(Mt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return BA(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return BA(__(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return BA(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return BA(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ir(e[r]));return t}function Gr(e,t){for(var r="";r.length<t;)r+=e;return r}function lA(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var z7=["january","february","march","april","may","june","july","august","september","october","november","december"];function co(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&z7.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var X7=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(a),l.push(s[o]);return l}})();function P_(e){return e?e.content&&e.type?Vi(e.content,!0):e.data?Nc(e.data):e.asNodeBuffer&&Mt?Nc(e.asNodeBuffer().toString("binary")):e.asBinary?Nc(e.asBinary()):e._data&&e._data.getContent?Nc(Vi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function G_(e){if(!e)return null;if(e.data)return ME(e.data);if(e.asNodeBuffer&&Mt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?ME(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function J7(e){return e&&e.name.slice(-4)===".bin"?G_(e):P_(e)}function Ga(e,t){for(var r=e.FullPaths||Kr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Tx(e,t){var r=Ga(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function sn(e,t,r){if(!r)return J7(Tx(e,t));if(!t)return null;try{return sn(e,t)}catch{return null}}function wa(e,t,r){if(!r)return P_(Tx(e,t));if(!t)return null;try{return wa(e,t)}catch{return null}}function W7(e,t,r){return G_(Tx(e,t))}function YE(e){for(var t=e.FullPaths||Kr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Rt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Mt?n=ls(r):n=d7(r),ut.utils.cfb_add(e,t,n)}ut.utils.cfb_add(e,t,r)}else e.file(t,r)}function _x(){return ut.utils.cfb_new()}function V_(e,t){switch(t.type){case"base64":return ut.read(e,{type:"base64"});case"binary":return ut.read(e,{type:"binary"});case"buffer":case"array":return ut.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Qc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var $r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Y7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,q7=/<[^>]*>/g,Kn=$r.match(qE)?qE:q7,$7=/<\w*:/,Z7=/<(\/?)\w+:/;function yt(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(Y7),o=0,u="",f=0,d="",m="",x=1;if(l)for(f=0;f!=l.length;++f){for(m=l[f],s=0;s!=m.length&&m.charCodeAt(s)!==61;++s);for(d=m.slice(0,s).trim();m.charCodeAt(s+1)==32;)++s;for(x=(a=m.charCodeAt(s+1))==34||a==39?1:0,u=m.slice(s+1+x,m.length-x),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var y=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[y]&&d.slice(o-3,o)=="ext")continue;n[y]=u,n[y.toLowerCase()]=u}}return n}function TA(e){return e.replace(Z7,"<$1")}var K_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bx=Hd(K_),Wt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,u){return K_[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var l=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,l)+r(a.slice(l+3))}})(),Fx=/[&<>'"]/g,e9=/[\u0000-\u0008\u000b-\u001f]/g;function dr(e){var t=e+"";return t.replace(Fx,function(r){return bx[r]}).replace(e9,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $E(e){return dr(e).replace(/ /g,"_x0020_")}var j_=/[\u0000-\u001f]/g;function Ux(e){var t=e+"";return t.replace(Fx,function(r){return bx[r]}).replace(/\n/g,"<br/>").replace(j_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function t9(e){var t=e+"";return t.replace(Fx,function(r){return bx[r]}).replace(j_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ZE=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function r9(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function kr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Um(e){for(var t="",r=0,n=0,a=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function e2(e){var t=Ys(2*e.length),r,n,a=1,s=0,l=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function t2(e){return ls(e,"binary").toString("utf8")}var mf="foo bar baz",yr=Mt&&(t2(mf)==Um(mf)&&t2||e2(mf)==Um(mf)&&e2)||Um,BA=Mt?function(e){return ls(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},su=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),z_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),n9=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),a9=/<\/?(?:vt:)?variant>/g,A9=/<(?:vt:)([^>]*)>([\s\S]*)</;function r2(e,t){var r=yt(e),n=e.match(n9(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var l=s.replace(a9,"").match(A9);l&&a.push({v:yr(l[2]),t:l[1]})}),a}var X_=/(^\s|\s$|\n)/;function Fn(e,t){return"<"+e+(t.match(X_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function iu(e){return Kr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ke(e,t,r){return"<"+e+(r!=null?iu(r):"")+(t!=null?(t.match(X_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Mp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function s9(e,t){switch(typeof e){case"string":var r=Ke("vt:lpwstr",dr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ke((e|0)==e?"vt:i4":"vt:r8",dr(String(e)));case"boolean":return Ke("vt:bool",e?"true":"false")}if(e instanceof Date)return Ke("vt:filetime",Mp(e));throw new Error("Unable to serialize "+e)}function kx(e){if(Mt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return yr(ni(Cx(e)));throw new Error("Bad input format: expected Buffer or string")}var lu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,dn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],pa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function i9(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function l9(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,l=n?-t:t;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var n2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},a2=Mt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ls(t)})):n2(e)}:n2,A2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(WA(e,a)));return n.join("").replace(qn,"")},Nx=Mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(qn,""):A2(e,t,r)}:A2,s2=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},J_=Mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):s2(e,t,r)}:s2,i2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ql(e,a)));return n.join("")},Bu=Mt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):i2(t,r,n)}:i2,W_=function(e,t){var r=xa(e,t);return r>0?Bu(e,t+4,t+4+r-1):""},Y_=W_,q_=function(e,t){var r=xa(e,t);return r>0?Bu(e,t+4,t+4+r-1):""},$_=q_,Z_=function(e,t){var r=2*xa(e,t);return r>0?Bu(e,t+4,t+4+r-1):""},eb=Z_,tb=function(t,r){var n=xa(t,r);return n>0?Nx(t,r+4,r+4+n):""},rb=tb,nb=function(e,t){var r=xa(e,t);return r>0?Bu(e,t+4,t+4+r):""},ab=nb,Ab=function(e,t){return i9(e,t)},od=Ab,Ix=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Mt&&(Y_=function(t,r){if(!Buffer.isBuffer(t))return W_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$_=function(t,r){if(!Buffer.isBuffer(t))return q_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},eb=function(t,r){if(!Buffer.isBuffer(t))return Z_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},rb=function(t,r){if(!Buffer.isBuffer(t))return tb(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},ab=function(t,r){if(!Buffer.isBuffer(t))return nb(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},od=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ab(t,r)},Ix=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ql=function(e,t){return e[t]},WA=function(e,t){return e[t+1]*256+e[t]},o9=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},xa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ii=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},c9=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Gc(e,t){var r="",n,a,s=[],l,o,u,f;switch(t){case"dbcs":if(f=this.l,Mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(WA(this,f)),f+=2;e*=2;break;case"utf8":r=Bu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Nx(this,this.l,this.l+e);break;case"wstr":return Gc.call(this,e,"dbcs");case"lpstr-ansi":r=Y_(this,this.l),e=4+xa(this,this.l);break;case"lpstr-cp":r=$_(this,this.l),e=4+xa(this,this.l);break;case"lpwstr":r=eb(this,this.l),e=4+2*xa(this,this.l);break;case"lpp4":e=4+xa(this,this.l),r=rb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+xa(this,this.l),r=ab(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=ql(this,this.l+e++))!==0;)s.push(gf(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=WA(this,this.l+e))!==0;)s.push(gf(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return l=ql(this,f),this.l=f+1,o=Gc.call(this,e-u,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(gf(WA(this,f))),f+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return l=ql(this,f),this.l=f+1,o=Gc.call(this,e-u,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(gf(ql(this,f))),f+=1}r=s.join("");break;default:switch(e){case 1:return n=ql(this,this.l),this.l++,n;case 2:return n=(t==="i"?o9:WA)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ii:c9)(this,this.l),this.l+=4,n):(a=xa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=od(this,this.l):a=od([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=J_(this,this.l,e);break}}return this.l+=e,r}var u9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},f9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},d9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function h9(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)d9(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,u9(this,t,this.l);break;case 8:if(n=8,r==="f"){l9(this,t,this.l);break}case 16:break;case-4:n=4,f9(this,t,this.l);break}return this.l+=n,this}function sb(e,t){var r=J_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function bn(e,t){e.l=t,e.read_shift=Gc,e.chk=sb,e.write_shift=h9}function Vn(e,t){e.l+=t}function _e(e){var t=Ys(e);return bn(t,0),t}function os(e,t,r){if(e){var n,a,s;bn(e,e.l||0);for(var l=e.length,o=0,u=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=hu[o]||hu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;u=e.l+s;var d=f.f&&f.f(e,s,r);if(e.l=u,t(d,f,o))return}}}function ia(){var e=[],t=Mt?256:2048,r=function(f){var d=_e(f);return bn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},l=function(){return a(),xn(e)},o=function(f){a(),n=f,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function Qe(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=hu[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Ix(r)&&e.push(r)}}function Vc(e,t,r){var n=Ir(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function l2(e,t,r){var n=Ir(e);return n.s=Vc(n.s,t.s,r),n.e=Vc(n.e,t.s,r),n}function Kc(e,t){if(e.cRel&&e.c<0)for(e=Ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=wt(e);return!e.cRel&&e.cRel!=null&&(r=p9(r)),!e.rRel&&e.rRel!=null&&(r=g9(r)),r}function km(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Lr(e.s.c)+":"+(e.e.cRel?"":"$")+Lr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+qr(e.s.r)+":"+(e.e.rRel?"":"$")+qr(e.e.r):Kc(e.s,t.biff)+":"+Kc(e.e,t.biff)}function Qx(e){return parseInt(m9(e),10)-1}function qr(e){return""+(e+1)}function g9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function m9(e){return e.replace(/\$(\d+)$/,"$1")}function Rx(e){for(var t=x9(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Lr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function p9(e){return e.replace(/^([A-Z])/,"$$$1")}function x9(e){return e.replace(/^\$([A-Z])/,"$1")}function v9(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function wt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function la(e){var t=e.indexOf(":");return t==-1?{s:Hr(e),e:Hr(e)}:{s:Hr(e.slice(0,t)),e:Hr(e.slice(t+1))}}function kt(e,t){return typeof t>"u"||typeof t=="number"?kt(e.s,e.e):(typeof e!="string"&&(e=wt(e)),typeof t!="string"&&(t=wt(t)),e==t?e:e+":"+t)}function Yt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function o2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ya(e.z,r?hn(t):t)}catch{}try{return e.w=Ya((e.XF||{}).numFmtId||(r?14:0),r?hn(t):t)}catch{return""+t}}function as(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?cs[e.v]||e.v:t==null?o2(e,e.v):o2(e,t))}function ai(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function ib(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var u=typeof n.origin=="string"?Hr(n.origin):n.origin;l=u.r,o=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Yt(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),l==-1&&(f.e.r=l=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var y={v:t[m][x]},E=l+m,C=o+x;if(f.s.r>E&&(f.s.r=E),f.s.c>C&&(f.s.c=C),f.e.r<E&&(f.e.r=E),f.e.c<C&&(f.e.c=C),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))y=t[m][x];else if(Array.isArray(y.v)&&(y.f=t[m][x][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||xt[14],n.cellDates?(y.t="d",y.w=Ya(y.z,hn(y.v))):(y.t="n",y.v=hn(y.v),y.w=Ya(y.z,y.v))):y.t="s";if(a)s[E]||(s[E]=[]),s[E][C]&&s[E][C].z&&(y.z=s[E][C].z),s[E][C]=y;else{var S=wt({c:C,r:E});s[S]&&s[S].z&&(y.z=s[S].z),s[S]=y}}}return f.s.c<1e7&&(s["!ref"]=kt(f)),s}function Bo(e,t){return ib(null,e,t)}function w9(e){return e.read_shift(4,"i")}function oA(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function Gn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function vn(e,t){var r=!1;return t==null&&(r=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function y9(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function B9(e,t){return t||(t=_e(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Dx(e,t){var r=e.l,n=e.read_shift(1),a=Gn(e),s=[],l={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),u=0;u!=o;++u)s.push(y9(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function C9(e,t){var r=!1;return t==null&&(r=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),vn(e.t,t),r?t.slice(0,t.l):t}var E9=Dx;function S9(e,t){var r=!1;return t==null&&(r=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),vn(e.t,t),t.write_shift(4,1),B9({},t),r?t.slice(0,t.l):t}function qa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function qi(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function $i(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Zi(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var T9=Gn,lb=vn;function Mx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function cd(e,t){var r=!1;return t==null&&(r=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _9=Gn,Lp=Mx,Lx=cd;function Hx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?od([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ii(t,0)>>2;return r?a/100:a}function ob(e,t){t==null&&(t=_e(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function cb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function b9(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var el=cb,Co=b9;function On(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ki(e,t){return(t||_e(8)).write_shift(8,e,"f")}function F9(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=Li[a];f&&(t.rgb=cu(f));break;case 2:t.rgb=cu([l,o,u]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function ud(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function U9(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function k9(e,t){t||(t=_e(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ub(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function N9(e){return ub(e,1)}function I9(e){return ub(e,2)}var Ox=2,Aa=3,pf=11,c2=12,fd=19,xf=64,Q9=65,R9=71,D9=4108,M9=4126,pn=80,fb=81,L9=[pn,fb],Hp={1:{n:"CodePage",t:Ox},2:{n:"Category",t:pn},3:{n:"PresentationFormat",t:pn},4:{n:"ByteCount",t:Aa},5:{n:"LineCount",t:Aa},6:{n:"ParagraphCount",t:Aa},7:{n:"SlideCount",t:Aa},8:{n:"NoteCount",t:Aa},9:{n:"HiddenCount",t:Aa},10:{n:"MultimediaClipCount",t:Aa},11:{n:"ScaleCrop",t:pf},12:{n:"HeadingPairs",t:D9},13:{n:"TitlesOfParts",t:M9},14:{n:"Manager",t:pn},15:{n:"Company",t:pn},16:{n:"LinksUpToDate",t:pf},17:{n:"CharacterCount",t:Aa},19:{n:"SharedDoc",t:pf},22:{n:"HyperlinksChanged",t:pf},23:{n:"AppVersion",t:Aa,p:"version"},24:{n:"DigSig",t:Q9},26:{n:"ContentType",t:pn},27:{n:"ContentStatus",t:pn},28:{n:"Language",t:pn},29:{n:"Version",t:pn},255:{},2147483648:{n:"Locale",t:fd},2147483651:{n:"Behavior",t:fd},1919054434:{}},Op={1:{n:"CodePage",t:Ox},2:{n:"Title",t:pn},3:{n:"Subject",t:pn},4:{n:"Author",t:pn},5:{n:"Keywords",t:pn},6:{n:"Comments",t:pn},7:{n:"Template",t:pn},8:{n:"LastAuthor",t:pn},9:{n:"RevNumber",t:pn},10:{n:"EditTime",t:xf},11:{n:"LastPrinted",t:xf},12:{n:"CreatedDate",t:xf},13:{n:"ModifiedDate",t:xf},14:{n:"PageCount",t:Aa},15:{n:"WordCount",t:Aa},16:{n:"CharCount",t:Aa},17:{n:"Thumbnail",t:R9},18:{n:"Application",t:pn},19:{n:"DocSecurity",t:Aa},255:{},2147483648:{n:"Locale",t:fd},2147483651:{n:"Behavior",t:fd},1919054434:{}},u2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},H9=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function O9(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var P9=O9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Li=Ir(P9),cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},db={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Px(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function G9(e){var t=Px();if(!e||!e.match)return t;var r={};if((e.match(Kn)||[]).forEach(function(n){var a=yt(n);switch(a[0].replace($7,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Pp[a.ContentType]]!==void 0&&t[Pp[a.ContentType]].push(a.PartName);break}}),t.xmlns!==dn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function hb(e,t){var r=G7(Pp),n=[],a;n[n.length]=$r,n[n.length]=Ke("Types",null,{xmlns:dn.CT,"xmlns:xsd":dn.xsd,"xmlns:xsi":dn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ke("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(a=e[u][0],n[n.length]=Ke("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:vf[u][t.bookType]||vf[u].xlsx}))},l=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Ke("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:vf[u][t.bookType]||vf[u].xlsx})})},o=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Ke("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[u][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Lt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ou(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function jc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kn)||[]).forEach(function(a){var s=yt(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Qc(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function so(e){var t=[$r,Ke("Relationships",null,{xmlns:dn.RELS})];return Kr(e["!id"]).forEach(function(r){t[t.length]=Ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function fr(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Lt.HLINK,Lt.XPATH,Lt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var V9="application/vnd.oasis.opendocument.spreadsheet";function K9(e,t){for(var r=kx(e),n,a;n=lu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=yt(n[0],!1),a.path=="/"&&a.type!==V9)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function j9(e){var t=[$r];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function f2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function z9(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function X9(e){var t=[$r];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(f2(e[r][0],e[r][1])),t.push(z9("",e[r][0]));return t.push(f2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ad.version+"</meta:generator></office:meta></office:document-meta>"}var Ja=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],J9=(function(){for(var e=new Array(Ja.length),t=0;t<Ja.length;++t){var r=Ja[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function mb(e){var t={};e=yr(e);for(var r=0;r<Ja.length;++r){var n=Ja[r],a=e.match(J9[r]);a!=null&&a.length>0&&(t[n[1]]=Wt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Nr(t[n[1]]))}return t}function Nm(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=dr(t),n[n.length]=r?Ke(e,t,r):Fn(e,t))}function pb(e,t){var r=t||{},n=[$r,Ke("cp:coreProperties",null,{"xmlns:cp":dn.CORE_PROPS,"xmlns:dc":dn.dc,"xmlns:dcterms":dn.dcterms,"xmlns:dcmitype":dn.dcmitype,"xmlns:xsi":dn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Nm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Mp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Nm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Mp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Ja.length;++s){var l=Ja[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Nm(l[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Hi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],xb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vb(e,t,r,n){var a=[];if(typeof e=="string")a=r2(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var l=typeof t=="string"?r2(t,n).map(function(d){return d.v}):t,o=0,u=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=l.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=l.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=l.slice(o,o+u);break}o+=u}}function W9(e,t,r){var n={};return t||(t={}),e=yr(e),Hi.forEach(function(a){var s=(e.match(su(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Wt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&vb(n.HeadingPairs,n.TitlesOfParts,t,r),t}function wb(e){var t=[],r=Ke;return e||(e={}),e.Application="SheetJS",t[t.length]=$r,t[t.length]=Ke("Properties",null,{xmlns:dn.EXT_PROPS,"xmlns:vt":dn.vt}),Hi.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=dr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+dr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Y9=/<[^>]+>[^<]*/g;function q9(e,t){var r={},n="",a=e.match(Y9);if(a)for(var s=0;s!=a.length;++s){var l=a[s],o=yt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Wt(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var u=l.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Wt(d);break;case"bool":r[n]=kr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Nr(d);break;case"cy":case"error":r[n]=Wt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,u)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function yb(e){var t=[$r,Ke("Properties",null,{xmlns:dn.CUST_PROPS,"xmlns:vt":dn.vt})];if(!e)return t.join("");var r=1;return Kr(e).forEach(function(a){++r,t[t.length]=Ke("property",s9(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Gp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Im;function $9(e,t,r){Im||(Im=Hd(Gp)),t=Im[t]||t,e[t]=r}function Z9(e,t){var r=[];return Kr(Gp).map(function(n){for(var a=0;a<Ja.length;++a)if(Ja[a][1]==n)return Ja[a];for(a=0;a<Hi.length;++a)if(Hi[a][1]==n)return Hi[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Fn(Gp[n[1]]||n[1],a))}}),Ke("DocumentProperties",r.join(""),{xmlns:pa.o})}function eG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Kr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Ja.length;++l)if(s==Ja[l][1])return;for(l=0;l<Hi.length;++l)if(s==Hi[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),a.push(Ke($E(s),o,{"dt:dt":u}))}}),t&&Kr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Ke($E(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+pa.o+'">'+a.join("")+"</"+n+">"}function Gx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function tG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=_e(8);return l.write_shift(4,n),l.write_shift(4,a),l}function Bb(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Cb(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Eb(e,t,r){return t===31?Cb(e):Bb(e,t,r)}function Vp(e,t,r){return Eb(e,t,r===!1?0:4)}function rG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Eb(e,t,0)}function nG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(qn,""),e.l-a&2&&(e.l+=2)}return r}function aG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(qn,"");return r}function AG(e){var t=e.l,r=dd(e,fb);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=dd(e,Aa);return[r,n]}function sG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(AG(e));return r}function d2(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(qn,"").replace(Ic,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Sb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function iG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function dd(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==c2&&n!==t&&L9.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===c2?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Bb(e,n,4).replace(qn,"");case 31:return Cb(e);case 64:return Gx(e);case 65:return Sb(e);case 71:return iG(e);case 80:return Vp(e,n,!s.raw).replace(qn,"");case 81:return rG(e,n).replace(qn,"");case 4108:return sG(e);case 4126:case 4127:return n==4127?nG(e):aG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function h2(e,t){var r=_e(4),n=_e(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_e(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=tG(t);break;case 31:case 80:for(n=_e(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xn([r,n])}function g2(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0,o=0,u=-1,f={};for(l=0;l!=a;++l){var d=e.read_shift(4),m=e.read_shift(4);s[l]=[d,m+r]}s.sort(function(F,_){return F[1]-_[1]});var x={};for(l=0;l!=a;++l){if(e.l!==s[l][1]){var y=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],y=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],y=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(y=!1,e.l=s[l][1]),y)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var E=t[s[l][0]];if(x[E.n]=dd(e,E.t,{raw:!0}),E.p==="version"&&(x[E.n]=String(x[E.n]>>16)+"."+("0000"+String(x[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(x[E.n]){case 0:x[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:aA(o=x[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[E.n])}}else if(s[l][0]===1){if(o=x.CodePage=dd(e,Ox),aA(o),u!==-1){var C=e.l;e.l=s[u][1],f=d2(e,o),e.l=C}}else if(s[l][0]===0){if(o===0){u=l,e.l=s[l+1][1];continue}f=d2(e,o)}else{var S=f[s[l][0]],T;switch(e[e.l]){case 65:e.l+=4,T=Sb(e);break;case 30:e.l+=4,T=Vp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,T=Vp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,T=e.read_shift(4,"i");break;case 19:e.l+=4,T=e.read_shift(4);break;case 5:e.l+=4,T=e.read_shift(8,"f");break;case 11:e.l+=4,T=Wr(e,4);break;case 64:e.l+=4,T=Nr(Gx(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[S]=T}}return e.l=r+n,x}var Tb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function lG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function m2(e,t,r){var n=_e(8),a=[],s=[],l=8,o=0,u=_e(8),f=_e(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),a.push(f),l+=8+u.length,!t){f=_e(8),f.write_shift(4,0),a.unshift(f);var d=[_e(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(u=_e(8+2*(m.length+1)+(m.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,m.length+1),u.write_shift(0,m,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=xn(d),s.unshift(u),l+=8+u.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Tb.indexOf(e[o][0])>-1||xb.indexOf(e[o][0])>-1)&&e[o][1]!=null){var x=e[o][1],y=0;if(t){y=+t[e[o][0]];var E=r[y];if(E.p=="version"&&typeof x=="string"){var C=x.split(".");x=(+C[0]<<16)+(+C[1]||0)}u=h2(E.t,x)}else{var S=lG(x);S==-1&&(S=31,x=String(x)),u=h2(S,x)}s.push(u),f=_e(8),f.write_shift(4,t?y:2+o),a.push(f),l+=8+u.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),xn([n].concat(a).concat(s))}function p2(e,t,r){var n=e.content;if(!n)return{};bn(n,0);var a,s,l,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==ut.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(l=n.read_shift(16),u=n.read_shift(4));var m=g2(n,t),x={SystemIdentifier:f};for(var y in m)x[y]=m[y];if(x.FMTID=s,a===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var E;try{E=g2(n,null)}catch{}for(y in E)x[y]=E[y];return x.FMTID=[s,l],x}function x2(e,t,r,n,a,s){var l=_e(a?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,ut.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var u=m2(e,r,n);if(o.push(u),a){var f=m2(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+u.length),o.push(f)}return xn(o)}function Ds(e,t){return e.read_shift(t),null}function oG(e,t){t||(t=_e(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function cG(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Wr(e,t){return e.read_shift(t)===1}function Yn(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function ln(e){return e.read_shift(2,"u")}function Va(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function _b(e,t){return cG(e,t,ln)}function uG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function bb(e,t,r){return r||(r=_e(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Cu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function fG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),l=0,o,u={};a&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*l),n&&(e.l+=o),u.t=d,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function dG(e){var t=e.t||"",r=_e(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_e(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return xn(a)}function ji(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Eu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ji(e,n,r)}function tl(e,t,r){if(r.biff>5)return Eu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Fb(e,t,r){return r||(r=_e(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function hG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function gG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(qn,"");return n&&(e.l+=24),a}function mG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(qn,"");return r+l}function pG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return gG(e);case"0303000000000000c000000000000046":return mG(e);default:throw new Error("Unsupported Moniker "+r)}}function wf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(qn,""):"";return r}function v2(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function xG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,l,o,u,f="",d,m;a&16&&(s=wf(e,r-e.l)),a&128&&(l=wf(e,r-e.l)),(a&257)===257&&(o=wf(e,r-e.l)),(a&257)===1&&(u=pG(e,r-e.l)),a&8&&(f=wf(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(m=Gx(e)),e.l=r;var x=l||o||u||"";x&&f&&(x+="#"+f),x||(x="#"+f),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var y={Target:x};return d&&(y.guid=d),m&&(y.time=m),s&&(y.Tooltip=s),y}function vG(e){var t=_e(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),v2(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&v2(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)t.write_shift(1,n.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ub(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function kb(e,t){var r=Ub(e);return r[3]=0,r}function _A(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zi(e,t,r,n){return n||(n=_e(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function wG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yG(e,t,r){return t===0?"":tl(e,t,r)}function BG(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,s,l]}function Nb(e){var t=e.read_shift(2),r=Hx(e);return[t,r]}function CG(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Cu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Gd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Ib(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Qb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var EG=Qb;function Rb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function SG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function TG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function In(e){e.l+=2,e.l+=e.read_shift(2)}var _G={0:In,4:In,5:In,6:In,7:TG,8:In,9:In,10:In,11:In,12:In,13:SG,14:In,15:In,16:In,17:In,18:In,19:In,20:In,21:Rb};function bG(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(_G[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function yf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Vx(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_e(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function FG(e,t){return t===0||e.read_shift(2),1200}function UG(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=tl(e,0,r);return e.read_shift(t+n-e.l),a}function kG(e,t){var r=!t||t.biff==8,n=_e(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function NG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function IG(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Cu(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:s,name:l}}function QG(e,t){var r=!t||t.biff>=8?2:1,n=_e(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function RG(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0;l!=a&&e.l<r;++l)s.push(fG(e));return s.Count=n,s.Unique=a,s}function DG(e,t){var r=_e(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=dG(e[a]);var s=xn([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function MG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function LG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function HG(e){var t=wG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function OG(e){return e.read_shift(2),e.read_shift(4)}function w2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function PG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:l,FirstTab:o,Selected:u,TabRatio:f}}function GG(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function VG(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function KG(e){var t=_e(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function jG(){}function zG(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Cu(e,0,r),n}function XG(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=_e(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function JG(e){var t=_A(e);return t.isst=e.read_shift(4),t}function WG(e,t,r,n){var a=_e(10);return zi(e,t,n,a),a.write_shift(4,r),a}function YG(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=_A(e);r.biff==2&&e.l++;var s=Eu(e,n-e.l,r);return a.val=s,a}function qG(e,t,r,n,a){var s=!a||a.biff==8,l=_e(8+ +s+(1+s)*r.length);return zi(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function $G(e,t,r){var n=e.read_shift(2),a=tl(e,0,r);return[n,a]}function ZG(e,t,r,n){var a=r&&r.biff==5;n||(n=_e(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var eV=tl;function y2(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:u}}}function tV(e,t){var r=t.biff==8||!t.biff?4:2,n=_e(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function rV(e){var t=e.read_shift(2),r=e.read_shift(2),n=Nb(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function nV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Nb(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:s}}function aV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:s}}function AV(e,t,r,n){var a={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return a.patternType=H9[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function sV(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=AV(e,t,n.fStyle,r),n}function B2(e,t,r,n){var a=r&&r.biff==5;n||(n=_e(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function iV(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function lV(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function C2(e,t,r){var n=_A(e);(r.biff==2||t==9)&&++e.l;var a=uG(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function oV(e,t,r,n,a,s){var l=_e(8);return zi(e,t,n,l),bb(r,s,l),l}function cV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_A(e),a=On(e);return n.val=a,n}function uV(e,t,r,n){var a=_e(14);return zi(e,t,n,a),Ki(r,a),a}var E2=yG;function fV(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=ji(e,s),o=[];n>e.l;)o.push(Eu(e));return[s,a,l,o]}function S2(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=CG(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var dV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function T2(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=ji(e,l,r);a&32&&(f=dV[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var m=n==e.l||o===0||!(d>0)?[]:bX(e,d,r,o);return{chKey:s,Name:f,itab:u,rgce:m}}function Db(e,t,r){if(r.biff<8)return hV(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(BG(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function hV(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Cu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function gV(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ji(e,n,r),l=ji(e,a,r);return[s,l]}function mV(e,t,r){var n=Qb(e);e.l++;var a=e.read_shift(1);return t-=8,[FX(e,t,r),a,n]}function _2(e,t,r){var n=EG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,TX(e,t,r)]}function pV(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function xV(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=tl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,l,s]}}function vV(e,t,r){return xV(e,t,r)}function wV(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Gd(e));return r}function yV(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Ib(e[r],t);return t}function BV(e,t,r){if(r&&r.biff<8)return EV(e,t,r);var n=Rb(e),a=bG(e,t-22,n[1]);return{cmo:n,ft:a}}var CV={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function EV(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((CV[n]||Vn)(e,t,r)),{cmo:[a,n,s],ft:l}}function SV(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=hG(e,6,r);var o=e.read_shift(2);e.read_shift(2),ln(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],m=ji(e,e.lens[f+1]-e.lens[f]-1);if(a+=m,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function TV(e,t){var r=Gd(e);e.l+=16;var n=xG(e,t-24);return[r,n]}function _V(e){var t=_e(24),r=Hr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return xn([t,vG(e[1])])}function bV(e,t){e.read_shift(2);var r=Gd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(qn,""),[r,n]}function FV(e){var t=e[1].Tooltip,r=_e(10+2*(t.length+1));r.write_shift(2,2048);var n=Hr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function UV(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=u2[r]||r,r=e.read_shift(2),t[1]=u2[r]||r,t}function kV(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function NV(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kb(e));return r}function IV(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kb(e));return r}function QV(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Mb(e,t,r){if(!r.cellStyles)return Vn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:s,w:l,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function RV(e,t){var r=_e(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function DV(e,t){var r={};return t<32||(e.l+=16,r.header=On(e),r.footer=On(e),e.l+=2),r}function MV(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function LV(e){for(var t=_e(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var HV=_A,OV=_b,PV=Eu;function GV(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function VV(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_A(e);++e.l;var a=tl(e,t-7,r);return n.t="str",n.val=a,n}function KV(e){var t=_A(e);++e.l;var r=On(e);return t.t="n",t.val=r,t}function jV(e,t,r){var n=_e(15);return bu(n,e,t),n.write_shift(8,r,"f"),n}function zV(e){var t=_A(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function XV(e,t,r){var n=_e(9);return bu(n,e,t),n.write_shift(2,r),n}function JV(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function WV(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function YV(e,t,r){var n=e.l+t,a=_A(e),s=e.read_shift(2),l=ji(e,s,r);return e.l=n,a.t="str",a.val=l,a}var qV=[2,3,48,49,131,139,140,245],Kp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Hd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ys(1);switch(u.type){case"base64":d=va(Ba(o));break;case"binary":d=va(o);break;case"buffer":case"array":d=o;break}bn(d,0);var m=d.read_shift(1),x=!!(m&136),y=!1,E=!1;switch(m){case 2:break;case 3:break;case 48:y=!0,x=!0;break;case 49:y=!0,x=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var C=0,S=521;m==2&&(C=d.read_shift(2)),d.l+=3,m!=2&&(C=d.read_shift(4)),C>1048576&&(C=1e6),m!=2&&(S=d.read_shift(2));var T=d.read_shift(2),F=u.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=e[d[d.l]]),d.l+=1,d.l+=2),E&&(d.l+=36);for(var _=[],Q={},L=Math.min(d.length,m==2?521:S-10-(y?264:0)),R=E?32:11;d.l<L&&d[d.l]!=13;)switch(Q={},Q.name=nu.utils.decode(F,d.slice(d.l,d.l+R)).replace(/[\u0000\r\n].*$/g,""),d.l+=R,Q.type=String.fromCharCode(d.read_shift(1)),m!=2&&!E&&(Q.offset=d.read_shift(4)),Q.len=d.read_shift(1),m==2&&(Q.offset=d.read_shift(2)),Q.dec=d.read_shift(1),Q.name.length&&_.push(Q),m!=2&&(d.l+=E?13:14),Q.type){case"B":(!y||Q.len!=8)&&u.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Q.type)}if(d[d.l]!==13&&(d.l=S-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=S;var U=0,K=0;for(f[0]=[],K=0;K!=_.length;++K)f[0][K]=_[K].name;for(;C-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,f[++U]=[],K=0,K=0;K!=_.length;++K){var D=d.slice(d.l,d.l+_[K].len);d.l+=_[K].len,bn(D,0);var ee=nu.utils.decode(F,D);switch(_[K].type){case"C":ee.trim().length&&(f[U][K]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?f[U][K]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):f[U][K]=ee;break;case"F":f[U][K]=parseFloat(ee.trim());break;case"+":case"I":f[U][K]=E?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":f[U][K]=!0;break;case"N":case"F":f[U][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[U][K]="##MEMO##"+(E?parseInt(ee.trim(),10):D.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(f[U][K]=+ee||0);break;case"@":f[U][K]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":f[U][K]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":f[U][K]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[U][K]=-D.read_shift(-8,"f");break;case"B":if(y&&_[K].len==8){f[U][K]=D.read_shift(8,"f");break}case"G":case"P":D.l+=_[K].len;break;case"0":if(_[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[K].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=_,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=Bo(r(o,f),f);return d["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,d}function a(o,u){try{return ai(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,u){var f=u||{};if(+f.codepage>=0&&aA(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=ia(),m=md(o,{header:1,raw:!0,cellDates:!0}),x=m[0],y=m.slice(1),E=o["!cols"]||[],C=0,S=0,T=0,F=1;for(C=0;C<x.length;++C){if(((E[C]||{}).DBF||{}).name){x[C]=E[C].DBF.name,++T;continue}if(x[C]!=null){if(++T,typeof x[C]=="number"&&(x[C]=x[C].toString(10)),typeof x[C]!="string")throw new Error("DBF Invalid column name "+x[C]+" |"+typeof x[C]+"|");if(x.indexOf(x[C])!==C){for(S=0;S<1024;++S)if(x.indexOf(x[C]+"_"+S)==-1){x[C]+="_"+S;break}}}}var _=Yt(o["!ref"]),Q=[],L=[],R=[];for(C=0;C<=_.e.c-_.s.c;++C){var U="",K="",D=0,ee=[];for(S=0;S<y.length;++S)y[S][C]!=null&&ee.push(y[S][C]);if(ee.length==0||x[C]==null){Q[C]="?";continue}for(S=0;S<ee.length;++S){switch(typeof ee[S]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=ee[S]instanceof Date?"D":"C";break;default:K="C"}D=Math.max(D,String(ee[S]).length),U=U&&U!=K?"C":K}D>250&&(D=250),K=((E[C]||{}).DBF||{}).type,K=="C"&&E[C].DBF.len>D&&(D=E[C].DBF.len),U=="B"&&K=="N"&&(U="N",R[C]=E[C].DBF.dec,D=E[C].DBF.len),L[C]=U=="C"||K=="N"?D:s[U]||0,F+=L[C],Q[C]=U}var re=d.next(32);for(re.write_shift(4,318902576),re.write_shift(4,y.length),re.write_shift(2,296+32*T),re.write_shift(2,F),C=0;C<4;++C)re.write_shift(4,0);for(re.write_shift(4,0|(+t[T_]||3)<<8),C=0,S=0;C<x.length;++C)if(x[C]!=null){var Z=d.next(32),ae=(x[C].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,ae,"sbcs"),Z.write_shift(1,Q[C]=="?"?"C":Q[C],"sbcs"),Z.write_shift(4,S),Z.write_shift(1,L[C]||s[Q[C]]||0),Z.write_shift(1,R[C]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),S+=L[C]||s[Q[C]]||0}var Te=d.next(264);for(Te.write_shift(4,13),C=0;C<65;++C)Te.write_shift(4,0);for(C=0;C<y.length;++C){var Se=d.next(F);for(Se.write_shift(1,0),S=0;S<x.length;++S)if(x[S]!=null)switch(Q[S]){case"L":Se.write_shift(1,y[C][S]==null?63:y[C][S]?84:70);break;case"B":Se.write_shift(8,y[C][S]||0,"f");break;case"N":var q="0";for(typeof y[C][S]=="number"&&(q=y[C][S].toFixed(R[S]||0)),T=0;T<L[S]-q.length;++T)Se.write_shift(1,32);Se.write_shift(1,q,"sbcs");break;case"D":y[C][S]?(Se.write_shift(4,("0000"+y[C][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(y[C][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+y[C][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(y[C][S]!=null?y[C][S]:"").slice(0,L[S]);for(Se.write_shift(1,Ae,"sbcs"),T=0;T<L[S]-Ae.length;++T)Se.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),Lb=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Kr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,y){var E=e[y];return typeof E=="number"?LE(E):E},n=function(x,y,E){var C=y.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return C==59?x:LE(C)};e["|"]=254;function a(x,y){switch(y.type){case"base64":return s(Ba(x),y);case"binary":return s(x,y);case"buffer":return s(Mt&&Buffer.isBuffer(x)?x.toString("binary"):ni(x),y);case"array":return s(Vi(x),y)}throw new Error("Unrecognized type "+y.type)}function s(x,y){var E=x.split(/[\n\r]+/),C=-1,S=-1,T=0,F=0,_=[],Q=[],L=null,R={},U=[],K=[],D=[],ee=0,re;for(+y.codepage>=0&&aA(+y.codepage);T!==E.length;++T){ee=0;var Z=E[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ae=Z.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Te=ae[0],Se;if(Z.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&Q.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,Ae=!1,Re=!1,ie=!1,Me=-1,J=-1;for(F=1;F<ae.length;++F)switch(ae[F].charAt(0)){case"A":break;case"X":S=parseInt(ae[F].slice(1))-1,Ae=!0;break;case"Y":for(C=parseInt(ae[F].slice(1))-1,Ae||(S=0),re=_.length;re<=C;++re)_[re]=[];break;case"K":Se=ae[F].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(lA(Se))?isNaN(co(Se).getDate())||(Se=Nr(Se)):(Se=lA(Se),L!==null&&wo(L)&&(Se=Pd(Se))),q=!0;break;case"E":ie=!0;var k=io(ae[F].slice(1),{r:C,c:S});_[C][S]=[_[C][S],k];break;case"S":Re=!0,_[C][S]=[_[C][S],"S5S"];break;case"G":break;case"R":Me=parseInt(ae[F].slice(1))-1;break;case"C":J=parseInt(ae[F].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Z)}if(q&&(_[C][S]&&_[C][S].length==2?_[C][S][0]=Se:_[C][S]=Se,L=null),Re){if(ie)throw new Error("SYLK shared formula cannot have own formula");var V=Me>-1&&_[Me][J];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");_[C][S][1]=r4(V[1],{r:C-Me,c:S-J})}break;case"F":var P=0;for(F=1;F<ae.length;++F)switch(ae[F].charAt(0)){case"X":S=parseInt(ae[F].slice(1))-1,++P;break;case"Y":for(C=parseInt(ae[F].slice(1))-1,re=_.length;re<=C;++re)_[re]=[];break;case"M":ee=parseInt(ae[F].slice(1))/20;break;case"F":break;case"G":break;case"P":L=Q[parseInt(ae[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=ae[F].slice(1).split(" "),re=parseInt(D[0],10);re<=parseInt(D[1],10);++re)ee=parseInt(D[2],10),K[re-1]=ee===0?{hidden:!0}:{wch:ee},qs(K[re-1]);break;case"C":S=parseInt(ae[F].slice(1))-1,K[S]||(K[S]={});break;case"R":C=parseInt(ae[F].slice(1))-1,U[C]||(U[C]={}),ee>0?(U[C].hpt=ee,U[C].hpx=fo(ee)):ee===0&&(U[C].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Z)}P<1&&(L=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Z)}}return U.length>0&&(R["!rows"]=U),K.length>0&&(R["!cols"]=K),y&&y.sheetRows&&(_=_.slice(0,y.sheetRows)),[_,R]}function l(x,y){var E=a(x,y),C=E[0],S=E[1],T=Bo(C,y);return Kr(S).forEach(function(F){T[F]=S[F]}),T}function o(x,y){return ai(l(x,y),y)}function u(x,y,E,C){var S="C;Y"+(E+1)+";X"+(C+1)+";K";switch(x.t){case"n":S+=x.v||0,x.f&&!x.F&&(S+=";E"+Wx(x.f,{r:E,c:C}));break;case"b":S+=x.v?"TRUE":"FALSE";break;case"e":S+=x.w||x.v;break;case"d":S+='"'+(x.w||x.v)+'"';break;case"s":S+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(x,y){y.forEach(function(E,C){var S="F;W"+(C+1)+" "+(C+1)+" ";E.hidden?S+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=uu(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=fu(E.wpx)),typeof E.wch=="number"&&(S+=Math.round(E.wch))),S.charAt(S.length-1)!=" "&&x.push(S)})}function d(x,y){y.forEach(function(E,C){var S="F;";E.hidden?S+="M0;":E.hpt?S+="M"+20*E.hpt+";":E.hpx&&(S+="M"+20*du(E.hpx)+";"),S.length>2&&x.push(S+"R"+(C+1))})}function m(x,y){var E=["ID;PWXL;N;E"],C=[],S=Yt(x["!ref"]),T,F=Array.isArray(x),_=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),x["!cols"]&&f(E,x["!cols"]),x["!rows"]&&d(E,x["!rows"]),E.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var Q=S.s.r;Q<=S.e.r;++Q)for(var L=S.s.c;L<=S.e.c;++L){var R=wt({r:Q,c:L});T=F?(x[Q]||[])[L]:x[R],!(!T||T.v==null&&(!T.f||T.F))&&C.push(u(T,x,Q,L))}return E.join(_)+_+C.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:l,from_sheet:m}})(),Hb=(function(){function e(s,l){switch(l.type){case"base64":return t(Ba(s),l);case"binary":return t(s,l);case"buffer":return t(Mt&&Buffer.isBuffer(s)?s.toString("binary"):ni(s),l);case"array":return t(Vi(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),u=-1,f=-1,d=0,m=[];d!==o.length;++d){if(o[d].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var x=o[d].trim().split(","),y=x[0],E=x[1];++d;for(var C=o[d]||"";(C.match(/["]/g)||[]).length&1&&d<o.length-1;)C+=`
`+o[++d];switch(C=C.trim(),+y){case-1:if(C==="BOT"){m[++u]=[],f=0;continue}else if(C!=="EOD")throw new Error("Unrecognized DIF special command "+C);break;case 0:C==="TRUE"?m[u][f]=!0:C==="FALSE"?m[u][f]=!1:isNaN(lA(E))?isNaN(co(E).getDate())?m[u][f]=E:m[u][f]=Nr(E):m[u][f]=lA(E),++f;break;case 1:C=C.slice(1,C.length-1),C=C.replace(/""/g,'"'),C&&C.match(/^=".*"$/)&&(C=C.slice(2,-1)),m[u][f++]=C!==""?C:null;break}if(C==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function r(s,l){return Bo(e(s,l),l)}function n(s,l){return ai(r(s,l),l)}var a=(function(){var s=function(u,f,d,m,x){u.push(f),u.push(d+","+m),u.push('"'+x.replace(/"/g,'""')+'"')},l=function(u,f,d,m){u.push(f+","+d),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],d=Yt(u["!ref"]),m,x=Array.isArray(u);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,d.e.r-d.s.r+1,""),s(f,"TUPLES",0,d.e.c-d.s.c+1,""),s(f,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){l(f,-1,0,"BOT");for(var E=d.s.c;E<=d.e.c;++E){var C=wt({r:y,c:E});if(m=x?(u[y]||[])[E]:u[C],!m){l(f,1,0,"");continue}switch(m.t){case"n":var S=m.w;!S&&m.v!=null&&(S=m.v),S==null?m.f&&!m.F?l(f,1,0,"="+m.f):l(f,1,0,""):l(f,0,S,"V");break;case"b":l(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Ya(m.z||xt[14],hn(Nr(m.v)))),l(f,0,m.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var T=`\r
`,F=f.join(T);return F}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),Ob=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var y=m.split(`
`),E=-1,C=-1,S=0,T=[];S!==y.length;++S){var F=y[S].trim().split(":");if(F[0]==="cell"){var _=Hr(F[1]);if(T.length<=_.r)for(E=T.length;E<=_.r;++E)T[E]||(T[E]=[]);switch(E=_.r,C=_.c,F[2]){case"t":T[E][C]=e(F[3]);break;case"v":T[E][C]=+F[3];break;case"vtf":var Q=F[F.length-1];case"vtc":switch(F[3]){case"nl":T[E][C]=!!+F[4];break;default:T[E][C]=+F[4];break}F[2]=="vtf"&&(T[E][C]=[T[E][C],Q])}}}return x&&x.sheetRows&&(T=T.slice(0,x.sheetRows)),T}function n(m,x){return Bo(r(m,x),x)}function a(m,x){return ai(n(m,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var x=[],y=[],E,C="",S=la(m["!ref"]),T=Array.isArray(m),F=S.s.r;F<=S.e.r;++F)for(var _=S.s.c;_<=S.e.c;++_)if(C=wt({r:F,c:_}),E=T?(m[F]||[])[_]:m[C],!(!E||E.v==null||E.t==="z")){switch(y=["cell",C,"t"],E.t){case"s":case"str":y.push(t(E.v));break;case"n":E.f?(y[2]="vtf",y[3]="n",y[4]=E.v,y[5]=t(E.f)):(y[2]="v",y[3]=E.v);break;case"b":y[2]="vt"+(E.f?"f":"c"),y[3]="nl",y[4]=E.v?"1":"0",y[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var Q=hn(Nr(E.v));y[2]="vtc",y[3]="nd",y[4]=""+Q,y[5]=E.w||Ya(E.z||xt[14],Q);break;case"e":continue}x.push(y.join(":"))}return x.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(m){return[s,l,o,l,f(m),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}})(),uo=(function(){function e(d,m,x,y,E){E.raw?m[x][y]=d:d===""||(d==="TRUE"?m[x][y]=!0:d==="FALSE"?m[x][y]=!1:isNaN(lA(d))?isNaN(co(d).getDate())?m[x][y]=d:m[x][y]=Nr(d):m[x][y]=lA(d))}function t(d,m){var x=m||{},y=[];if(!d||d.length===0)return y;for(var E=d.split(/[\r\n]/),C=E.length-1;C>=0&&E[C].length===0;)--C;for(var S=10,T=0,F=0;F<=C;++F)T=E[F].indexOf(" "),T==-1?T=E[F].length:T++,S=Math.max(S,T);for(F=0;F<=C;++F){y[F]=[];var _=0;for(e(E[F].slice(0,S).trim(),y,F,_,x),_=1;_<=(E[F].length-S)/10+1;++_)e(E[F].slice(S+(_-1)*10,S+_*10).trim(),y,F,_,x)}return x.sheetRows&&(y=y.slice(0,x.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var m={},x=!1,y=0,E=0;y<d.length;++y)(E=d.charCodeAt(y))==34?x=!x:!x&&E in r&&(m[E]=(m[E]||0)+1);E=[];for(y in m)Object.prototype.hasOwnProperty.call(m,y)&&E.push([m[y],y]);if(!E.length){m=n;for(y in m)Object.prototype.hasOwnProperty.call(m,y)&&E.push([m[y],y])}return E.sort(function(C,S){return C[0]-S[0]||n[C[1]]-n[S[1]]}),r[E.pop()[1]]||44}function s(d,m){var x=m||{},y="",E=x.dense?[]:{},C={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=a(d.slice(0,1024)):x&&x.FS?y=x.FS:y=a(d.slice(0,1024));var S=0,T=0,F=0,_=0,Q=0,L=y.charCodeAt(0),R=!1,U=0,K=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var D=x.dateNF!=null?M7(x.dateNF):null;function ee(){var re=d.slice(_,Q),Z={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)Z.t="z";else if(x.raw)Z.t="s",Z.v=re;else if(re.trim().length===0)Z.t="s",Z.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(Z.t="s",Z.v=re.slice(2,-1).replace(/""/g,'"')):fz(re)?(Z.t="n",Z.f=re.slice(1)):(Z.t="s",Z.v=re);else if(re=="TRUE")Z.t="b",Z.v=!0;else if(re=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(F=lA(re)))Z.t="n",x.cellText!==!1&&(Z.w=re),Z.v=F;else if(!isNaN(co(re).getDate())||D&&re.match(D)){Z.z=x.dateNF||xt[14];var ae=0;D&&re.match(D)&&(re=L7(re,x.dateNF,re.match(D)||[]),ae=1),x.cellDates?(Z.t="d",Z.v=Nr(re,ae)):(Z.t="n",Z.v=hn(Nr(re,ae))),x.cellText!==!1&&(Z.w=Ya(Z.z,Z.v instanceof Date?hn(Z.v):Z.v)),x.cellNF||delete Z.z}else Z.t="s",Z.v=re;if(Z.t=="z"||(x.dense?(E[S]||(E[S]=[]),E[S][T]=Z):E[wt({c:T,r:S})]=Z),_=Q+1,K=d.charCodeAt(_),C.e.c<T&&(C.e.c=T),C.e.r<S&&(C.e.r=S),U==L)++T;else if(T=0,++S,x.sheetRows&&x.sheetRows<=S)return!0}e:for(;Q<d.length;++Q)switch(U=d.charCodeAt(Q)){case 34:K===34&&(R=!R);break;case L:case 10:case 13:if(!R&&ee())break e;break}return Q-_>0&&ee(),E["!ref"]=kt(C),E}function l(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,m):Bo(t(d,m),m)}function o(d,m){var x="",y=m.type=="string"?[0,0,0,0]:nv(d,m);switch(m.type){case"base64":x=Ba(d);break;case"binary":x=d;break;case"buffer":m.codepage==65001?x=d.toString("utf8"):m.codepage&&typeof nu<"u"||(x=Mt&&Buffer.isBuffer(d)?d.toString("binary"):ni(d));break;case"array":x=Vi(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+m.type)}return y[0]==239&&y[1]==187&&y[2]==191?x=yr(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=yr(x):m.type=="binary"&&typeof nu<"u",x.slice(0,19)=="socialcalc:version:"?Ob.to_sheet(m.type=="string"?x:yr(x),m):l(x,m)}function u(d,m){return ai(o(d,m),m)}function f(d){for(var m=[],x=Yt(d["!ref"]),y,E=Array.isArray(d),C=x.s.r;C<=x.e.r;++C){for(var S=[],T=x.s.c;T<=x.e.c;++T){var F=wt({r:C,c:T});if(y=E?(d[C]||[])[T]:d[F],!y||y.v==null){S.push("          ");continue}for(var _=(y.w||(as(y),y.w)||"").slice(0,10);_.length<10;)_+=" ";S.push(_+(T===0?" ":""))}m.push(S.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}})();function $V(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Lb.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return uo.to_workbook(e,t)}}var Oi=(function(){function e(k,V,P){if(k){bn(k,k.l||0);for(var z=P.Enum||Me;k.l<k.length;){var le=k.read_shift(2),Be=z[le]||z[65535],de=k.read_shift(2),ce=k.l+de,ne=Be.f&&Be.f(k,de,P);if(k.l=ce,V(ne,Be,le))return}}}function t(k,V){switch(V.type){case"base64":return r(va(Ba(k)),V);case"binary":return r(va(k),V);case"buffer":case"array":return r(k,V)}throw"Unsupported type "+V.type}function r(k,V){if(!k)return k;var P=V||{},z=P.dense?[]:{},le="Sheet1",Be="",de=0,ce={},ne=[],Ce=[],N={s:{r:0,c:0},e:{r:0,c:0}},Ie=P.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)P.Enum=Me,e(k,function(He,ft,Et){switch(Et){case 0:P.vers=He,He>=4096&&(P.qpro=!0);break;case 6:N=He;break;case 204:He&&(Be=He);break;case 222:Be=He;break;case 15:case 51:P.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:Et==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=P.dateNF||xt[14],P.cellDates&&(He[1].t="d",He[1].v=Pd(He[1].v))),P.qpro&&He[3]>de&&(z["!ref"]=kt(N),ce[le]=z,ne.push(le),z=P.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},de=He[3],le=Be||"Sheet"+(de+1),Be="");var lr=P.dense?(z[He[0].r]||[])[He[0].c]:z[wt(He[0])];if(lr){lr.t=He[1].t,lr.v=He[1].v,He[1].z!=null&&(lr.z=He[1].z),He[1].f!=null&&(lr.f=He[1].f);break}P.dense?(z[He[0].r]||(z[He[0].r]=[]),z[He[0].r][He[0].c]=He[1]):z[wt(He[0])]=He[1];break}},P);else if(k[2]==26||k[2]==14)P.Enum=J,k[2]==14&&(P.qpro=!0,k.l=0),e(k,function(He,ft,Et){switch(Et){case 204:le=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>de&&(z["!ref"]=kt(N),ce[le]=z,ne.push(le),z=P.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},de=He[3],le="Sheet"+(de+1)),Ie>0&&He[0].r>=Ie)break;P.dense?(z[He[0].r]||(z[He[0].r]=[]),z[He[0].r][He[0].c]=He[1]):z[wt(He[0])]=He[1],N.e.c<He[0].c&&(N.e.c=He[0].c),N.e.r<He[0].r&&(N.e.r=He[0].r);break;case 27:He[14e3]&&(Ce[He[14e3][0]]=He[14e3][1]);break;case 1537:Ce[He[0]]=He[1],He[0]==de&&(le=He[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(z["!ref"]=kt(N),ce[Be||le]=z,ne.push(Be||le),!Ce.length)return{SheetNames:ne,Sheets:ce};for(var Pe={},Ye=[],et=0;et<Ce.length;++et)ce[ne[et]]?(Ye.push(Ce[et]||ne[et]),Pe[Ce[et]]=ce[Ce[et]]||ce[ne[et]]):(Ye.push(Ce[et]),Pe[Ce[et]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:Pe}}function n(k,V){var P=V||{};if(+P.codepage>=0&&aA(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var z=ia(),le=Yt(k["!ref"]),Be=Array.isArray(k),de=[];ze(z,0,s(1030)),ze(z,6,u(le));for(var ce=Math.min(le.e.r,8191),ne=le.s.r;ne<=ce;++ne)for(var Ce=qr(ne),N=le.s.c;N<=le.e.c;++N){ne===le.s.r&&(de[N]=Lr(N));var Ie=de[N]+Ce,Pe=Be?(k[ne]||[])[N]:k[Ie];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")(Pe.v|0)==Pe.v&&Pe.v>=-32768&&Pe.v<=32767?ze(z,13,y(ne,N,Pe.v)):ze(z,14,C(ne,N,Pe.v));else{var Ye=as(Pe);ze(z,15,m(ne,N,Ye.slice(0,239)))}}return ze(z,1),z.end()}function a(k,V){var P=V||{};if(+P.codepage>=0&&aA(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var z=ia();ze(z,0,l(k));for(var le=0,Be=0;le<k.SheetNames.length;++le)(k.Sheets[k.SheetNames[le]]||{})["!ref"]&&ze(z,27,ie(k.SheetNames[le],Be++));var de=0;for(le=0;le<k.SheetNames.length;++le){var ce=k.Sheets[k.SheetNames[le]];if(!(!ce||!ce["!ref"])){for(var ne=Yt(ce["!ref"]),Ce=Array.isArray(ce),N=[],Ie=Math.min(ne.e.r,8191),Pe=ne.s.r;Pe<=Ie;++Pe)for(var Ye=qr(Pe),et=ne.s.c;et<=ne.e.c;++et){Pe===ne.s.r&&(N[et]=Lr(et));var He=N[et]+Ye,ft=Ce?(ce[Pe]||[])[et]:ce[He];if(!(!ft||ft.t=="z"))if(ft.t=="n")ze(z,23,ee(Pe,et,de,ft.v));else{var Et=as(ft);ze(z,22,U(Pe,et,de,Et.slice(0,239)))}}++de}}return ze(z,1),z.end()}function s(k){var V=_e(2);return V.write_shift(2,k),V}function l(k){var V=_e(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var P=0,z=0,le=0,Be=0;Be<k.SheetNames.length;++Be){var de=k.SheetNames[Be],ce=k.Sheets[de];if(!(!ce||!ce["!ref"])){++le;var ne=la(ce["!ref"]);P<ne.e.r&&(P=ne.e.r),z<ne.e.c&&(z=ne.e.c)}}return P>8191&&(P=8191),V.write_shift(2,P),V.write_shift(1,le),V.write_shift(1,z),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(k,V,P){var z={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&P.qpro?(z.s.c=k.read_shift(1),k.l++,z.s.r=k.read_shift(2),z.e.c=k.read_shift(1),k.l++,z.e.r=k.read_shift(2),z):(z.s.c=k.read_shift(2),z.s.r=k.read_shift(2),V==12&&P.qpro&&(k.l+=2),z.e.c=k.read_shift(2),z.e.r=k.read_shift(2),V==12&&P.qpro&&(k.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function u(k){var V=_e(8);return V.write_shift(2,k.s.c),V.write_shift(2,k.s.r),V.write_shift(2,k.e.c),V.write_shift(2,k.e.r),V}function f(k,V,P){var z=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(z[0].c=k.read_shift(1),z[3]=k.read_shift(1),z[0].r=k.read_shift(2),k.l+=2):(z[2]=k.read_shift(1),z[0].c=k.read_shift(2),z[0].r=k.read_shift(2)),z}function d(k,V,P){var z=k.l+V,le=f(k,V,P);if(le[1].t="s",P.vers==20768){k.l++;var Be=k.read_shift(1);return le[1].v=k.read_shift(Be,"utf8"),le}return P.qpro&&k.l++,le[1].v=k.read_shift(z-k.l,"cstr"),le}function m(k,V,P){var z=_e(7+P.length);z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,k),z.write_shift(1,39);for(var le=0;le<z.length;++le){var Be=P.charCodeAt(le);z.write_shift(1,Be>=128?95:Be)}return z.write_shift(1,0),z}function x(k,V,P){var z=f(k,V,P);return z[1].v=k.read_shift(2,"i"),z}function y(k,V,P){var z=_e(7);return z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,k),z.write_shift(2,P,"i"),z}function E(k,V,P){var z=f(k,V,P);return z[1].v=k.read_shift(8,"f"),z}function C(k,V,P){var z=_e(13);return z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,k),z.write_shift(8,P,"f"),z}function S(k,V,P){var z=k.l+V,le=f(k,V,P);if(le[1].v=k.read_shift(8,"f"),P.qpro)k.l=z;else{var Be=k.read_shift(2);Q(k.slice(k.l,k.l+Be),le),k.l+=Be}return le}function T(k,V,P){var z=V&32768;return V&=-32769,V=(z?k:0)+(V>=8192?V-16384:V),(z?"":"$")+(P?Lr(V):qr(V))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Q(k,V){bn(k,0);for(var P=[],z=0,le="",Be="",de="",ce="";k.l<k.length;){var ne=k[k.l++];switch(ne){case 0:P.push(k.read_shift(8,"f"));break;case 1:Be=T(V[0].c,k.read_shift(2),!0),le=T(V[0].r,k.read_shift(2),!1),P.push(Be+le);break;case 2:{var Ce=T(V[0].c,k.read_shift(2),!0),N=T(V[0].r,k.read_shift(2),!1);Be=T(V[0].c,k.read_shift(2),!0),le=T(V[0].r,k.read_shift(2),!1),P.push(Ce+N+":"+Be+le)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(k.read_shift(2));break;case 6:{for(var Ie="";ne=k[k.l++];)Ie+=String.fromCharCode(ne);P.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:ce=P.pop(),de=P.pop(),P.push(["AND","OR"][ne-20]+"("+de+","+ce+")");break;default:if(ne<32&&_[ne])ce=P.pop(),de=P.pop(),P.push(de+_[ne]+ce);else if(F[ne]){if(z=F[ne][1],z==69&&(z=k[k.l++]),z>P.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+P.join("|")+"|");return}var Pe=P.slice(-z);P.length-=z,P.push(F[ne][0]+"("+Pe.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}P.length==1?V[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function L(k){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=k.read_shift(2),V[3]=k[k.l++],V[0].c=k[k.l++],V}function R(k,V){var P=L(k);return P[1].t="s",P[1].v=k.read_shift(V-4,"cstr"),P}function U(k,V,P,z){var le=_e(6+z.length);le.write_shift(2,k),le.write_shift(1,P),le.write_shift(1,V),le.write_shift(1,39);for(var Be=0;Be<z.length;++Be){var de=z.charCodeAt(Be);le.write_shift(1,de>=128?95:de)}return le.write_shift(1,0),le}function K(k,V){var P=L(k);P[1].v=k.read_shift(2);var z=P[1].v>>1;if(P[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return P[1].v=z,P}function D(k,V){var P=L(k),z=k.read_shift(4),le=k.read_shift(4),Be=k.read_shift(2);if(Be==65535)return z===0&&le===3221225472?(P[1].t="e",P[1].v=15):z===0&&le===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var de=Be&32768;return Be=(Be&32767)-16446,P[1].v=(1-de*2)*(le*Math.pow(2,Be+32)+z*Math.pow(2,Be)),P}function ee(k,V,P,z){var le=_e(14);if(le.write_shift(2,k),le.write_shift(1,P),le.write_shift(1,V),z==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var Be=0,de=0,ce=0,ne=0;return z<0&&(Be=1,z=-z),de=Math.log2(z)|0,z/=Math.pow(2,de-31),ne=z>>>0,(ne&2147483648)==0&&(z/=2,++de,ne=z>>>0),z-=ne,ne|=2147483648,ne>>>=0,z*=Math.pow(2,32),ce=z>>>0,le.write_shift(4,ce),le.write_shift(4,ne),de+=16383+(Be?32768:0),le.write_shift(2,de),le}function re(k,V){var P=D(k);return k.l+=V-14,P}function Z(k,V){var P=L(k),z=k.read_shift(4);return P[1].v=z>>6,P}function ae(k,V){var P=L(k),z=k.read_shift(8,"f");return P[1].v=z,P}function Te(k,V){var P=ae(k);return k.l+=V-10,P}function Se(k,V){return k[k.l+V-1]==0?k.read_shift(V,"cstr"):""}function q(k,V){var P=k[k.l++];P>V-1&&(P=V-1);for(var z="";z.length<P;)z+=String.fromCharCode(k[k.l++]);return z}function Ae(k,V,P){if(!(!P.qpro||V<21)){var z=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var le=k.read_shift(V-21,"cstr");return[z,le]}}function Re(k,V){for(var P={},z=k.l+V;k.l<z;){var le=k.read_shift(2);if(le==14e3){for(P[le]=[0,""],P[le][0]=k.read_shift(2);k[k.l];)P[le][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return P}function ie(k,V){var P=_e(5+k.length);P.write_shift(2,14e3),P.write_shift(2,V);for(var z=0;z<k.length;++z){var le=k.charCodeAt(z);P[P.l++]=le>127?95:le}return P[P.l++]=0,P}var Me={0:{n:"BOF",f:ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function ZV(e){var t={},r=e.match(Kn),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=yt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=wx[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var eK=(function(){var e=su("t"),t=su("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Wt(l[1])},u=s.match(t);return u&&(o.s=ZV(u[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(o){return o.v})}})(),tK=(function(){var t=/(\r\n|\n)/g;function r(a,s,l){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),l.push("</"+u+">")),l.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),rK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,nK=/<(?:\w+:)?r>/,aK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Wt(yr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=yr(e),r&&(n.h=Ux(n.t))):e.match(nK)&&(n.r=yr(e),n.t=Wt(yr((e.replace(aK,"").match(rK)||[]).join("").replace(Kn,""))),r&&(n.h=tK(eK(n.r)))),n):{t:""}}var AK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sK=/<(?:\w+:)?(?:si|sstItem)>/g,iK=/<\/(?:\w+:)?(?:si|sstItem)>/;function lK(e,t){var r=[],n="";if(!e)return r;var a=e.match(AK);if(a){n=a[2].replace(sK,"").split(iK);for(var s=0;s!=n.length;++s){var l=Kx(n[s].trim(),t);l!=null&&(r[r.length]=l)}a=yt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var oK=/^\s|\s$|[\t\n\r]/;function Pb(e,t){if(!t.bookSST)return"";var r=[$r];r[r.length]=Ke("sst",null,{xmlns:Yi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(oK)&&(s+=' xml:space="preserve"'),s+=">"+dr(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function cK(e){return[e.read_shift(4),e.read_shift(4)]}function uK(e,t){var r=[],n=!1;return os(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function fK(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var dK=C9;function hK(e){var t=ia();Qe(t,159,fK(e));for(var r=0;r<e.length;++r)Qe(t,19,dK(e[r]));return Qe(t,160),t.end()}function Gb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function es(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function gK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=es(e,4),t.U=es(e,4),t.W=es(e,4),t}function mK(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function pK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(mK(e));return t}function xK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function vK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=es(e,4),t.U=es(e,4),t.W=es(e,4),t}function wK(e){var t=vK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Vb(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Kb(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function yK(e){var t=es(e);switch(t.Minor){case 2:return[t.Minor,BK(e)];case 3:return[t.Minor,CK()];case 4:return[t.Minor,EK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function BK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Vb(e,r),a=Kb(e,e.length-e.l);return{t:"Std",h:n,v:a}}function CK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function EK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kn,function(s){var l=yt(s);switch(TA(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function SK(e,t){var r={},n=r.EncryptionVersionInfo=es(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Vb(e,a),t-=a,r.EncryptionVerifier=Kb(e,t),r}function TK(e){var t={},r=t.EncryptionVersionInfo=es(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function jx(e){var t=0,r,n=Gb(e),a=n.length+1,s,l,o,u,f;for(r=Ys(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)l=r[s],o=(t&16384)===0?0:1,u=t<<1&32767,f=o|u,t=f^l;return t^52811}var jb=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],u=104,f=l.length-1;f>=0;--f)for(var d=l[f],m=0;m!=7;++m)d&64&&(o^=r[u]),d*=2,--u;return o};return function(l){for(var o=Gb(l),u=s(o),f=o.length,d=Ys(16),m=0;m!=16;++m)d[m]=0;var x,y,E;for((f&1)===1&&(x=u>>8,d[f]=a(e[0],x),--f,x=u&255,y=o[o.length-1],d[f]=a(y,x));f>0;)--f,x=u>>8,d[f]=a(o[f],x),--f,x=u&255,d[f]=a(o[f],x);for(f=15,E=15-o.length;E>0;)x=u>>8,d[f]=a(e[E],x),--f,--E,x=u&255,d[f]=a(o[f],x),--f,--E;return d}})(),_K=function(e,t,r,n,a){a||(a=t),n||(n=jb(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,a[s]=l,++r;return[a,r,n]},bK=function(e){var t=0,r=jb(e);return function(n){var a=_K("",n,t,r);return t=a[1],a[0]}};function FK(e,t,r,n){var a={key:ln(e),verificationBytes:ln(e)};return r.password&&(a.verifier=jx(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=bK(r.password)),a}function UK(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=TK(e):n.Data=SK(e,t),n}function kK(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?UK(e,t-2,n):FK(e,r.biff>=8?t:t-2,r,n),n}var zb=(function(){function e(a,s){switch(s.type){case"base64":return t(Ba(a),s);case"binary":return t(a,s);case"buffer":return t(Mt&&Buffer.isBuffer(a)?a.toString("binary"):ni(a),s);case"array":return t(Vi(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var l=s||{},o=l.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,m){Array.isArray(o)&&(o[m]=[]);for(var x=/\\\w+\b/g,y=0,E,C=-1;E=x.exec(d);){switch(E[0]){case"\\cell":var S=d.slice(y,x.lastIndex-E[0].length);if(S[0]==" "&&(S=S.slice(1)),++C,S.length){var T={v:S,t:"s"};Array.isArray(o)?o[m][C]=T:o[wt({r:m,c:C})]=T}break}y=x.lastIndex}C>f.e.c&&(f.e.c=C)}),o["!ref"]=kt(f),o}function r(a,s){return ai(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=Yt(a["!ref"]),o,u=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var m=wt({r:f,c:d});o=u?(a[f]||[])[d]:a[m],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(as(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function NK(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function cu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function IK(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),l=a-s;if(l===0)return[0,0,t];var o=0,u=0,f=a+s;switch(u=l/(f>1?2-f:f),a){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,u,f/2]}function QK(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,l=[s,s,s],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=a*o,l[0]+=a,l[1]+=u;break;case 1:u=a*(2-o),l[0]+=u,l[1]+=a;break;case 2:u=a*(o-2),l[1]+=a,l[2]+=u;break;case 3:u=a*(4-o),l[1]+=u,l[2]+=a;break;case 4:u=a*(o-4),l[2]+=a,l[0]+=u;break;case 5:u=a*(6-o),l[2]+=u,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function hd(e,t){if(t===0)return e;var r=IK(NK(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),cu(QK(r))}var Xb=6,RK=15,DK=1,Hn=Xb;function uu(e){return Math.floor((e+Math.round(128/Hn)/256)*Hn)}function fu(e){return Math.floor((e-5)/Hn*100+.5)/100}function gd(e){return Math.round((e*Hn+5)/Hn*256)/256}function Qm(e){return gd(fu(uu(e)))}function zx(e){var t=Math.abs(e-Qm(e)),r=Hn;if(t>.005)for(Hn=DK;Hn<RK;++Hn)Math.abs(e-Qm(e))<=t&&(t=Math.abs(e-Qm(e)),r=Hn);Hn=r}function qs(e){e.width?(e.wpx=uu(e.width),e.wch=fu(e.wpx),e.MDW=Hn):e.wpx?(e.wch=fu(e.wpx),e.width=gd(e.wch),e.MDW=Hn):typeof e.wch=="number"&&(e.width=gd(e.wch),e.wpx=uu(e.width),e.MDW=Hn),e.customWidth&&delete e.customWidth}var MK=96,Jb=MK;function du(e){return e*96/Jb}function fo(e){return e*Jb/96}var LK={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function HK(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Kn)||[]).forEach(function(l){var o=yt(l);switch(TA(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=kr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=kr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function OK(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Kn)||[]).forEach(function(l){var o=yt(l);switch(TA(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function PK(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Kn)||[]).forEach(function(l){var o=yt(l);switch(TA(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=yr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?kr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?kr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?kr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?kr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?kr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?kr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?kr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=wx[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=kr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var u=Li[a.color.index];a.color.index==81&&(u=Li[1]),u||(u=Li[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=hd(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function GK(e,t,r){t.NumberFmt=[];for(var n=Kr(xt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=xt[n[a]];var s=e[0].match(Kn);if(s)for(a=0;a<s.length;++a){var l=yt(s[a]);switch(TA(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Wt(yr(l.formatCode)),u=parseInt(l.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}ZA(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function VK(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ke("numFmt",null,{numFmtId:n,formatCode:dr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Bf=["numFmtId","fillId","fontId","borderId","xfId"],Cf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function KK(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Kn)||[]).forEach(function(s){var l=yt(s),o=0;switch(TA(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=parseInt(n[Bf[o]],10));for(o=0;o<Cf.length;++o)n[Cf[o]]&&(n[Cf[o]]=kr(n[Cf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};l.vertical&&(u.vertical=l.vertical),l.horizontal&&(u.horizontal=l.horizontal),l.textRotation!=null&&(u.textRotation=l.textRotation),l.indent&&(u.indent=l.indent),l.wrapText&&(u.wrapText=kr(l.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function jK(e){var t=[];return t[t.length]=Ke("cellXfs",null),e.forEach(function(r){t[t.length]=Ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var zK=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=o.match(t))&&GK(m,d,f),(m=o.match(a))&&PK(m,d,u,f),(m=o.match(n))&&OK(m,d,u,f),(m=o.match(s))&&HK(m,d,u,f),(m=o.match(r))&&KK(m,d,f),d}})();function Wb(e,t){var r=[$r,Ke("styleSheet",null,{xmlns:Yi[0],"xmlns:vt":dn.vt})],n;return e.SSF&&(n=VK(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=jK(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function XK(e,t){var r=e.read_shift(2),n=Gn(e);return[r,n]}function JK(e,t,r){r||(r=_e(6+4*t.length)),r.write_shift(2,e),vn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function WK(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=U9(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=F9(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gn(e),n}function YK(e,t){t||(t=_e(153)),t.write_shift(2,e.sz*20),k9(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ud(e.color,t);var n=0;return n=2,t.write_shift(1,n),vn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var qK=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rm,$K=Vn;function b2(e,t){t||(t=_e(84)),Rm||(Rm=Hd(qK));var r=Rm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ud({auto:1},t),ud({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ZK(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Yb(e,t,r){r||(r=_e(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function yc(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ej=Vn;function tj(e,t){return t||(t=_e(51)),t.write_shift(1,0),yc(null,t),yc(null,t),yc(null,t),yc(null,t),yc(null,t),t.length>t.l?t.slice(0,t.l):t}function rj(e,t){return t||(t=_e(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),cd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function nj(e,t,r){var n=_e(2052);return n.write_shift(4,e),cd(t,n),cd(r,n),n.length>n.l?n.slice(0,n.l):n}function aj(e,t,r){var n={};n.NumberFmt=[];for(var a in xt)n.NumberFmt[a]=xt[a];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return os(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],ZA(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=hd(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(d),l=!0;break;case 38:s.pop(),l=!1;break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Aj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Qe(e,615,oA(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Qe(e,44,JK(a,t[a]))}),Qe(e,616))}}function sj(e){var t=1;Qe(e,611,oA(t)),Qe(e,43,YK({sz:12,color:{theme:1},name:"Calibri",family:2})),Qe(e,612)}function ij(e){var t=2;Qe(e,603,oA(t)),Qe(e,45,b2({patternType:"none"})),Qe(e,45,b2({patternType:"gray125"})),Qe(e,604)}function lj(e){var t=1;Qe(e,613,oA(t)),Qe(e,46,tj()),Qe(e,614)}function oj(e){var t=1;Qe(e,626,oA(t)),Qe(e,47,Yb({numFmtId:0},65535)),Qe(e,627)}function cj(e,t){Qe(e,617,oA(t.length)),t.forEach(function(r){Qe(e,47,Yb(r,0))}),Qe(e,618)}function uj(e){var t=1;Qe(e,619,oA(t)),Qe(e,48,rj({xfId:0,name:"Normal"})),Qe(e,620)}function fj(e){var t=0;Qe(e,505,oA(t)),Qe(e,506)}function dj(e){var t=0;Qe(e,508,nj(t,"TableStyleMedium9","PivotStyleMedium4")),Qe(e,509)}function hj(e,t){var r=ia();return Qe(r,278),Aj(r,e.SSF),sj(r),ij(r),lj(r),oj(r),cj(r,t.cellXfs),uj(r),fj(r),dj(r),Qe(r,279),r.end()}var gj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mj(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kn)||[]).forEach(function(a){var s=yt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[gj.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function pj(){}function xj(){}var vj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,wj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Bj(e,t,r){t.themeElements={};var n;[["clrScheme",vj,mj],["fontScheme",wj,pj],["fmtScheme",yj,xj]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Cj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function qb(e,t){(!e||e.length===0)&&(e=Xx());var r,n={};if(!(r=e.match(Cj)))throw new Error("themeElements not found in theme");return Bj(r[0],n,t),n.raw=e,n}function Xx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[$r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ej(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=V_(s,{type:"array"})}catch{return}var o=wa(l,"theme/theme/theme1.xml",!0);if(o)return qb(o,r)}}function Sj(e){return e.read_shift(4)}function Tj(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=_j(e,4);break;case 2:t.xclrValue=Ub(e);break;case 3:t.xclrValue=Sj(e);break;case 4:e.l+=4;break}return e.l+=8,t}function _j(e,t){return Vn(e,t)}function bj(e,t){return Vn(e,t)}function Fj(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Tj(e);break;case 6:n[1]=bj(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Uj(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Fj(e,r-e.l));return{ixfe:n,ext:s}}function kj(e,t){t.forEach(function(r){r[0]})}function Nj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Gn(e)}}function Ij(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vn(e.name,t),t.slice(0,t.l)}function Qj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Rj(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Dj(e,t){var r=_e(8+2*t.length);return r.write_shift(4,e),vn(t,r),r.slice(0,r.l)}function Mj(e){return e.l+=4,e.read_shift(4)!=0}function Lj(e,t){var r=_e(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Hj(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],l=!1,o=2;return os(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){o==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):o==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:s.push(d),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Oj(){var e=ia();return Qe(e,332),Qe(e,334,oA(1)),Qe(e,335,Ij({name:"XLDAPR",version:12e4,flags:3496657072})),Qe(e,336),Qe(e,339,Dj(1,"XLDAPR")),Qe(e,52),Qe(e,35,oA(514)),Qe(e,4096,oA(0)),Qe(e,4097,Va(1)),Qe(e,36),Qe(e,53),Qe(e,340),Qe(e,337,Lj(1)),Qe(e,51,Rj([[1,0]])),Qe(e,338),Qe(e,333),e.end()}function Pj(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,l;return e.replace(Kn,function(o){var u=yt(o);switch(TA(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(l=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function $b(){var e=[$r];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Gj(e){var t=[];if(!e)return t;var r=1;return(e.match(Kn)||[]).forEach(function(n){var a=yt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Vj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=wt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Kj(e,t,r){var n=[];return os(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function jj(e,t,r,n){if(!e)return e;var a=n||{},s=!1;os(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function zj(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var to=1024;function Zb(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ke("xml",null,{"xmlns:v":pa.v,"xmlns:o":pa.o,"xmlns:x":pa.x,"xmlns:mv":pa.mv}).replace(/\/>/,">"),Ke("o:shapelayout",Ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ke("v:shapetype",[Ke("v:stroke",null,{joinstyle:"miter"}),Ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];to<e*1e3;)to+=1e3;return t.forEach(function(s){var l=Hr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?Ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ke("v:fill",u,o),d={on:"t",obscured:"t"};++to,a=a.concat(["<v:shape"+iu({id:"_x0000_s"+to,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ke("v:shadow",null,d),Ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Fn("x:AutoFill","False"),Fn("x:Row",String(l.r)),Fn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function F2(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(l){var o=Hr(l.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[l.ref]=s;var u=Yt(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=kt(u);f!==e["!ref"]&&(e["!ref"]=f)}s.c||(s.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var m=s.c.length-1;m>=0;--m){if(!r&&s.c[m].T)return;r&&!s.c[m].T&&s.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(d.a==n[m].id){d.a=n[m].name||d.a;break}}s.c.push(d)})}function Xj(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=yt(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Hr(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!m&&!!m[1]&&Kx(m[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),n.push(f)}}}}),n}function e4(e){var t=[$r,Ke("comments",null,{xmlns:Yi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=dr(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(a=r.indexOf(dr(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Fn("t",dr(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(Fn("t",dr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Jj(e,t){var r=[],n=!1,a={},s=0;return e.replace(Kn,function(o,u){var f=yt(o);switch(TA(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=u+o.length;break;case"</text>":a.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function Wj(e,t,r){var n=[$r,Ke("ThreadedComments",null,{xmlns:dn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var u={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=u.id:u.parentId=s,l.ID=u.id,l.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Ke("threadedComment",Fn("text",l.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function Yj(e,t){var r=[],n=!1;return e.replace(Kn,function(s){var l=yt(s);switch(TA(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function qj(e){var t=[$r,Ke("personList",null,{xmlns:dn.TCMNT,"xmlns:x":Yi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $j(e){var t={};t.iauthor=e.read_shift(4);var r=el(e);return t.rfx=r.s,t.ref=wt(r.s),e.l+=16,t}function Zj(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),Co(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ez=Gn;function tz(e){return vn(e.slice(0,54))}function rz(e,t){var r=[],n=[],a={},s=!1;return os(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function nz(e){var t=ia(),r=[];return Qe(t,628),Qe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Qe(t,632,tz(a.a)))})}),Qe(t,631),Qe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Hr(n[0]),e:Hr(n[0])};Qe(t,635,Zj([s,a])),a.t&&a.t.length>0&&Qe(t,637,S9(a)),Qe(t,636),delete a.iauthor})}),Qe(t,634),Qe(t,629),t.end()}var az="application/vnd.ms-office.vbaProject";function Az(e){var t=ut.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ut.utils.cfb_add(t,a,e.FileIndex[n].content)}}),ut.write(t)}function sz(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ut.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var t4=["xlsb","xlsm","xlam","biff8","xla"];function iz(){return{"!type":"dialog"}}function lz(){return{"!type":"dialog"}}function oz(){return{"!type":"macro"}}function cz(){return{"!type":"macro"}}var io=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,l){var o=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,a+(o?"":"$")+Lr(d)+(u?"":"$")+qr(f)}return function(a,s){return t=s,a.replace(e,r)}})(),Jx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Wx=(function(){return function(t,r){return t.replace(Jx,function(n,a,s,l,o,u){var f=Rx(l)-(s?0:r.c),d=Qx(u)-(o?0:r.r),m=d==0?"":o?d+1:"["+d+"]",x=f==0?"":s?f+1:"["+f+"]";return a+"R"+m+"C"+x})}})();function r4(e,t){return e.replace(Jx,function(r,n,a,s,l,o){return n+(a=="$"?a+s:Lr(Rx(s)+t.c))+(l=="$"?l+o:qr(Qx(o)+t.r))})}function uz(e,t,r){var n=la(t),a=n.s,s=Hr(r),l={r:s.r-a.r,c:s.c-a.c};return r4(e,l)}function fz(e){return e.length!=1}function U2(e){return e.replace(/_xlfn\./g,"")}function An(e){e.l+=1}function $s(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function n4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return a4(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),l=$s(e),o=$s(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function a4(e){var t=$s(e),r=$s(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function dz(e,t,r){if(r.biff<8)return a4(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=$s(e),l=$s(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function A4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return hz(e);var n=e.read_shift(r&&r.biff==12?4:2),a=$s(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function hz(e){var t=$s(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function gz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function mz(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pz(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:o}}function pz(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function xz(e,t,r){var n=(e[e.l++]&96)>>5,a=n4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function vz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=n4(e,s,r);return[n,a,l]}function wz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Bz(e,t,r){var n=(e[e.l++]&96)>>5,a=dz(e,t-1,r);return[n,a]}function Cz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function k2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Ez(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Sz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Tz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _z(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function bz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function s4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Fz(e){return e.read_shift(2),s4(e)}function Uz(e){return e.read_shift(2),s4(e)}function kz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=A4(e,0,r);return[n,a]}function Nz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=mz(e,0,r);return[n,a]}function Iz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=A4(e,0,r);return[n,a,s]}function Qz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[MX[a],o4[a],n]}function Rz(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Dz(e);return[a,(s[0]===0?o4:DX)[s[1]]]}function Dz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Mz(e,t,r){e.l+=r&&r.biff==2?3:4}function Lz(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Hz(e){return e.l++,cs[e.read_shift(1)]}function Oz(e){return e.l++,e.read_shift(2)}function Pz(e){return e.l++,e.read_shift(1)!==0}function Gz(e){return e.l++,On(e)}function Vz(e,t,r){return e.l++,Cu(e,t-1,r)}function Kz(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=cs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=On(e);break;case 2:r[1]=tl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function jz(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?el:Gd)(e));return a}function zz(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=a;++o)l[s][o]=Kz(e,r.biff);return l}function Xz(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Jz(e,t,r){if(r.biff==5)return Wz(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Wz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Yz(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function qz(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $z(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Zz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var eX=Vn,tX=Vn,rX=Vn;function Su(e,t,r){return e.l+=2,[gz(e)]}function Yx(e){return e.l+=6,[]}var nX=Su,aX=Yx,AX=Yx,sX=Su;function i4(e){return e.l+=2,[ln(e),e.read_shift(2)&1]}var iX=Su,lX=i4,oX=Yx,cX=Su,uX=Su,fX=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),l=fX[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:s}}function hX(e){return e.l+=2,[e.read_shift(4)]}function gX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function mX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function vX(e){return e.l+=4,[0,0]}var N2={1:{n:"PtgExp",f:Lz},2:{n:"PtgTbl",f:rX},3:{n:"PtgAdd",f:An},4:{n:"PtgSub",f:An},5:{n:"PtgMul",f:An},6:{n:"PtgDiv",f:An},7:{n:"PtgPower",f:An},8:{n:"PtgConcat",f:An},9:{n:"PtgLt",f:An},10:{n:"PtgLe",f:An},11:{n:"PtgEq",f:An},12:{n:"PtgGe",f:An},13:{n:"PtgGt",f:An},14:{n:"PtgNe",f:An},15:{n:"PtgIsect",f:An},16:{n:"PtgUnion",f:An},17:{n:"PtgRange",f:An},18:{n:"PtgUplus",f:An},19:{n:"PtgUminus",f:An},20:{n:"PtgPercent",f:An},21:{n:"PtgParen",f:An},22:{n:"PtgMissArg",f:An},23:{n:"PtgStr",f:Vz},26:{n:"PtgSheet",f:gX},27:{n:"PtgEndSheet",f:mX},28:{n:"PtgErr",f:Hz},29:{n:"PtgBool",f:Pz},30:{n:"PtgInt",f:Oz},31:{n:"PtgNum",f:Gz},32:{n:"PtgArray",f:Cz},33:{n:"PtgFunc",f:Qz},34:{n:"PtgFuncVar",f:Rz},35:{n:"PtgName",f:Xz},36:{n:"PtgRef",f:kz},37:{n:"PtgArea",f:xz},38:{n:"PtgMemArea",f:Yz},39:{n:"PtgMemErr",f:eX},40:{n:"PtgMemNoMem",f:tX},41:{n:"PtgMemFunc",f:qz},42:{n:"PtgRefErr",f:$z},43:{n:"PtgAreaErr",f:wz},44:{n:"PtgRefN",f:Nz},45:{n:"PtgAreaN",f:Bz},46:{n:"PtgMemAreaN",f:pX},47:{n:"PtgMemNoMemN",f:xX},57:{n:"PtgNameX",f:Jz},58:{n:"PtgRef3d",f:Iz},59:{n:"PtgArea3d",f:vz},60:{n:"PtgRefErr3d",f:Zz},61:{n:"PtgAreaErr3d",f:yz},255:{}},wX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yX={1:{n:"PtgElfLel",f:i4},2:{n:"PtgElfRw",f:cX},3:{n:"PtgElfCol",f:nX},6:{n:"PtgElfRwV",f:uX},7:{n:"PtgElfColV",f:sX},10:{n:"PtgElfRadical",f:iX},11:{n:"PtgElfRadicalS",f:oX},13:{n:"PtgElfColS",f:aX},15:{n:"PtgElfColSV",f:AX},16:{n:"PtgElfRadicalLel",f:lX},25:{n:"PtgList",f:dX},29:{n:"PtgSxName",f:hX},255:{}},BX={0:{n:"PtgAttrNoop",f:vX},1:{n:"PtgAttrSemi",f:bz},2:{n:"PtgAttrIf",f:Tz},4:{n:"PtgAttrChoose",f:Ez},8:{n:"PtgAttrGoto",f:Sz},16:{n:"PtgAttrSum",f:Mz},32:{n:"PtgAttrBaxcel",f:k2},33:{n:"PtgAttrBaxcel",f:k2},64:{n:"PtgAttrSpace",f:Fz},65:{n:"PtgAttrSpaceSemi",f:Uz},128:{n:"PtgAttrIfError",f:_z},255:{}};function Tu(e,t,r,n){if(n.biff<8)return Vn(e,t);for(var a=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=zz(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=jz(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&s.push(Vn(e,t)),s}function _u(e,t,r){for(var n=e.l+t,a,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],a=N2[s]||N2[wX[s]],(s===24||s===25)&&(a=(s===24?yX:BX)[e[e.l+1]]),!a||!a.f?Vn(e,t):l.push([a.n,a.f(e,t,r)]);return l}function CX(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var EX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function SX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function l4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function I2(e,t,r){var n=l4(e,t,r);return n=="#REF"?n:SX(n,r)}function Ln(e,t,r,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},o=[],u,f,d,m=0,x=0,y,E="";if(!e[0]||!e[0][0])return"";for(var C=-1,S="",T=0,F=e[0].length;T<F;++T){var _=e[0][T];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),C>=0){switch(e[0][C][1][0]){case 0:S=Gr(" ",e[0][C][1][1]);break;case 1:S=Gr("\r",e[0][C][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}f=f+S,C=-1}o.push(f+EX[_[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Vc(_[1][1],l,a),o.push(Kc(d,s));break;case"PtgRefN":d=r?Vc(_[1][1],r,a):_[1][1],o.push(Kc(d,s));break;case"PtgRef3d":m=_[1][1],d=Vc(_[1][2],l,a),E=I2(n,m,a),o.push(E+"!"+Kc(d,s));break;case"PtgFunc":case"PtgFuncVar":var Q=_[1][0],L=_[1][1];Q||(Q=0),Q&=127;var R=Q==0?[]:o.slice(-Q);o.length-=Q,L==="User"&&(L=R.shift()),o.push(L+"("+R.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":y=l2(_[1][1],r?{s:r}:l,a),o.push(km(y,a));break;case"PtgArea":y=l2(_[1][1],l,a),o.push(km(y,a));break;case"PtgArea3d":m=_[1][1],y=_[1][2],E=I2(n,m,a),o.push(E+"!"+km(y,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=_[1][2];var U=(n.names||[])[x-1]||(n[0]||[])[x],K=U?U.Name:"SH33TJSNAME"+String(x);K&&K.slice(0,6)=="_xlfn."&&!a.xlfn&&(K=K.slice(6)),o.push(K);break;case"PtgNameX":var D=_[1][1];x=_[1][2];var ee;if(a.biff<=5)D<0&&(D=-D),n[D]&&(ee=n[D][x]);else{var re="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][x]&&n[D][x].itab>0&&(re=n.SheetNames[n[D][x].itab-1]+"!"):re=n.SheetNames[x-1]+"!"),n[D]&&n[D][x])re+=n[D][x].Name;else if(n[0]&&n[0][x])re+=n[0][x].Name;else{var Z=(l4(n,D,a)||"").split(";;");Z[x-1]?re=Z[x-1]:re+="SH33TJSERRX"}o.push(re);break}ee||(ee={Name:"SH33TJSERRY"}),o.push(ee.Name);break;case"PtgParen":var ae="(",Te=")";if(C>=0){switch(S="",e[0][C][1][0]){case 2:ae=Gr(" ",e[0][C][1][1])+ae;break;case 3:ae=Gr("\r",e[0][C][1][1])+ae;break;case 4:Te=Gr(" ",e[0][C][1][1])+Te;break;case 5:Te=Gr("\r",e[0][C][1][1])+Te;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}C=-1}o.push(ae+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[wt(d)]){var q=n.sharedf[wt(d)];o.push(Ln(q,l,Se,n,a))}else{var Ae=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(Ln(f[1],l,Se,n,a)),Ae=!0;break}Ae||o.push(_[1])}break;case"PtgArray":o.push("{"+CX(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":C=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&C>=0&&Re.indexOf(e[0][T][0])==-1){_=e[0][C];var ie=!0;switch(_[1][0]){case 4:ie=!1;case 0:S=Gr(" ",_[1][1]);break;case 5:ie=!1;case 1:S=Gr("\r",_[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((ie?S:"")+o.pop()+(ie?"":S)),C=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function TX(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],Vn(e,t-2)];var o=_u(e,l,r);return t!==l+a&&(s=Tu(e,t-l-a,o,r)),e.l=n,[o,s]}function _X(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],Vn(e,t-2)];var o=_u(e,l,r);return t!==l+a&&(s=Tu(e,t-l-a,o,r)),e.l=n,[o,s]}function bX(e,t,r,n){var a=e.l+t,s=_u(e,n,r),l;return a!==e.l&&(l=Tu(e,a-e.l,s,r)),[s,l]}function FX(e,t,r){var n=e.l+t,a,s=e.read_shift(2),l=_u(e,s,r);return s==65535?[[],Vn(e,t-2)]:(t!==s+2&&(a=Tu(e,n-s-2,l,r)),[l,a])}function UX(e){var t;if(WA(e,e.l+6)!==65535)return[On(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function kX(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ki(e);return Ki(0)}function Dm(e,t,r){var n=e.l+t,a=_A(e);r.biff==2&&++e.l;var s=UX(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=_X(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function NX(e,t,r,n,a){var s=zi(t,r,a),l=kX(e.v),o=_e(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var f=_e(e.bf.length),d=0;d<e.bf.length;++d)f[d]=e.bf[d];var m=xn([s,l,o,f]);return m}function Vd(e,t,r){var n=e.read_shift(4),a=_u(e,n,r),s=e.read_shift(4),l=s>0?Tu(e,s,a,r):null;return[a,l]}var IX=Vd,Kd=Vd,QX=Vd,RX=Vd,DX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},o4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},MX={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Q2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function LX(e){var t="of:="+e.replace(Jx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Mm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function HX(e){return e.replace(/\./,"!")}var zc={},lo={},Xc=typeof Map<"u";function qx(e,t,r){var n=0,a=e.length;if(r){if(Xc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Xc?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Xc?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function jd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Hn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=fu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=gd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Pi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ai(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){ZA(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function c4(e,t,r,n,a,s){try{n.cellNF&&(e.z=xt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Nr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(xt[t]==null&&ZA(D7[t]||"General",t),e.t==="e")e.w=e.w||cs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v);else if(e.t==="d"){var l=hn(e.v);(l|0)===l?e.w=l.toString(10):e.w=Au(l)}else{if(e.v===void 0)return"";e.w=Gi(e.v,lo)}else e.t==="d"?e.w=Ya(t,hn(e.v),lo):e.w=Ya(t,e.v,lo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hd(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hd(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function OX(e,t,r){if(e&&e["!ref"]){var n=Yt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function PX(e,t){var r=Yt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=kt(r))}var GX=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,VX=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,KX=/<(?:\w:)?hyperlink [^>]*>/mg,jX=/"(\w*:\w*)"/,zX=/<(?:\w:)?col\b[^>]*[\/]?>/g,XX=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JX=/<(?:\w:)?pageMargins[^>]*\/>/g,u4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,WX=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,YX=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qX(e,t,r,n,a,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",m=e.match(VX);m?(f=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):f=d=e;var x=f.match(u4);x?$x(x[0],o,a,r):(x=f.match(WX))&&ZX(x[0],x[1]||"",o,a,r);var y=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var E=f.slice(y,y+50).match(jX);E&&PX(o,E[1])}var C=f.match(YX);C&&C[1]&&fJ(C[1],a);var S=[];if(t.cellStyles){var T=f.match(zX);T&&iJ(S,T)}m&&gJ(m[1],o,t,u,s,l);var F=d.match(XX);F&&(o["!autofilter"]=oJ(F[0]));var _=[],Q=d.match(GX);if(Q)for(y=0;y!=Q.length;++y)_[y]=Yt(Q[y].slice(Q[y].indexOf('"')+1));var L=d.match(KX);L&&aJ(o,L,n);var R=d.match(JX);if(R&&(o["!margins"]=AJ(yt(R[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=kt(u)),t.sheetRows>0&&o["!ref"]){var U=Yt(o["!ref"]);t.sheetRows<=+U.e.r&&(U.e.r=t.sheetRows-1,U.e.r>u.e.r&&(U.e.r=u.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>u.e.c&&(U.e.c=u.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),o["!fullref"]=o["!ref"],o["!ref"]=kt(U))}return S.length>0&&(o["!cols"]=S),_.length>0&&(o["!merges"]=_),o}function $X(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+kt(e[r])+'"/>';return t+"</mergeCells>"}function $x(e,t,r,n){var a=yt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Wt(yr(a.codeName)))}function ZX(e,t,r,n,a){$x(e.slice(0,e.indexOf(">")),r,n,a)}function eJ(e,t,r,n,a){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,l.codeName=BA(dr(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),o=(o||"")+Ke("outlinePr",null,f)}!s&&!o||(a[a.length]=Ke("sheetPr",o,l))}var tJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],rJ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function nJ(e){var t={sheet:1};return tJ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),rJ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=jx(e.password).toString(16).toUpperCase()),Ke("sheetProtection",null,t)}function aJ(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=yt(yr(t[a]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Wt(s.location))):(s.Target="#"+Wt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Yt(s.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=wt({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function AJ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function sJ(e){return Pi(e),Ke("pageMargins",null,e)}function iJ(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=yt(t[n],!0);a.hidden&&(a.hidden=kr(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,zx(a.width)),qs(a);s<=l;)e[s++]=Ir(a)}}function lJ(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ke("col",null,jd(a,n)));return r[r.length]="</cols>",r.join("")}function oJ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function cJ(e,t,r,n){var a=typeof e.ref=="string"?e.ref:kt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=la(a);l.s.r==l.e.r&&(l.e.r=la(t["!ref"]).e.r,a=kt(l));for(var o=0;o<s.length;++o){var u=s[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ke("autoFilter",null,{ref:a})}var uJ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fJ(e,t){t.Views||(t.Views=[{}]),(e.match(uJ)||[]).forEach(function(r,n){var a=yt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),kr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function dJ(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ke("sheetViews",Ke("sheetView",null,a),{})}function hJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=cs[e.v];break;case"d":n&&n.cellDates?a=Nr(e.v,-1).toISOString():(e=Ir(e),e.t="n",a=""+(e.v=hn(Nr(e.v)))),typeof e.z>"u"&&(e.z=xt[14]);break;default:a=e.v;break}var o=Fn("v",dr(a)),u={r:t},f=Ai(n.cellXfs,e,n);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Fn("v",""+qx(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ke("f",dr(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Ke("c",o,u)}var gJ=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=su("v"),l=su("f");return function(u,f,d,m,x,y){for(var E=0,C="",S=[],T=[],F=0,_=0,Q=0,L="",R,U,K=0,D=0,ee,re,Z=0,ae=0,Te=Array.isArray(y.CellXf),Se,q=[],Ae=[],Re=Array.isArray(f),ie=[],Me={},J=!1,k=!!d.sheetStubs,V=u.split(t),P=0,z=V.length;P!=z;++P){C=V[P].trim();var le=C.length;if(le!==0){var Be=0;e:for(E=0;E<le;++E)switch(C[E]){case">":if(C[E-1]!="/"){++E;break e}if(d&&d.cellStyles){if(U=yt(C.slice(Be,E),!0),K=U.r!=null?parseInt(U.r,10):K+1,D=-1,d.sheetRows&&d.sheetRows<K)continue;Me={},J=!1,U.ht&&(J=!0,Me.hpt=parseFloat(U.ht),Me.hpx=fo(Me.hpt)),U.hidden=="1"&&(J=!0,Me.hidden=!0),U.outlineLevel!=null&&(J=!0,Me.level=+U.outlineLevel),J&&(ie[K-1]=Me)}break;case"<":Be=E;break}if(Be>=E)break;if(U=yt(C.slice(Be,E),!0),K=U.r!=null?parseInt(U.r,10):K+1,D=-1,!(d.sheetRows&&d.sheetRows<K)){m.s.r>K-1&&(m.s.r=K-1),m.e.r<K-1&&(m.e.r=K-1),d&&d.cellStyles&&(Me={},J=!1,U.ht&&(J=!0,Me.hpt=parseFloat(U.ht),Me.hpx=fo(Me.hpt)),U.hidden=="1"&&(J=!0,Me.hidden=!0),U.outlineLevel!=null&&(J=!0,Me.level=+U.outlineLevel),J&&(ie[K-1]=Me)),S=C.slice(E).split(e);for(var de=0;de!=S.length&&S[de].trim().charAt(0)=="<";++de);for(S=S.slice(de),E=0;E!=S.length;++E)if(C=S[E].trim(),C.length!==0){if(T=C.match(r),F=E,_=0,Q=0,C="<c "+(C.slice(0,1)=="<"?">":"")+C,T!=null&&T.length===2){for(F=0,L=T[1],_=0;_!=L.length&&!((Q=L.charCodeAt(_)-64)<1||Q>26);++_)F=26*F+Q;--F,D=F}else++D;for(_=0;_!=C.length&&C.charCodeAt(_)!==62;++_);if(++_,U=yt(C.slice(0,_),!0),U.r||(U.r=wt({r:K-1,c:D})),L=C.slice(_),R={t:""},(T=L.match(s))!=null&&T[1]!==""&&(R.v=Wt(T[1])),d.cellFormula){if((T=L.match(l))!=null&&T[1]!==""){if(R.f=Wt(yr(T[1])).replace(/\r\n/g,`
`),d.xlfn||(R.f=U2(R.f)),T[0].indexOf('t="array"')>-1)R.F=(L.match(a)||[])[1],R.F.indexOf(":")>-1&&q.push([Yt(R.F),R.F]);else if(T[0].indexOf('t="shared"')>-1){re=yt(T[0]);var ce=Wt(yr(T[1]));d.xlfn||(ce=U2(ce)),Ae[parseInt(re.si,10)]=[re,ce,U.r]}}else(T=L.match(/<f[^>]*\/>/))&&(re=yt(T[0]),Ae[re.si]&&(R.f=uz(Ae[re.si][1],Ae[re.si][2],U.r)));var ne=Hr(U.r);for(_=0;_<q.length;++_)ne.r>=q[_][0].s.r&&ne.r<=q[_][0].e.r&&ne.c>=q[_][0].s.c&&ne.c<=q[_][0].e.c&&(R.F=q[_][1])}if(U.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(k)R.t="z";else continue;else R.t=U.t||"n";switch(m.s.c>D&&(m.s.c=D),m.e.c<D&&(m.e.c=D),R.t){case"n":if(R.v==""||R.v==null){if(!k)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!k)continue;R.t="z"}else ee=zc[parseInt(R.v,10)],R.v=ee.t,R.r=ee.r,d.cellHTML&&(R.h=ee.h);break;case"str":R.t="s",R.v=R.v!=null?yr(R.v):"",d.cellHTML&&(R.h=Ux(R.v));break;case"inlineStr":T=L.match(n),R.t="s",T!=null&&(ee=Kx(T[1]))?(R.v=ee.t,d.cellHTML&&(R.h=ee.h)):R.v="";break;case"b":R.v=kr(R.v);break;case"d":d.cellDates?R.v=Nr(R.v,1):(R.v=hn(Nr(R.v,1)),R.t="n");break;case"e":(!d||d.cellText!==!1)&&(R.w=R.v),R.v=db[R.v];break}if(Z=ae=0,Se=null,Te&&U.s!==void 0&&(Se=y.CellXf[U.s],Se!=null&&(Se.numFmtId!=null&&(Z=Se.numFmtId),d.cellStyles&&Se.fillId!=null&&(ae=Se.fillId))),c4(R,Z,ae,d,x,y),d.cellDates&&Te&&R.t=="n"&&wo(xt[Z])&&(R.t="d",R.v=Pd(R.v)),U.cm&&d.xlmeta){var Ce=(d.xlmeta.Cell||[])[+U.cm-1];Ce&&Ce.type=="XLDAPR"&&(R.D=!0)}if(Re){var N=Hr(U.r);f[N.r]||(f[N.r]=[]),f[N.r][N.c]=R}else f[U.r]=R}}}}ie.length>0&&(f["!rows"]=ie)}})();function mJ(e,t,r,n){var a=[],s=[],l=Yt(e["!ref"]),o="",u,f="",d=[],m=0,x=0,y=e["!rows"],E=Array.isArray(e),C={r:f},S,T=-1;for(x=l.s.c;x<=l.e.c;++x)d[x]=Lr(x);for(m=l.s.r;m<=l.e.r;++m){for(s=[],f=qr(m),x=l.s.c;x<=l.e.c;++x){u=d[x]+f;var F=E?(e[m]||[])[x]:e[u];F!==void 0&&(o=hJ(F,u,e,t))!=null&&s.push(o)}(s.length>0||y&&y[m])&&(C={r:f},y&&y[m]&&(S=y[m],S.hidden&&(C.hidden=1),T=-1,S.hpx?T=du(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(C.ht=T,C.customHeight=1),S.level&&(C.outlineLevel=S.level)),a[a.length]=Ke("row",s.join(""),C))}if(y)for(;m<y.length;++m)y&&y[m]&&(C={r:m+1},S=y[m],S.hidden&&(C.hidden=1),T=-1,S.hpx?T=du(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(C.ht=T,C.customHeight=1),S.level&&(C.outlineLevel=S.level),a[a.length]=Ke("row","",C));return a.join("")}function f4(e,t,r,n){var a=[$r,Ke("worksheet",null,{xmlns:Yi[0],"xmlns:r":dn.r})],s=r.SheetNames[e],l=0,o="",u=r.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",d=Yt(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=kt(d)}n||(n={}),u["!comments"]=[];var m=[];eJ(u,r,e,t,a),a[a.length]=Ke("dimension",null,{ref:f}),a[a.length]=dJ(u,t,e,r),t.sheetFormat&&(a[a.length]=Ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(a[a.length]=lJ(u,u["!cols"])),a[l=a.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=mJ(u,t),o.length>0&&(a[a.length]=o)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),u["!protect"]&&(a[a.length]=nJ(u["!protect"])),u["!autofilter"]!=null&&(a[a.length]=cJ(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(a[a.length]=$X(u["!merges"]));var x=-1,y,E=-1;return u["!links"].length>0&&(a[a.length]="<hyperlinks>",u["!links"].forEach(function(C){C[1].Target&&(y={ref:C[0]},C[1].Target.charAt(0)!="#"&&(E=fr(n,-1,dr(C[1].Target).replace(/#.*$/,""),Lt.HLINK),y["r:id"]="rId"+E),(x=C[1].Target.indexOf("#"))>-1&&(y.location=dr(C[1].Target.slice(x+1))),C[1].Tooltip&&(y.tooltip=dr(C[1].Tooltip)),a[a.length]=Ke("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(a[a.length]=sJ(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Fn("ignoredErrors",Ke("ignoredError",null,{numberStoredAsText:1,sqref:f}))),m.length>0&&(E=fr(n,-1,"../drawings/drawing"+(e+1)+".xml",Lt.DRAW),a[a.length]=Ke("drawing",null,{"r:id":"rId"+E}),u["!drawing"]=m),u["!comments"].length>0&&(E=fr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Lt.VML),a[a.length]=Ke("legacyDrawing",null,{"r:id":"rId"+E}),u["!legacy"]=E),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function pJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function xJ(e,t,r){var n=_e(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=du(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,u=n.l;n.l+=4;for(var f={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,x=-1,y=d<<10;y<d+1<<10;++y){f.c=y;var E=Array.isArray(r)?(r[f.r]||[])[f.c]:r[wt(f)];E&&(m<0&&(m=y),x=y)}m<0||(++o,n.write_shift(4,m),n.write_shift(4,x))}var C=n.l;return n.l=u,n.write_shift(4,o),n.l=C,n.length>n.l?n.slice(0,n.l):n}function vJ(e,t,r,n){var a=xJ(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Qe(e,0,a)}var wJ=el,yJ=Co;function BJ(){}function CJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=T9(e),r}function EJ(e,t,r){r==null&&(r=_e(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return ud({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),lb(e,r),r.slice(0,r.l)}function SJ(e){var t=qa(e);return[t]}function TJ(e,t,r){return r==null&&(r=_e(8)),qi(t,r)}function _J(e){var t=$i(e);return[t]}function bJ(e,t,r){return r==null&&(r=_e(4)),Zi(t,r)}function FJ(e){var t=qa(e),r=e.read_shift(1);return[t,r,"b"]}function UJ(e,t,r){return r==null&&(r=_e(9)),qi(t,r),r.write_shift(1,e.v?1:0),r}function kJ(e){var t=$i(e),r=e.read_shift(1);return[t,r,"b"]}function NJ(e,t,r){return r==null&&(r=_e(5)),Zi(t,r),r.write_shift(1,e.v?1:0),r}function IJ(e){var t=qa(e),r=e.read_shift(1);return[t,r,"e"]}function QJ(e,t,r){return r==null&&(r=_e(9)),qi(t,r),r.write_shift(1,e.v),r}function RJ(e){var t=$i(e),r=e.read_shift(1);return[t,r,"e"]}function DJ(e,t,r){return r==null&&(r=_e(8)),Zi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function MJ(e){var t=qa(e),r=e.read_shift(4);return[t,r,"s"]}function LJ(e,t,r){return r==null&&(r=_e(12)),qi(t,r),r.write_shift(4,t.v),r}function HJ(e){var t=$i(e),r=e.read_shift(4);return[t,r,"s"]}function OJ(e,t,r){return r==null&&(r=_e(8)),Zi(t,r),r.write_shift(4,t.v),r}function PJ(e){var t=qa(e),r=On(e);return[t,r,"n"]}function GJ(e,t,r){return r==null&&(r=_e(16)),qi(t,r),Ki(e.v,r),r}function d4(e){var t=$i(e),r=On(e);return[t,r,"n"]}function VJ(e,t,r){return r==null&&(r=_e(12)),Zi(t,r),Ki(e.v,r),r}function KJ(e){var t=qa(e),r=Hx(e);return[t,r,"n"]}function jJ(e,t,r){return r==null&&(r=_e(12)),qi(t,r),ob(e.v,r),r}function zJ(e){var t=$i(e),r=Hx(e);return[t,r,"n"]}function XJ(e,t,r){return r==null&&(r=_e(8)),Zi(t,r),ob(e.v,r),r}function JJ(e){var t=qa(e),r=Dx(e);return[t,r,"is"]}function WJ(e){var t=qa(e),r=Gn(e);return[t,r,"str"]}function YJ(e,t,r){return r==null&&(r=_e(12+4*e.v.length)),qi(t,r),vn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function qJ(e){var t=$i(e),r=Gn(e);return[t,r,"str"]}function $J(e,t,r){return r==null&&(r=_e(8+4*e.v.length)),Zi(t,r),vn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ZJ(e,t,r){var n=e.l+t,a=qa(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=Kd(e,n-e.l,r);l[3]=Ln(o,null,a,r.supbooks,r)}else e.l=n;return l}function eW(e,t,r){var n=e.l+t,a=qa(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=Kd(e,n-e.l,r);l[3]=Ln(o,null,a,r.supbooks,r)}else e.l=n;return l}function tW(e,t,r){var n=e.l+t,a=qa(e);a.r=r["!row"];var s=On(e),l=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=Kd(e,n-e.l,r);l[3]=Ln(o,null,a,r.supbooks,r)}else e.l=n;return l}function rW(e,t,r){var n=e.l+t,a=qa(e);a.r=r["!row"];var s=Gn(e),l=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=Kd(e,n-e.l,r);l[3]=Ln(o,null,a,r.supbooks,r)}else e.l=n;return l}var nW=el,aW=Co;function AW(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function sW(e,t){var r=e.l+t,n=el(e),a=Mx(e),s=Gn(e),l=Gn(e),o=Gn(e);e.l=r;var u={rfx:n,relId:a,loc:s,display:o};return l&&(u.Tooltip=l),u}function iW(e,t){var r=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Co({s:Hr(e[0]),e:Hr(e[0])},r),Lx("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return vn(a||"",r),vn(e[1].Tooltip||"",r),vn("",r),r.slice(0,r.l)}function lW(){}function oW(e,t,r){var n=e.l+t,a=cb(e),s=e.read_shift(1),l=[a];if(l[2]=s,r.cellFormula){var o=IX(e,n-e.l,r);l[1]=o}else e.l=n;return l}function cW(e,t,r){var n=e.l+t,a=el(e),s=[a];if(r.cellFormula){var l=RX(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function uW(e,t,r){r==null&&(r=_e(18));var n=jd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var h4=["left","right","top","bottom","header","footer"];function fW(e){var t={};return h4.forEach(function(r){t[r]=On(e)}),t}function dW(e,t){return t==null&&(t=_e(48)),Pi(e),h4.forEach(function(r){Ki(e[r],t)}),t}function hW(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function gW(e,t,r){r==null&&(r=_e(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function mW(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),Co(e,t),t}function pW(e,t){return t==null&&(t=_e(66)),t.write_shift(2,e.password?jx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function xW(){}function vW(){}function wW(e,t,r,n,a,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,x=!1,y,E,C,S,T,F,_,Q,L,R=[];o.biff=12,o["!row"]=0;var U=0,K=!1,D=[],ee={},re=o.supbooks||a.supbooks||[[]];if(re.sharedf=ee,re.arrayf=D,re.SheetNames=a.SheetNames||a.Sheets.map(function(Re){return Re.name}),!o.supbooks&&(o.supbooks=re,a.Names))for(var Z=0;Z<a.Names.length;++Z)re[0][Z+1]=a.Names[Z];var ae=[],Te=[],Se=!1;hu[16]={n:"BrtShortReal",f:d4};var q;if(os(e,function(ie,Me,J){if(!x)switch(J){case 148:f=ie;break;case 0:y=ie,o.sheetRows&&o.sheetRows<=y.r&&(x=!0),Q=qr(S=y.r),o["!row"]=y.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=fo(ie.hpt)),Te[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:ie[2]},ie[2]){case"n":E.v=ie[1];break;case"s":_=zc[ie[1]],E.v=_.t,E.r=_.r;break;case"b":E.v=!!ie[1];break;case"e":E.v=ie[1],o.cellText!==!1&&(E.w=cs[E.v]);break;case"str":E.t="s",E.v=ie[1];break;case"is":E.t="s",E.v=ie[1].t;break}if((C=l.CellXf[ie[0].iStyleRef])&&c4(E,C.numFmtId,null,o,s,l),T=ie[0].c==-1?T+1:ie[0].c,o.dense?(u[S]||(u[S]=[]),u[S][T]=E):u[Lr(T)+Q]=E,o.cellFormula){for(K=!1,U=0;U<D.length;++U){var k=D[U];y.r>=k[0].s.r&&y.r<=k[0].e.r&&T>=k[0].s.c&&T<=k[0].e.c&&(E.F=kt(k[0]),K=!0)}!K&&ie.length>3&&(E.f=ie[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>T&&(d.s.c=T),d.e.r<y.r&&(d.e.r=y.r),d.e.c<T&&(d.e.c=T),o.cellDates&&C&&E.t=="n"&&wo(xt[C.numFmtId])){var V=Ri(E.v);V&&(E.t="d",E.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}q&&(q.type=="XLDAPR"&&(E.D=!0),q=void 0);break;case 1:case 12:if(!o.sheetStubs||m)break;E={t:"z",v:void 0},T=ie[0].c==-1?T+1:ie[0].c,o.dense?(u[S]||(u[S]=[]),u[S][T]=E):u[Lr(T)+Q]=E,d.s.r>y.r&&(d.s.r=y.r),d.s.c>T&&(d.s.c=T),d.e.r<y.r&&(d.e.r=y.r),d.e.c<T&&(d.e.c=T),q&&(q.type=="XLDAPR"&&(E.D=!0),q=void 0);break;case 176:R.push(ie);break;case 49:q=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var P=n["!id"][ie.relId];for(P?(ie.Target=P.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=P):ie.relId==""&&(ie.Target="#"+ie.loc),S=ie.rfx.s.r;S<=ie.rfx.e.r;++S)for(T=ie.rfx.s.c;T<=ie.rfx.e.c;++T)o.dense?(u[S]||(u[S]=[]),u[S][T]||(u[S][T]={t:"z",v:void 0}),u[S][T].l=ie):(F=wt({c:T,r:S}),u[F]||(u[F]={t:"z",v:void 0}),u[F].l=ie);break;case 426:if(!o.cellFormula)break;D.push(ie),L=o.dense?u[S][T]:u[Lr(T)+Q],L.f=Ln(ie[1],d,{r:y.r,c:T},re,o),L.F=kt(ie[0]);break;case 427:if(!o.cellFormula)break;ee[wt(ie[0].s)]=ie[1],L=o.dense?u[S][T]:u[Lr(T)+Q],L.f=Ln(ie[1],d,{r:y.r,c:T},re,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)ae[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Se||(Se=!0,zx(ie.w/256)),qs(ae[ie.e+1]);break;case 161:u["!autofilter"]={ref:kt(ie)};break;case 476:u["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(u["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!Me.T){if(!m||o.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=kt(f||d)),o.sheetRows&&u["!ref"]){var Ae=Yt(u["!ref"]);o.sheetRows<=+Ae.e.r&&(Ae.e.r=o.sheetRows-1,Ae.e.r>d.e.r&&(Ae.e.r=d.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>d.e.c&&(Ae.e.c=d.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),u["!fullref"]=u["!ref"],u["!ref"]=kt(Ae))}return R.length>0&&(u["!merges"]=R),ae.length>0&&(u["!cols"]=ae),Te.length>0&&(u["!rows"]=Te),u}function yW(e,t,r,n,a,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Ir(t),t.z=t.z||xt[14],t.v=hn(Nr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var u={r,c:n};switch(u.s=Ai(a.cellXfs,t,a),t.l&&s["!links"].push([wt(u),t.l]),t.c&&s["!comments"].push([wt(u),t.c]),t.t){case"s":case"str":return a.bookSST?(o=qx(a.Strings,t.v,a.revStrings),u.t="s",u.v=o,l?Qe(e,18,OJ(t,u)):Qe(e,7,LJ(t,u))):(u.t="str",l?Qe(e,17,$J(t,u)):Qe(e,6,YJ(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Qe(e,13,XJ(t,u)):Qe(e,2,jJ(t,u)):l?Qe(e,16,VJ(t,u)):Qe(e,5,GJ(t,u)),!0;case"b":return u.t="b",l?Qe(e,15,NJ(t,u)):Qe(e,4,UJ(t,u)),!0;case"e":return u.t="e",l?Qe(e,14,DJ(t,u)):Qe(e,3,QJ(t,u)),!0}return l?Qe(e,12,bJ(t,u)):Qe(e,1,TJ(t,u)),!0}function BW(e,t,r,n){var a=Yt(t["!ref"]||"A1"),s,l="",o=[];Qe(e,145);var u=Array.isArray(t),f=a.e.r;t["!rows"]&&(f=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=f;++d){l=qr(d),vJ(e,t,a,d);var m=!1;if(d<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){d===a.s.r&&(o[x]=Lr(x)),s=o[x]+l;var y=u?(t[d]||[])[x]:t[s];if(!y){m=!1;continue}m=yW(e,y,d,x,n,t,m)}}Qe(e,146)}function CW(e,t){!t||!t["!merges"]||(Qe(e,177,AW(t["!merges"].length)),t["!merges"].forEach(function(r){Qe(e,176,aW(r))}),Qe(e,178))}function EW(e,t){!t||!t["!cols"]||(Qe(e,390),t["!cols"].forEach(function(r,n){r&&Qe(e,60,uW(n,r))}),Qe(e,391))}function SW(e,t){!t||!t["!ref"]||(Qe(e,648),Qe(e,649,mW(Yt(t["!ref"]))),Qe(e,650))}function TW(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=fr(r,-1,n[1].Target.replace(/#.*$/,""),Lt.HLINK);Qe(e,494,iW(n,a))}}),delete t["!links"]}function _W(e,t,r,n){if(t["!comments"].length>0){var a=fr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Lt.VML);Qe(e,551,Lx("rId"+a)),t["!legacy"]=a}}function bW(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:kt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=la(s);o.s.r==o.e.r&&(o.e.r=la(t["!ref"]).e.r,s=kt(o));for(var u=0;u<l.length;++u){var f=l[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+s;break}}u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Qe(e,161,Co(Yt(s))),Qe(e,162)}}function FW(e,t,r){Qe(e,133),Qe(e,137,gW(t,r)),Qe(e,138),Qe(e,134)}function UW(e,t){t["!protect"]&&Qe(e,535,pW(t["!protect"]))}function kW(e,t,r,n){var a=ia(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var u=Yt(l["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Qe(a,129),(r.vbaraw||l["!outline"])&&Qe(a,147,EJ(o,l["!outline"])),Qe(a,148,yJ(u)),FW(a,l,r.Workbook),EW(a,l),BW(a,l,e,t),UW(a,l),bW(a,l,r,e),CW(a,l),TW(a,l,n),l["!margins"]&&Qe(a,476,dW(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&SW(a,l),_W(a,l,e,n),Qe(a,130),a.end()}function NW(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=Wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function IW(e,t,r,n,a,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var x=NW(m);d.s.r=d.s.c=0,d.e.c=o,f=Lr(o),x[0].forEach(function(y,E){l[f+qr(E)]={t:"n",v:y,z:x[1]},u=E}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(l["!ref"]=kt(d)),l}function QW(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(u4);return o&&$x(o[0],s,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function RW(e,t){e.l+=10;var r=Gn(e);return{name:r}}function DW(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return os(e,function(u,f,d){switch(d){case 550:s["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Zx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],MW=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],LW=[],HW=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function R2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=kr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function D2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=kr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function g4(e){D2(e.WBProps,Zx),D2(e.CalcPr,HW),R2(e.WBView,MW),R2(e.Sheets,LW),lo.date1904=kr(e.WBProps.date1904)}function OW(e){return!e.Workbook||!e.Workbook.WBProps?"false":kr(e.Workbook.WBProps.date1904)?"true":"false"}var PW="][*?/\\".split("");function m4(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return PW.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function GW(e,t,r){e.forEach(function(n,a){m4(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function VW(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];GW(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)OX(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var KW=/<\w+:workbook/;function jW(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},l=0;if(e.replace(Kn,function(u,f){var d=yt(u);switch(TA(d[0])){case"<?xml":break;case"<workbook":u.match(KW)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zx.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=kr(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=yr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Wt(yr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=yr(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),kr(d.hidden||"0")&&(s.Hidden=!0),l=f+u.length;break;case"</definedName>":s.Ref=Wt(yr(e.slice(l,f))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Yi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return g4(r),r}function p4(e){var t=[$r];t[t.length]=Ke("workbook",null,{xmlns:Yi[0],"xmlns:r":dn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zx.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ke("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:dr(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ke("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(t[t.length]=Ke("definedName",dr(o.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zW(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Lp(e),r.name=Gn(e),r}function XW(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Lx(e.strRelID,t),vn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function JW(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Gn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function WW(e,t){t||(t=_e(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),lb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function YW(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function qW(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=_9(e),l=QX(e,0,r),o=Mx(e);e.l=n;var u={Name:s,Ptg:l};return a<268435455&&(u.Sheet=a),o&&(u.Comment=o),u}function $W(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],hu[16]={n:"BrtFRTArchID$",f:YW},os(e,function(u,f,d){switch(d){case 156:l.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Ln(u.Ptg,null,null,l,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,u]):l[0]=[d,u],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(u),l.XTI=l.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),g4(r),r.Names=s,r.supbooks=l,r}function ZW(e,t){Qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Qe(e,156,XW(a))}Qe(e,144)}function eY(e,t){t||(t=_e(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return vn("SheetJS",t),vn(ad.version,t),vn(ad.version,t),vn("7262",t),t.length>t.l?t.slice(0,t.l):t}function tY(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function rY(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Qe(e,135),Qe(e,158,tY(a)),Qe(e,136))}}function nY(e,t){var r=ia();return Qe(r,131),Qe(r,128,eY()),Qe(r,153,WW(e.Workbook&&e.Workbook.WBProps||null)),rY(r,e),ZW(r,e),Qe(r,132),r.end()}function aY(e,t,r){return t.slice(-4)===".bin"?$W(e,r):jW(e,r)}function AY(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?wW(e,n,r,a,s,l,o):qX(e,n,r,a,s,l,o)}function sY(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?DW(e,n,r,a,s):QW(e,n,r,a,s)}function iY(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?oz():cz()}function lY(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?iz():lz()}function oY(e,t,r,n){return t.slice(-4)===".bin"?aj(e,r,n):zK(e,r,n)}function cY(e,t,r){return qb(e,r)}function uY(e,t,r){return t.slice(-4)===".bin"?uK(e,r):lK(e,r)}function fY(e,t,r){return t.slice(-4)===".bin"?rz(e,r):Xj(e,r)}function dY(e,t,r){return t.slice(-4)===".bin"?Kj(e):Gj(e)}function hY(e,t,r,n){return r.slice(-4)===".bin"?jj(e,t,r,n):void 0}function gY(e,t,r){return t.slice(-4)===".bin"?Hj(e,t,r):Pj(e,t,r)}function mY(e,t,r){return(t.slice(-4)===".bin"?nY:p4)(e)}function pY(e,t,r,n,a){return(t.slice(-4)===".bin"?kW:f4)(e,r,n,a)}function xY(e,t,r){return(t.slice(-4)===".bin"?hj:Wb)(e,r)}function vY(e,t,r){return(t.slice(-4)===".bin"?hK:Pb)(e,r)}function wY(e,t,r){return(t.slice(-4)===".bin"?nz:e4)(e)}function yY(e){return(e.slice(-4)===".bin"?Oj:$b)()}var x4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,v4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function rA(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(x4),s,l,o,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(v4),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function BY(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(x4),a,s,l,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(v4),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Jc;function CY(e,t){var r=Jc[e]||Wt(e);return r==="General"?Gi(t):Ya(r,t)}function EY(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=kr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Nr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Wt(t)]=a}function SY(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||cs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v):e.w=Gi(e.v):e.w=CY(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Jc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&wo(n)){var a=Ri(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function TY(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=LK[n.Pattern]||n.Pattern)}e[t.ID]=t}function _Y(e,t,r,n,a,s,l,o,u,f){var d="General",m=n.StyleID,x={};f=f||{};var y=[],E=0;for(m===void 0&&o&&(m=o.StyleID),m===void 0&&l&&(m=l.StyleID);s[m]!==void 0&&(s[m].nf&&(d=s[m].nf),s[m].Interior&&y.push(s[m].Interior),!!s[m].Parent);)m=s[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=kr(e);break;case"String":n.t="s",n.r=ZE(Wt(e)),n.v=e.indexOf("<")>-1?Wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Nr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Wt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=db[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=ZE(t||e));break}if(SY(n,d,f),f.cellFormula!==!1)if(n.Formula){var C=Wt(n.Formula);C.charCodeAt(0)==61&&(C=C.slice(1)),n.f=io(C,a),delete n.Formula,n.ArrayRange=="RC"?n.F=io("RC:RC",a):n.ArrayRange&&(n.F=io(n.ArrayRange,a),u.push([Yt(n.F),n.F]))}else for(E=0;E<u.length;++E)a.r>=u[E][0].s.r&&a.r<=u[E][0].e.r&&a.c>=u[E][0].s.c&&a.c<=u[E][0].e.c&&(n.F=u[E][1]);f.cellStyles&&(y.forEach(function(S){!x.patternType&&S.patternType&&(x.patternType=S.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function bY(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Lm(e,t){var r=t||{};yo();var n=Nc(kx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=yr(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Ir(r);return l.type="string",uo.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ft){a.indexOf("<"+ft)>=0&&(s=!0)}),s)return dq(n,r);Jc={"General Number":"General","General Date":xt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xt[15],"Short Date":xt[14],"Long Time":xt[19],"Medium Time":xt[18],"Short Time":xt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xt[2],Standard:xt[4],Percent:xt[10],Scientific:xt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},m=[],x=r.dense?[]:{},y="",E={},C={},S=rA('<Data ss:Type="String">'),T=0,F=0,_=0,Q={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},R={},U="",K=0,D=[],ee={},re={},Z=0,ae=[],Te=[],Se={},q=[],Ae,Re=!1,ie=[],Me=[],J={},k=0,V=0,P={Sheets:[],WBProps:{date1904:!1}},z={};lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";o=lu.exec(n);)switch(o[3]=(le=o[3]).toLowerCase()){case"data":if(le=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?_Y(n.slice(T,o.index),U,S,u[u.length-1][0]=="comment"?Se:E,{c:F,r:_},L,q[F],C,ie,r):(U="",S=rA(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Te.length>0&&(E.c=Te),(!r.sheetRows||r.sheetRows>_)&&E.v!==void 0&&(r.dense?(x[_]||(x[_]=[]),x[_][F]=E):x[Lr(F)+qr(_)]=E),E.HRef&&(E.l={Target:Wt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(k=F+(parseInt(E.MergeAcross,10)|0),V=_+(parseInt(E.MergeDown,10)|0),D.push({s:{c:F,r:_},e:{c:k,r:V}})),!r.sheetStubs)E.MergeAcross?F=k+1:++F;else if(E.MergeAcross||E.MergeDown){for(var Be=F;Be<=k;++Be)for(var de=_;de<=V;++de)(Be>F||de>_)&&(r.dense?(x[de]||(x[de]=[]),x[de][Be]={t:"z"}):x[Lr(Be)+qr(de)]={t:"z"});F=k+1}else++F;else E=BY(o[0]),E.Index&&(F=+E.Index-1),F<Q.s.c&&(Q.s.c=F),F>Q.e.c&&(Q.e.c=F),o[0].slice(-2)==="/>"&&++F,Te=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<Q.s.r&&(Q.s.r=_),_>Q.e.r&&(Q.e.r=_),o[0].slice(-2)==="/>"&&(C=rA(o[0]),C.Index&&(_=+C.Index-1)),F=0,++_):(C=rA(o[0]),C.Index&&(_=+C.Index-1),J={},(C.AutoFitHeight=="0"||C.Height)&&(J.hpx=parseInt(C.Height,10),J.hpt=du(J.hpx),Me[_]=J),C.Hidden=="1"&&(J.hidden=!0,Me[_]=J));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));m.push(y),Q.s.r<=Q.e.r&&Q.s.c<=Q.e.c&&(x["!ref"]=kt(Q),r.sheetRows&&r.sheetRows<=Q.e.r&&(x["!fullref"]=x["!ref"],Q.e.r=r.sheetRows-1,x["!ref"]=kt(Q))),D.length&&(x["!merges"]=D),q.length>0&&(x["!cols"]=q),Me.length>0&&(x["!rows"]=Me),d[y]=x}else Q={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=F=0,u.push([o[3],!1]),f=rA(o[0]),y=Wt(f.Name),x=r.dense?[]:{},D=[],ie=[],Me=[],z={name:y,Hidden:0},P.Sheets.push(z);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),q=[],Re=!1}break;case"style":o[1]==="/"?TY(L,R,r):R=rA(o[0]);break;case"numberformat":R.nf=Wt(rA(o[0]).Format||"General"),Jc[R.nf]&&(R.nf=Jc[R.nf]);for(var ce=0;ce!=392&&xt[ce]!=R.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(xt[ce]==null){ZA(R.nf,ce);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Ae=rA(o[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!Re&&Ae.wpx>10){Re=!0,Hn=Xb;for(var ne=0;ne<q.length;++ne)q[ne]&&qs(q[ne])}Re&&qs(Ae),q[Ae.Index-1||q.length]=Ae;for(var Ce=0;Ce<+Ae.Span;++Ce)q[q.length]=Ir(Ae);break;case"namedrange":if(o[1]==="/")break;P.Names||(P.Names=[]);var N=yt(o[0]),Ie={Name:N.Name,Ref:io(N.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Ie.Sheet=P.Sheets.length-1),P.Names.push(Ie);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?U+=n.slice(K,o.index):K=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=rA(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?$9(ee,le,n.slice(Z,o.index)):Z=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));bY(Se),Te.push(Se)}else u.push([o[3],!1]),f=rA(o[0]),Se={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Pe=rA(o[0]);x["!autofilter"]={ref:io(Pe.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return P2(n,r);var Ye=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(o[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Z,o.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else Z=o.index+o[0].length;break;case"header":x["!margins"]||Pi(x["!margins"]={},"xlml"),isNaN(+yt(o[0]).Margin)||(x["!margins"].header=+yt(o[0]).Margin);break;case"footer":x["!margins"]||Pi(x["!margins"]={},"xlml"),isNaN(+yt(o[0]).Margin)||(x["!margins"].footer=+yt(o[0]).Margin);break;case"pagemargins":var et=yt(o[0]);x["!margins"]||Pi(x["!margins"]={},"xlml"),isNaN(+et.Top)||(x["!margins"].top=+et.Top),isNaN(+et.Left)||(x["!margins"].left=+et.Left),isNaN(+et.Right)||(x["!margins"].right=+et.Right),isNaN(+et.Bottom)||(x["!margins"].bottom=+et.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?EY(re,le,ae,n.slice(Z,o.index)):(ae=o,Z=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=d),He.SheetNames=m,He.Workbook=P,He.SSF=Ir(xt),He.Props=ee,He.Custprops=re,He}function jp(e,t){switch(tv(t=t||{}),t.type||"base64"){case"base64":return Lm(Ba(e),t);case"binary":case"buffer":case"file":return Lm(e,t);case"array":return Lm(ni(e),t)}}function FY(e,t){var r=[];return e.Props&&r.push(Z9(e.Props,t)),e.Custprops&&r.push(eG(e.Props,e.Custprops)),r.join("")}function UY(){return""}function kY(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Ke("NumberFormat",null,{"ss:Format":dr(xt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Ke("Style",s.join(""),l))}),Ke("Styles",r.join(""))}function w4(e){return Ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Wx(e.Ref,{r:0,c:0})})}function NY(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(w4(a)))}return Ke("Names",r.join(""))}function IY(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var o=a[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(w4(o)))}return s.join("")}function QY(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ke("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ke("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Fn("ProtectContents","True")),e["!protect"].objects&&a.push(Fn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Fn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Fn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Ke("WorksheetOptions",a.join(""),{xmlns:pa.x})}function RY(e){return e.map(function(t){var r=r9(t.t||""),n=Ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ke("Comment",n,{"ss:Author":t.a})}).join("")}function DY(e,t,r,n,a,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+dr(Wx(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var u=Hr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==l.r?"":"["+(u.r-l.r)+"]")+"C"+(u.c==l.c?"":"["+(u.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=dr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=dr(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],d=0;d!=f.length;++d)f[d].s.c!=l.c||f[d].s.r!=l.r||(f[d].e.c>f[d].s.c&&(o["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(o["ss:MergeDown"]=f[d].e.r-f[d].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",x=String(e.v);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=cs[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xt[14]);break;case"s":m="String",x=t9(e.v||"");break}var y=Ai(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=l.c+1;var E=e.v!=null?x:"",C=e.t=="z"?"":'<Data ss:Type="'+m+'">'+E+"</Data>";return(e.c||[]).length>0&&(C+=RY(e.c)),Ke("Cell",C,o)}function MY(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=fo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function LY(e,t,r,n){if(!e["!ref"])return"";var a=Yt(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(S,T){qs(S);var F=!!S.width,_=jd(T,S),Q={"ss:Index":T+1};F&&(Q["ss:Width"]=uu(_.width)),S.hidden&&(Q["ss:Hidden"]="1"),o.push(Ke("Column",null,Q))});for(var u=Array.isArray(e),f=a.s.r;f<=a.e.r;++f){for(var d=[MY(f,(e["!rows"]||[])[f])],m=a.s.c;m<=a.e.c;++m){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>m)&&!(s[l].s.r>f)&&!(s[l].e.c<m)&&!(s[l].e.r<f)){(s[l].s.c!=m||s[l].s.r!=f)&&(x=!0);break}if(!x){var y={r:f,c:m},E=wt(y),C=u?(e[f]||[])[m]:e[E];d.push(DY(C,E,e,t,r,n,y))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function HY(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],l=s?IY(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?LY(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(QY(s,t,e,r)),n.join("")}function OY(e,t){t||(t={}),e.SSF||(e.SSF=Ir(xt)),e.SSF&&(yo(),Ld(e.SSF),t.revssf=Od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(FY(e,t)),r.push(UY()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ke("Worksheet",HY(n,t,e),{"ss:Name":dr(e.SheetNames[n])}));return r[2]=kY(e,t),r[3]=NY(e),$r+Ke("Workbook",r.join(""),{xmlns:pa.ss,"xmlns:o":pa.o,"xmlns:x":pa.x,"xmlns:ss":pa.ss,"xmlns:dt":pa.dt,"xmlns:html":pa.html})}function PY(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=N9(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=I9(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var GY=[60,1084,2066,2165,2175];function VY(e,t,r,n,a){var s=n,l=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}l.push(o),r.l+=s;for(var u=WA(r,r.l),f=zp[u],d=0;f!=null&&GY.indexOf(u)>-1;)s=WA(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+s),l.push(o),r.l+=4+s,f=zp[u=WA(r,r.l)];var m=xn(l);bn(m,0);var x=0;m.lens=[];for(var y=0;y<l.length;++y)m.lens.push(x),x+=l[y].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function xA(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=xt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||cs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v):e.w=Gi(e.v):e.w=Ya(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&wo(xt[n]||String(n))){var a=Ri(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ef(e,t,r){return{v:e,ixfe:t,t:r}}function KY(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},l={},o=null,u=[],f="",d={},m,x="",y,E,C,S,T={},F=[],_,Q,L=[],R=[],U={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},D=function($e){return $e<8?Li[$e]:$e<64&&R[$e-8]||Li[$e]},ee=function($e,vt,Nt){var Bt=vt.XF.data;if(!(!Bt||!Bt.patternType||!Nt||!Nt.cellStyles)){vt.s={},vt.s.patternType=Bt.patternType;var qt;(qt=cu(D(Bt.icvFore)))&&(vt.s.fgColor={rgb:qt}),(qt=cu(D(Bt.icvBack)))&&(vt.s.bgColor={rgb:qt})}},re=function($e,vt,Nt){if(!(J>1)&&!(Nt.sheetRows&&$e.r>=Nt.sheetRows)){if(Nt.cellStyles&&vt.XF&&vt.XF.data&&ee($e,vt,Nt),delete vt.ixfe,delete vt.XF,m=$e,x=wt($e),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),$e.r<l.s.r&&(l.s.r=$e.r),$e.c<l.s.c&&(l.s.c=$e.c),$e.r+1>l.e.r&&(l.e.r=$e.r+1),$e.c+1>l.e.c&&(l.e.c=$e.c+1),Nt.cellFormula&&vt.f){for(var Bt=0;Bt<F.length;++Bt)if(!(F[Bt][0].s.c>$e.c||F[Bt][0].s.r>$e.r)&&!(F[Bt][0].e.c<$e.c||F[Bt][0].e.r<$e.r)){vt.F=kt(F[Bt][0]),(F[Bt][0].s.c!=$e.c||F[Bt][0].s.r!=$e.r)&&delete vt.f,vt.f&&(vt.f=""+Ln(F[Bt][1],l,$e,ie,Z));break}}Nt.dense?(a[$e.r]||(a[$e.r]=[]),a[$e.r][$e.c]=vt):a[x]=vt}},Z={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Z.password=t.password);var ae,Te=[],Se=[],q=[],Ae=[],Re=!1,ie=[];ie.SheetNames=Z.snames,ie.sharedf=Z.sharedf,ie.arrayf=Z.arrayf,ie.names=[],ie.XTI=[];var Me=0,J=0,k=0,V=[],P=[],z;Z.codepage=1200,aA(1200);for(var le=!1;e.l<e.length-1;){var Be=e.l,de=e.read_shift(2);if(de===0&&Me===10)break;var ce=e.l===e.length?0:e.read_shift(2),ne=zp[de];if(ne&&ne.f){if(t.bookSheets&&Me===133&&de!==133)break;if(Me=de,ne.r===2||ne.r==12){var Ce=e.read_shift(2);if(ce-=2,!Z.enc&&Ce!==de&&((Ce&255)<<8|Ce>>8)!==de)throw new Error("rt mismatch: "+Ce+"!="+de);ne.r==12&&(e.l+=10,ce-=10)}var N={};if(de===10?N=ne.f(e,ce,Z):N=VY(de,ne,e,ce,Z),J==0&&[9,521,1033,2057].indexOf(Me)===-1)continue;switch(de){case 34:r.opts.Date1904=U.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Z.enc||(e.l=0),Z.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=N;break;case 66:var Ie=Number(N);switch(Ie){case 21010:Ie=1200;break;case 32768:Ie=1e4;break;case 32769:Ie=1252;break}aA(Z.codepage=Ie),le=!0;break;case 317:Z.rrtabid=N;break;case 25:Z.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:Z.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(a["!type"]="dialog"),N.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),N.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:L.push(N);break;case 430:ie.push([N]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(N);break;case 24:case 536:z={Name:N.Name,Ref:Ln(N.rgce,l,null,ie,Z)},N.itab>0&&(z.Sheet=N.itab-1),ie.names.push(z),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(P[N.itab-1]={ref:kt(N.rgce[0][0][1][2])});break;case 22:Z.ExternCount=N;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(N),ie.XTI=ie.XTI.concat(N);break;case 2196:if(Z.biff<8)break;z!=null&&(z.Comment=N[1]);break;case 18:a["!protect"]=N;break;case 19:N!==0&&Z.WTF&&console.error("Password verifier: "+N);break;case 133:s[N.pos]=N,Z.snames.push(N.name);break;case 10:{if(--J)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=kt(l),t.sheetRows&&t.sheetRows<=l.e.r){var Pe=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=kt(l),l.e.r=Pe}l.e.r++,l.e.c++}Te.length>0&&(a["!merges"]=Te),Se.length>0&&(a["!objects"]=Se),q.length>0&&(a["!cols"]=q),Ae.length>0&&(a["!rows"]=Ae),U.Sheets.push(K)}f===""?d=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),Z.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(Z.biff=5,le=!0,aA(Z.codepage=28591)),Z.biff==8&&N.BIFFVer==0&&N.dt==16&&(Z.biff=2),J++)break;if(a=t.dense?[]:{},Z.biff<8&&!le&&(le=!0,aA(Z.codepage=t.codepage||1252)),Z.biff<5||N.BIFFVer==0&&N.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:e.l-ce,name:f};s[Ye.pos]=Ye,Z.snames.push(f)}else f=(s[Be]||{name:""}).name;N.dt==32&&(a["!type"]="chart"),N.dt==64&&(a["!type"]="macro"),Te=[],Se=[],Z.arrayf=F=[],q=[],Ae=[],Re=!1,K={Hidden:(s[Be]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[N.r]||[])[N.c]:a[wt({c:N.c,r:N.r})])&&++N.c,_={ixfe:N.ixfe,XF:L[N.ixfe]||{},v:N.val,t:"n"},k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:N.c,r:N.r},_,t);break;case 5:case 517:_={ixfe:N.ixfe,XF:L[N.ixfe],v:N.val,t:N.t},k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:N.c,r:N.r},_,t);break;case 638:_={ixfe:N.ixfe,XF:L[N.ixfe],v:N.rknum,t:"n"},k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:N.c,r:N.r},_,t);break;case 189:for(var et=N.c;et<=N.C;++et){var He=N.rkrec[et-N.c][0];_={ixfe:He,XF:L[He],v:N.rkrec[et-N.c][1],t:"n"},k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:et,r:N.r},_,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){o=N;break}if(_=Ef(N.val,N.cell.ixfe,N.tt),_.XF=L[_.ixfe],t.cellFormula){var ft=N.formula;if(ft&&ft[0]&&ft[0][0]&&ft[0][0][0]=="PtgExp"){var Et=ft[0][0][1][0],lr=ft[0][0][1][1],Jt=wt({r:Et,c:lr});T[Jt]?_.f=""+Ln(N.formula,l,N.cell,ie,Z):_.F=((t.dense?(a[Et]||[])[lr]:a[Jt])||{}).F}else _.f=""+Ln(N.formula,l,N.cell,ie,Z)}k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re(N.cell,_,t),o=N}break;case 7:case 519:if(o)o.val=N,_=Ef(N,o.cell.ixfe,"s"),_.XF=L[_.ixfe],t.cellFormula&&(_.f=""+Ln(o.formula,l,o.cell,ie,Z)),k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(N);var Er=wt(N[0].s);if(y=t.dense?(a[N[0].s.r]||[])[N[0].s.c]:a[Er],t.cellFormula&&y){if(!o||!Er||!y)break;y.f=""+Ln(N[1],l,N[0],ie,Z),y.F=kt(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!o)break;T[wt(o.cell)]=N[0],y=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[wt(o.cell)],(y||{}).f=""+Ln(N[0],l,m,ie,Z)}}break;case 253:_=Ef(u[N.isst].t,N.ixfe,"s"),u[N.isst].h&&(_.h=u[N.isst].h),_.XF=L[_.ixfe],k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:N.c,r:N.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:N.ixfe,XF:L[N.ixfe],t:"z"},k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:N.c,r:N.r},_,t));break;case 190:if(t.sheetStubs)for(var Zr=N.c;Zr<=N.C;++Zr){var dt=N.ixfe[Zr-N.c];_={ixfe:dt,XF:L[dt],t:"z"},k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:Zr,r:N.r},_,t)}break;case 214:case 516:case 4:_=Ef(N.val,N.ixfe,"s"),_.XF=L[_.ixfe],k>0&&(_.z=V[_.ixfe>>8&63]),xA(_,t,r.opts.Date1904),re({c:N.c,r:N.r},_,t);break;case 0:case 512:J===1&&(l=N);break;case 252:u=N;break;case 1054:if(Z.biff==4){V[k++]=N[1];for(var oe=0;oe<k+163&&xt[oe]!=N[1];++oe);oe>=163&&ZA(N[1],k+163)}else ZA(N[1],N[0]);break;case 30:{V[k++]=N;for(var je=0;je<k+163&&xt[je]!=N;++je);je>=163&&ZA(N,k+163)}break;case 229:Te=Te.concat(N);break;case 93:Se[N.cmo[0]]=Z.lastobj=N;break;case 438:Z.lastobj.TxO=N;break;case 127:Z.lastobj.ImData=N;break;case 440:for(S=N[0].s.r;S<=N[0].e.r;++S)for(C=N[0].s.c;C<=N[0].e.c;++C)y=t.dense?(a[S]||[])[C]:a[wt({c:C,r:S})],y&&(y.l=N[1]);break;case 2048:for(S=N[0].s.r;S<=N[0].e.r;++S)for(C=N[0].s.c;C<=N[0].e.c;++C)y=t.dense?(a[S]||[])[C]:a[wt({c:C,r:S})],y&&y.l&&(y.l.Tooltip=N[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;y=t.dense?(a[N[0].r]||[])[N[0].c]:a[wt(N[0])];var bt=Se[N[2]];y||(t.dense?(a[N[0].r]||(a[N[0].r]=[]),y=a[N[0].r][N[0].c]={t:"z"}):y=a[wt(N[0])]={t:"z"},l.e.r=Math.max(l.e.r,N[0].r),l.s.r=Math.min(l.s.r,N[0].r),l.e.c=Math.max(l.e.c,N[0].c),l.s.c=Math.min(l.s.c,N[0].c)),y.c||(y.c=[]),E={a:N[1],t:bt.TxO.t},y.c.push(E)}break;case 2173:kj(L[N.ixfe],N.ext);break;case 125:{if(!Z.cellStyles)break;for(;N.e>=N.s;)q[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},Re||(Re=!0,zx(N.w/256)),qs(q[N.e+1])}break;case 520:{var ht={};N.level!=null&&(Ae[N.r]=ht,ht.level=N.level),N.hidden&&(Ae[N.r]=ht,ht.hidden=!0),N.hpt&&(Ae[N.r]=ht,ht.hpt=N.hpt,ht.hpx=fo(N.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Pi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=N;break;case 161:a["!margins"]||Pi(a["!margins"]={}),a["!margins"].header=N.header,a["!margins"].footer=N.footer;break;case 574:N.RTL&&(U.Views[0].RTL=!0);break;case 146:R=N;break;case 2198:ae=N;break;case 140:Q=N;break;case 442:f?K.CodeName=N||K.name:U.WBProps.CodeName=N||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=ce}return r.SheetNames=Kr(s).sort(function(Tt,$e){return Number(Tt)-Number($e)}).map(function(Tt){return s[Tt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&P.forEach(function(Tt,$e){r.Sheets[r.SheetNames[$e]]["!autofilter"]=Tt}),r.Strings=u,r.SSF=Ir(xt),Z.enc&&(r.Encryption=Z.enc),ae&&(r.Themes=ae),r.Metadata={},Q!==void 0&&(r.Metadata.Country=Q),ie.names.length>0&&(U.Names=ie.names),r.Workbook=U,r}var Wc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jY(e,t,r){var n=ut.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=p2(n,Hp,Wc.DSI);for(var s in a)t[s]=a[s]}catch(f){if(r.WTF)throw f}var l=ut.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=p2(l,Op,Wc.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(vb(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function zY(e,t){var r=[],n=[],a=[],s=0,l,o=XE(Hp,"n"),u=XE(Op,"n");if(e.Props)for(l=Kr(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(u,l[s])?n:a).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=Kr(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(u,l[s])?n:a).push([l[s],e.Custprops[l[s]]]);var f=[];for(s=0;s<a.length;++s)Tb.indexOf(a[s][0])>-1||xb.indexOf(a[s][0])>-1||a[s][1]!=null&&f.push(a[s]);n.length&&ut.utils.cfb_add(t,"/SummaryInformation",x2(n,Wc.SI,u,Op)),(r.length||f.length)&&ut.utils.cfb_add(t,"/DocumentSummaryInformation",x2(r,Wc.DSI,o,Hp,f.length?f:null,Wc.UDI))}function y4(e,t){t||(t={}),tv(t),Bx(),t.codepage&&yx(t.codepage);var r,n;if(e.FullPaths){if(ut.find(e,"/encryption"))throw new Error("File is password-protected");r=ut.find(e,"!CompObj"),n=ut.find(e,"/Workbook")||ut.find(e,"/Book")}else{switch(t.type){case"base64":e=va(Ba(e));break;case"binary":e=va(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}bn(e,0),n={content:e}}var a,s;if(r&&PY(r),t.bookProps&&!t.bookSheets)a={};else{var l=Mt?"buffer":"array";if(n&&n.content)a=KY(n.content,t);else if((s=ut.find(e,"PerfectOffice_MAIN"))&&s.content)a=Oi.to_workbook(s.content,(t.type=l,t));else if((s=ut.find(e,"NativeContent_MAIN"))&&s.content)a=Oi.to_workbook(s.content,(t.type=l,t));else throw(s=ut.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ut.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Az(e))}var o={};return e.FullPaths&&jY(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function XY(e,t){var r=t||{},n=ut.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ut.utils.cfb_add(n,a,B4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&zY(e,n),r.biff==8&&e.vbaraw&&sz(n,ut.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var hu={0:{f:pJ},1:{f:SJ},2:{f:KJ},3:{f:IJ},4:{f:FJ},5:{f:PJ},6:{f:WJ},7:{f:MJ},8:{f:rW},9:{f:tW},10:{f:ZJ},11:{f:eW},12:{f:_J},13:{f:zJ},14:{f:RJ},15:{f:kJ},16:{f:d4},17:{f:qJ},18:{f:HJ},19:{f:Dx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qW},40:{},42:{},43:{f:WK},44:{f:XK},45:{f:$K},46:{f:ej},47:{f:ZK},48:{},49:{f:w9},50:{},51:{f:Qj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Mb},62:{f:JJ},63:{f:Vj},64:{f:xW},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:hW},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CJ},148:{f:wJ,p:16},151:{f:lW},152:{},153:{f:JW},154:{},155:{},156:{f:zW},157:{},158:{},159:{T:1,f:cK},160:{T:-1},161:{T:1,f:el},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Nj},336:{T:-1},337:{f:Mj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Lp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Db},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:oW},427:{f:cW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:fW},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:BJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Lp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ez},633:{T:1},634:{T:-1},635:{T:1,f:$j},636:{T:-1},637:{f:E9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:RW},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:vW},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},zp={6:{f:Dm},10:{f:Ds},12:{f:ln},13:{f:ln},14:{f:Wr},15:{f:Wr},16:{f:On},17:{f:Wr},18:{f:Wr},19:{f:ln},20:{f:E2},21:{f:E2},23:{f:Db},24:{f:T2},25:{f:Wr},26:{},27:{},28:{f:vV},29:{},34:{f:Wr},35:{f:S2},38:{f:On},39:{f:On},40:{f:On},41:{f:On},42:{f:Wr},43:{f:Wr},47:{f:kK},49:{f:zG},51:{f:ln},60:{},61:{f:PG},64:{f:Wr},65:{f:jG},66:{f:ln},77:{},80:{},81:{},82:{},85:{f:ln},89:{},90:{},91:{},92:{f:UG},93:{f:BV},94:{},95:{f:Wr},96:{},97:{},99:{f:Wr},125:{f:Mb},128:{f:iV},129:{f:NG},130:{f:ln},131:{f:Wr},132:{f:Wr},133:{f:IG},134:{},140:{f:UV},141:{f:ln},144:{},146:{f:IV},151:{},152:{},153:{},154:{},155:{},156:{f:ln},157:{},158:{},160:{f:OV},161:{f:DV},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:nV},190:{f:aV},193:{f:Ds},197:{},198:{},199:{},200:{},201:{},202:{f:Wr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ln},220:{},221:{f:Wr},222:{},224:{f:sV},225:{f:FG},226:{f:Ds},227:{},229:{f:wV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:RG},253:{f:JG},255:{f:MG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:_b},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wr},353:{f:Ds},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:fV},431:{f:Wr},432:{},433:{},434:{},437:{},438:{f:SV},439:{f:Wr},440:{f:TV},441:{},442:{f:Eu},443:{},444:{f:ln},445:{},446:{},448:{f:Ds},449:{f:OG,r:2},450:{f:Ds},512:{f:y2},513:{f:HV},515:{f:cV},516:{f:YG},517:{f:C2},519:{f:PV},520:{f:LG},523:{},545:{f:_2},549:{f:w2},566:{},574:{f:VG},638:{f:rV},659:{},1048:{},1054:{f:$G},1084:{},1212:{f:mV},2048:{f:bV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ds},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:QV,r:12},2173:{f:Uj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:gV,r:12},2197:{},2198:{f:Ej,r:12},2199:{},2200:{},2201:{},2202:{f:pV,r:12},2203:{f:Ds},2204:{},2205:{},2206:{},2207:{},2211:{f:HG},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:MV},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:NV},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:y2},1:{},2:{f:zV},3:{f:KV},4:{f:VV},5:{f:C2},7:{f:JV},8:{},9:{f:yf},11:{},22:{f:ln},30:{f:eV},31:{},32:{},33:{f:_2},36:{},37:{f:w2},50:{f:WV},62:{},52:{},67:{},68:{f:ln},69:{},86:{},126:{},127:{f:GV},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:YV},223:{},234:{},354:{},421:{},518:{f:Dm},521:{f:yf},536:{f:T2},547:{f:S2},561:{},579:{},1030:{f:Dm},1033:{f:yf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&Ix(r)&&e.push(r)}}function JY(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(e,t,r,a);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,u=0,f=0;f+(l[o]||8224)<=8224;)f+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f;u<a;){for(d=e.next(4),d.write_shift(2,60),f=0;f+(l[o]||8224)<=8224;)f+=l[o]||8224,o++;d.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f}}}function bu(e,t,r){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function WY(e,t,r,n){var a=_e(9);return bu(a,e,t),bb(r,n||"b",a),a}function YY(e,t,r){var n=_e(8+2*r.length);return bu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function qY(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?hn(Nr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ze(e,2,XV(r,n,a)):ze(e,3,jV(r,n,a));return;case"b":case"e":ze(e,5,WY(r,n,t.v,t.t));return;case"s":case"str":ze(e,4,YY(r,n,(t.v||"").slice(0,255)));return}ze(e,1,bu(null,r,n))}function $Y(e,t,r,n){var a=Array.isArray(t),s=Yt(t["!ref"]||"A1"),l,o="",u=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=kt(s)}for(var f=s.s.r;f<=s.e.r;++f){o=qr(f);for(var d=s.s.c;d<=s.e.c;++d){f===s.s.r&&(u[d]=Lr(d)),l=u[d]+o;var m=a?(t[f]||[])[d]:t[l];m&&qY(e,m,f,d)}}}function ZY(e,t){for(var r=t||{},n=ia(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,Vx(e,16,r)),$Y(n,e.Sheets[e.SheetNames[a]],a,r),ze(n,10),n.end()}function eq(e,t,r){ze(e,49,XG({sz:12,name:"Arial"},r))}function tq(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,1054,ZG(a,t[a],r))})}function rq(e,t){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Ib(Yt(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function nq(e,t){for(var r=0;r<16;++r)ze(e,224,B2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ze(e,224,B2(n,0,t))})}function aq(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ze(e,440,_V(n)),n[1].Tooltip&&ze(e,2048,FV(n))}delete t["!links"]}function Aq(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ze(e,125,RV(jd(a,n),a))})}}function sq(e,t,r,n,a){var s=16+Ai(a.cellXfs,t,a);if(t.v==null&&!t.bf){ze(e,513,zi(r,n,s));return}if(t.bf)ze(e,6,NX(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?hn(Nr(t.v)):t.v;ze(e,515,uV(r,n,l,s));break;case"b":case"e":ze(e,517,oV(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=qx(a.Strings,t.v,a.revStrings);ze(e,253,WG(r,n,o,s))}else ze(e,516,qG(r,n,(t.v||"").slice(0,255),s,a));break;default:ze(e,513,zi(r,n,s))}}function iq(e,t,r){var n=ia(),a=r.SheetNames[e],s=r.Sheets[a]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},u=Array.isArray(s),f=t.biff==8,d,m="",x=[],y=Yt(s["!ref"]||"A1"),E=f?65536:16384;if(y.e.c>255||y.e.r>=E){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,E-1)}ze(n,2057,Vx(r,16,t)),ze(n,13,Va(1)),ze(n,12,Va(100)),ze(n,15,Yn(!0)),ze(n,17,Yn(!1)),ze(n,16,Ki(.001)),ze(n,95,Yn(!0)),ze(n,42,Yn(!1)),ze(n,43,Yn(!1)),ze(n,130,Va(1)),ze(n,128,lV()),ze(n,131,Yn(!1)),ze(n,132,Yn(!1)),f&&Aq(n,s["!cols"]),ze(n,512,tV(y,t)),f&&(s["!links"]=[]);for(var C=y.s.r;C<=y.e.r;++C){m=qr(C);for(var S=y.s.c;S<=y.e.c;++S){C===y.s.r&&(x[S]=Lr(S)),d=x[S]+m;var T=u?(s[C]||[])[S]:s[d];T&&(sq(n,T,C,S,t),f&&T.l&&s["!links"].push([d,T.l]))}}var F=o.CodeName||o.name||a;return f&&ze(n,574,KG((l.Views||[])[0])),f&&(s["!merges"]||[]).length&&ze(n,229,yV(s["!merges"])),f&&aq(n,s),ze(n,442,Fb(F)),f&&rq(n,s),ze(n,10),n.end()}function lq(e,t,r){var n=ia(),a=(e||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},o=r.biff==8,u=r.biff==5;if(ze(n,2057,Vx(e,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,o?Va(1200):null),ze(n,193,oG(2)),u&&ze(n,191),u&&ze(n,192),ze(n,226),ze(n,92,kG("SheetJS",r)),ze(n,66,Va(o?1200:1252)),o&&ze(n,353,Va(0)),o&&ze(n,448),ze(n,317,LV(e.SheetNames.length)),o&&e.vbaraw&&ze(n,211),o&&e.vbaraw){var f=l.CodeName||"ThisWorkbook";ze(n,442,Fb(f))}ze(n,156,Va(17)),ze(n,25,Yn(!1)),ze(n,18,Yn(!1)),ze(n,19,Va(0)),o&&ze(n,431,Yn(!1)),o&&ze(n,444,Va(0)),ze(n,61,GG()),ze(n,64,Yn(!1)),ze(n,141,Va(0)),ze(n,34,Yn(OW(e)=="true")),ze(n,14,Yn(!0)),o&&ze(n,439,Yn(!1)),ze(n,218,Va(0)),eq(n,e,r),tq(n,e.SSF,r),nq(n,r),o&&ze(n,352,Yn(!1));var d=n.end(),m=ia();o&&ze(m,140,kV()),o&&r.Strings&&JY(m,252,DG(r.Strings)),ze(m,10);var x=m.end(),y=ia(),E=0,C=0;for(C=0;C<e.SheetNames.length;++C)E+=(o?12:11)+(o?2:1)*e.SheetNames[C].length;var S=d.length+E+x.length;for(C=0;C<e.SheetNames.length;++C){var T=s[C]||{};ze(y,133,QG({pos:S,hs:T.Hidden||0,dt:0,name:e.SheetNames[C]},r)),S+=t[C].length}var F=y.end();if(E!=F.length)throw new Error("BS8 "+E+" != "+F.length);var _=[];return d.length&&_.push(d),F.length&&_.push(F),x.length&&_.push(x),xn(_)}function oq(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ir(xt)),e&&e.SSF&&(yo(),Ld(e.SSF),r.revssf=Od(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,rv(r),r.cellXfs=[],Ai(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=iq(a,r,e);return n.unshift(lq(e,n,r)),xn(n)}function B4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=la(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return oq(e,t);case 4:case 3:case 2:return ZY(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function M2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=a.index,o=s&&s.index||e.length,u=X7(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,m=0,x=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<u.length;++l){var C=u[l].trim(),S=C.slice(0,3).toLowerCase();if(S=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(S!="<td"&&S!="<th")){var T=C.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var F=T[o].trim();if(F.match(/<t[dh]/i)){for(var _=F,Q=0;_.charAt(0)=="<"&&(Q=_.indexOf(">"))>-1;)_=_.slice(Q+1);for(var L=0;L<E.length;++L){var R=E[L];R.s.c==d&&R.s.r<f&&f<=R.e.r&&(d=R.e.c+1,L=-1)}var U=yt(F.slice(0,F.indexOf(">")));x=U.colspan?+U.colspan:1,((m=+U.rowspan)>1||x>1)&&E.push({s:{r:f,c:d},e:{r:f+(m||1)-1,c:d+x-1}});var K=U.t||U["data-t"]||"";if(!_.length){d+=x;continue}if(_=z_(_),y.s.r>f&&(y.s.r=f),y.e.r<f&&(y.e.r=f),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!_.length){d+=x;continue}var D={t:"s",v:_};r.raw||!_.trim().length||K=="s"||(_==="TRUE"?D={t:"b",v:!0}:_==="FALSE"?D={t:"b",v:!1}:isNaN(lA(_))?isNaN(co(_).getDate())||(D={t:"d",v:Nr(_)},r.cellDates||(D={t:"n",v:hn(D.v)}),D.z=r.dateNF||xt[14]):D={t:"n",v:lA(_)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=D):n[wt({r:f,c:d})]=D,d+=x}}}}return n["!ref"]=kt(y),E.length&&(n["!merges"]=E),n}function cq(e,t,r,n){for(var a=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>l)&&!(a[f].e.r<r||a[f].e.c<l)){if(a[f].s.r<r||a[f].s.c<l){o=-1;break}o=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(o<0)){var d=wt({r,c:l}),m=n.dense?(e[r]||[])[l]:e[d],x=m&&m.v!=null&&(m.h||Ux(m.w||(as(m),m.w)||""))||"",y={};o>1&&(y.rowspan=o),u>1&&(y.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(y["data-t"]=m&&m.t||"z",m.v!=null&&(y["data-v"]=m.v),m.z!=null&&(y["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),y.id=(n.id||"sjs")+"-"+d,s.push(Ke("td",x,y))}}var E="<tr>";return E+s.join("")+"</tr>"}var uq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fq="</body></html>";function dq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ai(M2(r[0],t),t);var n=Av();return r.forEach(function(a,s){sv(n,M2(a,t),"Sheet"+(s+1))}),n}function hq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function C4(e,t){var r=t||{},n=r.header!=null?r.header:uq,a=r.footer!=null?r.footer:fq,s=[n],l=la(e["!ref"]);r.dense=Array.isArray(e),s.push(hq(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(cq(e,l,o,r));return s.push("</table>"+a),s.join("")}function E4(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Hr(n.origin):n.origin;a=l.r,s=l.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=la(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),a==-1&&(f.e.r=a=d.e.r+1)}var m=[],x=0,y=e["!rows"]||(e["!rows"]=[]),E=0,C=0,S=0,T=0,F=0,_=0;for(e["!cols"]||(e["!cols"]=[]);E<o.length&&C<u;++E){var Q=o[E];if(L2(Q)){if(n.display)continue;y[C]={hidden:!0}}var L=Q.children;for(S=T=0;S<L.length;++S){var R=L[S];if(!(n.display&&L2(R))){var U=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):z_(R.innerHTML),K=R.getAttribute("data-z")||R.getAttribute("z");for(x=0;x<m.length;++x){var D=m[x];D.s.c==T+s&&D.s.r<C+a&&C+a<=D.e.r&&(T=D.e.c+1-s,x=-1)}_=+R.getAttribute("colspan")||1,((F=+R.getAttribute("rowspan")||1)>1||_>1)&&m.push({s:{r:C+a,c:T+s},e:{r:C+a+(F||1)-1,c:T+s+(_||1)-1}});var ee={t:"s",v:U},re=R.getAttribute("data-t")||R.getAttribute("t")||"";U!=null&&(U.length==0?ee.t=re||"z":n.raw||U.trim().length==0||re=="s"||(U==="TRUE"?ee={t:"b",v:!0}:U==="FALSE"?ee={t:"b",v:!1}:isNaN(lA(U))?isNaN(co(U).getDate())||(ee={t:"d",v:Nr(U)},n.cellDates||(ee={t:"n",v:hn(ee.v)}),ee.z=n.dateNF||xt[14]):ee={t:"n",v:lA(U)})),ee.z===void 0&&K!=null&&(ee.z=K);var Z="",ae=R.getElementsByTagName("A");if(ae&&ae.length)for(var Te=0;Te<ae.length&&!(ae[Te].hasAttribute("href")&&(Z=ae[Te].getAttribute("href"),Z.charAt(0)!="#"));++Te);Z&&Z.charAt(0)!="#"&&(ee.l={Target:Z}),n.dense?(e[C+a]||(e[C+a]=[]),e[C+a][T+s]=ee):e[wt({c:T+s,r:C+a})]=ee,f.e.c<T+s&&(f.e.c=T+s),T+=_}}++C}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,C-1+a),e["!ref"]=kt(f),C>=u&&(e["!fullref"]=kt((f.e.r=o.length-E+C-1+a,f))),e}function S4(e,t){var r=t||{},n=r.dense?[]:{};return E4(n,e,t)}function gq(e,t){return ai(S4(e,t),t)}function L2(e){var t="",r=mq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function mq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function pq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Wt(t.replace(/<[^>]*>/g,""));return[r]}var H2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function T4(e,t){var r=t||{},n=kx(e),a=[],s,l,o={name:""},u="",f=0,d,m,x={},y=[],E=r.dense?[]:{},C,S,T={value:""},F="",_=0,Q=[],L=-1,R=-1,U={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,D={},ee=[],re={},Z=0,ae=0,Te=[],Se=1,q=1,Ae=[],Re={Names:[]},ie={},Me=["",""],J=[],k={},V="",P=0,z=!1,le=!1,Be=0;for(lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");C=lu.exec(n);)switch(C[3]=C[3].replace(/_.*$/,"")){case"table":case"":C[1]==="/"?(U.e.c>=U.s.c&&U.e.r>=U.s.r?E["!ref"]=kt(U):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=U.e.r&&(E["!fullref"]=E["!ref"],U.e.r=r.sheetRows-1,E["!ref"]=kt(U)),ee.length&&(E["!merges"]=ee),Te.length&&(E["!rows"]=Te),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),x[d.name]=E,le=!1):C[0].charAt(C[0].length-2)!=="/"&&(d=yt(C[0],!1),L=R=-1,U.s.r=U.s.c=1e7,U.e.r=U.e.c=0,E=r.dense?[]:{},ee=[],Te=[],le=!0);break;case"table-row-group":C[1]==="/"?--K:++K;break;case"table-row":case"":if(C[1]==="/"){L+=Se,Se=1;break}if(m=yt(C[0],!1),m.?L=m.-1:L==-1&&(L=0),Se=+m["number-rows-repeated"]||1,Se<10)for(Be=0;Be<Se;++Be)K>0&&(Te[L+Be]={level:K});R=-1;break;case"covered-table-cell":C[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(E[L]||(E[L]=[]),E[L][R]={t:"z"}):E[wt({r:L,c:R})]={t:"z"}),F="",Q=[];break;case"table-cell":case"":if(C[0].charAt(C[0].length-2)==="/")++R,T=yt(C[0],!1),q=parseInt(T["number-columns-repeated"]||"1",10),S={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(S.f=Q2(Wt(T.formula))),(T.||T["value-type"])=="string"&&(S.t="s",S.v=Wt(T["string-value"]||""),r.dense?(E[L]||(E[L]=[]),E[L][R]=S):E[wt({r:L,c:R})]=S),R+=q-1;else if(C[1]!=="/"){++R,F="",_=0,Q=[],q=1;var de=Se?L+Se-1:L;if(R>U.e.c&&(U.e.c=R),R<U.s.c&&(U.s.c=R),L<U.s.r&&(U.s.r=L),de>U.e.r&&(U.e.r=de),T=yt(C[0],!1),J=[],k={},S={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Wt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(Z=parseInt(T["number-matrix-rows-spanned"],10)||0,ae=parseInt(T["number-matrix-columns-spanned"],10)||0,re={s:{r:L,c:R},e:{r:L+Z-1,c:R+ae-1}},S.F=kt(re),Ae.push([re,S.F])),T.formula)S.f=Q2(T.formula);else for(Be=0;Be<Ae.length;++Be)L>=Ae[Be][0].s.r&&L<=Ae[Be][0].e.r&&R>=Ae[Be][0].s.c&&R<=Ae[Be][0].e.c&&(S.F=Ae[Be][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(Z=parseInt(T["number-rows-spanned"],10)||0,ae=parseInt(T["number-columns-spanned"],10)||0,re={s:{r:L,c:R},e:{r:L+Z-1,c:R+ae-1}},ee.push(re)),T["number-columns-repeated"]&&(q=parseInt(T["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=kr(T["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(T.value);break;case"percentage":S.t="n",S.v=parseFloat(T.value);break;case"currency":S.t="n",S.v=parseFloat(T.value);break;case"date":S.t="d",S.v=Nr(T["date-value"]),r.cellDates||(S.t="n",S.v=hn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=K7(T["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Pd(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(T.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",T["string-value"]!=null&&(F=Wt(T["string-value"]),Q=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(z=!1,S.t==="s"&&(S.v=F||"",Q.length&&(S.R=Q),z=_==0),ie.Target&&(S.l=ie),J.length>0&&(S.c=J,J=[]),F&&r.cellText!==!1&&(S.w=F),z&&(S.t="z",delete S.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=L))for(var ce=0;ce<Se;++ce){if(q=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(E[L+ce]||(E[L+ce]=[]),E[L+ce][R]=ce==0?S:Ir(S);--q>0;)E[L+ce][R+q]=Ir(S);else for(E[wt({r:L+ce,c:R})]=S;--q>0;)E[wt({r:L+ce,c:R+q})]=Ir(S);U.e.c<=R&&(U.e.c=R)}q=parseInt(T["number-columns-repeated"]||"1",10),R+=q-1,q=0,S={},F="",Q=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(C[1]==="/"){if((s=a.pop())[0]!==C[3])throw"Bad state: "+s}else C[0].charAt(C[0].length-2)!=="/"&&a.push([C[3],!0]);break;case"annotation":if(C[1]==="/"){if((s=a.pop())[0]!==C[3])throw"Bad state: "+s;k.t=F,Q.length&&(k.R=Q),k.a=V,J.push(k)}else C[0].charAt(C[0].length-2)!=="/"&&a.push([C[3],!1]);V="",P=0,F="",_=0,Q=[];break;case"creator":C[1]==="/"?V=n.slice(P,C.index):P=C.index+C[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(C[1]==="/"){if((s=a.pop())[0]!==C[3])throw"Bad state: "+s}else C[0].charAt(C[0].length-2)!=="/"&&a.push([C[3],!1]);F="",_=0,Q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(C[1]==="/"){if(D[o.name]=u,(s=a.pop())[0]!==C[3])throw"Bad state: "+s}else C[0].charAt(C[0].length-2)!=="/"&&(u="",o=yt(C[0],!1),a.push([C[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=yt(C[0],!1),u+=H2[C[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=yt(C[0],!1),u+=H2[C[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(C[0].slice(-2)==="/>")break;if(C[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,C.index);break}else f=C.index+C[0].length;break;case"named-range":l=yt(C[0],!1),Me=Mm(l["cell-range-address"]);var ne={Name:l.name,Ref:Me[0]+"!"+Me[1]};le&&(ne.Sheet=y.length),Re.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(C[1]==="/"&&(!T||!T["string-value"])){var Ce=pq(n.slice(_,C.index));F=(F.length>0?F+`
`:"")+Ce[0]}else yt(C[0],!1),_=C.index+C[0].length;break;case"s":break;case"database-range":if(C[1]==="/")break;try{Me=Mm(yt(C[0])["target-range-address"]),x[Me[0]]["!autofilter"]={ref:Me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(C[1]!=="/"){if(ie=yt(C[0],!1),!ie.href)break;ie.Target=Wt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Me=Mm(ie.Target.slice(1)),ie.Target="#"+Me[0]+"!"+Me[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(C[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(C)}}var N={Sheets:x,SheetNames:y,Workbook:Re};return r.bookSheets&&delete N.Sheets,N}function O2(e,t){t=t||{},Ga(e,"META-INF/manifest.xml")&&K9(sn(e,"META-INF/manifest.xml"),t);var r=wa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=T4(yr(r),t);return Ga(e,"meta.xml")&&(n.Props=mb(sn(e,"meta.xml"))),n}function P2(e,t){return T4(e,t)}var xq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+iu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return $r+t}})(),G2=(function(){var e=function(s){return dr(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var u=[];u.push('      <table:table table:name="'+dr(l.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,d=0,m=la(s["!ref"]||"A1"),x=s["!merges"]||[],y=0,E=Array.isArray(s);if(s["!cols"])for(d=0;d<=m.e.c;++d)u.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var C="",S=s["!rows"]||[];for(f=0;f<m.s.r;++f)C=S[f]?' table:style-name="ro'+S[f].ods+'"':"",u.push("        <table:table-row"+C+`></table:table-row>
`);for(;f<=m.e.r;++f){for(C=S[f]?' table:style-name="ro'+S[f].ods+'"':"",u.push("        <table:table-row"+C+`>
`),d=0;d<m.s.c;++d)u.push(t);for(;d<=m.e.c;++d){var T=!1,F={},_="";for(y=0;y!=x.length;++y)if(!(x[y].s.c>d)&&!(x[y].s.r>f)&&!(x[y].e.c<d)&&!(x[y].e.r<f)){(x[y].s.c!=d||x[y].s.r!=f)&&(T=!0),F["table:number-columns-spanned"]=x[y].e.c-x[y].s.c+1,F["table:number-rows-spanned"]=x[y].e.r-x[y].s.r+1;break}if(T){u.push(r);continue}var Q=wt({r:f,c:d}),L=E?(s[f]||[])[d]:s[Q];if(L&&L.f&&(F["table:formula"]=dr(LX(L.f)),L.F&&L.F.slice(0,Q.length)==Q)){var R=la(L.F);F["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,F["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!L){u.push(t);continue}switch(L.t){case"b":_=L.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=L.v?"true":"false";break;case"n":_=L.w||String(L.v||0),F["office:value-type"]="float",F["office:value"]=L.v||0;break;case"s":case"str":_=L.v==null?"":L.v,F["office:value-type"]="string";break;case"d":_=L.w||Nr(L.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=Nr(L.v).toISOString(),F["table:style-name"]="ce1";break;default:u.push(t);continue}var U=e(_);if(L.l&&L.l.Target){var K=L.l.Target;K=K.charAt(0)=="#"?"#"+HX(K.slice(1)):K,K.charAt(0)!="#"&&!K.match(/^\w+:/)&&(K="../"+K),U=Ke("text:a",U,{"xlink:href":K.replace(/&/g,"&amp;")})}u.push("          "+Ke("table:table-cell",Ke("text:p",U,{}),F)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var m=f["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;qs(m),m.ods=o;var x=f["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++o}}});var u=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=u;var m=f["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var u=[$r],f=iu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=iu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+f+d+`>
`),u.push(gb().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),a(u,l),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var m=0;m!=l.SheetNames.length;++m)u.push(n(l.Sheets[l.SheetNames[m]],l,m));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function _4(e,t){if(t.bookType=="fods")return G2(e,t);var r=_x(),n="",a=[],s=[];return n="mimetype",Rt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Rt(r,n,G2(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Rt(r,n,xq(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Rt(r,n,$r+gb()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Rt(r,n,X9(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Rt(r,n,j9(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Xp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):yr(ni(e))}function vq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):va(BA(e))}function wq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Zs(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function V2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yq(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Bq(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function gu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ur(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Vr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function er(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=gu(e,r),s=a&7;a=Math.floor(a/8);var l=0,o;if(a==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=gu(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var f={data:o,type:s};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Tn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ur(n*8+a.type)),a.type==2&&t.push(ur(a.data.length)),t.push(a.data))})}),Zs(t)}function ev(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ha(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=gu(e,n),s=er(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:Vr(s[1][0].data),messages:[]};s[2].forEach(function(o){var u=er(o.data),f=Vr(u[3][0].data);l.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=s[3])!=null&&t[0]&&(l.merge=Vr(s[3][0].data)>>>0>0),r.push(l)}return r}function jl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ur(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ur(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:ur(l.data.length)}],n[2].push({data:Tn(l.meta),type:2})});var s=Tn(n);t.push(ur(s.length)),t.push(s),a.forEach(function(l){return t.push(l)})}),Zs(t)}function Cq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=gu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var u=0,f=0;if(s==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Zs(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var d=Zs(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Oa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Cq(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Zs(t)}function zl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=ur(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Zs(t)}function Eq(e,t,r,n){var a=Xi(e),s=a.getUint32(4,!0),l=(n>1?12:8)+V2(s&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);s&512&&(o=a.getUint32(l,!0),l+=4),l+=V2(s&(n>1?12288:4096))*4,s&16&&(u=a.getUint32(l,!0),l+=4),s&32&&(f=a.getFloat64(l,!0),l+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function Sq(e,t,r){var n=Xi(e),a=n.getUint32(8,!0),s=12,l=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);a&1&&(u=yq(e,s),s+=16),a&2&&(f=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(l=n.getUint32(s,!0),s+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[o]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function Hm(e,t){var r=new Uint8Array(32),n=Xi(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Bq(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Om(e,t){var r=new Uint8Array(32),n=Xi(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Tq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Eq(e,t,r,e[0]);case 5:return Sq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Dn(e){var t=er(e);return gu(t[1][0].data)}function K2(e,t){var r=er(t.data),n=Vr(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(l){var o=er(l.data),u=Vr(o[1][0].data)>>>0;switch(n){case 1:s[u]=Xp(o[3][0].data);break;case 8:{var f=e[Dn(o[9][0].data)][0],d=er(f.data),m=e[Dn(d[1][0].data)][0],x=Vr(m.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var y=er(m.data);s[u]=y[3].map(function(E){return Xp(E.data)}).join("")}break}}),s}function _q(e,t){var r,n,a,s,l,o,u,f,d,m,x,y,E,C,S=er(e),T=Vr(S[1][0].data)>>>0,F=Vr(S[2][0].data)>>>0,_=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Vr(S[8][0].data)>0||!1,Q,L;if((s=(a=S[7])==null?void 0:a[0])!=null&&s.data&&t!=0)Q=(o=(l=S[7])==null?void 0:l[0])==null?void 0:o.data,L=(f=(u=S[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(d=S[4])==null?void 0:d[0])!=null&&m.data&&t!=1)Q=(y=(x=S[4])==null?void 0:x[0])==null?void 0:y.data,L=(C=(E=S[3])==null?void 0:E[0])==null?void 0:C.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=_?4:1,U=Xi(Q),K=[],D=0;D<Q.length/2;++D){var ee=U.getUint16(D*2,!0);ee<65535&&K.push([D,ee])}if(K.length!=F)throw"Expected ".concat(F," cells, found ").concat(K.length);var re=[];for(D=0;D<K.length-1;++D)re[K[D][0]]=L.subarray(K[D][1]*R,K[D+1][1]*R);return K.length>=1&&(re[K[K.length-1][0]]=L.subarray(K[K.length-1][1]*R)),{R:T,cells:re}}function bq(e,t){var r,n=er(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Vr(n[7][0].data)>>>0>0?1:0:-1,s=ev(n[5],function(l){return _q(l,a)});return{nrows:Vr(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(u,f){if(l[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));l[o.R][f]=u}),l},[])}}function Fq(e,t,r){var n,a=er(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Vr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Vr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=kt(s);var l=er(a[4][0].data),o=K2(e,e[Dn(l[4][0].data)][0]),u=(n=l[17])!=null&&n[0]?K2(e,e[Dn(l[17][0].data)][0]):[],f=er(l[3][0].data),d=0;f[1].forEach(function(m){var x=er(m.data),y=e[Dn(x[2][0].data)][0],E=Vr(y.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var C=bq(e,y);C.data.forEach(function(S,T){S.forEach(function(F,_){var Q=wt({r:d+T,c:_}),L=Tq(F,o,u);L&&(r[Q]=L)})}),d+=C.nrows})}function Uq(e,t){var r=er(t.data),n={"!ref":"A1"},a=e[Dn(r[2][0].data)],s=Vr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Fq(e,a[0],n),n}function kq(e,t){var r,n=er(t.data),a={name:(r=n[1])!=null&&r[0]?Xp(n[1][0].data):"",sheets:[]},s=ev(n[2],Dn);return s.forEach(function(l){e[l].forEach(function(o){var u=Vr(o.meta[1][0].data);u==6e3&&a.sheets.push(Uq(e,o))})}),a}function Nq(e,t){var r=Av(),n=er(t.data),a=ev(n[1],Dn);if(a.forEach(function(s){e[s].forEach(function(l){var o=Vr(l.meta[1][0].data);if(o==2){var u=kq(e,l);u.sheets.forEach(function(f,d){sv(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Pm(e){var t,r,n,a,s={},l=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=Oa(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var d;try{d=Ha(f)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){s[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Vr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(u){s[u].forEach(function(f){var d=Vr(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Nq(s,o)}function Iq(e,t,r){var n,a,s,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Vr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,f=Xi(e[7][0].data),d=0,m=[],x=Xi(e[4][0].data),y=0,E=[],C=0;C<t.length;++C){if(t[C]==null){f.setUint16(C*2,65535,!0),x.setUint16(C*2,65535);continue}f.setUint16(C*2,d,!0),x.setUint16(C*2,y,!0);var S,T;switch(typeof t[C]){case"string":S=Hm({t:"s",v:t[C]},r),T=Om({t:"s",v:t[C]},r);break;case"number":S=Hm({t:"n",v:t[C]},r),T=Om({t:"n",v:t[C]},r);break;case"boolean":S=Hm({t:"b",v:t[C]},r),T=Om({t:"b",v:t[C]},r);break;default:throw new Error("Unsupported value "+t[C])}m.push(S),d+=S.length,E.push(T),y+=T.length,++u}for(e[2][0].data=ur(u);C<e[7][0].data.length/2;++C)f.setUint16(C*2,65535,!0),x.setUint16(C*2,65535,!0);return e[6][0].data=Zs(m),e[3][0].data=Zs(E),u}function Qq(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=la(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(kt(n)));var s=md(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(V){return V.forEach(function(P){typeof P=="string"&&l.push(P)})});var o={},u=[],f=ut.read(t.numbers,{type:"base64"});f.FileIndex.map(function(V,P){return[V,f.FullPaths[P]]}).forEach(function(V){var P=V[0],z=V[1];if(P.type==2&&P.name.match(/\.iwa/)){var le=P.content,Be=Oa(le),de=Ha(Be);de.forEach(function(ce){u.push(ce.id),o[ce.id]={deps:[],location:z,type:Vr(ce.messages[0].meta[1][0].data)}})}}),u.sort(function(V,P){return V-P});var d=u.filter(function(V){return V>1}).map(function(V){return[V,ur(V)]});f.FileIndex.map(function(V,P){return[V,f.FullPaths[P]]}).forEach(function(V){var P=V[0];if(V[1],!!P.name.match(/\.iwa/)){var z=Ha(Oa(P.content));z.forEach(function(le){le.messages.forEach(function(Be){d.forEach(function(de){le.messages.some(function(ce){return Vr(ce.meta[1][0].data)!=11006&&wq(ce.data,de[1])})&&o[de[0]].deps.push(le.id)})})})}});for(var m=ut.find(f,o[1].location),x=Ha(Oa(m.content)),y,E=0;E<x.length;++E){var C=x[E];C.id==1&&(y=C)}var S=Dn(er(y.messages[0].data)[1][0].data);for(m=ut.find(f,o[S].location),x=Ha(Oa(m.content)),E=0;E<x.length;++E)C=x[E],C.id==S&&(y=C);for(S=Dn(er(y.messages[0].data)[2][0].data),m=ut.find(f,o[S].location),x=Ha(Oa(m.content)),E=0;E<x.length;++E)C=x[E],C.id==S&&(y=C);for(S=Dn(er(y.messages[0].data)[2][0].data),m=ut.find(f,o[S].location),x=Ha(Oa(m.content)),E=0;E<x.length;++E)C=x[E],C.id==S&&(y=C);var T=er(y.messages[0].data);{T[6][0].data=ur(n.e.r+1),T[7][0].data=ur(n.e.c+1);var F=Dn(T[46][0].data),_=ut.find(f,o[F].location),Q=Ha(Oa(_.content));{for(var L=0;L<Q.length&&Q[L].id!=F;++L);if(Q[L].id!=F)throw"Bad ColumnRowUIDMapArchive";var R=er(Q[L].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var U=0;U<=n.e.c;++U){var K=[];K[1]=K[2]=[{type:0,data:ur(U+420690)}],R[1].push({type:2,data:Tn(K)}),R[2].push({type:0,data:ur(U)}),R[3].push({type:0,data:ur(U)})}R[4]=[],R[5]=[],R[6]=[];for(var D=0;D<=n.e.r;++D)K=[],K[1]=K[2]=[{type:0,data:ur(D+726270)}],R[4].push({type:2,data:Tn(K)}),R[5].push({type:0,data:ur(D)}),R[6].push({type:0,data:ur(D)});Q[L].messages[0].data=Tn(R)}_.content=zl(jl(Q)),_.size=_.content.length,delete T[46];var ee=er(T[4][0].data);{ee[7][0].data=ur(n.e.r+1);var re=er(ee[1][0].data),Z=Dn(re[2][0].data);_=ut.find(f,o[Z].location),Q=Ha(Oa(_.content));{if(Q[0].id!=Z)throw"Bad HeaderStorageBucket";var ae=er(Q[0].messages[0].data);for(D=0;D<s.length;++D){var Te=er(ae[2][0].data);Te[1][0].data=ur(D),Te[4][0].data=ur(s[D].length),ae[2][D]={type:ae[2][0].type,data:Tn(Te)}}Q[0].messages[0].data=Tn(ae)}_.content=zl(jl(Q)),_.size=_.content.length;var Se=Dn(ee[2][0].data);_=ut.find(f,o[Se].location),Q=Ha(Oa(_.content));{if(Q[0].id!=Se)throw"Bad HeaderStorageBucket";for(ae=er(Q[0].messages[0].data),U=0;U<=n.e.c;++U)Te=er(ae[2][0].data),Te[1][0].data=ur(U),Te[4][0].data=ur(n.e.r+1),ae[2][U]={type:ae[2][0].type,data:Tn(Te)};Q[0].messages[0].data=Tn(ae)}_.content=zl(jl(Q)),_.size=_.content.length;var q=Dn(ee[4][0].data);(function(){for(var V=ut.find(f,o[q].location),P=Ha(Oa(V.content)),z,le=0;le<P.length;++le){var Be=P[le];Be.id==q&&(z=Be)}var de=er(z.messages[0].data);{de[3]=[];var ce=[];l.forEach(function(N,Ie){ce[1]=[{type:0,data:ur(Ie)}],ce[2]=[{type:0,data:ur(1)}],ce[3]=[{type:2,data:vq(N)}],de[3].push({type:2,data:Tn(ce)})})}z.messages[0].data=Tn(de);var ne=jl(P),Ce=zl(ne);V.content=Ce,V.size=V.content.length})();var Ae=er(ee[3][0].data);{var Re=Ae[1][0];delete Ae[2];var ie=er(Re.data);{var Me=Dn(ie[2][0].data);(function(){for(var V=ut.find(f,o[Me].location),P=Ha(Oa(V.content)),z,le=0;le<P.length;++le){var Be=P[le];Be.id==Me&&(z=Be)}var de=er(z.messages[0].data);{delete de[6],delete Ae[7];var ce=new Uint8Array(de[5][0].data);de[5]=[];for(var ne=0,Ce=0;Ce<=n.e.r;++Ce){var N=er(ce);ne+=Iq(N,s[Ce],l),N[1][0].data=ur(Ce),de[5].push({data:Tn(N),type:2})}de[1]=[{type:0,data:ur(n.e.c+1)}],de[2]=[{type:0,data:ur(n.e.r+1)}],de[3]=[{type:0,data:ur(ne)}],de[4]=[{type:0,data:ur(n.e.r+1)}]}z.messages[0].data=Tn(de);var Ie=jl(P),Pe=zl(Ie);V.content=Pe,V.size=V.content.length})()}Re.data=Tn(ie)}ee[3][0].data=Tn(Ae)}T[4][0].data=Tn(ee)}y.messages[0].data=Tn(T);var J=jl(x),k=zl(J);return m.content=k,m.size=m.content.length,f}function b4(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function tv(e){b4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function rv(e){b4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Rq(e){return Lt.WS.indexOf(e)>-1?"sheet":e==Lt.CS?"chart":e==Lt.DS?"dialog":e==Lt.MS?"macro":e&&e.length?e:"sheet"}function Dq(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Rq(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Mq(e,t,r,n,a,s,l,o,u,f,d,m){try{s[n]=jc(wa(e,r,!0),t);var x=sn(e,t),y;switch(o){case"sheet":y=AY(x,t,a,u,s[n],f,d,m);break;case"chart":if(y=sY(x,t,a,u,s[n],f,d,m),!y||!y["!drawel"])break;var E=Qc(y["!drawel"].Target,t),C=ou(E),S=zj(wa(e,E,!0),jc(wa(e,C,!0),E)),T=Qc(S,E),F=ou(T);y=IW(wa(e,T,!0),T,u,jc(wa(e,F,!0),T),f,y);break;case"macro":y=iY(x,t,a,u,s[n],f,d,m);break;case"dialog":y=lY(x,t,a,u,s[n],f,d,m);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=y;var _=[];s&&s[n]&&Kr(s[n]).forEach(function(Q){var L="";if(s[n][Q].Type==Lt.CMNT){L=Qc(s[n][Q].Target,t);var R=fY(sn(e,L,!0),L,u);if(!R||!R.length)return;F2(y,R,!1)}s[n][Q].Type==Lt.TCMNT&&(L=Qc(s[n][Q].Target,t),_=_.concat(Jj(sn(e,L,!0),u)))}),_&&_.length&&F2(y,_,!0,u.people||[])}catch(Q){if(u.WTF)throw Q}}function Da(e){return e.charAt(0)=="/"?e.slice(1):e}function Lq(e,t){if(yo(),t=t||{},tv(t),Ga(e,"META-INF/manifest.xml")||Ga(e,"objectdata.xml"))return O2(e,t);if(Ga(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Pm<"u"){if(e.FileIndex)return Pm(e);var r=ut.utils.cfb_new();return YE(e).forEach(function(Te){Rt(r,Te,W7(e,Te))}),Pm(r)}throw new Error("Unsupported NUMBERS file")}if(!Ga(e,"[Content_Types].xml"))throw Ga(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ga(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=YE(e),a=G9(wa(e,"[Content_Types].xml")),s=!1,l,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",sn(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!sn(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(zc=[],a.sst)try{zc=uY(sn(e,Da(a.sst)),a.sst,t)}catch(Te){if(t.WTF)throw Te}t.cellStyles&&a.themes.length&&(u=cY(wa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=oY(sn(e,Da(a.style)),a.style,u,t))}a.links.map(function(Te){try{var Se=jc(wa(e,ou(Da(Te))),Te);return hY(sn(e,Da(Te)),Se,Te,t)}catch{}});var d=aY(sn(e,Da(a.workbooks[0])),a.workbooks[0],t),m={},x="";a.coreprops.length&&(x=sn(e,Da(a.coreprops[0]),!0),x&&(m=mb(x)),a.extprops.length!==0&&(x=sn(e,Da(a.extprops[0]),!0),x&&W9(x,m,t)));var y={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=wa(e,Da(a.custprops[0]),!0),x&&(y=q9(x,t)));var E={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(Se){return Se.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),t.bookProps&&(E.Props=m,E.Custprops=y),t.bookSheets&&typeof l<"u"&&(E.SheetNames=l),t.bookSheets?E.SheetNames:t.bookProps))return E;l={};var C={};t.bookDeps&&a.calcchain&&(C=dY(sn(e,Da(a.calcchain)),a.calcchain));var S=0,T={},F,_;{var Q=d.Sheets;m.Worksheets=Q.length,m.SheetNames=[];for(var L=0;L!=Q.length;++L)m.SheetNames[L]=Q[L].name}var R=s?"bin":"xml",U=a.workbooks[0].lastIndexOf("/"),K=(a.workbooks[0].slice(0,U+1)+"_rels/"+a.workbooks[0].slice(U+1)+".rels").replace(/^\//,"");Ga(e,K)||(K="xl/_rels/workbook."+R+".rels");var D=jc(wa(e,K,!0),K.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=gY(sn(e,Da(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Yj(sn(e,Da(a.people[0])),t)),D&&(D=Dq(D,d.Sheets));var ee=sn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=m.Worksheets;++S){var re="sheet";if(D&&D[S]?(F="xl/"+D[S][1].replace(/[\/]?xl\//,""),Ga(e,F)||(F=D[S][1]),Ga(e,F)||(F=K.replace(/_rels\/.*$/,"")+D[S][1]),re=D[S][2]):(F="xl/worksheets/sheet"+(S+1-ee)+"."+R,F=F.replace(/sheet0\./,"sheet.")),_=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(m.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Z=!1,ae=0;ae!=t.sheets.length;++ae)typeof t.sheets[ae]=="number"&&t.sheets[ae]==S&&(Z=1),typeof t.sheets[ae]=="string"&&t.sheets[ae].toLowerCase()==m.SheetNames[S].toLowerCase()&&(Z=1);if(!Z)continue e}}Mq(e,F,_,m.SheetNames[S],S,T,l,re,t,d,u,f)}return E={Directory:a,Workbook:d,Props:m,Custprops:y,Deps:C,Sheets:l,SheetNames:m.SheetNames,Strings:zc,Styles:f,Themes:u,SSF:Ir(xt)},t&&t.bookFiles&&(e.files?(E.keys=n,E.files=e.files):(E.keys=[],E.files={},e.FullPaths.forEach(function(Te,Se){Te=Te.replace(/^Root Entry[\/]/,""),E.keys.push(Te),E.files[Te]=e.FileIndex[Se]}))),t&&t.bookVBA&&(a.vba.length>0?E.vbaraw=sn(e,Da(a.vba[0]),!0):a.defaults&&a.defaults.bin===az&&(E.vbaraw=sn(e,"xl/vbaProject.bin",!0))),E}function Hq(e,t){var r=t||{},n="Workbook",a=ut.find(e,n);try{if(n="/!DataSpaces/Version",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(gK(a.content),n="/!DataSpaces/DataSpaceMap",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=pK(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=xK(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);wK(a.content)}catch{}if(n="/EncryptionInfo",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=yK(a.content);if(n="/EncryptedPackage",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Oq(e,t){return t.bookType=="ods"?_4(e,t):t.bookType=="numbers"?Qq(e,t):t.bookType=="xlsb"?Pq(e,t):Gq(e,t)}function Pq(e,t){to=1024,e&&!e.SSF&&(e.SSF=Ir(xt)),e&&e.SSF&&(yo(),Ld(e.SSF),t.revssf=Od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=t4.indexOf(t.bookType)>-1,a=Px();rv(t=t||{});var s=_x(),l="",o=0;if(t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Rt(s,l,pb(e.Props,t)),a.coreprops.push(l),fr(t.rels,2,l,Lt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Rt(s,l,wb(e.Props)),a.extprops.push(l),fr(t.rels,3,l,Lt.EXT_PROPS),e.Custprops!==e.Props&&Kr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Rt(s,l,yb(e.Custprops)),a.custprops.push(l),fr(t.rels,4,l,Lt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Rt(s,l,pY(o-1,l,t,e,d)),a.sheets.push(l),fr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Lt.WS[0])}if(m){var y=m["!comments"],E=!1,C="";y&&y.length>0&&(C="xl/comments"+o+"."+r,Rt(s,C,wY(y,C)),a.comments.push(C),fr(d,-1,"../comments"+o+"."+r,Lt.CMNT),E=!0),m["!legacy"]&&E&&Rt(s,"xl/drawings/vmlDrawing"+o+".vml",Zb(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Rt(s,ou(l),so(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Rt(s,l,vY(t.Strings,l,t)),a.strs.push(l),fr(t.wbrels,-1,"sharedStrings."+r,Lt.SST)),l="xl/workbook."+r,Rt(s,l,mY(e,l)),a.workbooks.push(l),fr(t.rels,1,l,Lt.WB),l="xl/theme/theme1.xml",Rt(s,l,Xx(e.Themes,t)),a.themes.push(l),fr(t.wbrels,-1,"theme/theme1.xml",Lt.THEME),l="xl/styles."+r,Rt(s,l,xY(e,l,t)),a.styles.push(l),fr(t.wbrels,-1,"styles."+r,Lt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Rt(s,l,e.vbaraw),a.vba.push(l),fr(t.wbrels,-1,"vbaProject.bin",Lt.VBA)),l="xl/metadata."+r,Rt(s,l,yY(l)),a.metadata.push(l),fr(t.wbrels,-1,"metadata."+r,Lt.XLMETA),Rt(s,"[Content_Types].xml",hb(a,t)),Rt(s,"_rels/.rels",so(t.rels)),Rt(s,"xl/_rels/workbook."+r+".rels",so(t.wbrels)),delete t.revssf,delete t.ssf,s}function Gq(e,t){to=1024,e&&!e.SSF&&(e.SSF=Ir(xt)),e&&e.SSF&&(yo(),Ld(e.SSF),t.revssf=Od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=t4.indexOf(t.bookType)>-1,a=Px();rv(t=t||{});var s=_x(),l="",o=0;if(t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Rt(s,l,pb(e.Props,t)),a.coreprops.push(l),fr(t.rels,2,l,Lt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Rt(s,l,wb(e.Props)),a.extprops.push(l),fr(t.rels,3,l,Lt.EXT_PROPS),e.Custprops!==e.Props&&Kr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Rt(s,l,yb(e.Custprops)),a.custprops.push(l),fr(t.rels,4,l,Lt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},x=e.Sheets[e.SheetNames[o-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Rt(s,l,f4(o-1,t,e,m)),a.sheets.push(l),fr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Lt.WS[0])}if(x){var E=x["!comments"],C=!1,S="";if(E&&E.length>0){var T=!1;E.forEach(function(F){F[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(S="xl/threadedComments/threadedComment"+o+"."+r,Rt(s,S,Wj(E,d,t)),a.threadedcomments.push(S),fr(m,-1,"../threadedComments/threadedComment"+o+"."+r,Lt.TCMNT)),S="xl/comments"+o+"."+r,Rt(s,S,e4(E)),a.comments.push(S),fr(m,-1,"../comments"+o+"."+r,Lt.CMNT),C=!0}x["!legacy"]&&C&&Rt(s,"xl/drawings/vmlDrawing"+o+".vml",Zb(o,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&Rt(s,ou(l),so(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Rt(s,l,Pb(t.Strings,t)),a.strs.push(l),fr(t.wbrels,-1,"sharedStrings."+r,Lt.SST)),l="xl/workbook."+r,Rt(s,l,p4(e)),a.workbooks.push(l),fr(t.rels,1,l,Lt.WB),l="xl/theme/theme1.xml",Rt(s,l,Xx(e.Themes,t)),a.themes.push(l),fr(t.wbrels,-1,"theme/theme1.xml",Lt.THEME),l="xl/styles."+r,Rt(s,l,Wb(e,t)),a.styles.push(l),fr(t.wbrels,-1,"styles."+r,Lt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Rt(s,l,e.vbaraw),a.vba.push(l),fr(t.wbrels,-1,"vbaProject.bin",Lt.VBA)),l="xl/metadata."+r,Rt(s,l,$b()),a.metadata.push(l),fr(t.wbrels,-1,"metadata."+r,Lt.XLMETA),d.length>1&&(l="xl/persons/person.xml",Rt(s,l,qj(d)),a.people.push(l),fr(t.wbrels,-1,"persons/person.xml",Lt.PEOPLE)),Rt(s,"[Content_Types].xml",hb(a,t)),Rt(s,"_rels/.rels",so(t.rels)),Rt(s,"xl/_rels/workbook."+r+".rels",so(t.wbrels)),delete t.revssf,delete t.ssf,s}function nv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ba(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Vq(e,t){return ut.find(e,"EncryptedPackage")?Hq(e,t):y4(e,t)}function Kq(e,t){var r,n=e,a=t||{};return a.type||(a.type=Mt&&Buffer.isBuffer(e)?"buffer":"base64"),r=V_(n,a),Lq(r,a)}function F4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return jp(e.slice(r),t);default:break e}return uo.to_workbook(e,t)}function jq(e,t){var r="",n=nv(e,t);switch(t.type){case"base64":r=Ba(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Vi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=yr(r)),t.type="binary",F4(r,t)}function zq(e,t){var r=e;return t.type=="base64"&&(r=Ba(r)),r=nu.utils.decode(1200,r.slice(2),"str"),t.type="binary",F4(r,t)}function Xq(e){return e.match(/[^\x00-\x7F]/)?BA(e):e}function Gm(e,t,r,n){return n?(r.type="string",uo.to_workbook(e,r)):uo.to_workbook(t,r)}function Jp(e,t){Bx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Jp(new Uint8Array(e),(r=Ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lo={},r.dateNF&&(lo.dateNF=r.dateNF),r.type||(r.type=Mt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Mt?"buffer":"binary",n=P7(e),typeof Uint8Array<"u"&&!Mt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Xq(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=Ir(r),r.type="array",Jp(Cx(n),r)}switch((a=nv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Vq(ut.read(n,r),r);break;case 9:if(a[1]<=8)return y4(n,r);break;case 60:return jp(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return $V(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Hb.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Kq(n,r):Gm(e,n,r,s);case 239:return a[3]===60?jp(n,r):Gm(e,n,r,s);case 255:if(a[1]===254)return zq(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Oi.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Oi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Kp.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return zb.to_workbook(n,r);break;case 10:case 13:case 32:return jq(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qV.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Kp.to_workbook(n,r):Gm(e,n,r,s)}function U4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return yu(t.file,ut.write(e,{type:Mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ut.write(e,t)}function Jq(e,t){var r=Ir(t||{}),n=Oq(e,r);return Wq(n,r)}function Wq(e,t){var r={},n=Mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?ut.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Md(a))}return t.password&&typeof encrypt_agile<"u"?U4(encrypt_agile(a,t.password),t):t.type==="file"?yu(t.file,a):t.type=="string"?yr(a):a}function Yq(e,t){var r=t||{},n=XY(e,r);return U4(n,r)}function wA(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return au(BA(n));case"binary":return BA(n);case"string":return e;case"file":return yu(t.file,n,"utf8");case"buffer":return Mt?ls(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):wA(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qq(e,t){switch(t.type){case"base64":return au(e);case"binary":return e;case"string":return e;case"file":return yu(t.file,e,"binary");case"buffer":return Mt?ls(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Sf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?au(r):t.type=="string"?yr(r):r;case"file":return yu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function k4(e,t){Bx(),VW(e);var r=Ir(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=k4(e,r);return r.type="array",Md(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wA(OY(e,r),r);case"slk":case"sylk":return wA(Lb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return wA(C4(e.Sheets[e.SheetNames[a]],r),r);case"txt":return qq(N4(e.Sheets[e.SheetNames[a]],r),r);case"csv":return wA(av(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return wA(Hb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Sf(Kp.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return wA(uo.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return wA(zb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return wA(Ob.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return wA(_4(e,r),r);case"wk1":return Sf(Oi.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Sf(Oi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Sf(B4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Yq(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Jq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $q(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Yc(e,t,r){var n={};return n.type="file",n.file=t,$q(n),k4(e,n)}function Zq(e,t,r,n,a,s,l,o){var u=qr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||e[r])for(var y=t.s.c;y<=t.e.c;++y){var E=l?e[r][y]:e[n[y]+u];if(E===void 0||E.t===void 0){if(f===void 0)continue;s[y]!=null&&(x[s[y]]=f);continue}var C=E.v;switch(E.t){case"z":if(C==null)break;continue;case"e":C=C==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(s[y]!=null){if(C==null)if(E.t=="e"&&C===null)x[s[y]]=null;else if(f!==void 0)x[s[y]]=f;else if(d&&C===null)x[s[y]]=null;else continue;else x[s[y]]=d&&(E.t!=="n"||E.t==="n"&&o.rawNumbers!==!1)?C:as(E,C,o);C!=null&&(m=!1)}}return{row:x,isempty:m}}function md(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],l=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=Yt(d);break;case"number":u=Yt(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(a=0);var m=qr(u.s.r),x=[],y=[],E=0,C=0,S=Array.isArray(e),T=u.s.r,F=0,_={};S&&!e[T]&&(e[T]=[]);var Q=f.skipHidden&&e["!cols"]||[],L=f.skipHidden&&e["!rows"]||[];for(F=u.s.c;F<=u.e.c;++F)if(!(Q[F]||{}).hidden)switch(x[F]=Lr(F),r=S?e[T][F]:e[x[F]+m],n){case 1:s[F]=F-u.s.c;break;case 2:s[F]=x[F];break;case 3:s[F]=f.header[F-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=as(r,null,f),C=_[l]||0,!C)_[l]=1;else{do o=l+"_"+C++;while(_[o]);_[l]=C,_[o]=1}s[F]=o}for(T=u.s.r+a;T<=u.e.r;++T)if(!(L[T]||{}).hidden){var R=Zq(e,u,T,x,n,s,S,f);(R.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(y[E++]=R.row)}return y.length=E,y}var j2=/"/g;function e$(e,t,r,n,a,s,l,o){for(var u=!0,f=[],d="",m=qr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var y=o.dense?(e[r]||[])[x]:e[n[x]+m];if(y==null)d="";else if(y.v!=null){u=!1,d=""+(o.rawNumbers&&y.t=="n"?y.v:as(y,null,o));for(var E=0,C=0;E!==d.length;++E)if((C=d.charCodeAt(E))===a||C===s||C===34||o.forceQuotes){d='"'+d.replace(j2,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(u=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(j2,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(l)}function av(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Yt(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(x[E]||{}).hidden||(m[E]=Lr(E));for(var C=0,S=a.s.r;S<=a.e.r;++S)(y[S]||{}).hidden||(d=e$(e,a,S,m,l,u,s,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((C++?o:"")+d)));return delete n.dense,r.join("")}function N4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=av(e,t);return r}function t$(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Yt(e["!ref"]),s="",l=[],o,u=[],f=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)l[o]=Lr(o);for(var d=a.s.r;d<=a.e.r;++d)for(s=qr(d),o=a.s.c;o<=a.e.c;++o)if(t=l[o]+s,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function I4(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var u=typeof n.origin=="string"?Hr(n.origin):n.origin;l=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+a}};if(s["!ref"]){var m=Yt(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(l=m.e.r+1,d.e.r=l+t.length-1+a)}else l==-1&&(l=0,d.e.r=t.length-1+a);var x=n.header||[],y=0;t.forEach(function(C,S){Kr(C).forEach(function(T){(y=x.indexOf(T))==-1&&(x[y=x.length]=T);var F=C[T],_="z",Q="",L=wt({c:o+y,r:l+S+a});f=mu(s,L),F&&typeof F=="object"&&!(F instanceof Date)?s[L]=F:(typeof F=="number"?_="n":typeof F=="boolean"?_="b":typeof F=="string"?_="s":F instanceof Date?(_="d",n.cellDates||(_="n",F=hn(F)),Q=n.dateNF||xt[14]):F===null&&n.nullError&&(_="e",F=0),f?(f.t=_,f.v=F,delete f.w,delete f.R,Q&&(f.z=Q)):s[L]=f={t:_,v:F},Q&&(f.z=Q))})}),d.e.c=Math.max(d.e.c,o+x.length-1);var E=qr(l);if(a)for(y=0;y<x.length;++y)s[Lr(y+o)+E]={t:"s",v:x[y]};return s["!ref"]=kt(d),s}function r$(e,t){return I4(null,e,t)}function mu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Hr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?mu(e,wt(t)):mu(e,wt({r:t,c:r||0}))}function n$(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Av(){return{SheetNames:[],Sheets:{}}}function sv(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(m4(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function a$(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=n$(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function A$(e,t){return e.z=t,e}function Q4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function s$(e,t,r){return Q4(e,"#"+t,r)}function i$(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function l$(e,t,r,n){for(var a=typeof t!="string"?t:Yt(t),s=typeof t=="string"?t:kt(t),l=a.s.r;l<=a.e.r;++l)for(var o=a.s.c;o<=a.e.c;++o){var u=mu(e,l,o);u.t="n",u.F=s,delete u.v,l==a.s.r&&o==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var Rn={encode_col:Lr,encode_row:qr,encode_cell:wt,encode_range:kt,decode_col:Rx,decode_row:Qx,split_cell:v9,decode_cell:Hr,decode_range:la,format_cell:as,sheet_add_aoa:ib,sheet_add_json:I4,sheet_add_dom:E4,aoa_to_sheet:Bo,json_to_sheet:r$,table_to_sheet:S4,table_to_book:gq,sheet_to_csv:av,sheet_to_txt:N4,sheet_to_json:md,sheet_to_html:C4,sheet_to_formulae:t$,sheet_to_row_object_array:md,sheet_get_cell:mu,book_new:Av,book_append_sheet:sv,book_set_sheet_visibility:a$,cell_set_number_format:A$,cell_set_hyperlink:Q4,cell_set_internal_link:s$,cell_add_comment:i$,sheet_set_array_formula:l$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const z2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),X2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M21.16,3.16a1.2,1.2,0,0,0-.81-.29H3.65A1.2,1.2,0,0,0,2.45,4.07V19.93a1.2,1.2,0,0,0,1.2,1.2h16.7a1.2,1.2,0,0,0,1.2-1.2V4.07a1.2,1.2,0,0,0-.39-.91ZM14.21,12.19,11.83,15a.34.34,0,0,1-.31.18.33.33,0,0,1-.3-.17l-2.4-2.82a.33.33,0,0,1,.24-.53h1.37a.33.33,0,0,1,.3.17l1,1.18,1-1.18a.33.33,0,0,1,.3-.17h1.37a.33.33,0,0,1,.24.53Z"})}),Tf=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),J2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),Vm=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),W2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),Km=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Y2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),o$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),_f=({title:e,value:t,icon:r,colorClass:n})=>h.jsxs("div",{className:`p-6 rounded-xl border shadow-sm flex items-center justify-between transition-transform hover:scale-[1.02] ${n}`,children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium opacity-80 uppercase tracking-wide",children:e}),h.jsx("p",{className:"text-3xl font-bold mt-2",children:t})]}),h.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:r})]}),c$=()=>{const{user:e}=ri(),[t,r]=X.useState([]),[n,a]=X.useState([]),[s,l]=X.useState(!0),[o,u]=X.useState([]),[f,d]=X.useState(!0),[m,x]=X.useState(null),[y,E]=X.useState([]),C=X.useRef({}),[S,T]=X.useState("overview"),[F,_]=X.useState(""),[Q,L]=X.useState(null),R=X.useRef({}),[U,K]=X.useState([]),[D,ee]=X.useState([]),[re,Z]=X.useState({mode:"closed"}),[ae,Te]=X.useState(!1),[Se,q]=X.useState({name:"",rows:"8",cols:"10"}),[Ae,Re]=X.useState(""),[ie,Me]=X.useState({subject:"",studentCount:""}),[J,k]=X.useState(""),V=X.useCallback(async()=>{if(!e)return;l(!0);const[oe,je]=await Promise.all([hT(e.id),jL()]);r(oe),a(je),l(!1)},[e]),P=X.useCallback(async()=>{if(!e)return;d(!0);const oe=await WL(e.id);u(oe),d(!1)},[e]),z=X.useCallback(async()=>{if(!e)return;const oe=await tH(e.id);K(oe)},[e]),le=X.useCallback(async()=>{if(!e)return;const oe=await aH(e.id);ee(oe)},[e]),Be=X.useCallback(async()=>{if(!e)return;const oe=await dT(e.id);E(oe)},[e]);X.useEffect(()=>{V(),P(),z(),le(),Be()},[V,P,z,le,Be]);const de=async oe=>{e&&(await zL(oe,e.id),V(),Be())},ce=async oe=>{await XL(oe),V(),Be()},ne=async(oe,je)=>{e&&window.confirm(`Are you sure you want to permanently delete the account for "${je}"? This action cannot be undone and will also delete all exams created by this teacher.`)&&(await JL(oe,e.id)?(await V(),await P(),await Be()):alert("Failed to delete teacher. Ensure you have the correct permissions."))},Ce=async oe=>{e&&window.confirm("Are you sure you want to permanently delete this exam? This action cannot be undone.")&&(await gT(oe,e.id,e.role)?((m==null?void 0:m.id)===oe&&x(null),await P(),await Be()):alert("Failed to delete exam."))},N=async(oe,je)=>{const bt=C.current[oe];if(!bt||!m)return;const ht=bt.style.boxShadow;bt.style.boxShadow="none";const Tt=await Pc(bt,{scale:2,backgroundColor:"#ffffff"});bt.style.boxShadow=ht;const $e=Tt.toDataURL("image/png"),vt=document.createElement("a"),Nt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),Bt=je.replace(/[^a-z0-9]/gi,"_").toLowerCase();vt.download=`${Nt}_${Bt}_plan.png`,vt.href=$e,document.body.appendChild(vt),vt.click(),document.body.removeChild(vt)},Ie=oe=>{oe.seatingPlan&&(R.current={},L(oe.id))},Pe=oe=>{if(!oe.seatingPlan){alert("This exam does not have a seating plan to export.");return}const je=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),bt=Rn.book_new();oe.halls.forEach(Tt=>{var jr,Sr,Ea,Sa;const $e=oe.seatingPlan[Tt.id];if(!$e)return;const vt=$e.reduce((br,gt)=>Math.max(br,gt.length),0);let Nt=[];if(je){const br=[""];for(let gt=0;gt<vt;gt++)br.push(`Seat ${gt+1}`),br.push(`Student ${gt+1}`);Nt.push(br);for(let gt=0;gt<$e.length;gt++){const Mr=[`Row ${gt+1}`];for(let Br=0;Br<vt;Br++){const Ar=(jr=$e[gt])==null?void 0:jr[Br];Mr.push(`r${gt+1}-c${Br+1}`),Mr.push(((Sr=Ar==null?void 0:Ar.student)==null?void 0:Sr.id)||"")}Nt.push(Mr)}}else{const br=[""];for(let gt=0;gt<vt;gt++)br.push(`Col ${gt+1}`);Nt.push(br);for(let gt=0;gt<$e.length;gt++){const Mr=[`Row ${gt+1}`];for(let Br=0;Br<vt;Br++){const Ar=(Ea=$e[gt])==null?void 0:Ea[Br];Mr.push(((Sa=Ar==null?void 0:Ar.student)==null?void 0:Sa.id)||"")}Nt.push(Mr)}}const Bt=Rn.aoa_to_sheet(Nt),qt=Tt.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Rn.book_append_sheet(bt,Bt,qt)});const ht=oe.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Yc(bt,`${ht}_seating_plan.xlsx`)},Ye=oe=>{var jr,Sr,Ea,Sa;if(!m||!m.seatingPlan){alert("Seating plan not available for this hall.");return}const je=m.seatingPlan[oe.id];if(!je)return;const bt=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),ht=Rn.book_new(),Tt=je.reduce((br,gt)=>Math.max(br,gt.length),0);let $e=[];if(bt){const br=[""];for(let gt=0;gt<Tt;gt++)br.push(`Seat ${gt+1}`),br.push(`Student ${gt+1}`);$e.push(br);for(let gt=0;gt<je.length;gt++){const Mr=[`Row ${gt+1}`];for(let Br=0;Br<Tt;Br++){const Ar=(jr=je[gt])==null?void 0:jr[Br];Mr.push(`r${gt+1}-c${Br+1}`),Mr.push(((Sr=Ar==null?void 0:Ar.student)==null?void 0:Sr.id)||"")}$e.push(Mr)}}else{const br=[""];for(let gt=0;gt<Tt;gt++)br.push(`Col ${gt+1}`);$e.push(br);for(let gt=0;gt<je.length;gt++){const Mr=[`Row ${gt+1}`];for(let Br=0;Br<Tt;Br++){const Ar=(Ea=je[gt])==null?void 0:Ea[Br];Mr.push(((Sa=Ar==null?void 0:Ar.student)==null?void 0:Sa.id)||"")}$e.push(Mr)}}const vt=Rn.aoa_to_sheet($e),Nt=oe.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Rn.book_append_sheet(ht,vt,Nt);const Bt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),qt=oe.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Yc(ht,`${Bt}_${qt}_plan.xlsx`)},et=async oe=>{re.mode==="create-template"&&oe.name&&e&&(await Rc({name:oe.name,layout:oe.layout},e.id),await z(),Be()),Z({mode:"closed"})},He=async oe=>{if(oe.preventDefault(),!e)return;Re("");const{name:je,rows:bt,cols:ht}=Se,Tt=parseInt(bt,10),$e=parseInt(ht,10);if(!je.trim()){Re("Template name cannot be empty.");return}if(U.some(Nt=>Nt.name.toLowerCase()===je.trim().toLowerCase())){Re("A template with this name already exists.");return}if(isNaN(Tt)||Tt<=0||Tt>50||isNaN($e)||$e<=0||$e>50){Re("Rows and columns must be numbers between 1 and 50.");return}const vt=[];for(let Nt=0;Nt<Tt;Nt++)for(let Bt=0;Bt<$e;Bt++)vt.push({id:`seat-${Nt}-${Bt}-${Date.now()}`,row:Nt,col:Bt,type:"standard"});await Rc({name:je.trim(),layout:vt},e.id),await z(),Be(),Te(!1),q({name:"",rows:"8",cols:"10"})},ft=async oe=>{e&&window.confirm("Are you sure you want to delete this hall template? This cannot be undone.")&&(await mT(oe,e.id,e.role)?await z():alert("Failed to delete template. You may not have permission."))},Et=async oe=>{if(oe.preventDefault(),k(""),!e)return;const{subject:je,studentCount:bt}=ie,ht=parseInt(bt,10);if(!je.trim()){k("Subject/code cannot be empty.");return}if(isNaN(ht)||ht<=0){k("Student count must be a positive number.");return}if(D.some(Tt=>Tt.subject.toLowerCase()===je.trim().toLowerCase())){k("A template with this subject/code already exists.");return}await cp({subject:je.trim(),studentCount:ht},e.id),Me({subject:"",studentCount:""}),await le(),Be()},lr=async oe=>{e&&window.confirm("Are you sure you want to delete this student set template? This cannot be undone.")&&(await pT(oe,e.id,e.role)?await le():alert("Failed to delete template. You may not have permission."))},Jt=o.find(oe=>oe.id===Q);X.useEffect(()=>{if(!Jt||!Jt.seatingPlan)return;const oe=setTimeout(async()=>{const je=Object.entries(R.current).filter(([,ht])=>ht!==null);if(je.length!==Jt.halls.length){L(null);return}const bt=je.map(async([ht,Tt])=>{const $e=Jt.halls.find(Sr=>Sr.id===ht);if(!Tt||!$e)return;Tt.style.boxShadow="none";const vt=await Pc(Tt,{scale:2,backgroundColor:"#ffffff"});Tt.style.boxShadow="";const Nt=vt.toDataURL("image/png"),Bt=document.createElement("a"),qt=Jt.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),jr=$e.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Bt.download=`${qt}_${jr}_plan.png`,Bt.href=Nt,document.body.appendChild(Bt),Bt.click(),document.body.removeChild(Bt)});await Promise.all(bt),L(null)},100);return()=>clearTimeout(oe)},[Q,Jt]);const Er=oe=>{var je;return e&&e.id===oe?`${e.name} (Admin)`:((je=[...t].find(bt=>bt.id===oe))==null?void 0:je.name)||"Unknown User"};if(m)return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"min-h-screen",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx(tt,{onClick:()=>x(null),variant:"secondary",children:" Back to Dashboard"}),h.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[m.seatingPlan&&h.jsxs(h.Fragment,{children:[h.jsx(tt,{onClick:()=>Ie(m),disabled:!!Q,variant:"secondary",className:"flex items-center",children:Q===m.id?"Downloading...":h.jsxs(h.Fragment,{children:[h.jsx(z2,{className:"mr-2 h-4 w-4"})," Download PNGs"]})}),h.jsxs(tt,{onClick:()=>Pe(m),className:"flex items-center",children:[h.jsx(X2,{className:"mr-2 h-4 w-4"}),"Download Excel"]})]}),h.jsx(tt,{onClick:()=>Ce(m.id),variant:"danger",children:"Delete Exam"})]})]}),h.jsx(jt,{className:"mb-6",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-bold text-violet-700 dark:text-violet-400",children:m.title}),h.jsxs("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:["Date: ",m.date]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-300",children:"Created by:"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:Er(m.createdBy)})]})]})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[h.jsxs(jt,{children:[h.jsxs("h4",{className:"text-lg font-semibold mb-3 border-b pb-2 dark:border-slate-700",children:["Halls (",m.halls.length,")"]}),h.jsx("ul",{className:"space-y-2 text-sm",children:m.halls.map(oe=>h.jsxs("li",{className:"flex justify-between p-2 bg-slate-50 dark:bg-slate-700/50 rounded",children:[h.jsx("span",{children:oe.name}),h.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[oe.layout.filter(je=>je.type!=="faculty").length," seats"]})]},oe.id))})]}),h.jsxs(jt,{children:[h.jsxs("h4",{className:"text-lg font-semibold mb-3 border-b pb-2 dark:border-slate-700",children:["Student Sets (",m.studentSets.length,")"]}),h.jsx("ul",{className:"space-y-2 text-sm",children:m.studentSets.map(oe=>h.jsxs("li",{className:"flex justify-between p-2 bg-slate-50 dark:bg-slate-700/50 rounded",children:[h.jsx("span",{children:oe.subject}),h.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[oe.studentCount," students"]})]},oe.id))})]})]}),h.jsx("div",{className:"lg:col-span-2 space-y-8",children:m.seatingPlan?m.halls.map(oe=>h.jsxs(jt,{ref:je=>{je&&(C.current[oe.id]=je)},children:[h.jsx(Zc,{hall:oe,plan:m.seatingPlan,studentSets:m.studentSets}),h.jsxs("div",{className:"text-center mt-4 flex justify-center gap-2",children:[h.jsxs(tt,{onClick:()=>N(oe.id,oe.name),variant:"secondary",className:"flex items-center mx-auto !py-1 !px-3 text-sm",children:[h.jsx(z2,{className:"mr-2 h-4 w-4"})," Download PNG"]}),h.jsxs(tt,{onClick:()=>Ye(oe),variant:"secondary",className:"flex items-center mx-auto !py-1 !px-3 text-sm",children:[h.jsx(X2,{className:"mr-2 h-4 w-4"})," Download Excel"]})]})]},oe.id)):h.jsxs(jt,{children:[h.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Seating Arrangement"}),h.jsx("div",{className:"text-center text-slate-500 dark:text-slate-400 py-10",children:h.jsx("p",{children:"No seating plan has been generated for this exam yet."})})]})})]})]})]}),Jt&&Jt.id===m.id&&Jt.seatingPlan&&h.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px",zIndex:-1},children:Jt.halls.map(oe=>h.jsx("div",{ref:je=>{je&&(R.current[oe.id]=je)},style:{width:"800px",padding:"1px"},children:h.jsx(jt,{children:h.jsx(Zc,{hall:oe,plan:Jt.seatingPlan,studentSets:Jt.studentSets})})},oe.id))})]});const Zr=t.filter(oe=>oe.name.toLowerCase().includes(F.toLowerCase())||oe.email.toLowerCase().includes(F.toLowerCase())),dt=o.filter(oe=>oe.title.toLowerCase().includes(F.toLowerCase()));return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(yA,{}),re.mode==="create-template"&&h.jsx(dp,{isOpen:!0,onClose:()=>Z({mode:"closed"}),onSave:et,initialLayout:[],isTemplateCreationMode:!0}),ae&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",onClick:()=>Te(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md",onClick:oe=>oe.stopPropagation(),children:[h.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Grid Hall Template"}),h.jsxs("form",{onSubmit:He,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsx(Ut,{label:"Template Name",id:"grid-template-name",value:Se.name,onChange:oe=>q({...Se,name:oe.target.value}),required:!0,placeholder:"e.g., Small Classroom"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx(Ut,{label:"Rows",id:"grid-template-rows",type:"number",min:"1",max:"50",value:Se.rows,onChange:oe=>q({...Se,rows:oe.target.value}),required:!0}),h.jsx(Ut,{label:"Columns",id:"grid-template-cols",type:"number",min:"1",max:"50",value:Se.cols,onChange:oe=>q({...Se,cols:oe.target.value}),required:!0})]}),Ae&&h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:Ae})]}),h.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[h.jsx(tt,{type:"button",variant:"secondary",onClick:()=>Te(!1),children:"Cancel"}),h.jsx(tt,{type:"submit",children:"Save Template"})]})]})]})}),h.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h2",{className:"text-3xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Admin Dashboard"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Manage your institution's teachers, exams, and templates."})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[h.jsx(_f,{title:"Active Exams",value:o.length,icon:h.jsx(Km,{className:"h-6 w-6 text-violet-600 dark:text-violet-300"}),colorClass:"bg-violet-50 border-violet-100 text-violet-900 dark:bg-violet-900/20 dark:border-violet-900/50 dark:text-violet-100"}),h.jsx(_f,{title:"Managed Teachers",value:t.length,icon:h.jsx(Vm,{className:"h-6 w-6 text-blue-600 dark:text-blue-300"}),colorClass:"bg-blue-50 border-blue-100 text-blue-900 dark:bg-blue-900/20 dark:border-blue-900/50 dark:text-blue-100"}),h.jsx(_f,{title:"Templates",value:U.length+D.length,icon:h.jsx(W2,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-300"}),colorClass:"bg-emerald-50 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-900/50 dark:text-emerald-100"}),h.jsx(_f,{title:"Pending Approvals",value:n.length,icon:h.jsx(J2,{className:"h-6 w-6 text-amber-600 dark:text-amber-300"}),colorClass:"bg-amber-50 border-amber-100 text-amber-900 dark:bg-amber-900/20 dark:border-amber-900/50 dark:text-amber-100"})]}),h.jsx("div",{className:"mb-6 border-b border-slate-200 dark:border-slate-700",children:h.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:["overview","teachers","exams","templates"].map(oe=>h.jsxs("button",{onClick:()=>{T(oe),_("")},className:`
                                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize transition-colors
                                    ${S===oe?"border-violet-500 text-violet-600 dark:text-violet-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"}
                                `,children:[oe,oe==="teachers"&&n.length>0&&h.jsx("span",{className:"ml-2 bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200 py-0.5 px-2 rounded-full text-xs",children:n.length})]},oe))})}),h.jsxs("div",{className:"space-y-6",children:[S==="overview"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsx("div",{className:"lg:col-span-2",children:h.jsxs(jt,{className:"h-full",children:[h.jsxs("h3",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:[h.jsx(o$,{className:"h-6 w-6 text-violet-500"})," Recent Activity"]}),h.jsx("div",{className:"max-h-[500px] overflow-y-auto pr-2 custom-scrollbar",children:y.length>0?h.jsx("div",{className:"relative border-l-2 border-slate-200 dark:border-slate-700 ml-3 space-y-6 py-2",children:y.map(oe=>h.jsxs("div",{className:"relative pl-6",children:[h.jsx("div",{className:`absolute -left-[9px] top-1 h-4 w-4 rounded-full border-4 border-white dark:border-slate-800 ${oe.role===At.ADMIN?"bg-red-500":oe.role===At.TEACHER?"bg-blue-500":"bg-green-500"}`}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-slate-400 mb-0.5 font-mono",children:new Date(oe.timestamp).toLocaleString()}),h.jsxs("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[h.jsx("span",{className:`${oe.role===At.ADMIN?"text-red-600 dark:text-red-400":oe.role===At.TEACHER?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400"} font-bold`,children:oe.actorName}),h.jsx("span",{className:"mx-1 text-slate-400",children:""}),oe.action.replace(/_/g," ")]}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:oe.details})]})]},oe.id))}):h.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 py-10 text-sm",children:"No activity logs found."})})]})}),h.jsx("div",{className:"lg:col-span-1",children:h.jsxs(jt,{className:"bg-gradient-to-br from-violet-50 to-white dark:from-slate-800 dark:to-slate-900 border-violet-100 dark:border-slate-700 h-full",children:[h.jsx("h3",{className:"text-lg font-bold mb-4 text-violet-900 dark:text-violet-100",children:"System Health"}),h.jsxs("ul",{className:"space-y-4",children:[h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Total Exams"}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-200",children:o.length})]}),h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Generated Plans"}),h.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:o.filter(oe=>oe.seatingPlan).length})]}),h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Pending Plans"}),h.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:o.filter(oe=>!oe.seatingPlan).length})]}),h.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-white dark:bg-slate-800/50 rounded-lg shadow-sm",children:[h.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Active Teachers"}),h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:t.length})]})]})]})})]}),S==="teachers"&&h.jsxs("div",{className:"space-y-6",children:[n.length>0&&h.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-800 rounded-xl p-6 shadow-sm",children:[h.jsxs("h4",{className:"text-lg font-bold text-amber-800 dark:text-amber-200 mb-4 flex items-center gap-2",children:[h.jsx("div",{className:"p-1 bg-amber-200 dark:bg-amber-800 rounded-full",children:h.jsx(J2,{className:"h-4 w-4"})}),"Pending Approvals (",n.length,")"]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(oe=>h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-amber-100 dark:border-slate-700 flex flex-col justify-between h-full",children:[h.jsxs("div",{className:"mb-3",children:[h.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200",children:oe.name}),h.jsx("p",{className:"text-sm text-slate-500 break-all",children:oe.email})]}),h.jsxs("div",{className:"flex gap-2 mt-auto",children:[h.jsx(tt,{variant:"primary",className:"flex-1 !py-1.5 !text-sm bg-emerald-600 hover:bg-emerald-700",onClick:()=>de(oe.id),children:"Approve"}),h.jsx(tt,{type:"button",variant:"danger",className:"!py-1.5 !px-3 !text-sm",onClick:je=>{je.stopPropagation(),ne(oe.id,oe.name)},children:"Reject"})]})]},oe.id))})]}),h.jsxs(jt,{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[h.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[h.jsx(Vm,{className:"h-6 w-6 text-blue-500"})," Active Staff Directory"]}),h.jsxs("div",{className:"relative w-full sm:w-72",children:[h.jsx(Ut,{placeholder:"Search by name or email...",value:F,onChange:oe=>_(oe.target.value),containerClassName:"mb-0",className:"pl-10"}),h.jsx("div",{className:"absolute left-3 top-2.5 text-slate-400",children:h.jsx(Y2,{className:"h-5 w-5"})})]})]}),s?h.jsx("p",{className:"text-center py-8",children:"Loading staff data..."}):h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[Zr.map(oe=>h.jsxs("div",{className:"group relative p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl border border-transparent hover:border-violet-200 dark:hover:border-slate-600 transition-all shadow-sm hover:shadow-md",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center text-sm font-bold text-white flex-shrink-0 shadow-sm ${oe.permissionGranted?"bg-gradient-to-br from-blue-500 to-blue-600":"bg-red-400"}`,children:oe.name.charAt(0)}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200 truncate",title:oe.name,children:oe.name}),h.jsx("p",{className:"text-xs text-slate-500 truncate",title:oe.email,children:oe.email})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-200 dark:border-slate-700",children:[h.jsx("button",{onClick:()=>oe.permissionGranted?ce(oe.id):de(oe.id),className:`px-3 py-1 text-xs rounded-md border transition-colors ${oe.permissionGranted?"border-amber-200 text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20":"border-emerald-200 text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20"}`,children:oe.permissionGranted?"Revoke Access":"Grant Access"}),h.jsx("button",{type:"button",onClick:je=>{je.stopPropagation(),ne(oe.id,oe.name)},className:"p-1 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors",title:"Delete Account",children:h.jsx(Tf,{className:"h-4 w-4"})})]})]},oe.id)),Zr.length===0&&h.jsx("p",{className:"col-span-full text-center py-12 text-slate-500 italic",children:"No teachers found matching your search."})]})]})]}),S==="exams"&&h.jsxs(jt,{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[h.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[h.jsx(Km,{className:"h-6 w-6 text-violet-500"})," Exam Schedules"]}),h.jsxs("div",{className:"relative w-full sm:w-72",children:[h.jsx(Ut,{placeholder:"Search exams by title...",value:F,onChange:oe=>_(oe.target.value),containerClassName:"mb-0",className:"pl-10"}),h.jsx("div",{className:"absolute left-3 top-2.5 text-slate-400",children:h.jsx(Y2,{className:"h-5 w-5"})})]})]}),f?h.jsx("p",{className:"text-center py-8",children:"Loading exams..."}):dt.length>0?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:dt.map(oe=>h.jsxs("div",{className:"group relative flex flex-col justify-between p-5 bg-white border border-slate-200 hover:border-violet-300 hover:shadow-lg dark:bg-slate-800 dark:border-slate-700 dark:hover:border-violet-600 rounded-xl transition-all duration-200 cursor-pointer h-full",onClick:()=>x(oe),children:[h.jsxs("div",{className:"mb-4",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("p",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 line-clamp-2",title:oe.title,children:oe.title}),h.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide flex-shrink-0 ${oe.seatingPlan?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-300"}`,children:oe.seatingPlan?"Generated":"Pending"})]}),h.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 space-y-1",children:[h.jsxs("p",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"opacity-70",children:""})," ",oe.date]}),h.jsxs("p",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"opacity-70",children:""})," ",Er(oe.createdBy)]}),h.jsxs("p",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"opacity-70",children:""})," ",oe.halls.length," Halls"]})]})]}),h.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100 dark:border-slate-700 mt-auto",children:[h.jsx("div",{className:"text-xs text-slate-400 font-medium group-hover:text-violet-500 transition-colors",children:"View Details "}),h.jsx("button",{type:"button",className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",onClick:je=>{je.stopPropagation(),Ce(oe.id)},title:"Delete Exam",children:h.jsx(Tf,{className:"h-5 w-5"})})]})]},oe.id))}):h.jsxs("div",{className:"text-center py-16 bg-slate-50 dark:bg-slate-800/50 rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-700",children:[h.jsx(Km,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:"No exams found matching your criteria."})]})]}),S==="templates"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h.jsxs(jt,{className:"h-full",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[h.jsx(W2,{className:"h-5 w-5 text-emerald-500"})," Hall Layouts"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(tt,{variant:"secondary",className:"!py-1.5 !px-3 text-xs",onClick:()=>{Te(!0),Re(""),q({name:"",rows:"8",cols:"10"})},children:"+ New Grid"}),h.jsx(tt,{variant:"secondary",className:"!py-1.5 !px-3 text-xs",onClick:()=>Z({mode:"create-template"}),children:"+ Editor"})]})]}),h.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:[U.map(oe=>h.jsx("div",{className:"group relative p-4 bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-700 rounded-lg hover:shadow-md transition-all hover:border-emerald-300",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200",children:oe.name}),h.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[oe.layout.length," seats defined"]}),h.jsxs("p",{className:"text-[10px] text-slate-400 mt-1",children:["Creator: ",Er(oe.createdBy)]})]}),h.jsx("button",{type:"button",onClick:je=>{je.stopPropagation(),ft(oe.id)},className:"text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:"Delete Template",children:h.jsx(Tf,{className:"h-4 w-4"})})]})},oe.id)),U.length===0&&h.jsx("p",{className:"text-center text-sm text-slate-500 py-8 italic",children:"No hall templates created yet."})]})]}),h.jsxs(jt,{className:"h-full",children:[h.jsx("div",{className:"flex justify-between items-center mb-6",children:h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[h.jsx(Vm,{className:"h-5 w-5 text-blue-500"})," Student Sets"]})}),h.jsxs("form",{onSubmit:Et,className:"flex gap-2 mb-6 bg-slate-100 dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:[h.jsx("input",{className:"flex-grow px-3 py-1.5 text-sm rounded border border-slate-300 dark:bg-slate-700 dark:border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none",placeholder:"Subject (e.g. Math 101)",value:ie.subject,onChange:oe=>Me({...ie,subject:oe.target.value})}),h.jsx("input",{type:"number",className:"w-20 px-3 py-1.5 text-sm rounded border border-slate-300 dark:bg-slate-700 dark:border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none",placeholder:"#",value:ie.studentCount,onChange:oe=>Me({...ie,studentCount:oe.target.value})}),h.jsx(tt,{type:"submit",className:"!py-1.5 !px-3 text-sm whitespace-nowrap",children:"Add"})]}),J&&h.jsx("p",{className:"text-xs text-red-600 mb-3 -mt-4",children:J}),h.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:[D.map(oe=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-700 rounded-lg hover:shadow-sm transition-all hover:border-blue-300",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-sm text-slate-800 dark:text-slate-200",children:oe.subject}),h.jsxs("p",{className:"text-xs text-slate-500",children:[oe.studentCount," students"]})]}),h.jsx("button",{type:"button",onClick:je=>{je.stopPropagation(),lr(oe.id)},className:"text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:"Delete Template",children:h.jsx(Tf,{className:"h-4 w-4"})})]},oe.id)),D.length===0&&h.jsx("p",{className:"text-center text-sm text-slate-500 py-8 italic",children:"No student set templates created yet."})]})]})]})]})]})]})},u$=({label:e,id:t,containerClassName:r="",...n})=>h.jsxs("div",{className:r,children:[e&&h.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1",children:e}),h.jsx("textarea",{id:t,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500 transition dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:placeholder-slate-400 dark:focus:ring-violet-400 dark:focus:border-violet-400",rows:4,...n})]}),f$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),d$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),h$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),g$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),m$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),p$=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),x$=({isOpen:e,onClose:t,onSave:r,initialPlan:n,halls:a,studentSets:s,seatDimensions:l})=>{var Be;const[o,u]=X.useState(n),[f,d]=X.useState(((Be=a[0])==null?void 0:Be.id)||""),[m,x]=X.useState(new Set),[y,E]=X.useState(null),[C,S]=X.useState(null),[T,F]=X.useState([]),[_,Q]=X.useState([]),[L,R]=X.useState(-1),[U,K]=X.useState(null);X.useEffect(()=>{var de;if(e){const ce={};Object.keys(n).forEach(Ce=>{ce[Ce]=n[Ce].map(N=>N.map(Ie=>({...Ie})))}),u(ce),d(((de=a[0])==null?void 0:de.id)||""),F([]),x(new Set),K(null);const ne={plan:JSON.parse(JSON.stringify(ce)),holdingStudents:[]};Q([ne]),R(0)}},[e,n,a]);const D=(de,ce)=>{const ne={plan:JSON.parse(JSON.stringify(de)),holdingStudents:JSON.parse(JSON.stringify(ce))},Ce=_.slice(0,L+1);Ce.push(ne),Ce.length>50&&Ce.shift(),Q(Ce),R(Ce.length-1),u(de),F(ce)},ee=X.useCallback(()=>{if(L>0){const de=L-1,ce=_[de];u(JSON.parse(JSON.stringify(ce.plan))),F(JSON.parse(JSON.stringify(ce.holdingStudents))),R(de),x(new Set)}},[_,L]),re=X.useCallback(()=>{if(L<_.length-1){const de=L+1,ce=_[de];u(JSON.parse(JSON.stringify(ce.plan))),F(JSON.parse(JSON.stringify(ce.holdingStudents))),R(de),x(new Set)}},[_,L]);X.useEffect(()=>{const de=ce=>{e&&((ce.metaKey||ce.ctrlKey)&&ce.key==="z"?(ce.preventDefault(),ce.shiftKey?re():ee()):(ce.metaKey||ce.ctrlKey)&&ce.key==="y"&&(ce.preventDefault(),re()))};return window.addEventListener("keydown",de),()=>window.removeEventListener("keydown",de)},[e,ee,re]);const Z=(de,ce,ne)=>`${de}-${ce}-${ne}`,ae=(de,ce,ne,Ce,N)=>{if(de.stopPropagation(),!N){de.shiftKey||x(new Set);return}const Ie=Z(ce,ne,Ce),Pe=new Set(de.shiftKey?m:[]);Pe.has(Ie)?Pe.delete(Ie):Pe.add(Ie),x(Pe)},Te=()=>{x(new Set)},Se=(de,ce,ne,Ce,N)=>{const Ie=Z(ce,ne,Ce);m.has(Ie)||x(new Set([Ie])),E({hallId:ce,row:ne,col:Ce,student:N}),S(null),de.dataTransfer.effectAllowed="move",document.body.classList.add("cursor-grabbing")},q=(de,ce)=>{S(ce),E(null),x(new Set),de.dataTransfer.effectAllowed="move"},Ae=()=>{document.body.classList.remove("cursor-grabbing")},Re=de=>{de.preventDefault(),de.dataTransfer.dropEffect="move"},ie=(de,ce,ne,Ce)=>{var et;de.preventDefault();const N=o[ce];if(!N)return;const Ie=(et=N[ne])==null?void 0:et[Ce];if(!Ie)return;const Pe={...o};let Ye=[...T];if(y){const He=ne-y.row,ft=Ce-y.col,Et=[],lr=[],Jt=(dt,oe,je)=>{var bt,ht;return(ht=(bt=Pe[dt])==null?void 0:bt[oe])==null?void 0:ht[je]};for(const dt of m){const[oe,je,bt]=dt.split("-"),ht=parseInt(je),Tt=parseInt(bt),$e=Jt(oe,ht,Tt);if($e&&$e.student){Et.push({hallId:oe,row:ht,col:Tt,student:$e.student});const vt=ce,Nt=ht+He,Bt=Tt+ft,qt=Jt(vt,Nt,Bt);if(!qt)return;lr.push({hallId:vt,row:Nt,col:Bt,existingStudent:qt.student})}}const Er=new Map;Et.forEach((dt,oe)=>{const je=lr[oe];Er.set(Z(je.hallId,je.row,je.col),dt.student),je.existingStudent?Et.some(ht=>ht.hallId===je.hallId&&ht.row===je.row&&ht.col===je.col)||Er.set(Z(dt.hallId,dt.row,dt.col),je.existingStudent):Er.has(Z(dt.hallId,dt.row,dt.col))||Er.set(Z(dt.hallId,dt.row,dt.col),void 0)}),Er.forEach((dt,oe)=>{const[je,bt,ht]=oe.split("-"),Tt=Jt(je,parseInt(bt),parseInt(ht));Tt&&(dt?Tt.student=dt:delete Tt.student)});const Zr=new Set;lr.forEach(dt=>{Zr.add(Z(dt.hallId,dt.row,dt.col))}),x(Zr),D(Pe,Ye)}else C&&(Ie.student?(Ye=Ye.filter(He=>He.id!==C.id),Ye.push(Ie.student),Ie.student=C):(Ye=Ye.filter(He=>He.id!==C.id),Ie.student=C),D(Pe,Ye));E(null),S(null)},Me=de=>{if(de.preventDefault(),y){const ce={...o};let ne=[...T];const Ce=[],N=new Set,Ie=Pe=>(N.has(Pe)||(ce[Pe]=ce[Pe].map(Ye=>Ye.map(et=>({...et}))),N.add(Pe)),ce[Pe]);if(m.size>0)m.forEach(Pe=>{var lr;const[Ye,et,He]=Pe.split("-"),ft=Ie(Ye),Et=(lr=ft==null?void 0:ft[parseInt(et)])==null?void 0:lr[parseInt(He)];Et&&Et.student&&(Ce.push(Et.student),delete Et.student)}),x(new Set);else{const Ye=Ie(y.hallId)[y.row][y.col];Ye.student&&(Ce.push(Ye.student),delete Ye.student)}Ce.length>0&&(ne=[...ne,...Ce]),D(ce,ne)}E(null),S(null)},J=()=>{if(T.length>0){K(`Cannot save changes! There are ${T.length} students currently unseated in the holding area.`),setTimeout(()=>K(null),5e3);return}r(o),t()},k=de=>{const ce=s.findIndex(ne=>ne.id===de);return ce>=0?Ps[ce%Ps.length]:"bg-gray-200"},V=()=>{if(!f)return;const de=o[f],ce=new Set;de.forEach((ne,Ce)=>{ne.forEach((N,Ie)=>{N&&N.student&&ce.add(Z(f,Ce,Ie))})}),x(ce)};if(!e)return null;const P=l!=null&&l.width?`${l.width/16}rem`:"7rem",z=l!=null&&l.height?`${l.height/16}rem`:"4rem",le=l!=null&&l.fontSize?`${l.fontSize}px`:"0.75rem";return h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex justify-center items-center z-50 p-4",onClick:t,children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full h-full max-w-[95vw] max-h-[95vh] flex flex-col overflow-hidden relative",onClick:de=>de.stopPropagation(),children:[h.jsxs("header",{className:"bg-white dark:bg-slate-900 border-b dark:border-slate-800 flex flex-col sm:flex-row justify-between items-center px-6 py-3 gap-4 shadow-sm z-20",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-2 bg-violet-100 dark:bg-violet-900/30 rounded-lg",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-violet-600 dark:text-violet-400",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Seating Editor"}),h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 hidden sm:block",children:["Drag to move. ",h.jsx("kbd",{className:"bg-slate-200 dark:bg-slate-700 px-1 rounded font-mono",children:"Shift+Click"})," for multi-select."]})]})]}),h.jsx("div",{className:"flex overflow-x-auto max-w-lg p-1 bg-slate-100 dark:bg-slate-800 rounded-lg no-scrollbar",children:a.map(de=>h.jsx("button",{onClick:ce=>{ce.stopPropagation(),d(de.id)},className:`px-4 py-2 text-sm font-semibold rounded-md transition-all whitespace-nowrap flex-1 ${f===de.id?"bg-white dark:bg-slate-700 text-violet-600 dark:text-violet-400 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:de.name},de.id))}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"flex gap-1 mr-2 border-r dark:border-slate-700 pr-3",children:[h.jsx("button",{onClick:ee,disabled:L<=0,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Undo (Ctrl+Z)",children:h.jsx(m$,{})}),h.jsx("button",{onClick:re,disabled:L>=_.length-1,className:"p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-slate-600 dark:text-slate-300 transition-colors",title:"Redo (Ctrl+Y)",children:h.jsx(p$,{})})]}),h.jsx(tt,{onClick:t,variant:"secondary",className:"!px-4",children:"Cancel"}),h.jsxs(tt,{onClick:J,className:"flex items-center !px-5 shadow-lg shadow-violet-500/20",children:[h.jsx(f$,{})," Save"]})]})]}),h.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[h.jsxs("aside",{className:"w-80 flex-shrink-0 flex flex-col bg-slate-50 dark:bg-slate-800/50 border-r dark:border-slate-800 shadow-inner",children:[h.jsxs("div",{className:"p-4 flex-grow flex flex-col overflow-hidden",children:[h.jsx("div",{className:"flex justify-between items-center mb-2",children:h.jsxs("h3",{className:"font-bold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:["Holding Area",h.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${T.length>0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-slate-200 text-slate-600 dark:bg-slate-700 dark:text-slate-400"}`,children:T.length})]})}),h.jsxs("div",{className:`flex-grow border-2 border-dashed rounded-xl p-3 overflow-y-auto transition-all ${T.length>0?"border-amber-400 bg-amber-50 dark:bg-amber-900/10 dark:border-amber-500/50":"border-slate-300 dark:border-slate-700 bg-slate-100/50 dark:bg-slate-900/30"} hover:border-violet-400 dark:hover:border-violet-500`,onDragOver:Re,onDrop:Me,children:[h.jsx("div",{className:"grid grid-cols-2 gap-2",children:T.map(de=>h.jsx("div",{draggable:!0,onDragStart:ce=>q(ce,de),onDragEnd:Ae,className:`
                                                p-2 rounded-lg text-xs text-center font-bold cursor-grab active:cursor-grabbing 
                                                shadow-sm border border-black/5 text-slate-900 hover:shadow-md transition-all 
                                                ${k(de.setId)}
                                            `,children:de.id},de.id))}),T.length===0&&h.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 gap-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),h.jsx("p",{className:"text-sm font-medium",children:"Drop Students Here"}),h.jsx("p",{className:"text-xs opacity-75 text-center px-4",children:"Drag students off the grid to unseat them temporarily."})]})]})]}),h.jsxs("div",{className:"p-4 border-t dark:border-slate-800 bg-white dark:bg-slate-900/50",children:[h.jsx("h4",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:"Student Sets"}),h.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:s.map((de,ce)=>h.jsxs("div",{className:"flex items-center text-xs group",children:[h.jsx("div",{className:`w-3 h-3 rounded-full mr-2 shadow-sm ${Ps[ce%Ps.length]}`}),h.jsx("span",{className:"truncate font-medium text-slate-700 dark:text-slate-300",children:de.subject}),h.jsx("span",{className:"ml-auto text-slate-400 text-[10px] bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:de.studentCount})]},de.id))})]})]}),h.jsxs("main",{className:"flex-grow flex flex-col bg-slate-100 dark:bg-[#0B1120] relative overflow-auto custom-scrollbar",style:{backgroundImage:"radial-gradient(#CBD5E1 1px, transparent 1px)",backgroundSize:"20px 20px"},onClick:Te,children:[h.jsxs("div",{className:"sticky top-4 left-1/2 transform -translate-x-1/2 bg-white/90 dark:bg-slate-800/90 backdrop-blur shadow-lg rounded-full px-4 py-2 flex items-center gap-3 z-30 border dark:border-slate-700 w-max mx-auto",children:[h.jsxs("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mr-2",children:["Selection: ",m.size]}),h.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"}),h.jsx("button",{onClick:V,className:"text-xs font-medium hover:text-violet-600 dark:hover:text-violet-400 transition-colors",children:"Select All"}),h.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"}),h.jsx("button",{onClick:()=>x(new Set),className:"text-xs font-medium hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Clear"})]}),h.jsx("div",{className:"flex-grow flex justify-center items-start min-h-full min-w-full pt-20 pb-40 pl-40 pr-40",children:f&&o[f]&&(()=>{const de=o[f],ce=de.reduce((ne,Ce)=>Math.max(ne,Ce.length),0);return h.jsxs("div",{className:"relative grid gap-4 p-12 bg-white dark:bg-slate-800 rounded-2xl shadow-xl border dark:border-slate-700 w-max",style:{gridTemplateColumns:`repeat(${ce}, minmax(${P}, 1fr))`},onClick:ne=>ne.stopPropagation(),children:[h.jsx("div",{className:"absolute -inset-8 border-2 border-transparent pointer-events-none rounded-3xl"}),de.map((ne,Ce)=>ne.map((N,Ie)=>{var ft;if(!N)return h.jsx("div",{style:{height:z,width:P},className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg opacity-50"},`${Ce}-${Ie}`);const Pe=!!N.student,Ye=Pe?k(N.student.setId):"bg-slate-100 dark:bg-slate-700",et=Z(f,Ce,Ie),He=m.has(et);return h.jsxs("div",{onDragOver:Re,onDrop:Et=>ie(Et,f,Ce,Ie),draggable:Pe,onDragStart:Et=>Pe&&Se(Et,f,Ce,Ie,N.student),onDragEnd:Ae,onClick:Et=>ae(Et,f,Ce,Ie,N.student),className:`
                                                            rounded-xl flex flex-col items-center justify-center font-bold
                                                            border transition-all duration-200 relative px-2
                                                            ${Ye}
                                                            ${Pe?"cursor-grab active:cursor-grabbing border-transparent text-slate-900 shadow-sm hover:shadow-md hover:-translate-y-0.5":"border-slate-200 dark:border-slate-600 border-dashed text-slate-300 dark:text-slate-600"}
                                                            ${N.type==="faculty"?"ring-2 ring-yellow-400":""}
                                                            ${N.type==="accessible"?"ring-2 ring-blue-400":""}
                                                            ${He?"ring-4 ring-indigo-500 z-10 shadow-xl scale-105":""}
                                                        `,style:{height:z,width:P,fontSize:le},title:`R${Ce+1} C${Ie+1} ${N.student?`(${N.student.id})`:"Empty"}`,children:[He&&h.jsx("div",{className:"absolute -top-2 -right-2 bg-indigo-600 text-white rounded-full p-0.5 shadow-md",children:h.jsx(d$,{})}),Pe?h.jsx("span",{className:"break-all text-center leading-tight",children:(ft=N.student)==null?void 0:ft.id}):h.jsxs("span",{className:"text-[10px] font-mono opacity-50",children:[Ce+1,"-",Ie+1]})]},`${N.hallId}-${Ce}-${Ie}`)}).concat(Array.from({length:ce-ne.length}).map((N,Ie)=>h.jsx("div",{style:{height:z,width:P}},`pad-${Ce}-${Ie}`))))]})})()})]})]}),U&&h.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 z-50 animate-bounce-in",children:h.jsxs("div",{className:"bg-red-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-4 border border-red-500 max-w-md",children:[h.jsx(g$,{}),h.jsxs("div",{className:"flex-grow",children:[h.jsx("h4",{className:"font-bold",children:"Cannot Save Changes"}),h.jsx("p",{className:"text-sm text-red-100",children:U})]}),h.jsx("button",{onClick:()=>K(null),className:"text-red-200 hover:text-white",children:h.jsx(h$,{})})]})})]})})},bf=e=>{let t=0;e.forEach(s=>{s.students&&s.students.length>0&&s.students.forEach(l=>{l&&l.length>t&&(t=l.length)})});let r=80,n=60,a=12;return t>10&&t<=15?(r=100,n=70,a=11):t>15&&t<=20?(r=120,n=80,a=10):t>20&&(r=140,n=90,a=9),{width:r,height:n,fontSize:a}},v$=e=>{let t=0;return e.studentSets.forEach(r=>{r.students&&r.students.length>0&&r.students.forEach(n=>{n&&n.length>t&&(t=n.length)})}),t},Ff=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})}),Uf=({className:e})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 20 20",fill:"currentColor",children:[h.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),h.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]}),kf=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Bc=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm1.8 18H14l-2-3.4-2 3.4H8.2l2.9-4.5L8.2 11H10l2 3.4 2-3.4h1.8l-2.9 4.5 2.9 4.5zM13 9V3.5L18.5 9H13z"})}),_i=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),bi=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Fi=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6V4m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM12 10v2m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM12 18v2m-6-16v2m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM6 14v6m6-16v6m0 2a2 2 0 100 4v0a2 2 0 100-4v0zM18 6v10m0 2a2 2 0 100 4v0a2 2 0 100-4v0z"})}),Cc=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),jm=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),w$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),y$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),Ma=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),Ms=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13 0H11"})}),B$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),q2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),$2=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Z2=e=>{if(e.length===0)return{isGrid:!1};let t=-1,r=-1;for(const l of e)l.row>t&&(t=l.row),l.col>r&&(r=l.col);const n=t+1,a=r+1;if(e.length!==n*a)return{isGrid:!1};const s=new Set(e.map(l=>`${l.row},${l.col}`));for(let l=0;l<n;l++)for(let o=0;o<a;o++)if(!s.has(`${l},${o}`))return{isGrid:!1};return{isGrid:!0,rows:n,cols:a}},C$=()=>{var fs,yn,oi,_a;const{user:e}=ri(),[t,r]=X.useState([]),[n,a]=X.useState([]),[s,l]=X.useState([]),[o,u]=X.useState([]),[f,d]=X.useState(!0),[m,x]=X.useState(null),[y,E]=X.useState(""),[C,S]=X.useState(""),[T,F]=X.useState(!1),[_,Q]=X.useState({mode:"closed",hallIndex:null}),[L,R]=X.useState(!1),[U,K]=X.useState({name:"",rows:"8",cols:"10"}),[D,ee]=X.useState(""),[re,Z]=X.useState({open:!1,index:null}),ae=X.useRef({}),Te=X.useRef([]),[Se,q]=X.useState(null),[Ae,Re]=X.useState(null),[ie,Me]=X.useState(!1),J=X.useRef({}),[k,V]=X.useState({subject:"",studentCount:""}),[P,z]=X.useState(""),[le,Be]=X.useState(null),[de,ce]=X.useState(null),[ne,Ce]=X.useState([]),[N,Ie]=X.useState(null),[Pe,Ye]=X.useState([]),[et,He]=X.useState("ai"),[ft,Et]=X.useState(!1),[lr,Jt]=X.useState(!1),[Er,Zr]=X.useState({width:80,height:60,fontSize:12}),dt={id:"",title:"",date:"",halls:[],studentSets:[],aiSeatingRules:"",seatingType:"normal",editorMode:"ai",createdBy:(e==null?void 0:e.id)||"",adminId:(e==null?void 0:e.adminId)||""};X.useEffect(()=>{if(m&&m.studentSets.length>0){const{width:Y,height:fe,fontSize:Ne}=bf(m.studentSets);Zr({width:Y,height:fe,fontSize:Ne})}},[m]);const oe=X.useCallback(async()=>{if(e){const Y=await qL(e.id);r(Y)}},[e]),je=X.useCallback(async()=>{if(e){const Y=await eH(e.id);a(Y)}},[e]),bt=X.useCallback(async()=>{if(e){const Y=await nH(e.id);l(Y)}},[e]),ht=X.useCallback(async()=>{if(e&&e.adminId){const Y=await hT(e.adminId);u(Y)}},[e]);X.useEffect(()=>{(async()=>{e!=null&&e.permissionGranted&&(d(!0),await Promise.all([oe(),je(),bt(),ht()])),d(!1)})()},[oe,je,bt,ht,e]);const Tt=Y=>{if(Y===(e==null?void 0:e.id))return"Me";const fe=o.find(Ne=>Ne.id===Y);return fe?fe.name:"Unknown"},$e=(Y,fe)=>{m&&x(Ne=>Ne?{...Ne,[Y]:fe}:null)},vt=Y=>{m&&x(fe=>fe?{...fe,editorMode:Y,seatingType:"normal"}:null)},Nt=Y=>{m&&x(fe=>fe?{...fe,seatingType:Y}:null)},Bt=(Y,fe)=>{if(!m)return;const Ne=[...m.halls];Ne[Y]={...Ne[Y],name:fe},x(De=>De?{...De,halls:Ne}:null)},qt=(Y,fe)=>{if(!m)return;const Ne=[...m.halls];Ne[Y]={...Ne[Y],frontDirection:fe},x(De=>De?{...De,halls:Ne}:null)},jr=()=>{if(!m)return;const Y=`Hall ${String.fromCharCode(65+m.halls.length)}`,fe={id:`new-hall-${Date.now()}`,name:Y,layout:[],constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"};x(Ne=>Ne?{...Ne,halls:[...Ne.halls,fe]}:null)},Sr=(Y,fe)=>{if(m)if(fe==="normal"){const Ne=[];for(let it=0;it<8;it++)for(let lt=0;lt<10;lt++)Ne.push({id:`seat-${it}-${lt}-${Date.now()}`,row:it,col:lt,type:"standard"});const Ve=[...m.halls];Ve[Y]={...Ve[Y],layout:Ne},x(it=>it?{...it,halls:Ve}:null)}else Q({mode:"edit-hall",hallIndex:Y})},Ea=(Y,fe,Ne)=>{if(!m)return;const De=Z2(m.halls[Y].layout);let ye=De.isGrid?De.rows:8,Ve=De.isGrid?De.cols:10;const it=parseInt(Ne,10);if(isNaN(it)||it<=0||it>50)return;fe==="rows"?ye=it:Ve=it;const lt=[];for(let mr=0;mr<ye;mr++)for(let Ht=0;Ht<Ve;Ht++)lt.push({id:`seat-${mr}-${Ht}-${Date.now()}`,row:mr,col:Ht,type:"standard"});const zt=[...m.halls];zt[Y]={...zt[Y],layout:lt},x(mr=>mr?{...mr,halls:zt}:null)},Sa=Y=>{if(!m)return;let fe=Y.name;m.halls.some(De=>De.name===fe)&&(fe=`${fe} (Copy)`);const Ne={id:`hall-from-template-${Date.now()}`,name:fe,layout:Y.layout.map(De=>({...De})),constraints:{type:"no-limit",arrangement:"horizontal"},frontDirection:"top"};x(De=>De?{...De,halls:[...De.halls,Ne]}:null)},br=async Y=>{if(_.mode==="create-template"&&Y.name&&e)await Rc({name:Y.name,layout:Y.layout},e.id),await je();else if(_.mode==="edit-template"&&_.templateId&&Y.name&&e)await rH(_.templateId,{name:Y.name,layout:Y.layout},e.id),await je();else if(_.mode==="edit-hall"&&_.hallIndex!==null&&m){const fe=_.hallIndex,Ne=[...m.halls];Ne[fe]={...Ne[fe],layout:Y.layout},x(De=>De?{...De,halls:Ne}:null)}Q({mode:"closed",hallIndex:null})},gt=Y=>{m&&x(fe=>fe?{...fe,halls:fe.halls.filter((Ne,De)=>De!==Y)}:null)},Mr=(Y,fe)=>{if(!m)return;const Ne=[...m.halls],De=Ne[Y];let ye={...De.constraints||{arrangement:"horizontal"},type:fe};fe==="advanced"&&!ye.allowedSetIds&&(ye.allowedSetIds=[]),Ne[Y]={...De,constraints:ye},x(Ve=>Ve?{...Ve,halls:Ne}:null)},Br=(Y,fe)=>{if(!m)return;const Ne=[...m.halls],De=Ne[Y];Ne[Y]={...De,constraints:{...De.constraints||{type:"no-limit"},arrangement:fe}},x(ye=>ye?{...ye,halls:Ne}:null)},Ar=(Y,fe,Ne)=>{var Ve;if(!m)return;const De=[...m.halls],ye=De[Y];if(((Ve=ye.constraints)==null?void 0:Ve.type)==="advanced"){const it=ye.constraints.allowedSetIds||[],lt=Ne?[...it,fe]:it.filter(zt=>zt!==fe);De[Y]={...ye,constraints:{...ye.constraints,allowedSetIds:lt}},x(zt=>zt?{...zt,halls:De}:null)}},bA=(Y,fe,Ne)=>{if(!m)return;const De=[...m.studentSets];De[Y]={...De[Y],[fe]:Ne},x(ye=>ye?{...ye,studentSets:De}:null)},FA=()=>{if(!m)return;const Y={id:`new-set-${Date.now()}`,subject:"",studentCount:"",isPlaceholder:!0};x(fe=>fe?{...fe,studentSets:[...fe.studentSets,Y]}:null)},rl=(Y,fe,Ne)=>{if(!m)return;const De=[...m.studentSets];if(fe==="custom")De[Y]={...De[Y],subject:"",studentCount:"",isPlaceholder:!1};else if(fe==="template"&&Ne){let ye=Ne.subject;m.studentSets.some((Ve,it)=>it!==Y&&Ve.subject===ye)&&(ye=`${ye} (Copy)`),De[Y]={...De[Y],subject:ye,studentCount:Ne.studentCount,isPlaceholder:!1}}x(ye=>ye?{...ye,studentSets:De}:null)},nl=(Y,fe)=>{if(!Y.target.files||Y.target.files.length===0)return;const Ne=Y.target.files[0],De=new FileReader;De.onload=ye=>{var Ve;if((Ve=ye.target)!=null&&Ve.result)try{const it=Jp(ye.target.result,{type:"binary"}),lt=it.SheetNames[0];if(!lt){E("The Excel file doesn't contain any sheets.");return}const zt=it.Sheets[lt],Ht=Rn.sheet_to_json(zt,{header:1,defval:"",blankrows:!1}).flat().map(It=>String(It).trim()).filter(It=>It!=="");if(Ht.length>0){const It={id:`excel-set-${Date.now()}-${lt}`,subject:lt,studentCount:Ht.length,students:Ht,isPlaceholder:!1};x(en=>{if(!en)return null;const Tr=[...en.studentSets];Tr.splice(fe,1,It);const{width:mt,height:ot,fontSize:sr}=bf(Tr);return Zr({width:mt,height:ot,fontSize:sr}),{...en,studentSets:Tr}}),E("")}else E("No student register numbers found in the Excel sheet. The sheet appears to be empty.")}catch(it){console.error("Error parsing Excel file:",it),E("There was an error processing the Excel file. Please ensure it is a valid .xlsx or .xls file.")}finally{Y.target&&(Y.target.value="")}},De.onerror=ye=>{console.error("FileReader error:",ye),E("Failed to read the file."),Y.target&&(Y.target.value="")},De.readAsBinaryString(Ne)},si=Y=>{if(!m)return;const fe=[...m.studentSets],Ne=fe[Y].id;fe[Y]={id:Ne,subject:"",studentCount:"",isPlaceholder:!0},x(De=>De?{...De,studentSets:fe}:null)},fA=Y=>{m&&x(fe=>fe?{...fe,studentSets:fe.studentSets.filter((Ne,De)=>De!==Y)}:null)},Eo=async Y=>{if(!e||!Y.name.trim()||Y.layout.length===0)return;const fe=Y.name.trim();if(!n.some(Ne=>Ne.name.toLowerCase()===fe.toLowerCase())){ce(Y.id);try{await Rc({name:fe,layout:Y.layout},e.id),await je(),Ce(Ne=>[...Ne,Y.id]),setTimeout(()=>{Ce(Ne=>Ne.filter(De=>De!==Y.id))},3e3)}catch(Ne){console.error("Failed to save hall template:",Ne)}finally{ce(null)}}},al=async Y=>{if(Y.preventDefault(),!e)return;ee("");const{name:fe,rows:Ne,cols:De}=U,ye=parseInt(Ne,10),Ve=parseInt(De,10);if(!fe.trim()){ee("Template name cannot be empty.");return}if(n.some(lt=>lt.name.toLowerCase()===fe.trim().toLowerCase())){ee("A template with this name already exists.");return}if(isNaN(ye)||ye<=0||ye>50||isNaN(Ve)||Ve<=0||Ve>50){ee("Rows and columns must be numbers between 1 and 50.");return}const it=[];for(let lt=0;lt<ye;lt++)for(let zt=0;zt<Ve;zt++)it.push({id:`seat-${lt}-${zt}-${Date.now()}`,row:lt,col:zt,type:"standard"});await Rc({name:fe.trim(),layout:it},e.id),await je(),R(!1),K({name:"",rows:"8",cols:"10"})},us=Y=>{Q({mode:"edit-template",hallIndex:null,templateId:Y.id,templateName:Y.name})},Al=async Y=>{e&&window.confirm("Are you sure you want to delete this hall template? This cannot be undone.")&&(await mT(Y,e.id,e.role),await je())},ii=async Y=>{if(Y.preventDefault(),z(""),!e)return;const{subject:fe,studentCount:Ne}=k,De=parseInt(Ne,10);if(!fe.trim()){z("Subject/code cannot be empty.");return}if(isNaN(De)||De<=0){z("Student count must be a positive number.");return}if(le)await AH(le,{subject:fe.trim(),studentCount:De},e.id),Be(null);else{if(s.some(ye=>ye.subject.toLowerCase()===fe.trim().toLowerCase())){z("A template with this subject/code already exists.");return}await cp({subject:fe.trim(),studentCount:De},e.id)}V({subject:"",studentCount:""}),await bt()},li=Y=>{V({subject:Y.subject,studentCount:Y.studentCount.toString()}),Be(Y.id)},I=()=>{V({subject:"",studentCount:""}),Be(null)},j=async Y=>{if(!e)return;const fe=Y.subject.trim(),Ne=parseInt(String(Y.studentCount),10);if(!(!fe||isNaN(Ne)||Ne<=0)&&!s.some(De=>De.subject.toLowerCase()===fe.toLowerCase())){Ie(Y.id);try{await cp({subject:fe,studentCount:Ne},e.id),await bt(),Ye(De=>[...De,Y.id]),setTimeout(()=>{Ye(De=>De.filter(ye=>ye!==Y.id))},3e3)}catch(De){console.error("Failed to save student set template:",De)}finally{Ie(null)}}},H=async Y=>{e&&window.confirm("Are you sure you want to delete this student set template? This cannot be undone.")&&(await pT(Y,e.id,e.role),le===Y&&I(),await bt())},O=()=>{if(!m)return null;if(!m.title.trim()||!m.date||m.halls.length===0||m.studentSets.length===0)return E("Please fill in all exam details, and add at least one hall and one student set."),null;if(m.halls.some(Y=>Y.layout.length===0))return E("One or more halls has an empty layout. Please design a layout for each hall."),null;if(m.studentSets.some(Y=>Y.isPlaceholder))return E("Please configure all student sets before saving or generating a plan."),null;try{const Y=m.studentSets.map(fe=>{const Ne=parseInt(String(fe.studentCount),10);if(isNaN(Ne)||Ne<=0)throw new Error(`Invalid student count for set "${fe.subject}". Please enter a positive number.`);return{...fe,id:fe.id||`set-${Date.now()}`,studentCount:Ne}});return{...m,halls:m.halls.map(fe=>({...fe,id:fe.id||`hall-${Date.now()}`})),studentSets:Y,id:m.id||void 0,createdBy:m.createdBy||(e==null?void 0:e.id)||"",adminId:m.adminId||(e==null?void 0:e.adminId)||""}}catch(Y){return E(Y.message),null}},G=async()=>{if(!m||!e)return;E(""),S("");const Y=O();if(Y){if(Y.id){const fe=t.find(Ne=>Ne.id===Y.id);if(fe){const Ne=JSON.stringify(Y.halls)!==JSON.stringify(fe.halls),De=JSON.stringify(Y.studentSets)!==JSON.stringify(fe.studentSets),ye=Y.aiSeatingRules!==fe.aiSeatingRules,Ve=Y.seatingType!==fe.seatingType,it=Y.editorMode!==fe.editorMode;(Ne||De||ye||Ve||it)&&Y.seatingPlan&&(Y.seatingPlan=void 0)}}d(!0),Y.id?await sm(Y):await $L({title:Y.title,date:Y.date,halls:Y.halls,studentSets:Y.studentSets,aiSeatingRules:Y.aiSeatingRules,seatingType:Y.seatingType,editorMode:Y.editorMode},e.id),await oe(),d(!1),x(null)}},W=async()=>{if(!m)return;E(""),S("");const Y=O();if(!Y)return;d(!0);let fe;if(m.editorMode==="classic"||m.editorMode==="advanced"?fe=await up({halls:Y.halls,studentSets:Y.studentSets,seatingType:Y.seatingType||"normal"}):fe=await fp({halls:Y.halls,studentSets:Y.studentSets,rules:Y.aiSeatingRules||"",seatingType:Y.seatingType||"normal",editorMode:Y.editorMode}),fe.plan){const Ne={...Y,id:Y.id||`exam${Date.now()}`,seatingPlan:fe.plan};await sm(Ne),await oe();const De={...m,id:Ne.id,seatingPlan:Ne.seatingPlan,halls:Ne.halls,studentSets:Ne.studentSets};x(De),fe.message&&S(fe.message)}else E(fe.message||"Failed to generate seating plan. Please check your configuration and try again.");d(!1)},me=async(Y,fe)=>{const Ne=ae.current[Y];if(!Ne||!m)return;const De=Ne.style.boxShadow;Ne.style.boxShadow="none";const ye=Er.width>100?1.5:2,Ve=await Pc(Ne,{scale:ye,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0});Ne.style.boxShadow=De;const it=Ve.toDataURL("image/png"),lt=document.createElement("a"),zt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),mr=fe.replace(/[^a-z0-9]/gi,"_").toLowerCase();lt.download=`${zt}_${mr}_plan.png`,lt.href=it,document.body.appendChild(lt),lt.click(),document.body.removeChild(lt)},be=Y=>{var Ht,It,en,Tr;if(!m||!m.seatingPlan){E("Seating plan not generated yet.");return}const fe=m.seatingPlan[Y.id];if(!fe)return;const Ne=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),De=Rn.book_new(),ye=fe.reduce((mt,ot)=>Math.max(mt,ot.length),0);let Ve=[];if(Ne){const mt=[""];for(let ot=0;ot<ye;ot++)mt.push(`Seat ${ot+1}`),mt.push(`Student ${ot+1}`);Ve.push(mt);for(let ot=0;ot<fe.length;ot++){const sr=[`Row ${ot+1}`];for(let rr=0;rr<ye;rr++){const Ct=(Ht=fe[ot])==null?void 0:Ht[rr];sr.push(`r${ot+1}-c${rr+1}`),sr.push(((It=Ct==null?void 0:Ct.student)==null?void 0:It.id)||"")}Ve.push(sr)}}else{const mt=[""];for(let ot=0;ot<ye;ot++)mt.push(`Col ${ot+1}`);Ve.push(mt);for(let ot=0;ot<fe.length;ot++){const sr=[`Row ${ot+1}`];for(let rr=0;rr<ye;rr++){const Ct=(en=fe[ot])==null?void 0:en[rr];sr.push(((Tr=Ct==null?void 0:Ct.student)==null?void 0:Tr.id)||"")}Ve.push(sr)}}const it=Rn.aoa_to_sheet(Ve),lt=Y.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Rn.book_append_sheet(De,it,lt);const zt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),mr=Y.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Yc(De,`${zt}_${mr}_plan.xlsx`)},pe=async()=>{if(!(!m||!m.seatingPlan)){Me(!0),E("");for(const Y of m.halls){const fe=ae.current[Y.id];if(!fe)continue;const Ne=fe.style.boxShadow;fe.style.boxShadow="none";try{const De=Er.width>100?1.5:2,Ve=(await Pc(fe,{scale:De,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0})).toDataURL("image/png"),it=document.createElement("a"),lt=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),zt=Y.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();it.download=`${lt}_${zt}_plan.png`,it.href=Ve,document.body.appendChild(it),it.click(),document.body.removeChild(it),await new Promise(mr=>setTimeout(mr,500))}catch(De){console.error("Error generating PNG for hall:",Y.name,De),E(`Could not generate PNG for ${Y.name}.`)}finally{fe.style.boxShadow=Ne}}Me(!1)}},xe=()=>{if(!m||!m.seatingPlan){E("Seating plan not generated yet.");return}const Y=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?");E("");const fe=Rn.book_new();m.halls.forEach(De=>{var mr,Ht,It,en;const ye=m.seatingPlan[De.id];if(!ye)return;const Ve=ye.reduce((Tr,mt)=>Math.max(Tr,mt.length),0);let it=[];if(Y){const Tr=[""];for(let mt=0;mt<Ve;mt++)Tr.push(`Seat ${mt+1}`),Tr.push(`Student ${mt+1}`);it.push(Tr);for(let mt=0;mt<ye.length;mt++){const ot=[`Row ${mt+1}`];for(let sr=0;sr<Ve;sr++){const rr=(mr=ye[mt])==null?void 0:mr[sr];ot.push(`r${mt+1}-c${sr+1}`),ot.push(((Ht=rr==null?void 0:rr.student)==null?void 0:Ht.id)||"")}it.push(ot)}}else{const Tr=[""];for(let mt=0;mt<Ve;mt++)Tr.push(`Col ${mt+1}`);it.push(Tr);for(let mt=0;mt<ye.length;mt++){const ot=[`Row ${mt+1}`];for(let sr=0;sr<Ve;sr++){const rr=(It=ye[mt])==null?void 0:It[sr];ot.push(((en=rr==null?void 0:rr.student)==null?void 0:en.id)||"")}it.push(ot)}}const lt=Rn.aoa_to_sheet(it),zt=De.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Rn.book_append_sheet(fe,lt,zt)});const Ne=m.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Yc(fe,`${Ne}_full_seating_plan.xlsx`)},ve=async Y=>{if(!m||!e)return;d(!0),await ZL(m.id,Y,e.id)?(x(Ne=>Ne?{...Ne,seatingPlan:Y}:null),await oe()):E("Failed to save the updated seating plan."),d(!1)},Le=async Y=>{e&&window.confirm("Are you sure you want to permanently delete this exam? This action cannot be undone.")&&(d(!0),await gT(Y,e.id,e.role),(m==null?void 0:m.id)===Y&&x(null),await oe(),d(!1))},Ge=Y=>{x({...JSON.parse(JSON.stringify(Y)),aiSeatingRules:Y.aiSeatingRules||"",seatingType:Y.seatingType||"normal",editorMode:Y.editorMode||"ai"}),E(""),S("");const{width:fe,height:Ne,fontSize:De}=bf(Y.studentSets);Zr({width:fe,height:Ne,fontSize:De})},We=Y=>{x({...dt,createdBy:(e==null?void 0:e.id)||"",adminId:(e==null?void 0:e.adminId)||"",editorMode:Y,seatingType:"normal"}),E(""),S("")},Oe=()=>{x(null),E(""),S("")},Je=async Y=>{q(Y.id);let fe;if(Y.editorMode==="classic"||Y.editorMode==="advanced"?fe=await up({halls:Y.halls,studentSets:Y.studentSets,seatingType:Y.seatingType||"normal"}):fe=await fp({halls:Y.halls,studentSets:Y.studentSets,rules:Y.aiSeatingRules||"Arrange students fairly.",seatingType:Y.seatingType||"normal",editorMode:Y.editorMode}),fe.plan){const Ne={...Y,seatingPlan:fe.plan};await sm(Ne),await oe(),fe.message&&window.alert(fe.message)}else window.alert(fe.message||"Failed to generate seating plan. Not enough seats for all students.");q(null)},at=Y=>{J.current={},Re(Y.id)},hr=Y=>{if(!Y.seatingPlan){alert("This exam does not have a seating plan to export.");return}const fe=window.confirm("Do you want to include seat names (e.g., r1-c1) in the export?"),Ne=Rn.book_new();Y.halls.forEach(ye=>{var Ht,It,en,Tr;const Ve=Y.seatingPlan[ye.id];if(!Ve)return;const it=Ve.reduce((mt,ot)=>Math.max(mt,ot.length),0);let lt=[];if(fe){const mt=[""];for(let ot=0;ot<it;ot++)mt.push(`Seat ${ot+1}`),mt.push(`Student ${ot+1}`);lt.push(mt);for(let ot=0;ot<Ve.length;ot++){const sr=[`Row ${ot+1}`];for(let rr=0;rr<it;rr++){const Ct=(Ht=Ve[ot])==null?void 0:Ht[rr];sr.push(`r${ot+1}-c${rr+1}`),sr.push(((It=Ct==null?void 0:Ct.student)==null?void 0:It.id)||"")}lt.push(sr)}}else{const mt=[""];for(let ot=0;ot<it;ot++)mt.push(`Col ${ot+1}`);lt.push(mt);for(let ot=0;ot<Ve.length;ot++){const sr=[`Row ${ot+1}`];for(let rr=0;rr<it;rr++){const Ct=(en=Ve[ot])==null?void 0:en[rr];sr.push(((Tr=Ct==null?void 0:Ct.student)==null?void 0:Tr.id)||"")}lt.push(sr)}}const zt=Rn.aoa_to_sheet(lt),mr=ye.name.replace(/[*?:/\\\[\]]/g,"").substring(0,31);Rn.book_append_sheet(Ne,zt,mr)});const De=Y.title.replace(/[^a-z0-9]/gi,"_").toLowerCase();Yc(Ne,`${De}_seating_plan.xlsx`)},Dt=t.find(Y=>Y.id===Ae);if(X.useEffect(()=>{if(!Dt||!Dt.seatingPlan)return;const Y=setTimeout(async()=>{const fe=Object.entries(J.current).filter(([,De])=>De!==null);if(fe.length!==Dt.halls.length){Re(null);return}const Ne=fe.map(async([De,ye])=>{const Ve=Dt.halls.find(Tr=>Tr.id===De);if(!ye||!Ve)return;ye.style.boxShadow="none";const lt=v$(Dt)>15?1.5:2,zt=await Pc(ye,{scale:lt,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0});ye.style.boxShadow="";const mr=zt.toDataURL("image/png"),Ht=document.createElement("a"),It=Dt.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),en=Ve.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();Ht.download=`${It}_${en}_plan.png`,Ht.href=mr,document.body.appendChild(Ht),Ht.click(),document.body.removeChild(Ht)});await Promise.all(Ne),Re(null)},100);return()=>clearTimeout(Y)},[Ae,Dt]),!(e!=null&&e.permissionGranted))return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(yA,{}),h.jsx("main",{className:"max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-10 border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-red-100 dark:bg-red-900/20 rounded-full mb-6",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),h.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Permission Required"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg leading-relaxed",children:"Your account does not have the necessary permissions to manage exams. Please contact the system administrator to request access."})]})})]});if(f&&!m)return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(yA,{}),h.jsx("main",{className:"max-w-7xl mx-auto py-12 px-4 text-center",children:h.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[h.jsx("div",{className:"animate-spin rounded-full h-14 w-14 border-b-2 border-blue-600 dark:border-blue-400"}),h.jsx("span",{className:"text-lg text-gray-600 dark:text-gray-400 font-medium",children:"Loading exam data..."})]})})]});if(m){const Y=!m.id,fe=Y?null:t.find(ye=>ye.id===m.id),Ne=fe?JSON.stringify(m)!==JSON.stringify(fe):!0,De=m.studentSets.filter(ye=>!ye.isPlaceholder).map(ye=>({...ye,studentCount:Number(ye.studentCount)||0}));return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[T&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-start pt-20 z-50 animate-fadeIn",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700",onClick:ye=>ye.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Ma,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Select Hall Template"})]}),h.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:n.length>0?n.map(ye=>h.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Ma,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:ye.name}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[ye.layout.length," seats"]})]})]}),h.jsx(tt,{variant:"primary",size:"sm",className:"!py-2 !px-4 text-sm",onClick:()=>{Sa(ye),F(!1)},children:"Add"})]},ye.id)):h.jsxs("div",{className:"text-center py-10",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:h.jsx(Ma,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No hall templates available"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create templates to reuse hall layouts"})]})}),h.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:h.jsx(tt,{onClick:()=>F(!1),variant:"outline",className:"w-full",children:"Cancel"})})]})}),_.mode!=="closed"&&h.jsx(dp,{isOpen:!0,onClose:()=>Q({mode:"closed",hallIndex:null}),onSave:br,initialLayout:_.mode==="edit-hall"&&_.hallIndex!==null?(fs=m.halls[_.hallIndex])==null?void 0:fs.layout:_.mode==="edit-template"&&_.templateId?(yn=n.find(ye=>ye.id===_.templateId))==null?void 0:yn.layout:[],initialName:_.mode==="edit-template"?_.templateName:void 0,isTemplateCreationMode:_.mode==="create-template"||_.mode==="edit-template"}),re.open&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-start pt-20 z-50 animate-fadeIn",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700",onClick:ye=>ye.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(Ms,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Select Student Set Template"})]}),h.jsx("button",{onClick:()=>Z({open:!1,index:null}),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:s.length>0?s.map(ye=>h.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(Ms,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:ye.subject}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[ye.studentCount," students"]})]})]}),h.jsx(tt,{variant:"primary",size:"sm",className:"!py-2 !px-4 text-sm",onClick:()=>{re.index!==null&&rl(re.index,"template",ye),Z({open:!1,index:null})},children:"Add"})]},ye.id)):h.jsxs("div",{className:"text-center py-10",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:h.jsx(Ms,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No student set templates available"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create templates to reuse student sets"})]})}),h.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:h.jsx(tt,{onClick:()=>Z({open:!1,index:null}),variant:"outline",className:"w-full",children:"Cancel"})})]})}),lr&&m.seatingPlan&&h.jsx(x$,{isOpen:!0,onClose:()=>Jt(!1),onSave:ve,initialPlan:m.seatingPlan,halls:m.halls,studentSets:De,seatDimensions:Er}),h.jsxs("div",{className:"mb-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:Y?"Create New Exam":"Edit Exam Configuration"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:Y?"Configure your exam schedule and seating arrangements":"Update your existing exam setup"})]}),h.jsx(tt,{onClick:Oe,variant:"outline",className:"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500",children:" Back to Dashboard"})]}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx($2,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Exam Information"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Enter the basic details for your exam"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Title"}),h.jsx(Ut,{id:"exam-title",placeholder:"e.g., Fall Semester Final Examinations",value:m.title,onChange:ye=>$e("title",ye.target.value)})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Date"}),h.jsx(Ut,{id:"exam-date",type:"date",value:m.date,onChange:ye=>$e("date",ye.target.value)})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:h.jsx(Fi,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Editor Mode Selection"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose how you want to arrange seating"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[h.jsxs("div",{onClick:()=>vt("ai"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="ai"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="ai"?"bg-blue-100 dark:bg-blue-800/30 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(_i,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${m.editorMode==="ai"?"text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:"AI Mode"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Natural language instructions"})]})]}),m.editorMode==="ai"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-blue-500 dark:bg-blue-400"})]}),h.jsxs("div",{onClick:()=>vt("ai-advanced"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="ai-advanced"?"border-purple-500 bg-purple-50 dark:bg-purple-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="ai-advanced"?"bg-purple-100 dark:bg-purple-800/30 text-purple-600 dark:text-purple-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(Cc,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${m.editorMode==="ai-advanced"?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"}`,children:"AI + Advanced"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"AI with hall constraints"})]})]}),m.editorMode==="ai-advanced"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-purple-500 dark:bg-purple-400"})]}),h.jsxs("div",{onClick:()=>vt("advanced"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="advanced"?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="advanced"?"bg-cyan-100 dark:bg-cyan-800/30 text-cyan-600 dark:text-cyan-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(Fi,{className:"w-5 w-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${m.editorMode==="advanced"?"text-cyan-700 dark:text-cyan-300":"text-gray-700 dark:text-gray-300"}`,children:"Advanced Mode"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Manual control with algorithms"})]})]}),m.editorMode==="advanced"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-cyan-500 dark:bg-cyan-400"})]}),h.jsxs("div",{onClick:()=>vt("classic"),className:`relative p-5 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${m.editorMode==="classic"?"border-green-500 bg-green-50 dark:bg-green-900/10 shadow-sm":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[h.jsx("div",{className:`p-3 rounded-lg ${m.editorMode==="classic"?"bg-green-100 dark:bg-green-800/30 text-green-600 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:h.jsx(bi,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold ${m.editorMode==="classic"?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:"Classic Mode"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Simple round-robin distribution"})]})]}),m.editorMode==="classic"&&h.jsx("div",{className:"absolute top-3 right-3 h-3 w-3 rounded-full bg-green-500 dark:bg-green-400"})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:h.jsx(q2,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Exam Halls"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure the physical layout and constraints for each examination hall"})]})]}),h.jsx("div",{className:"space-y-6",children:m.halls.map((ye,Ve)=>{var en,Tr,mt,ot,sr,rr;const it=n.some(Ct=>Ct.name.toLowerCase()===ye.name.trim().toLowerCase()),lt=de===ye.id,zt=ne.includes(ye.id),mr=!ye.name.trim(),Ht=Z2(ye.layout),It=ye.layout.length===0?"placeholder":Ht.isGrid?"normal":"advanced";return h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsxs("div",{className:"flex-grow",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:h.jsx(q2,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),h.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Hall Configuration"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hall Name"}),h.jsx(Ut,{id:`hall-name-${Ve}`,value:ye.name,onChange:Ct=>Bt(Ve,Ct.target.value),placeholder:"e.g., Main Auditorium"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Front Direction"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:["top","bottom","left","right"].map(Ct=>h.jsx("button",{type:"button",onClick:()=>qt(Ve,Ct),className:`px-3 py-2 text-sm font-medium rounded-md transition-all ${(ye.frontDirection||"top")===Ct?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:Ct.charAt(0).toUpperCase()+Ct.slice(1)},Ct))})]})]})]}),h.jsx("button",{type:"button",onClick:()=>gt(Ve),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors ml-4",children:h.jsx(Ff,{})})]}),It==="placeholder"&&h.jsxs("div",{className:"mb-6 p-6 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 text-center",children:[h.jsx("h5",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-300",children:"Define Hall Layout"}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4 text-sm",children:"Choose how you want to define the seating layout"}),h.jsxs("div",{className:"flex justify-center gap-4",children:[h.jsx(tt,{variant:"outline",onClick:()=>Sr(Ve,"normal"),className:"!py-3 !px-6",children:"Grid Layout"}),h.jsx(tt,{variant:"outline",onClick:()=>Sr(Ve,"advanced"),className:"!py-3 !px-6",children:"Advanced Editor"})]})]}),It==="normal"&&Ht.isGrid&&h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rows"}),h.jsx(Ut,{type:"number",value:Ht.rows,min:"1",max:"50",onChange:Ct=>Ea(Ve,"rows",Ct.target.value)})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Columns"}),h.jsx(Ut,{type:"number",value:Ht.cols,min:"1",max:"50",onChange:Ct=>Ea(Ve,"cols",Ct.target.value)})]})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:h.jsx(Ms,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),h.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",h.jsxs("span",{className:"font-semibold",children:[ye.layout.filter(Ct=>Ct.type!=="faculty").length," seats"]})]})]}),h.jsx(tt,{variant:"outline",onClick:()=>Q({mode:"edit-hall",hallIndex:Ve}),size:"sm",children:"Switch to Advanced Editor"})]})]}),It==="advanced"&&h.jsx("div",{className:"mb-6",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:h.jsx(Ms,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),h.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",h.jsxs("span",{className:"font-semibold",children:[ye.layout.filter(Ct=>Ct.type!=="faculty").length," seats"]})]})]}),h.jsx(tt,{variant:"outline",onClick:()=>Q({mode:"edit-hall",hallIndex:Ve}),size:"sm",children:"Edit Advanced Layout"})]})}),["advanced","ai-advanced"].includes(m.editorMode||"ai")&&h.jsxs("div",{className:"pt-6 border-t border-gray-200 dark:border-gray-700",children:[h.jsx("h5",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Hall Constraints"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Student Placement"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{type:"button",onClick:()=>Mr(Ve,"no-limit"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!((en=ye.constraints)!=null&&en.type)||((Tr=ye.constraints)==null?void 0:Tr.type)==="no-limit"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"No Restrictions"}),h.jsx("button",{type:"button",onClick:()=>Mr(Ve,"advanced"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${((mt=ye.constraints)==null?void 0:mt.type)==="advanced"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Restricted Sets"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Seating Direction"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{type:"button",onClick:()=>Br(Ve,"horizontal"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${!((ot=ye.constraints)!=null&&ot.arrangement)||ye.constraints.arrangement==="horizontal"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Horizontal"}),h.jsx("button",{type:"button",onClick:()=>Br(Ve,"vertical"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${((sr=ye.constraints)==null?void 0:sr.arrangement)==="vertical"?"bg-blue-600 text-white shadow-sm":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:"Vertical"})]})]}),((rr=ye.constraints)==null?void 0:rr.type)==="advanced"&&h.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Allowed Student Sets"}),m.studentSets.filter(Ct=>!Ct.isPlaceholder).length>0?h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.studentSets.filter(Ct=>!Ct.isPlaceholder).map(Ct=>{var Fu,Uu;return h.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-white dark:hover:bg-gray-700 rounded-lg transition-colors border border-gray-200 dark:border-gray-700",children:[h.jsx("input",{type:"checkbox",checked:((Uu=(Fu=ye.constraints)==null?void 0:Fu.allowedSetIds)==null?void 0:Uu.includes(Ct.id))||!1,onChange:sl=>Ar(Ve,Ct.id,sl.target.checked),className:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 dark:text-blue-400 focus:ring-blue-500 bg-white dark:bg-gray-800"}),h.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:Ct.subject})]},Ct.id)})}):h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No student sets configured yet"})]})]})]}),h.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:zt?h.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),h.jsx("span",{className:"text-sm font-medium",children:"Saved as Template"})]}):lt?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),h.jsx("span",{className:"text-sm font-medium",children:"Saving..."})]}):it?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx(Ma,{}),h.jsx("span",{className:"text-sm font-medium",children:"Template Exists"})]}):h.jsxs(tt,{variant:"outline",size:"sm",disabled:mr||ye.layout.length===0,onClick:()=>Eo(ye),className:"flex items-center gap-2",children:[h.jsx(Ma,{}),"Save as Template"]})})]},ye.id)})}),h.jsxs("div",{className:"flex flex-wrap gap-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[h.jsxs(tt,{onClick:jr,variant:"outline",className:"flex items-center gap-2",children:[h.jsx(jm,{}),"Add Hall"]}),h.jsxs(tt,{onClick:()=>F(!0),variant:"outline",className:"flex items-center gap-2",children:[h.jsx(Ma,{}),"Add from Template"]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(Ms,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Student Sets"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Define groups of students participating in the exam"})]})]}),h.jsx("div",{className:"space-y-6",children:m.studentSets.map((ye,Ve)=>{if(ye.isPlaceholder)return h.jsxs("div",{className:"p-8 bg-gray-50 dark:bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 text-center",children:[h.jsx("h4",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-300",children:"Configure New Student Set"}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 text-sm",children:"Choose how you want to add student data"}),h.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mb-6",children:[h.jsx(tt,{variant:"outline",onClick:()=>rl(Ve,"custom"),className:"!py-3 !px-6",children:"Create Custom Set"}),h.jsx(tt,{variant:"outline",onClick:()=>Z({open:!0,index:Ve}),className:"!py-3 !px-6",children:"Use Template"}),h.jsxs(tt,{variant:"outline",className:"!py-3 !px-6 flex items-center gap-2",onClick:()=>{var It;return(It=Te.current[Ve])==null?void 0:It.click()},children:[h.jsx(Bc,{className:"h-4 w-4"}),"Upload Excel"]}),h.jsx("input",{type:"file",ref:It=>{It&&(Te.current[Ve]=It)},hidden:!0,accept:".xlsx, .xls",onChange:It=>nl(It,Ve)})]}),h.jsx("button",{type:"button",onClick:()=>fA(Ve),className:"text-red-600 hover:text-red-800 text-sm font-medium hover:underline transition",children:"Remove This Set"})]},ye.id);const it=s.some(It=>It.subject.toLowerCase()===ye.subject.trim().toLowerCase()),lt=N===ye.id,zt=Pe.includes(ye.id),mr=!ye.subject.trim()||!(parseInt(String(ye.studentCount),10)>0),Ht=!!ye.students;return h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subject / Set Code"}),h.jsx(Ut,{id:`set-subject-${Ve}`,value:ye.subject,onChange:It=>bA(Ve,"subject",It.target.value),placeholder:"e.g., PHYS101"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Number of Students"}),h.jsx(Ut,{id:`set-count-${Ve}`,type:"number",min:"1",value:ye.studentCount,onChange:It=>bA(Ve,"studentCount",It.target.value),readOnly:Ht})]}),h.jsx("div",{className:"flex items-end gap-2",children:h.jsxs("button",{type:"button",onClick:()=>si(Ve),className:"w-full h-10 flex items-center justify-center bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors text-gray-700 dark:text-gray-300",title:"Change Set Type",children:[h.jsx(Uf,{className:"h-4 w-4 mr-2"}),"Edit Type"]})}),h.jsx("div",{className:"flex items-end",children:h.jsxs("button",{type:"button",onClick:()=>fA(Ve),className:"w-full h-10 flex items-center justify-center bg-white dark:bg-gray-700 border border-red-300 dark:border-red-600 rounded-md hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-red-600 dark:text-red-400",children:[h.jsx(Ff,{className:"h-4 w-4 mr-2"}),"Remove"]})})]}),Ht&&h.jsx("div",{className:"mb-4",children:h.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300 rounded-full text-xs font-medium",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Populated from Excel file"]})}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("div",{children:Ht&&h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[h.jsx("span",{className:"font-medium",children:"Note:"})," Count determined by uploaded Excel file"]})}),h.jsx("div",{children:zt?h.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),h.jsx("span",{className:"text-sm font-medium",children:"Saved as Template"})]}):lt?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),h.jsx("span",{className:"text-sm font-medium",children:"Saving..."})]}):it?h.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[h.jsx(Ma,{}),h.jsx("span",{className:"text-sm font-medium",children:"Template Exists"})]}):h.jsxs(tt,{variant:"outline",size:"sm",disabled:mr||Ht,onClick:()=>j(ye),className:"flex items-center gap-2",children:[h.jsx(Ma,{}),"Save as Template"]})})]})]},ye.id)})}),h.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[h.jsxs(tt,{onClick:FA,variant:"outline",className:"flex items-center gap-2",children:[h.jsx(jm,{}),"Add Student Set"]}),h.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg border border-blue-200 dark:border-blue-800",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-800/20 rounded",children:h.jsx(Bc,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Excel Upload Guidelines"}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsx("li",{children:" The first sheet name will be used as the set code"}),h.jsx("li",{children:" Format student ID columns as 'Text' to preserve formatting"}),h.jsx("li",{children:" All non-empty cells will be read as student register numbers"}),h.jsx("li",{children:" Supports .xlsx and .xls file formats"})]})]})]})})]})]}),["ai","ai-advanced"].includes(m.editorMode||"ai")&&h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:h.jsx(_i,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"AI Seating Configuration"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Customize seating rules using natural language"})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Seating Strategy"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>Nt("normal"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType!=="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType!=="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Normal Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Efficient seating with custom AI instructions"})]})}),h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>Nt("fair"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType==="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType==="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fair Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatic alternation with extra spacing"})]})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Custom Instructions"}),h.jsx(u$,{id:"ai-rules",value:m.aiSeatingRules||"",onChange:ye=>$e("aiSeatingRules",ye.target.value),placeholder:`Enter specific seating rules. For example:
 Prioritize front rows for students with accessibility needs
 Separate students from the same department
 Ensure no two adjacent seats have the same subject code
 Place faculty supervisors at the back of each row`,rows:5,className:"w-full"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"AI will interpret your instructions to create the optimal seating arrangement."})]})]})]}),(m.editorMode==="classic"||m.editorMode==="advanced")&&h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg",children:h.jsx(Fi,{className:"h-6 w-6 text-cyan-600 dark:text-cyan-400"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:m.editorMode==="advanced"?"Advanced Seating Configuration":"Classic Seating Configuration"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.editorMode==="advanced"?"Manual control with predictable algorithms":"Simple round-robin distribution"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-4",children:"Seating Strategy"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>Nt("normal"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType!=="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType!=="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Normal Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.editorMode==="advanced"?"Alternates students and fills all remaining seats":"Simple round-robin distribution across all halls"})]})}),h.jsx("div",{className:"flex-1",children:h.jsxs("div",{onClick:()=>Nt("fair"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${m.seatingType==="fair"?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`h-3 w-3 rounded-full ${m.seatingType==="fair"?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`}),h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fair Seating"})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.editorMode==="advanced"?"Alternates students with empty seats between different sets":"Ensures spacing between students of different sets"})]})})]})]})]}),C&&h.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/10 rounded-lg border border-amber-200 dark:border-amber-800",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-1.5 bg-amber-100 dark:bg-amber-800/20 rounded",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h1m0 0h-1m1 0v4m0 0v4m0-8h1m-1 0h-1m1 0V8m0 0h-1m1 0V4m0 0h-1m1 0V0"})})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-300",children:"Note"}),h.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-400 mt-1",children:C})]})]})}),y&&h.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-800",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-1.5 bg-red-100 dark:bg-red-800/20 rounded",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"Validation Error"}),h.jsx("p",{className:"text-sm text-red-700 dark:text-red-400 mt-1",children:y})]})]})}),h.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6",children:h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsx(tt,{onClick:G,variant:"outline",className:"flex-1 !py-4 text-base font-semibold",disabled:f||!Ne,children:f?h.jsxs("span",{className:"flex items-center justify-center gap-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}),"Saving..."]}):Y?"Save Exam Draft":"Update Exam"}),h.jsx(tt,{onClick:W,variant:"primary",className:"flex-1 !py-4 text-base font-semibold",disabled:f,children:f?h.jsxs("span",{className:"flex items-center justify-center gap-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Generating Plan..."]}):"Generate Seating Plan"})]})})]}),m.seatingPlan&&h.jsxs("div",{className:"mt-12 space-y-8",children:[h.jsx(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:h.jsxs("div",{className:"text-center py-8",children:[h.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(kf,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Seating Plan Ready"})]}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto",children:"Your seating arrangement has been generated successfully. Download individual hall plans or export the complete seating chart."}),h.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-8",children:[h.jsxs(tt,{onClick:pe,variant:"outline",className:"flex items-center justify-center gap-2 !py-3 !px-6",disabled:ie,children:[h.jsx(kf,{className:"h-5 w-5"}),ie?"Downloading...":"Download All Halls (PNG)"]}),h.jsxs(tt,{onClick:xe,variant:"primary",className:"flex items-center justify-center gap-2 !py-3 !px-6",children:[h.jsx(Bc,{className:"h-5 w-5"}),"Export Full Plan (Excel)"]})]}),h.jsxs("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/10 rounded-xl border border-blue-200 dark:border-blue-800 max-w-lg mx-auto",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/20 rounded-lg",children:h.jsx(Uf,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Need manual adjustments?"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Edit individual student placements"})]})]}),h.jsx(tt,{onClick:()=>Jt(!0),variant:"primary",className:"w-full !py-3",children:"Open Seating Editor"})]})]})}),h.jsx("div",{className:"space-y-8",children:m.halls.map(ye=>{const Ve={...ye,layout:ye.layout};return h.jsxs(jt,{ref:it=>{it&&(ae.current[ye.id]=it)},className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 w-full",children:[h.jsx(Zc,{hall:Ve,plan:m.seatingPlan,studentSets:De,seatDimensions:Er}),h.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-300",children:ye.name}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Seating Plan"})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsxs(tt,{onClick:()=>me(ye.id,ye.name),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(kf,{})," PNG"]}),h.jsxs(tt,{onClick:()=>be(Ve),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(Bc,{})," Excel"]})]})]})})]},ye.id)})})]})]})]})]})}const gr=t.filter(Y=>Y.editorMode==="ai"||!Y.editorMode),kn=t.filter(Y=>Y.editorMode==="advanced"),$a=t.filter(Y=>Y.editorMode==="classic"),Ta=t.filter(Y=>Y.editorMode==="ai-advanced"),jn=Y=>h.jsx("div",{className:"space-y-4",children:Y.map(fe=>{const Ne=Se===fe.id,De=Ae===fe.id;return h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow",children:[h.jsx("div",{className:"p-5",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>Ge(fe),children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsxs("div",{className:`p-2 rounded-lg ${fe.editorMode==="ai"?"bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":fe.editorMode==="ai-advanced"?"bg-purple-100 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400":fe.editorMode==="advanced"?"bg-cyan-100 dark:bg-cyan-900/20 text-cyan-600 dark:text-cyan-400":"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400"}`,children:[fe.editorMode==="ai"&&h.jsx(_i,{className:"h-5 w-5"}),fe.editorMode==="ai-advanced"&&h.jsx(Cc,{className:"h-5 w-5"}),fe.editorMode==="advanced"&&h.jsx(Fi,{className:"h-5 w-5"}),fe.editorMode==="classic"&&h.jsx(bi,{className:"h-5 w-5"})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 text-lg",children:fe.title}),h.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(B$,{className:"h-4 w-4"}),fe.date]}),h.jsx("span",{children:""}),h.jsxs("span",{children:["Created by: ",Tt(fe.createdBy)]})]})]})]}),h.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[h.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${fe.seatingPlan?"bg-green-100 text-green-800 dark:bg-green-500/20 dark:text-green-300":"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300"}`,children:fe.seatingPlan?" Plan Generated":" Pending Plan"}),h.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[fe.halls.length," Hall",fe.halls.length!==1?"s":""]}),h.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[fe.studentSets.length," Set",fe.studentSets.length!==1?"s":""]})]})]}),h.jsx("button",{onClick:()=>Ge(fe),className:"ml-4 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx(w$,{})})]})}),h.jsx("div",{className:"px-5 py-4 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700 rounded-b-xl",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("div",{className:"flex items-center gap-2",children:fe.seatingPlan?h.jsxs(h.Fragment,{children:[h.jsxs(tt,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:ye=>{ye.stopPropagation(),at(fe)},disabled:De,children:[h.jsx(kf,{className:"h-4 w-4"}),De?"...":"PNGs"]}),h.jsxs(tt,{variant:"primary",size:"sm",className:"flex items-center gap-2",onClick:ye=>{ye.stopPropagation(),hr(fe)},children:[h.jsx(Bc,{className:"h-4 w-4"}),"Excel"]})]}):h.jsx(tt,{variant:"primary",size:"sm",className:"flex items-center gap-2",onClick:ye=>{ye.stopPropagation(),Je(fe)},disabled:Ne,children:Ne?h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Generating..."]}):h.jsxs(h.Fragment,{children:[h.jsx(_i,{className:"h-4 w-4"}),"Generate Plan"]})})}),h.jsx(tt,{variant:"danger",size:"sm",onClick:ye=>{ye.stopPropagation(),Le(fe.id)},children:"Delete"})]})})]},fe.id)})});return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(_.mode==="create-template"||_.mode==="edit-template")&&h.jsx(dp,{isOpen:!0,onClose:()=>Q({mode:"closed",hallIndex:null}),onSave:br,initialLayout:_.mode==="edit-hall"&&_.hallIndex!==null?(oi=m.halls[_.hallIndex])==null?void 0:oi.layout:_.mode==="edit-template"&&_.templateId?(_a=n.find(Y=>Y.id===_.templateId))==null?void 0:_a.layout:[],initialName:_.mode==="edit-template"?_.templateName:void 0,isTemplateCreationMode:_.mode==="create-template"||_.mode==="edit-template"}),L&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4 animate-fadeIn",onClick:()=>R(!1),children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700",onClick:Y=>Y.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(bi,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Create Grid Hall Template"})]}),h.jsxs("form",{onSubmit:al,children:[h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template Name"}),h.jsx(Ut,{id:"grid-template-name",value:U.name,onChange:Y=>K({...U,name:Y.target.value}),required:!0,placeholder:"e.g., Main Auditorium Layout"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rows"}),h.jsx(Ut,{id:"grid-template-rows",type:"number",min:"1",max:"50",value:U.rows,onChange:Y=>K({...U,rows:Y.target.value}),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Columns"}),h.jsx(Ut,{id:"grid-template-cols",type:"number",min:"1",max:"50",value:U.cols,onChange:Y=>K({...U,cols:Y.target.value}),required:!0})]})]}),D&&h.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-800",children:h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:D})})]}),h.jsxs("div",{className:"mt-8 flex justify-end gap-4",children:[h.jsx(tt,{type:"button",variant:"outline",onClick:()=>R(!1),children:"Cancel"}),h.jsx(tt,{type:"submit",variant:"primary",children:"Save Template"})]})]})]})}),h.jsxs("div",{className:"mb-10",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"Exam Seating Management"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create and manage exam schedules with intelligent seating arrangements"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(jm,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Create New Exam"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose an editor mode to begin creating your exam schedule"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{onClick:()=>We("ai"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(_i,{className:"text-blue-600 dark:text-blue-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"AI-Powered Mode"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Flexible seating with natural language rules"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Natural language instructions"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Intelligent seating optimization"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-blue-500"}),"Flexible rule-based arrangement"]})]})]}),h.jsxs("div",{onClick:()=>We("ai-advanced"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(Cc,{className:"text-purple-600 dark:text-purple-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"AI + Advanced"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"AI logic with strict hall constraints"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Combined AI and manual control"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Hall-specific set restrictions"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-purple-500"}),"Advanced constraint management"]})]})]}),h.jsxs("div",{onClick:()=>We("advanced"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-cyan-300 dark:hover:border-cyan-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(Fi,{className:"text-cyan-600 dark:text-cyan-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Advanced Mode"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manual control with predictable algorithms"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Granular hall control"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Deterministic seating"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-cyan-500"}),"Fast and predictable"]})]})]}),h.jsxs("div",{onClick:()=>We("classic"),className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-600 hover:shadow-md transition-all cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg group-hover:scale-110 transition-transform",children:h.jsx(bi,{className:"text-green-600 dark:text-green-400 w-6 h-6"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Classic Mode"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Simple round-robin distribution"})]})]}),h.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Simple and fast"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Automatic mixing"]}),h.jsxs("li",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-1 w-1 rounded-full bg-green-500"}),"Minimal configuration"]})]})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h1m0 0h-1m1 0v4m0 0v4m0-8h1m-1 0h-1m1 0V8m0 0h-1m1 0V4m0 0h-1m1 0V0"})})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"Editor Mode Guide"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Understanding the different seating arrangement methods"})]})]}),h.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",onClick:()=>Et(!ft),children:h.jsx(y$,{className:`h-6 w-6 transition-transform ${ft?"rotate-180":""}`})})]}),ft&&h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Editor Mode Comparison"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/20 rounded",children:h.jsx(_i,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"AI-Powered Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Best for complex scenarios requiring flexible, intelligent seating based on natural language instructions."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:'Example: "Keep Physics students away from Math students and prioritize front rows for accessibility needs."'})]})]}),h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-800/20 rounded",children:h.jsx(Cc,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"AI + Advanced Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Combines AI intelligence with strict hall-level controls for power users needing precise placement."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Restrict Hall A to Chemistry students only, then apply AI rules within that constraint."})]})]}),h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-cyan-100 dark:bg-cyan-800/20 rounded",children:h.jsx(Fi,{className:"h-5 w-5 text-cyan-600 dark:text-cyan-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Advanced Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Manual control with predictable algorithms, perfect for standardized exam setups."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Manually assign specific student sets to specific halls with defined seating directions."})]})]}),h.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[h.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-800/20 rounded",children:h.jsx(bi,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Classic Mode"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Simple and fast round-robin distribution for straightforward exam scenarios."}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Example: Automatically mix all student sets across all available halls in order."})]})]})]})]}),h.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[h.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4",children:"Workflow Overview"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"1"})}),h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Setup"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter exam details, add halls, and configure student sets"})]}),h.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"2"})}),h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Configure"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Choose editor mode and apply seating rules or constraints"})]}),h.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 text-center",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-3",children:h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"3"})}),h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Generate & Export"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Generate seating plan and export as Excel or PNG files"})]})]})]})]})]}),h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:h.jsx($2,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"My Exam Schedules"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage and monitor all your exam configurations"})]})]}),h.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:h.jsxs("nav",{className:"-mb-px flex flex-wrap gap-x-6","aria-label":"Tabs",children:[h.jsxs("button",{onClick:()=>He("ai"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${et==="ai"?"border-blue-500 dark:border-blue-400 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["AI Exams (",gr.length,")"]}),h.jsxs("button",{onClick:()=>He("ai-advanced"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${et==="ai-advanced"?"border-purple-500 dark:border-purple-400 text-purple-600 dark:text-purple-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["AI+Advanced (",Ta.length,")"]}),h.jsxs("button",{onClick:()=>He("advanced"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${et==="advanced"?"border-cyan-500 dark:border-cyan-400 text-cyan-600 dark:text-cyan-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Advanced (",kn.length,")"]}),h.jsxs("button",{onClick:()=>He("classic"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${et==="classic"?"border-green-500 dark:border-green-400 text-green-600 dark:text-green-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Classic (",$a.length,")"]})]})}),h.jsxs("div",{className:"mt-6",children:[et==="ai"&&(gr.length>0?jn(gr):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900/20 rounded-full mb-4",children:h.jsx(_i,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No AI exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create your first AI-powered exam schedule"})]})),et==="ai-advanced"&&(Ta.length>0?jn(Ta):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-purple-100 dark:bg-purple-900/20 rounded-full mb-4",children:h.jsx(Cc,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No AI+Advanced exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Combine AI with advanced constraints"})]})),et==="advanced"&&(kn.length>0?jn(kn):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-cyan-100 dark:bg-cyan-900/20 rounded-full mb-4",children:h.jsx(Fi,{className:"h-8 w-8 text-cyan-600 dark:text-cyan-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No Advanced exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create exams with manual control"})]})),et==="classic"&&($a.length>0?jn($a):h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full mb-4",children:h.jsx(bi,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No Classic exams created yet"}),h.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create simple round-robin exams"})]}))]})]})]}),h.jsx("div",{className:"space-y-8",children:h.jsxs(jt,{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:h.jsx(Ma,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"Template Library"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Reuse configurations across exams"})]})]}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Hall Layout Templates"}),h.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.length," templates"]})]}),h.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 mb-4 space-y-3",children:[h.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Create New Template"}),h.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.jsxs(tt,{onClick:()=>{R(!0),ee(""),K({name:"",rows:"8",cols:"10"})},variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(bi,{className:"h-4 w-4"}),"Grid Template"]}),h.jsxs(tt,{onClick:()=>Q({mode:"create-template",hallIndex:null}),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[h.jsx(Ma,{className:"h-4 w-4"}),"Custom Layout"]})]})]}),h.jsx("div",{className:"space-y-3",children:n.length>0?n.map(Y=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-900/20 rounded",children:h.jsx(Ma,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:Y.name}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Y.layout.length," seats"]})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>us(Y),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:h.jsx(Uf,{className:"h-4 w-4"})}),h.jsx("button",{onClick:()=>Al(Y.id),className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:h.jsx(Ff,{className:"h-4 w-4"})})]})]},Y.id)):h.jsxs("div",{className:"text-center py-6",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full mb-3",children:h.jsx(Ma,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No hall templates"})]})})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Student Set Templates"}),h.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.length," templates"]})]}),h.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 mb-4 space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:le?"Edit Template":"Create New Template"}),le&&h.jsx("button",{type:"button",onClick:I,className:"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 underline",children:"Cancel Edit"})]}),h.jsxs("form",{onSubmit:ii,className:"space-y-3",children:[h.jsx(Ut,{placeholder:"Subject / Code",value:k.subject,onChange:Y=>V({...k,subject:Y.target.value}),size:"sm"}),h.jsx(Ut,{type:"number",min:"1",placeholder:"Student Count",value:k.studentCount,onChange:Y=>V({...k,studentCount:Y.target.value}),size:"sm"}),P&&h.jsx("div",{className:"p-2 bg-red-50 dark:bg-red-900/10 rounded border border-red-200 dark:border-red-800",children:h.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:P})}),h.jsx(tt,{type:"submit",variant:"primary",size:"sm",className:"w-full",children:le?"Update Template":"Save Template"})]})]}),h.jsx("div",{className:"space-y-3",children:s.length>0?s.map(Y=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-1.5 bg-green-100 dark:bg-green-900/20 rounded",children:h.jsx(Ms,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:Y.subject}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Y.studentCount," students"]})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>li(Y),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:h.jsx(Uf,{className:"h-4 w-4"})}),h.jsx("button",{onClick:()=>H(Y.id),className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:h.jsx(Ff,{className:"h-4 w-4"})})]})]},Y.id)):h.jsxs("div",{className:"text-center py-6",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full mb-3",children:h.jsx(Ms,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No student set templates"})]})})]})]})]})})]}),Dt&&Dt.seatingPlan&&h.jsx("div",{style:{position:"absolute",left:"-9999px",top:"-9999px",zIndex:-1},children:Dt.halls.map(Y=>h.jsx("div",{ref:fe=>{fe&&(J.current[Y.id]=fe)},style:{width:"800px",padding:"1px"},children:h.jsx(jt,{children:h.jsx(Zc,{hall:Y,plan:Dt.seatingPlan,studentSets:Dt.studentSets,seatDimensions:bf(Dt.studentSets)})})},Y.id))})]})]})},E$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),S$=({className:e})=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"})]}),Xl=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),T$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),_$=({className:e})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${e}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),b$=({exams:e,onSelectExam:t})=>{const[r,n]=X.useState(new Date),a=X.useMemo(()=>e.reduce((S,T)=>{const F=T.date;return S[F]||(S[F]=[]),S[F].push(T),S},{}),[e]),s=()=>{n(new Date(r.getFullYear(),r.getMonth()-1,1))},l=()=>{n(new Date(r.getFullYear(),r.getMonth()+1,1))},o=r.getFullYear(),u=r.getMonth(),f=r.toLocaleString("default",{month:"long"}),d=new Date(o,u,1).getDay(),m=new Date(o,u+1,0).getDate(),x=Array.from({length:m},(S,T)=>T+1),y=Array.from({length:d}),E=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=S=>{const T=new Date;return S===T.getDate()&&u===T.getMonth()&&o===T.getFullYear()};return h.jsxs(jt,{className:"border border-slate-200 dark:border-slate-700 shadow-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:h.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),h.jsxs("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-200",children:[f," ",o]}),h.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:h.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),h.jsxs("div",{className:"grid grid-cols-7 gap-px bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden border dark:border-slate-700",children:[E.map(S=>h.jsx("div",{className:"py-2 text-center text-xs font-semibold text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-800",children:S},S)),y.map((S,T)=>h.jsx("div",{className:"bg-white dark:bg-slate-800 h-24 sm:h-32"},`empty-${T}`)),x.map(S=>{const T=`${o}-${String(u+1).padStart(2,"0")}-${String(S).padStart(2,"0")}`,F=a[T]||[],_=C(S);return h.jsxs("div",{className:"bg-white dark:bg-slate-800 h-24 sm:h-32 p-1 sm:p-2 flex flex-col relative transition-colors hover:bg-slate-50 dark:hover:bg-slate-750",children:[h.jsx("span",{className:`w-7 h-7 flex items-center justify-center rounded-full text-sm font-medium mb-1 ${_?"bg-violet-600 text-white shadow-md":"text-slate-700 dark:text-slate-300"}`,children:S}),h.jsx("div",{className:"flex-grow space-y-1 overflow-y-auto custom-scrollbar",children:F.map(Q=>h.jsx("button",{onClick:()=>t(Q),className:"w-full text-left p-1.5 rounded text-[10px] sm:text-xs font-medium bg-violet-100 text-violet-700 dark:bg-violet-500/20 dark:text-violet-300 hover:bg-violet-200 dark:hover:bg-violet-500/30 truncate transition-colors border-l-2 border-violet-500",title:Q.title,children:Q.title},Q.id))})]},S)})]})]})},F$=({exams:e,onSelectExam:t})=>h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(r=>{const n=new Date(r.date),a=n.toLocaleString("default",{month:"short"}).toUpperCase(),s=n.getDate();return h.jsxs("div",{className:"group bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-lg border border-slate-200 dark:border-slate-700 p-0 overflow-hidden transition-all duration-300 cursor-pointer flex flex-col h-full",onClick:()=>t(r),role:"button",tabIndex:0,onKeyPress:l=>(l.key==="Enter"||l.key===" ")&&t(r),children:[h.jsxs("div",{className:"p-5 flex items-start gap-4 flex-grow",children:[h.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-lg w-16 h-16 border border-slate-200 dark:border-slate-600",children:[h.jsx("span",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:a}),h.jsx("span",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:s})]}),h.jsxs("div",{className:"flex-grow min-w-0",children:[h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-1 truncate group-hover:text-violet-600 dark:group-hover:text-violet-400 transition-colors",children:r.title}),h.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:[r.halls.length," Hall",r.halls.length!==1?"s":"","  ",r.studentSets.length," Subject",r.studentSets.length!==1?"s":""]})]})]}),h.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/30 px-5 py-3 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"View details"}),h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-violet-500 transform group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]},r.id)})}),U$=()=>{var R,U;const{user:e}=ri(),[t,r]=X.useState([]),[n,a]=X.useState(null),[s,l]=X.useState(!0),[o,u]=X.useState("calendar"),f=X.useRef({}),[d,m]=X.useState(""),[x,y]=X.useState(""),[E,C]=X.useState(null),S=X.useCallback((K,D)=>{var ee;if(!K.seatingPlan)return null;for(const re in K.seatingPlan){const Z=K.seatingPlan[re];for(const ae of Z)for(const Te of ae)if(((ee=Te==null?void 0:Te.student)==null?void 0:ee.id)===D)return Te}return null},[]),T=n&&(e!=null&&e.registerNumber)?S(n,e.registerNumber):null,F=X.useCallback(K=>{if(!K)return;const D=setTimeout(()=>{const ee=f.current[K.hallId],re=document.querySelector("header");if(ee&&re){const Z=re.offsetHeight,Te=ee.getBoundingClientRect().top+window.scrollY,Se=window.innerHeight-Z,q=Te-Se/2+ee.offsetHeight/2-Z;window.scrollTo({top:q,behavior:"smooth"})}else ee&&ee.scrollIntoView({behavior:"smooth",block:"center"})},150);return()=>clearTimeout(D)},[]);X.useEffect(()=>{(async()=>{if(!(e!=null&&e.registerNumber)||!e.adminId){l(!1);return}try{l(!0);const D=await YL(e.registerNumber,e.adminId);r(D.sort((ee,re)=>new Date(ee.date).getTime()-new Date(re.date).getTime()))}catch(D){console.error("Error fetching exams:",D)}finally{l(!1)}})()},[e]),X.useEffect(()=>{n&&T?(C(T),m((e==null?void 0:e.registerNumber)||""),F(T)):(C(null),m("")),y("")},[n,T,e==null?void 0:e.registerNumber,F]);const _=K=>{if(K.preventDefault(),!n||!d.trim())return;const D=S(n,d.trim());D?(C(D),y(""),F(D)):(C(null),y(`Register Number "${d.trim()}" not found in this exam.`))},Q=()=>{T&&(C(T),m((e==null?void 0:e.registerNumber)||""),y(""),F(T))};if(s)return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-4xl mx-auto py-12 px-4 text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600 mx-auto mb-4"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Loading your exam schedules..."})]})]});if(n){const K=E?n.halls.find(D=>D.id===E.hallId):null;return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-screen-2xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsx("div",{className:"mb-6",children:h.jsxs(tt,{onClick:()=>a(null),variant:"secondary",className:"!px-3 !py-1 text-sm flex items-center gap-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to My Schedules"]})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[h.jsxs(jt,{className:"border-t-4 border-t-violet-500",children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:n.title}),h.jsxs("p",{className:"text-slate-500 dark:text-slate-400 flex items-center gap-2",children:[h.jsx(Xl,{className:"h-5 w-5 text-violet-500"}),new Date(n.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),h.jsxs(jt,{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-800/50",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-200",children:"Find a Seat"}),h.jsxs("form",{onSubmit:_,className:"flex gap-2 mb-4",children:[h.jsx(Ut,{containerClassName:"flex-grow",id:"search-register-number",placeholder:"Enter Reg. Number",value:d,onChange:D=>m(D.target.value),className:"!bg-white dark:!bg-slate-900"}),h.jsx(tt,{type:"submit",className:"!px-3",children:h.jsx(E$,{className:"h-5 w-5"})})]}),x&&h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-2 rounded border border-red-100 dark:border-red-900/30 mb-4",children:x}),E&&K?h.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[h.jsxs("div",{className:"bg-violet-600 text-white p-3 flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Exam Ticket"}),h.jsx(_$,{className:"h-5 w-5 opacity-80"})]}),h.jsxs("div",{className:"p-4 space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-end border-b border-dashed border-slate-200 dark:border-slate-700 pb-3",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Student ID"}),h.jsx("p",{className:"text-lg font-mono font-bold text-slate-800 dark:text-slate-100",children:(R=E.student)==null?void 0:R.id})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Subject"}),h.jsx("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:(U=E.student)==null?void 0:U.setId})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Hall"}),h.jsx("p",{className:"text-base font-bold text-violet-600 dark:text-violet-400",children:(K==null?void 0:K.name)||"N/A"})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase",children:"Seat Position"}),h.jsxs("p",{className:"text-base font-bold text-slate-800 dark:text-slate-200",children:["R",E.row+1," - C",E.col+1]})]})]})]})]}):!x&&h.jsx("div",{className:"text-center py-6 text-slate-400 dark:text-slate-500 text-sm italic",children:"Enter a register number above to locate a specific seat."})]})]}),h.jsx("div",{className:"lg:col-span-2 space-y-8",children:n.seatingPlan?n.halls.map(D=>h.jsx("div",{ref:ee=>{ee&&(f.current[D.id]=ee)},children:h.jsxs(jt,{className:"relative overflow-hidden",children:[(E==null?void 0:E.hallId)===D.id&&h.jsx("div",{className:"absolute top-0 right-0 bg-violet-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg shadow-md z-10",children:"Your Hall"}),h.jsx(Zc,{hall:D,plan:n.seatingPlan,studentSets:n.studentSets,highlightSeat:(E==null?void 0:E.hallId)===D.id?{row:E.row,col:E.col}:void 0})]})},D.id)):h.jsx(jt,{children:h.jsxs("div",{className:"text-center py-16",children:[h.jsx("div",{className:"inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-800 mb-4",children:h.jsx(Xl,{className:"h-8 w-8 text-slate-400"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-slate-100",children:"Seating Plan Unavailable"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 max-w-sm mx-auto",children:"The administrator hasn't generated or published the seating arrangement for this exam yet. Please check back later."})]})})})]}),T&&h.jsxs("button",{onClick:Q,className:"fixed bottom-8 right-8 bg-violet-600 text-white p-4 rounded-full shadow-xl hover:bg-violet-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-violet-300 z-50 flex items-center gap-2 group","aria-label":"Find my seat",title:"Find my seat",children:[h.jsx(S$,{className:"h-6 w-6"}),h.jsx("span",{className:"max-w-0 overflow-hidden group-hover:max-w-xs transition-all duration-300 whitespace-nowrap font-medium text-sm",children:"My Seat"})]})]})]})}const L=t.length>0?t[0]:null;return h.jsxs("div",{className:"min-h-screen",children:[h.jsx(yA,{}),h.jsxs("main",{className:"max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100",children:["Hello, ",h.jsx("span",{className:"text-violet-600 dark:text-violet-400",children:(e==null?void 0:e.name)||"Student"}),"!"]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Here is your examination schedule."})]}),L&&h.jsxs("div",{className:"mb-10 p-6 bg-gradient-to-r from-violet-600 to-indigo-600 rounded-2xl shadow-lg text-white relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white opacity-10 rounded-full blur-2xl"}),h.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-violet-200 text-sm font-semibold uppercase tracking-wider mb-1",children:"Next Up"}),h.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-1",children:L.title}),h.jsxs("p",{className:"text-violet-100 flex items-center gap-2",children:[h.jsx(Xl,{className:"h-5 w-5"}),new Date(L.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]}),h.jsx(tt,{onClick:()=>a(L),className:"bg-white text-violet-700 hover:bg-violet-50 border-none shadow-none font-bold px-6 py-3",children:"View Details & Seat"})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end mb-6 gap-4 border-b border-slate-200 dark:border-slate-700 pb-4",children:[h.jsxs("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[h.jsx(Xl,{className:"h-6 w-6 text-slate-400"})," All Exams"]}),t.length>0&&h.jsxs("div",{className:"flex bg-slate-200 dark:bg-slate-700 rounded-lg p-1",children:[h.jsxs("button",{onClick:()=>u("calendar"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-sm font-medium transition-all ${o==="calendar"?"bg-white dark:bg-slate-600 text-violet-600 dark:text-violet-300 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:[h.jsx(Xl,{className:"h-4 w-4"})," Calendar"]}),h.jsxs("button",{onClick:()=>u("list"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-sm font-medium transition-all ${o==="list"?"bg-white dark:bg-slate-600 text-violet-600 dark:text-violet-300 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:[h.jsx(T$,{className:"h-4 w-4"})," List"]})]})]}),t.length>0?h.jsx("div",{className:"animate-fade-in-up",children:o==="calendar"?h.jsx(b$,{exams:t,onSelectExam:a}):h.jsx(F$,{exams:t,onSelectExam:a})}):h.jsxs("div",{className:"text-center py-20 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-700",children:[h.jsx("div",{className:"inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-700 mb-4",children:h.jsx(Xl,{className:"h-10 w-10 text-slate-400"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-slate-100",children:"No Exams Scheduled"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 max-w-md mx-auto",children:"You don't have any upcoming exams assigned to your register number yet. Relax!"})]})]})]})},Nf=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,user:n}=ri(),a=As();return r?!n||!t.includes(n.role)?h.jsx(Xm,{to:"/login",replace:!0}):h.jsx(h.Fragment,{children:e}):h.jsx(Xm,{to:"/login",state:{from:a},replace:!0})},k$=()=>{const{user:e}=ri();return h.jsxs(zk,{children:[h.jsx(Ui,{path:"/login",element:h.jsx(_H,{})}),h.jsx(Ui,{path:"/super-admin",element:h.jsx(Nf,{allowedRoles:[At.SUPER_ADMIN],children:h.jsx(NH,{})})}),h.jsx(Ui,{path:"/admin",element:h.jsx(Nf,{allowedRoles:[At.ADMIN],children:h.jsx(c$,{})})}),h.jsx(Ui,{path:"/teacher",element:h.jsx(Nf,{allowedRoles:[At.TEACHER],children:h.jsx(C$,{})})}),h.jsx(Ui,{path:"/student",element:h.jsx(Nf,{allowedRoles:[At.STUDENT],children:h.jsx(U$,{})})}),h.jsx(Ui,{path:"/",element:h.jsx(Xm,{to:e?`/${e.role.toLowerCase().replace("_","-")}`:"/login"})})]})},N$=()=>h.jsx(dH,{children:h.jsx(fH,{children:h.jsx(mN,{children:h.jsx(k$,{})})})}),R4=document.getElementById("root");if(!R4)throw new Error("Could not find root element to mount to");const I$=WU.createRoot(R4);I$.render(h.jsx(PU.StrictMode,{children:h.jsx(N$,{})}));
